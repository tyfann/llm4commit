mmm a / packages / kiwi - core / package . json <nl> ppp b / packages / kiwi - core / package . json <nl> " dependencies " : { <nl> " color " : " ^ 3 . 1 . 2 " , <nl> - " emotion " : " ^ 10 . 0 . 27 " , <nl> " focus - trap " : " ^ 5 . 1 . 0 " , <nl> " focus - trap - vue " : " ^ 0 . 0 . 4 " , <nl> " lodash - es " : " ^ 4 . 17 . 15 " <nl> } , <nl> " peerDependencies " : { <nl> " breadstick " : " ^ 0 . 1 . 21 " , <nl> + " emotion " : " ^ 10 . 0 . 27 " , <nl> " vue " : " ^ 2 . 6 . 10 " , <nl> " vue - styled - components " : " git + https : / / github . com / codebender828 / vsc . git " <nl> } , <nl> 
mmm a / packages / kiwi - core / rollup . config . js <nl> ppp b / packages / kiwi - core / rollup . config . js <nl> ] <nl> } <nl> - / / const bannerTxt = ` / * ! Chakra - Vui v $ { pkg . version } | MIT License | github . com / codebender828 / kiwi - ui * / ` <nl> + const bannerTxt = ` / * ! Chakra - Vui v $ { pkg . version } | MIT License | github . com / codebender828 / kiwi - ui * / ` <nl> const baseFolder = ' . / src / ' <nl> - / / const capitalize = ( s ) = > { <nl> - / / if ( typeof s ! = = ' string ' ) return ' ' <nl> - / / return s . charAt ( 0 ) . toUpperCase ( ) + s . slice ( 1 ) <nl> - / / } <nl> + const capitalize = ( s ) = > { <nl> + if ( typeof s ! = = ' string ' ) return ' ' <nl> + return s . charAt ( 0 ) . toUpperCase ( ) + s . slice ( 1 ) <nl> + } <nl> const components = fs . readdirSync ( baseFolder ) <nl> . filter ( ( f ) = > fs . statSync ( path . join ( baseFolder , f ) ) . isDirectory ( ) ) <nl> @ @ - 90 , 23 + 90 , 23 @ @ const entries = { <nl> * Configurations <nl> * / <nl> export default ( ) = > { <nl> - / / const mapComponent = ( name ) = > { <nl> - / / return [ { <nl> - / / input : baseFolder + ` $ { name } / index . js ` , <nl> - / / external : externals , <nl> - / / output : { <nl> - / / format : ' umd ' , <nl> - / / name : capitalize ( name ) , <nl> - / / file : ` dist / components / $ { name } / index . js ` , <nl> - / / banner : bannerTxt , <nl> - / / exports : ' named ' , <nl> - / / globals : { <nl> - / / vue : ' Vue ' <nl> - / / } <nl> - / / } , <nl> - / / . . . commons <nl> - / / } ] <nl> - / / } <nl> + const mapComponent = ( name ) = > { <nl> + return [ { <nl> + input : baseFolder + ` $ { name } / index . js ` , <nl> + external : externals , <nl> + output : { <nl> + format : ' umd ' , <nl> + name : capitalize ( name ) , <nl> + file : ` dist / components / $ { name } / index . js ` , <nl> + banner : bannerTxt , <nl> + exports : ' named ' , <nl> + globals : { <nl> + vue : ' Vue ' <nl> + } <nl> + } , <nl> + . . . commons <nl> + } ] <nl> + } <nl> let config = [ { <nl> input : entries , <nl> @ @ - 115 , 62 + 115 , 62 @ @ export default ( ) = > { <nl> format : ' esm ' <nl> } , <nl> . . . commons <nl> + } , <nl> + { <nl> + input : entries , <nl> + output : { <nl> + dir : ` dist / es / ` , <nl> + format : ' es ' <nl> + } , <nl> + . . . commons <nl> + } , <nl> + { <nl> + input : entries , <nl> + output : { <nl> + dir : ` dist / cjs / ` , <nl> + format : ' cjs ' , <nl> + exports : ' named ' <nl> + } , <nl> + . . . commons <nl> + } , <nl> + { <nl> + input : ' . / src / index . js ' , <nl> + output : { <nl> + file : ` dist / umd / index . js / ` , <nl> + name : capitalize ( ' chakra ' ) , <nl> + format : ' umd ' , <nl> + exports : ' named ' , <nl> + banner : bannerTxt , <nl> + globals : { <nl> + vue : ' Vue ' <nl> } <nl> - / / { <nl> - / / input : entries , <nl> - / / output : { <nl> - / / dir : ` dist / es / ` , <nl> - / / format : ' es ' <nl> - / / } , <nl> - / / . . . commons <nl> - / / } , <nl> - / / { <nl> - / / input : entries , <nl> - / / output : { <nl> - / / dir : ` dist / cjs / ` , <nl> - / / format : ' cjs ' , <nl> - / / exports : ' named ' <nl> - / / } , <nl> - / / . . . commons <nl> - / / } , <nl> - / / { <nl> - / / input : ' . / src / index . js ' , <nl> - / / output : { <nl> - / / file : ` dist / umd / index . js / ` , <nl> - / / name : capitalize ( ' chakra ' ) , <nl> - / / format : ' umd ' , <nl> - / / exports : ' named ' , <nl> - / / banner : bannerTxt , <nl> - / / globals : { <nl> - / / vue : ' Vue ' <nl> - / / } <nl> - / / } , <nl> - / / . . . commons <nl> - / / } , <nl> - / / { <nl> - / / input : ' . / src / index . js ' , <nl> - / / output : { <nl> - / / file : ' dist / chakra - vui . esm . js ' , <nl> - / / name : capitalize ( ' chakra ' ) , <nl> - / / format : ' esm ' , <nl> - / / exports : ' named ' , <nl> - / / banner : bannerTxt <nl> - / / } , <nl> - / / . . . commons <nl> - / / } <nl> + } , <nl> + . . . commons <nl> + } , <nl> + { <nl> + input : ' . / src / index . js ' , <nl> + output : { <nl> + file : ' dist / chakra - vui . esm . js ' , <nl> + name : capitalize ( ' chakra ' ) , <nl> + format : ' esm ' , <nl> + exports : ' named ' , <nl> + banner : bannerTxt <nl> + } , <nl> + . . . commons <nl> + } , <nl> / / Individual components <nl> - / / . . . components . map ( ( f ) = > mapComponent ( f ) ) . reduce ( ( r , a ) = > r . concat ( a ) , [ ] ) <nl> + . . . components . map ( ( f ) = > mapComponent ( f ) ) . reduce ( ( r , a ) = > r . concat ( a ) , [ ] ) <nl> ] <nl> - / / if ( process . env . MINIFY = = = ' true ' ) { <nl> - / / config = config . filter ( ( c ) = > ! ! c . output . file ) <nl> - / / config . forEach ( ( c ) = > { <nl> - / / c . output . file = c . output . file . replace ( / \ . js / g , ' . min . js ' ) <nl> - / / c . plugins . push ( terser ( { <nl> - / / output : { <nl> - / / comments : ' / ^ ! / ' <nl> - / / } <nl> - / / } ) ) <nl> - / / } ) <nl> - / / } <nl> + if ( process . env . MINIFY = = = ' true ' ) { <nl> + config = config . filter ( ( c ) = > ! ! c . output . file ) <nl> + config . forEach ( ( c ) = > { <nl> + c . output . file = c . output . file . replace ( / \ . js / g , ' . min . js ' ) <nl> + c . plugins . push ( terser ( { <nl> + output : { <nl> + comments : ' / ^ ! / ' <nl> + } <nl> + } ) ) <nl> + } ) <nl> + } <nl> return config <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " now - build - storybook " : " build - storybook - o dist / storybook " <nl> } , <nl> - " devDependencies " : { <nl> + " dependencies " : { <nl> " @ babel / core " : " ^ 7 . 7 . 4 " , <nl> " @ babel / plugin - proposal - object - rest - spread " : " ^ 7 . 7 . 4 " , <nl> " @ babel / plugin - transform - modules - commonjs " : " ^ 7 . 7 . 4 " , <nl> " vue - lorem - ipsum " : " ^ 0 . 0 . 1 " , <nl> " vue - template - compiler " : " ^ 2 . 6 . 10 " , <nl> " vuepress " : " ^ 1 . 2 . 0 " <nl> - } , <nl> - " dependencies " : { } <nl> + } <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test " : " jest " , <nl> " clean " : " lerna run clean " , <nl> - " release " : " lerna publish " , <nl> - " patch " : " lerna version patch " , <nl> + " release " : " lerna version patch & & lerna publish from - package " , <nl> + " prepublish " : " yarn test & & yarn build " , <nl> " push " : " git add - A & & git commit - m \ " chore ( lerna ) : publishing package \ " & & lerna version - - conventional - commits " , <nl> " storybook " : " start - storybook - p 9000 " , <nl> " build - storybook " : " build - storybook - - quiet " , <nl> 
mmm a / yarn . lock <nl> ppp b / yarn . lock <nl> integrity sha512 - 0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw = = <nl> + " @ chakra - ui / vue @ ^ 0 . 4 . 1 " : <nl> + version " 0 . 4 . 2 " <nl> + resolved " https : / / registry . yarnpkg . com / @ chakra - ui / vue / - / vue - 0 . 4 . 2 . tgz # 5a6dc8ab19cad1b59039632037e6a32360378a71 " <nl> + integrity sha512 - wQ53rlbrG4 + AsyAUFuaboF2R3kHfwHFD9jUqL51UsVkc5cUecweyXvavNF / YRMBkAI1ni6BzPM / 3q / 9LqqHE7w = = <nl> + dependencies : <nl> + " @ popperjs / core " " ^ 2 . 4 . 0 " <nl> + " @ styled - system / css " " ^ 5 . 0 . 23 " <nl> + animejs " ^ 3 . 1 . 0 " <nl> + aria - hidden " ^ 1 . 1 . 1 " <nl> + breadstick " ^ 0 . 2 . 14 " <nl> + color " ^ 3 . 1 . 2 " <nl> + focus - trap " ^ 5 . 1 . 0 " <nl> + focus - trap - vue " ^ 0 . 0 . 4 " <nl> + lodash - es " ^ 4 . 17 . 15 " <nl> + portal - vue " ^ 2 . 1 . 6 " <nl> + styled - system " ^ 5 . 1 . 2 " <nl> + v - scroll - lock " ^ 1 . 1 . 0 " <nl> + <nl> " @ cnakazawa / watch @ ^ 1 . 0 . 3 " : <nl> version " 1 . 0 . 4 " <nl> resolved " https : / / registry . yarnpkg . com / @ cnakazawa / watch / - / watch - 1 . 0 . 4 . tgz # f864ae85004d0fcab6f50be9141c4da368d1656a " <nl> 
mmm a / packages / chakra - ui - docs / now . json <nl> ppp b / packages / chakra - ui - docs / now . json <nl> - " version " : 2 <nl> + " version " : 2 , <nl> + " env " : { <nl> + " MIXPANEL_TOKEN " : " 91ec73fd1b8e164d6cfbae6bf1a3e7d1 " <nl> + } , <nl> + " build " : { <nl> + " env " : { <nl> + " MIXPANEL_TOKEN " : " 91ec73fd1b8e164d6cfbae6bf1a3e7d1 " <nl> + } <nl> + } <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " @ babel / plugin - transform - parameters " : " ^ 7 . 7 . 4 " , <nl> " @ babel / preset - env " : " ^ 7 . 9 . 5 " , <nl> - " @ chakra - ui / vue " : " ^ 0 . 5 . 2 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 5 . 3 " , <nl> " @ commitlint / cli " : " ^ 8 . 2 . 0 " , <nl> " @ commitlint / config - conventional " : " ^ 8 . 2 . 0 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> 
mmm a / packages / chakra - ui - docs / package . json <nl> ppp b / packages / chakra - ui - docs / package . json <nl> " scripts " : { <nl> " dev " : " nuxt " , <nl> - " build " : " nuxt generate " , <nl> + " build " : " yarn build - static & & yarn export " , <nl> " build - static " : " nuxt build - - target static " , <nl> " export " : " nuxt export " , <nl> " start " : " nuxt start - - max_old_space_size = 8000 " , <nl> " devDependencies " : { <nl> " @ nuxtjs / eslint - config " : " ^ 2 . 0 . 0 " , <nl> " @ nuxtjs / eslint - module " : " ^ 1 . 0 . 0 " , <nl> - " babel - eslint " : " ^ 10 . 0 . 1 " , <nl> + " babel - eslint " : " ^ 10 . 1 . 0 " , <nl> " eslint " : " ^ 6 . 1 . 0 " , <nl> " eslint - config - prettier " : " ^ 6 . 10 . 0 " , <nl> " eslint - plugin - nuxt " : " > = 0 . 4 . 2 " , <nl> 
mmm a / modules / sandbox / script / init_jupyter . sh <nl> ppp b / modules / sandbox / script / init_jupyter . sh <nl> R - e " pacman : : p_load ( ' IRkernel ' ) " <nl> R - e " IRkernel : : installspec ( user = FALSE ) " <nl> - / usr / bin / python3 - m pip install ipywidgets <nl> / usr / bin / python3 - m pip install jupyterlab <nl> + / usr / bin / python3 - m pip install ipywidgets = = 7 . 7 . 2 # https : / / github . com / voila - dashboards / voila / issues / 1202 # issuecomment - 1255040572 until we wait . <nl> / usr / bin / python3 - m pip install jupyterlab - language - pack - fr - FR <nl> / usr / bin / python3 - m pip install jupyterlab - language - pack - es - ES <nl> / usr / bin / python3 - m pip install folium <nl> @ @ - 40 , 6 + 40 , 5 @ @ npm install - g - - unsafe - perm ijavascript <nl> npm install - g js - beautify <nl> / usr / bin / ijsinstall - - install = global <nl> - / usr / bin / python3 / usr / local / bin / jupyter labextension install @ jupyter - widgets / jupyterlab - manager <nl> - / usr / bin / python3 / usr / local / bin / jupyter labextension install jupyter - leaflet <nl> + <nl> / usr / bin / python3 / usr / local / bin / jupyter lab build <nl> \ No newline at end of file <nl> 
mmm a / scripts / release <nl> ppp b / scripts / release <nl> VERSION = " $ ( npm version - - no - git - tag - version $ BUMP_TYPE | sed ' s / v / / g ' ) " <nl> echo " = = > Updating Changelog " <nl> - node_modules / . bin / conventional - changelog - a - i CHANGELOG . md - o CHANGELOG . md - p angular <nl> + node_modules / . bin / conventional - changelog - i CHANGELOG . md - o CHANGELOG . md - p angular <nl> echo " = = > Cleaning Build directory " <nl> rm - rf . / dist <nl> 
mmm a / rollup . config . js <nl> ppp b / rollup . config . js <nl> import babili from ' rollup - plugin - babili ' ; <nl> const config = { <nl> - moduleName : ' ReactStrap ' , <nl> entry : ' src / index . js ' , <nl> - exports : ' named ' , <nl> plugins : [ <nl> nodeResolve ( ) , <nl> commonjs ( ) , <nl> @ @ - 20 , 13 + 18 , 6 @ @ const config = { <nl> ' react - addons - css - transition - group ' , <nl> ' react - addons - transition - group ' , <nl> ] , <nl> - / / Used for the UMD bundles <nl> - globals : { <nl> - react : ' React ' , <nl> - ' react - dom ' : ' ReactDOM ' , <nl> - ' react - addons - css - transition - group ' : ' CSSTransitionGroup ' , <nl> - ' react - addons - transition - group ' : ' TransitionGroup ' , <nl> - } , <nl> targets : [ <nl> { dest : ' dist / reactstrap . cjs . js ' , format : ' cjs ' } , <nl> { dest : ' dist / reactstrap . es . js ' , format : ' es ' } , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " react - test - renderer " : " ^ 15 . 5 . 4 " , <nl> " react - scripts " : " ^ 0 . 9 . 5 " , <nl> + " react - transition - group " : " ^ 1 . 1 . 2 " , <nl> " rollup " : " ^ 0 . 41 . 5 " , <nl> " rollup - plugin - babel " : " ^ 2 . 7 . 1 " , <nl> " rollup - plugin - babili " : " ^ 2 . 0 . 0 " , <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - scripts / docs <nl> env : <nl> global : <nl> - secure : GKu1vrkY7RWrrp0VOyxBjGSyTOGdU9jNT + oYR7P12PbCX4yzZ2mbsPpxWWs7Uh8ZXm5VEEfkrF80v / ccUEMvf1MD / q95nqLcQRoN / 31yDhiJ66uW + mZk0C6OqUUZJlcSt1Ta6oLmLVmkJUu2euOo4ZTGQ1iwV9EOS + auPYUjXF7df8JE9sTof4YM3jUiQ + 3ABIG8cOcsf81AyS9TOcpH6xPEs71Hz0uXta3TAAYpLgJSuuCciQn5Sr / 9UIh9w10zAasSZBy27 + A5mTf0C0xk3vN95cHfyS25r5x / zC3 + + YS / / 6MQASruT05Hf7STpF9Dy / 6mdg6tMfGr + 85zDqpMaF1dP5Rm9f8KHqZzYD52PtwLEkHpWwi / gqHY5vc + wHla5FEXiqawtBTRMj / hlvkvdN55qZnnFmsVEPrhHAIm1a8ECngzkZhG9QblszGgc55RtAtgGSlVsS5VWStsj29xLs2VJb6gYj69cMDSIND4e5VYzmrnaO / qRbzvRWJUIWFo / nmpSnAQbq5yV8K1 + VukbxX / hF7 + mE55ieeVww8tnC2bkxuQF1CbzTul5kPgAD7Hf8YdsSczvdZpSRHtN6OXGCotw4DRAiXZRb5TLFvEQFvbrNGciN5 / Z1rXxlMr8WWwckAFxVW1EQd + kKg8abjCOLE + YY04a + h3W / + XOgDPUlA = <nl> + secure : Jb9Q9 + XnCh + n5uNJuqUmLmPG6mUUv7iTi5bNeK6TpLdrVKk + 2mLdobV3iRUy / DEqNLwt2lxwzp1oq4YI / lZ0vlUam7HpFWpSf4PAI8ckGRqFdus7K45o + zxHLJ2zBQwXacsZB204qtO8RDdXaNb9PjRGNFdKm3ZuqZTv6PkO + hS05EFxmcW95HiSHpV / qPxKjEsDdCpoTNEA3MP0dNtSKygeht2nFQVr7WkOhkjDvUtU9EypkGbJeBCd0AckqXM0Qvmdi + + csyz5VRQhhUwI / 2BKSjbBVUZ6Q3m8sX2p4G / wFEbhXl5eKTzAYLuf + 9kT9Jg + gKdT30PoChx2NPKHv0XS8BOrKQScs6KIwOVH2 / CNCKqAxh3HkCMSONmqEQRqBK1V / gSCZ4zDX9PgrfyE23FLN / GM4YtBlkVCMLh8Y / hiapXUaDobxh / o2tfOoQkeoZWZeoeIydhwULTDSG2R3PKV7rkGYas0VQ + qtU + i8VG + PzjPT4DRf4xIKzNzJbFIq9oTNYBTasWi6 + OKzNw0uH3ydmRzf + GxaTwOIdR3nRQMQN60dH + 6qeJkrIvpfrGAB5gqTutXPfe0xf2rMrW6dyipnSgGlk1JOgA + cU4CPyHql1OA + ox / kIQ4I3PIJBu5YYE3amFmKLu3vnDHELSzM1CYeOs0sDasRyiDkKE79l0 = <nl> branches : <nl> only : <nl> - master <nl> - v4 <nl> - before_deploy : <nl> - - npm run build <nl> - deploy : <nl> - skip_cleanup : true <nl> - provider : npm <nl> - email : edward . d . hernandez @ gmail . com <nl> - api_key : <nl> - secure : FFlZtXFtzHE0mnYlYPnv5g7CE3IYj4DdO28qxSLV1sa1UC / FJOAY6no5iiQ62aL0CH66B9sgXjvOvRDYoSfIWjOxYS49OcYQ1U6cW4x3azI34FTVCkjfsmoOrnsiBkNjYkKbz + XW7rsdN / u4CA9womdqHq4v4dNroB8mgrHKli5 / CK7PhodRf9JYq758cc / cwZjnIQ3ioZ9vcsgsBcYO + 705kh0x6HNEYQyhDMm + + DMEupa7OtzZTeZbeDFxDCVlFWCxMJCbwkjqK4tqxXJglBbr2SPZ + LKi2EMHaILUoYwFsMimBFy + rYjCCe55zYnuYw2z + 6lPeqbJ7pvhodTYcf / kUVpHzUKBMrCW4oJXlQ7MjaX9gaiiD8K + pnP7IF3N + j7iiroxsRa7floYTjDLstxNwrawfrIajL1C0wRTZ9g7CUX / Pbxjs818zOAloHqzlVQewIt3Jcj0CyXeVgZSQvcHvU1ROSJkN9qYyBXbb9rou4j + mgYvLLy + aql91dvmSjQIuDGqG9x + Acyz5Zl5N36JNjNAwJxF1NV1E / Vks8TPdgU3O6zylP + tg9HAzu7jG9gnIAusC7vkE / 9RZ1TFQPAMTVrL + sqHmliDBHWBmMRibbkEsTl2vvV2ZSriHqQGqRFqv7jhON96RdzU6uxDtoRJb4ZGZrqEmt7l8n5USAU = <nl> - on : <nl> - tags : true <nl> - repo : reactstrap / reactstrap <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " @ nuxtjs / firebase " , <nl> - " version " : " 5 . 0 . 7 " , <nl> + " version " : " 5 . 1 . 0 " , <nl> " description " : " Intergrate Firebase into your Nuxt project . " , <nl> " keywords " : [ <nl> " firebase " , <nl> " cz - conventional - changelog " : " latest " , <nl> " eslint " : " latest " , <nl> " firebase " : " ^ 7 . 14 . 2 " , <nl> - " husky " : " latest " , <nl> + " husky " : " ^ 4 . 2 . 5 " , <nl> " jest " : " ^ 25 . 5 . 3 " , <nl> " standard - version " : " latest " , <nl> " vuepress " : " ^ 1 . 4 . 1 " , <nl> 
mmm a / build / Dockerfile . build <nl> ppp b / build / Dockerfile . build <nl> WORKDIR / build <nl> COPY . / build / compile . sh . <nl> - RUN chmod + x . / compile . sh & & . / compile . sh <nl> + RUN chmod + x . / compile . sh & & . / compile . sh & & rm . / compile . sh <nl> COPY - - from = notice / code / NOTICE . / <nl> 
mmm a / build / Dockerfile . messages <nl> ppp b / build / Dockerfile . messages <nl> RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> COPY . / packages / package . json . / packages / package - lock . json / code / deps / <nl> - COPY . / packages / code / packages <nl> WORKDIR / code / deps <nl> ENV ADBLOCK true <nl> ENV DISABLE_OPENCOLLECTIVE true <nl> 
mmm a / create_notice . py <nl> ppp b / create_notice . py <nl> def normalize_row ( row ) : <nl> - is_versioned_go_module = re . compile ( r " . * / v \ d $ " ) <nl> + is_versioned_go_module = re . compile ( r " . * / v \ d + $ " ) <nl> result = { } <nl> try : <nl> result [ " name " ] = row [ " module name " ] <nl> 
mmm a / Makefile <nl> ppp b / Makefile <nl> . PHONY : integration <nl> integration : # @ HELP Run integration tests <nl> integration : <nl> - @ docker - compose - p offen_integration - f docker - compose . integration . yml run - - rm integration npm t <nl> + @ docker - compose \ <nl> + - p offen_integration \ <nl> + - f docker - compose . integration . yml run - - rm \ <nl> + integration npm t <nl> . PHONY : dev - build <nl> dev - build : # @ HELP Build the Docker images for local development <nl> @ @ - 89 , 7 + 92 , 11 @ @ OFFEN_GIT_REVISION ? = none <nl> . PHONY : build <nl> build : # @ HELP Build the application binary <nl> build : <nl> - @ docker build - - build - arg ldflags = $ { LDFLAGS } - - build - arg targets = $ { TARGETS } - - build - arg rev = $ { OFFEN_GIT_REVISION } - t offen / build - f build / Dockerfile . build . <nl> + @ docker build \ <nl> + - - build - arg ldflags = $ { LDFLAGS } \ <nl> + - - build - arg targets = $ { TARGETS } \ <nl> + - - build - arg rev = $ { OFFEN_GIT_REVISION } \ <nl> + - t offen / build - f build / Dockerfile . build . <nl> @ mkdir - p bin <nl> @ docker create - - entrypoint = bash - it - - name binary offen / build <nl> @ docker cp binary : / build / . . / bin <nl> @ @ - 107 , 8 + 114 , 10 @ @ build - docker : <nl> setup - docs : # @ HELP Setup the development environment for working on the docs site <nl> setup - docs : <nl> @ docker - compose - p offen_docs - f docker - compose . docs . yml build <nl> - @ docker - compose - p offen_docs - f docker - compose . docs . yml run - - rm docs_jekyll bundle install <nl> - @ docker - compose - p offen_docs - f docker - compose . docs . yml run - - rm docs_jekyll bundle exec just - the - docs rake search : init <nl> + @ docker - compose - p offen_docs - f docker - compose . docs . yml run - - rm \ <nl> + docs_jekyll bundle install <nl> + @ docker - compose - p offen_docs - f docker - compose . docs . yml run - - rm \ <nl> + docs_jekyll bundle exec just - the - docs rake search : init <nl> . PHONY : docs <nl> docs : # @ HELP Run the development environment for the docs site <nl> @ @ - 116 , 7 + 125 , 7 @ @ docs : <nl> @ docker - compose - p offen_docs - f docker - compose . docs . yml up <nl> . PHONY : build - docs <nl> - build - docs : # @ HELP Build the static asstes for the docs site <nl> + build - docs : # @ HELP Build the static assets for the docs site <nl> build - docs : <nl> @ docker build - t offen / docs - f build / Dockerfile . docs . <nl> @ rm - rf docs - site & & mkdir docs - site <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> executor : node <nl> working_directory : ~ / offen / vault <nl> steps : <nl> - - test_node_app : <nl> - app : vault <nl> + - test_node_app <nl> script : <nl> executor : node <nl> working_directory : ~ / offen / script <nl> steps : <nl> - - test_node_app : <nl> - app : script <nl> + - test_node_app <nl> auditorium : <nl> executor : node <nl> working_directory : ~ / offen / auditorium <nl> steps : <nl> - - test_node_app : <nl> - app : auditorium <nl> + - test_node_app <nl> packages : <nl> executor : node <nl> working_directory : ~ / offen / packages <nl> steps : <nl> - - test_node_app : <nl> - app : packages <nl> + - test_node_app <nl> reuse : <nl> executor : python <nl> @ @ - 379 , 28 + 375 , 18 @ @ commands : <nl> test_node_app : <nl> description : Run unit tests for a Node . js based subapp <nl> parameters : <nl> - app : <nl> - type : string <nl> checkout : <nl> type : string <nl> default : ~ / offen <nl> steps : <nl> - checkout : <nl> path : < < parameters . checkout > > <nl> - - restore_cache : <nl> - key : offen - < < parameters . app > > - { { checksum " package . json " } } <nl> - run : <nl> name : Install dependencies <nl> - command : | <nl> - sudo apt - get install libxss1 <nl> - npm ci <nl> - - save_cache : <nl> - paths : <nl> - - ~ / offen / < < parameters . app > > / node_modules <nl> - key : offen - < < parameters . app > > - { { checksum " package . json " } } <nl> + command : npm ci <nl> - run : <nl> name : Run tests <nl> - command : npm test <nl> + command : npm t <nl> install_mc : <nl> description : Install MinIO client <nl> 
mmm a / build / Dockerfile . build <nl> ppp b / build / Dockerfile . build <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / auditorium / package . json . / auditorium / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> @ @ - 23 , 7 + 23 , 7 @ @ RUN npm run licenses <nl> FROM node : 14 - alpine as script <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / script / package . json . / script / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> @ @ - 43 , 7 + 43 , 7 @ @ RUN npm run licenses <nl> FROM node : 14 - alpine as vault <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / vault / package . json . / vault / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> @ @ - 64 , 7 + 64 , 7 @ @ RUN npm run licenses <nl> # packages does not have a build step but we need to derive license information <nl> FROM node : 14 - alpine as packages <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / packages / package . json . / packages / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> 
mmm a / build / Dockerfile . messages <nl> ppp b / build / Dockerfile . messages <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / auditorium / package . json . / auditorium / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> @ @ - 19 , 7 + 19 , 7 @ @ RUN npm run - - silent extract - strings > auditorium . po <nl> FROM node : 14 - alpine as script <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / script / package . json . / script / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> @ @ - 37 , 7 + 37 , 7 @ @ RUN npm run - - silent extract - strings > script . po <nl> FROM node : 14 - alpine as vault <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / vault / package . json . / vault / package - lock . json / code / deps / <nl> COPY . / packages / code / packages <nl> @ @ - 55 , 7 + 55 , 7 @ @ RUN npm run - - silent extract - strings > vault . po <nl> FROM node : 14 - alpine as packages <nl> RUN apk add git <nl> - RUN apk add - - no - cache - - virtual . gyp python make g + + <nl> + RUN apk add - - no - cache - - virtual . gyp python3 make g + + <nl> COPY . / packages / package . json . / packages / package - lock . json / code / deps / <nl> WORKDIR / code / deps <nl> 
mmm a / . github / workflows / extract_strings . yml <nl> ppp b / . github / workflows / extract_strings . yml <nl> id : cpr <nl> uses : peter - evans / create - pull - request @ v3 <nl> with : <nl> - base : development <nl> + base : $ { { github . ref } } <nl> token : $ { { secrets . PERSONAL_TOKEN } } <nl> commit - message : Update message files <nl> committer : Offen Bot < hioffen @ posteo . de > <nl> 
mmm a / . github / workflows / extract_strings . yml <nl> ppp b / . github / workflows / extract_strings . yml <nl> id : cpr <nl> uses : peter - evans / create - pull - request @ v3 <nl> with : <nl> - base : $ { { github . ref } } <nl> token : $ { { secrets . PERSONAL_TOKEN } } <nl> commit - message : Update message files <nl> committer : Offen Bot < hioffen @ posteo . de > <nl> 
mmm a / build / Dockerfile <nl> ppp b / build / Dockerfile <nl> # SPDX - License - Identifier : Apache - 2 . 0 <nl> - FROM alpine : 3 . 14 <nl> + FROM alpine : 3 . 15 <nl> LABEL maintainer = " offen < hioffen @ posteo . de > " <nl> RUN addgroup - g 10001 - S offen \ <nl> 
mmm a / Dockerfile . node <nl> ppp b / Dockerfile . node <nl> fonts - kacst \ <nl> fonts - thai - tlwg \ <nl> fonts - wqy - zenhei \ <nl> + fonts - freefont - ttf \ <nl> google - chrome - unstable \ <nl> - - no - install - recommends \ <nl> & & rm - rf / var / lib / apt / lists / * <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> docker buildx create docker - offen - - name docker - offen - - use <nl> docker buildx inspect - - bootstrap <nl> for tag in " $ { DOCKER_IMAGE_TAGS [ @ ] } " ; do <nl> - docker buildx build - - platform linux / amd64 , linux / arm64 , linux / arm / v7 offen / offen : $ tag . - - push <nl> + docker buildx build - - platform linux / amd64 , linux / arm64 , linux / arm / v7 - t offen / offen : $ tag . - - push <nl> done <nl> - store_artifacts : <nl> path : / tmp / artifacts <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> docker buildx create docker - offen - - name docker - offen - - use <nl> docker buildx inspect - - bootstrap <nl> for tag in " $ { DOCKER_IMAGE_TAGS [ @ ] } " ; do <nl> - docker buildx build - - platform linux / amd64 , linux / arm64 , linux / arm / v7 - t offen / offen : $ tag . - - push <nl> + docker buildx build - - platform linux / amd64 , linux / arm64 , linux / arm / v7 - f . / build / Dockerfile - t offen / offen : $ tag . - - push <nl> done <nl> - store_artifacts : <nl> path : / tmp / artifacts <nl> 
mmm a / build / Dockerfile . build <nl> ppp b / build / Dockerfile . build <nl> - - client auditorium . csv \ <nl> - - server server . csv > > NOTICE <nl> - FROM techknowlogick / xgo : go - 1 . 19 . 2 as compiler <nl> + FROM techknowlogick / xgo : go - 1 . 19 . 5 as compiler <nl> ARG rev <nl> ENV GIT_REVISION = $ rev <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " conventional - commit - types " : " ^ 2 . 1 . 0 " , <nl> " copy - webpack - plugin " : " ^ 1 . 1 . 1 " , <nl> - " css - loader " : " ^ 0 . 23 . 1 " , <nl> " cz - conventional - changelog " : " ^ 1 . 2 . 0 " , <nl> " eslint " : " ^ 1 . 10 . 3 " , <nl> " eslint - config - standard " : " ^ 4 . 4 . 0 " , <nl> " expose - loader " : " ^ 0 . 7 . 1 " , <nl> " extract - text - webpack - plugin " : " ^ 1 . 0 . 1 " , <nl> " file - loader " : " ^ 0 . 8 . 5 " , <nl> - " geojs " : " ^ 0 . 9 . 1 " , <nl> " grunt " : " ^ 1 . 0 . 1 " , <nl> - " html - loader " : " ^ 0 . 4 . 3 " , <nl> " html - webpack - plugin " : " ^ 2 . 9 . 0 " , <nl> " http - server " : " ^ 0 . 9 . 0 " , <nl> " husky " : " ^ 0 . 11 . 8 " , <nl> " imports - loader " : " ^ 0 . 6 . 5 " , <nl> - " jade " : " ^ 1 . 11 . 0 " , <nl> - " jade - loader " : " ^ 0 . 8 . 0 " , <nl> " javascript - detect - element - resize " : " ^ 0 . 5 . 3 " , <nl> " json - loader " : " ^ 0 . 5 . 4 " , <nl> " karma " : " ^ 0 . 13 . 22 " , <nl> " karma - tap " : " ^ 1 . 0 . 4 " , <nl> " karma - webpack " : " ^ 1 . 7 . 0 " , <nl> " legacy - loader " : " 0 . 0 . 2 " , <nl> - " less " : " ^ 2 . 3 . 1 " , <nl> - " md5 " : " ^ 2 . 2 . 1 " , <nl> " nightmare " : " ^ 2 . 3 . 1 " , <nl> " node - resemble " : " ^ 1 . 1 . 3 " , <nl> - " node - sass " : " ^ 3 . 4 . 2 " , <nl> - " nvd3 " : " ^ 1 . 8 . 4 " , <nl> " pegjs " : " ^ 0 . 9 . 0 " , <nl> " pegjs - loader " : " ^ 0 . 4 . 0 " , <nl> " phantomjs - prebuilt " : " ^ 2 . 1 . 5 " , <nl> " raw - loader " : " ^ 0 . 5 . 1 " , <nl> - " sass - loader " : " ^ 3 . 2 . 0 " , <nl> " sass - variable - loader " : " 0 . 0 . 4 " , <nl> - " script - loader " : " ^ 0 . 6 . 1 " , <nl> " semantic - release " : " ^ 4 . 3 . 5 " , <nl> " semistandard " : " ^ 7 . 0 . 5 " , <nl> " snazzy " : " ^ 4 . 0 . 0 " , <nl> - " strip - json - comments " : " ^ 2 . 0 . 1 " , <nl> - " strip - json - comments - loader " : " 0 . 0 . 2 " , <nl> - " style - loader " : " ^ 0 . 13 . 0 " , <nl> " stylus " : " ^ 0 . 54 . 5 " , <nl> " stylus - loader " : " ^ 2 . 0 . 0 " , <nl> " tap - spec " : " ^ 4 . 1 . 1 " , <nl> " tape " : " ^ 4 . 5 . 1 " , <nl> " tape - catch " : " ^ 1 . 0 . 6 " , <nl> - " telegraph - events " : " ^ 1 . 0 . 3 " , <nl> " url - loader " : " ^ 0 . 5 . 7 " , <nl> " validate - commit - msg " : " ^ 2 . 8 . 2 " , <nl> " webpack " : " ^ 1 . 12 . 12 " <nl> " UpSet " : " git + https : / / github . com / VCG / upset # 6e8b7a172443dd6b4f4324d1a3368287e9e9c089 " , <nl> " onset " : " git + https : / / github . com / Kitware / setvis # 506bfccff63b0c8f5c39a81d299ed310e5e8fbff " , <nl> " brace " : " ^ 0 . 7 . 0 " , <nl> + " css - loader " : " ^ 0 . 23 . 1 " , <nl> " d3 " : " ^ 3 . 5 . 14 " , <nl> " datalib " : " ^ 1 . 7 . 3 " , <nl> - " font - awesome " : " ^ 4 . 4 . 0 " , <nl> - " font - awesome - webpack " : " ^ 0 . 0 . 4 " , <nl> + " geojs " : " ^ 0 . 9 . 1 " , <nl> + " html - loader " : " ^ 0 . 4 . 3 " , <nl> " is_js " : " ^ 0 . 9 . 0 " , <nl> + " jade " : " ^ 1 . 11 . 0 " , <nl> + " jade - loader " : " ^ 0 . 8 . 0 " , <nl> " jquery " : " ^ 2 . 2 . 0 " , <nl> " jquery - deparam " : " ^ 0 . 5 . 2 " , <nl> + " less " : " ^ 2 . 3 . 1 " , <nl> + " md5 " : " ^ 2 . 2 . 1 " , <nl> + " node - sass " : " ^ 3 . 4 . 2 " , <nl> + " nvd3 " : " ^ 1 . 8 . 4 " , <nl> + " sass - loader " : " ^ 3 . 2 . 0 " , <nl> + " script - loader " : " ^ 0 . 6 . 1 " , <nl> + " strip - json - comments " : " ^ 2 . 0 . 1 " , <nl> + " strip - json - comments - loader " : " 0 . 0 . 2 " , <nl> + " style - loader " : " ^ 0 . 13 . 0 " , <nl> + " telegraph - events " : " ^ 1 . 0 . 3 " , <nl> " underscore " : " ^ 1 . 8 . 3 " , <nl> " vega " : " ^ 2 . 4 . 2 " <nl> } , <nl> 
mmm a / webpack . js <nl> ppp b / webpack . js <nl> } ) . concat ( paths ) ; <nl> } <nl> - module . exports = function ( config , basePath ) { <nl> + module . exports = function ( config , basePath , options ) { <nl> var includePaths = _includePaths ( basePath ) ; <nl> + options = options | | { } ; <nl> + <nl> + / / By default , exclude the existing loaders from affecting <nl> + / / node_modules / candela . This prevents double application of loaders if they <nl> + / / are specified in the client project without any include or exclude <nl> + / / directives . <nl> + var exclude = options . excludeCandelaNM = = = undefined | | options . excludeCandelaNM ; <nl> + <nl> / / Install empty module and module . loaders entries if missing . <nl> config . module = config . module | | { } ; <nl> config . module . loaders = config . module . loaders | | [ ] ; <nl> + / / Exclude the base paths from having existing loaders applied to them . <nl> + if ( exclude ) { <nl> + config . modules . loaders = config . modules . loaders | | [ ] ; <nl> + config . modules . loaders . forEach ( function ( loader ) { <nl> + loader . exclude = ( loader . exclude | | [ ] ) . concat ( includePaths ) ; <nl> + } ) ; <nl> + } <nl> + <nl> / / Prepend the Candela loaders . <nl> config . module . loaders = [ <nl> { <nl> 
mmm a / webpack . js <nl> ppp b / webpack . js <nl> / / directives . <nl> var exclude = options . excludeCandelaNM = = = undefined | | options . excludeCandelaNM ; <nl> + / / Exclude the base paths from having existing loaders applied to them . <nl> + if ( exclude ) { <nl> / / Install empty module and module . loaders entries if missing . <nl> config . module = config . module | | { } ; <nl> config . module . loaders = config . module . loaders | | [ ] ; <nl> - / / Exclude the base paths from having existing loaders applied to them . <nl> - if ( exclude ) { <nl> - config . modules . loaders = config . modules . loaders | | [ ] ; <nl> - config . modules . loaders . forEach ( function ( loader ) { <nl> - loader . exclude = ( loader . exclude | | [ ] ) . concat ( includePaths ) ; <nl> + / / For each loader , append the Candela include paths to its ` exclude ` <nl> + / / property . <nl> + config . module . loaders . forEach ( function ( loader ) { <nl> + / / Install an empty list if there is no ` exclude ` property . <nl> + loader . exclude = loader . exclude | | [ ] ; <nl> + <nl> + / / If the ` exclude ` propertry is a non - list singleton , wrap it in a list . <nl> + if ( ! Array . isArray ( loader . exclude ) ) { <nl> + loader . exclude = [ loader . exclude ] ; <nl> + } <nl> + <nl> + loader . exclude = loader . exclude . concat ( includePaths ) ; <nl> } ) ; <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> } , <nl> " dependencies " : { <nl> - " UpSet " : " git + https : / / github . com / ronichoudhury - work / upset # 7f3c307769490f389ef79b31f68f2558ffa7b2f8 " , <nl> + " UpSet " : " git + https : / / github . com / ronichoudhury - work / upset # aa6fcbf9573823ce5dae948e48d7a154deacad62 " , <nl> " onset " : " git + https : / / github . com / Kitware / setvis # b2b8e7cfdef335a4ee4b2af871e14d203ef3e754 " , <nl> " brace " : " ^ 0 . 7 . 0 " , <nl> " css - loader " : " ^ 0 . 23 . 1 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " codecov " : " cat coverage / lcov / lcov . info | codecov " , <nl> " examples " : " http - server build - p $ { PORT - 3000 } " , <nl> - " docs " : " npm run build : docs & & http - server build / docs - p $ { PORT - 3000 } " , <nl> + " docs " : " http - server build / docs - p $ { PORT - 3000 } " , <nl> " commit " : " git - cz " , <nl> " semantic - release " : " semantic - release pre & & npm publish & & semantic - release post " , <nl> " commitmsg " : " validate - commit - msg " <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " copy - webpack - plugin " : " ^ 1 . 1 . 1 " , <nl> " cz - conventional - changelog " : " ^ 1 . 2 . 0 " , <nl> - " d3 " : " ^ 3 . 5 . 17 " , <nl> " eslint " : " ^ 1 . 10 . 3 " , <nl> " eslint - config - standard " : " ^ 4 . 4 . 0 " , <nl> " eslint - plugin - promise " : " ^ 1 . 0 . 8 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " dependencies " : { <nl> " UpSet " : " git + https : / / github . com / ronichoudhury - work / upset # aa6fcbf9573823ce5dae948e48d7a154deacad62 " , <nl> - " onset " : " git + https : / / github . com / Kitware / setvis # b2b8e7cfdef335a4ee4b2af871e14d203ef3e754 " , <nl> " brace " : " ^ 0 . 7 . 0 " , <nl> " css - loader " : " ^ 0 . 23 . 1 " , <nl> " d3 " : " ^ 3 . 5 . 14 " , <nl> " md5 " : " ^ 2 . 2 . 1 " , <nl> " node - sass " : " ^ 3 . 4 . 2 " , <nl> " nvd3 " : " ^ 1 . 8 . 4 " , <nl> + " onset " : " git + https : / / github . com / Kitware / setvis # b2b8e7cfdef335a4ee4b2af871e14d203ef3e754 " , <nl> " sass - loader " : " ^ 3 . 2 . 0 " , <nl> " script - loader " : " ^ 0 . 6 . 1 " , <nl> " strip - json - comments " : " ^ 2 . 0 . 1 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " ignore " : [ <nl> " config " , <nl> - " src / external " , <nl> - " app / resonantlab / gaTemplate . js " , <nl> - " app / resonantlab / ga . js " , <nl> - " app / resonantlab / web_client / lib " , <nl> + " app / resonantlab " , <nl> " dist " , <nl> - " built " , <nl> + " build " , <nl> " R / candela / inst / htmlwidgets / lib " <nl> ] <nl> } , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " brace " : " ^ 0 . 7 . 0 " , <nl> " css - loader " : " ^ 0 . 23 . 1 " , <nl> - " d3 " : " ^ 4 . 8 . 0 " , <nl> + " d3 " : " ^ 3 . 5 . 17 " , <nl> " datalib " : " ^ 1 . 7 . 3 " , <nl> " geojs " : " ^ 0 . 9 . 1 " , <nl> " glo " : " github : ronichoudhury - work / glo # dist " , <nl> 
mmm a / examples / package . json <nl> ppp b / examples / package . json <nl> " underscore " : " ^ 1 . 8 . 3 " , <nl> " url - loader " : " ^ 0 . 5 . 8 " , <nl> - " vega " : " ^ 2 . 4 . 2 " <nl> + " vega " : " ^ 2 . 4 . 2 " , <nl> + " webpack " : " ^ 1 . 15 . 0 " <nl> + } , <nl> + " scripts " : { <nl> + " build " : " webpack " <nl> } <nl> } <nl> 
mmm a / . npmignore <nl> ppp b / . npmignore <nl> build <nl> - config <nl> + circle . yml <nl> CONTRIBUTING . md <nl> - coverage <nl> docs <nl> + examples <nl> python <nl> R <nl> requirements - dev . txt <nl> script <nl> - tests . bundle . js <nl> + shell . nix <nl> + tests <nl> + * * / test / <nl> + webpack . config . js <nl> + . babelrc <nl> + . npmignore <nl> + . server . pid <nl> + . server . log <nl> 
mmm a / . github / workflows / node . js . yml <nl> ppp b / . github / workflows / node . js . yml <nl> - name : Use Node . js $ { { matrix . node - version } } <nl> uses : actions / setup - node @ v2 <nl> with : <nl> + cache : npm <nl> node - version : $ { { matrix . node - version } } <nl> - run : npm ci <nl> - run : npm run build - - if - present <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> - name : Checkout <nl> uses : actions / checkout @ v1 <nl> - name : Setup Node . js <nl> - uses : actions / setup - node @ v1 <nl> + uses : actions / setup - node @ v2 <nl> with : <nl> + cache : npm <nl> node - version : 14 <nl> - name : Install dependencies <nl> run : npm ci <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> run : yarn - - frozen - lockfile <nl> - name : Build <nl> if : $ { { needs . changes . outputs . wmr = = ' true ' } } <nl> - run : yarn workspace wmr build <nl> + run : yarn wmr build <nl> - name : Test wmr <nl> if : $ { { needs . changes . outputs . wmr = = ' true ' } } <nl> - run : yarn workspace wmr test <nl> + run : yarn eslint packages / wmr & & yarn wmr test <nl> - name : Test wmr ( production build ) <nl> if : $ { { needs . changes . outputs . wmr = = ' true ' } } <nl> - run : yarn workspace wmr test - prod <nl> + run : yarn wmr test - prod <nl> - name : Test preact - iso <nl> if : $ { { needs . changes . outputs . preact - iso = = ' true ' } } <nl> - run : yarn workspace preact - iso test <nl> + run : yarn eslint packages / preact - iso & & yarn iso test <nl> lhci : <nl> needs : changes <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> test : <nl> name : Node $ { { matrix . node } } / $ { { matrix . os } } <nl> runs - on : $ { { matrix . os } } <nl> + environment : ci <nl> strategy : <nl> fail - fast : false <nl> matrix : <nl> @ @ - 20 , 4 + 21 , 8 @ @ jobs : <nl> node - version : $ { { matrix . node } } <nl> - run : npm install <nl> - run : npm run build - - if - present <nl> + - run : echo " 127 . 0 . 0 . 1 airtap . local " | sudo tee - a / etc / hosts <nl> - run : npm test <nl> + env : <nl> + SAUCE_USERNAME : $ { { secrets . SAUCE_USERNAME } } <nl> + SAUCE_ACCESS_KEY : $ { { secrets . SAUCE_ACCESS_KEY } } <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> # For more information see : https : / / help . github . com / actions / language - and - framework - guides / using - nodejs - with - github - actions <nl> - name : Build & Test Components <nl> + name : Release <nl> on : <nl> push : <nl> 
mmm a / . github / workflows / test . yml <nl> ppp b / . github / workflows / test . yml <nl> # For more information see : https : / / help . github . com / actions / language - and - framework - guides / using - nodejs - with - github - actions <nl> - name : Build & Test Components <nl> + name : PR Workflow <nl> on : <nl> - # Trigger the workflow on push or pull request , <nl> - # but only for the master branch <nl> - push : <nl> + pull_request : <nl> branches : <nl> + - master <nl> - develop <nl> - pull_request : <nl> + push : <nl> branches : <nl> - develop <nl> @ @ - 20 , 15 + 19 , 24 @ @ jobs : <nl> matrix : <nl> node - version : [ 12 . x ] <nl> steps : <nl> - - uses : actions / checkout @ v2 <nl> + - name : Checkout <nl> + uses : actions / checkout @ v2 <nl> + <nl> - name : Use Node . js $ { { matrix . node - version } } <nl> uses : actions / setup - node @ v1 <nl> with : <nl> node - version : $ { { matrix . node - version } } <nl> - - run : yarn <nl> - - run : yarn bootstrap <nl> - - run : yarn lint <nl> - - run : yarn build - - if - present <nl> - - run : yarn test <nl> + <nl> + - name : Install dependencies <nl> + run : yarn install - - frozen - lockfile & & yarn bootstrap <nl> + <nl> + - name : Lint types and code <nl> + run : yarn lint <nl> + <nl> + - name : Build packages <nl> + run : yarn build <nl> + <nl> + - name : Run tests <nl> + run : yarn test <nl> env : <nl> CI : true <nl> \ No newline at end of file <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> on : <nl> push : <nl> - branches : <nl> - - master <nl> paths : <nl> - " packages / * * " <nl> + branches : <nl> + - master <nl> jobs : <nl> release : <nl> @ @ - 28 , 10 + 28 , 8 @ @ jobs : <nl> node - version : 12 . x <nl> - name : Install dependencies <nl> - run : yarn <nl> + run : yarn install - - frozen - lockfile & & yarn bootstrap <nl> - - name : Bootstrap <nl> - run : yarn bootstrap <nl> - name : Linting <nl> run : yarn lint <nl> @ @ - 46 , 8 + 44 , 8 @ @ jobs : <nl> - name : Setup CI Git User <nl> run : | <nl> - git config - - global user . email " jbakebwa @ gmail . com " <nl> git config - - global user . name " codebender828 " <nl> + git config - - global user . email " jbakebwa @ 163 . com " <nl> - name : Publish packages <nl> uses : changesets / action @ master <nl> 
mmm a / . changeset / config . json <nl> ppp b / . changeset / config . json <nl> - " $ schema " : " https : / / unpkg . com / @ changesets / config @ 1 . 1 . 0 / schema . json " , <nl> - " changelog " : " @ changesets / cli / changelog " , <nl> + " $ schema " : " https : / / unpkg . com / @ changesets / config @ 1 . 4 . 0 / schema . json " , <nl> + " changelog " : [ <nl> + " @ changesets / changelog - github " , <nl> + { " repo " : " chakra - ui / chakra - ui - vue " } <nl> + ] , <nl> " commit " : false , <nl> " linked " : [ ] , <nl> " access " : " restricted " , <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> node - version : 12 . x <nl> - name : Install dependencies <nl> - run : yarn install - - frozen - lockfile & & yarn bootstrap <nl> + run : yarn install <nl> + - name : Bootstrap <nl> + run : yarn bootstrap <nl> - name : Linting <nl> run : yarn lint <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> uses : changesets / action @ master <nl> with : <nl> publish : yarn release <nl> + title : " chore ( release ) : version packages " <nl> commit : " chore ( release ) : version packages " <nl> env : <nl> NPM_TOKEN : $ { { secrets . NPM_TOKEN } } <nl> 
mmm a / . github / workflows / test . yml <nl> ppp b / . github / workflows / test . yml <nl> - name : Install Node dependencies <nl> run : yarn - - frozen - lockfile <nl> - - run : yarn test <nl> + - name : Run tests <nl> + run : yarn lerna run test <nl> + <nl> + - name : Lint <nl> + run : yarn lint <nl> 
mmm a / . github / workflows / test . yml <nl> ppp b / . github / workflows / test . yml <nl> - on : [ push ] <nl> + on : [ push , pull_request ] <nl> jobs : <nl> test : <nl> @ @ - 12 , 6 + 12 , 10 @ @ jobs : <nl> name : Node $ { { matrix . node } } <nl> + # We want to run on external PRs , but not on our own internal PRs as they ' ll be run <nl> + # by the push to the branch . <nl> + if : github . event_name = = ' push ' | | github . event . pull_request . head . repo . full_name ! = github . repository <nl> + <nl> steps : <nl> - uses : actions / checkout @ v2 <nl> 
mmm a / . github / workflows / test . yml <nl> ppp b / . github / workflows / test . yml <nl> - name : Install Canvas and XML dependencies <nl> run : sudo apt - get install - y libcairo2 - dev libpango1 . 0 - dev libxml2 - utils <nl> - - name : Get Yarn cache directory path <nl> - id : yarn - cache - dir - path <nl> - run : echo " : : set - output name = dir : : $ ( yarn cache dir ) " <nl> - <nl> - - uses : actions / cache @ v1 <nl> - id : yarn - cache # use this to check for ` cache - hit ` ( ` steps . yarn - cache . outputs . cache - hit ! = ' true ' ` ) <nl> - with : <nl> - path : $ { { steps . yarn - cache - dir - path . outputs . dir } } <nl> - key : $ { { runner . os } } - yarn - $ { { hashFiles ( ' * * / yarn . lock ' ) } } <nl> - restore - keys : | <nl> - $ { { runner . os } } - yarn - <nl> - <nl> - name : Setup Node $ { { matrix . node } } <nl> uses : actions / setup - node @ v1 <nl> with : <nl> 
mmm a / . github / workflows / test . yml <nl> ppp b / . github / workflows / test . yml <nl> - on : [ push , pull_request ] <nl> + on : <nl> + push : <nl> + branches : <nl> + - master <nl> + pull_request : <nl> jobs : <nl> test : <nl> @ @ - 12 , 10 + 16 , 6 @ @ jobs : <nl> name : Node $ { { matrix . node } } <nl> - # We want to run on external PRs , but not on our own internal PRs as they ' ll be run <nl> - # by the push to the branch . <nl> - if : github . event_name = = ' push ' | | github . event . pull_request . head . repo . full_name ! = github . repository <nl> - <nl> steps : <nl> - uses : actions / checkout @ v2 <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> docker : <nl> - image : circleci / node : 14 - browsers <nl> auth : * docker - pull - creds <nl> - - image : circleci / mysql : 5 . 7 <nl> + - image : circleci / mysql : 5 . 7 . 32 <nl> auth : * docker - pull - creds <nl> environment : <nl> MYSQL_DATABASE : circle_test <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> fi <nl> else <nl> echo ' export DOCKER_IMAGE_TAGS = ( $ CIRCLE_TAG latest ) ' > > $ BASH_ENV <nl> + echo ' export DOCKER_BUILD_DEPRECATED = " true " ' > > $ BASH_ENV <nl> fi <nl> - run : <nl> name : Download and import signing key <nl> @ @ - 205 , 7 + 206 , 9 @ @ jobs : <nl> for tag in " $ { DOCKER_IMAGE_TAGS [ @ ] } " ; do <nl> docker tag offen / offen : local offen / offen : $ tag <nl> + if [ ! - z " $ DOCKER_BUILD_DEPRECATED " ] ; then <nl> docker tag offen / offen : root offen / offen : $ tag - root <nl> + fi <nl> done <nl> - run : <nl> name : Push offen / offen to Docker Hub <nl> @ @ - 213 , 7 + 216 , 9 @ @ jobs : <nl> echo " $ DOCKER_ACCESSTOKEN " | docker login - - username $ DOCKER_LOGIN - - password - stdin <nl> for tag in " $ { DOCKER_IMAGE_TAGS [ @ ] } " ; do <nl> docker push offen / offen : $ tag <nl> + if [ ! - z " $ DOCKER_BUILD_DEPRECATED " ] ; then <nl> docker push offen / offen : $ tag - root <nl> + fi <nl> done <nl> - store_artifacts : <nl> path : / tmp / artifacts <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> description : The version of Cypress to use <nl> default : ' 4 . 5 . 0 ' <nl> steps : <nl> + - browser - tools / install - browser - tools <nl> - checkout <nl> - attach_workspace : <nl> at : ~ / offen <nl> - - run : <nl> - name : Install Chrome <nl> - command : | <nl> - wget - q - O - https : / / dl - ssl . google . com / linux / linux_signing_key . pub | sudo apt - key add - <nl> - sudo sh - c ' echo " deb [ arch = amd64 ] http : / / dl . google . com / linux / chrome / deb / stable main " > > / etc / apt / sources . list . d / google . list ' <nl> - sudo apt - get update & & sudo apt - get install - y google - chrome - unstable <nl> - run : <nl> name : Setup application <nl> command : | <nl> @ @ - 409 , 6 + 404 , 7 @ @ commands : <nl> orbs : <nl> docker : circleci / docker @ 1 . 0 . 1 <nl> + browser - tools : circleci / browser - tools @ 1 . 1 . 0 <nl> x - docker - pull - creds : & docker - pull - creds <nl> username : offen <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> command : sudo npm i - g npm @ 6 <nl> orbs : <nl> - docker : circleci / docker @ 1 . 0 . 1 <nl> + docker : circleci / docker @ 2 . 1 . 4 <nl> browser - tools : circleci / browser - tools @ 1 . 1 . 0 <nl> x - docker - pull - creds : & docker - pull - creds <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> docker : <nl> - image : cimg / node : 16 . 13 - browsers <nl> auth : * docker - pull - creds <nl> - - image : circleci / postgres : 11 . 2 - alpine <nl> + - image : cimg / postgres : 15 . 0 <nl> auth : * docker - pull - creds <nl> environment : <nl> POSTGRES_USER : circle <nl> @ @ - 426 , 7 + 426 , 7 @ @ executors : <nl> docker : <nl> - image : cimg / node : 16 . 13 - browsers <nl> auth : * docker - pull - creds <nl> - - image : circleci / mysql : 5 . 7 . 32 <nl> + - image : cimg / mysql : 5 . 7 . 38 <nl> auth : * docker - pull - creds <nl> environment : <nl> MYSQL_DATABASE : circle_test <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> DOCKER_LOGIN : offen <nl> DOCKER_BUILDKIT : ' 1 ' <nl> DOCKER_CLI_EXPERIMENTAL : enabled <nl> - MINIO_STORAGE : https : / / storage . offen . dev <nl> working_directory : ~ / offen <nl> steps : <nl> - checkout <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " codecov . io " : " ^ 0 . 1 . 6 " , <nl> " commitizen " : " ^ 2 . 8 . 6 " , <nl> + " condition - circle " : " ^ 1 . 5 . 0 " , <nl> " conventional - commit - types " : " ^ 2 . 1 . 0 " , <nl> " copy - webpack - plugin " : " ^ 1 . 1 . 1 " , <nl> " cz - conventional - changelog " : " ^ 1 . 2 . 0 " , <nl> " validate - commit - msg " : { <nl> " helpMessage " : " This project is commitizen - friendly . \ nLearn more at https : / / commitizen . github . io / cz - cli / https : / / commitizen . github . io / cz - cli / \ nTo try again , you can say \ " git commit - t . git / COMMIT_EDITMSG \ " . \ nOr , you can use git - cz to make your commits . " <nl> } <nl> + } , <nl> + " release " : { <nl> + " verifyConditions " : " condition - circle " <nl> } <nl> } <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> compile : <nl> override : <nl> + # Build Candela and " install " it as a node module . <nl> - npm run build <nl> + - rm - rf node_modules / candela <nl> + - npm install <nl> + <nl> + # Build the examples . <nl> - npm run build : examples <nl> + <nl> + # Build the unit test and coverage test bundles . <nl> - npm run build : test : unit <nl> - npm run build : test : coverage <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> compile : <nl> override : <nl> - # Build Candela and " install " it as a node module . <nl> + # Build Candela . <nl> - npm run build <nl> - - rm - rf node_modules / candela <nl> - - npm install <nl> # Build the examples . <nl> - npm run build : examples <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " docs " : " http - server build / docs - p $ { PORT - 3000 } " , <nl> " commit " : " git - cz " , <nl> - " semantic - release " : " semantic - release pre & & npm publish & & semantic - release post " , <nl> + " semantic - release " : " semantic - release pre - - debug & & npm publish & & semantic - release post - - debug " , <nl> " commitmsg " : " validate - commit - msg " <nl> } , <nl> " semistandard " : { <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> # Install flake8 for Python linting . <nl> - sudo pip install flake8 <nl> + # Install Lerna globally . <nl> + - sudo npm install - g lerna @ 2 . 10 . 2 <nl> + <nl> # Inject npm token into environment . <nl> - echo " / / registry . npmjs . org / : _authToken = $ NPM_TOKEN " > > ~ / . npmrc <nl> - cache_directories : <nl> - - node_modules <nl> - <nl> compile : <nl> override : <nl> # Build Candela . <nl> @ @ - 26 , 8 + 26 , 8 @ @ compile : <nl> - npm run build : examples <nl> # Build the unit test and coverage test bundles . <nl> - - npm run build : test : unit <nl> - - npm run build : test : coverage <nl> + - npm run build : test <nl> + - npm run build : coverage <nl> test : <nl> override : <nl> @ @ - 45 , 19 + 45 , 18 @ @ test : <nl> # Coverage tests . <nl> - npm run test : coverage <nl> - - npm run test : coverage : codecov <nl> post : <nl> # Gather up the testing images as build artifacts . <nl> - mkdir $ CIRCLE_ARTIFACTS / test_images <nl> - - find plugins - name ' * . png ' | xargs - I xxx cp xxx $ CIRCLE_ARTIFACTS / test_images <nl> + - find packages / examples / test - name ' * . png ' | xargs - I xxx cp xxx $ CIRCLE_ARTIFACTS / test_images <nl> # Copy the html coverage report to the artifacts directory as well . <nl> - mkdir $ CIRCLE_ARTIFACTS / coverage <nl> - cp - r build / coverage / html $ CIRCLE_ARTIFACTS / coverage <nl> deployment : <nl> - semantic - release : <nl> + lerna - publish : <nl> branch : master <nl> commands : <nl> - - DEBUG = condition npm run semantic - release <nl> + - lerna publish - - conventional - commits - - yes <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> - sudo pip install flake8 <nl> # Install Lerna globally . <nl> - - sudo npm install - g lerna @ 2 . 10 . 2 <nl> + - npm install - g lerna @ 2 . 10 . 2 <nl> # Inject npm token into environment . <nl> - echo " / / registry . npmjs . org / : _authToken = $ NPM_TOKEN " > > ~ / . npmrc <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " install " : " lerna bootstrap - - hoist " , <nl> " clean : lerna " : " lerna clean " , <nl> - " clean : dist " : " sh scripts / clean - all " , <nl> - " build " : " sh scripts / build - all " , <nl> + " clean : dist " : " bash scripts / clean - all " , <nl> + " build " : " bash scripts / build - all " , <nl> " build : examples " : " cd packages / examples & & npm run build " , <nl> " examples " : " cd packages / examples & & npm run serve " , <nl> - " build : test " : " sh scripts / build - test " , <nl> - " build : coverage " : " COVERAGE = 1 sh scripts / build - test " , <nl> - " test : unit " : " sh scripts / run - test " , <nl> + " build : test " : " bash scripts / build - test " , <nl> + " build : coverage " : " COVERAGE = 1 bash scripts / build - test " , <nl> + " test : unit " : " bash scripts / run - test " , <nl> " test : image " : " cd packages / examples & & npm test " , <nl> - " test : coverage " : " COVERAGE = 1 sh scripts / run - test " , <nl> + " test : coverage " : " COVERAGE = 1 bash scripts / run - test " , <nl> " coverage : report " : " http - server build / coverage / html - p $ { PORT - 3000 } " , <nl> " build : docs " : " sphinx - build - a - b html docs / build / docs / " , <nl> - " lint " : " sh scripts / run - lint " , <nl> + " lint " : " bash scripts / run - lint " , <nl> " lint : pycandela " : " flake8 - - config python / pycandela / flake8 . cfg python / pycandela " , <nl> " docs " : " http - server build / docs - p $ { PORT - 3000 } " , <nl> " commit " : " git - cz " , <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> compile : <nl> override : <nl> - # Build Candela . <nl> + # Build Candela and the examples . <nl> - npm run build <nl> - # Build the examples . <nl> - - npm run build : examples <nl> - <nl> # Build the unit test and coverage test bundles . <nl> - npm run build : test <nl> - npm run build : coverage <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " examples " : " cd packages / examples & & npm run serve " , <nl> " build : test " : " lerna run build : test " , <nl> - " build : coverage " : " COVERAGE = 1 bash scripts / build - test " , <nl> + " build : coverage " : " COVERAGE = 1 npm run build : test " , <nl> " test : unit " : " lerna run test - - ignore @ candela / examples " , <nl> " test : image " : " cd packages / examples & & npm test " , <nl> " test : coverage " : " COVERAGE = 1 npm run test : unit " , <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> # Build the examples package . <nl> - npm run build : examples <nl> + # Build the big bundle . <nl> + - npm run build : bundle <nl> + <nl> # Build the unit test and coverage test bundles . <nl> - npm run build : test <nl> - npm run build : coverage <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> compile : <nl> override : <nl> # Build Candela . <nl> - - npm run build <nl> + - npm run build : prod <nl> # Build the examples package . <nl> - npm run build : examples <nl> # Build the big bundle . <nl> - - npm run build : bundle <nl> + - npm run build : bundle : prod <nl> # Build the JupyterLab extension ( which depends on @ candela / all from the <nl> # previous step ) . <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> strategy : <nl> matrix : <nl> node - version : [ 12 . x , 14 . x ] <nl> + <nl> steps : <nl> - uses : actions / checkout @ v2 <nl> with : <nl> fetch - depth : 1 <nl> + <nl> - name : Use Node . js $ { { matrix . node - version } } <nl> uses : actions / setup - node @ v1 <nl> with : <nl> node - version : $ { { matrix . node - version } } <nl> + <nl> + - uses : actions / cache @ v3 <nl> + id : gittar - cache <nl> + with : <nl> + path : ~ / . gittar <nl> + key : $ { { runner . os } } - gittar <nl> + <nl> - name : Get yarn cache directory path <nl> id : yarn - cache - dir - path <nl> run : echo " : : set - output name = dir : : $ ( yarn cache dir ) " <nl> - - uses : actions / cache @ v1 <nl> - id : yarn - cache # use this to check for ` cache - hit ` ( ` steps . yarn - cache . outputs . cache - hit ! = ' true ' ` ) <nl> + - uses : actions / cache @ v3 <nl> + id : yarn - cache <nl> with : <nl> path : $ { { steps . yarn - cache - dir - path . outputs . dir } } <nl> key : $ { { runner . os } } - yarn - $ { { hashFiles ( ' * * / yarn . lock ' ) } } <nl> restore - keys : $ { { runner . os } } - yarn - <nl> + <nl> - run : yarn install - - frozen - lockfile <nl> - name : test <nl> env : <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> branches : <nl> - master <nl> - next <nl> - - staging <nl> - - trying <nl> pull_request : <nl> branches : <nl> - master <nl> @ @ - 31 , 6 + 29 , 13 @ @ jobs : <nl> with : <nl> node - version : $ { { matrix . node - version } } <nl> + - uses : dorny / paths - filter @ v2 <nl> + id : filter <nl> + with : <nl> + filters : | <nl> + cli : <nl> + - ' packages / cli / * * ' <nl> + <nl> - uses : actions / cache @ v3 <nl> id : gittar - cache <nl> with : <nl> @ @ - 48 , 19 + 53 , 11 @ @ jobs : <nl> restore - keys : $ { { runner . os } } - yarn - <nl> - run : yarn install - - frozen - lockfile <nl> - - name : test <nl> + <nl> + - name : test : cli <nl> + if : steps . filter . outputs . cli = = ' true ' <nl> env : <nl> CI : true <nl> WITH_LOG : true <nl> LIGHTHOUSE_CHROMIUM_PATH : ' which google - chrome - stable ' <nl> - run : npm run test <nl> - <nl> - ci - success : <nl> - name : ci <nl> - if : $ { { success ( ) } } <nl> - needs : <nl> - - test <nl> - runs - on : ubuntu - latest <nl> - steps : <nl> - - name : CI succeeded <nl> - run : exit 0 <nl> + run : yarn test : cli <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> node_js : <nl> - - " 7 " <nl> + - " 8 " <nl> + - " 9 " <nl> install : <nl> - npm install - g codecov <nl> - - " npm install " <nl> + - npm install <nl> script : <nl> - - " npm run server_dev & npm run test " <nl> + - npm run test <nl> after_script : <nl> - codecov <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> - uses : actions / checkout @ v2 <nl> - name : Install modules <nl> run : yarn <nl> + - name : Run Lint <nl> + run : yarn lint <nl> - name : Run tests <nl> run : yarn test : unit <nl> - <nl> + - name : Pre Deploy test <nl> + run : yarn deploy : build <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> # A workflow run is made up of one or more jobs that can run sequentially or in parallel <nl> jobs : <nl> # This workflow contains a single job called " build " <nl> - build : <nl> + Lint : <nl> # The type of runner that the job will run on <nl> runs - on : ubuntu - latest <nl> - <nl> # Steps represent a sequence of tasks that will be executed as part of the job <nl> steps : <nl> - uses : actions / checkout @ v2 <nl> @ @ - 24 , 7 + 23 , 23 @ @ jobs : <nl> run : yarn <nl> - name : Run Lint <nl> run : yarn lint <nl> + UnitTest : <nl> + # The type of runner that the job will run on <nl> + runs - on : ubuntu - latest <nl> + # Steps represent a sequence of tasks that will be executed as part of the job <nl> + steps : <nl> + - uses : actions / checkout @ v2 <nl> + - name : Install modules <nl> + run : yarn <nl> - name : Run tests <nl> run : yarn test : unit <nl> + PreBuild : <nl> + # The type of runner that the job will run on <nl> + runs - on : ubuntu - latest <nl> + # Steps represent a sequence of tasks that will be executed as part of the job <nl> + steps : <nl> + - uses : actions / checkout @ v2 <nl> + - name : Install modules <nl> + run : yarn <nl> - name : Pre Deploy test <nl> run : yarn build : ci <nl> \ No newline at end of file <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build : utils " : " cross - env BABEL_ENV = utils babel src - - out - dir lib - - ignore src / index . js " , <nl> " build : umd " : " node build / bin / build - locale . js " , <nl> - " build : ci " : " npm run build : file & & cross - env NODE_ENV = development webpack - dev - server - - config build / webpack . demo . js " , <nl> + " build : ci " : " npm run build : file & & cross - env NODE_ENV = development webpack - - config build / webpack . demo . js " , <nl> " clean " : " rimraf lib & & rimraf packages / * / lib & & rimraf test / * * / coverage " , <nl> " deploy : build " : " npm run build : file & & cross - env NODE_ENV = production webpack - - config build / webpack . demo . js & & echo element . eleme . io > > examples / element - ui / CNAME " , <nl> " deploy : extension " : " cross - env NODE_ENV = production webpack - - config build / webpack . extension . js " , <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> steps : <nl> - uses : actions / checkout @ v2 <nl> - name : Install modules <nl> - run : yarn <nl> + run : npm i <nl> - name : Pre Deploy test <nl> - run : yarn build : docs <nl> \ No newline at end of file <nl> + run : npm run build : docs <nl> 
mmm a / scripts / verifyCommit . js <nl> ppp b / scripts / verifyCommit . js <nl> const mergeRE = / ^ Merge pull request / <nl> if ( ! commitRE . test ( msg ) ) { <nl> if ( ! mergeRE . test ( msg ) ) { <nl> + console . log ( msg ) <nl> console . error ( <nl> ` $ { chalk . bgRed . white ( ' ERROR ' ) } $ { chalk . red ( <nl> ` invalid commit message format . ` <nl> 
mmm a / scripts / verifyCommit . js <nl> ppp b / scripts / verifyCommit . js <nl> const msg = require ( ' fs ' ) . readFileSync ( msgPath , ' utf - 8 ' ) . trim ( ) <nl> const commitRE = / ^ ( revert : ) ? ( feat | fix | docs | dx | style | refactor | perf | test | workflow | build | ci | chore | types | wip | release ) ( \ ( . + \ ) ) ? ( . { 1 , 10 } ) ? : . { 1 , 50 } / <nl> - const mergeRE = / ^ Merge pull request / <nl> + const mergeRe = / ^ ( Merge pull request | Merge branch ) / <nl> + <nl> if ( ! commitRE . test ( msg ) ) { <nl> - if ( ! mergeRE . test ( msg ) ) { <nl> + if ( ! mergeRe . test ( msg ) ) { <nl> console . log ( msg ) <nl> console . error ( <nl> ` $ { chalk . bgRed . white ( ' ERROR ' ) } $ { chalk . red ( <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> # Controls when the action will run . Triggers the workflow on push or pull request <nl> - # events but only for the next branch <nl> + # events but only for the master branch <nl> on : <nl> push : <nl> branches : [ next ] <nl> @ @ - 13 , 21 + 13 , 23 @ @ on : <nl> # A workflow run is made up of one or more jobs that can run sequentially or in parallel <nl> jobs : <nl> # This workflow contains a single job called " build " <nl> - <nl> - <nl> Lint : <nl> # The type of runner that the job will run on <nl> runs - on : ubuntu - latest <nl> # Steps represent a sequence of tasks that will be executed as part of the job <nl> steps : <nl> - - name : Install pnpm <nl> - uses : pnpm / action - setup @ v2 . 0 . 1 <nl> - id : pnpm - install <nl> - with : <nl> - version : 7 <nl> + - uses : actions / checkout @ v2 <nl> - name : Install modules <nl> - run : pnpm i <nl> + run : npm i <nl> - name : Run Lint <nl> - run : pnpm run lint <nl> - - name : Unit Test <nl> - run : pnpm run test : once <nl> + run : npm run lint <nl> + UnitTest : <nl> + # The type of runner that the job will run on <nl> + runs - on : ubuntu - latest <nl> + # Steps represent a sequence of tasks that will be executed as part of the job <nl> + steps : <nl> + - uses : actions / checkout @ v2 <nl> + - name : Install modules <nl> + run : npm i <nl> + - name : Run tests <nl> + run : npm run test : lint <nl> \ No newline at end of file <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> - name : Install modules <nl> run : npm i <nl> - name : Run tests <nl> - run : npm run test : lint <nl> \ No newline at end of file <nl> + run : npm run test : once <nl> \ No newline at end of file <nl> 
mmm a / . github / workflows / main . yml <nl> ppp b / . github / workflows / main . yml <nl> run : npm i <nl> - name : Run Lint <nl> run : npm run lint <nl> - UnitTest : <nl> - # The type of runner that the job will run on <nl> - runs - on : ubuntu - latest <nl> - # Steps represent a sequence of tasks that will be executed as part of the job <nl> - steps : <nl> - - uses : actions / checkout @ v2 <nl> - - name : Install modules <nl> - run : npm i <nl> - - name : Run tests <nl> + - name : unittest <nl> run : npm run test : once <nl> + - name : typecheck <nl> + run : npm run typecheck <nl> 
mmm a / azure - pipelines . yml <nl> ppp b / azure - pipelines . yml <nl> steps : <nl> - task : NodeTool @ 0 <nl> inputs : <nl> - version : $ ( node_version ) <nl> + versionSpec : $ ( node_version ) <nl> displayName : ' Install Node . js ' <nl> - script : | <nl> npm install <nl> - npm run test <nl> + npm test <nl> displayName : ' npm install and test ' <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " clean : modules " : " npx rimraf node_modules " , <nl> " commit " : " git - cz " , <nl> - " postinstall " : " lerna bootstrap - - hoist " , <nl> + " postinstall " : " lerna bootstrap - - no - ci - - hoist " , <nl> " test " : " lerna run test - - parallel " , <nl> " lint " : " lerna run lint - - parallel " , <nl> " lint : md " : " markdownlint . / readme . md . / . github " <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> node_js : <nl> - ' 8 ' <nl> - ' 10 ' <nl> + addons : <nl> + apt : <nl> + packages : <nl> + # Ubuntu 16 + does not install this dependency by default , so we need to install it ourselves <nl> + - libgconf - 2 - 4 <nl> services : <nl> - docker <nl> # # Prevent from verbose install log caused by cypress installation <nl> env : <nl> - CI = true <nl> - # # Cache NPM folder and cypress binary <nl> cache : <nl> + # Caches $ HOME / . npm when npm ci is default script command <nl> + # Caches node_modules in all other cases <nl> + npm : true <nl> directories : <nl> - - ~ / . npm <nl> + # we also need to cache folder with Cypress binary <nl> - ~ / . cache <nl> install : <nl> - npm ci <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> with : <nl> node - version : $ { { matrix . node - version } } <nl> - - name : Use latest NPM on ubuntu / macos <nl> - if : matrix . platform = = ' ubuntu - latest ' | | matrix . platform = = ' macos - latest ' <nl> - run : sudo npm i - g npm <nl> - <nl> - - name : Use latest NPM on windows <nl> - if : matrix . platform = = ' windows - latest ' <nl> - run : npm i - g npm <nl> - <nl> - name : Install dependencies <nl> run : npm ci <nl> 
mmm a / contracts / token / ERC1155 / README . adoc <nl> ppp b / contracts / token / ERC1155 / README . adoc <nl> The EIP consists of three interfaces which fulfill different roles , found here as ` IERC1155 ` , ` IERC1155MetadataURI ` and ` IERC1155Receiver ` . <nl> - ` ERC1155 ` implement the mandatory ` IERC1155 ` interface , as well as the optional extension ` IERC1155MetadataURI ` by relying on the substition mechanism to use the same URI for all token types , dramatically reducing gas costs . <nl> + ` ERC1155 ` implements the mandatory ` IERC1155 ` interface , as well as the optional extension ` IERC1155MetadataURI ` , by relying on the substitution mechanism to use the same URI for all token types , dramatically reducing gas costs . <nl> ` ERC1155Holder ` implements the ` IERC1155Receiver ` interface for contracts that can receive ( and hold ) ERC1155 tokens . <nl> 
mmm a / docs / modules / ROOT / pages / erc1155 . adoc <nl> ppp b / docs / modules / ROOT / pages / erc1155 . adoc <nl> / / SPDX - License - Identifier : MIT <nl> pragma solidity ^ 0 . 8 . 0 ; <nl> - import " @ openzeppelin / contracts / token / ERC1155 / ERC1155Holder . sol " ; <nl> + import " @ openzeppelin / contracts / token / ERC1155 / utils / ERC1155Holder . sol " ; <nl> contract MyContract is ERC1155Holder { <nl> } <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> The answer is simple , but possibly frustrating . I ' m not saying ( how I pronounce it ) . It ' s up to you to call it as you like . All answers are correct : ) <nl> + # # Design principles <nl> + <nl> + - Less flags is better <nl> + - Works across all platforms <nl> + - Less features <nl> + - Let individuals build on top of nodemon <nl> + - Offer all CLI functionality as an API <nl> + - Contributions must have and pass tests <nl> + <nl> + Nodemon is not perfect , and CLI arguments has sprawled beyond where I ' m completely happy , but perhaps it can be pulled back a little . <nl> + <nl> # # FAQ <nl> See the [ FAQ ] ( https : / / github . com / remy / nodemon / blob / master / faq . md ) and please add your own questions if you think they would help others . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # Application isn ' t restarting <nl> - In some networked environments ( such as a container running nodemon reading across a mounted drive ) , you will need to use the ` legacyWatch : true ` which enabled Chokidar ' s polling . <nl> + In some networked environments ( such as a container running nodemon reading across a mounted drive ) , you will need to use the ` legacyWatch : true ` which enables Chokidar ' s polling . <nl> Via the CLI , use either ` - - legacy - watch ` or ` - L ` for short : <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> On Ubuntu globally installed node applications have been found to have no output when they ' re run . This * seems * to be an issue with node not being correctly installed ( possibly linked to the binary having to be called ` nodejs ` ) . <nl> The solution ( that ' s worked in the past ) is to install [ nvm ] ( https : / / github . com / creationix / nvm ) first and using it to install node , * rather * than using ` apt - get ` ( or similar tools ) to install node directly . <nl> + <nl> + # # If nodemon is facing the watch errors <nl> + execute ' echo fs . inotify . max_user_watches = 582222 | sudo tee - a / etc / sysctl . conf & & sudo sysctl - p ' command on terminal <nl> + <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> npm install - - save - dev nodemon <nl> - With a local installation , nodemon will not be available in your system path . Instead , the local installation of nodemon can be run by calling it from within an npm script ( such as ` npm start ` ) . Additionally , the ` npm bin ` command can be used to obtain the path to the project ' s local ` . bin ` directory . <nl> + With a local installation , nodemon will not be available in your system path . Instead , the local installation of nodemon can be run by calling it from within an npm script ( such as ` npm start ` ) or using ` npx nodemon ` . <nl> # Usage <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> The solution ( that ' s worked in the past ) is to install [ nvm ] ( https : / / github . com / creationix / nvm ) first and using it to install node , * rather * than using ` apt - get ` ( or similar tools ) to install node directly . <nl> - # # If nodemon is facing the watch errors <nl> - execute ' echo fs . inotify . max_user_watches = 582222 | sudo tee - a / etc / sysctl . conf & & sudo sysctl - p ' command on terminal <nl> + # # If nodemon is facing the watch errors ( mac ) <nl> + <nl> + Try the following command on terminal : <nl> + <nl> + ` ` ` bash <nl> + echo fs . inotify . max_user_watches = 582222 | sudo tee - a / etc / sysctl . conf & & sudo sysctl - p <nl> + ` ` ` <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - < a href = " https : / / app . codesponsor . io / link / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon " rel = " nofollow " > < img src = " https : / / app . codesponsor . io / embed / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon . svg " style = " width : 888px ; height : 68px ; " alt = " Sponsor " / > < / a > <nl> - <nl> For use during development of a node . js based application . <nl> nodemon will watch the files in the directory in which nodemon was started , and if any files change , nodemon will automatically restart your node application . <nl> @ @ - 291 , 3 + 289 , 5 @ @ See the [ FAQ ] ( https : / / github . com / remy / nodemon / blob / master / faq . md ) and please add <nl> # License <nl> MIT [ http : / / rem . mit - license . org ] ( http : / / rem . mit - license . org ) <nl> + <nl> + < a href = " https : / / app . codesponsor . io / link / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon " rel = " nofollow " target = " _blank " > < img src = " https : / / app . codesponsor . io / embed / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon . svg " style = " width : 888px ; height : 68px ; " alt = " Sponsor " / > < / a > <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> The solution ( that ' s worked in the past ) is to install [ nvm ] ( https : / / github . com / creationix / nvm ) first and using it to install node , * rather * than using ` apt - get ` ( or similar tools ) to install node directly . <nl> - # # If nodemon is facing the watch errors ( mac ) <nl> + # # If nodemon is facing the watch errors ( Mac & Linux ) <nl> Try the following command on terminal : <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> [ ! [ NPM version ] ( https : / / badge . fury . io / js / nodemon . svg ) ] ( https : / / npmjs . org / package / nodemon ) <nl> [ ! [ Travis Status ] ( https : / / travis - ci . org / remy / nodemon . svg ? branch = master ) ] ( https : / / travis - ci . org / remy / nodemon ) <nl> + < a href = " https : / / app . codesponsor . io / link / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon " rel = " nofollow " target = " _blank " > < img src = " https : / / app . codesponsor . io / embed / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon . svg " style = " width : 888px ; height : 68px ; " alt = " Sponsor " / > < / a > <nl> + <nl> # Installation <nl> Either through cloning with git or by using [ npm ] ( http : / / npmjs . org ) ( the recommended way ) : <nl> @ @ - 289 , 5 + 291 , 3 @ @ See the [ FAQ ] ( https : / / github . com / remy / nodemon / blob / master / faq . md ) and please add <nl> # License <nl> MIT [ http : / / rem . mit - license . org ] ( http : / / rem . mit - license . org ) <nl> - <nl> - < a href = " https : / / app . codesponsor . io / link / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon " rel = " nofollow " target = " _blank " > < img src = " https : / / app . codesponsor . io / embed / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon . svg " style = " width : 888px ; height : 68px ; " alt = " Sponsor " / > < / a > <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> 9 Dec 23 : 52 : 58 - [ nodemon ] starting ` node . / app . js fixtures / sigint . js ` <nl> ` ` ` <nl> - This is because the main script argument ( ` fixtures / sigint . js ` in this case ) wasn ' t found , and a ` package . json ` ' s main file * was * found . ie . to solve , double check the path to your script is correct . <nl> + This is because the main script argument ( ` fixtures / sigint . js ` in this case ) wasn ' t found , and a ` package . json ` ' s main file _was_ found . ie . to solve , double check the path to your script is correct . <nl> # # What has precedence , ignore or watch ? <nl> @ @ - 106 , 10 + 106 , 10 @ @ sudo ln - s / usr / bin / nodejs / usr / local / bin / node <nl> Fedora and Ubuntu pakage node as nodejs , because node . dpkg is <nl> > Description - en : Amateur Packet Radio Node program <nl> - The node program accepts TCP / IP and packet radio network connections and <nl> - presents users with an interface that allows them to make gateway connections <nl> - to remote hosts using a variety of amateur radio protocols . <nl> - They make the binary is nodejs , rather than node . So long as you ' re not using that Packet Radio Node Program mentioned above the workaround will work . <nl> + > The node program accepts TCP / IP and packet radio network connections and <nl> + > presents users with an interface that allows them to make gateway connections <nl> + > to remote hosts using a variety of amateur radio protocols . <nl> + > They make the binary is nodejs , rather than node . So long as you ' re not using that Packet Radio Node Program mentioned above the workaround will work . <nl> Thank you [ @ EvanCarroll ] ( https : / / github . com / remy / nodemon / issues / 68 # issuecomment - 13672509 ) <nl> @ @ - 138 , 7 + 138 , 7 @ @ forever stop foo <nl> This will stop both nodemon and the node process it was monitoring . <nl> - Note that I * would not * recommend using nodemon in a production environment - but that ' s because I wouldn ' t want it restart without my explicit instruction . <nl> + Note that I _would not_ recommend using nodemon in a production environment - but that ' s because I wouldn ' t want it restart without my explicit instruction . <nl> # # What does " verbose " give me ? <nl> @ @ - 146 , 10 + 146 , 10 @ @ The ` - - verbose ` ( or ` - V ` ) puts nodemon in verbose mode which adds some detail to <nl> Additional restart information : <nl> - - Which nodemon configs are loaded ( local and global if found ) <nl> - - Which ignore rules are being applied <nl> - - Which file extensions are being watch <nl> - - The process ID of your application ( the ` child pid ` ) <nl> + * Which nodemon configs are loaded ( local and global if found ) <nl> + * Which ignore rules are being applied <nl> + * Which file extensions are being watch <nl> + * The process ID of your application ( the ` child pid ` ) <nl> For example : <nl> @ @ - 166 , 10 + 166 , 10 @ @ For example : <nl> When nodemon detects a change , the following addition information is shown : <nl> - - Which file ( s ) triggered the check <nl> - - Which ( if any ) rules the file matched to cause a subsequent restart <nl> - - How many rules were matched and out of those rules , how many cause a restart <nl> - - A list of all the files that * successfully * caused a restart <nl> + * Which file ( s ) triggered the check <nl> + * Which ( if any ) rules the file matched to cause a subsequent restart <nl> + * How many rules were matched and out of those rules , how many cause a restart <nl> + * A list of all the files that _successfully_ caused a restart <nl> For example , on ` lib / app . js ` being changed : <nl> @ @ - 192 , 9 + 192 , 9 @ @ Note that if you have a ` nodemon . json ` in your ` $ HOME ` path , then this will also <nl> # # nodemon does nothing <nl> - On Ubuntu globally installed node applications have been found to have no output when they ' re run . This * seems * to be an issue with node not being correctly installed ( possibly linked to the binary having to be called ` nodejs ` ) . <nl> + On Ubuntu globally installed node applications have been found to have no output when they ' re run . This _seems_ to be an issue with node not being correctly installed ( possibly linked to the binary having to be called ` nodejs ` ) . <nl> - The solution ( that ' s worked in the past ) is to install [ nvm ] ( https : / / github . com / creationix / nvm ) first and using it to install node , * rather * than using ` apt - get ` ( or similar tools ) to install node directly . <nl> + The solution ( that ' s worked in the past ) is to install [ nvm ] ( https : / / github . com / creationix / nvm ) first and using it to install node , _rather_ than using ` apt - get ` ( or similar tools ) to install node directly . <nl> # # If nodemon is facing the watch errors ( Mac & Linux ) <nl> @ @ - 204 , 3 + 204 , 15 @ @ Try the following command on terminal : <nl> echo fs . inotify . max_user_watches = 582222 | sudo tee - a / etc / sysctl . conf & & sudo sysctl - p <nl> ` ` ` <nl> + # # Error : Cannot find module ' internal / util / types ' <nl> + <nl> + If you see the error ` Cannot find module ' internal / util / types ' ` , the error is solved with a clean npm cache and trying to reinstall the dependency you ' re working with . <nl> + <nl> + A start is to use the following commands : <nl> + <nl> + ` ` ` <nl> + sudo npm cache clean - - force <nl> + sudo npm i - g npm <nl> + ` ` ` <nl> + <nl> + Otherwise see [ issue # 1124 ] ( https : / / github . com / remy / nodemon / issues / 1124 ) for further suggestions . <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> - Commit messages must follow the [ Angular - style ] ( https : / / github . com / angular / angular . js / blob / master / CONTRIBUTING . md # commit - message - format ) commit format ( but excluding the scope ) . <nl> + Commit messages must follow the [ Angular - style ] ( https : / / github . com / angular / angular . js / blob / master / DEVELOPERS . md # commits ) commit format ( but excluding the scope ) . <nl> i . e : <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> Fedora is looking for ` nodejs ` rather than ` node ` which is the binary that nodemon kicks off . <nl> - The solution is a simple workaround , Linux 101 : <nl> + A workaround is to make sure that ` node ` binary exists in the ` PATH ` : <nl> ` ` ` bash <nl> sudo ln - s / usr / bin / nodejs / usr / local / bin / node <nl> ` ` ` <nl> + Alternatively the ` - - exec nodejs ` option can be used . <nl> + <nl> Fedora and Ubuntu pakage node as nodejs , because node . dpkg is <nl> > Description - en : Amateur Packet Radio Node program <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> [ ! [ NPM version ] ( https : / / badge . fury . io / js / nodemon . svg ) ] ( https : / / npmjs . org / package / nodemon ) <nl> [ ! [ Travis Status ] ( https : / / travis - ci . org / remy / nodemon . svg ? branch = master ) ] ( https : / / travis - ci . org / remy / nodemon ) [ ! [ Backers on Open Collective ] ( https : / / opencollective . com / nodemon / backers / badge . svg ) ] ( # backers ) [ ! [ Sponsors on Open Collective ] ( https : / / opencollective . com / nodemon / sponsors / badge . svg ) ] ( # sponsors ) <nl> - < a href = " https : / / app . codesponsor . io / link / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon " rel = " nofollow " target = " _blank " > < img src = " https : / / app . codesponsor . io / embed / wnz2te8CdfKZ8wMjGUpi8EZG / remy / nodemon . svg " style = " width : 888px ; height : 68px ; " alt = " Sponsor " / > < / a > <nl> - <nl> # Installation <nl> Either through cloning with git or by using [ npm ] ( http : / / npmjs . org ) ( the recommended way ) : <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Either through cloning with git or by using [ npm ] ( http : / / npmjs . org ) ( the recommended way ) : <nl> - ` ` ` <nl> + ` ` ` bash <nl> npm install - g nodemon <nl> ` ` ` <nl> @ @ - 23 , 7 + 23 , 7 @ @ And nodemon will be installed globally to your system path . <nl> You can also install nodemon as a developement dependency : <nl> - ` ` ` <nl> + ` ` ` bash <nl> npm install - - save - dev nodemon <nl> ` ` ` <nl> @ @ - 33 , 19 + 33 , 19 @ @ With a local installation , nodemon will not be available in your system path . In <nl> nodemon wraps your application , so you can pass all the arguments you would normally pass to your app : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon [ your node app ] <nl> ` ` ` <nl> For CLI options , use the ` - h ` ( or ` - - help ` ) argument : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - h <nl> ` ` ` <nl> Using nodemon is simple , if my application accepted a host and port as the arguments , I would start it as so : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon . / server . js localhost 8080 <nl> ` ` ` <nl> @ @ - 55 , 7 + 55 , 7 @ @ If no script is given , nodemon will test for a ` package . json ` file and if found , <nl> You can also pass the ` inspect ` flag to node through the command line as you would normally : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - inspect . / server . js 80 <nl> ` ` ` <nl> @ @ - 129 , 7 + 129 , 7 @ @ Please see [ doc / requireable . md ] ( doc / requireable . md ) <nl> nodemon can also be used to execute and monitor other programs . nodemon will read the file extension of the script being run and monitor that extension instead of . js if there ' s no ` nodemon . json ` : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - exec " python - v " . / app . py <nl> ` ` ` <nl> @ @ - 151 , 7 + 151 , 7 @ @ To add support for nodemon to know about the . pl extension ( for Perl ) , the nodem <nl> Now running the following , nodemon will know to use ` perl ` as the executable : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon script . pl <nl> ` ` ` <nl> @ @ - 161 , 7 + 161 , 7 @ @ It ' s generally recommended to use the global ` nodemon . json ` to add your own ` exe <nl> By default nodemon monitors the current working directory . If you want to take control of that option , use the ` - - watch ` option to add specific paths : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - watch app - - watch libs app / server . js <nl> ` ` ` <nl> @ @ - 173 , 7 + 173 , 7 @ @ Don ' t use unix globbing to pass multiple directories , e . g ` - - watch . / lib / * ` , it <nl> By default , nodemon looks for files with the ` . js ` , ` . mjs ` , ` . coffee ` , ` . litcoffee ` , and ` . json ` extensions . If you use the ` - - exec ` option and monitor ` app . py ` nodemon will monitor files with the extension of ` . py ` . However , you can specify your own list with the ` - e ` ( or ` - - ext ` ) switch like so : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - e js , jade <nl> ` ` ` <nl> @ @ - 185 , 19 + 185 , 19 @ @ By default , nodemon will only restart when a ` . js ` JavaScript file changes . In s <nl> This can be done via the command line : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - ignore lib / - - ignore tests / <nl> ` ` ` <nl> Or specific files can be ignored : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - ignore lib / app . js <nl> ` ` ` <nl> Patterns can also be ignored ( but be sure to quote the arguments ) : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - ignore ' lib / * . js ' <nl> ` ` ` <nl> @ @ - 209 , 7 + 209 , 7 @ @ In some networked environments ( such as a container running nodemon reading acro <nl> Via the CLI , use either ` - - legacy - watch ` or ` - L ` for short : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - L <nl> ` ` ` <nl> @ @ - 221 , 19 + 221 , 19 @ @ In some situations , you may want to wait until a number of files have changed . T <nl> To add an extra throttle , or delay restarting , use the ` - - delay ` command : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - delay 10 server . js <nl> ` ` ` <nl> For more precision , milliseconds can be specified . Either as a float : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - delay 2 . 5 server . js <nl> ` ` ` <nl> Or using the time specifier ( ms ) : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - delay 2500ms server . js <nl> ` ` ` <nl> @ @ - 241 , 7 + 241 , 7 @ @ The delay figure is number of seconds ( or milliseconds , if specified ) to delay b <nl> If you are setting this value in ` nodemon . json ` , the value will always be interpretted in milliseconds . E . g . , the following are equivalent : <nl> - ` ` ` <nl> + ` ` ` bash <nl> nodemon - - delay 2 . 5 <nl> { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> [ < img src = " https : / / nodemon . io / sparkpost . svg " width = " 200 " > ] ( https : / / sparkpo . st / nodemon ) <nl> - [ < img src = " https : / / nodemon . io / minmax . png " width = " 200 " > ] ( https : / / https : / / mixmax . com ) <nl> + [ < img src = " https : / / nodemon . io / mixmax . png " width = " 200 " > ] ( https : / / https : / / mixmax . com ) <nl> # License <nl> 
mmm a / doc / sample - nodemon . md <nl> ppp b / doc / sample - nodemon . md <nl> " env " : { <nl> " NODE_ENV " : " development " <nl> } , <nl> - " ext " : " js json " <nl> + " ext " : " js , json " <nl> } <nl> Note that the ` ignore ` used is nodemon ' s default ignore rule . The complete defaults can be seen here : [ defaults . js ] ( https : / / github . com / remy / nodemon / blob / master / lib / config / defaults . js ) . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> And nodemon will be installed globally to your system path . <nl> - You can also install nodemon as a developement dependency : <nl> + You can also install nodemon as a development dependency : <nl> ` ` ` bash <nl> npm install - - save - dev nodemon <nl> @ @ - 131 , 7 + 131 , 7 @ @ Please see [ doc / events . md ] ( doc / events . md # Using_nodemon_as_child_process ) <nl> # # Running non - node scripts <nl> - nodemon can also be used to execute and monitor other programs . nodemon will read the file extension of the script being run and monitor that extension instead of . js if there ' s no ` nodemon . json ` : <nl> + nodemon can also be used to execute and monitor other programs . nodemon will read the file extension of the script being run and monitor that extension instead of ` . js ` if there ' s no ` nodemon . json ` : <nl> ` ` ` bash <nl> nodemon - - exec " python - v " . / app . py <nl> @ @ - 143 , 7 + 143 , 7 @ @ Now nodemon will run ` app . py ` with python in verbose mode ( note that if you ' re n <nl> Using the ` nodemon . json ` config file , you can define your own default executables using the ` execMap ` property . This is particularly useful if you ' re working with a language that isn ' t supported by default by nodemon . <nl> - To add support for nodemon to know about the . pl extension ( for Perl ) , the nodemon . json file would add : <nl> + To add support for nodemon to know about the ` . pl ` extension ( for Perl ) , the ` nodemon . json ` file would add : <nl> ` ` ` json <nl> { <nl> @ @ - 181 , 7 + 181 , 7 @ @ By default , nodemon looks for files with the ` . js ` , ` . mjs ` , ` . coffee ` , ` . litcoff <nl> nodemon - e js , jade <nl> ` ` ` <nl> - Now nodemon will restart on any changes to files in the directory ( or subdirectories ) with the extensions . js , . jade . <nl> + Now nodemon will restart on any changes to files in the directory ( or subdirectories ) with the extensions ` . js ` , ` . jade ` . <nl> # # Ignoring files <nl> @ @ - 243 , 7 + 243 , 7 @ @ nodemon - - delay 2500ms server . js <nl> The delay figure is number of seconds ( or milliseconds , if specified ) to delay before restarting . So nodemon will only restart your app the given number of seconds after the * last * file change . <nl> - If you are setting this value in ` nodemon . json ` , the value will always be interpretted in milliseconds . E . g . , the following are equivalent : <nl> + If you are setting this value in ` nodemon . json ` , the value will always be interpreted in milliseconds . E . g . , the following are equivalent : <nl> ` ` ` bash <nl> nodemon - - delay 2 . 5 <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> echo fs . inotify . max_user_watches = 582222 | sudo tee - a / etc / sysctl . conf & & sudo sysctl - p <nl> ` ` ` <nl> + # # " Port in use " with - - inspect flag and docker <nl> + <nl> + The workaround is to use [ kill - port ] ( https : / / github . com / tiaanduplessis / kill - port ) to close off the debugger port , used similarly to : <nl> + <nl> + ` ` ` bash <nl> + nodemon - - delay 80ms - - exec ' kill - port - k 9228 / tcp ; node - - inspect = 0 . 0 . 0 . 0 : 9228 . / app / http . js ' <nl> + ` ` ` <nl> + <nl> + [ Original suggestion here ] ( https : / / github . com / remy / nodemon / issues / 1050 # issuecomment - 323680697 ) and [ addition information here ] ( https : / / github . com / remy / nodemon / issues / 1346 # issuecomment - 401218386 ) . <nl> + <nl> + # # Windows : nodemon keeps restarting without changes <nl> + <nl> + This _might_ be related to a Microsoft Windows release pertaining to the OS and breaking ` fsevents ` module ( which is used by [ chokidar ] ( https : / / github . com / paulmillr / chokidar ) - the underlying watch package ) . <nl> + <nl> + The workaround is to run the following command : <nl> + <nl> + ` ` ` bash <nl> + fsutil behavior set disablelastaccess 1 <nl> + ` ` ` <nl> + <nl> + [ Futher reading thread ] ( https : / / github . com / remy / nodemon / issues / 1354 ) <nl> + <nl> # # Error : Cannot find module ' internal / util / types ' <nl> If you see the error ` Cannot find module ' internal / util / types ' ` , the error is solved with a clean npm cache and trying to reinstall the dependency you ' re working with . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - For use during development of a node . js based application . <nl> + nodemon is a tool that helps develop node . js based applications by automatically restarting the node application when file changes in the directory are detected . <nl> - nodemon will watch the files in the directory in which nodemon was started , and if any files change , nodemon will automatically restart your node application . <nl> - <nl> - nodemon does * * not * * require * any * changes to your code or method of development . nodemon wraps your node application and keeps an eye on any files that have changed . Remember that nodemon is a replacement wrapper for ` node ` , think of it as replacing the word " node " on the command line when you run your script . <nl> + nodemon does * * not * * require * any * additional changes to your code or method of development . nodemon is a replacement wrapper for ` node ` , to use ` nodemon ` replace the word ` node ` on the command line when executing your script . <nl> [ ! [ NPM version ] ( https : / / badge . fury . io / js / nodemon . svg ) ] ( https : / / npmjs . org / package / nodemon ) <nl> [ ! [ Travis Status ] ( https : / / travis - ci . org / remy / nodemon . svg ? branch = master ) ] ( https : / / travis - ci . org / remy / nodemon ) [ ! [ Backers on Open Collective ] ( https : / / opencollective . com / nodemon / backers / badge . svg ) ] ( # backers ) [ ! [ Sponsors on Open Collective ] ( https : / / opencollective . com / nodemon / sponsors / badge . svg ) ] ( # sponsors ) <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> # # No automatic restart when using Docker volumes [ issue # 419 ] ( https : / / github . com / remy / nodemon / issues / 419 # issuecomment - 391244911 ) <nl> - Some Node . js Docker images do not seem to have the full suite of filtesystem process utilities that allow ` nodemon ` to restart automatically when the code in a mounted volume changes . To handle this , and enable automatic restarts without using legacy mode , you can install the [ procps ] ( http : / / procps . sourceforge . net ) package . <nl> + Some Node . js Docker images do not seem to have the full suite of filesystem process utilities that allow ` nodemon ` to restart automatically when the code in a mounted volume changes . To handle this , and enable automatic restarts without using legacy mode , you can install the [ procps ] ( http : / / procps . sourceforge . net ) package . <nl> Here ' s an example snippet of a Dockerfile : <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> This is a working document , and if it makes sense , I ' ll take pull requests to help make it better . <nl> + # How to clear the console on restart <nl> + <nl> + Rather than being a ( nother ) feature in nodemon , and as per the [ design principles ] ( https : / / github . com / remy / nodemon # design - principles ) you can clear the console using nodemon ' s existing architecture . <nl> + <nl> + In your ` nodemon . json ` ( or in your ` package . json ` ) you can include the follow event handler to always clear the console when nodemon starts : <nl> + <nl> + ` ` ` json <nl> + { <nl> + " events " : { <nl> + " start " : " node - e console . clear ( ) " <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> # nodemon doesn ' t work with my REPL <nl> Create an nodemon . json file with the setting : <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> } <nl> ` ` ` <nl> + # nodemon doesn ' t restart on . env change <nl> + <nl> + This is an edge case with how nodemon watches files . This is because nodemon doesn ' t know if ` . env ` is a hidden file with no extension or a ` * . env ` without a filename . <nl> + <nl> + Nonetheless , to trigger a change on ` . env ` ( or similar files like ` . bash_profile ` ) , you need to explicitly tell nodemon to watch the file . <nl> + <nl> + However , now nodemon will * only * watch the ` . env ` file , so you need to add to what nodemon is watching , i . e . tell nodemon to _also_ watch the current working directory : <nl> + <nl> + ` ` ` bash <nl> + $ nodemon - - watch . env - - watch app app / index . js <nl> + ` ` ` <nl> + <nl> # nodemon doesn ' t work with my REPL <nl> Create an nodemon . json file with the setting : <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> } <nl> ` ` ` <nl> + # # Gracefully reloading down your script <nl> + <nl> + It is possible to have nodemon send any signal that you specify to your application . <nl> + <nl> + ` ` ` bash <nl> + nodemon - - signal SIGHUP server . js <nl> + ` ` ` <nl> + <nl> + Your application can handle the signal as follows . <nl> + <nl> + ` ` ` js <nl> + process . once ( " SIGHUP " , function ( ) { <nl> + reloadSomeConfiguration ( ) ; <nl> + } ) <nl> + ` ` ` <nl> + <nl> + Please note that nodemon will send this signal to every process in the process tree . <nl> + <nl> + If you are using ` cluster ` , then each workers ( as well as the master ) will receive the signal . If you wish to terminate all workers on receiving a ` SIGHUP ` , a common pattern is to catch the ` SIGHUP ` in the master , and forward ` SIGTERM ` to all workers , while ensuring that all workers ignore ` SIGHUP ` . <nl> + <nl> + ` ` ` js <nl> + if ( cluster . isMaster ) { <nl> + process . on ( " SIGHUP " , function ( ) { <nl> + for ( const worker of Object . values ( cluster . workers ) ) { <nl> + worker . process . kill ( " SIGTERM " ) ; <nl> + } <nl> + } ) ; <nl> + } else { <nl> + process . on ( " SIGHUP " , function ( ) { } ) <nl> + } <nl> + ` ` ` <nl> + <nl> # # Controlling shutdown of your script <nl> nodemon sends a kill signal to your application when it sees a file update . If you need to clean up on shutdown inside your script you can capture the kill signal and handle it yourself . <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> ` ` ` json <nl> { <nl> " events " : { <nl> - " start " : " node - e ' console . clear ( ) ' " <nl> + " start " : " cls | | clear " <nl> } <nl> } <nl> ` ` ` <nl> + Note that on Windows , this will clear the scroll buffer too . If you try to use node to clear the screen , you may have a race condition between the boot time of your process and the start event . This method should be the fastest . <nl> + <nl> # nodemon doesn ' t restart on . env change <nl> This is an edge case with how nodemon watches files . This is because nodemon doesn ' t know if ` . env ` is a hidden file with no extension or a ` * . env ` without a filename . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # Design principles <nl> - - Less flags is better <nl> + - Fewer flags is better <nl> - Works across all platforms <nl> - - Less features <nl> + - Fewer features <nl> - Let individuals build on top of nodemon <nl> - Offer all CLI functionality as an API <nl> - Contributions must have and pass tests <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - nodemon does * * not * * require * any * additional changes to your code or method of development . nodemon is a replacement wrapper for ` node ` , to use ` nodemon ` replace the word ` node ` on the command line when executing your script . <nl> + nodemon does * * not * * require * any * additional changes to your code or method of development . nodemon is a replacement wrapper for ` node ` . To use ` nodemon ` , replace the word ` node ` on the command line when executing your script . <nl> [ ! [ NPM version ] ( https : / / badge . fury . io / js / nodemon . svg ) ] ( https : / / npmjs . org / package / nodemon ) <nl> [ ! [ Travis Status ] ( https : / / travis - ci . org / remy / nodemon . svg ? branch = master ) ] ( https : / / travis - ci . org / remy / nodemon ) [ ! [ Backers on Open Collective ] ( https : / / opencollective . com / nodemon / backers / badge . svg ) ] ( # backers ) [ ! [ Sponsors on Open Collective ] ( https : / / opencollective . com / nodemon / sponsors / badge . svg ) ] ( # sponsors ) <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Any output from this script is prefixed with ` [ nodemon ] ` , otherwise all output from your application , errors included , will be echoed out as expected . <nl> - If no script is given , nodemon will test for a ` package . json ` file and if found , will run the file associated with the * main * property ( [ ref ] ( https : / / github . com / remy / nodemon / issues / 14 ) ) . <nl> - <nl> You can also pass the ` inspect ` flag to node through the command line as you would normally : <nl> ` ` ` bash <nl> nodemon - - inspect . / server . js 80 <nl> ` ` ` <nl> - If you have a ` package . json ` file for your app , you can omit the main script entirely and nodemon will read the ` package . json ` for the ` main ` property and use that value as the app . <nl> + If you have a ` package . json ` file for your app , you can omit the main script entirely and nodemon will read the ` package . json ` for the ` main ` property and use that value as the app ( [ ref ] ( https : / / github . com / remy / nodemon / issues / 14 ) ) . <nl> nodemon will also search for the ` scripts . start ` property in ` package . json ` ( as of nodemon 1 . 1 . x ) . <nl> 
mmm a / website / index . html <nl> ppp b / website / index . html <nl> src = " https : / / images . opencollective . com / casino - en - vivo / 1340a53 / logo / 256 . png " style = " margin - top : 20px " <nl> width = " 120 " > < / a > < / p > <nl> + <nl> + < p > < a href = " https : / / kasynohex . com / " > < img <nl> + src = " https : / / images . opencollective . com / kasynohex - com / b25daf6 / logo / 256 . png " style = " margin - top : 20px " <nl> + width = " 120 " > < / a > < / p > <nl> + <nl> + < p > < a href = " https : / / netticasinohex . com / " > < img <nl> + src = " https : / / images . opencollective . com / netticasinohex - com / 71d7417 / logo / 256 . png " style = " margin - top : 20px " <nl> + width = " 120 " > < / a > < / p > <nl> + <nl> + < p > < a href = " https : / / aussiecasinohex . com / " > < img <nl> + src = " https : / / images . opencollective . com / aussiecasinohex / 923df37 / logo / 256 . png " style = " margin - top : 20px " <nl> + width = " 120 " > < / a > < / p > <nl> < / div > <nl> < / div > <nl> < / main > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < a href = " https : / / www . najlepszeplatformyforex . pl / blog / broker - xtb / " > < img style = " margin : 12px ; float : left " src = " https : / / user - images . githubusercontent . com / 13700 / 106011732 - a72b2580 - 60b2 - 11eb - 9d6a - 24bf958de95d . png " width = " 120 " > < / a > <nl> < a href = " https : / / www . auscasinos . com / new " > < img style = " margin : 12px ; float : left " src = " https : / / images . opencollective . com / auscasinos / 8df0f47 / logo / 256 . png " style = " margin : 12px ; margin - top : 20px " width = " 120 " > < / a > <nl> < a href = " https : / / www . casinoenvivo . com / blackjack " > < img style = " margin : 12px ; float : left " src = " https : / / images . opencollective . com / casino - en - vivo / 1340a53 / logo / 256 . png " style = " margin : 12px ; margin - top : 20px " width = " 120 " > < / a > <nl> - <nl> - <nl> < a href = " https : / / kasynohex . com / " > < img <nl> src = " https : / / images . opencollective . com / kasynohex - com / b25daf6 / logo / 256 . png " style = " float : left ; margin : 12px " <nl> width = " 120 " > < / a > <nl> - <nl> < a href = " https : / / netticasinohex . com / " > < img <nl> src = " https : / / images . opencollective . com / netticasinohex - com / 71d7417 / logo / 256 . png " style = " float : left ; margin : 12px " <nl> width = " 120 " > < / a > <nl> - <nl> < a href = " https : / / aussiecasinohex . com / " > < img <nl> src = " https : / / images . opencollective . com / aussiecasinohex / 923df37 / logo / 256 . png " style = " float : left ; margin : 12px " <nl> width = " 120 " > < / a > <nl> - <nl> < / div > <nl> # License <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> " . . . " : " . . . other standard package . json values " , <nl> " nodemonConfig " : { <nl> " ignore " : [ " test / * " , " docs / * " ] , <nl> - " delay " : " 2500 " <nl> + " delay " : 2500 <nl> } <nl> } <nl> ` ` ` <nl> @ @ - 247 , 7 + 247 , 7 @ @ If you are setting this value in ` nodemon . json ` , the value will always be interp <nl> nodemon - - delay 2 . 5 <nl> { <nl> - " delay " : " 2500 " <nl> + " delay " : 2500 <nl> } <nl> ` ` ` <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Either through cloning with git or by using [ npm ] ( http : / / npmjs . org ) ( the recommended way ) : <nl> ` ` ` bash <nl> - npm install - g nodemon <nl> + npm install - g nodemon # or using yarn : yarn global add nodemon <nl> ` ` ` <nl> And nodemon will be installed globally to your system path . <nl> @ @ - 24 , 10 + 24 , 10 @ @ And nodemon will be installed globally to your system path . <nl> You can also install nodemon as a development dependency : <nl> ` ` ` bash <nl> - npm install - - save - dev nodemon <nl> + npm install - - save - dev nodemon # or using yarn : yarn add nodemon - D <nl> ` ` ` <nl> - With a local installation , nodemon will not be available in your system path . Instead , the local installation of nodemon can be run by calling it from within an npm script ( such as ` npm start ` ) or using ` npx nodemon ` . <nl> + With a local installation , nodemon will not be available in your system path or you can ' t use it directly from the command line . Instead , the local installation of nodemon can be run by calling it from within an npm script ( such as ` npm start ` ) or using ` npx nodemon ` . <nl> # Usage <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> Alternatively the ` - - exec nodejs ` option can be used . <nl> - Fedora and Ubuntu pakage node as nodejs , because node . dpkg is <nl> + Fedora and Ubuntu package node as nodejs , because node . dpkg is <nl> > Description - en : Amateur Packet Radio Node program <nl> > The node program accepts TCP / IP and packet radio network connections and <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> If you find your files aren ' t being monitored , either nodemon isn ' t restarting , or it reports that zero files are being watched , then you may need the polling mode . <nl> - To enable polling use the the legacy flag either via the terminal : <nl> + To enable polling use the legacy flag either via the terminal : <nl> ` ` ` shell <nl> $ nodemon - - legacy - watch <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> 1 . Open up a powershell command window ( open it as administrator ) <nl> 2 . To check out current restrictions type " Get - ExecutionPolicy " <nl> 3 . Enable powershell by typing " Set - ExecutionPolicy remotesigned " <nl> + <nl> + # # How can I watch all file types in a folder ? <nl> + <nl> + To watch all file types , use ` ' * ' ` : <nl> + <nl> + ` ` ` bash <nl> + nodemon - - ext ' * ' - - watch public - - exec ' python - m SimpleHTTPServer ' <nl> + ` ` ` <nl> 
mmm a / doc / sample - nodemon . md <nl> ppp b / doc / sample - nodemon . md <nl> + ` ` ` json <nl> { <nl> " restartable " : " rs " , <nl> " ignore " : [ <nl> @ @ - 24 , 5 + 25 , 6 @ @ Here is an example ( of a contrived ) ` nodemon . json ` file : <nl> } , <nl> " ext " : " js , json " <nl> } <nl> + ` ` ` <nl> Note that the ` ignore ` used is nodemon ' s default ignore rule . The complete defaults can be seen here : [ defaults . js ] ( https : / / github . com / remy / nodemon / blob / master / lib / config / defaults . js ) . <nl> 
mmm a / . github / ISSUE_TEMPLATE / bug_report . md <nl> ppp b / . github / ISSUE_TEMPLATE / bug_report . md <nl> gulp , grunt , webpack , etc . Thank you so much < 3 <nl> - - > <nl> - - Versions : < ! - - run this : node - e ' console . log ( ` node @ $ { process . version } , $ { process . platform } @ $ { require ( \ " os \ " ) . release ( ) } ` ) ' - - > <nl> + - Versions : < ! - - run this : node - e ' console . log ( ` node @ $ { process . version } , $ { process . platform } @ $ { require ( " os " ) . release ( ) } ` ) ' - - > <nl> - ` nodemon - v ` : <nl> - Operating system / terminal environment ( powershell , gitshell , etc ) : <nl> - Using Docker ? What image : <nl> 
mmm a / website / index . html <nl> ppp b / website / index . html <nl> < main > <nl> - < p > Nodemon is a utility < strong > depended on by over 1 . 5 million projects < / strong > , that will monitor for any <nl> + < p > Nodemon is a utility < strong > depended on about 3 million projects < / strong > , that will monitor for any <nl> changes in your source and automatically restart your server . <nl> Perfect for development . < / p > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Now nodemon will only restart if there are changes in the ` . / app ` or ` . / libs ` directory . By default nodemon will traverse sub - directories , so there ' s no need in explicitly including sub - directories . <nl> - Don ' t use unix globbing to pass multiple directories , e . g ` - - watch . / lib / * ` , it won ' t work . You need a ` - - watch ` flag per directory watched . <nl> + Nodemon also supports unix globbing , e . g ` - - watch ' . / lib / * ' ` . The globbing pattern must be quoted . <nl> # # Specifying extension watch list <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> ` ` ` json <nl> { <nl> " verbose " : true , <nl> - " ignore " : [ " * . test . js " , " fixtures / * " ] , <nl> + " ignore " : [ " * . test . js " , " * * / fixtures / * * " ] , <nl> " execMap " : { <nl> " rb " : " ruby " , <nl> " pde " : " processing - - sketch = { { pwd } } - - run " <nl> @ @ - 109 , 7 + 109 , 7 @ @ Specify the config in the same format as you would for a config file but under ` <nl> " homepage " : " http : / / nodemon . io " , <nl> " . . . " : " . . . other standard package . json values " , <nl> " nodemonConfig " : { <nl> - " ignore " : [ " test / * " , " docs / * " ] , <nl> + " ignore " : [ " * * / test / * * " , " * * / docs / * * " ] , <nl> " delay " : 2500 <nl> } <nl> } <nl> @ @ - 203 , 6 + 203 , 8 @ @ Patterns can also be ignored ( but be sure to quote the arguments ) : <nl> nodemon - - ignore ' lib / * . js ' <nl> ` ` ` <nl> + * * Important * * the ignore rules are patterns matched to the full absolute path , and this determines how many files are monitored . If using a wild card glob pattern , it needs to be used as ` * * ` or omitted entirely . For example , ` nodemon - - ignore ' * * / test / * * ' ` will work , whereas ` - - ignore ' * / test / * ' ` will not . <nl> + <nl> Note that by default , nodemon will ignore the ` . git ` , ` node_modules ` , ` bower_components ` , ` . nyc_output ` , ` coverage ` and ` . sass - cache ` directories and * add * your ignored patterns to the list . If you want to indeed watch a directory like ` node_modules ` , you need to [ override the underlying default ignore rules ] ( https : / / github . com / remy / nodemon / blob / master / faq . md # overriding - the - underlying - default - ignore - rules ) . <nl> # # Application isn ' t restarting <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - < img src = " https : / / user - images . githubusercontent . com / 13700 / 35731649 - 652807e8 - 080e - 11e8 - 88fd - 1b2f6d553b2d . png " alt = " Nodemon Logo " > <nl> + < a href = " https : / / nodemon . io / " > < img src = " https : / / user - images . githubusercontent . com / 13700 / 35731649 - 652807e8 - 080e - 11e8 - 88fd - 1b2f6d553b2d . png " alt = " Nodemon Logo " > < / a > <nl> < / p > <nl> # nodemon <nl> 
mmm a / faq . md <nl> ppp b / faq . md <nl> ` ` ` bash <nl> nodemon - - ext ' * ' - - watch public - - exec ' python - m SimpleHTTPServer ' <nl> ` ` ` <nl> + <nl> + # # Workaround for when - - inspect flag is passed and the old process doesn ' t finish before starting a new process <nl> + <nl> + Based on [ this issue ] ( https : / / github . com / remy / nodemon / issues / 2056 ) . <nl> + <nl> + Sometimes when using the ` - - inspect ` flag , nodemon will try to start the a process before the old process is finished . <nl> + <nl> + This will cause an error trying to up the new process because of the debugger service : <nl> + <nl> + ` ` ` <nl> + [ 0 ] [ nodemon ] restarting due to changes . . . <nl> + [ 0 ] [ nodemon ] starting ` node - - inspect . / main / index . js ` <nl> + [ 0 ] Starting inspector on 127 . 0 . 0 . 1 : 9229 failed : address already in use <nl> + ` ` ` <nl> + <nl> + Your application will likely be running the old version code if you see that message , and you will need to stop the app and manually start it again to run the app with the newer code version . <nl> + <nl> + A common cause for this is when graceful shutdowns are doing async tasks , i . e : <nl> + <nl> + ` ` ` <nl> + process . once ( ' SIGUSR2 ' , async ( ) = > { <nl> + await db . disconnect ( ) <nl> + } ) <nl> + ` ` ` <nl> + <nl> + Simply removing the ` await ` keyword would likely fix the issue . <nl> + <nl> + If even after that you still running into that problem , there ' s a workaround to force kill the debugger whenever nodemon triggers a restart . <nl> + <nl> + You can create a ` nodemon . json ` file at the project root and add the following config : <nl> + <nl> + ` ` ` <nl> + { <nl> + " events " : { <nl> + " restart " : " sh - c ' lsof - i : $ { PORT : - 9229 } - t | xargs kill ' " <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> + This will run a shell command to kill the process running on the PORT 9229 ( default node debug port ) whenever nodemon triggers a restart . <nl> + <nl> + It may fail sometimes , but it makes the hot reload works partially . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> } <nl> ` ` ` <nl> + ` preact / compat ` is our compatibility layer that allows you to leverage the many libraries of the React ecosystem and use them with Preact . If this is something you ' d like to use with WMR you can add an ` alias ` section as well to your ` package . json ` : <nl> + <nl> + ` ` ` json <nl> + { <nl> + " alias " : { <nl> + " react " : " preact / compat " , <nl> + " react - dom " : " preact / compat " <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> * * 5 . * * You ' re all set ! As an extra step , if you ' d like WMR to prerender your application to static HTML during production builds , replace ` render ( ) ` with [ preact - iso ] ( https : / / www . npmjs . com / package / preact - iso ) : <nl> ` ` ` diff <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> [ Check out the docs to learn more ] ( packages / wmr / README . md ) <nl> + # # Packages <nl> + <nl> + | Package | Version | <nl> + | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | : - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | [ wmr ] ( packages / wmr ) | [ ! [ wmr npm ] ( https : / / img . shields . io / npm / v / wmr . svg ) ] ( https : / / npm . im / wmr ) | <nl> + | [ create - wmr ] ( packages / create - wmr ) | [ ! [ create - wmr npm ] ( https : / / img . shields . io / npm / v / create - wmr . svg ) ] ( https : / / npm . im / create - wmr ) | <nl> + | [ @ wmr - plugins / directory - import ] ( packages / directory - plugin ) | [ ! [ @ wmr - plugins / directory - import npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / directory - import . svg ) ] ( https : / / npm . im / @ wmr - plugins / directory - import ) | <nl> + | [ @ wmr - plugins / nomodule ] ( packages / nomodule - plugin ) | [ ! [ @ wmr - plugins / nomodule npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / nomodule . svg ) ] ( https : / / npm . im / @ wmr - plugins / nomodule ) | <nl> + | [ @ wmr - plugins / service - worker ] ( packages / sw - plugin ) | [ ! [ @ wmr - plugins / service - worker npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / service - worker . svg ) ] ( https : / / npm . im / @ wmr - plugins / service - worker ) | <nl> + | [ preact - iso ] ( packages / preact - iso ) | [ ! [ preact - iso npm ] ( https : / / img . shields . io / npm / v / preact - iso . svg ) ] ( https : / / npm . im / preact - iso ) | <nl> + <nl> # # Contributing <nl> ` ` ` sh <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # Packages <nl> - | Package | Version | <nl> - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | : - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> - | [ wmr ] ( packages / wmr ) | [ ! [ wmr npm ] ( https : / / img . shields . io / npm / v / wmr . svg ) ] ( https : / / npm . im / wmr ) | <nl> - | [ create - wmr ] ( packages / create - wmr ) | [ ! [ create - wmr npm ] ( https : / / img . shields . io / npm / v / create - wmr . svg ) ] ( https : / / npm . im / create - wmr ) | <nl> - | [ @ wmr - plugins / directory - import ] ( packages / directory - plugin ) | [ ! [ @ wmr - plugins / directory - import npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / directory - import . svg ) ] ( https : / / npm . im / @ wmr - plugins / directory - import ) | <nl> - | [ @ wmr - plugins / nomodule ] ( packages / nomodule - plugin ) | [ ! [ @ wmr - plugins / nomodule npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / nomodule . svg ) ] ( https : / / npm . im / @ wmr - plugins / nomodule ) | <nl> - | [ @ wmr - plugins / service - worker ] ( packages / sw - plugin ) | [ ! [ @ wmr - plugins / service - worker npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / service - worker . svg ) ] ( https : / / npm . im / @ wmr - plugins / service - worker ) | <nl> - | [ preact - iso ] ( packages / preact - iso ) | [ ! [ preact - iso npm ] ( https : / / img . shields . io / npm / v / preact - iso . svg ) ] ( https : / / npm . im / preact - iso ) | <nl> + | Package | Description | Version | <nl> + | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | : - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | : - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | [ wmr ] ( packages / wmr ) | The tiny all - in - one development tool for modern web apps | [ ! [ wmr npm ] ( https : / / img . shields . io / npm / v / wmr . svg ) ] ( https : / / npm . im / wmr ) | <nl> + | [ create - wmr ] ( packages / create - wmr ) | Create a new WMR project in seconds | [ ! [ create - wmr npm ] ( https : / / img . shields . io / npm / v / create - wmr . svg ) ] ( https : / / npm . im / create - wmr ) | <nl> + | [ @ wmr - plugins / directory - import ] ( packages / directory - plugin ) | Allows you to import multiple files in a single statement | [ ! [ @ wmr - plugins / directory - import npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / directory - import . svg ) ] ( https : / / npm . im / @ wmr - plugins / directory - import ) | <nl> + | [ @ wmr - plugins / nomodule ] ( packages / nomodule - plugin ) | Allows you to create legacy bundles alongside WMR ' s modern output | [ ! [ @ wmr - plugins / nomodule npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / nomodule . svg ) ] ( https : / / npm . im / @ wmr - plugins / nomodule ) | <nl> + | [ @ wmr - plugins / service - worker ] ( packages / sw - plugin ) | Allows you to add a service worker | [ ! [ @ wmr - plugins / service - worker npm ] ( https : / / img . shields . io / npm / v / @ wmr - plugins / service - worker . svg ) ] ( https : / / npm . im / @ wmr - plugins / service - worker ) | <nl> + | [ preact - iso ] ( packages / preact - iso ) | Isomorphic async tools for Preact | [ ! [ preact - iso npm ] ( https : / / img . shields . io / npm / v / preact - iso . svg ) ] ( https : / / npm . im / preact - iso ) | <nl> # # Contributing <nl> 
mmm a / src / main . js <nl> ppp b / src / main . js <nl> import App from ' . / App . vue ' <nl> import ' . / registerServiceWorker ' <nl> - / / import { provideTheme } from ' @ / lib / utils ' <nl> import Kiwi from ' . / lib / plugin ' <nl> Vue . config . productionTip = false <nl> + / / Install Kiwi plugin <nl> Vue . use ( Kiwi ) <nl> new Vue ( { <nl> + / / Alternative way to provide theme would be to import { provideTheme } from utils and provide it with render function <nl> / / Provide theme to the root of the application <nl> / / render : h = > provideTheme ( h , App ) <nl> render : h = > h ( App ) <nl> 
mmm a / src / lib / utils / icons . js <nl> ppp b / src / lib / utils / icons . js <nl> + / * * <nl> + * @ description Parse all Font Awesome Icons <nl> + * @ param { Object } iconSet - Registered Icons object <nl> + * @ returns { Object } - All Font awesome icons parsed . <nl> + * / <nl> const parseFAIcons = ( iconSet ) = > { <nl> const parseFAIcon = ( iconObject ) = > { <nl> const { icon } = iconObject <nl> @ @ - 15 , 7 + 20 , 6 @ @ const parseFAIcons = ( iconSet ) = > { <nl> . map ( value = > parseFAIcon ( value ) ) <nl> . reduce ( ( target , source ) = > merge ( target , source ) , { } ) <nl> - console . log ( { result } ) <nl> return result <nl> } <nl> 
mmm a / packages / docs / components / components . js <nl> ppp b / packages / docs / components / components . js <nl> ' Image ' , <nl> ' Input ' , <nl> ' Link ' , <nl> - / / ' List ' , <nl> + ' List ' , <nl> ' Menu ' , <nl> ' Modal ' , <nl> ' NumberInput ' , <nl> @ @ - 48 , 10 + 48 , 10 @ @ const components = [ <nl> / / ' Stat ' , <nl> ' Stack ' , <nl> ' Switch ' , <nl> - / / ' Tabs ' , <nl> + ' Tabs ' , <nl> ' Tag ' , <nl> ' Text ' , <nl> - / / ' Textarea ' , <nl> + ' Textarea ' , <nl> ' Toast ' , <nl> ' Tooltip ' <nl> ] <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> ` ` ` bash <nl> yarn install <nl> yarn bootstrap <nl> - yarn serve <nl> + yarn dev <nl> ` ` ` <nl> - <nl> - <nl> - # # # # Project TODO : <nl> - - [ x ] Setup Storybook for components UI <nl> - - [ x ] Theme Provider <nl> - - [ x ] Develop styling scheme for components with styled system <nl> - - [ x ] Setup Vue . js plugin system <nl> - - [ x ] Provide Theme <nl> - - [ x ] Observe theme and set it dynamically in javascript plugin . <nl> - - [ x ] Provide icons API for icons component <nl> - - [ x ] Accessibility and WIA - ARIA standard implementation <nl> - - [ ] Setup NPM distribution <nl> + # # # # Project TODOs : <nl> + - [ ] Documentation site ( Ongoing ) <nl> - [ ] Set up type system for plugin & components export with Typescript <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> You can also view all developed components in * * [ Storybook ] ( https : / / chakra - ui - vue . netlify . com ) ! * * <nl> # # # Development for Contributing : <nl> - Interested in contributing ? See our open issues ! Remember to take a look at our [ CONTRIBUTORS ] ( . . / . . / . github / CONTRIBUTING . md ) guide . <nl> + Interested in contributing ? See our [ open issues ] ( / issues ) ! Remember to take a look at our [ CONTRIBUTORS ] ( . . / . . / . github / CONTRIBUTING . md ) guide . <nl> ` ` ` bash <nl> yarn install <nl> 
mmm a / packages / chakra - ui - docs / package . json <nl> ppp b / packages / chakra - ui - docs / package . json <nl> " dotenv - defaults " : " ^ 1 . 1 . 1 " , <nl> " emotion " : " ^ 10 . 0 . 27 " , <nl> + " file - contributors " : " ^ 1 . 0 . 2 " , <nl> + " node - sass " : " ^ 4 . 13 . 1 " , <nl> " nuxt " : " ^ 2 . 0 . 0 " , <nl> " prismjs " : " ^ 1 . 19 . 0 " , <nl> + " sass - loader " : " ^ 8 . 0 . 2 " , <nl> " vue " : " ^ 2 . 6 . 11 " , <nl> " vue - live " : " ^ 1 . 5 . 1 " , <nl> " vue - prism - editor " : " ^ 0 . 5 . 1 " , <nl> 
mmm a / packages / chakra - ui - core / src / ThemeProvider / index . js <nl> ppp b / packages / chakra - ui - core / src / ThemeProvider / index . js <nl> return { <nl> $ theme : ( ) = > this . theme , <nl> $ icons : this . icons , <nl> + / * * <nl> + * By default the ThemeProvider exposes a colorMode value of light <nl> + * If no ` ColorModeProvider ` is provided in children / consumer app , all chakra <nl> + * components will consume the $ colorMode from here . <nl> + * / <nl> $ colorMode : ( ) = > ' light ' <nl> } <nl> } , <nl> 
mmm a / packages / chakra - ui - docs / layouts / default . vue <nl> ppp b / packages / chakra - ui - docs / layouts / default . vue <nl> ' . preview - panel ' : { <nl> borderColor : this . thBg [ colorMode ] <nl> } , <nl> - ' blockquote ' : this . callout [ colorMode ] , <nl> + ' blockquote ' : { <nl> + . . . this . callout [ colorMode ] , <nl> + rounded : ' md ' , <nl> + overflow : ' hidden ' <nl> + } , <nl> ' table , p ' : { <nl> ' code ' : this . code [ colorMode ] <nl> } <nl> 
mmm a / packages / chakra - ui - docs / docs / button . mdx <nl> ppp b / packages / chakra - ui - docs / docs / button . mdx <nl> + import LiveEditor from ' . . / components / LiveEditor ' <nl> + import { Button , ButtonGroup , PseudoBox } from ' @ chakra - ui / vue ' <nl> + import Code from ' . . / components / CodeBlock ' <nl> + Vue . component ( ' Button ' , Button ) <nl> + Vue . component ( ' ButtonGroup ' , ButtonGroup ) <nl> + Vue . component ( ' PseudoBox ' , PseudoBox ) <nl> + <nl> # Button <nl> + < br / > <nl> + Button component is used to trigger an action or event , such as submitting a form , opening a dialog , canceling an action , or performing a delete operation . <nl> + <nl> + # # # Import <nl> + <nl> + < Code lang = " javascript " code = { ` import { Button } from " chakra - ui / vue " ` } / > <nl> + <nl> + # # # Usage <nl> + < LiveEditor > <nl> + { ` <nl> + < Button variantColor = " green " > Button < / Button > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Button Sizes <nl> + <nl> + Use the ` size ` prop to change the size of the button . You can set the value to ` xs ` , ` sm ` , ` md ` or ` lg ` . <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < ButtonGroup : spacing = " 4 " > <nl> + < Button variantColor = " green " size = " xs " > <nl> + Button <nl> + < / Button > <nl> + < Button variantColor = " blue " size = " sm " > <nl> + Button <nl> + < / Button > <nl> + < Button variantColor = " red " size = " md " > <nl> + Button <nl> + < / Button > <nl> + < Button variantColor = " orange " size = " lg " > <nl> + Button <nl> + < / Button > <nl> + < / ButtonGroup > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Button Variant <nl> + <nl> + Use the ` variant ` prop to change the visual style of the Button . You can set the value to ` solid ` , ` ghost ` , ` outline ` , or ` link ` . <nl> + <nl> + < LiveEditor > { ` <nl> + < ButtonGroup : spacing = " 4 " > <nl> + < Button variantColor = " red " variant = " solid " > <nl> + Button <nl> + < / Button > <nl> + < Button variantColor = " orange " variant = " outline " > <nl> + Button <nl> + < / Button > <nl> + < Button variantColor = " yellow " variant = " ghost " > <nl> + Button <nl> + < / Button > <nl> + < Button variantColor = " green " variant = " link " > <nl> + Button <nl> + < / Button > <nl> + < / ButtonGroup > <nl> + ` } < / LiveEditor > <nl> + <nl> + <nl> + # # # Button with Icon <nl> + <nl> + You can add left and right icons to the Button component . See how to [ add icons ] ( # / icons ) to your project . <nl> + <nl> + < LiveEditor > { ` <nl> + < ButtonGroup : spacing = " 4 " > <nl> + < Button leftIcon = " email " variantColor = " green " variant = " solid " > <nl> + Email <nl> + < / Button > <nl> + < Button rightIcon = " arrow - forward " variantColor = " blue " variant = " outline " > <nl> + Call us <nl> + < / Button > <nl> + < / ButtonGroup > <nl> + ` } < / LiveEditor > <nl> + <nl> + # # # Button loading state <nl> + <nl> + Pass ` isLoading ` prop to the Button component to show it ' s loading state . You can optionally pass ` loadingText ` prop , if you do , the button will show a spinner and the loading text . Otherwise , the button will take the width of the text label and show only the spinner . <nl> + <nl> + < LiveEditor > { ` <nl> + < ButtonGroup : spacing = " 4 " > <nl> + < Button isLoading variantColor = " green " variant = " solid " > <nl> + Email <nl> + < / Button > <nl> + < Button <nl> + isLoading <nl> + loadingText = " Submitting " <nl> + variantColor = " blue " <nl> + variant = " outline " <nl> + > <nl> + Submit <nl> + < / Button > <nl> + < / ButtonGroup > <nl> + ` } < / LiveEditor > <nl> + <nl> + # # # Accessibility <nl> + <nl> + - Button has ` role ` button . ` isLoading ` <nl> + - When Button has focus , ` space ` and ` enter ` activates it <nl> + <nl> + # # # Composition <nl> + <nl> + Button composes [ Pseudobox ] ( # ) and all props ( variant , variantColor , etc . ) are converted to style props . This means you can override any style of the Button via props . <nl> + <nl> + < LiveEditor > { ` <nl> + / / The size prop affects the height of the button <nl> + / / but I can still override it by passing a custom height <nl> + < Button <nl> + size = " md " <nl> + height = " 50px " <nl> + width = " 250px " <nl> + border = " 2px " <nl> + borderColor = " green . 500 " <nl> + > <nl> + Button <nl> + < / Button > <nl> + ` } < / LiveEditor > <nl> + <nl> + # # # Custom Button <nl> + <nl> + In event you need to make your own custom button , you can leverage the ` PseudoBox ` component . It provides the ` hover ` , ` focus ` , ` active ` and ` disabled ` style props to style the button . <nl> + <nl> + < LiveEditor > { ` <nl> + < PseudoBox <nl> + as = " button " <nl> + height = " 24px " <nl> + lineHeight = " 1 . 2 " <nl> + transition = " all 0 . 2s cubic - bezier ( . 08 , . 52 , . 52 , 1 ) " <nl> + border = " 1px " <nl> + px = " 8px " <nl> + rounded = " 2px " <nl> + fontSize = " 14px " <nl> + fontWeight = " semibold " <nl> + bg = " # f5f6f7 " <nl> + borderColor = " # ccd0d5 " <nl> + color = " # 4b4f56 " <nl> + > <nl> + Join Group <nl> + < / PseudoBox > <nl> + ` } < / LiveEditor > <nl> + <nl> + # # # props <nl> + <nl> + The Button composes the ` PseudoBox ` component so you can pass props for ` PseudoBox ` . These are props related to the Button component . <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` aria - label ` | ` string ` | | The label of the button | <nl> + | ` variant ` | ` string ` | | The color of the button . Use a color key passed in ` theme . colors ` . | <nl> + | ` variantColor ` | ` outline ` , ` ghost ` , ` unstyled ` , ` link ` , ` solid ` | ` solid ` | The color of the button . Use a color key passed in ` theme . colors ` . | <nl> + | ` isDisabled ` | ` boolean ` | | If ` true ` , the button will be disabled . | <nl> + | ` isLoading ` | ` boolean ` | | If ` true ` , the button will show a spinner | <nl> + | ` loadingText ` | ` string ` | | The label to show in the button when isLoading is true . If no text is passed , it only shows the spinner | <nl> + | ` size ` | ` xs ` , ` sm ` , ` md ` , ` lg ` | ` md ` | The size of the button | <nl> + <nl> 
mmm a / packages / chakra - ui - docs / docs / alert . mdx <nl> ppp b / packages / chakra - ui - docs / docs / alert . mdx <nl> + import LiveEditor from ' . . / components / LiveEditor ' <nl> + import { Alert , AlertIcon , AlertTitle , AlertDescription , CloseButton , Stack } from ' @ chakra - ui / vue ' <nl> + import Code from ' . . / components / CodeBlock ' <nl> + Vue . component ( ' Alert ' , Alert ) <nl> + Vue . component ( ' AlertIcon ' , AlertIcon ) <nl> + Vue . component ( ' AlertTitle ' , AlertTitle ) <nl> + Vue . component ( ' AlertDescription ' , AlertDescription ) <nl> + Vue . component ( ' CloseButton ' , CloseButton ) <nl> + Vue . component ( ' Stack ' , Stack ) <nl> + <nl> + <nl> # Alert <nl> + <nl> + Alerts are used to communicate a state that affects a system , feature or page . <nl> + <nl> + # # Import <nl> + <nl> + Chakra UI Vue exports 4 alert related components . <nl> + <nl> + - ` Alert ` : The wrapper for alert components . <nl> + - ` AlertIcon ` : The visual icon for the alert that changes based on the ` status ` prop . <nl> + - ` AlertTitle ` : The title of the alert to be announced by screen readers . <nl> + - ` AlertDescription ` : The description of the alert to be announced by screen readers . <nl> + <nl> + < Code lang = " javascript " code = { ` <nl> + import { <nl> + Alert , <nl> + AlertIcon , <nl> + AlertTitle , <nl> + AlertDescription , <nl> + } from " @ chakra - ui / vue " ; <nl> + ` } / > <nl> + <nl> + # # Usage <nl> + <nl> + < br / > <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < Alert status = " error " > <nl> + < AlertIcon / > <nl> + < AlertTitle : mr = " 2 " > Your browser is outdated ! < / AlertTitle > <nl> + < AlertDescription > Your Chakra experience may be degraded . < / AlertDescription > <nl> + < CloseButton position = " absolute " right = " 8px " top = " 8px " / > <nl> + < / Alert > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Status <nl> + <nl> + Change the status of the alerts by passing the ` status ` prop . This affects the <nl> + color scheme and icon used . Alert supports ` error ` , ` success ` , ` warning ` , and <nl> + ` info ` statuses . <nl> + <nl> + <nl> + < br / > <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < Stack > <nl> + < Alert status = " error " > <nl> + < AlertIcon / > <nl> + There was an error processing your request <nl> + < / Alert > <nl> + < Alert status = " success " > <nl> + < AlertIcon / > <nl> + Data uploaded to the server . Fire on ! <nl> + < / Alert > <nl> + < Alert status = " warning " > <nl> + < AlertIcon / > <nl> + Seems your account is about to expire , upgrade now ! <nl> + < / Alert > <nl> + < Alert status = " info " > <nl> + < AlertIcon / > <nl> + Chakra is going live on August 30th . Get ready ! <nl> + < / Alert > <nl> + < / Stack > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Variant <nl> + <nl> + Alert has 4 variant styles you can use . Pass the ` variant ` prop and use either <nl> + ` subtle ` , ` solid ` , ` left - accent ` or ` top - accent ` . <nl> + <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < Stack > <nl> + < Alert status = " success " variant = " subtle " > <nl> + < AlertIcon / > <nl> + Data uploaded to the server . Fire on ! <nl> + < / Alert > <nl> + < Alert status = " success " variant = " solid " > <nl> + < AlertIcon / > <nl> + Data uploaded to the server . Fire on ! <nl> + < / Alert > <nl> + < Alert status = " success " variant = " left - accent " > <nl> + < AlertIcon / > <nl> + Data uploaded to the server . Fire on ! <nl> + < / Alert > <nl> + < Alert status = " success " variant = " top - accent " > <nl> + < AlertIcon / > <nl> + Data uploaded to the server . Fire on ! <nl> + < / Alert > <nl> + < / Stack > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Composition <nl> + <nl> + Alert ships with smaller component to allow for flexibility and make it easy to <nl> + create all kinds of layout . Here ' s an example of custom alert style and layout . <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < Alert <nl> + status = " success " <nl> + variant = " subtle " <nl> + flexDirection = " column " <nl> + justifyContent = " center " <nl> + textAlign = " center " <nl> + height = " 200px " <nl> + > <nl> + < AlertIcon size = " 40px " : mr = " 0 " / > <nl> + < AlertTitle : mt = " 4 " : mb = " 1 " fontSize = " lg " > <nl> + Application submitted ! <nl> + < / AlertTitle > <nl> + < AlertDescription maxWidth = " sm " > <nl> + Thanks for submitting your application . Our team will get back to you soon . <nl> + < / AlertDescription > <nl> + < / Alert > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # Props <nl> + <nl> + # # # Alert Props <nl> + <nl> + Alert is the wrapper for alert component . It composes the ` Flex ` component . <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | status | ` error ` , ` success ` , ` warning ` , ` info ` | ` info ` | The status of the alert | <nl> + | variant | ` subtle ` , ` solid ` , ` left - accent ` , ` top - accent ` | ` subtle ` | The variant of the alert style to use . | <nl> + <nl> + # # # AlertIcon Props <nl> + <nl> + AlertIcon composes ` Icon ` and changes the icon based on the ` status ` prop . <nl> + <nl> + # # # AlertTitle Props <nl> + <nl> + AlertTitle composes the ` Box ` component . <nl> + <nl> + # # # AlertDescription Props <nl> + <nl> + AlertDescription composes the ` Box ` component . <nl> \ No newline at end of file <nl> 
mmm a / packages / chakra - ui - core / src / CAccordion / CAccordion . js <nl> ppp b / packages / chakra - ui - core / src / CAccordion / CAccordion . js <nl> + * Hey ! Welcome to @ chakra - ui / vue Accordion <nl> + * <nl> + * Accordions display a list of high - level <nl> + * options that can expand / collapse to reveal <nl> + * more information . <nl> + * <nl> + * An accordion is a vertically stacked set <nl> + * of interactive headings that each contain <nl> + * a title , content snippet , or thumbnail <nl> + * representing a section of content . <nl> + * The headings function as controls that enable <nl> + * users to reveal or hide their associated sections <nl> + * of content . Accordions are commonly used to <nl> + * reduce the need to scroll when presenting <nl> + * multiple sections of content on a single page . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> + * @ see Source link to source <nl> + * @ see WAI - ARIA https : / / www . w3 . org / TR / wai - aria - practices - 1 . 2 / # accordion <nl> + * / <nl> + <nl> import { baseProps } from ' . . / config ' <nl> import { forwardProps , cloneVNodes , useId , isDef } from ' . . / utils ' <nl> import styleProps from ' . . / config / props ' <nl> @ @ - 8 , 6 + 30 , 16 @ @ import CPseudoBox from ' . . / CPseudoBox ' <nl> import CCollapse from ' . . / CCollapse ' <nl> import CIcon from ' . . / CIcon ' <nl> + / * * <nl> + * CAccordion component <nl> + * <nl> + * The wrapper that clones it ' s children <nl> + * to pass it ' s prop to the ` CAccordionItem ` . <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> + * / <nl> + <nl> const CAccordion = { <nl> name : ' CAccordion ' , <nl> props : { <nl> @ @ - 116 , 6 + 148 , 15 @ @ const CAccordion = { <nl> } <nl> } <nl> + / * * <nl> + * CAccordionItem component <nl> + * <nl> + * A single accordion item <nl> + * <nl> + * @ extends CPseudoBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> + * / <nl> + <nl> const CAccordionItem = { <nl> name : ' CAccordionItem ' , <nl> props : { <nl> @ @ - 202 , 6 + 243 , 15 @ @ const CAccordionItem = { <nl> } <nl> } <nl> + / * * <nl> + * CAccordionHeader component <nl> + * <nl> + * The button that toggles the expand / collapse <nl> + * state of the accordion item . <nl> + * <nl> + * @ extends CPseudoBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> + * / <nl> const CAccordionHeader = { <nl> name : ' CAccordionHeader ' , <nl> inject : [ ' $ AccordionContext ' ] , <nl> @ @ - 246 , 6 + 296 , 15 @ @ const CAccordionHeader = { <nl> } <nl> } <nl> + / * * <nl> + * CAccordionPanel component <nl> + * <nl> + * The container for the accordion item <nl> + * details to be revealed . <nl> + * <nl> + * @ extends CPseudoBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> + * / <nl> const CAccordionPanel = { <nl> name : ' CAccordionPanel ' , <nl> inject : [ ' $ AccordionContext ' ] , <nl> @ @ - 277 , 6 + 336 , 15 @ @ const CAccordionPanel = { <nl> } <nl> } <nl> + / * * <nl> + * CAccordionIcon component <nl> + * <nl> + * A chevron - down icon that rotates based on the <nl> + * expanded / collapsed state . <nl> + * <nl> + * @ extends CPseudoBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> + * / <nl> const CAccordionIcon = { <nl> name : ' CAccordionIcon ' , <nl> inject : [ ' $ AccordionContext ' ] , <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ Vue Starter ] ( https : / / codesandbox . io / s / chakra - ui - vue - starter - 2sy0g ) <nl> - [ Nuxt Starter ] ( https : / / codesandbox . io / s / chakra - ui - nuxt - demo - f8tq4 ) <nl> + - [ Gridsome Starter ] ( https : / / codesandbox . io / s / chakra - ui - gridsome - demo - 038c9 ) <nl> # # # Storybook Components <nl> 
mmm a / packages / chakra - ui - docs / docs / alertdialog . mdx <nl> ppp b / packages / chakra - ui - docs / docs / alertdialog . mdx <nl> # # Props <nl> - AlertDialog and it ' s components composes the ` Modal ` component , the only <nl> + AlertDialog and it ' s components composes the ` CModal ` component , the only <nl> exception is that it requires a ` leastDestructiveRef ` which is similar to the <nl> - ` initialFocusRef ` in ` Modal ` <nl> + ` initialFocusRef ` in ` CModal ` <nl> | Name | Type | Default | Description | <nl> | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> 
mmm a / packages / chakra - ui - docs / docs / box . mdx <nl> ppp b / packages / chakra - ui - docs / docs / box . mdx <nl> + import LiveEditor from ' . . / components / LiveEditor ' <nl> + import Code from ' . . / components / CodeBlock ' <nl> + import SEO from ' . . / components / SEO ' <nl> + import { CBox , CImage , CBadge , CIcon } from ' @ chakra - ui / vue ' <nl> + Vue . component ( ' CBox ' , CBox ) <nl> + Vue . component ( ' CImage ' , CImage ) <nl> + Vue . component ( ' CBadge ' , CBadge ) <nl> + Vue . component ( ' CIcon ' , CIcon ) <nl> + <nl> + < SEO <nl> + title = " Box " <nl> + description = " Box is the most abstract component on top of which all other @ chakra - ui / vue components are built . By default , it renders a ` div ` element " <nl> + / > <nl> + <nl> + <nl> # Box <nl> + <nl> + ` CBox ` is the most abstract component on top of which all other ` @ chakra - ui / vue ` components are built . By default , it renders a ` div ` element . <nl> + <nl> + < br / > <nl> + <nl> + * * The ` CBox ` component is useful because it helps with 3 common use cases : * * <nl> + - Creation of responsive layouts with ease . <nl> + - Provides a shorthand way to pass styles via props ( ` bg ` instead of ` backgroundColor ` ) . <nl> + - Composition of new components by providing for overrides by using the ` as ` prop . <nl> + <nl> + # # Import <nl> + <nl> + < Code lang = " javascript " code = { ` import { CBox } from " @ chakra - ui / vue " ; ` } / > <nl> + <nl> + # # Usage <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - box bg = " tomato " w = " 100 % " p = " 4 " color = " white " > <nl> + This is the Box <nl> + < / c - box > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # Composition with ` CBox ` <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < template > <nl> + < c - box maxW = " sm " border - width = " 1px " rounded = " lg " overflow = " hidden " > <nl> + < c - image : src = " property . imageUrl " : alt = " property . imageAlt " / > <nl> + < c - box p = " 6 " > <nl> + < c - box d = " flex " align - items = " baseline " > <nl> + < c - badge rounded = " full " px = " 2 " variant - color = " green " > <nl> + New <nl> + < / c - badge > <nl> + < c - box <nl> + color = " gray . 500 " <nl> + font - weight = " semibold " <nl> + letter - spacing = " wide " <nl> + font - size = " xs " <nl> + text - sransform = " uppercase " <nl> + ml = " 2 " <nl> + > <nl> + { { property . beds } } beds & bull ; { { property . baths } } baths <nl> + < / c - box > <nl> + < / c - box > <nl> + < c - box <nl> + mt = " 1 " <nl> + font - weight = " semibold " <nl> + as = " h4 " <nl> + line - height = " tight " <nl> + is - truncated <nl> + > <nl> + { { property . title } } <nl> + < / c - box > <nl> + < c - box > <nl> + { { property . formattedPrice } } <nl> + < c - box as = " span " color = " gray . 600 " fontSize = " sm " > <nl> + / wk <nl> + < / c - box > <nl> + < / c - box > <nl> + < c - box d = " flex " mt = " 2 " align - items = " center " > <nl> + < c - icon <nl> + v - for = " ( _ , i ) in Array ( 5 ) . fill ( ' ' ) " <nl> + name = " star " <nl> + : key = " i " <nl> + : color = " i < property . rating ? ' green . 500 ' : ' gray . 300 ' " <nl> + / > <nl> + < c - box as = " span " ml = " 2 " color = " gray . 600 " font - size = " sm " > <nl> + { { property . reviewCount } } reviews <nl> + < / c - box > <nl> + < / c - box > <nl> + < / c - box > <nl> + < / c - box > <nl> + < / template > \ n <nl> + < script > <nl> + export default { <nl> + name : ' Example ' , <nl> + data ( ) { <nl> + return { <nl> + property : { <nl> + imageUrl : " https : / / bit . ly / 2Z4KKcF " , <nl> + imageAlt : " Rear view of modern home with pool " , <nl> + beds : 3 , <nl> + baths : 2 , <nl> + title : " Modern home in city center in the heart of historic Los Angeles " , <nl> + formattedPrice : " $ 1 , 900 . 00 " , <nl> + reviewCount : 34 , <nl> + rating : 4 , <nl> + } <nl> + } <nl> + } <nl> + } <nl> + < / script > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # ` as ` prop <nl> + <nl> + You can use the ` as ` prop to change the element render , just like the ` tag ` prop on Vue ' s global dynamic component . <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - box as = " button " rounded = " md " bg = " tomato " color = " white " px = " 4 " h = " 8 " > <nl> + Button <nl> + < / c - box > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # Props <nl> + See all ` CBox ` props in the < nuxt - link to = " style - props " > Style Props page < / nuxt - link > <nl> \ No newline at end of file <nl> 
mmm a / packages / chakra - ui - docs / docs / tooltip . mdx <nl> ppp b / packages / chakra - ui - docs / docs / tooltip . mdx <nl> + import LiveEditor from ' . . / components / LiveEditor ' <nl> + import Code from ' . . / components / CodeBlock ' <nl> + import SEO from ' . . / components / SEO ' <nl> + <nl> + import { CTooltip , CIcon , CButton , CStack } from ' @ chakra - ui / vue ' <nl> + Vue . component ( ' CTooltip ' , CTooltip ) <nl> + Vue . component ( ' CIcon ' , CIcon ) <nl> + Vue . component ( ' CButton ' , CButton ) <nl> + Vue . component ( ' CStack ' , CStack ) <nl> + <nl> + < SEO <nl> + title = " Tooltip " <nl> + description = " A tooltip is a brief , informative message that appears when a user interacts with an element . Tooltips are usually initiated in one of two ways : through a mouse - hover gesture or through a keyboard - hover gesture . " <nl> + / > <nl> + <nl> # Tooltip <nl> + <nl> + A tooltip is a brief , informative message that appears when a user interacts with an element . Tooltips are usually initiated in one of two ways : through a mouse - hover gesture or through a keyboard - hover gesture . <nl> + <nl> + The Tooltip component follows the [ WAI - ARIA ] ( https : / / www . w3 . org / TR / wai - aria - practices / # tooltip ) Tooltip Pattern . <nl> + <nl> + # # Import <nl> + <nl> + < br / > <nl> + < Code <nl> + lang = " js " <nl> + code = { ` import { CTooltip } from " @ chakra - ui / vue " ; <nl> + ` } <nl> + / > <nl> + <nl> + # # Usage <nl> + <nl> + If the children of ` CTooltip ` is a string , we wrap with in a ` span ` with ` tab - index ` set to 0 , to ensure it meets the accessibility requirements . <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - tooltip label = " Chakra UI rocks " > Psst ! Hover Me < / c - tooltip > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # With an icon <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - tooltip label = " Welcome home " placement = " bottom " > <nl> + < c - icon name = " phone " / > <nl> + < / c - tooltip > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # With arrow <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - tooltip has - arrow label = " Add new component " placement = " right " > <nl> + < c - icon name = " add " / > <nl> + < / c - tooltip > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Tooltip with focusable content <nl> + <nl> + If the children of CTooltip is a focusable element , the tooltip will show when you focus or hover on the element , and will hide when you blur or moves cursor out of the element . <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - tooltip has - arrow label = " Sends your order to Delivery hero " placement = " top " bg = " blue . 600 " > <nl> + < c - button > Place Order < / c - button > <nl> + < / c - tooltip > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Placement <nl> + <nl> + Using the ` placement ` prop you can adjust where your tooltip will be displayed . <nl> + <nl> + < LiveEditor > <nl> + { ` <nl> + < c - stack should - wrap - children > <nl> + < c - tooltip has - arrow label = " left " placement = " left " > <nl> + < c - button variant = " outline " > Left < / c - button > <nl> + < / c - tooltip > <nl> + < c - tooltip has - arrow label = " top " placement = " top " > <nl> + < c - button variant = " outline " > Top < / c - button > <nl> + < / c - tooltip > <nl> + < c - tooltip has - arrow label = " right " placement = " right " > <nl> + < c - button variant = " outline " > Right < / c - button > <nl> + < / c - tooltip > <nl> + < c - tooltip has - arrow label = " bottom " placement = " bottom " > <nl> + < c - button variant = " outline " > Bottom < / c - button > <nl> + < / c - tooltip > <nl> + < / c - stack > <nl> + ` } <nl> + < / LiveEditor > <nl> + <nl> + # # # Props <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - | - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` isOpen ` | ` boolean ` | | If ` true ` , the tooltip is shown . | <nl> + | ` defaultIsOpen ` | ` boolean ` | | If ` true ` , the tooltip is initially shown . | <nl> + | ` label ` | ` string ` | | The label of the tooltip . | <nl> + | ` aria - label ` | ` string ` | | An alternate label for screen readers . | <nl> + | ` placement ` | ` PopperJS . Placement ` | ` bottom ` | Position the tooltip relative to the trigger element as well as surrounding elements . | <nl> + | ` children ` | ` Vue . VNode ` | | The ` VNode ` to be used as the trigger of the tooltip . | <nl> + | ` hasArrow ` | ` boolean ` | | If ` true ` display an arrow tip on the tooltip . | <nl> + | ` showDelay ` | ` number ` | | The delay in ` ms ` for the tooltip to show | <nl> + | ` hideDelay ` | ` number ` | | The delay in ` ms ` for the tooltip to hide | <nl> + | ` closeOnClick ` | ` boolean ` | | If ` true ` hide the tooltip , when the trigger is clicked . | <nl> + | ` shouldWrapChildren ` | ` boolean ` | | If ` true ` , the tooltip will wrap the children in a ` span ` with ` tabIndex = 0 ` | <nl> + <nl> + # # # Events <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - | - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` @ open ` | ` function ` | | Function called when the tooltip shows . | <nl> + | ` @ close ` | ` function ` | | Function called when the tooltip hides . | <nl> 
mmm a / packages / chakra - ui - docs / docs / alertdialog . mdx <nl> ppp b / packages / chakra - ui - docs / docs / alertdialog . mdx <nl> - import LiveEditor from ' . . / components / LiveEditor ' <nl> - import Code from ' . . / components / CodeBlock ' <nl> import SEO from ' . . / components / SEO ' <nl> - import { CButton , CAlertDialog , CAlertDialogContent , CAlertDialogOverlay , CAlertDialogBody , CAlertDialogHeader , CAlertDialogFooter , CAlertDialogCloseButton } from ' @ chakra - ui / vue ' <nl> - Vue . component ( ' CButton ' , CButton ) <nl> - Vue . component ( ' CAlertDialog ' , CAlertDialog ) <nl> - Vue . component ( ' CAlertDialogContent ' , CAlertDialogContent ) <nl> - Vue . component ( ' CAlertDialogOverlay ' , CAlertDialogOverlay ) <nl> - Vue . component ( ' CAlertDialogBody ' , CAlertDialogBody ) <nl> - Vue . component ( ' CAlertDialogHeader ' , CAlertDialogHeader ) <nl> - Vue . component ( ' CAlertDialogFooter ' , CAlertDialogFooter ) <nl> - Vue . component ( ' CAlertDialogCloseButton ' , CAlertDialogCloseButton ) <nl> < SEO <nl> title = " Alert Dialog " <nl> @ @ - 38 , 7 + 26 , 8 @ @ Chakra UI exports 7 alert dialog related components . <nl> < br / > <nl> - < Code lang = " javascript " code = { ` import { <nl> + ` ` ` js <nl> + import { <nl> CAlertDialog , <nl> CAlertDialogHeader , <nl> CAlertDialogBody , <nl> @ @ - 47 , 7 + 36 , 7 @ @ Chakra UI exports 7 alert dialog related components . <nl> CAlertDialogContent , <nl> CAlertDialogCloseButton <nl> } from " @ chakra - ui / vue " ; <nl> - ` } / > <nl> + ` ` ` <nl> # # Usage <nl> @ @ - 55 , 12 + 44 , 11 @ @ Chakra UI exports 7 alert dialog related components . <nl> Vue ref to a focusable element or component in your alert dialog . The ` leastDestructiveRef ` prop also accepts <nl> a function that returns a ref . <nl> - Based on < a href = " https : / / www . w3 . org / TR / wai - aria - practices / # alertdialog " target = " _blank " > WAI - ARIA specifications for alert dialogs < / a > , <nl> + Based on [ WAI - ARIA specifications for alert dialogs ] ( https : / / www . w3 . org / TR / wai - aria - practices / # alertdialog ) <nl> when the dialog opens , focus should be placed on the least destructive element <nl> to prevent users from accidentally confirming the destructive action . <nl> - < LiveEditor > <nl> - { ` <nl> + ` ` ` vue live = true <nl> < template > <nl> < div > <nl> < c - alert - dialog <nl> @ @ - 72 , 10 + 60 , 10 @ @ to prevent users from accidentally confirming the destructive action . <nl> < c - alert - dialog - content > <nl> < c - alert - dialog - header font - size = " lg " font - weight = " bold " > <nl> Delete Customer <nl> - < / c - alert - dialog - header > \ n <nl> + < / c - alert - dialog - header > <nl> < c - alert - dialog - body > <nl> Are you sure ? You can ' t undo this action afterwards . <nl> - < / c - alert - dialog - body > \ n <nl> + < / c - alert - dialog - body > <nl> < c - alert - dialog - footer > <nl> < c - button ref = " cancelRef " @ click = " closeDialog " > <nl> Cancel <nl> @ @ - 90 , 7 + 78 , 7 @ @ to prevent users from accidentally confirming the destructive action . <nl> Delete Customer <nl> < / c - button > <nl> < / div > <nl> - < / template > \ n <nl> + < / template > <nl> < script > <nl> export default { <nl> data ( ) { <nl> @ @ - 107 , 9 + 95 , 8 @ @ export default { <nl> } <nl> } <nl> } <nl> - < \ / script > <nl> - ` } <nl> - < / LiveEditor > <nl> + < / script > <nl> + ` ` ` <nl> # # Accessibility <nl> 
mmm a / packages / chakra - ui - docs / docs / closebutton . mdx <nl> ppp b / packages / chakra - ui - docs / docs / closebutton . mdx <nl> # # Import <nl> ` ` ` js <nl> - import { CloseButton } from ' @ chakra - ui / vue ' ; <nl> + import { CCloseButton } from ' @ chakra - ui / vue ' ; <nl> ` ` ` <nl> 
mmm a / packages / chakra - ui - docs / docs / tag . mdx <nl> ppp b / packages / chakra - ui - docs / docs / tag . mdx <nl> + <nl> + < SEO <nl> + title = " Tag " <nl> + description = " Tag component is used for items that need to be labeled , categorized , or organized using keywords that describe them . " <nl> + / > <nl> + <nl> # Tag <nl> + <nl> + Tag component is used for items that need to be labeled , categorized , or organized using keywords that describe them . <nl> + <nl> + # # Import <nl> + <nl> + Chakra UI Vue exports 4 Tag related components : <nl> + <nl> + - * * CTag * * : The wrapper for all the tag elements <nl> + - * * CTagLabel * * : The label for tag ' s text content . <nl> + - * * CTagIcon * * : The icon for the tag <nl> + - * * CTagCloseButton * * : The close button for the tag . <nl> + <nl> + ` ` ` js <nl> + import { CTag , CTagIcon , CTagLabel , CTagCloseButton } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - tag > Awesome Tag < / c - tag > <nl> + ` ` ` <nl> + <nl> + ` ` ` vue live = true <nl> + < template > <nl> + < c - stack : spacing = " 4 " is - inline > <nl> + < c - tag v - for = " size in sizes " : size = " size " : key = " size " variantColor = " vue " > <nl> + Vue { { size } } <nl> + < / c - tag > <nl> + < / c - stack > <nl> + < / template > <nl> + < script > <nl> + export default { <nl> + data ( ) { <nl> + return { <nl> + sizes : [ ' sm ' , ' md ' , ' lg ' ] <nl> + } <nl> + } <nl> + } <nl> + < / script > <nl> + ` ` ` <nl> + <nl> + # # With left icon <nl> + <nl> + ` ` ` vue live = true <nl> + < template > <nl> + < c - stack : spacing = " 4 " is - inline > <nl> + < c - tag v - for = " size in sizes " : size = " size " : key = " size " variant - color = " cyan " > <nl> + < c - tag - icon icon = " add " size = " 12px " / > <nl> + < c - tag - label > New { { size } } < / c - tag - label > <nl> + < / c - tag > <nl> + < / c - stack > <nl> + < / template > <nl> + < script > <nl> + export default { <nl> + data ( ) { <nl> + return { <nl> + sizes : [ ' sm ' , ' md ' , ' lg ' ] <nl> + } <nl> + } <nl> + } <nl> + < / script > <nl> + ` ` ` <nl> + <nl> + # # With right icon <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 4 " is - inline > <nl> + < c - tag variant - color = " cyan " > <nl> + < c - tag - label > Cyan < / c - tag - label > <nl> + < c - tag - icon icon = " check " size = " 12px " / > <nl> + < / c - tag > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # With close button <nl> + <nl> + ` ` ` vue live = true <nl> + < template > <nl> + < c - stack : spacing = " 4 " is - inline > <nl> + < c - tag <nl> + v - for = " size in sizes " <nl> + : size = " size " <nl> + : key = " size " <nl> + variant = " solid " <nl> + variant - color = " cyan " <nl> + > <nl> + < c - tag - label > Close { { size } } < / c - tag - label > <nl> + < c - tag - close - button / > <nl> + < / c - tag > <nl> + < / c - stack > <nl> + < / template > <nl> + < script > <nl> + export default { <nl> + data ( ) { <nl> + return { <nl> + sizes : [ ' sm ' , ' md ' , ' lg ' ] <nl> + } <nl> + } <nl> + } <nl> + < / script > <nl> + ` ` ` <nl> + <nl> + # # With custom element <nl> + <nl> + ` ` ` vue live = true <nl> + < c - tag variant - color = " red " rounded = " full " > <nl> + < c - avatar <nl> + src = " https : / / bit . ly / sage - adebayo " <nl> + size = " xs " <nl> + name = " Segun Adebayo " <nl> + : ml = " - 1 " <nl> + : mr = " 2 " <nl> + / > <nl> + < c - tag - label > Segun < / c - tag - label > <nl> + < / c - tag > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` variant ` | ` solid ` , ` subtle ` , ` outline ` | ` subtle ` | The variant style of the tag component . | <nl> + | ` size ` | ` sm ` , ` md ` , ` lg ` | ` lg ` | The size of the tag component . | <nl> + | ` variantColor ` | ` string ` | ` gray ` | The color scheme of the tag variant . | <nl> 
mmm a / packages / chakra - ui - docs / docs / spinner . mdx <nl> ppp b / packages / chakra - ui - docs / docs / spinner . mdx <nl> + <nl> + < SEO <nl> + title = " Spinner " <nl> + description = " Spinners provide a visual cue that an action is processing awaiting a course of change or a result . " <nl> + / > <nl> + <nl> # Spinner <nl> + <nl> + Spinners provide a visual cue that an action is processing awaiting a course of change or a result . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { CSpinner } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - spinner / > <nl> + ` ` ` <nl> + <nl> + # # # Spinner with Color <nl> + <nl> + ` ` ` vue live = true <nl> + < c - spinner color = " blue . 500 " / > <nl> + ` ` ` <nl> + <nl> + # # # Spinner with different size <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack is - inline : spacing = " 4 " > <nl> + < c - spinner size = " xs " / > <nl> + < c - spinner size = " sm " / > <nl> + < c - spinner size = " md " / > <nl> + < c - spinner size = " lg " / > <nl> + < c - spinner size = " xl " / > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # # Spinner with empty area color <nl> + <nl> + ` ` ` vue live = true <nl> + < c - spinner <nl> + thickness = " 4px " <nl> + speed = " 0 . 65s " <nl> + empty - color = " green . 200 " <nl> + color = " vue . 500 " <nl> + size = " xl " <nl> + / > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | size | ` xl ` , ` lg ` , ` md ` , ` sm ` , ` xs ` | ` md ` | The size of the spinner . | <nl> + | thickness | ` string ` | ` 2px ` | The thickness of the spinner . | <nl> + | speed | ` string ` | ` 0 . 45s ` | The speed of the spinner . | <nl> + | label | ` string ` | ` Loading . . . ` | An accessible label for the spinner ( Useful for screen readers ) | <nl> + | color | ` string ` | | The color of the spinner . | <nl> + | emptyColor | ` string ` | ` transparent ` | The color of the empty areas in the spinner . | <nl> 
mmm a / packages / chakra - ui - docs / docs / stat . mdx <nl> ppp b / packages / chakra - ui - docs / docs / stat . mdx <nl> + <nl> + < SEO <nl> + title = " Stat " <nl> + description = " The Stat component is used to display a single statistic . " <nl> + / > <nl> + <nl> # Stat <nl> + <nl> + The Stat component is used to display a single statistic . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { <nl> + CStat , <nl> + CStatLabel , <nl> + CStatNumber , <nl> + CStatHelpText , <nl> + CStatArrow , <nl> + CStatGroup <nl> + } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stat > <nl> + < c - stat - label > Collected Fees < / c - stat - label > <nl> + < c - stat - number > $ 500 . 00 < / c - stat - number > <nl> + < c - stat - helper - text > Feb 12 - Feb 28 < / c - stat - helper - text > <nl> + < / c - stat > <nl> + ` ` ` <nl> + <nl> + # # # Stat with Indicator <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stat - group > <nl> + < c - stat > <nl> + < c - stat - label > Sent < / c - stat - label > <nl> + < c - stat - number > 380 , 610 < / c - stat - number > <nl> + < c - stat - helper - text > <nl> + < c - stat - arrow type = " increase " / > <nl> + 30 . 60 % <nl> + < / c - stat - helper - text > <nl> + < / c - stat > <nl> + < c - stat > <nl> + < c - stat - label > Clicked < / c - stat - label > <nl> + < c - stat - number > 45 < / c - stat - number > <nl> + < c - stat - helper - text > <nl> + < c - stat - arrow type = " decrease " / > <nl> + - 5 . 20 % <nl> + < / c - stat - helper - text > <nl> + < / c - stat > <nl> + < / c - stat - group > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + - StatLabel , StatHelpText , StatNumber composes [ Text ] ( / text ) component <nl> + - StatArrow composes [ CIcon ] ( / icon ) component <nl> + - Stat , StatGroup composes [ CBox ] ( / box ) component <nl> 
mmm a / packages / chakra - ui - docs / docs / switch . mdx <nl> ppp b / packages / chakra - ui - docs / docs / switch . mdx <nl> + <nl> + < SEO <nl> + title = " Switch " <nl> + description = " The Switch component is used as an alternative for the Checkbox component , switch between enabled or disabled states . " <nl> + / > <nl> + <nl> # Switch <nl> + <nl> + The Switch component is used as an alternative for the [ Checkbox ] ( / checkbox ) component , switch between enabled or disabled states . <nl> + <nl> + Switch must always be accompanied by a label , and follows the same keyboard workflow as a checkbox . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { CSwitch } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - form - control > <nl> + < c - form - label html - for = " email - alerts " > Enable email alerts ? < / c - form - label > <nl> + < c - switch id = " email - alerts " / > <nl> + < / c - form - control > <nl> + ` ` ` <nl> + <nl> + # # Sizes <nl> + <nl> + Pass the size prop to change the ` size ` of the switch . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack align = " center " is - inline > <nl> + < c - switch size = " sm " / > <nl> + < c - switch size = " md " / > <nl> + < c - switch size = " lg " / > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # Switch background color <nl> + <nl> + You can change the checked background color of the switch by passing the ` color ` prop . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack is - inline > <nl> + < c - switch color = " vue " / > <nl> + < c - switch color = " red " size = " lg " / > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` size ` | ` sm ` , ` md ` , ` lg ` | | The size of the switch . | <nl> + | ` color ` | ` string ` | | The background color of the switch when checked . | <nl> + | ` name ` | ` string ` | | The input name of the switch when used in a form . | <nl> + | ` value ` | ` string ` , ` boolean ` | | The value of the switch . | <nl> + | ` children ` | ` React . ReactNode ` | | The children of the switch . | <nl> + | ` aria - label ` | ` string ` | | The aria - label of the switch for accessibility . | <nl> + | ` aria - labelledby ` | ` string ` | | The aria - labelledby of the switch for accessibility . | <nl> + | ` isChecked ` | ` boolean ` | | If ` true ` , set the switch to the checked state . | <nl> + | ` defaultIsChecked ` | ` boolean ` | | If ` true ` , the checkbox will be initially checked . | <nl> + | ` isDisabled ` | ` boolean ` | | If ` true ` , set the disabled to the invalid state . | <nl> + | ` isInvalid ` | ` boolean ` | | If ` true ` , set the switch to the invalid state . | <nl> 
mmm a / packages / chakra - ui - docs / docs / stack . mdx <nl> ppp b / packages / chakra - ui - docs / docs / stack . mdx <nl> + <nl> + < SEO <nl> + title = " Stack " <nl> + description = " Stack is a layout utility component that makes it easy to stack elements together and apply a space between them . " <nl> + / > <nl> + <nl> # Stack <nl> + <nl> + Stack is a layout utility component that makes it easy to stack elements together and apply a space between them . It composes the [ Flex ] ( / flex ) component . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { CStack } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + By default , each item is stacked vertically . Stack clones it ' s children and passes the spacing to them using ` margin - bottom ` or ` margin - right ` . <nl> + <nl> + # # Usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 5 " > <nl> + < c - box : p = " 5 " shadow = " md " border - width = " 1px " > <nl> + < c - heading > See the Vue < / c - heading > <nl> + < c - text : mt = " 4 " > Vue makes front - end development a breeze . < / c - text > <nl> + < / c - box > <nl> + < c - box : p = " 5 " shadow = " md " border - width = " 1px " > <nl> + < c - heading > Go Nuxt ! < / c - heading > <nl> + < c - text : mt = " 4 " > Nuxt makes writing Vue even easier . < / c - text > <nl> + < / c - box > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # Stack items horizontally <nl> + <nl> + To stack ` CStack ` children horizontally , pass the ` isInline ` prop or ` direction ` and set it to row . <nl> + <nl> + Optionally , you can use align and justify to adjust the alignment and distribution of the items . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 5 " is - inline > <nl> + < c - box : p = " 5 " shadow = " md " border - width = " 1px " > <nl> + < c - heading > See the Vue < / c - heading > <nl> + < c - text : mt = " 4 " > Vue makes front - end development a breeze . < / c - text > <nl> + < / c - box > <nl> + < c - box : p = " 5 " shadow = " md " border - width = " 1px " > <nl> + < c - heading > Go Nuxt ! < / c - heading > <nl> + < c - text : mt = " 4 " > Nuxt makes writing Vue even easier . < / c - text > <nl> + < / c - box > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # Reverse display order of items <nl> + <nl> + Pass the ` isReversed ` prop or set ` direction ` to ` row - reverse ` or ` column - reverse ` . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 5 " is - reversed > <nl> + < c - box : p = " 5 " shadow = " md " border - width = " 1px " > <nl> + < c - heading > See the Vue < / c - heading > <nl> + < c - text : mt = " 4 " > Vue makes front - end development a breeze . < / c - text > <nl> + < / c - box > <nl> + < c - box : p = " 5 " shadow = " md " border - width = " 1px " > <nl> + < c - heading > Go Nuxt ! < / c - heading > <nl> + < c - text : mt = " 4 " > Nuxt makes writing Vue even easier . < / c - text > <nl> + < / c - box > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` isInline ` | ` boolean ` | false | If ` true ` the items will be stacked horizontally . | <nl> + | ` isReversed ` | ` boolean ` | false | If ` true ` the items will be displayed in reverse order . | <nl> + | ` direction ` | ` FlexProps [ " flexDirection " ] ` | | The direction to stack the items . | <nl> + | ` spacing ` | ` StyledSystem . MarginProps ` | | The space between each stack item | <nl> + | ` align ` | ` FlexProps [ " alignItems " ] ` | | The alignment of the stack item . Similar to ` align - items ` | <nl> + | ` justify ` | ` FlexProps [ " justifyContent " ] ` | | The distribution of the stack item . Similar to ` justify - content ` | <nl> + | ` shouldWrapChildren ` | ` boolean ` | | If ` true ` , the children will be wrapped in a ` Box ` with ` display : inline - block ` , and the Box will take the spacing props | <nl> + <nl> + # # Slots <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | default | The content of the stack | <nl> 
mmm a / packages / chakra - ui - docs / docs / simplegrid . mdx <nl> ppp b / packages / chakra - ui - docs / docs / simplegrid . mdx <nl> + <nl> + < SEO <nl> + title = " SimpleGrid " <nl> + description = " SimpleGrid provides a friendly interface to create responsive grid layouts with ease . It renders a div element with display : grid . " <nl> + / > <nl> + <nl> # SimpleGrid <nl> + <nl> + SimpleGrid provides a friendly interface to create responsive grid layouts with ease . It renders a div element with display : grid . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { CSimpleGrid } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + Specifying the number of columns for the grid layout . <nl> + <nl> + ` ` ` vue live = true <nl> + < CSimpleGrid : columns = " 2 " : spacing = " 10 " > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < / CSimpleGrid > <nl> + ` ` ` <nl> + <nl> + You can also make it responsive by passing array or object values into the <nl> + ` columns ` prop . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - simple - grid : columns = " [ 2 , null , 3 ] " spacing = " 40px " > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < / c - simple - grid > <nl> + ` ` ` <nl> + <nl> + # # # Auto - responsive grid <nl> + <nl> + To make the grid responsive adjust automatically without passing ` columns ` , <nl> + simply pass the ` minChildWidth ` prop to specify the ` min - width ` a child should <nl> + have before adjusting the layout . <nl> + <nl> + This uses css grid ` auto - fit ` and ` minmax ( ) ` internally . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - simple - grid min - child - width = " 120px " spacing = " 40px " > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < / c - simple - grid > <nl> + ` ` ` <nl> + <nl> + # # # Changing the spacing for columns and rows <nl> + <nl> + Simply pass the ` spacing ` prop to change the row and column spacing between the <nl> + grid items . ` SimpleGrid ` also allows you pass ` spacingX ` and ` spacingY ` to <nl> + define the space between columns and rows respectively . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - simple - grid : columns = " 2 " spacing - x = " 40px " spacing - y = " 20px " > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < c - box background = " green " height = " 80px " > < / c - box > <nl> + < / c - simple - grid > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + SimpleGrid composes ` Box ` so you can pass all the ` Box ` props and css grid props <nl> + with addition of these : <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` columns ` | ` number ` | | The number of columns | <nl> + | ` spacing ` | ` GridProps [ " gridGap " ] ` | | The gap between the grid items | <nl> + | ` spacingX ` | ` GridProps [ " gridGap " ] ` | | The column gap between the grid items | <nl> + | ` spacingY ` | ` GridProps [ " gridGap " ] ` | | The row gap between the grid items | <nl> + | ` minChildWidth ` | ` CSSProperties [ " minWidth " ] ` | | The width at which child elements will break into columns . Pass a number for pixel values or a string for any other valid CSS length . | <nl> 
mmm a / packages / chakra - ui - docs / docs / select . mdx <nl> ppp b / packages / chakra - ui - docs / docs / select . mdx <nl> + <nl> + < SEO <nl> + title = " Select " <nl> + description = " Select component is a component that allows users pick a value from predefined options . Ideally , it should be used when there are more than 5 options , otherwise you might consider using a radio group instead . " <nl> + / > <nl> + <nl> # Select <nl> + <nl> + Select component is a component that allows users pick a value from predefined options . Ideally , it should be used when there are more than 5 options , otherwise you might consider using a radio group instead . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { CSelect } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + # # Usage <nl> + <nl> + Here ' s a basic usage of the Select component . <nl> + <nl> + ` ` ` vue live = true <nl> + < template > <nl> + < c - box mb = " 3 " w = " 300px " > <nl> + < c - select v - model = " burgerType " placeholder = " Select Burger " > <nl> + < option value = " grilled " > Grilled Backyard Burger < / option > <nl> + < option value = " pub - style " > The Pub - Style Burger < / option > <nl> + < option value = " jucy - lucy " > The Jucy Lucy < / option > <nl> + < / c - select > <nl> + < / c - box > <nl> + < / template > <nl> + < script > <nl> + export default { <nl> + data ( ) { <nl> + return { <nl> + burgerType : ' ' <nl> + } <nl> + } <nl> + } <nl> + < / script > <nl> + ` ` ` <nl> + <nl> + # # # Changing the size of the Select <nl> + <nl> + There are three sizes of select : large ( 48px ) , default ( 40px ) and small ( 32px ) . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 3 " > <nl> + < c - select placeholder = " large size " size = " lg " / > <nl> + < c - select placeholder = " default size " size = " md " / > <nl> + < c - select placeholder = " small size " size = " sm " / > <nl> + < / c - sack > <nl> + ` ` ` <nl> + <nl> + # # # Changing the appearance of the Select <nl> + <nl> + Just like the input component , select comes in 3 variants , ` outline ` , ` unstyled ` <nl> + , ` flushed ` , and ` filled ` . Pass the ` variant ` prop and set it to either of <nl> + these values . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 3 " > <nl> + < c - select variant = " outline " placeholder = " Outline " / > <nl> + < c - select variant = " filled " placeholder = " Filled " / > <nl> + < c - select variant = " flushed " placeholder = " Flushed " / > <nl> + < c - select variant = " unstyled " placeholder = " Unstyled " / > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> + # # # Overriding the styles of the Select <nl> + <nl> + Even though the select comes with predefined styles , you can override pretty <nl> + much any property . Here ' s we ' ll override the background color . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - select <nl> + backgroundColor = " tomato " <nl> + borderColor = " tomato " <nl> + color = " white " <nl> + placeholder = " Woohoo ! A new background color ! " <nl> + / > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + The Select component composes [ PseudoBox ] ( / pseudoBox ) so you can pass all ` PseudoBox ` props . <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` size ` | ` sm ` , ` md ` , ` lg ` | ` md ` | The visual size of the ` select ` element . | <nl> + | ` icon ` | ` string ` | ` chevron - down ` | The icon to use in place if the ` chevron - down ` | <nl> + | ` iconSize ` | ` BoxProps [ ' size ' ] ` | ` 20px ` | The visual size of the icon | <nl> + | ` variant ` | ` outline ` , ` unstyled ` , ` flushed ` , ` filled ` | ` outline ` | The variant of the select style to use . | <nl> + | ` focusBorderColor ` | ` string ` | | The border color when the select is focused . | <nl> + | ` errorBorderColor ` | ` string ` | | The border color when ` isInvalid ` is set to ` true ` . | <nl> + | ` isDisabled ` | ` boolean ` | ` false ` | If ` true ` , the select will be disabled . This sets ` aria - disabled = true ` and you can style this state by passing ` _disabled ` prop . | <nl> + | ` isInvalid ` | ` boolean ` | ` false ` | If ` true ` , the ` select ` will indicate an error . This sets ` aria - invalid = true ` and you can style this state by passing ` _invalid ` prop . | <nl> + | ` isRequired ` | ` boolean ` | ` false ` | If ` true ` , the select element will be required . | <nl> + | ` isReadOnly ` | ` boolean ` | ` false ` | If ` true ` , prevents the value of the select from being edited . | <nl> + | ` rootProps ` | ` BoxProps ` | | The props to pass to the wrapper of the select . The select is wrapped in a ` Box ` to help align the icon , if you want to pass some props to that wrapper , use this prop | <nl> + <nl> + # # Slots <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | default | contains the ` < option > ` element as children of ` CSelect ` | <nl> 
mmm a / packages / chakra - ui - docs / docs / slider . mdx <nl> ppp b / packages / chakra - ui - docs / docs / slider . mdx <nl> + <nl> + < SEO <nl> + title = " Slider " <nl> + description = " The Slider is used to allow users to make selections from a range of values . " <nl> + / > <nl> + <nl> # Slider <nl> + <nl> + The Slider is used to allow users to make selections from a range of values . <nl> + <nl> + Sliders reflect a range of values along a bar , from which users may select a <nl> + single value . They are ideal for adjusting settings such as volume , brightness , <nl> + or applying image filters . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { <nl> + CSlider , <nl> + CSliderTrack , <nl> + CSliderFilledTrack , <nl> + CSliderThumb <nl> + } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - slider default - value = " 56 " > <nl> + < c - slider - track / > <nl> + < c - slider - filled - track / > <nl> + < c - slider - thumb / > <nl> + < / c - slider > <nl> + ` ` ` <nl> + <nl> + # # # Changing the slider color <nl> + <nl> + ` ` ` vue live = true <nl> + < c - slider color = " pink " default - value = " 24 " > <nl> + < c - slider - track / > <nl> + < c - slider - filled - track / > <nl> + < c - slider - thumb / > <nl> + < / c - slider > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + # # # Slider Props <nl> + <nl> + The ` Slider ` component wraps all it ' s children in the [ Box ] ( / box ) component , so <nl> + you can pass all ` Box ` props to change it ' s style . <nl> + <nl> + | Name | Type | Default | Description | <nl> + | - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` value ` | ` number ` | | The value of the slider . | <nl> + | ` defaultValue ` | ` number ` | | The initial value of the slider . | <nl> + | ` max ` | ` number ` | | Standard ` input ` max attribute . | <nl> + | ` min ` | ` number ` | | Standard ` input ` min attribute . | <nl> + | ` step ` | ` number ` | | Standard ` input ` step attribute . | <nl> + | ` aria - label ` | ` string ` | | The accessible label . | <nl> + | ` aria - labelledby ` | ` string ` | | The ` id ` of the element that labels the sliders | <nl> + | ` aria - valuetext ` | ` string ` | | The aria - valuetext of the switch for accessibility . | <nl> + | ` orientation ` | ` string ` | | The orientation of the slider , only ` horizontal ` is supported for now . | <nl> + | ` getAriaValueText ` | ` ( value : number ) : string ` | | The callback to format the ` aria - valuetext ` . | <nl> + | ` size ` | ` sm ` , ` md ` , ` lg ` | | The size of the slider . | <nl> + | ` color ` | ` string ` | | The color scheme to use for the slider . Use a color key in ` theme . colors ` | <nl> + | ` name ` | ` string ` | | The name of the slider component when used in a form . | <nl> + | ` id ` | ` string ` | | The id of the slider component when used in a form . | <nl> + <nl> + # # Slider Events <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` change ` | Callback fired when the value of the slider changes . | <nl> + | ` onFocus ` | Callback fired when the thumb receives focus | <nl> + | ` blur ` | Callback fired when the thumb is blurred | <nl> + | ` mouseDown ` | Callback fired when the you mousedown on any part of the slider | <nl> + | ` keyDown ` | Callback fired when the you keydown on any part of the slider | <nl> + <nl> + # # Slots <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | default | Slot for the children of the slider . | <nl> + <nl> + # # # SliderThumb Props <nl> + <nl> + SliderThumb composes [ PseudoBox ] ( / pseudobox ) so you can pass all PseudoBox props <nl> + to change it ' s style . <nl> + <nl> + # # # SliderFilledTrack Props <nl> + <nl> + SliderFilledTrack composes [ PseudoBox ] ( / pseudobox ) so you can pass all PseudoBox <nl> + props to change it ' s style . <nl> + <nl> + # # # SliderTrack Props <nl> + <nl> + SliderTrack composes [ Box ] ( / box ) so you can pass all Box props to change it ' s <nl> + style . <nl> 
mmm a / packages / chakra - ui - docs / docs / textarea . mdx <nl> ppp b / packages / chakra - ui - docs / docs / textarea . mdx <nl> + <nl> + < SEO <nl> + title = " Textarea " <nl> + description = " The Textarea component allows you to easily create multi - line text inputs . " <nl> + / > <nl> + <nl> # Textarea <nl> + <nl> + The Textarea component allows you to easily create multi - line text inputs . <nl> + <nl> + # # Import <nl> + <nl> + ` ` ` js <nl> + import { CTextarea } from ' @ chakra - ui / vue ' <nl> + ` ` ` <nl> + <nl> + # # Usage <nl> + <nl> + ` ` ` vue live = true <nl> + < c - textarea placeholder = " Here is a sample placeholder " / > <nl> + ` ` ` <nl> + <nl> + # # Disabled Textarea <nl> + <nl> + ` ` ` vue live = true <nl> + < c - textarea is - disabled placeholder = " Here is a sample placeholder " / > <nl> + ` ` ` <nl> + <nl> + # # Invalid Textarea <nl> + <nl> + ` ` ` vue live = true <nl> + < c - textarea is - invalid placeholder = " Here is a sample placeholder " / > <nl> + ` ` ` <nl> + <nl> + # # Props <nl> + <nl> + The Textarea composes the [ Input ] ( / input ) component <nl> + <nl> + # # Event <nl> + <nl> + | Name | Description | <nl> + | - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | change | Handles what happens when the content of the textarea changes | <nl> 
mmm a / packages / chakra - ui - docs / docs / tabs . mdx <nl> ppp b / packages / chakra - ui - docs / docs / tabs . mdx <nl> An accessible tabs component . <nl> - The ` Tab ` and ` TabPanel ` elements are associated by their order in the tree . <nl> + The ` CTab ` and ` CTabPanel ` elements are associated by their order in the tree . <nl> None of the components are empty wrappers , each is associated with a real DOM <nl> element in the document , giving you maximum control over styling and <nl> composition . <nl> 
mmm a / packages / chakra - ui - docs / docs / getting - started . mdx <nl> ppp b / packages / chakra - ui - docs / docs / getting - started . mdx <nl> Install Chakra UI and it ' s peer dependency , ` emotion ` <nl> + <nl> < br / > <nl> ` ` ` bash <nl> yarn add @ chakra - ui / vue emotion <nl> ` ` ` <nl> + <nl> or ( with npm ) <nl> ` ` ` bash <nl> npm install @ chakra - ui / vue emotion - - save <nl> ` ` ` <nl> + # # # With Vue CLI plugin <nl> + <nl> + If you are using Vue CLI 3 , then you can install Chakra UI and get a base setup using the Chakra UI [ plugin ] ( https : / / www . npmjs . com / package / vue - cli - plugin - chakra - ui ) . <nl> + <nl> + ` ` ` bash <nl> + vue add chakra - ui <nl> + ` ` ` <nl> + <nl> # # # With Nuxt . js <nl> - If you ' re using Nuxt , you need to install ` @ nuxtjs / emotion ` package as well to server - side render your styles . <nl> + If you ' re using Nuxt , you need to install ` @ nuxtjs / emotion ` package as well to server - side render your styles . <nl> ` ` ` bash <nl> yarn add @ chakra - ui / vue emotion @ nuxtjs / emotion <nl> @ @ - 22 , 39 + 32 , 37 @ @ yarn add @ chakra - ui / vue emotion @ nuxtjs / emotion <nl> Create a theme object to include custom color , typography , and layout values . Chakra UI comes with a default theme , so this step is optional . <nl> - <nl> - <nl> ` ` ` js <nl> / / example theme . js <nl> export default { <nl> - breakpoints : [ " 30em " , " 48em " , " 62em " , " 80em " ] , <nl> + breakpoints : [ ' 30em ' , ' 48em ' , ' 62em ' , ' 80em ' ] , <nl> fonts : { <nl> heading : ' " Avenir Next " , sans - serif ' , <nl> - body : " system - ui , sans - serif " , <nl> - mono : " Menlo , monospace " , <nl> + body : ' system - ui , sans - serif ' , <nl> + mono : ' Menlo , monospace ' <nl> } , <nl> fontSizes : { <nl> - xs : " 0 . 75rem " , <nl> - sm : " 0 . 875rem " , <nl> - md : " 1rem " , <nl> - lg : " 1 . 125rem " , <nl> - xl : " 1 . 25rem " , <nl> - " 2xl " : " 1 . 5rem " , <nl> - " 3xl " : " 1 . 875rem " , <nl> - " 4xl " : " 2 . 25rem " , <nl> - " 5xl " : " 3rem " , <nl> - " 6xl " : " 4rem " , <nl> - } , <nl> - } ; <nl> + xs : ' 0 . 75rem ' , <nl> + sm : ' 0 . 875rem ' , <nl> + md : ' 1rem ' , <nl> + lg : ' 1 . 125rem ' , <nl> + xl : ' 1 . 25rem ' , <nl> + ' 2xl ' : ' 1 . 5rem ' , <nl> + ' 3xl ' : ' 1 . 875rem ' , <nl> + ' 4xl ' : ' 2 . 25rem ' , <nl> + ' 5xl ' : ' 3rem ' , <nl> + ' 6xl ' : ' 4rem ' <nl> + } <nl> + } <nl> ` ` ` <nl> # # Usage <nl> + <nl> * * 1 . Import the Chakra UI plugin in your ` main . js ` file . * * <nl> In order to use Chakra , you need to wrap your main application inside the Chakra ` CThemeProvider ` component . <nl> You can do so as shown below . <nl> - <nl> ` ` ` js <nl> import Vue from ' vue ' <nl> import Chakra , { CThemeProvider } from ' @ chakra - ui / vue ' <nl> @ @ - 64 , 14 + 72 , 12 @ @ Vue . use ( Chakra ) <nl> new Vue ( { <nl> el : ' # app ' , <nl> - render : ( h ) = > h ( CThemeProvider , [ <nl> - h ( App ) <nl> - ] ) <nl> + render : ( h ) = > h ( CThemeProvider , [ h ( App ) ] ) <nl> } ) . $ mount ( ) <nl> ` ` ` <nl> - <nl> If you ' d like to add extend the Chakra theme with custom brand colors you can do so as shown below . This is also optional . <nl> + <nl> < br / > <nl> ` ` ` js <nl> @ @ - 84 , 24 + 90 , 22 @ @ Vue . use ( Chakra , { <nl> colors : { <nl> . . . defaultTheme . colors , <nl> brand : { <nl> - 900 : " # 1a365d " , <nl> - 800 : " # 153e75 " , <nl> - 700 : " # 2a69ac " , <nl> - } , <nl> + 900 : ' # 1a365d ' , <nl> + 800 : ' # 153e75 ' , <nl> + 700 : ' # 2a69ac ' <nl> + } <nl> } <nl> } <nl> } ) <nl> new Vue ( { <nl> el : ' # app ' , <nl> - render : ( h ) = > h ( CThemeProvider , [ <nl> - h ( App ) <nl> - ] ) <nl> + render : ( h ) = > h ( CThemeProvider , [ h ( App ) ] ) <nl> } ) . $ mount ( ) <nl> ` ` ` <nl> - <nl> # # Injecting Global Styles . <nl> + <nl> Sometimes you may need to apply css reset styles to your application . <nl> Chakra UI exports a ` CReset ` that ' ll remove browser default styles . It ' s heavily inspired by [ Tailwind ' s preflight ] ( https : / / unpkg . com / tailwindcss @ 1 . 1 . 2 / dist / base . css ) <nl> @ @ - 116 , 10 + 120 , 7 @ @ Vue . use ( Chakra ) <nl> new Vue ( { <nl> el : ' # app ' , <nl> - render : ( h ) = > h ( CThemeProvider , [ <nl> - h ( CReset ) , <nl> - h ( App ) <nl> - ] ) <nl> + render : ( h ) = > h ( CThemeProvider , [ h ( CReset ) , h ( App ) ] ) <nl> } ) . $ mount ( ) <nl> ` ` ` <nl> @ @ - 150 , 10 + 151 , 11 @ @ export default { <nl> ` ` ` <nl> # # # Codesandbox starters <nl> + <nl> - [ Vue Starter ] ( https : / / codesandbox . io / s / chakra - ui - vue - starter - 2sy0g ) <nl> - [ Nuxt Starter ] ( https : / / codesandbox . io / s / chakra - ui - nuxt - demo - f8tq4 ) <nl> - [ Gridsome Starter ] ( https : / / codesandbox . io / s / chakra - ui - gridsome - demo - 038c9 ) <nl> - <nl> # # # Storybook Components <nl> + <nl> You can also view all developed components in [ Storybook ] ( https : / / chakra - ui - vue . netlify . com ) ! <nl> 
mmm a / packages / chakra - ui - docs / docs / accessibility . mdx <nl> ppp b / packages / chakra - ui - docs / docs / accessibility . mdx <nl> All authored components are compliant with the WAI - ARIA standards for authored components . <nl> - We ' ve written the time to write summarized description of the accessibility support for <nl> + We ' ve taken the time to write summarized description of the accessibility support for <nl> all authored components in @ chakra - ui / vue . We called this document an accessibility report <nl> and can be found in the ` accessibility . md ` file in the respective component ' s source directory . <nl> 
mmm a / packages / chakra - ui - docs / utils / all - routes . js <nl> ppp b / packages / chakra - ui - docs / utils / all - routes . js <nl> ' Contributing ' <nl> ] <nl> + export const footerLinks = [ <nl> + ' Contributors ' <nl> + ] <nl> + <nl> export default [ <nl> . . . topNavLinks , <nl> . . . aboutNavLinks , <nl> + . . . footerLinks , <nl> . . . components <nl> ] <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " @ babel / plugin - transform - parameters " : " ^ 7 . 7 . 4 " , <nl> " @ babel / preset - env " : " ^ 7 . 9 . 5 " , <nl> - " @ chakra - ui / vue " : " ^ 0 . 5 . 3 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 5 . 4 " , <nl> " @ commitlint / cli " : " ^ 8 . 2 . 0 " , <nl> " @ commitlint / config - conventional " : " ^ 8 . 2 . 0 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> 
mmm a / packages / chakra - ui - docs / components / Navbar . vue <nl> ppp b / packages / chakra - ui - docs / components / Navbar . vue <nl> ml = " auto " <nl> > <nl> + < CBox as = " li " mr = " 4 " > <nl> + < CLink color = " gray . 600 " : _hover = " { color : ' vue . 400 ' } " is - external href = " https : / / chakra - ui . com / " > <nl> + Chakra UI React <nl> + < / CLink > <nl> + < / CBox > <nl> < CBox as = " li " mr = " 4 " > <nl> < CLink color = " gray . 500 " : _hover = " { color : ' vue . 400 ' } " is - external href = " https : / / github . com / chakra - ui / chakra - ui - vue " > <nl> < CIcon name = " github " size = " 20px " / > <nl> 
mmm a / packages / chakra - ui - docs / components / Hero . vue <nl> ppp b / packages / chakra - ui - docs / components / Hero . vue <nl> href = " https : / / chakra - ui . com / " <nl> > <nl> - Looking for React . js verison ? <nl> + Looking for React . js version ? <nl> < / CLink > <nl> < / CFlex > <nl> < / CFlex > <nl> 
mmm a / website / pages / stack . mdx <nl> ppp b / website / pages / stack . mdx <nl> < / c - stack > <nl> ` ` ` <nl> + # # Stacking HTML elements <nl> + The ` CStack ` element is able also to stack HTML elements . Internally it wraps HTML elements inside a ` CBox ` primitive <nl> + component and spaces it like it would any other Chakra component . <nl> + <nl> + ` ` ` vue live = true <nl> + < c - stack : spacing = " 4 " > <nl> + < c - text > Chakra component 1 < / c - text > <nl> + < p > HTML paragraph element < / p > <nl> + < h3 > HTML heading element < / h3 > <nl> + < c - text > Chakra component 2 < / c - text > <nl> + < / c - stack > <nl> + ` ` ` <nl> + <nl> # # Props <nl> | Name | Type | Default | Description | <nl> 
mmm a / website / plugins / chakra - ui . js <nl> ppp b / website / plugins / chakra - ui . js <nl> fePlay , <nl> feExternalLink , <nl> feGlobe , <nl> + feGithub , <nl> feMenu , <nl> feLinkedin , <nl> feSearch , <nl> @ @ - 49 , 7 + 50 , 8 @ @ Vue . use ( Chakra . default , { <nl> feEdit , <nl> feSettings , <nl> feTwitter , <nl> - feCoffee <nl> + feCoffee , <nl> + feGithub <nl> } , <nl> extend : { <nl> storybook : { <nl> 
mmm a / website / package . json <nl> ppp b / website / package . json <nl> " @ mdx - js / vue - loader " : " ^ 1 . 6 . 1 " , <nl> " @ nuxtjs / dotenv " : " ^ 1 . 4 . 0 " , <nl> - " @ nuxtjs / emotion " : " ^ 0 . 0 . 1 " , <nl> + " @ nuxtjs / emotion " : " ^ 0 . 1 . 0 " , <nl> " @ nuxtjs / now - builder " : " ^ 0 . 17 . 0 " , <nl> " @ nuxtjs / google - analytics " : " ^ 2 . 4 . 0 " , <nl> " @ nuxtjs / pwa " : " ^ 3 . 0 . 0 - 0 " , <nl> 
mmm a / website / pages / color - mode . mdx <nl> ppp b / website / pages / color - mode . mdx <nl> In your main . js <nl> ` ` ` js <nl> import Vue from ' vue ' <nl> - import Chakra , { CThemeProvider , CColorModeProvider CReset } from ' @ chakra - ui / vue ' <nl> + import Chakra , { CThemeProvider , CColorModeProvider , CReset } from ' @ chakra - ui / vue ' <nl> import App from ' . / App . vue ' <nl> Vue . use ( Chakra ) <nl> 
mmm a / website / pages / with - vuepress . mdx <nl> ppp b / website / pages / with - vuepress . mdx <nl> } <nl> } <nl> } ) <nl> - } ) <nl> + } <nl> ` ` ` <nl> Now you can wrap your main application inside the Chakra ` CThemeProvider ` component by creating a layout wrapper in ` theme / layouts / Layout . vue ` . <nl> @ @ - 105 , 7 + 105 , 11 @ @ export default { <nl> # # Using Chakra components <nl> - _In your ` App . vue ` file . _ <nl> + You can now use Chakra in your custom components for your theme in either your ` theme / components ` folder ( available to other theme components ) , <nl> + or your ` theme / global - components ` folder ( available to your markdown pages as well as other components ) . <nl> + Learn more about theme inheritance in the [ Vuepress documentation ] ( https : / / vuepress . vuejs . org / theme / inheritance . html # inheritance - strategy ) <nl> + <nl> + _In your ` my - component . vue ` file . _ <nl> ` ` ` vue <nl> < template > <nl> @ @ - 120 , 7 + 124 , 7 @ @ _In your ` App . vue ` file . _ <nl> import { CBox , CButton } from ' @ chakra - ui / vue ' <nl> export default { <nl> - name : ' App ' , <nl> + name : ' MyComponent ' , <nl> components : { <nl> CBox , <nl> CButton <nl> @ @ - 128 , 3 + 132 , 13 @ @ export default { <nl> } <nl> < / script > <nl> ` ` ` <nl> + <nl> + # # # Vuepress Codesandbox Starters <nl> + <nl> + Here ' s a link to sample component starter with Nuxt . js <nl> + <nl> + - [ Vuepress Starter ] ( https : / / codesandbox . io / s / chakra - ui - vuepress - starter - qx4up ) <nl> + <nl> + # # # Storybook Components <nl> + <nl> + You can also view all developed components in [ Storybook ] ( https : / / chakra - ui - vue . netlify . com ) ! <nl> 
mmm a / packages / chakra - ui - core / src / CButtonGroup / CButtonGroup . js <nl> ppp b / packages / chakra - ui - core / src / CButtonGroup / CButtonGroup . js <nl> attrs : { <nl> d : ' inline - block ' , <nl> . . . data . attrs , <nl> + role : ' group ' , <nl> ' data - chakra - component ' : ' CButtonGroup ' <nl> } , <nl> on : listeners <nl> 
mmm a / website / layouts / default . vue <nl> ppp b / website / layouts / default . vue <nl> < CReset / > <nl> < Navbar / > <nl> - < CFlex max - h = " calc ( 100vh - 60px ) " > <nl> + < CFlex <nl> + max - h = " calc ( 100vh - 60px ) " <nl> + max - w = " 1440px " <nl> + mx = " auto " <nl> + > <nl> < Sidebar / > <nl> < CBox <nl> id = " main - content " <nl> 
mmm a / website / pages / theme . mdx <nl> ppp b / website / pages / theme . mdx <nl> } , <nl> } ; <nl> ` ` ` <nl> + <nl> + # # Config <nl> + <nl> + The theme ' s config is to provide global settings that are used by different <nl> + parts of the Chakra UI system . <nl> + <nl> + | Property | Description | Default | <nl> + | - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - | <nl> + | ` cssVarPrefix ` | The prefix to use for the generated CSS custom properties | ` chakra ` | <nl> + | ` initialColorMode ` | The initial color mode your application should start with . < br reset / > Can be either ` light ` or ` dark ` mode | ` light ` | <nl> + | ` useSystemColorMode ` | If ` true ` , the chakra system will update color mode < br reset / > based on your system preferences | ` false ` | <nl> + <nl> + You can leverage the ` extendTheme ` function to override a specific theme config <nl> + property . <nl> + <nl> + ` ` ` js <nl> + export default { <nl> + config : { <nl> + cssVarPrefix : " ck " , <nl> + } , <nl> + } ; <nl> + ` ` ` <nl> \ No newline at end of file <nl> 
mmm a / website / pages / responsive - styles . mdx <nl> ppp b / website / pages / responsive - styles . mdx <nl> > We use the ` @ media ( min - width ) ` media queries to ensure values are <nl> > mobile - first . <nl> + Responsive syntax relies on the breakpoints defined in the theme object . Chakra <nl> + UI provides default breakpoints , here ' s what it looks like : <nl> + <nl> + ` ` ` js <nl> + const breakpoints = { <nl> + sm : ' 30em ' , / / 480px upwards <nl> + md : ' 48em ' , / / 768px upwards <nl> + lg : ' 62em ' , / / 992px upwards <nl> + xl : ' 80em ' , / / 1280px upwards <nl> + ' 2xl ' : ' 96em ' / / 1536px upwards <nl> + } <nl> + ` ` ` <nl> + <nl> + To make styles responsive , you can use either the array or object syntax . <nl> + <nl> + # # The Array syntax <nl> + <nl> + All style props accept arrays as values for mobile - first responsive styles . This <nl> + is the recommended method . <nl> + <nl> ` ` ` vue <nl> < template > <nl> < c - box <nl> @ @ - 76 , 28 + 96 , 103 @ @ It ' ll generate a CSS that looks like this <nl> } <nl> ` ` ` <nl> - <nl> ___NOTE___ : In the shortcut example ` ' 100 % ' ` is used instead of ` 1 ` because in the default Chakra UI Vue theme , ` theme . sizes [ 1 ] = 0 . 25rem ` . This means that using a prop like ` : width = " 1 " ` will render a width of 4px and not ` ' 100 % ' ` <nl> - The equivalent of this style if you passed it as an object . <nl> + To interpret array responsive values , Chakra UI converts the values defined in ` theme . breakpoints ` <nl> + and sorts them in ascending order . Afterward , we map the <nl> + values defined in the array to the breakpoints <nl> ` ` ` js <nl> - / / First , create an alias for breakpoints <nl> - const breakpoints = [ " 30em " , " 48em " , " 62em " , " 80em " ] ; <nl> - / / aliases <nl> - breakpoints . sm = breakpoints [ 0 ] ; <nl> - breakpoints . md = breakpoints [ 1 ] ; <nl> - breakpoints . lg = breakpoints [ 2 ] ; <nl> - breakpoints . xl = breakpoints [ 3 ] ; <nl> + / / This is the default breakpoint <nl> + const breakpoints = { <nl> + sm : ' 30em ' , <nl> + md : ' 48em ' , <nl> + lg : ' 62em ' , <nl> + xl : ' 80em ' , <nl> + ' 2xl ' : ' 96em ' <nl> + } <nl> + <nl> + / / Internally , we transform to this <nl> + const breakpoints = [ ' 0em ' , ' 30em ' , ' 48em ' , ' 62em ' , ' 80em ' , ' 96em ' ] <nl> ` ` ` <nl> + Here ' s how to interpret this syntax : <nl> - then <nl> + - ` 300px ` : From ` 0em ` upwards <nl> + - ` 400px ` : From ` 30em ` upwards <nl> + - ` 500px ` : From ` 48em ` upwards <nl> - ` ` ` vue <nl> - < c - box : width = " { base : 1 , sm : 1 / 2 , md : 1 / 4 } " / > <nl> + > To skip certain breakpoints , you can pass ` null ` to any position in the array <nl> + > to avoid generating unnecessary CSS . <nl> + <nl> + # # The Object syntax <nl> + <nl> + You can also define responsive values with breakpoint aliases in an object . Any <nl> + undefined alias key will define the base , non - responsive value . <nl> + <nl> + Let ' s say you have a ` CText ` that looks like this : <nl> + <nl> + ` ` ` vue live = false <nl> + < c - text font - size = ' 40px ' > This is a text < / c - text > <nl> + ` ` ` <nl> + <nl> + To make the ` fontSize ` responsive using the object syntax , here ' s what you need <nl> + to do : <nl> + <nl> + ` ` ` vue live = false <nl> + < c - text : font - size = " { base : ' 24px ' , md : ' 40px ' , lg : ' 56px ' } " > <nl> + This is responsive text <nl> + < / c - text > <nl> + ` ` ` <nl> + <nl> + > * * Remember , Chakra UI uses the min - width media query for responsive design * * . <nl> + > The breakpoints are : ` sm = 30em ` , ` md = 48em ` , ` lg = 62em ` , ` xl = 80em ` <nl> + <nl> + Here ' s how to interpret this syntax : <nl> + <nl> + - ` base ` : From ` 0em ` upwards <nl> + - ` md ` : From ` 48em ` upwards <nl> + - ` lg ` : From ` 62em ` upwards <nl> + <nl> + # # Customizing Breakpoints <nl> + <nl> + In some scenarios , you might need to define custom breakpoints for your <nl> + application . We recommended using common aliases like ` sm ` , ` md ` , ` lg ` , and <nl> + ` xl ` . <nl> + <nl> + To define custom breakpoints , pass them as an object containing the aliases . <nl> + <nl> + > Note : Ensure the css unit of your breakpoints are the same . Use all ` px ` or <nl> + > all ` em ` , don ' t mix them . <nl> + <nl> + ` ` ` js <nl> + / / 1 . Import the utilities <nl> + import { extendTheme } from ' @ chakra - ui / vue ' <nl> + <nl> + / / 2 . Update the breakpoints as key - value pairs <nl> + const customBreakpoints = { <nl> + sm : ' 320px ' , <nl> + md : ' 768px ' , <nl> + lg : ' 960px ' , <nl> + xl : ' 1200px ' , <nl> + ' 2xl ' : ' 1536px ' <nl> + } <nl> + <nl> + / / 3 . Extend the theme <nl> + Vue . use ( Chakra , { <nl> + extendTheme : { <nl> + breakpoints : customBreakpoints <nl> + . . . <nl> + } <nl> + } <nl> + <nl> + / / 4 . Now you can use the custom breakpoints <nl> + < c - box : width = { base : ' 100 % ' , sm : ' 50 % ' , md : ' 25 % ' } / > <nl> ` ` ` <nl> + > Note : If you ' re using * * pixels * * as breakpoint values make sure to * * always * * <nl> + > provide a value for the ` 2xl ` breakpoint , which by its default pixels value is <nl> + > * * " 1536px " * * . <nl> # # Demo <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> / / client only <nl> } <nl> - if ( target = = = ' server ' ) { <nl> + if ( target = = = ' node ' ) { <nl> / / server only <nl> } <nl> @ @ - 69 , 7 + 69 , 7 @ @ module . exports = function myRazzlePlugin ( webpackConfig , env , webpack , options ) { <nl> / / client only <nl> } <nl> - if ( target = = = ' server ' ) { <nl> + if ( target = = = ' node ' ) { <nl> / / server only <nl> } <nl> @ @ - 148 , 7 + 148 , 7 @ @ module . exports = { <nl> / / client only <nl> } <nl> - if ( target = = = ' server ' ) { <nl> + if ( target = = = ' node ' ) { <nl> / / server only <nl> } <nl> 
mmm a / examples / with - single - exposed - port / README . md <nl> ppp b / examples / with - single - exposed - port / README . md <nl> } , <nl> } ; <nl> ` ` ` <nl> + <nl> + A bit more complex on a subpath behind a reverse nginx proxy : <nl> + <nl> + ` ` ` nginxconf <nl> + http { <nl> + <nl> + server { <nl> + listen 8080 ; # or 80 or 443 <nl> + server_name _ ; <nl> + location / razzle - dev { # no / , no regex <nl> + return 302 / razzle - dev / ; # a / <nl> + } <nl> + location / razzle - dev / { # no regex <nl> + proxy_pass http : / / 127 . 0 . 0 . 1 : 3001 / ; # a / <nl> + proxy_http_version 1 . 1 ; <nl> + proxy_set_header Upgrade \ $ http_upgrade ; <nl> + proxy_set_header Connection " upgrade " ; <nl> + } <nl> + location / razzle - dev / sockjs - node / { # no regex <nl> + proxy_pass http : / / 127 . 0 . 0 . 1 : 3001 ; # no / <nl> + proxy_http_version 1 . 1 ; <nl> + proxy_set_header Upgrade \ $ http_upgrade ; <nl> + proxy_set_header Connection " upgrade " ; <nl> + } <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> + ` ` ` js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + modify ( config , { target , dev } , webpack ) { <nl> + const appConfig = config ; / / stay immutable here <nl> + <nl> + if ( target = = = ' web ' & & dev ) { <nl> + appConfig . devServer . public = ' localhost : 8080 ' / / or 80 or 443 <nl> + appConfig . devServer . proxy = { <nl> + context : ( ) = > true , <nl> + target : ' http : / / localhost : 3000 ' <nl> + } ; <nl> + appConfig . devServer . sockPath = ' / razzle - dev / sockjs - node ' ; <nl> + } <nl> + <nl> + return appConfig ; <nl> + } , <nl> + } ; <nl> + <nl> + ` ` ` <nl> 
mmm a / examples / with - single - exposed - port / README . md <nl> ppp b / examples / with - single - exposed - port / README . md <nl> A bit more complex on a subpath behind a reverse nginx proxy : <nl> + <nl> + ` ` ` js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + modify ( config , { target , dev } , webpack ) { <nl> + const appConfig = config ; / / stay immutable here <nl> + <nl> + if ( target = = = ' web ' & & dev ) { <nl> + appConfig . devServer . public = ' localhost : 8080 ' / / or 80 or 443 <nl> + appConfig . devServer . proxy = { <nl> + context : ( ) = > true , <nl> + target : ' http : / / localhost : 3000 ' <nl> + } ; <nl> + appConfig . devServer . sockPath = ' / razzle - dev / sockjs - node ' ; <nl> + } <nl> + <nl> + return appConfig ; <nl> + } , <nl> + } ; <nl> + <nl> + ` ` ` <nl> + <nl> + ` ` ` bash <nl> + CLIENT_PUBLIC_PATH = http : / / localhost : 8080 / razzle - dev / yarn start <nl> + ` ` ` <nl> + <nl> ` ` ` nginxconf <nl> http { <nl> @ @ - 82 , 25 + 109 , 3 @ @ http { <nl> } <nl> } <nl> ` ` ` <nl> - <nl> - ` ` ` js <nl> - ' use strict ' ; <nl> - <nl> - module . exports = { <nl> - modify ( config , { target , dev } , webpack ) { <nl> - const appConfig = config ; / / stay immutable here <nl> - <nl> - if ( target = = = ' web ' & & dev ) { <nl> - appConfig . devServer . public = ' localhost : 8080 ' / / or 80 or 443 <nl> - appConfig . devServer . proxy = { <nl> - context : ( ) = > true , <nl> - target : ' http : / / localhost : 3000 ' <nl> - } ; <nl> - appConfig . devServer . sockPath = ' / razzle - dev / sockjs - node ' ; <nl> - } <nl> - <nl> - return appConfig ; <nl> - } , <nl> - } ; <nl> - <nl> - ` ` ` <nl> 
mmm a / packages / razzle - plugin - typescript / README . md <nl> ppp b / packages / razzle - plugin - typescript / README . md <nl> } ; <nl> ` ` ` <nl> + See full configuration in the [ typescript example project ] ( https : / / github . com / jaredpalmer / razzle / tree / master / examples / with - typescript ) . <nl> + <nl> # # # With custom options : <nl> ` ` ` js <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> + # # Options <nl> + <nl> + As of Razzle 3 . 2 , you can modify some parts of Razzle with options . <nl> + <nl> + We show the default options here : <nl> + <nl> + ` ` ` js <nl> + / / . / razzle . config . js <nl> + module . exports = { <nl> + options : { <nl> + cssPrefix : ' static / css ' , <nl> + jsPrefix : ' static / js ' , <nl> + mediaPrefix : ' static / media ' , <nl> + } , <nl> + } ; <nl> + ` ` ` <nl> + <nl> + More options will be added in the future , some options now in experimental will be moved here . <nl> + <nl> # # Plugins <nl> As of Razzle 2 . 0 , you can add your plugins to modify your setup . <nl> 
mmm a / examples / with - now - v2 / README . md <nl> ppp b / examples / with - now - v2 / README . md <nl> Take a look at ` now . json ` . We are uploading the result of the razzle build , and setting up the routes for the app entry point and all static resources . <nl> + ` ` ` json <nl> + { <nl> + " version " : 2 , <nl> + " name " : " example " , <nl> + " builds " : [ <nl> + { <nl> + " src " : " build / public / * * " , <nl> + " use " : " @ now / static " <nl> + } , <nl> + { <nl> + " src " : " build / server . js " , <nl> + " use " : " @ now / node - server " <nl> + } <nl> + ] , <nl> + " routes " : [ <nl> + { " src " : " / assets . json " , " dest " : " build / assets . json " } , <nl> + { " src " : " / favicon . ico " , " dest " : " build / public / favicon . ico " } , <nl> + { " src " : " / robots . txt " , " dest " : " build / public / robots . txt " } , <nl> + { " src " : " / static / ( . * ) " , " dest " : " build / public / static / $ 1 " } , <nl> + { " src " : " / ( . * ) " , " dest " : " build / server . js " } <nl> + <nl> + ] , <nl> + " env " : { <nl> + " NODE_ENV " : " production " <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> We are also setting the ` NODE_ENV ` environment variable . Most likely , your app will use other environment variables , beware you should not commit secrets like api keys and others into your repository . Take a look at now ' s documentation to understand what you should do in such cases . <nl> # # Documentation <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> options : { <nl> pluginOptions , / / the options passed to the plugin ( { name : ' pluginname ' , options : { key : ' value ' } } ) <nl> razzleOptions , / / the modified options passed to Razzle in the ` options ` key in ` razzle . config . js ` ( options : { key : ' value ' } ) <nl> - webpackOptions / / the modified options that will be used to configure webpack / webpack loaders and plugins <nl> + webpackOptions / / the modified options that was used to configure webpack / webpack loaders and plugins <nl> } , <nl> paths / / the modified paths that will be used by Razzle . <nl> } ) { <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> # # Debugging with Inspector <nl> - - ` npm start - - - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> + - ` npm start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> - - ` npm start - - - - inspect - brk = [ host : port ] ` This is the same as ` - - inspect ` , but will also break before user code starts . ( to give a debugger time to attach before early code runs ) For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> + - ` npm start - - inspect - brk = [ host : port ] ` This is the same as ` - - inspect ` , but will also break before user code starts . ( to give a debugger time to attach before early code runs ) For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> All the hook functions supported in plugins is also supported here . We show only one function here for brevity . <nl> + In Razzle 3 . 3 ` modify ` was deprecated . In Razzle 4 . 0 it was replaced with ` modifyWebpackConfig ` . <nl> + <nl> ` ` ` js <nl> / / razzle . config . js <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> } <nl> ` ` ` <nl> - You can [ take a look at this file ] ( https : / / github . com / jaredpalmer / razzle / blob / next / packages / babel - preset - razzle / index . js ) to learn about the presets included by ` razzle / babel ` . <nl> + You can [ take a look at this file ] ( https : / / github . com / jaredpalmer / razzle / blob / finch / packages / babel - preset - razzle / index . js ) to learn about the presets included by ` razzle / babel ` . <nl> To add presets / plugins * * without configuring them * * , you can do it this way : <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> More features may be added in the future and may become fully supported features . <nl> + # # # Razzle 4 . 0 <nl> + <nl> + If you want to be ready for the Razzle 4 . 0 release you can enble some experimental features to be sure you build will work on 4 . 0 . <nl> + <nl> + ` ` ` js <nl> + / / razzle . config . js <nl> + <nl> + module . exports = { <nl> + experimental : { <nl> + newBabel : true , <nl> + newExternals : true , <nl> + newSplitChunks : true , <nl> + newContentHash : true , <nl> + newMainFields : true , <nl> + } <nl> + } ; <nl> + ` ` ` <nl> + <nl> # # # To enable react refresh : <nl> ` ` ` js <nl> 
mmm a / packages / razzle / README . md <nl> ppp b / packages / razzle / README . md <nl> - [ ! [ CircleCI ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master . svg ? style = shield ) ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master ) [ ! [ npm ] ( https : / / img . shields . io / npm / dm / razzle ) ] ( https : / / www . npmjs . com / package / razzle ) [ ! [ Known Vulnerabilities ] ( https : / / snyk . io / test / github / jaredpalmer / razzle / badge . svg ? targetFile = package . json ) ] ( https : / / snyk . io / test / github / jaredpalmer / razzle ? targetFile = package . json ) ! [ Node CI ] ( https : / / github . com / jaredpalmer / razzle / workflows / Node % 20CI / badge . svg ) [ ! [ GitHub version ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle . svg ) ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle ) ! [ Razzle - status ] ( https : / / david - dm . org / jaredpalmer / razzle . svg ? path = packages / razzle ) [ ! [ license ] ( https : / / badgen . now . sh / badge / license / MIT ) ] ( . / LICENSE ) <nl> + [ ! [ GitHub version ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle . svg ) ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle ) [ ! [ npm ] ( https : / / img . shields . io / npm / dm / razzle ) ] ( https : / / www . npmjs . com / package / razzle ) ! [ Node CI ] ( https : / / github . com / jaredpalmer / razzle / workflows / Node % 20CI / badge . svg ) [ ! [ CircleCI ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master . svg ? style = shield ) ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master ) [ ! [ Known Vulnerabilities ] ( https : / / snyk . io / test / github / jaredpalmer / razzle / badge . svg ? targetFile = package . json ) ] ( https : / / snyk . io / test / github / jaredpalmer / razzle ? targetFile = package . json ) ! [ Razzle - status ] ( https : / / david - dm . org / jaredpalmer / razzle . svg ? path = packages / razzle ) [ ! [ license ] ( https : / / badgen . now . sh / badge / license / MIT ) ] ( . / LICENSE ) <nl> Universal JavaScript applications are tough to setup . Either you buy into a framework like [ Next . js ] ( https : / / github . com / zeit / next . js ) or [ react - server ] ( https : / / github . com / redfin / react - server ) , fork a boilerplate , or set things up yourself . Aiming to fill this void , Razzle is a tool that abstracts all complex configuration needed for SSR into a single dependency - - giving you the awesome developer experience of [ create - react - app ] ( https : / / github . com / facebookincubator / create - react - app ) , but then leaving the rest of your app ' s architectural decisions about frameworks , routing , and data fetching up to you . With this approach , Razzle not only works with React , but also Reason , Elm , Vue , Angular , and most importantly . . . . . . whatever comes next . <nl> 
mmm a / packages / razzle / README . md <nl> ppp b / packages / razzle / README . md <nl> - [ ! [ GitHub version ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle . svg ) ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle ) [ ! [ npm ] ( https : / / img . shields . io / npm / dm / razzle ) ] ( https : / / www . npmjs . com / package / razzle ) ! [ Node CI ] ( https : / / github . com / jaredpalmer / razzle / workflows / Node % 20CI / badge . svg ) [ ! [ CircleCI ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master . svg ? style = shield ) ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master ) [ ! [ Known Vulnerabilities ] ( https : / / snyk . io / test / github / jaredpalmer / razzle / badge . svg ? targetFile = package . json ) ] ( https : / / snyk . io / test / github / jaredpalmer / razzle ? targetFile = package . json ) ! [ Razzle - status ] ( https : / / david - dm . org / jaredpalmer / razzle . svg ? path = packages / razzle ) [ ! [ license ] ( https : / / badgen . now . sh / badge / license / MIT ) ] ( . / LICENSE ) <nl> + [ ! [ GitHub version ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle . svg ) ] ( https : / / badge . fury . io / gh / jaredpalmer % 2Frazzle ) [ ! [ npm ] ( https : / / img . shields . io / npm / dm / razzle ) ] ( https : / / www . npmjs . com / package / razzle ) ! [ Node CI ] ( https : / / github . com / jaredpalmer / razzle / workflows / Node % 20CI / badge . svg ) [ ! [ CircleCI ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master . svg ? style = shield ) ] ( https : / / circleci . com / gh / jaredpalmer / razzle / tree / master ) [ ! [ Known Vulnerabilities ] ( https : / / snyk . io / test / github / jaredpalmer / razzle / badge . svg ? targetFile = package . json ) ] ( https : / / snyk . io / test / github / jaredpalmer / razzle ? targetFile = package . json ) ! [ Razzle - status ] ( https : / / david - dm . org / jaredpalmer / razzle . svg ? path = packages / razzle ) [ ! [ license ] ( https : / / badgen . now . sh / badge / license / MIT ) ] ( . / LICENSE ) [ ! [ Join the community on Spectrum ] ( https : / / withspectrum . github . io / badge / badge . svg ) ] ( https : / / spectrum . chat / palmer ) <nl> Universal JavaScript applications are tough to setup . Either you buy into a framework like [ Next . js ] ( https : / / github . com / zeit / next . js ) or [ react - server ] ( https : / / github . com / redfin / react - server ) , fork a boilerplate , or set things up yourself . Aiming to fill this void , Razzle is a tool that abstracts all complex configuration needed for SSR into a single dependency - - giving you the awesome developer experience of [ create - react - app ] ( https : / / github . com / facebookincubator / create - react - app ) , but then leaving the rest of your app ' s architectural decisions about frameworks , routing , and data fetching up to you . With this approach , Razzle not only works with React , but also Reason , Elm , Vue , Angular , and most importantly . . . . . . whatever comes next . <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> ` ` ` <nl> Now that you ' ve configured your project to support absolute imports , if you want to import a module located at src / components / Button . js , you can import the module like so : <nl> + <nl> ` ` ` js <nl> import Button from ' components / Button ' ; <nl> ` ` ` <nl> + # # Aliased Paths / Modules <nl> + <nl> + You can configure your application to support importing modules using aliased paths . This can be done by configuring a jsconfig . json or tsconfig . json file in the root of your project . If you ' re using TypeScript in your project , you will already have a tsconfig . json file . <nl> + <nl> + ` ` ` json <nl> + { <nl> + " compilerOptions " : { <nl> + " baseUrl " : " src " , <nl> + " paths " : { <nl> + " @ extra / * " : [ " . . / extra / * " ] <nl> + } <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> + Now that you ' ve configured your project to support aliased imports , if you want to import a module located at extra / components / Button . js , you can import the module like so : <nl> + <nl> + ` ` ` js <nl> + import Button from ' @ extra / components / Button ' ; <nl> + ` ` ` <nl> + <nl> # # Experimental <nl> Razzle has support for some experimental features . Coming soon . <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> alt = " Razzle Hot Restart " <nl> / > <nl> + # # Dependencies <nl> + <nl> + To make sure razzle is installed properly make sure razzle peerdependencies are installed , run : <nl> + <nl> + ` ` ` bash <nl> + yarn add razzle razzle - dev - utils babel - preset - razzle webpack - dev - server @ 3 . 11 . 0 mini - css - extract - plugin @ 0 . 9 . 0 - - dev <nl> + ` ` ` <nl> + <nl> + Choose your webpack version <nl> + <nl> + ` ` ` bash <nl> + yarn add webpack @ 5 . 16 . 0 - - dev <nl> + # or <nl> + yarn add webpack @ 4 . 46 . 0 - - dev <nl> + ` ` ` <nl> + <nl> + Also if there are issues , try adding specific package versions to resolutions in ` package . json ` . <nl> + <nl> # # Debugging with Inspector <nl> - ` npm start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> # # Debugging with Inspector <nl> - - ` npm start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> + - ` npm start - - - - inspect = [ host : port ] ` or ` yarn start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> - - ` npm start - - inspect - brk = [ host : port ] ` This is the same as ` - - inspect ` , but will also break before user code starts . ( to give a debugger time to attach before early code runs ) For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> + - ` npm start - - - - inspect - brk = [ host : port ] ` or ` yarn start - - inspect - brk = [ host : port ] ` This is the same as ` - - inspect ` , but will also break before user code starts . ( to give a debugger time to attach before early code runs ) For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> 
mmm a / website / pages / deployment - options / azure . md <nl> ppp b / website / pages / deployment - options / azure . md <nl> + Add razzle config <nl> + <nl> + ` ` ` js <nl> + / / razzle . config . js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + options : { <nl> + forceRuntimeEnvVars : [ ' HOST ' , ' PORT ' ] <nl> + } <nl> + } ; <nl> + ` ` ` <nl> + <nl> Create web . config <nl> ` ` ` xml <nl> < ? xml version = " 1 . 0 " encoding = " utf - 8 " ? > <nl> < ! - - <nl> + web . config <nl> This configuration file is required if iisnode is used to run node processes behind <nl> IIS or IIS Express . For more information , visit : <nl> https : / / github . com / tjanczuk / iisnode / blob / master / src / samples / configuration / web . config <nl> @ @ - 66 , 10 + 80 , 10 @ @ Create web . config <nl> < / configuration > <nl> ` ` ` <nl> - Build the Razzle project <nl> + Zip the Razzle project <nl> ` ` ` bash <nl> - yarn build <nl> + zip - r site . zip * - x " build / * " " node_modules / * " <nl> ` ` ` <nl> Login to Azure <nl> @ @ - 87 , 18 + 101 , 21 @ @ webappname = myRazzle $ RANDOM <nl> az group create - - location westeurope - - name myResourceGroup <nl> # Create an App Service plan in ` FREE ` tier . <nl> - az appservice plan create - - name myAppServicePlan - - resource - group myResourceGroup - - sku FREE <nl> + az appservice plan create - - name myAppServicePlan - - resource - group myResourceGroup - - sku FREE - - is - linux <nl> # Create a web app . <nl> - az webapp create - - name $ webappname - - resource - group myResourceGroup - - plan myAppServicePlan <nl> + az webapp create - - name $ webappname - - resource - group myResourceGroup - - plan myAppServicePlan - - runtime " node | 12 - lts " <nl> + <nl> + # Enable building with zip deploy <nl> + az webapp config appsettings set - - name $ webappname - - resource - group myResourceGroup - - settings SCM_DO_BUILD_DURING_DEPLOYMENT = true <nl> # Get FTP publishing profile and query for publish URL and credentials <nl> creds = ( $ ( az webapp deployment list - publishing - profiles - - name $ webappname - - resource - group myResourceGroup \ <nl> - - - query " [ ? contains ( publishMethod , ' FTP ' ) ] . [ publishUrl , userName , userPWD ] " - - output tsv ) ) <nl> + - - query " [ ? contains ( publishMethod , ' ZipDeploy ' ) ] . [ publishUrl , userName , userPWD ] " - - output tsv ) ) <nl> # Use cURL to perform FTP upload . You can use any FTP tool to do this instead . <nl> - curl - T index . html - u $ { creds [ 1 ] } : $ { creds [ 2 ] } $ { creds [ 0 ] } / <nl> + curl - X POST - u $ { creds [ 1 ] } : $ { creds [ 2 ] } - - data - binary @ " site . zip " https : / / $ { creds [ 0 ] } / api / zipdeploy <nl> # Copy the result of the following command into a browser to see the static HTML site . <nl> - echo http : / / $ webappname . azurewebsites . net <nl> + echo https : / / $ webappname . azurewebsites . net <nl> ` ` ` <nl> 
mmm a / website / pages / deployment - options / aws . md <nl> ppp b / website / pages / deployment - options / aws . md <nl> + Add dependencies <nl> + <nl> + ` ` ` bash <nl> + yarn add ts - node typescript @ types / node aws - cdk @ aws - cdk / core @ aws - cdk / aws - s3 @ aws - cdk / aws - s3 - deployment @ aws - cdk / aws - lambda @ aws - cdk / aws - apigateway @ aws - cdk / aws - ssm @ aws - cdk / aws - secretsmanager - - dev <nl> + ` ` ` <nl> + <nl> + ` ` ` jsonc <nl> + / / cdk . json <nl> + { <nl> + " app " : " npx ts - node - - prefer - ts - exts bin / cdk . ts " , <nl> + " context " : { <nl> + " @ aws - cdk / core : enableStackNameDuplicates " : " true " , <nl> + " aws - cdk : enableDiffNoFail " : " true " , <nl> + " @ aws - cdk / core : stackRelativeExports " : " true " , <nl> + " @ aws - cdk / aws - ecr - assets : dockerIgnoreSupport " : true , <nl> + " @ aws - cdk / aws - secretsmanager : parseOwnedSecretName " : true , <nl> + " @ aws - cdk / aws - kms : defaultKeyPolicies " : true , <nl> + " @ aws - cdk / aws - s3 : grantWriteWithoutAcl " : true <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> + <nl> + ` ` ` typescript <nl> + / / bin / cdk . ts <nl> + # ! / usr / bin / env node <nl> + import ' source - map - support / register ' ; <nl> + import * as cdk from ' @ aws - cdk / core ' ; <nl> + import { RazzleStack } from ' . . / lib / RazzleStack ' ; <nl> + <nl> + const app = new cdk . App ( ) ; <nl> + new RazzleStack ( app , ' RazzleStack ' , { name : ' basic ' } ) ; <nl> + ` ` ` <nl> + <nl> ` ` ` typescript <nl> - / / helpers . ts <nl> + / / lib / helpers . ts <nl> import * as SSM from ' @ aws - cdk / aws - ssm ' ; <nl> import * as CDK from ' @ aws - cdk / core ' ; <nl> @ @ - 16 , 7 + 50 , 7 @ @ export interface ConfigProps extends CDK . StackProps { <nl> export class ModeStack extends CDK . Stack { <nl> public readonly mode : string = this . node . tryGetContext ( ' mode ' ) | | ' development ' ; <nl> public readonly Mode : string = <nl> - this . node . tryGetContext ( ' mode ' ) . replace ( / ^ \ w / , ( c : string ) = > c . toUpperCase ( ) ) | | ' Development ' ; <nl> + this . mode . replace ( / ^ \ w / , ( c : string ) = > c . toUpperCase ( ) ) ; <nl> constructor ( scope : CDK . Construct , id : string , props ? : ConfigProps ) { <nl> super ( scope , id , props ) ; <nl> @ @ - 25 , 7 + 59 , 7 @ @ export class ModeStack extends CDK . Stack { <nl> ` ` ` <nl> ` ` ` typescript <nl> - / / RazzleStack . ts <nl> + / / lib / RazzleStack . ts <nl> import * as CDK from ' @ aws - cdk / core ' ; <nl> import * as S3 from ' @ aws - cdk / aws - s3 ' ; <nl> import * as S3Deployment from ' @ aws - cdk / aws - s3 - deployment ' ; <nl> 
mmm a / website / pages / deployment - options / azure . md <nl> ppp b / website / pages / deployment - options / azure . md <nl> webappname = myRazzle $ RANDOM <nl> # Create a resource group . <nl> - az group create - - location westeurope - - name myResourceGroup <nl> + az group create \ <nl> + - - location westeurope \ <nl> + - - name myResourceGroup <nl> # Create an App Service plan in ` FREE ` tier . <nl> - az appservice plan create - - name myAppServicePlan - - resource - group myResourceGroup - - sku FREE - - is - linux <nl> + az appservice plan create - - name myAppServicePlan \ <nl> + - - resource - group myResourceGroup \ <nl> + - - sku FREE \ <nl> + - - is - linux <nl> # Create a web app . <nl> - az webapp create - - name $ webappname - - resource - group myResourceGroup - - plan myAppServicePlan - - runtime " node | 12 - lts " <nl> + az webapp create \ <nl> + - - name $ webappname \ <nl> + - - resource - group myResourceGroup \ <nl> + - - plan myAppServicePlan \ <nl> + - - runtime " node | 12 - lts " <nl> # Enable building with zip deploy <nl> - az webapp config appsettings set - - name $ webappname - - resource - group myResourceGroup - - settings SCM_DO_BUILD_DURING_DEPLOYMENT = true <nl> - <nl> - # Get FTP publishing profile and query for publish URL and credentials <nl> - creds = ( $ ( az webapp deployment list - publishing - profiles - - name $ webappname - - resource - group myResourceGroup \ <nl> - - - query " [ ? contains ( publishMethod , ' ZipDeploy ' ) ] . [ publishUrl , userName , userPWD ] " - - output tsv ) ) <nl> + az webapp config appsettings set \ <nl> + - - name $ webappname \ <nl> + - - resource - group myResourceGroup \ <nl> + - - settings SCM_DO_BUILD_DURING_DEPLOYMENT = true <nl> + <nl> + # Get ZipDeploy publishing profile and query for publish URL and credentials <nl> + creds = ( $ ( az webapp deployment list - publishing - profiles \ <nl> + - - name $ webappname \ <nl> + - - resource - group myResourceGroup \ <nl> + - - query " [ ? contains ( publishMethod , ' ZipDeploy ' ) ] . [ publishUrl , userName , userPWD ] " \ <nl> + - - output tsv ) ) <nl> # Use cURL to perform http zip upload . You can use any http tool to do this instead . <nl> - curl - X POST - u $ { creds [ 1 ] } : $ { creds [ 2 ] } - - data - binary @ " site . zip " https : / / $ { creds [ 0 ] } / api / zipdeploy <nl> + curl - X POST \ <nl> + - u $ { creds [ 1 ] } : $ { creds [ 2 ] } \ <nl> + - - data - binary @ " site . zip " \ <nl> + https : / / $ { creds [ 0 ] } / api / zipdeploy <nl> # Copy the result of the following command into a browser to see the static HTML site . <nl> echo https : / / $ webappname . azurewebsites . net <nl> 
mmm a / website / pages / deployment - options / plesk . md <nl> ppp b / website / pages / deployment - options / plesk . md <nl> + <nl> + First make sure your Plesk install supports Node . js <nl> + <nl> + Go into the domain manager for your domain . Look on the icons below next to ` Hosting Settings ` there should be a green icon with ` Node . js ` . <nl> + <nl> + If this is not the case it may be disabled for you or not installed . Ask your host to enable it or install it like so : <nl> + <nl> + Under home click ` Add or Remove Components ` . <nl> + <nl> + Then click ` Add / Remove Components ` - Under ` Web hosting ` set ` NodeJS support ` and <nl> + ` Phusion Passenger server ` to ` install ` and click continue . <nl> + <nl> + After you made sure your Plesk supports Node . js add razzle config . <nl> + <nl> + ` ` ` js <nl> + / / razzle . config . js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + options : { <nl> + forceRuntimeEnvVars : [ ' HOST ' , ' PORT ' ] <nl> + } <nl> + } ; <nl> + ` ` ` <nl> + <nl> + Create ` handler . js ` in the app root <nl> + <nl> + ` ` ` js <nl> + / / handler . js <nl> + module . exports = require ( ' . / build / server . js ' ) ; <nl> + ` ` ` <nl> + <nl> + Build the Razzle project and make a tar archive <nl> + <nl> + ` ` ` bash <nl> + yarn build <nl> + tar czvf site . tar . gz build package . json handler . js <nl> + ` ` ` <nl> + <nl> + Go into ` File Manager ` for your domain on Plesk . <nl> + <nl> + Create a ` site ` directory in the ` Home directory ` upload the site . tar . gz here and extract it . <nl> + <nl> + Go into the domain manager for your domain . Click the ` Node . js ` icon . <nl> + <nl> + Set ` Document Root ` to ` / site / build / public ` , ` Application Root ` to ` / site ` and ` Application Startup File ` to ` handler . js ` . <nl> + <nl> + Then click ` Enable Node . js ` followed by ` NPM Install ` at the top . <nl> + <nl> + Go into the domain manager for your domain . Click ` Open in web ` . <nl> 
mmm a / website / pages / deployment - options / aws . md <nl> ppp b / website / pages / deployment - options / aws . md <nl> - Add dependencies <nl> - <nl> - ` ` ` bash <nl> - yarn add ts - node typescript @ types / node aws - cdk @ aws - cdk / core @ aws - cdk / aws - s3 @ aws - cdk / aws - s3 - deployment @ aws - cdk / aws - lambda @ aws - cdk / aws - apigateway @ aws - cdk / aws - ssm @ aws - cdk / aws - secretsmanager - - dev <nl> - ` ` ` <nl> Add razzle config . <nl> @ @ - 25 , 77 + 20 , 41 @ @ Add this to ` src / index . js ` <nl> export const handler = app ; <nl> ` ` ` <nl> - Add this to ` package . json ` <nl> + Build the Razzle project <nl> - ` ` ` json <nl> - { <nl> - " scripts " : { <nl> - " cdk " : " cdk " <nl> - } <nl> - } <nl> + ` ` ` bash <nl> + yarn build <nl> ` ` ` <nl> - Add ` cdk . json ` <nl> + Init cdk app <nl> - ` ` ` jsonc <nl> - / / cdk . json <nl> - { <nl> - " app " : " npx ts - node - - prefer - ts - exts bin / cdk . ts " , <nl> - " context " : { <nl> - " @ aws - cdk / core : enableStackNameDuplicates " : " true " , <nl> - " aws - cdk : enableDiffNoFail " : " true " , <nl> - " @ aws - cdk / core : stackRelativeExports " : " true " , <nl> - " @ aws - cdk / aws - ecr - assets : dockerIgnoreSupport " : true , <nl> - " @ aws - cdk / aws - secretsmanager : parseOwnedSecretName " : true , <nl> - " @ aws - cdk / aws - kms : defaultKeyPolicies " : true , <nl> - " @ aws - cdk / aws - s3 : grantWriteWithoutAcl " : true <nl> - } <nl> - } <nl> + ` ` ` bash <nl> + mkdir razzle - cdk <nl> + cd razzle - cdk <nl> + <nl> + cdk init app - - language typescript <nl> ` ` ` <nl> - Add ` tsconfig . json ` <nl> + Add dependencies <nl> - ` ` ` jsonc <nl> - / / tsconfig . json <nl> - { <nl> - " compilerOptions " : { <nl> - " target " : " ES2018 " , <nl> - " module " : " commonjs " , <nl> - " lib " : [ " es2018 " ] , <nl> - " declaration " : true , <nl> - " strict " : true , <nl> - " noImplicitAny " : true , <nl> - " strictNullChecks " : true , <nl> - " noImplicitThis " : true , <nl> - " alwaysStrict " : true , <nl> - " noUnusedLocals " : false , <nl> - " noUnusedParameters " : false , <nl> - " noImplicitReturns " : true , <nl> - " noFallthroughCasesInSwitch " : false , <nl> - " inlineSourceMap " : true , <nl> - " inlineSources " : true , <nl> - " experimentalDecorators " : true , <nl> - " strictPropertyInitialization " : false , <nl> - " typeRoots " : [ " . / node_modules / @ types " ] <nl> - } , <nl> - " exclude " : [ " cdk . out " ] <nl> - } <nl> + ` ` ` bash <nl> + yarn add @ aws - cdk / aws - s3 @ aws - cdk / aws - s3 - deployment @ aws - cdk / aws - lambda @ aws - cdk / aws - apigateway @ aws - cdk / aws - ssm @ aws - cdk / aws - secretsmanager - - dev <nl> ` ` ` <nl> - Add ` bin / cdk . ts ` <nl> + Add ` razzle - cdk / bin / razzle - cdk . ts ` <nl> ` ` ` typescript <nl> / / bin / cdk . ts <nl> # ! / usr / bin / env node <nl> import ' source - map - support / register ' ; <nl> import * as cdk from ' @ aws - cdk / core ' ; <nl> - import { RazzleStack } from ' . . / lib / RazzleStack ' ; <nl> + import { RazzleCdkStack } from ' . . / lib / razzle - cdk - stack ' ; <nl> const app = new cdk . App ( ) ; <nl> - new RazzleStack ( app , ' RazzleStack ' , { name : ' basic ' } ) ; <nl> + new RazzleCdkStack ( app , ' RazzleCdkStack ' , { name : ' basic ' } ) ; <nl> ` ` ` <nl> - Add ` lib / helpers . ts ` <nl> + Add ` razzle - cdk / lib / helpers . ts ` <nl> ` ` ` typescript <nl> / / lib / helpers . ts <nl> @ @ - 121 , 7 + 80 , 7 @ @ export class ModeStack extends CDK . Stack { <nl> } <nl> ` ` ` <nl> - Add ` lib / RazzleStack . ts ` <nl> + Add ` razzle - cdk / lib / razzle - cdk - stack . ts ` <nl> ` ` ` typescript <nl> / / lib / RazzleStack . ts <nl> @ @ - 135 , 7 + 94 , 7 @ @ import * as SecretsManager from ' @ aws - cdk / aws - secretsmanager ' ; <nl> import { ConfigProps , getParam , ModeStack } from ' . / helpers ' ; <nl> - export class RazzleStack extends ModeStack { <nl> + export class RazzleCdkStack extends ModeStack { <nl> constructor ( app : CDK . App , id : string , props : ConfigProps ) { <nl> super ( app , id , props ) ; <nl> @ @ - 170 , 7 + 129 , 7 @ @ export class RazzleStack extends ModeStack { <nl> * Deploy public folder of build to ` my - razzle - app - bucket - public - files - $ { this . mode } ` bucket <nl> * / <nl> new S3Deployment . BucketDeployment ( this , ` $ { publicBucketName } - deploy ` , { <nl> - sources : [ S3Deployment . Source . asset ( ' . / build / public ' ) ] , <nl> + sources : [ S3Deployment . Source . asset ( ' . . / build / public ' ) ] , <nl> destinationBucket : bucketPublicFiles , <nl> } ) ; <nl> @ @ - 203 , 7 + 162 , 7 @ @ export class RazzleStack extends ModeStack { <nl> * / <nl> const myRazzleAppSsrFunction = new Lambda . Function ( this , ` MyRazzleAppSSRFunction $ { this . Mode } ` , { <nl> description : ` Lambda Function that runs My Razzle App SSR on $ { this . Mode } ` , <nl> - code : Lambda . Code . fromAsset ( ' . / build ' , { <nl> + code : Lambda . Code . fromAsset ( ' . . / build ' , { <nl> exclude : [ ' public ' , ' static ' , ' * . json ' ] , <nl> } ) , <nl> handler : ' server . handler ' , <nl> @ @ - 244 , 3 + 203 , 10 @ @ export class RazzleStack extends ModeStack { <nl> } <nl> } <nl> ` ` ` <nl> + <nl> + Bootstrap and deploy <nl> + <nl> + ` ` ` bash <nl> + yarn cdk bootstrap <nl> + yarn cdk deploy <nl> + ` ` ` <nl> 
mmm a / website / pages / deployment - options / aws . md <nl> ppp b / website / pages / deployment - options / aws . md <nl> buildType : ' serverless ' <nl> } , <nl> modifyPaths ( { <nl> - webpackObject , <nl> - options : { <nl> - razzleOptions , <nl> + paths , <nl> + } ) { <nl> + paths . prodAppServerIndexJs = path . join ( paths . appSrc , ' index . prod ' ) ; <nl> + return paths ; <nl> } , <nl> + modifyWebpackConfig ( { <nl> + env : { <nl> + target , <nl> + dev , <nl> + } , <nl> + webpackConfig , <nl> paths , <nl> } ) { <nl> - if ( process . env . NODE_ENV = = = ' production ' ) { <nl> - paths . appServerIndexJs = path . join ( paths . appSrc , ' index . prod ' ) ; <nl> + if ( target = = = ' node ' ) { <nl> + if ( ! dev ) { <nl> + webpackConfig . entry . server = [ paths . prodAppServerIndexJs ] ; <nl> } <nl> - return paths ; <nl> } <nl> + return webpackConfig ; <nl> + } , <nl> } ; <nl> ` ` ` <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> cd razzle <nl> git checkout - B < my - branch > <nl> NODE_ENV = development yarn install - - - ignore - engines <nl> + # optionally install add - dependencies <nl> + sudo npm install add - dependencies - g <nl> ` ` ` <nl> This will install all ` node_modules ` in all the packages and all the examples and symlink <nl> inter - dependencies . Thus when you make local changes in any of the packages you can try them <nl> - immediately in all the examples . <nl> + immediately in all the examples . ` add - dependencies ` can be used to just add packages to ` package . json ` . <nl> # # # Commands <nl> - - ` yarn run clean ` : Clean up all ` node_modules ` and remove all symlinks from packages and examples . <nl> - - ` yarn run bootstrap ` : Run ` yarn ` on all examples and packages . Automatically symlinks inter - dependent modules . <nl> - - ` yarn run test ` : Runs all tests <nl> - - ` yarn run test : packages ` : Runs tests for packages <nl> - - ` yarn run test : e2e ` : Runs end - to - end tests <nl> - - ` yarn run build - docs ` : Builds docs / updates doc TOC <nl> + - ` yarn clean ` : Clean up all ` node_modules ` and remove all symlinks from packages and examples . <nl> + - ` yarn bootstrap ` : Run ` yarn ` on all packages . Automatically symlinks inter - dependent modules . <nl> + - ` yarn test ` : Runs all tests <nl> + - ` yarn test : packages ` : Runs tests for packages <nl> + - ` yarn test : e2e ` : Runs end - to - end tests <nl> + - ` yarn build - docs ` : Builds docs / updates doc TOC <nl> + - ` yarn bootstrap - examples ` : Run ` yarn ` with specific examples as workspaces . Automatically symlinks inter - dependent modules . Run ` yarn restrap ` in the example to reinstall . <nl> + - ` yarn new - example ` : Creates a new example from another example . ` yarn new - example basic new - example ` . <nl> + - ` yarn publish - all - stable ` : Does a a stable release <nl> + - ` yarn publish - all - canary ` : Does a ` razzle @ canary ` release . <nl> # # # Updating your fork <nl> @ @ - 68 , 7 + 74 , 7 @ @ git pull origin master <nl> # # Adding examples <nl> # # # Use ` examples / basic ` as template <nl> - If you ' d like to add an example , I suggest you duplicate the ` examples / basic ` folder and use that as kind of base template . Before you start adding stuff , go ahead and change the name of the package in the your new example ' s ` package . json ` . Then go back to the project root and run ` yarn bootstrap ` . This will make sure that your new example is using your local version of all the ` packages ` . <nl> + If you ' d like to add an example , I suggest you duplicate the ` examples / basic ` folder ` yarn new - example basic your - example ` and use that as kind of base template . Before you start adding stuff , go ahead and change the name of the package in the your new example ' s ` package . json ` . Then go back to the project root and run ` yarn bootstrap - examples your - example ` . This will make sure that your new example is using your local version of all the ` packages ` . <nl> # # # Naming examples <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> # # Adding examples <nl> - # # # Use ` examples / basic ` as template <nl> + # # # Use examples / basic as template <nl> If you ' d like to add an example , I suggest you duplicate the ` examples / basic ` folder ` yarn new - example basic your - example ` and use that as kind of base template . Before you start adding stuff , go ahead and change the name of the package in the your new example ' s ` package . json ` . Then go back to the project root and run ` yarn bootstrap - examples your - example ` . This will make sure that your new example is using your local version of all the ` packages ` . <nl> # # # Naming examples <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> - [ Commands ] ( # commands ) <nl> - [ Updating your fork ] ( # updating - your - fork ) <nl> - [ Adding examples ] ( # adding - examples ) <nl> - - [ Use ` examples / basic ` as template ] ( # use - examplesbasic - as - template ) <nl> + - [ Use ` examples / basic ` as template ] ( # use - examples - basic - as - template ) <nl> - [ Naming examples ] ( # naming - examples ) <nl> - [ How to get your example merged ] ( # how - to - get - your - example - merged ) <nl> - [ Guidelines ] ( # guidelines ) <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> # # # npm export <nl> - Exports a static version of the application in production mode . <nl> + Exports a static version of the application in production mode . Must add the ` export ` command to ` package . json ` ' s scripts along with a ` static_export . js ` file in the ` src ` directory . See [ Static Site Generation ] ( https : / / razzlejs . org / docs / static - export / ) for more details . <nl> # # # rs <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> - ` yarn test : packages ` : Runs tests for packages <nl> - ` yarn test : e2e ` : Runs end - to - end tests <nl> - ` yarn build - docs ` : Builds docs / updates doc TOC <nl> - - ` yarn bootstrap - examples ` : Run ` yarn ` with specific examples as workspaces . Automatically symlinks inter - dependent modules . Run ` yarn restrap ` in the example to reinstall . <nl> - - ` yarn new - example ` : Creates a new example from another example . ` yarn new - example basic new - example ` . <nl> - - ` yarn publish - all - stable ` : Does a a stable release <nl> - ` yarn publish - all - canary ` : Does a ` razzle @ canary ` release . <nl> + - ` yarn publish - all - stable ` : Does a a stable release ( uses the npm version released of the packages ) <nl> + - ` yarn new - example ` : Creates a new example from another example . ` yarn new - example basic new - example ` . <nl> + - ` yarn bootstrap - examples ` : Run ` yarn ` with specific examples as workspaces . Automatically symlinks inter - dependent modules . Run ` yarn restrap ` in the example to reinstall . <nl> + - ` yarn test : examples : simple ` : Runs tests for all simple examples ( uses the npm version released of the packages ) <nl> + - ` yarn test : examples : complex ` : Runs tests for all complex examples ( uses the npm version released of the packages ) <nl> + - ` yarn test : examples ` : Runs tests for all examples ( uses the npm version released of the packages ) <nl> + <nl> + # # # Workflow for working on razzle core with examples <nl> + <nl> + ` ` ` bash <nl> + <nl> + git clone https : / / github . com / < YOUR_GITHUB_USERNAME > / razzle . git <nl> + cd razzle <nl> + git checkout < my - branch > <nl> + NODE_ENV = development yarn install - - - ignore - engines <nl> + <nl> + sudo npm install add - dependencies - g <nl> + <nl> + pwd <nl> + # / home / oyvind / Documents / GitHub / razzle / <nl> + <nl> + yarn install <nl> + <nl> + # to make sure tests pass <nl> + yarn test - - runInBand <nl> + <nl> + # to add a new example <nl> + yarn new - example existingexample with - somefeature <nl> + <nl> + # to work on a example <nl> + cd examples / basic <nl> + example = " $ ( basename $ PWD ) " <nl> + pushd . . / . . <nl> + <nl> + # if it is a example with webpack5 you need to do <nl> + yarn add - W webpack @ 5 . 16 . 0 <nl> + <nl> + # switch back to webpack4 later to work with webpack4 <nl> + yarn add - W webpack @ 4 . 46 . 0 <nl> + <nl> + # then <nl> + yarn bootstrap - examples $ example <nl> + popd <nl> + yarn build <nl> + <nl> + # if you want to add dependencies to the example <nl> + add - dependencies somedependency <nl> + yarn restrap <nl> + <nl> + # if you make changes to startserver plugin <nl> + pushd . . / . . <nl> + cd packages / razzle - start - server - webpack - plugin <nl> + yarn build <nl> + popd <nl> + ` ` ` <nl> # # # Updating your fork <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> The build is minified and the filenames include the hashes . <nl> Your app is ready to be deployed ! <nl> + By default this uses NODE_ENV = production and asks if you want to run it . <nl> + <nl> + If you nont want the confirmation add - - noninteractive to your build command . <nl> + <nl> + If you want to use a different env file e . g . . env . something - staging file you can add - - node - env = something - staging <nl> + <nl> # # # npm run start : prod <nl> Runs the compiled app in production . <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> Also if there are issues , try adding specific package versions to resolutions in ` package . json ` . <nl> + # # Common problems <nl> + <nl> + If you have issues with css this might be related to postcss being resolved wrong . <nl> + <nl> + To fix this add : <nl> + <nl> + ` ` ` json <nl> + { <nl> + " postcss " : " 8 . 2 . 4 " <nl> + } <nl> + ` ` ` <nl> + <nl> + To resolutions in your package . json . For npm see [ here ] ( https : / / stackoverflow . com / questions / 52416312 / npm - equivalent - of - yarn - resolutions ) . <nl> + <nl> # # Debugging with Inspector <nl> - ` npm start - - - - inspect = [ host : port ] ` or ` yarn start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> 
mmm a / packages / razzle / config / loadRazzleConfig . js <nl> ppp b / packages / razzle / config / loadRazzleConfig . js <nl> module . exports = ( webpackObject , razzleConfig , packageJsonIn ) = > { <nl> return new Promise ( async resolve = > { <nl> console . info ( " If you have issues with css make sure postcss resolves to v8 . 2 . 4 . " ) ; <nl> - console . info ( " See : \ n " ) ; <nl> + console . info ( " See : https : / / razzlejs . org / getting - started # common - problems \ n " ) ; <nl> console . warn ( " CssMinimizerPlugin currently uses clean - css , \ nwe will switch to cssnano once it supports postcss v8 . 2 . 4 . \ n " ) ; <nl> let razzle = razzleConfig | | { } ; <nl> 
mmm a / packages / razzle / README . md <nl> ppp b / packages / razzle / README . md <nl> Visit < a aria - label = " razzle getting started " href = " https : / / razzle - git - canary . jared . vercel . app / getting - started " > https : / / razzle - git - canary . jared . vercel . app / getting - started < / a > to get started with Razzle . <nl> + # # Examples <nl> + <nl> + Razzle has many examples , we might have one that fits your needs <nl> + <nl> + See : [ The examples ] ( https : / / github . com / jaredpalmer / razzle / tree / master / examples ) <nl> + <nl> # # Documentation <nl> Visit < a aria - label = " razzle docs " href = " https : / / razzle - git - canary . jared . vercel . app / " > https : / / razzle - git - canary . jared . vercel . app / < / a > to view the documentation . <nl> 
mmm a / website / pages / docs / upgrade - guide . md <nl> ppp b / website / pages / docs / upgrade - guide . md <nl> ` ` ` bash <nl> yarn add - - dev \ <nl> - webpack - dev - server @ 3 . 11 . 0 \ <nl> - mini - css - extract - plugin @ 0 . 9 . 0 \ <nl> - postcss @ 8 . 2 . 4 <nl> + razzle \ <nl> + razzle - dev - utils \ <nl> + babel - preset - razzle <nl> ` ` ` <nl> + . . . and Razzle peerDependencies <nl> + <nl> Update / add razzle peerdependencies <nl> ` ` ` bash <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> Also if there are issues , try adding specific package versions to resolutions in ` package . json ` . <nl> - # # Common problems <nl> + # # Common issues <nl> If you have issues with css this might be related to postcss being resolved wrong . <nl> @ @ - 115 , 6 + 115 , 42 @ @ To fix this add : <nl> } <nl> ` ` ` <nl> + If you get a error like this : <nl> + <nl> + ` ` ` <nl> + node_modules / react - images - upload / index . css : 1 <nl> + . fileUploader { <nl> + ^ <nl> + <nl> + SyntaxError : Unexpected token ' . ' <nl> + at wrapSafe ( internal / modules / cjs / loader . js : 1072 : 16 ) <nl> + ` ` ` <nl> + <nl> + It means node tries to use ` index . css ` as a node module . <nl> + <nl> + To fix this make sure the module with the css is not externalized . <nl> + <nl> + ` ` ` js <nl> + / / razzle . config . js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + modifyWebpackOptions ( { <nl> + options : { <nl> + webpackOptions , / / the modified options that was used to configure webpack / webpack loaders and plugins <nl> + } <nl> + } ) { <nl> + <nl> + / / If you use experimental . newExternals <nl> + webpackOptions . notNodeExternalResMatch = ( request , context ) = > { <nl> + return / react - images - upload / . test ( request ) <nl> + } ; <nl> + <nl> + return webpackOptions ; <nl> + } , <nl> + } ; <nl> + ` ` ` <nl> + <nl> To resolutions in your package . json . For npm see [ here ] ( https : / / stackoverflow . com / questions / 52416312 / npm - equivalent - of - yarn - resolutions ) . <nl> # # Debugging with Inspector <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> " postcss " : " 8 . 2 . 4 " <nl> } <nl> ` ` ` <nl> + To resolutions in your package . json . For npm see [ here ] ( https : / / stackoverflow . com / questions / 52416312 / npm - equivalent - of - yarn - resolutions ) . <nl> If you get a error like this : <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> } <nl> } ) { <nl> - / / If you use experimental . newExternals <nl> webpackOptions . notNodeExternalResMatch = ( request , context ) = > { <nl> return / react - images - upload / . test ( request ) <nl> } ; <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> } ; <nl> ` ` ` <nl> - To resolutions in your package . json . For npm see [ here ] ( https : / / stackoverflow . com / questions / 52416312 / npm - equivalent - of - yarn - resolutions ) . <nl> - <nl> # # Debugging with Inspector <nl> - ` npm start - - - - inspect = [ host : port ] ` or ` yarn start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> options : { <nl> verbose : false , / / set to true to get more info / error output <nl> debug : { } , / / debug flags <nl> - buildType : ' iso ' , / / or ' spa ' and ' serverless ' <nl> + buildType : ' iso ' , / / or ' spa ' , ' serveronly ' , ' iso - serverless ' and ' serveronly - serverless ' <nl> cssPrefix : ' static / css ' , <nl> jsPrefix : ' static / js ' , <nl> mediaPrefix : ' static / media ' , <nl> 
mmm a / packages / razzle - plugin - typescript / README . md <nl> ppp b / packages / razzle - plugin - typescript / README . md <nl> Razzle now has support for typescript using babel . Unless you specifically need this plugin we recommend using the builtin support <nl> - Use [ with - typescript example ] ( https : / / github . com / jaredpalmer / razzle / tree / next / examples / with - typescript ) instead . <nl> + Use [ with - typescript example ] ( https : / / github . com / jaredpalmer / razzle / tree / master / examples / with - typescript ) instead . <nl> # # Usage in Razzle Projects <nl> @ @ - 22 , 7 + 22 , 7 @ @ module . exports = { <nl> } ; <nl> ` ` ` <nl> - See full configuration in the [ typescript example project ] ( https : / / github . com / jaredpalmer / razzle / tree / master / examples / with - typescript ) . <nl> + See full configuration in the [ typescript example project ] ( https : / / github . com / jaredpalmer / razzle / tree / master / examples / with - typescript - plugin ) . <nl> # # # With custom options : <nl> 
mmm a / website / pages / docs / single - page - applications . md <nl> ppp b / website / pages / docs / single - page - applications . md <nl> < link rel = " icon " href = " < % = process . env . PUBLIC_PATH % > favicon . ico " / > <nl> < meta name = " viewport " content = " width = device - width , initial - scale = 1 , shrink - to - fit = no " / > <nl> < meta name = " theme - color " content = " # 000000 " / > <nl> + < % = htmlWebpackPlugin . tags . headTags % > <nl> < ! - - <nl> Notice the use of < % = process . env . PUBLIC_PATH % > in the tags above . <nl> It will be replaced with the URL of the ` public ` folder during the build . <nl> @ @ - 31 , 6 + 32 , 7 @ @ In addition to universal / isomorphic applications , Razzle can build single page ( <nl> To begin the development , run ` npm start ` or ` yarn start ` . <nl> To create a production bundle , use ` npm run build ` or ` yarn build ` . <nl> - - > <nl> + < % = htmlWebpackPlugin . tags . bodyTags % > <nl> < / body > <nl> < / html > <nl> ` ` ` <nl> 
mmm a / website / pages / index . mdx <nl> ppp b / website / pages / index . mdx <nl> - [ Jest ] ( https : / / github . com / facebook / jest ) test runner setup with sensible defaults via ` razzle test ` <nl> - SPA mode , build client side apps with razzle <nl> + # # Not ready for Razzle 4 . 0 ? <nl> + <nl> + [ Razzle 3 docs ] ( https : / / razzle - git - three - jared . vercel . app / ) <nl> + <nl> # # Getting help <nl> If you get stuck , check out Razzle ' s [ GitHub Discussions ] ( https : / / github . com / jaredpalmer / razzle / discussions ) . In addition , # razzle - afterjs on [ Formium Community Discord Server ] ( https : / / discord . gg / pJSg287 ) is a great way to get help quickly too . <nl> 
mmm a / website / pages / getting - started . mdx <nl> ppp b / website / pages / getting - started . mdx <nl> } ; <nl> ` ` ` <nl> + Devserver not starting and no errors show up <nl> + <nl> + Make razzle more verbose : <nl> + <nl> + ` ` ` js <nl> + / / razzle . config . js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + options : { <nl> + verbose : true <nl> + } <nl> + } ; <nl> + ` ` ` <nl> + <nl> # # Debugging with Inspector <nl> - ` npm start - - - - inspect = [ host : port ] ` or ` yarn start - - inspect = [ host : port ] ` This will start the node server and enable the inspector agent . The ` = [ host : port ] ` is optional and defaults to ` = 127 . 0 . 0 . 1 : 9229 ` . For more information , see [ this ] ( https : / / nodejs . org / en / docs / guides / debugging - getting - started / ) . <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> import ' react - app - polyfill / ie11 ' ; / / For IE 11 support <nl> ` ` ` <nl> + # # Transpilation of external modules <nl> + <nl> + If you need to transpile external modules with arrow functions etc . <nl> + <nl> + Make sure the modules are added to the babelRule . <nl> + <nl> + ` ` ` js <nl> + / / razzle . config . js <nl> + ' use strict ' ; <nl> + <nl> + module . exports = { <nl> + modifyWebpackOptions ( { <nl> + env : { <nl> + target , / / the target ' node ' or ' web ' <nl> + dev , / / is this a development build ? true or false <nl> + } <nl> + options : { <nl> + webpackOptions , / / the default options that will be used to configure webpack / webpack loaders and plugins <nl> + } <nl> + } ) { <nl> + if ( target = = = ' web ' ) { <nl> + webpackOptions . babelRule . include = webpackOptions . babelRule . include . concat ( [ / themodule / , / anothermodule / ] ) <nl> + } <nl> + return webpackOptions ; <nl> + } <nl> + } ; <nl> + ` ` ` <nl> + <nl> # # Absolute Imports <nl> You can configure your application to support importing modules using absolute paths . This can be done by configuring a jsconfig . json or tsconfig . json file in the root of your project . If you ' re using TypeScript in your project , you will already have a tsconfig . json file . <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> } <nl> } ) { <nl> if ( target = = = ' web ' ) { <nl> - webpackOptions . babelRule . include = webpackOptions . babelRule . include . concat ( [ / themodule / , / anothermodule / ] ) <nl> + webpackOptions . babelRule . include = webpackOptions . babelRule . include . concat ( [ <nl> + / themodule / , <nl> + / anothermodule / <nl> + ] ) <nl> } <nl> return webpackOptions ; <nl> } <nl> 
mmm a / packages / razzle - plugin - scss / README . md <nl> ppp b / packages / razzle - plugin - scss / README . md <nl> ` ` ` js <nl> { <nl> dev : { <nl> + sassOptions : { <nl> sourceMap : true , <nl> includePaths : [ paths . appNodeModules ] , <nl> } , <nl> - prod : { <nl> - sourceMap : false , <nl> - includePaths : [ paths . appNodeModules ] , <nl> } , <nl> - } <nl> - ` ` ` <nl> - <nl> - Set ` dev ` to add config to postcss in ` development ` . <nl> - Set ` prod ` to add config to postcss in ` production ` . <nl> - <nl> - See [ node - sass options ] ( https : / / github . com / sass / node - sass # options ) to override configs . <nl> - <nl> - - - - <nl> - <nl> - # # # sassModules <nl> - <nl> - default <nl> - <nl> - ` ` ` js <nl> - { <nl> - dev : { <nl> + prod : { <nl> + sassOptions : { <nl> sourceMap : true , <nl> + sourceMapContents : false , <nl> includePaths : [ paths . appNodeModules ] , <nl> - modules : true <nl> } , <nl> - prod : { <nl> - sourceMap : false , <nl> - includePaths : [ paths . appNodeModules ] , <nl> - modules : true <nl> } , <nl> - } <nl> + } , <nl> ` ` ` <nl> Set ` dev ` to add config to postcss in ` development ` . <nl> @ @ - 146 , 15 + 125 , 20 @ @ default <nl> dev : { <nl> sourceMap : true , <nl> importLoaders : 1 , <nl> - modules : false , <nl> + modules : { <nl> + auto : true , <nl> + localIdentName : ' [ name ] __ [ local ] ___ [ hash : base64 : 5 ] ' , <nl> + } , <nl> } , <nl> prod : { <nl> - sourceMap : false , <nl> + sourceMap : razzleOptions . enableSourceMaps , <nl> importLoaders : 1 , <nl> - modules : false , <nl> - minimize : true , <nl> + modules : { <nl> + auto : true , <nl> + localIdentName : ' [ name ] __ [ local ] ___ [ hash : base64 : 5 ] ' , <nl> + } , <nl> + } , <nl> } , <nl> - } <nl> ` ` ` <nl> Set ` dev ` to add config to postcss in ` development ` . <nl> 
mmm a / website / pages / docs / customization . md <nl> ppp b / website / pages / docs / customization . md <nl> If you need to transpile external modules with arrow functions etc . <nl> - Make sure the modules are added to the babelRule . <nl> + Make sure the modules are not externalized and are added to the babelRule include . <nl> ` ` ` js <nl> / / razzle . config . js <nl> @ @ - 427 , 12 + 427 , 13 @ @ module . exports = { <nl> webpackOptions , / / the default options that will be used to configure webpack / webpack loaders and plugins <nl> } <nl> } ) { <nl> - if ( target = = = ' web ' ) { <nl> + webpackOptions . notNodeExternalResMatch = ( request , context ) = > { <nl> + return / themodule | anothermodule / . test ( request ) <nl> + } ; <nl> webpackOptions . babelRule . include = webpackOptions . babelRule . include . concat ( [ <nl> / themodule / , <nl> / anothermodule / <nl> - ] ) <nl> - } <nl> + ] ) ; <nl> return webpackOptions ; <nl> } <nl> } ; <nl> 
mmm a / sheets / winget . md <nl> ppp b / sheets / winget . md <nl> slug : winget <nl> - - - <nl> - # # Upgrade All Apps <nl> + # # Upgrade all packages <nl> - The ` - - all ` option allows you to upgrade all apps : <nl> + The ` - - all ` option allows you to upgrade all packages : <nl> ` ` ` bash <nl> winget upgrade - - all <nl> ` ` ` <nl> + <nl> + # # List installed packages <nl> + <nl> + Listing installed packages will also detail which ones can be updated . <nl> + <nl> + ` ` ` bash <nl> + winget list <nl> + ` ` ` <nl> + <nl> + # # Update specific package <nl> + <nl> + To update a specific package add the package ` - - id ` <nl> + <nl> + ` ` ` bash <nl> + winget upgrade - - id VideoLAN . VLC <nl> + ` ` ` <nl> 
mmm a / sheets / git . md <nl> ppp b / sheets / git . md <nl> ` ` ` <nl> Since version ` 2 . 28 ` of ` Git ` this can be done using this command : <nl> + <nl> ` ` ` bash <nl> git config - - global init . defaultBranch main <nl> ` ` ` <nl> - For more info : [ Highlights from Git 2 . 28 ] ( https : / / github . blog / 2020 - 07 - 27 - highlights - from - git - 2 - 28 / # introducing - init - defaultbranch ) <nl> + <nl> + For more info : <nl> + [ Highlights from Git 2 . 28 ] ( https : / / github . blog / 2020 - 07 - 27 - highlights - from - git - 2 - 28 / # introducing - init - defaultbranch ) <nl> # # Add a repo from your machine to GitHub <nl> @ @ - 315 , 40 + 318 , 39 @ @ git update - index - - no - assume - unchanged < file > <nl> # # Cloning a repo from someone else ' s GitHub and pushing it to a repo on my GitHub <nl> - So you make a clone , make some changes then realise that you need to <nl> - add it to your GitHub account before making a pull <nl> + < Author author = " rawkode " / > <nl> - ` ` ` bash <nl> - git remote - v <nl> - origin https : / / github . com / OtherUser / other - username / other - repo ( fetch ) <nl> - origin https : / / github . com / OtherUser / other - username / other - repo ( push ) <nl> - ` ` ` <nl> - <nl> - You just need to set the ` origin ` to yours then add the ` upstream ` as <nl> - the original ` origin ` make sense ? <nl> - <nl> - So change ` origin ` to yours : <nl> + So you make a clone of a repo that sin ' t yours , make some changes then <nl> + realise that you need to add it to your GitHub account to make a PR . <nl> ` ` ` bash <nl> - git remote set - url origin http : / / github . com / your - username / your - repo <nl> + git remote - v <nl> + origin https : / / github . com / other - user / other - username / other - repo ( fetch ) <nl> + origin https : / / github . com / other - user / other - username / other - repo ( push ) <nl> ` ` ` <nl> - Then add ` upsrtream ` as theirs : <nl> + You just need to set the clone your working on as the downstream repo . <nl> ` ` ` bash <nl> - git remote add upstream https : / / github . com / other - username / other - repo <nl> + # add as downstream <nl> + git remote add downstream https : / / github . com / your - username / your - repo <nl> + # or as your username <nl> + git remote add your - username https : / / github . com / your - username / your - repo <nl> ` ` ` <nl> Now it should look something like this : <nl> ` ` ` bash <nl> git remote - v <nl> - origin http : / / github . com / your - username / your - repo ( fetch ) <nl> - origin http : / / github . com / your - username / your - repo ( push ) <nl> - upstream https : / / github . com / other - username / other - repo ( fetch ) <nl> - upstream https : / / github . com / other - username / other - repo ( push ) <nl> + origin https : / / github . com / other - username / other - repo ( fetch ) <nl> + origin https : / / github . com / other - username / other - repo ( push ) <nl> + downstream http : / / github . com / your - username / your - repo ( fetch ) <nl> + downstream http : / / github . com / your - username / your - repo ( push ) <nl> ` ` ` <nl> + You can then push your changes to the downstream repo and make a PR <nl> + via GitHub . <nl> + <nl> # # Remove an ` upstream ` repository <nl> If you no longer need a reference to a forked repository then remove <nl> 
mmm a / docs / app / Examples / modules / Dropdown / Usage / DropdownExampleOpenOnFocus . js <nl> ppp b / docs / app / Examples / modules / Dropdown / Usage / DropdownExampleOpenOnFocus . js <nl> < div > <nl> < Dropdown placeholder = ' I open on focus ' openOnFocus selection options = { friendOptions } / > <nl> { ' ' } <nl> - < Dropdown placeholder = ' I do not open on focussed ' openOnFocus = { false } selection options = { friendOptions } / > <nl> + < Dropdown placeholder = ' I do not open on focus ' openOnFocus = { false } selection options = { friendOptions } / > <nl> < / div > <nl> ) <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> - [ Workflow ] ( # workflow ) <nl> - [ Create a Component ] ( # create - a - component ) <nl> - [ Define _meta ] ( # define - _meta ) <nl> + - [ Using propTypes ] ( # using - proptypes ) <nl> - [ Conformance Test ] ( # conformance - test ) <nl> - [ Open A PR ] ( # open - a - pr ) <nl> - [ Spec out the API ] ( # spec - out - the - api ) <nl> 
mmm a / src / modules / Popup / Popup . js <nl> ppp b / src / modules / Popup / Popup . js <nl> * / <nl> export default class Popup extends Component { <nl> static propTypes = { <nl> - / * * Display the popup without the pointing arrow * / <nl> + / * * Display the popup without the pointing arrow . * / <nl> basic : PropTypes . bool , <nl> - / * * You may pass a content as children of the Popup * / <nl> + / * * You may pass a content as children of the Popup . * / <nl> children : PropTypes . node , <nl> / * * Classes to add to the Popup className . * / <nl> @ @ - 54 , 33 + 54 , 33 @ @ export default class Popup extends Component { <nl> / * * Simple text content for the popover * / <nl> content : PropTypes . node , <nl> - / * * A Flowing popup have no maximum width and continue to flow to fit its content * / <nl> + / * * A flowing Popup has no maximum width and continues to flow to fit its content . * / <nl> flowing : PropTypes . bool , <nl> - / * * Takes up the entire width of its offset container * / <nl> + / * * Takes up the entire width of its offset container . * / <nl> / / TODO : implement the Popup fluid layout <nl> / / fluid : PropTypes . bool , <nl> - / * * Header displayed above the content in bold * / <nl> + / * * Header displayed above the content in bold . * / <nl> header : PropTypes . string , <nl> - / * * Whether the popup should not close on hover * / <nl> + / * * Whether the popup should not close on hover . * / <nl> hoverable : PropTypes . bool , <nl> - / * * Invert the colors of the popup * / <nl> + / * * Invert the colors of the Popup . * / <nl> inverted : PropTypes . bool , <nl> - / * * The node where the popup should mount . . * / <nl> + / * * Hide the Popup when scrolling the window . * / <nl> hideOnScroll : PropTypes . bool , <nl> - / * * Horizontal offset in pixels to be applied to the popup * / <nl> + / * * Horizontal offset in pixels to be applied to the Popup . * / <nl> offset : PropTypes . number , <nl> / * * Event triggering the popup * / <nl> on : PropTypes . oneOf ( _meta . props . on ) , <nl> / * * <nl> - * Called when a close event happens <nl> + * Called when a close event happens . <nl> * <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props . <nl> @ @ - 88 , 7 + 88 , 7 @ @ export default class Popup extends Component { <nl> onClose : PropTypes . func , <nl> / * * <nl> - * Called when the portal is mounted on the DOM <nl> + * Called when the portal is mounted on the DOM . <nl> * <nl> * @ param { null } <nl> * @ param { object } data - All props . <nl> @ @ - 96 , 7 + 96 , 7 @ @ export default class Popup extends Component { <nl> onMount : PropTypes . func , <nl> / * * <nl> - * Called when an open event happens <nl> + * Called when an open event happens . <nl> * <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props . <nl> @ @ - 104 , 7 + 104 , 7 @ @ export default class Popup extends Component { <nl> onOpen : PropTypes . func , <nl> / * * <nl> - * Called when the portal is unmounted from the DOM <nl> + * Called when the portal is unmounted from the DOM . <nl> * <nl> * @ param { null } <nl> * @ param { object } data - All props . <nl> @ @ - 114 , 16 + 114 , 16 @ @ export default class Popup extends Component { <nl> / * * Positioning for the popover * / <nl> positioning : PropTypes . oneOf ( _meta . props . positioning ) , <nl> - / * * Popup size * / <nl> + / * * Popup size . * / <nl> size : PropTypes . oneOf ( _meta . props . size ) , <nl> - / * * custom popup style * / <nl> + / * * Custom Popup style . * / <nl> style : PropTypes . object , <nl> / * * Element to be rendered in - place where the popup is defined . * / <nl> trigger : PropTypes . node , <nl> - / * * Popup width * / <nl> + / * * Popup width . * / <nl> wide : PropTypes . oneOf ( _meta . props . wide ) , <nl> } <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < h1 align = " center " > <nl> - < a href = " https : / / react . semantic - ui . com / " > Semantic UI React < / a > <nl> + < a href = " http : / / react . semantic - ui . com / " > Semantic UI React < / a > <nl> < / h1 > <nl> < ! - - Badges - - > <nl> @ @ - 149 , 7 + 149 , 7 @ @ Big thanks to our [ contributors ] [ 20 ] , especially : <nl> - @ layershifter for bringing momentum and continual support <nl> [ 1 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / blob / master / . github / CONTRIBUTING . md <nl> - [ 2 ] : https : / / react . semantic - ui . com / <nl> + [ 2 ] : http : / / react . semantic - ui . com / <nl> [ 3 ] : https : / / facebook . github . io / react / <nl> [ 4 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / labels / help % 20wanted <nl> [ 5 ] : http : / / semantic - ui . com / <nl> 
mmm a / src / collections / Grid / Grid . js <nl> ppp b / src / collections / Grid / Grid . js <nl> / * * Represents column count per row in Grid . * / <nl> columns : PropTypes . oneOf ( [ . . . SUI . WIDTHS , ' equal ' ] ) , <nl> - / * * A grid can be combined with a container to use avaiable layout and alignment . * / <nl> + / * * A grid can be combined with a container to use the available layout and alignment . * / <nl> container : PropTypes . bool , <nl> / * * A grid can have dividers between its columns . * / <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> - # # [ Unreleased ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / tree / HEAD ) <nl> - <nl> - [ Full Changelog ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / compare / v0 . 66 . 0 . . . HEAD ) <nl> - <nl> - * * Implemented enhancements : * * <nl> - <nl> - - Accordion . Title - ' as ' prop in dynamic accordion titles [ \ # 1144 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1144 ) <nl> - <nl> # # [ v0 . 66 . 0 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / tree / v0 . 66 . 0 ) ( 2017 - 02 - 22 ) <nl> [ Full Changelog ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / compare / v0 . 65 . 0 . . . v0 . 66 . 0 ) <nl> - Add missing MenuItem ` disabled ` prop [ \ # 1363 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1363 ) <nl> - Remove Form ` onSubmit ` prop and serializer [ \ # 1362 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1362 ) <nl> - Add ` link ` prop to Card [ \ # 1350 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1350 ) <nl> + - Accordion . Title - ' as ' prop in dynamic accordion titles [ \ # 1144 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1144 ) <nl> - Typings : unable to set many typical html element props [ \ # 1072 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1072 ) <nl> * * Fixed bugs : * * <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Update the changelog ( requires [ github_changelog_generator ] [ 15 ] ) : <nl> ` ` ` sh <nl> - npm run deploy : docs <nl> github_changelog_generator <nl> git add CHANGELOG . md <nl> git commit - m ' docs ( changelog ) : update changelog [ ci skip ] ' <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / roadmap . space <nl> - https : / / edabit . com <nl> - https : / / blackship . com <nl> + - http : / / www . brewhousesolutions . com <nl> # # Voice Your Opinion : speech_balloon : <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - Our doc site DNS and CDN providers are having issues at the moment . <nl> - <nl> - * * Please use https : / / semantic - org . github . io / Semantic - UI - React as a short - term fix . * * <nl> - Images will not load with this link , however , the majority of the docs will be usable . <nl> - <nl> - Thanks for your patience and help while we resolve these issues : <nl> - - [ CDN Issue # 1404 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1404 ) <nl> - - [ DNS Issue # 1429 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1429 ) <nl> - <nl> - * * * <nl> < ! - - Logo - - > <nl> < p align = " center " > <nl> < a href = " http : / / react . semantic - ui . com " > <nl> @ @ - 18 , 7 + 7 , 7 @ @ Thanks for your patience and help while we resolve these issues : <nl> < ! - - Name - - > <nl> < h1 align = " center " > <nl> - < a href = " https : / / semantic - org . github . io / Semantic - UI - React " > Semantic UI React < / a > <nl> + < a href = " http : / / react . semantic - ui . com / " > Semantic UI React < / a > <nl> < / h1 > <nl> < ! - - Badges - - > <nl> @ @ - 164 , 7 + 153 , 7 @ @ Big thanks to our [ contributors ] [ 20 ] , especially : <nl> - @ layershifter for bringing momentum and continual support <nl> [ 1 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / blob / master / . github / CONTRIBUTING . md <nl> - [ 2 ] : https : / / semantic - org . github . io / Semantic - UI - React <nl> + [ 2 ] : http : / / react . semantic - ui . com / <nl> [ 3 ] : https : / / facebook . github . io / react / <nl> [ 4 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / labels / help % 20wanted <nl> [ 5 ] : http : / / semantic - ui . com / <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / edabit . com <nl> - https : / / blackship . com <nl> - http : / / www . brewhousesolutions . com <nl> + - https : / / www . lifebot . fr <nl> # # Voice Your Opinion : speech_balloon : <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # [ Documentation ] [ 2 ] : blue_book : <nl> + <nl> + # # Examples & Tutorials <nl> + <nl> + This is a listing of example projects and guides that will help you integrate Semantic - UI - React into your new or existing projects . <nl> + <nl> + - [ semantic - ui - react - todos ] ( https : / / github . com / wyc / semantic - ui - react - todos ) : This example modifies the well - known [ react - redux Todo List ] ( https : / / github . com / reactjs / redux / tree / master / examples / todos ) to use Semantic UI components . There is also a write - up on the process in the project README . <nl> + <nl> + <nl> # # Built With Semantic - UI - React <nl> These great products are built on Semantic - UI - React . Add yours [ here ] [ 22 ] . <nl> 
mmm a / docs / app / Views / Usage . js <nl> ppp b / docs / app / Views / Usage . js <nl> $ npm install semantic - ui - css - - save <nl> < / pre > <nl> < / Segment > <nl> + < p > <nl> + After install , you ' ll need to include the minified CSS file <nl> + in your < em > index . js < / em > file : <nl> + < / p > <nl> + < Segment > <nl> + < pre > <nl> + import ' semantic - ui - css / semantic . min . css ' ; <nl> + < / pre > <nl> + < / Segment > <nl> { / * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> * Semantic - UI package <nl> 
mmm a / src / elements / Container / Container . js <nl> ppp b / src / elements / Container / Container . js <nl> / * * Additional classes . * / <nl> className : PropTypes . string , <nl> - / * * Container has no maximum with . * / <nl> + / * * Container has no maximum width . * / <nl> fluid : PropTypes . bool , <nl> / * * Reduce maximum width to more naturally accommodate text . * / <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> These great products are built on Semantic UI React . Add yours [ here ] [ 22 ] . <nl> + - Netflix ' s Edge Developer Experience team ' s numerous [ internal apps ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1604 ) <nl> - http : / / stoplight . io <nl> - https : / / roadmap . space <nl> - https : / / edabit . com <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> This is a listing of example projects and guides that will help you integrate Semantic UI React into your new or existing projects . <nl> + # # # [ react - semantic . ui - starter ] [ 102 ] <nl> + Production - ready , performance - first , optimized , robust , fully - featured boilerplate / example for your new Progressive Web App . <nl> + <nl> # # # [ semantic - ui - react - todos ] [ 100 ] <nl> This example modifies the well - known [ react - redux Todo List ] [ 101 ] to use Semantic UI components . There is also a write - up on the process in the project README . <nl> @ @ - 206 , 3 + 209 , 4 @ @ Big thanks to our [ contributors ] [ 20 ] , especially : <nl> < ! - - Examples - - > <nl> [ 100 ] : https : / / github . com / wyc / semantic - ui - react - todos <nl> [ 101 ] : https : / / github . com / reactjs / redux / tree / master / examples / todos <nl> + [ 102 ] : https : / / github . com / Metnew / react - semantic . ui - starter <nl> 
mmm a / docs / app / Views / Introduction . js <nl> ppp b / docs / app / Views / Introduction . js <nl> < Header as = ' h2 ' dividing > Augmentation < / Header > <nl> < p > <nl> Control the rendered HTML tag , or render one component < code > as < / code > another component . <nl> - Extra props are passed to the component you are rending < code > as < / code > . <nl> + Extra props are passed to the component you are rendering < code > as < / code > . <nl> < / p > <nl> < p > <nl> 
mmm a / docs / app / Examples / elements / Button / GroupVariations / ButtonExampleGroupVertical . js <nl> ppp b / docs / app / Examples / elements / Button / GroupVariations / ButtonExampleGroupVertical . js <nl> import { Button } from ' semantic - ui - react ' <nl> const ButtonExampleGroupVertical = ( ) = > ( <nl> - < Button . Group attached = ' top ' vertical > <nl> + < Button . Group vertical > <nl> < Button > Feed < / Button > <nl> < Button > Messages < / Button > <nl> < Button > Events < / Button > <nl> 
mmm a / docs / app / Views / Introduction . js <nl> ppp b / docs / app / Views / Introduction . js <nl> const RatingHTML = ` < div <nl> class = " ui rating " <nl> data - rating = " 1 " <nl> - data - max - rating = " 3 " <nl> + data - max - rating = " 5 " <nl> > < / div > ` <nl> const MessageIconJSX = ` < Message <nl> 
mmm a / docs / app / Components / IconSearch / IconSearch . js <nl> ppp b / docs / app / Components / IconSearch / IconSearch . js <nl> state = { search : ' ' , includeSimilar : true } <nl> componentDidMount ( ) { <nl> - const input = document . querySelector ( ' # docs - icon - set - input input ' ) <nl> + const input = document . querySelector ( ' # docs - icon - set - input ' ) <nl> input . focus ( ) <nl> } <nl> 
mmm a / docs / app / Examples / views / Item / Variations / ItemExampleFloated . js <nl> ppp b / docs / app / Examples / views / Item / Variations / ItemExampleFloated . js <nl> - import { Button , Image as ImageComponent , Item } from ' semantic - ui - react ' <nl> + import { Button , Image , Item } from ' semantic - ui - react ' <nl> - const paragraph = < ImageComponent src = ' / assets / images / wireframe / short - paragraph . png ' / > <nl> + const paragraph = < Image src = ' / assets / images / wireframe / short - paragraph . png ' / > <nl> const ItemExampleFloated = ( ) = > ( <nl> < Item . Group relaxed > <nl> 
mmm a / docs / app / Examples / collections / Table / Variations / TableExampleSortable . js <nl> ppp b / docs / app / Examples / collections / Table / Variations / TableExampleSortable . js <nl> < Table sortable celled fixed > <nl> < Table . Header > <nl> < Table . Row > <nl> - < Table . HeaderCell sorted = { column = = = ' name ' & & direction } onClick = { this . handleSort ( ' name ' ) } > <nl> + < Table . HeaderCell sorted = { column = = = ' name ' ? direction : null } onClick = { this . handleSort ( ' name ' ) } > <nl> Name <nl> < / Table . HeaderCell > <nl> - < Table . HeaderCell sorted = { column = = = ' age ' & & direction } onClick = { this . handleSort ( ' age ' ) } > <nl> + < Table . HeaderCell sorted = { column = = = ' age ' ? direction : null } onClick = { this . handleSort ( ' age ' ) } > <nl> Age <nl> < / Table . HeaderCell > <nl> - < Table . HeaderCell sorted = { column = = = ' gender ' & & direction } onClick = { this . handleSort ( ' gender ' ) } > <nl> + < Table . HeaderCell sorted = { column = = = ' gender ' ? direction : null } onClick = { this . handleSort ( ' gender ' ) } > <nl> Gender <nl> < / Table . HeaderCell > <nl> < / Table . Row > <nl> 
mmm a / docs / app / Views / Introduction . js <nl> ppp b / docs / app / Views / Introduction . js <nl> < / Menu . Item > <nl> < / Menu > ` <nl> const MenuItemLinkAugmentationHTML = ` < div class = " ui menu " > <nl> - < a class = " item " > <nl> + < a class = " item " href = " / home " > <nl> Home <nl> < / a > <nl> < / div > ` <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentProps . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentProps . js <nl> const paramSignature = params <nl> . map ( param = > ` $ { param . name } : $ { getTagType ( param ) } ` ) <nl> / / prevent object properties from showing as individual params <nl> - . filter ( p = > ! p . includes ( ' . ' ) ) <nl> + . filter ( p = > ! _ . includes ( p , ' . ' ) ) <nl> . join ( ' , ' ) <nl> const tagDescriptionRows = _ . compact ( [ . . . params , returns ] ) . map ( tag = > { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - http : / / www . brewhousesolutions . com <nl> - https : / / www . lifebot . fr <nl> - https : / / www . stackforge . co <nl> + - https : / / sublimefund . org <nl> # # Voice Your Opinion <nl> 
mmm a / docs / app / Components / IconSearch / IconSearch . js <nl> ppp b / docs / app / Components / IconSearch / IconSearch . js <nl> render ( ) { <nl> const { includeSimilar } = this . state <nl> return ( <nl> - < Grid columns = { 1 } padded textAlign = ' center ' style = { gridStyle } > <nl> + < Grid columns = { 1 } padded style = { gridStyle } > <nl> < Grid . Column > <nl> + < Header as = ' h2 ' > Icon Set < / Header > <nl> + < p > An icon set contains an arbitrary number of glyphs . < / p > <nl> + <nl> + < Message > <nl> + Semantic includes a complete port of { ' ' } <nl> + < a href = ' http : / / fontawesome . io / whats - new / ' rel = ' noopener noreferrer ' target = ' _blank ' > Font Awesome 4 . 7 . 0 < / a > <nl> + { ' ' } designed by { ' ' } <nl> + < a href = ' http : / / www . twitter . com / davegandy ' rel = ' noopener noreferrer ' > Dave Gandy < / a > for its standard icon <nl> + set . <nl> + < / Message > <nl> + <nl> < Form > <nl> < Form . Group inline > <nl> < Form . Input <nl> @ @ - 163 , 7 + 174 , 7 @ @ export default class IconSearch extends Component { <nl> < / Form . Group > <nl> < / Form > <nl> < / Grid . Column > <nl> - < Grid . Column > <nl> + < Grid . Column textAlign = ' center ' > <nl> { this . renderIcons ( ) } <nl> < / Grid . Column > <nl> < / Grid > <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentExample . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentExample . js <nl> const { error , showCode , sourceCode } = this . state <nl> if ( ! showCode ) return <nl> - const style = { } <nl> + const style = { width : ' 100 % ' } <nl> if ( error ) { <nl> style . boxShadow = ` inset 0 0 0 1em $ { errorStyle . background } ` <nl> } <nl> 
mmm a / docs / app / index . ejs <nl> ppp b / docs / app / index . ejs <nl> < title > Semantic UI React < / title > <nl> < script > <nl> + / / Redirect to HTTPs <nl> + / / We need poor - mans client side redirects because we persist app router urls in localStorage <nl> + if ( location . hostname = = = ' react . semantic - ui . com ' & & location . protocol ! = = ' https : ' ) { <nl> + location . href = location . href . replace ( ' http : ' , ' https : ' ) <nl> + } <nl> / / Apply gh - pages SPA redirect that was applied in 404 . html <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> ( function ( ) { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / www . stackforge . co <nl> - https : / / sublimefund . org <nl> - https : / / thefaithcircle . com <nl> + - https : / / appfollow . io <nl> # # Voice Your Opinion <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < img alt = " Gitter " src = " https : / / img . shields . io / badge / gitter - join_chat - 1dce73 . svg ? logo = data % 3Aimage % 2Fsvg % 2Bxml % 3Bbase64 % 2CPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIwIiB5PSI1IiBmaWxsPSIjZmZmIiB3aWR0aD0iMSIgaGVpZ2h0PSI1Ii8 % 2BPHJlY3QgeD0iMiIgeT0iNiIgZmlsbD0iI2ZmZiIgd2lkdGg9IjEiIGhlaWdodD0iNyIvPjxyZWN0IHg9IjQiIHk9IjYiIGZpbGw9IiNmZmYiIHdpZHRoPSIxIiBoZWlnaHQ9IjciLz48cmVjdCB4PSI2IiB5PSI2IiBmaWxsPSIjZmZmIiB3aWR0aD0iMSIgaGVpZ2h0PSI0Ii8 % 2BPC9zdmc % 2B & logoWidth = 8 & style = flat - square & maxAge = 2592000 " / > <nl> < / a > <nl> - < a href = " ttps : / / circleci . com / gh / Semantic - Org / Semantic - UI - React / tree / master " > <nl> + < a href = " https : / / circleci . com / gh / Semantic - Org / Semantic - UI - React / tree / master " > <nl> < img alt = " Circle " src = " https : / / img . shields . io / circleci / project / Semantic - Org / Semantic - UI - React / master . svg ? style = flat - square " / > <nl> < / a > <nl> < a href = " https : / / codecov . io / gh / Semantic - Org / Semantic - UI - React " > <nl> 
mmm a / docs / app / Layouts / StickyLayout . js <nl> ppp b / docs / app / Layouts / StickyLayout . js <nl> - import React from ' react ' <nl> - import { Container , Divider , Dropdown , Grid , Header , Icon , Image , List , Menu , Segment } from ' semantic - ui - react ' <nl> + import React , { Component } from ' react ' <nl> + import { <nl> + Container , Divider , Dropdown , Grid , Header , Icon , Image , List , Menu , Segment , Visibility , <nl> + } from ' semantic - ui - react ' <nl> + <nl> + const menuStyle = { <nl> + border : ' none ' , <nl> + borderRadius : 0 , <nl> + boxShadow : ' none ' , <nl> + marginBottom : ' 1em ' , <nl> + marginTop : ' 4em ' , <nl> + transition : ' box - shadow 0 . 5s ease , padding 0 . 5s ease ' , <nl> + } <nl> + <nl> + const fixedMenuStyle = { <nl> + backgroundColor : ' # fff ' , <nl> + border : ' 1px solid # ddd ' , <nl> + boxShadow : ' 0px 3px 5px rgba ( 0 , 0 , 0 , 0 . 2 ) ' , <nl> + } <nl> + <nl> + const overlayStyle = { <nl> + float : ' left ' , <nl> + margin : ' 0em 3em 1em 0em ' , <nl> + } <nl> + <nl> + const fixedOverlayStyle = { <nl> + . . . overlayStyle , <nl> + position : ' fixed ' , <nl> + top : ' 80px ' , <nl> + zIndex : 10 , <nl> + } <nl> + <nl> + const overlayMenuStyle = { <nl> + position : ' relative ' , <nl> + left : 0 , <nl> + transition : ' left 0 . 5s ease ' , <nl> + } <nl> + <nl> + const fixedOverlayMenuStyle = { <nl> + . . . overlayMenuStyle , <nl> + left : ' 800px ' , <nl> + } <nl> const LeftImage = ( ) = > ( <nl> < Image <nl> @ @ - 35 , 21 + 75 , 57 @ @ const Paragraph = ( ) = > ( <nl> < / p > <nl> ) <nl> - const StickyLayout = ( ) = > ( <nl> + export default class StickyLayout extends Component { <nl> + state = { <nl> + menuFixed : false , <nl> + overlayFixed : false , <nl> + } <nl> + <nl> + handleOverlayRef = ( c ) = > { <nl> + const { overlayRect } = this . state <nl> + <nl> + if ( ! overlayRect ) this . setState ( { overlayRect : _ . pick ( c . getBoundingClientRect ( ) , ' height ' , ' width ' ) } ) <nl> + } <nl> + <nl> + stickOverlay = ( ) = > this . setState ( { overlayFixed : true } ) <nl> + <nl> + stickTopMenu = ( ) = > this . setState ( { menuFixed : true } ) <nl> + <nl> + unStickOverlay = ( ) = > this . setState ( { overlayFixed : false } ) <nl> + <nl> + unStickTopMenu = ( ) = > this . setState ( { menuFixed : false } ) <nl> + <nl> + render ( ) { <nl> + const { menuFixed , overlayFixed , overlayRect } = this . state <nl> + <nl> + return ( <nl> < div > <nl> + { / * Heads up , style below isn ' t necessary for correct work of example , simply our docs defines other <nl> + background color . <nl> + * / } <nl> + < style > { ` <nl> + html , body { <nl> + background : # fff ; <nl> + } <nl> + ` } < / style > <nl> + <nl> < Container text style = { { marginTop : ' 2em ' } } > <nl> < Header as = ' h1 ' > Sticky Example < / Header > <nl> < p > This example shows how to use lazy loaded images , a sticky menu , and a simple text container < / p > <nl> < / Container > <nl> - < Menu style = { { <nl> - background : ' # f7f7f7 ' , <nl> - border : ' none ' , <nl> - borderRadius : 0 , <nl> - boxShadow : ' none ' , <nl> - marginTop : ' 4em ' , <nl> - transition : ' box - shadow 0 . 5s ease , padding 0 . 5s ease ' , <nl> - } } <nl> + { / * Attaching the top menu is a simple operation , we only switch ` fixed ` prop add add another styles if it has <nl> + gone beyond the scope of visibility <nl> + * / } <nl> + < Visibility <nl> + onBottomPassed = { this . stickTopMenu } <nl> + onBottomVisible = { this . unStickTopMenu } <nl> + once = { false } <nl> + > <nl> + < Menu <nl> + borderless <nl> + fixed = { menuFixed & & ' top ' } <nl> + style = { menuFixed ? fixedMenuStyle : menuStyle } <nl> > <nl> < Container text > <nl> < Menu . Item > <nl> @ @ - 80 , 12 + 156 , 34 @ @ const StickyLayout = ( ) = > ( <nl> < / Menu . Menu > <nl> < / Container > <nl> < / Menu > <nl> + < / Visibility > <nl> < Container text > <nl> { _ . times ( 3 , i = > < Paragraph key = { i } / > ) } <nl> - < div style = { { float : ' left ' , margin : ' 0em 3em 1em 0em ' } } > <nl> - < Menu icon = ' labeled ' vertical > <nl> + { / * Example with overlay menu is more complex , SUI simply clones all elements inside , but we should use a <nl> + different approach . <nl> + <nl> + An empty Visibility element controls the need to change the fixing of element below , it also uses height <nl> + and width params received from its ref for correct display . <nl> + * / } <nl> + < Visibility <nl> + offset = { 80 } <nl> + once = { false } <nl> + onTopPassed = { this . stickOverlay } <nl> + onTopVisible = { this . unStickOverlay } <nl> + style = { overlayFixed ? { . . . overlayStyle , . . . overlayRect } : { } } <nl> + / > <nl> + <nl> + < div <nl> + ref = { this . handleOverlayRef } <nl> + style = { overlayFixed ? fixedOverlayStyle : overlayStyle } <nl> + > <nl> + < Menu <nl> + icon = ' labeled ' <nl> + style = { overlayFixed ? fixedOverlayMenuStyle : overlayMenuStyle } <nl> + vertical <nl> + > <nl> < Menu . Item > <nl> < Icon name = ' twitter ' / > <nl> Twitter <nl> @ @ - 93 , 7 + 191 , 7 @ @ const StickyLayout = ( ) = > ( <nl> < Menu . Item > <nl> < Icon name = ' facebook ' / > <nl> - Facebook <nl> + Share <nl> < / Menu . Item > <nl> < Menu . Item > <nl> @ @ - 171 , 5 + 269 , 5 @ @ const StickyLayout = ( ) = > ( <nl> < / Segment > <nl> < / div > <nl> ) <nl> - <nl> - export default StickyLayout <nl> + } <nl> + } <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / sublimefund . org <nl> - https : / / thefaithcircle . com <nl> - https : / / appfollow . io <nl> + - http : / / according . to . localsourc . es <nl> + <nl> # # Voice Your Opinion <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < img alt = " Codecov " src = " https : / / img . shields . io / codecov / c / github / Semantic - Org / Semantic - UI - React / master . svg ? style = flat - square " / > <nl> < / a > <nl> - < a href = " https : / / gemnasium . com / Semantic - Org / Semantic - UI - React " > <nl> - < img alt = " Gemnasium " src = " https : / / img . shields . io / gemnasium / Semantic - Org / Semantic - UI - React . svg ? style = flat - square " / > <nl> + < a href = " https : / / david - dm . org / Semantic - Org / Semantic - UI - React " > <nl> + < img alt = " David " src = " https : / / img . shields . io / david / Semantic - Org / Semantic - UI - React . svg ? style = flat - square " / > <nl> < / a > <nl> < a href = " https : / / www . npmjs . com / package / semantic - ui - react " > <nl> < img alt = " npm " src = " https : / / img . shields . io / npm / v / semantic - ui - react . svg ? style = flat - square " / > <nl> 
mmm a / docs / app / Examples / modules / Dropdown / Usage / DropdownExampleSearchQuery . js <nl> ppp b / docs / app / Examples / modules / Dropdown / Usage / DropdownExampleSearchQuery . js <nl> searchQuery : ' ' , <nl> } ) <nl> - handleSearchChange = ( e , searchQuery ) = > this . setState ( { searchQuery } ) <nl> + handleSearchChange = ( e , { searchQuery } ) = > this . setState ( { searchQuery } ) <nl> render ( ) { <nl> const { searchQuery , value } = this . state <nl> 
mmm a / docs / app / Examples / modules / Dropdown / Usage / DropdownExampleRemote . js <nl> ppp b / docs / app / Examples / modules / Dropdown / Usage / DropdownExampleRemote . js <nl> } <nl> handleChange = ( e , { value } ) = > this . setState ( { value } ) <nl> - handleSearchChange = ( e , value ) = > this . setState ( { searchQuery : value } ) <nl> + handleSearchChange = ( e , { searchQuery } ) = > this . setState ( { searchQuery } ) <nl> fetchOptions = ( ) = > { <nl> this . setState ( { isFetching : true } ) <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / edabit . com <nl> - https : / / blackship . com <nl> - http : / / www . brewhousesolutions . com <nl> - - https : / / www . lifebot . fr <nl> + - https : / / www . seeuletter . com <nl> - https : / / www . stackforge . co <nl> - https : / / sublimefund . org <nl> - https : / / thefaithcircle . com <nl> 
mmm a / docs / app / Examples / addons / Portal / Types / PortalExampleControlled . js <nl> ppp b / docs / app / Examples / addons / Portal / Types / PortalExampleControlled . js <nl> import { Button , Grid , Header , Segment , Portal } from ' semantic - ui - react ' <nl> export default class PortalExampleControlled extends Component { <nl> - state = { <nl> - open : false , <nl> - } <nl> + state = { open : false } <nl> handleClick = ( ) = > this . setState ( { open : ! this . state . open } ) <nl> @ @ - 23 , 12 + 21 , 7 @ @ export default class PortalExampleControlled extends Component { <nl> onClick = { this . handleClick } <nl> / > <nl> - < Portal <nl> - closeOnTriggerClick <nl> - openOnTriggerClick <nl> - onClose = { this . handleClose } <nl> - open = { open } <nl> - > <nl> + < Portal onClose = { this . handleClose } open = { open } > <nl> < Segment style = { { left : ' 40 % ' , position : ' fixed ' , top : ' 50 % ' , zIndex : 1000 } } > <nl> < Header > This is a controlled portal < / Header > <nl> < p > Portals have tons of great callback functions to hook into . < / p > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Our [ CONTRIBUTING . md ] [ 1 ] is a step - by - step setup and development guide . It is meant to be read from top to bottom . Once you ' re up to speed , each issue here includes more information on how you can help : <nl> - # # # [ Good First Contribution ] [ 21 ] <nl> + # # # [ Good First Issue ] [ 21 ] <nl> - Issues labeled [ ` good first contribution ` ] [ 21 ] are a great way to ease into development on this project . <nl> + Issues labeled [ ` good first issue ` ] [ 21 ] are a great way to ease into development on this project . <nl> # # # [ Missing Components ] [ 17 ] <nl> @ @ - 193 , 7 + 193 , 7 @ @ Big thanks to our [ contributors ] [ 20 ] , especially : <nl> [ 18 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / blob / master / CHANGELOG . md <nl> [ 19 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / issues ? q = is % 3Aopen + RFC + label % 3ARFC <nl> [ 20 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / graphs / contributors <nl> - [ 21 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / labels / good % 20first % 20contribution <nl> + [ 21 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / labels / good % 20first % 20issue <nl> [ 22 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / edit / master / README . md <nl> [ 23 ] : https : / / react . semantic - ui . com / usage # css <nl> [ 24 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 802 # issuecomment - 258990274 <nl> 
mmm a / docs / app / Examples / elements / Button / GroupVariations / ButtonExampleGroupLabeledIcon . js <nl> ppp b / docs / app / Examples / elements / Button / GroupVariations / ButtonExampleGroupLabeledIcon . js <nl> import { Button } from ' semantic - ui - react ' <nl> const ButtonExampleGroupLabeledIcon = ( ) = > ( <nl> - < Button . Group labeled > <nl> + < Button . Group vertical labeled icon > <nl> < Button icon = ' play ' content = ' Play ' / > <nl> < Button icon = ' pause ' content = ' Pause ' / > <nl> < Button icon = ' shuffle ' content = ' Shuffle ' / > <nl> 
mmm a / docs / app / Examples / collections / Form / Shorthand / FormExampleSubcomponentId . js <nl> ppp b / docs / app / Examples / collections / Form / Shorthand / FormExampleSubcomponentId . js <nl> < Form > <nl> < Form . Group widths = ' equal ' > <nl> < Form . Input id = ' form - subcomponent - shorthand - input - first - name ' label = ' First name ' placeholder = ' First name ' / > <nl> - < Form . Input id = ' form - subcomponent - shorthand - input - last - name ' label = ' First name ' placeholder = ' First name ' / > <nl> + < Form . Input id = ' form - subcomponent - shorthand - input - last - name ' label = ' Last name ' placeholder = ' Last name ' / > <nl> < / Form . Group > <nl> < / Form > <nl> ) <nl> 
mmm a / docs / app / index . ejs <nl> ppp b / docs / app / index . ejs <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / js - beautify / < % = htmlWebpackPlugin . options . versions . jsBeautify % > / beautify - html . min . js " > < / script > <nl> < ! - - Use unminified React when not in production so we get errors and warnings - - > <nl> - < script src = " / / cdnjs . cloudflare . com / ajax / libs / prop - types / < % = htmlWebpackPlugin . options . versions . propTypes % > / prop - types . min . js " > < / script > <nl> + < script src = " / / cdnjs . cloudflare . com / ajax / libs / prop - types / < % = htmlWebpackPlugin . options . versions . propTypes % > / prop - types < % = __PROD__ ? ' min ' : ' ' % > . js " > < / script > <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / react / < % = htmlWebpackPlugin . options . versions . react % > / umd / react < % = __PROD__ ? ' . production . min ' : ' . development ' % > . js " > < / script > <nl> - < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / react - dom / < % = htmlWebpackPlugin . options . versions . reactDOM % > / umd / react - dom . production . min . js " > < / script > <nl> - < script src = " / / cdnjs . cloudflare . com / ajax / libs / react - dom / < % = htmlWebpackPlugin . options . versions . reactDOM % > / umd / react - dom - server . browser . production . min . js " > < / script > <nl> + < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / react - dom / < % = htmlWebpackPlugin . options . versions . reactDOM % > / umd / react - dom < % = __PROD__ ? ' . production . min ' : ' . development ' % > . js " > < / script > <nl> + < script src = " / / cdnjs . cloudflare . com / ajax / libs / react - dom / < % = htmlWebpackPlugin . options . versions . reactDOM % > / umd / react - dom - server . browser < % = __PROD__ ? ' . production . min ' : ' . development ' % > . js " > < / script > <nl> < script src = " / / pagead2 . googlesyndication . com / pagead / js / adsbygoogle . js " > < / script > <nl> < style > <nl> html , body { <nl> 
mmm a / docs / app / Examples / modules / Accordion / Advanced / AccordionExampleForm . js <nl> ppp b / docs / app / Examples / modules / Accordion / Advanced / AccordionExampleForm . js <nl> < Form > <nl> < Form . Group widths = { 2 } > <nl> < Form . Input label = ' First Name ' placeholder = ' First Name ' / > <nl> - < Form . Input label = ' First Name ' placeholder = ' Last Name ' / > <nl> + < Form . Input label = ' Last Name ' placeholder = ' Last Name ' / > <nl> < / Form . Group > <nl> < Accordion as = { Form . Field } panels = { panels } / > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Here are some helpful links : <nl> - [ Building CSS with Webpack ] [ 24 ] <nl> - - [ Building CSS with Meteor ] [ 26 ] <nl> + - [ Building CSS with Meteor ] [ 30 ] <nl> - [ Creating a standalone theme ] [ 25 ] <nl> # # Voice Your Opinion <nl> @ @ - 197 , 11 + 197 , 11 @ @ Big thanks to our [ contributors ] [ 20 ] , especially : <nl> [ 23 ] : https : / / react . semantic - ui . com / usage # css <nl> [ 24 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 802 # issuecomment - 258990274 <nl> [ 25 ] : http : / / learnsemantic . com / themes / creating . html <nl> - [ 26 ] : https : / / github . com / Semantic - Org / Semantic - UI - Meteor <nl> [ 26 ] : https : / / github . com / levithomason <nl> [ 27 ] : https : / / github . com / layershifter <nl> [ 28 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / tree / master / examples / webpack1 <nl> [ 29 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / tree / master / examples / webpack2 <nl> + [ 30 ] : https : / / github . com / Semantic - Org / Semantic - UI - Meteor <nl> < ! - - Examples - - > <nl> [ 100 ] : https : / / github . com / wyc / semantic - ui - react - todos <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - http : / / www . aircip . ir <nl> - http : / / platform . nazarbazaar . ir <nl> - https : / / build . games <nl> + - https : / / platform . forecastcycles . com <nl> # # Example Projects <nl> 
mmm a / docs / app / Views / Usage . js <nl> ppp b / docs / app / Views / Usage . js <nl> < Segment basic padded > <nl> < Header as = ' h2 ' dividing > JavaScript < / Header > <nl> < p > <nl> - The Semantic UI React package can be installed via NPM : <nl> + The Semantic UI React package can be installed via Yarn : <nl> < / p > <nl> < Segment > <nl> < pre > $ yarn add { pkg . name } < / pre > <nl> - < pre > $ npm install { pkg . name } - - save < / pre > <nl> < / Segment > <nl> < p > <nl> Installing Semantic UI React provides the JavaScript for your components . <nl> @ @ - 98 , 12 + 97 , 12 @ @ const Usage = ( ) = > ( <nl> main Semantic UI repository to provide a lightweight CSS only version of Semantic UI . <nl> < / p > <nl> < p > <nl> - Semantic UI CSS can be installed as a package in your project using NPM . You won ' t be able to <nl> + Semantic UI CSS can be installed as a package in your project using Yarn . You won ' t be able to <nl> use custom themes with this method . <nl> < / p > <nl> < Segment > <nl> < pre > <nl> - $ npm install semantic - ui - css - - save <nl> + $ yarn add semantic - ui - css <nl> < / pre > <nl> < / Segment > <nl> < p > <nl> @ @ - 133 , 7 + 132 , 6 @ @ const Usage = ( ) = > ( <nl> < / p > <nl> < Segment > <nl> < pre > $ yarn add semantic - ui - - dev < / pre > <nl> - < pre > $ npm install semantic - ui - - save - dev < / pre > <nl> < / Segment > <nl> < p > <nl> After building the project with Gulp , you ' ll need to include the minified CSS file <nl> 
mmm a / docs / app / Examples / views / Advertisement / Types / AdvertisementExampleBannerTop . js <nl> ppp b / docs / app / Examples / views / Advertisement / Types / AdvertisementExampleBannerTop . js <nl> import { Advertisement } from ' semantic - ui - react ' <nl> const AdvertisementExampleBannerTop = ( ) = > ( <nl> - < Advertisement unit = ' top banner ' test = ' Vertical Banner ' / > <nl> + < Advertisement unit = ' top banner ' test = ' Top Banner ' / > <nl> ) <nl> export default AdvertisementExampleBannerTop <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # # [ webpack2 ] [ 29 ] <nl> Our example project right [ here ] [ 29 ] in this repo . <nl> - # # # [ react - semantic . ui - starter ] [ 102 ] <nl> - Production - ready , performance - first , optimized , robust , fully - featured boilerplate / example for your new Progressive Web App . <nl> + # # # [ SUIcrux ] [ 102 ] <nl> + Advanced universal starter with Semantic - UI - React . React / Redux / Lazy - loading / SSR / PWA . <nl> # # # [ semantic - ui - react - todos ] [ 100 ] <nl> This example modifies the well - known [ react - redux Todo List ] [ 101 ] to use Semantic UI components . There is also a write - up on the process in the project README . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / build . games <nl> - https : / / platform . forecastcycles . com <nl> - https : / / www . findlectures . com <nl> + - https : / / github . com / ayastreb / bandwidth - hero <nl> # # Example Projects <nl> 
mmm a / docs / app / Examples / elements / Header / Content / index . js <nl> ppp b / docs / app / Examples / elements / Header / Content / index . js <nl> examplePath = ' elements / Header / Content / HeaderExampleSubheader ' <nl> / > <nl> < ComponentExample <nl> - description = ' You can pass an Subheader content to the Header subheader prop . ' <nl> + description = ' You can pass any Subheader content to the Header subheader prop . ' <nl> examplePath = ' elements / Header / Content / HeaderExampleSubheaderProp ' <nl> / > <nl> < / ExampleSection > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / appfollow . io <nl> - http : / / according . to . localsourc . es <nl> - http : / / www . aircip . ir <nl> + - https : / / www . bailfacile . fr <nl> - http : / / platform . nazarbazaar . ir <nl> - https : / / build . games <nl> - https : / / platform . forecastcycles . com <nl> 
mmm a / docs / app / Examples / elements / Step / Variations / StepExampleEvenlyDivided . js <nl> ppp b / docs / app / Examples / elements / Step / Variations / StepExampleEvenlyDivided . js <nl> const StepExampleEvenlyDivided = ( ) = > ( <nl> < Step . Group widths = { 3 } > <nl> < Step > <nl> - < Icon icon = ' truck ' / > <nl> + < Icon name = ' truck ' / > <nl> < Step . Content > <nl> < Step . Title > Shipping < / Step . Title > <nl> < / Step . Content > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / www . findlectures . com <nl> - https : / / github . com / ayastreb / bandwidth - hero <nl> - https : / / re . yomeshgupta . com <nl> + - https : / / moneytracker . cc <nl> # # Example Projects <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - https : / / github . com / ayastreb / bandwidth - hero <nl> - https : / / re . yomeshgupta . com <nl> - https : / / moneytracker . cc <nl> + - https : / / tax . cryptact . com <nl> # # Example Projects <nl> 
mmm a / docs / app / Examples / addons / Pagination / Usage / PaginationExampleOptions . js <nl> ppp b / docs / app / Examples / addons / Pagination / Usage / PaginationExampleOptions . js <nl> boundaryRange = { boundaryRange } <nl> onPageChange = { this . handlePaginationChange } <nl> size = ' mini ' <nl> + siblingRange = { siblingRange } <nl> totalPages = { totalPages } <nl> / / Heads up ! All items are powered by shorthands , if you want to hide one of them , just pass ` null ` as value <nl> ellipsisItem = { showEllipsis ? undefined : null } <nl> 
mmm a / docs / app / Examples / collections / Table / Types / TableExamplePagination . js <nl> ppp b / docs / app / Examples / collections / Table / Types / TableExamplePagination . js <nl> < Table . HeaderCell colSpan = ' 3 ' > <nl> < Menu floated = ' right ' pagination > <nl> < Menu . Item as = ' a ' icon > <nl> - < Icon name = ' left chevron ' / > <nl> + < Icon name = ' chevron left ' / > <nl> < / Menu . Item > <nl> < Menu . Item as = ' a ' > 1 < / Menu . Item > <nl> < Menu . Item as = ' a ' > 2 < / Menu . Item > <nl> < Menu . Item as = ' a ' > 3 < / Menu . Item > <nl> < Menu . Item as = ' a ' > 4 < / Menu . Item > <nl> < Menu . Item as = ' a ' icon > <nl> - < Icon name = ' right chevron ' / > <nl> + < Icon name = ' chevron right ' / > <nl> < / Menu . Item > <nl> < / Menu > <nl> < / Table . HeaderCell > <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentExample / ComponentExample . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentExample / ComponentExample . js <nl> / / capture the default export so we can return it from the IIFE <nl> const defaultExport = _ . get ( / export \ s + default \ s + ( ? : class | function ) ? ( ? : \ s + ) ? ( \ w + ) / . exec ( sourceCode ) , ' [ 1 ] ' ) <nl> - / / consider everything after the imports to be the body <nl> - / / remove ` export ` statements except ` export default class | function ` <nl> - const body = _ . get ( / import [ \ s \ S ] * from . * \ n ( [ \ s \ S ] * ) / . exec ( sourceCode ) , ' [ 1 ] ' , ' ' ) <nl> + const body = _ . get ( / ( export \ sdefault \ sclass | const | class \ s \ S * \ sextends ) [ \ s \ S ] * / . exec ( sourceCode ) , ' [ 0 ] ' , ' ' ) <nl> . replace ( / export \ s + default \ s + ( ? ! class | function ) \ w + ( [ \ s \ n ] + ) ? / , ' ' ) / / remove ` export default Foo ` statements <nl> . replace ( / export \ s + default \ s + / , ' ' ) / / remove ` export default . . . ` <nl> 
mmm a / docs / app / Layouts / StickyLayout . js <nl> ppp b / docs / app / Layouts / StickyLayout . js <nl> < p > This example shows how to use lazy loaded images , a sticky menu , and a simple text container < / p > <nl> < / Container > <nl> - { / * Attaching the top menu is a simple operation , we only switch ` fixed ` prop add add another styles if it has <nl> + { / * Attaching the top menu is a simple operation , we only switch ` fixed ` prop and add another style if it has <nl> gone beyond the scope of visibility <nl> * / } <nl> < Visibility <nl> 
mmm a / docs / app / Examples / addons / Responsive / Usage / ResponsiveExampleFireOnMount . js <nl> ppp b / docs / app / Examples / addons / Responsive / Usage / ResponsiveExampleFireOnMount . js <nl> < Grid . Column textAlign = { textAlign } > <nl> < Segment > <nl> This grid has responsive align of the text . It will be right aligned on computer and left aligned on other <nl> - breakpoins . <nl> + breakpoints . <nl> < / Segment > <nl> < / Grid . Column > <nl> < / Responsive > <nl> 
mmm a / docs / app / Components / CarbonAd / CarbonAd . js <nl> ppp b / docs / app / Components / CarbonAd / CarbonAd . js <nl> const style = { <nl> transition : ` opacity $ { TRANSITION_TIME } ms ` , <nl> - minHeight : 173 , <nl> + minHeight : 199 , <nl> background : ' # 000 ' , <nl> opacity : isBlockingAds ? 1 : opacity , <nl> } <nl> 
mmm a / docs / app / Layouts / GridLayout . js <nl> ppp b / docs / app / Layouts / GridLayout . js <nl> < Header as = ' h3 ' > Text Container < / Header > <nl> < p > <nl> Sometimes you just need to put a single column of centered text on a page . A < code > text container < / code > is <nl> - a special type of container optimized for a single flowing column of text , like this instructions on this page . <nl> + a special type of container optimized for a single flowing column of text , like these instructions on this page . <nl> < / p > <nl> < p > Text containers < b > do not need to use grids < / b > and help simplify basic page layouts . < / p > <nl> 
mmm a / docs / app / Examples / elements / List / ContentVariations / index . js <nl> ppp b / docs / app / Examples / elements / List / ContentVariations / index . js <nl> < ComponentExample <nl> title = ' Floated ' <nl> - description = ' An list , or an element inside a list can be floated left or right ' <nl> + description = ' A list , or an element inside a list can be floated left or right ' <nl> examplePath = ' elements / List / ContentVariations / ListExampleFloated ' <nl> / > <nl> < ComponentExample examplePath = ' elements / List / ContentVariations / ListExampleFloatedHorizontal ' / > <nl> 
mmm a / docs / app / Examples / elements / List / Variations / index . js <nl> ppp b / docs / app / Examples / elements / List / Variations / index . js <nl> import ExampleSection from ' docs / app / Components / ComponentDoc / ExampleSection ' <nl> const ListVariations = ( ) = > ( <nl> - < ExampleSection title = ' Types ' > <nl> + < ExampleSection title = ' Variations ' > <nl> < ComponentExample <nl> title = ' Horizontal ' <nl> description = ' A list can be formatted to have items appear horizontally ' <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> - [ Components ] ( # components ) <nl> - [ Props ] ( # props ) <nl> - [ Examples ] ( # examples ) <nl> + - [ Releasing ] ( # releasing ) <nl> < ! - - END doctoc generated TOC please keep comment here to allow auto update - - > <nl> @ @ - 557 , 6 + 558 , 17 @ @ Usage examples for a component live in ` docs / app / Examples ` . The examples follow <nl> Adding documentation for new components is a bit tedious . The best way to do this ( for now ) is to copy an existing component ' s and update them . <nl> + # # Releasing <nl> + <nl> + On the latest clean ` master ` : <nl> + <nl> + ` ` ` sh <nl> + npm run release : < major | minor | patch > <nl> + ` ` ` <nl> + > : warning : ` npm ` must be used . At the time of writing ` yarn ` does not properly handle the credentials . <nl> + <nl> + Releasing will update the changelog which requires [ github_changelog_generator ] [ 15 ] . <nl> + <nl> [ 1 ] : https : / / github . com / Semantic - Org / Semantic - UI - React / blob / master / test / specs / commonTests . js <nl> [ 2 ] : https : / / facebook . github . io / react / docs / forms . html # controlled - components <nl> [ 3 ] : https : / / facebook . github . io / react / docs / forms . html # uncontrolled - components <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - # # Built With Semantic UI React <nl> + # # Built With <nl> < img align = " left " height = " 50 " src = " https : / / github . com / Semantic - Org / Semantic - UI - React / raw / master / docs / app / amazon - logo . png " / > <nl> < img align = " left " height = " 50 " src = " https : / / github . com / Semantic - Org / Semantic - UI - React / raw / master / docs / app / netflix - logo . png " / > <nl> @ @ - 160 , 6 + 160 , 7 @ @ Any other issue labeled [ ` help wanted ` ] [ 4 ] is ready for a PR . <nl> - Complete SUI component definition support <nl> - Completely documented <nl> - Completely tested <nl> + - Accessible <nl> # # Credit <nl> 
mmm a / docs / app / Examples / modules / Modal / Variations / ModalExampleScrollingContent . js <nl> ppp b / docs / app / Examples / modules / Modal / Variations / ModalExampleScrollingContent . js <nl> < / Modal . Content > <nl> < Modal . Actions > <nl> < Button primary > <nl> - Proceed < Icon name = ' right chevron ' / > <nl> + Proceed < Icon name = ' chevron right ' / > <nl> < / Button > <nl> < / Modal . Actions > <nl> < / Modal > <nl> 
mmm a / docs / app / Examples / collections / Form / GroupVariations / index . js <nl> ppp b / docs / app / Examples / collections / Form / GroupVariations / index . js <nl> examplePath = ' collections / Form / GroupVariations / FormExampleEvenlyDividedGroup ' <nl> > <nl> < Message info > <nl> - When using the < code > widths = ' even ' < / code > prop declaration on a < code > Form . Group < / code > , <nl> + When using the < code > widths = ' equal ' < / code > prop declaration on a < code > Form . Group < / code > , <nl> all child < code > Form . Dropdown < / code > , < code > Form . Input < / code > , < code > Form . Select < / code > <nl> components must be rendered with a < code > fluid < / code > prop to work correctly . <nl> < / Message > <nl> 
mmm a / docs / src / routes . js <nl> ppp b / docs / src / routes . js <nl> import ExternalExampleLayout from ' . / components / ExternalExampleLayout ' <nl> import DocsLayout from ' . / components / DocsLayout ' <nl> import DocsRoot from ' . / components / DocsRoot ' <nl> - import LayoutsLayout from ' . / components / layoutsLayout ' <nl> - import LayoutsRoot from ' . / components / layoutsRoot ' <nl> + import LayoutsLayout from ' . / components / LayoutsLayout ' <nl> + import LayoutsRoot from ' . / components / LayoutsRoot ' <nl> import Introduction from ' . / views / Introduction ' <nl> import Layouts from ' . / views / layouts ' <nl> 
mmm a / docs / src / views / Usage . js <nl> ppp b / docs / src / views / Usage . js <nl> should use corresponding version of Semantic UI React : <nl> < / p > <nl> < Message . List > <nl> - < Message . Item > for SUI 2 . 2 use 0 . 79 . 1 and below < / Message . Item > <nl> - < Message . Item > for SUI 2 . 3 use 0 . 80 . 0 and higher < / Message . Item > <nl> + < Message . Item > for SUI 2 . 2 use 0 . 80 . 2 and below < / Message . Item > <nl> + < Message . Item > for SUI 2 . 3 use 0 . 81 . 0 and higher < / Message . Item > <nl> < / Message . List > <nl> < / Message > <nl> @ @ - 247 , 7 + 247 , 7 @ @ const Usage = ( ) = > ( <nl> < / p > <nl> < p > <nl> - Please ensure that you ' re using < code > semantic - ui - react @ 0 . 82 . 0 < / code > or higher because we <nl> + Please ensure that you ' re using < code > semantic - ui - react @ 0 . 81 . 2 < / code > or higher because we <nl> added the { ' ' } <nl> < a <nl> href = ' https : / / webpack . js . org / guides / tree - shaking / # mark - the - file - as - side - effect - free ' <nl> 
mmm a / docs / src / examples / elements / Button / Types / ButtonExampleAnimated . js <nl> ppp b / docs / src / examples / elements / Button / Types / ButtonExampleAnimated . js <nl> < Button animated > <nl> < Button . Content visible > Next < / Button . Content > <nl> < Button . Content hidden > <nl> - < Icon name = ' right arrow ' / > <nl> + < Icon name = ' arrow right ' / > <nl> < / Button . Content > <nl> < / Button > <nl> < Button animated = ' vertical ' > <nl> 
mmm a / docs / src / layouts / HomepageLayout . js <nl> ppp b / docs / src / layouts / HomepageLayout . js <nl> const { fixed } = this . state <nl> return ( <nl> - < Responsive { . . . Responsive . onlyComputer } > <nl> + < Responsive minWidth = { Responsive . onlyTablet . minWidth } > <nl> < Visibility <nl> once = { false } <nl> onBottomPassed = { this . showFixedMenu } <nl> @ @ - 135 , 7 + 135 , 7 @ @ class MobileContainer extends Component { <nl> const { sidebarOpened } = this . state <nl> return ( <nl> - < Responsive { . . . Responsive . onlyMobile } > <nl> + < Responsive maxWidth = { Responsive . onlyMobile . maxWidth } > <nl> < Sidebar . Pushable > <nl> < Sidebar as = { Menu } animation = ' uncover ' inverted vertical visible = { sidebarOpened } > <nl> < Menu . Item as = ' a ' active > <nl> 
mmm a / docs / src / examples / elements / Icon / Groups / IconExampleIconGroup . js <nl> ppp b / docs / src / examples / elements / Icon / Groups / IconExampleIconGroup . js <nl> const IconExampleIconGroup = ( ) = > ( <nl> < Icon . Group size = ' huge ' > <nl> - < Icon size = ' big ' name = ' thin circle ' / > <nl> + < Icon size = ' big ' name = ' circle outline ' / > <nl> < Icon name = ' user ' / > <nl> < / Icon . Group > <nl> ) <nl> 
mmm a / docs / src / examples / elements / Icon / Groups / IconExampleLoadingGroup . js <nl> ppp b / docs / src / examples / elements / Icon / Groups / IconExampleLoadingGroup . js <nl> < Icon color = ' black ' name = ' user ' / > <nl> < / Icon . Group > <nl> < Icon . Group size = ' huge ' > <nl> - < Icon loading size = ' big ' name = ' sun ' / > <nl> + < Icon loading size = ' big ' name = ' circle notch ' / > <nl> < Icon name = ' user ' / > <nl> < / Icon . Group > <nl> < / div > <nl> 
mmm a / docs / src / examples / elements / Icon / Variations / IconExampleFitted . js <nl> ppp b / docs / src / examples / elements / Icon / Variations / IconExampleFitted . js <nl> const IconExampleFitted = ( ) = > ( <nl> < div > <nl> - < p > Tight spacing < / p > <nl> - < Icon fitted name = ' help ' / > <nl> - < p > Tight spacing < / p > <nl> + This icon < Icon fitted name = ' help ' / > is fitted . <nl> + < br / > <nl> + This icon < Icon name = ' help ' / > is not . <nl> < / div > <nl> ) <nl> 
mmm a / docs / src / components / ComponentDoc / ComponentExample / ComponentExample . js <nl> ppp b / docs / src / components / ComponentDoc / ComponentExample / ComponentExample . js <nl> import ComponentExampleTitle from ' . / ComponentExampleTitle ' <nl> const childrenStyle = { <nl> + paddingBottom : 0 , <nl> paddingTop : 0 , <nl> maxWidth : ' 50rem ' , <nl> } <nl> @ @ - 224 , 12 + 225 , 12 @ @ class ComponentExample extends PureComponent { <nl> < div id = { this . anchorName } style = { { paddingTop : ' 1rem ' } } > <nl> < Grid <nl> className = ' docs - example ' <nl> - columns = ' equal ' <nl> padded = ' vertically ' <nl> onMouseLeave = { handleMouseLeave } <nl> onMouseMove = { handleMouseMove } <nl> style = { exampleStyle } <nl> > <nl> + < Grid . Row columns = ' equal ' > <nl> < Grid . Column > <nl> < ComponentExampleTitle <nl> description = { description } <nl> @ @ - 248 , 11 + 249 , 12 @ @ class ComponentExample extends PureComponent { <nl> showHTML = { showHTML } <nl> / > <nl> < / Grid . Column > <nl> + < / Grid . Row > <nl> { children & & ( <nl> - < Grid . Column width = { 16 } style = { childrenStyle } > <nl> - { children } <nl> - < / Grid . Column > <nl> + < Grid . Row columns = { 1 } style = { childrenStyle } > <nl> + < Grid . Column > { children } < / Grid . Column > <nl> + < / Grid . Row > <nl> ) } <nl> < Grid . Column <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < / a > <nl> < a href = " https : / / circleci . com / gh / Semantic - Org / Semantic - UI - React / tree / master " > <nl> - < img alt = " Circle " src = " https : / / img . shields . io / circleci / project / Semantic - Org / Semantic - UI - React / master . svg ? style = flat - square " / > <nl> + < img alt = " Circle " src = " https : / / img . shields . io / circleci / project / github / Semantic - Org / Semantic - UI - React / master . svg ? style = flat - square " / > <nl> < / a > <nl> < a href = " https : / / codecov . io / gh / Semantic - Org / Semantic - UI - React " > <nl> < img alt = " Codecov " src = " https : / / img . shields . io / codecov / c / github / Semantic - Org / Semantic - UI - React / master . svg ? style = flat - square " / > <nl> 
mmm a / docs / src / examples / collections / Form / Shorthand / FormExampleFieldControlId . js <nl> ppp b / docs / src / examples / collections / Form / Shorthand / FormExampleFieldControlId . js <nl> - import { Form , Input , TextArea , Button } from ' semantic - ui - react ' <nl> + import { Form , Input , TextArea , Button , Select } from ' semantic - ui - react ' <nl> + <nl> + const genderOptions = [ <nl> + { key : ' m ' , text : ' Male ' , value : ' male ' } , <nl> + { key : ' f ' , text : ' Female ' , value : ' female ' } , <nl> + ] <nl> const FormExampleFieldControlId = ( ) = > ( <nl> < Form > <nl> @ @ - 16 , 6 + 21 , 14 @ @ const FormExampleFieldControlId = ( ) = > ( <nl> label = ' Last name ' <nl> placeholder = ' Last name ' <nl> / > <nl> + < Form . Field <nl> + control = { Select } <nl> + options = { genderOptions } <nl> + label = { { children : ' Gender ' , htmlFor : ' form - select - control - gender ' } } <nl> + placeholder = ' Gender ' <nl> + search <nl> + searchInput = { { id : ' form - select - control - gender ' } } <nl> + / > <nl> < / Form . Group > <nl> < Form . Field <nl> id = ' form - textarea - control - opinion ' <nl> 
mmm a / docs / src / examples / collections / Grid / Variations / index . js <nl> ppp b / docs / src / examples / collections / Grid / Variations / index . js <nl> < ComponentExample <nl> title = ' Stretched ' <nl> - description = ' A row can automatically resize all elements to split the available width evenly . ' <nl> + description = ' A row can automatically resize all elements to split the available height evenly . ' <nl> examplePath = ' collections / Grid / Variations / GridExampleStretched ' <nl> / > <nl> < ComponentExample examplePath = ' collections / Grid / Variations / GridExampleStretchedEqual ' / > <nl> 
mmm a / docs / src / components / Document . js <nl> ppp b / docs / src / components / Document . js <nl> < link rel = ' stylesheet ' href = ' / style . css ' / > <nl> < link <nl> rel = ' stylesheet ' <nl> - href = { ` / / cdnjs . cloudflare . com / ajax / libs / semantic - ui / $ { versions . sui } / semantic . min . css ` } <nl> + href = { ` https : / / cdnjs . cloudflare . com / ajax / libs / semantic - ui / $ { versions . sui } / semantic . min . css ` } <nl> / > <nl> - < script src = { ` / / cdnjs . cloudflare . com / ajax / libs / anchor - js / $ { versions . anchor } / anchor . min . js ` } / > <nl> < script <nl> - src = { ` / / cdn . jsdelivr . net / npm / @ babel / standalone @ $ { versions . babel . standalone } / babel . min . js ` } <nl> + src = { ` https : / / cdnjs . cloudflare . com / ajax / libs / anchor - js / $ { versions . anchor } / anchor . min . js ` } <nl> / > <nl> < script <nl> - src = { ` / / cdn . jsdelivr . net / npm / @ babel / preset - env - standalone @ $ { <nl> + src = { ` https : / / cdn . jsdelivr . net / npm / @ babel / standalone @ $ { <nl> + versions . babel . standalone <nl> + } / babel . min . js ` } <nl> + / > <nl> + < script <nl> + src = { ` https : / / cdn . jsdelivr . net / npm / @ babel / preset - env - standalone @ $ { <nl> versions . babel . standalone <nl> } / babel - preset - env . min . js ` } <nl> / > <nl> - < script src = { ` / / cdn . jsdelivr . net / faker . js / $ { versions . faker } / faker . min . js ` } / > <nl> + < script src = { ` https : / / cdn . jsdelivr . net / faker . js / $ { versions . faker } / faker . min . js ` } / > <nl> - < script crossOrigin = ' true ' src = { ` / / unpkg . com / prettier @ $ { versions . prettier } / standalone . js ` } / > <nl> < script <nl> crossOrigin = ' true ' <nl> - src = { ` / / unpkg . com / prettier @ $ { versions . prettier } / parser - babylon . js ` } <nl> + src = { ` https : / / unpkg . com / prettier @ $ { versions . prettier } / standalone . js ` } <nl> + / > <nl> + < script <nl> + crossOrigin = ' true ' <nl> + src = { ` https : / / unpkg . com / prettier @ $ { versions . prettier } / parser - babylon . js ` } <nl> / > <nl> < script <nl> - src = { ` / / cdnjs . cloudflare . com / ajax / libs / prop - types / $ { versions . propTypes } / prop - types $ { <nl> + src = { ` https : / / cdnjs . cloudflare . com / ajax / libs / prop - types / $ { versions . propTypes } / prop - types $ { <nl> siteData . dev ? ' ' : ' . min ' <nl> } . js ` } <nl> / > <nl> < script <nl> - src = { ` / / cdnjs . cloudflare . com / ajax / libs / react / $ { versions . react } / umd / react $ { <nl> + src = { ` https : / / cdnjs . cloudflare . com / ajax / libs / react / $ { versions . react } / umd / react $ { <nl> dev ? ' . development ' : ' . production . min ' <nl> } . js ` } <nl> / > <nl> < script <nl> - src = { ` / / cdnjs . cloudflare . com / ajax / libs / react - dom / $ { versions . react } / umd / react - dom $ { <nl> + src = { ` https : / / cdnjs . cloudflare . com / ajax / libs / react - dom / $ { versions . react } / umd / react - dom $ { <nl> dev ? ' . development ' : ' . production . min ' <nl> } . js ` } <nl> / > <nl> < script <nl> - src = { ` / / cdnjs . cloudflare . com / ajax / libs / react - dom / $ { <nl> + src = { ` https : / / cdnjs . cloudflare . com / ajax / libs / react - dom / $ { <nl> versions . react <nl> } / umd / react - dom - server . browser $ { dev ? ' . development ' : ' . production . min ' } . js ` } <nl> / > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < details > <nl> < summary > < b > How do I setup CSS ? < / b > < / summary > <nl> + <nl> There are several options . Refer to our doc on [ CSS Usage ] [ 23 ] . <nl> < / details > <nl> 
mmm a / docs / src / components / ComponentDoc / ComponentExample / ComponentExampleRenderSource . js <nl> ppp b / docs / src / components / ComponentDoc / ComponentExample / ComponentExampleRenderSource . js <nl> import * as selectCommon from ' docs / src / examples / addons / Select / common ' <nl> import Wireframe from ' docs / src / examples / behaviors / Visibility / Wireframe ' <nl> import * as dropdownCommon from ' docs / src / examples / modules / Dropdown / common ' <nl> + import SearchExampleStandard from ' docs / src / examples / modules / Search / Types / SearchExampleStandard ' <nl> + import SearchExampleCategory from ' docs / src / examples / modules / Search / Types / SearchExampleCategory ' <nl> const babelConfig = { <nl> presets : [ <nl> @ @ - 39 , 7 + 41 , 10 @ @ const commons = { <nl> const resolver = ( importPath , { displayName } ) = > { <nl> if ( externals [ importPath ] ) return externals [ importPath ] <nl> if ( commons [ displayName ] & & _ . endsWith ( importPath , ' / common ' ) ) return commons [ displayName ] <nl> + <nl> if ( _ . endsWith ( importPath , ' / Wireframe ' ) ) return Wireframe <nl> + if ( _ . endsWith ( importPath , ' / SearchExampleCategory ' ) ) return SearchExampleCategory <nl> + if ( _ . endsWith ( importPath , ' / SearchExampleStandard ' ) ) return SearchExampleStandard <nl> throw new Error ( <nl> [ <nl> 
mmm a / docs / src / pages / Usage . mdx <nl> ppp b / docs / src / pages / Usage . mdx <nl> < CodeSnippet <nl> mode = ' html ' <nl> - value = { ` < link rel = " stylesheet " href = " / / cdnjs . cloudflare . com / ajax / libs / semantic - ui / $ { props . versions . sui } / semantic . min . css " > < / link > ` } <nl> + value = { ` < link rel = " stylesheet " href = " / / cdn . jsdelivr . net / npm / semantic - ui @ $ { props . versions . sui } / dist / semantic . min . css " > < / link > ` } <nl> / > <nl> # # # Semantic UI CSS package <nl> 
mmm a / docs / src / examples / addons / TextArea / Types / index . js <nl> ppp b / docs / src / examples / addons / TextArea / Types / index . js <nl> + import { Message } from ' semantic - ui - react ' <nl> import ComponentExample from ' docs / src / components / ComponentDoc / ComponentExample ' <nl> import ExampleSection from ' docs / src / components / ComponentDoc / ExampleSection ' <nl> @ @ - 9 , 7 + 10 , 12 @ @ const TextAreaTypesExamples = ( ) = > ( <nl> title = ' TextArea ' <nl> description = ' A default TextArea . ' <nl> examplePath = ' addons / TextArea / Types / TextAreaExampleTextArea ' <nl> - / > <nl> + > <nl> + < Message info > <nl> + You should always wrap a < code > Textarea < / code > with a < code > Form < / code > component to get <nl> + styles applied because Semantic UI applies styles for < code > . ui . form textarea < / code > . <nl> + < / Message > <nl> + < / ComponentExample > <nl> < / ExampleSection > <nl> ) <nl> 
mmm a / docs / src / layouts / FixedMenuLayout . js <nl> ppp b / docs / src / layouts / FixedMenuLayout . js <nl> < Segment inverted vertical style = { { margin : ' 5em 0em 0em ' , padding : ' 5em 0em ' } } > <nl> < Container textAlign = ' center ' > <nl> < Grid divided inverted stackable > <nl> - < Grid . Row > <nl> < Grid . Column width = { 3 } > <nl> < Header inverted as = ' h4 ' content = ' Group 1 ' / > <nl> < List link inverted > <nl> @ @ - 94 , 12 + 93 , 11 @ @ const FixedMenuLayout = ( ) = > ( <nl> Extra space for a call to action inside the footer that could help re - engage users . <nl> < / p > <nl> < / Grid . Column > <nl> - < / Grid . Row > <nl> < / Grid > <nl> < Divider inverted section / > <nl> < Image centered size = ' mini ' src = ' / logo . png ' / > <nl> - < List horizontal inverted divided link > <nl> + < List horizontal inverted divided link size = ' small ' > <nl> < List . Item as = ' a ' href = ' # ' > <nl> Site Map <nl> < / List . Item > <nl> 
mmm a / docs / src / utils / formatCode . js <nl> ppp b / docs / src / utils / formatCode . js <nl> import prettierConfig from ' . . / . . / . . / . prettierrc . json ' <nl> + import isBrowser from ' . . / . . / . . / src / lib / isBrowser ' <nl> const { printWidth } = prettierConfig . overrides . find ( <nl> ( { files } ) = > files = = = ' docs / src / examples / * * / * . js ' , <nl> @ @ - 19 , 7 + 20 , 7 @ @ const formatCode = ( code , parser = ' babylon ' ) = > { <nl> . . . prettierConfig , <nl> printWidth , <nl> parser , <nl> - plugins : window . prettierPlugins , <nl> + plugins : isBrowser ( ) ? window . prettierPlugins : undefined , <nl> } ) <nl> return formatted . replace ( / ^ ; < / , ' < ' ) / / remove beginning comma in JSX / HTML <nl> 
mmm a / docs / src / utils / formatCode . js <nl> ppp b / docs / src / utils / formatCode . js <nl> / / Please use this function directly and don ' t reexport it in utils . <nl> / / https : / / github . com / prettier / prettier / issues / 4959 <nl> - const formatCode = ( code , parser = ' babylon ' ) = > { <nl> + const formatCode = isBrowser ( ) <nl> + ? ( code , parser = ' babylon ' ) = > { <nl> if ( ! code ) return ' ' <nl> const formatted = prettier . format ( code , { <nl> . . . prettierConfig , <nl> printWidth , <nl> parser , <nl> - plugins : isBrowser ( ) ? window . prettierPlugins : undefined , <nl> + plugins : window . prettierPlugins , <nl> } ) <nl> - return formatted . replace ( / ^ ; < / , ' < ' ) / / remove beginning comma in JSX / HTML <nl> + return formatted . replace ( / ^ ; < / , ' < ' ) / / remove beginning semi in JSX / HTML <nl> } <nl> + : x = > x <nl> export default formatCode <nl> 
mmm a / docs / src / components / ComponentDoc / ComponentProps / ComponentProps . js <nl> ppp b / docs / src / components / ComponentDoc / ComponentProps / ComponentProps . js <nl> return ( <nl> < div > <nl> - < Checkbox slider checked = { ! ! activeDisplayName } label = ' Props ' onClick = { this . handleToggle } / > <nl> + < Checkbox slider checked = { ! ! activeDisplayName } label = ' Props ' onChange = { this . handleToggle } / > <nl> < ComponentPropsComponents <nl> activeDisplayName = { activeDisplayName } <nl> displayNames = { displayNames } <nl> 
mmm a / docs / src / examples / elements / Placeholder / Variations / PlaceholderExampleLineLengthWithHeader . js <nl> ppp b / docs / src / examples / elements / Placeholder / Variations / PlaceholderExampleLineLengthWithHeader . js <nl> const PlaceholderExampleLineLengthWithHeader = ( ) = > ( <nl> < Placeholder > <nl> - < div className = ' ui placeholder ' > <nl> < Placeholder . Header image > <nl> < Placeholder . Line length = ' medium ' / > <nl> < Placeholder . Line length = ' full ' / > <nl> @ @ - 12 , 7 + 11 , 6 @ @ const PlaceholderExampleLineLengthWithHeader = ( ) = > ( <nl> < Placeholder . Line length = ' full ' / > <nl> < Placeholder . Line length = ' medium ' / > <nl> < / Placeholder . Paragraph > <nl> - < / div > <nl> < / Placeholder > <nl> ) <nl> 
mmm a / docs / src / examples / addons / Responsive / Types / ResponsiveExampleMaxWidth . js <nl> ppp b / docs / src / examples / addons / Responsive / Types / ResponsiveExampleMaxWidth . js <nl> Visible only if display has < code > 767px < / code > width and lower <nl> < / Responsive > <nl> < Responsive as = { Segment } maxWidth = { 2569 } > <nl> - Visible only if display has < code > 2569px < / code > width <nl> + Visible only if display has < code > 2569px < / code > width and lower <nl> < / Responsive > <nl> < / Segment . Group > <nl> ) <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " scripts " : { <nl> " build " : " cross - env NODE_ENV = production gulp build " , <nl> - " build : changelog " : " github_changelog_generator - - user Semantic - Org - - project Semantic - UI - React - - no - issues - - no - unreleased - - release - branch master - - breaking - labels breaking - change - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 250 ) ) " , <nl> + " build : changelog " : " github_changelog_generator - - user Semantic - Org - - project Semantic - UI - React - - no - issues - - no - unreleased - - release - branch master - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 250 ) ) " , <nl> " build : docs " : " cross - env NODE_ENV = production gulp build : docs " , <nl> " build : docs : staging " : " cross - env STAGING = true yarn build : docs & & yarn serve docs / dist " , <nl> " build : dist " : " gulp - - series build : dist " , <nl> 
mmm a / src / modules / Modal / ModalDescription . js <nl> ppp b / src / modules / Modal / ModalDescription . js <nl> import { childrenUtils , customPropTypes , getElementType , getUnhandledProps } from ' . . / . . / lib ' <nl> / * * <nl> - * A modal can have a header . <nl> + * A modal can contain a description with one or more paragraphs . <nl> * / <nl> function ModalDescription ( props ) { <nl> const { children , className , content } = props <nl> 
mmm a / docs / src / examples / modules / Dropdown / Types / DropdownExampleFloating . js <nl> ppp b / docs / src / examples / modules / Dropdown / Types / DropdownExampleFloating . js <nl> < Button . Group color = ' teal ' > <nl> < Button > Save < / Button > <nl> < Dropdown <nl> - as = { Button } <nl> - className = ' icon ' <nl> + className = ' button icon ' <nl> floating <nl> options = { options } <nl> trigger = { < React . Fragment / > } <nl> 
mmm a / docs / src / examples / modules / Dropdown / Usage / DropdownExampleRemote . js <nl> ppp b / docs / src / examples / modules / Dropdown / Usage / DropdownExampleRemote . js <nl> } ) <nl> class DropdownExampleRemote extends Component { <nl> - componentWillMount ( ) { <nl> - this . setState ( { <nl> + state = { <nl> isFetching : false , <nl> multiple : true , <nl> search : true , <nl> searchQuery : null , <nl> value : [ ] , <nl> options : getOptions ( ) , <nl> - } ) <nl> } <nl> handleChange = ( e , { value } ) = > this . setState ( { value } ) <nl> @ @ - 39 , 7 + 37 , 7 @ @ class DropdownExampleRemote extends Component { <nl> this . setState ( { value : multiple ? [ value ] : value } ) <nl> } <nl> - toggleSearch = e = > this . setState ( { search : e . target . checked } ) <nl> + toggleSearch = ( e ) = > this . setState ( { search : e . target . checked } ) <nl> toggleMultiple = ( e ) = > { <nl> const { value } = this . state <nl> @ @ - 61 , 10 + 59 , 20 @ @ class DropdownExampleRemote extends Component { <nl> Random <nl> < / Button > <nl> < label > <nl> - < input type = ' checkbox ' checked = { search } onChange = { this . toggleSearch } / > Search <nl> + < input <nl> + type = ' checkbox ' <nl> + checked = { search } <nl> + onChange = { this . toggleSearch } <nl> + / > { ' ' } <nl> + Search <nl> < / label > { ' ' } <nl> < label > <nl> - < input type = ' checkbox ' checked = { multiple } onChange = { this . toggleMultiple } / > Multiple <nl> + < input <nl> + type = ' checkbox ' <nl> + checked = { multiple } <nl> + onChange = { this . toggleMultiple } <nl> + / > { ' ' } <nl> + Multiple <nl> < / label > <nl> < / p > <nl> < Dropdown <nl> 
mmm a / docs / src / components / ComponentDoc / ComponentDoc . js <nl> ppp b / docs / src / components / ComponentDoc / ComponentDoc . js <nl> state = { } <nl> examplesRef = createRef ( ) <nl> - getChildContext ( ) { <nl> + static getDerivedStateFromProps ( props , state ) { <nl> return { <nl> - onPassed : this . handleExamplePassed , <nl> + displayName : props . displayName , <nl> + activePath : props . displayName = = = state . displayName ? state . activePath : undefined , <nl> } <nl> } <nl> - componentWillReceiveProps ( { displayName } ) { <nl> - if ( displayName ! = = this . props . displayName ) { <nl> - this . setState ( { activePath : undefined } ) <nl> + getChildContext ( ) { <nl> + return { <nl> + onPassed : this . handleExamplePassed , <nl> } <nl> } <nl> 
mmm a / docs / src / components / ComponentDoc / ComponentProps / ComponentProps . js <nl> ppp b / docs / src / components / ComponentDoc / ComponentProps / ComponentProps . js <nl> displayName : PropTypes . string . isRequired , <nl> } <nl> - state = { <nl> - activeDisplayName : null , <nl> - } <nl> - <nl> - componentWillReceiveProps ( nextProps ) { <nl> - const currentName = this . props . displayName <nl> - const nextName = nextProps . displayName <nl> + state = { } <nl> - if ( currentName . displayName ! = = nextName ) { <nl> - this . setState ( { activeDisplayName : null } ) <nl> + static getDerivedStateFromProps ( props , state ) { <nl> + return { <nl> + displayName : props . displayName , <nl> + activeDisplayName : props . displayName = = = state . displayName ? state . activeDisplayName : null , <nl> } <nl> } <nl> 
mmm a / docs / src / examples / modules / Dropdown / Usage / index . js <nl> ppp b / docs / src / examples / modules / Dropdown / Usage / index . js <nl> examplePath = ' modules / Dropdown / Usage / DropdownExampleSearchQuery ' <nl> > <nl> < Message info > <nl> - This example also shows how to override default bevahiour of the search query and keep <nl> + This example also shows how to override default behaviour of the search query and keep <nl> entered value after selection . <nl> < / Message > <nl> < / ComponentExample > <nl> 
mmm a / docs / src / layouts / BootstrapMigrationLayout . js <nl> ppp b / docs / src / layouts / BootstrapMigrationLayout . js <nl> < Grid . Row > <nl> < Grid . Column > <nl> < Header as = ' h1 ' > Buttons < / Header > <nl> - < Button as = ' a ' tabindex = ' 0 ' > <nl> + < Button as = ' a ' tabIndex = ' 0 ' > <nl> Default <nl> < / Button > <nl> - < Button as = ' a ' primary tabindex = ' 0 ' > <nl> + < Button as = ' a ' primary tabIndex = ' 0 ' > <nl> Primary <nl> < / Button > <nl> - < Button as = ' a ' basic tabindex = ' 0 ' > <nl> + < Button as = ' a ' basic tabIndex = ' 0 ' > <nl> Basic <nl> < / Button > <nl> - < Button as = ' a ' positive tabindex = ' 0 ' > <nl> + < Button as = ' a ' positive tabIndex = ' 0 ' > <nl> Success <nl> < / Button > <nl> - < Button as = ' a ' negative tabindex = ' 0 ' > <nl> + < Button as = ' a ' negative tabIndex = ' 0 ' > <nl> Error <nl> < / Button > <nl> < / Grid . Column > <nl> 
mmm a / docs / src / pages / Usage . mdx <nl> ppp b / docs / src / pages / Usage . mdx <nl> render : ( ) = > ( <nl> < Tab . Pane style = { { fontSize : ' inherit ' } } > <nl> < p > <nl> - Semantic UI React is fully compatible with < code > create - app - react < / code > and works out <nl> + Semantic UI React is fully compatible with < code > create - react - app < / code > and works out <nl> the box . Setup of custom theme is covered in < Link to = ' / theming ' > Theming guide < / Link > . <nl> < / p > <nl> < / Tab . Pane > <nl> 
mmm a / docs / src / examples / modules / Embed / Types / EmbedExampleCustom . js <nl> ppp b / docs / src / examples / modules / Embed / Types / EmbedExampleCustom . js <nl> < Embed <nl> icon = ' right circle arrow ' <nl> placeholder = ' / images / image - 16by9 . png ' <nl> - url = ' http : / / www . myfav . es / jack ' <nl> + url = ' https : / / www . myfav . es / jack ' <nl> / > <nl> ) <nl> 
mmm a / docs / src / pages / Theming . mdx <nl> ppp b / docs / src / pages / Theming . mdx <nl> # # # Install required dependencies <nl> - Create React App does not support LESS out of the box , we and propose to use [ ` @ craco / craco ` ] ( https : / / www . npmjs . com / package / @ craco / craco ) to add it and avoid ` eject ` . You have to install required packages : <nl> + Create React App does not support LESS out of the box , we and propose to use [ ` @ craco / craco ` ] ( https : / / www . npmjs . com / package / @ craco / craco ) to add its support and avoid ` eject ` . You have to install required packages : <nl> ` ` ` bash <nl> - npm install @ craco / craco craco - less semantic - ui - less - - save - dev <nl> + npm install @ craco / craco @ semantic - ui - react / craco - less semantic - ui - less - - save - dev <nl> ` ` ` <nl> ` ` ` bash <nl> - yarn add @ craco / craco craco - less semantic - ui - less - - dev <nl> + yarn add @ craco / craco @ semantic - ui - react / craco - less semantic - ui - less - - dev <nl> ` ` ` <nl> And then update your ` package . json ` and create ` craco . config . js ` : <nl> @ @ - 104 , 39 + 104 , 8 @ @ And then update your ` package . json ` and create ` craco . config . js ` : <nl> ` ` ` <nl> ` ` ` jsx label = craco . config . js <nl> - const { getLoader , loaderByName , throwUnexpectedConfigError } = require ( ' @ craco / craco ' ) <nl> - <nl> module . exports = { <nl> - webpack : { <nl> - alias : { <nl> - ' . . / . . / theme . config $ ' : require ( ' path ' ) . join ( __dirname , ' / src / semantic - ui / theme . config ' ) , <nl> - } , <nl> - } , <nl> - plugins : [ <nl> - { plugin : require ( ' craco - less ' ) } , <nl> - { <nl> - plugin : { <nl> - overrideWebpackConfig : ( { context , webpackConfig } ) = > { <nl> - const { isFound , match : fileLoaderMatch } = getLoader ( <nl> - webpackConfig , <nl> - loaderByName ( ' file - loader ' ) , <nl> - ) <nl> - <nl> - if ( ! isFound ) { <nl> - throwUnexpectedConfigError ( { <nl> - message : ` Can ' t find file - loader in the $ { context . env } webpack config ! ` , <nl> - } ) <nl> - } <nl> - <nl> - fileLoaderMatch . loader . exclude . push ( / theme . config $ / ) <nl> - fileLoaderMatch . loader . exclude . push ( / \ . variables $ / ) <nl> - fileLoaderMatch . loader . exclude . push ( / \ . overrides $ / ) <nl> - <nl> - return webpackConfig <nl> - } , <nl> - } , <nl> - } , <nl> - ] , <nl> + plugins : [ { plugin : require ( ' @ semantic - ui - react / craco - less ' ) } ] , <nl> } <nl> ` ` ` <nl> 
mmm a / docs / src / examples / collections / Menu / Content / MenuExampleHeaderVertical . js <nl> ppp b / docs / src / examples / collections / Menu / Content / MenuExampleHeaderVertical . js <nl> export default class MenuExampleHeaderVertical extends Component { <nl> state = { } <nl> - handleItemClick = ( name ) = > this . setState ( { activeItem : name } ) <nl> + handleItemClick = ( e , { name } ) = > this . setState ( { activeItem : name } ) ; <nl> render ( ) { <nl> const { activeItem } = this . state <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> yarn <nl> ` ` ` <nl> - > Note , we use ` yarn ` because ` npm ` has unfortunately become unreliable . Get it [ here ] [ 16 ] . <nl> + > Note : we use ` yarn ` and advise you do too while contributing . Get it [ here ] ( https : / / yarnpkg . com / ) . You can use ` npm install / npm ci ` but we don ' t include a ` package - lock . json ` in the repository , so you may end up with slightly out of sync dependencies . <nl> Add our repo as a git remote so you can pull / rebase your fork with our latest updates : <nl> 
mmm a / docs / src / examples / behaviors / Visibility / Settings / VisibilityExampleUpdateOn . js <nl> ppp b / docs / src / examples / behaviors / Visibility / Settings / VisibilityExampleUpdateOn . js <nl> < Segment > <nl> < Checkbox <nl> checked = { showWireframe } <nl> - label = ' Show Wifeframe ' <nl> + label = ' Show Wireframe ' <nl> onChange = { this . handleWireframe } <nl> toggle <nl> / > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < details > <nl> < summary > < b > Can I use custom Icons ? < / b > < / summary > <nl> - Yes . Just use < code > & lt ; Icon className = ' my - icon ' / & gt ; < / code > instead of ` & lt ; Icon name = ' my - icon ' / & gt ; ` . See https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 931 # issuecomment - 263643210 for detailed info and examples . <nl> + Yes . Just use < code > & lt ; Icon className = ' my - icon ' / & gt ; < / code > instead of < code > & lt ; Icon name = ' my - icon ' / & gt ; < / code > . See https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 931 # issuecomment - 263643210 for detailed info and examples . <nl> < / details > <nl> < details > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < / p > <nl> - > Hey , we ' re in development . Prior to reaching [ v1 . 0 . 0 ] [ 6 ] : <nl> - > <nl> - > 1 . * * MINOR * * versions represent * * breaking changes * * <nl> - > 1 . * * PATCH * * versions represent * * fixes _and_ features * * <nl> - > 1 . There are * * no deprecation warnings * * between releases <nl> - > 1 . You should consult the [ * * CHANGELOG * * ] [ 18 ] and related issues / PRs for more information <nl> - <nl> # # Installation & Usage <nl> See the [ * * Documentation * * ] [ 2 ] for an introduction , usage information , and examples . <nl> 
mmm a / docs / src / examples / elements / Label / Types / LabelExampleImageColored . js <nl> ppp b / docs / src / examples / elements / Label / Types / LabelExampleImageColored . js <nl> < / Label > <nl> < Label as = ' a ' color = ' teal ' image > <nl> < img src = ' / images / avatar / small / jenny . jpg ' / > <nl> - Veronika <nl> + Jenny <nl> < Label . Detail > Friend < / Label . Detail > <nl> < / Label > <nl> < Label as = ' a ' color = ' yellow ' image > <nl> < img src = ' / images / avatar / small / christian . jpg ' / > <nl> - Helen <nl> + Christian <nl> < Label . Detail > Co - worker < / Label . Detail > <nl> < / Label > <nl> < / div > <nl> 
mmm a / docs / src / examples / collections / Table / Variations / TableExampleSortable . js <nl> ppp b / docs / src / examples / collections / Table / Variations / TableExampleSortable . js <nl> - import React , { Component } from ' react ' <nl> + import React from ' react ' <nl> import { Table } from ' semantic - ui - react ' <nl> const tableData = [ <nl> @ @ - 9 , 34 + 9 , 35 @ @ const tableData = [ <nl> { name : ' Ben ' , age : 70 , gender : ' Male ' } , <nl> ] <nl> - export default class TableExampleSortable extends Component { <nl> - state = { <nl> - column : null , <nl> - data : tableData , <nl> - direction : null , <nl> + function exampleReducer ( state , action ) { <nl> + switch ( action . type ) { <nl> + case ' CHANGE_SORT ' : <nl> + if ( state . column = = = action . column ) { <nl> + return { <nl> + . . . state , <nl> + data : state . data . reverse ( ) , <nl> + direction : <nl> + state . direction = = = ' ascending ' ? ' descending ' : ' ascending ' , <nl> + } <nl> } <nl> - handleSort = ( clickedColumn ) = > ( ) = > { <nl> - const { column , data , direction } = this . state <nl> - <nl> - if ( column ! = = clickedColumn ) { <nl> - this . setState ( { <nl> - column : clickedColumn , <nl> - data : _ . sortBy ( data , [ clickedColumn ] ) , <nl> + return { <nl> + column : action . column , <nl> + data : _ . sortBy ( state . data , [ action . column ] ) , <nl> direction : ' ascending ' , <nl> - } ) <nl> - <nl> - return <nl> } <nl> - <nl> - this . setState ( { <nl> - data : data . reverse ( ) , <nl> - direction : direction = = = ' ascending ' ? ' descending ' : ' ascending ' , <nl> - } ) <nl> + default : <nl> + throw new Error ( ) <nl> + } <nl> } <nl> - render ( ) { <nl> - const { column , data , direction } = this . state <nl> + function TableExampleSortable ( ) { <nl> + const [ state , dispatch ] = React . useReducer ( exampleReducer , { <nl> + column : null , <nl> + data : tableData , <nl> + direction : null , <nl> + } ) <nl> + const { column , data , direction } = state <nl> return ( <nl> < Table sortable celled fixed > <nl> @ @ - 44 , 26 + 45 , 26 @ @ export default class TableExampleSortable extends Component { <nl> < Table . Row > <nl> < Table . HeaderCell <nl> sorted = { column = = = ' name ' ? direction : null } <nl> - onClick = { this . handleSort ( ' name ' ) } <nl> + onClick = { ( ) = > dispatch ( { type : ' CHANGE_SORT ' , column : ' name ' } ) } <nl> > <nl> Name <nl> < / Table . HeaderCell > <nl> < Table . HeaderCell <nl> sorted = { column = = = ' age ' ? direction : null } <nl> - onClick = { this . handleSort ( ' age ' ) } <nl> + onClick = { ( ) = > dispatch ( { type : ' CHANGE_SORT ' , column : ' age ' } ) } <nl> > <nl> Age <nl> < / Table . HeaderCell > <nl> < Table . HeaderCell <nl> sorted = { column = = = ' gender ' ? direction : null } <nl> - onClick = { this . handleSort ( ' gender ' ) } <nl> + onClick = { ( ) = > dispatch ( { type : ' CHANGE_SORT ' , column : ' gender ' } ) } <nl> > <nl> Gender <nl> < / Table . HeaderCell > <nl> < / Table . Row > <nl> < / Table . Header > <nl> < Table . Body > <nl> - { _ . map ( data , ( { age , gender , name } ) = > ( <nl> + { data . map ( ( { age , gender , name } ) = > ( <nl> < Table . Row key = { name } > <nl> < Table . Cell > { name } < / Table . Cell > <nl> < Table . Cell > { age } < / Table . Cell > <nl> @ @ - 74 , 4 + 75 , 5 @ @ export default class TableExampleSortable extends Component { <nl> < / Table > <nl> ) <nl> } <nl> - } <nl> + <nl> + export default TableExampleSortable <nl> 
mmm a / src / modules / Tab / Tab . js <nl> ppp b / src / modules / Tab / Tab . js <nl> / * * Align vertical menu * / <nl> menuPosition : PropTypes . oneOf ( [ ' left ' , ' right ' ] ) , <nl> - / * * Shorthand props for the Grid . * / <nl> + / * * Shorthand props for the Grid . Only applicable to vertical menus . * / <nl> grid : PropTypes . object , <nl> / * * <nl> 
mmm a / docs / src / examples / modules / Search / Types / SearchExampleStandardCustom . js <nl> ppp b / docs / src / examples / modules / Search / Types / SearchExampleStandardCustom . js <nl> import _ from ' lodash ' <nl> import faker from ' faker ' <nl> - import React , { Component } from ' react ' <nl> + import React from ' react ' <nl> import { Search , Grid , Header , Segment , Label } from ' semantic - ui - react ' <nl> const source = _ . times ( 5 , ( ) = > ( { <nl> @ @ - 11 , 58 + 10 , 80 @ @ const source = _ . times ( 5 , ( ) = > ( { <nl> price : faker . finance . amount ( 0 , 100 , 2 , ' $ ' ) , <nl> } ) ) <nl> - const resultRenderer = ( { title } ) = > < Label content = { title } / > <nl> - <nl> - resultRenderer . propTypes = { <nl> - title : PropTypes . string , <nl> - description : PropTypes . string , <nl> + const initialState = { <nl> + loading : false , <nl> + results : [ ] , <nl> + value : ' ' , <nl> } <nl> - const initialState = { isLoading : false , results : [ ] , value : ' ' } <nl> + function exampleReducer ( state , action ) { <nl> + switch ( action . type ) { <nl> + case ' CLEAN_QUERY ' : <nl> + return initialState <nl> + case ' START_SEARCH ' : <nl> + return { . . . state , loading : true , value : action . query } <nl> + case ' FINISH_SEARCH ' : <nl> + return { . . . state , loading : false , results : action . results } <nl> + case ' UPDATE_SELECTION ' : <nl> + return { . . . state , value : action . selection } <nl> - export default class SearchExampleStandard extends Component { <nl> - state = initialState <nl> + default : <nl> + throw new Error ( ) <nl> + } <nl> + } <nl> - handleResultSelect = ( e , { result } ) = > this . setState ( { value : result . title } ) <nl> + const resultRenderer = ( { title } ) = > < Label content = { title } / > <nl> + <nl> + function SearchExampleStandardCustom ( ) { <nl> + const [ state , dispatch ] = React . useReducer ( exampleReducer , initialState ) <nl> + const { loading , results , value } = state <nl> - handleSearchChange = ( e , { value } ) = > { <nl> - this . setState ( { isLoading : true , value } ) <nl> + const timeoutRef = React . useRef ( ) <nl> + const handleSearchChange = React . useCallback ( ( e , data ) = > { <nl> + clearTimeout ( timeoutRef . current ) <nl> + dispatch ( { type : ' START_SEARCH ' , query : data . value } ) <nl> - setTimeout ( ( ) = > { <nl> - if ( this . state . value . length < 1 ) return this . setState ( initialState ) <nl> + timeoutRef . current = setTimeout ( ( ) = > { <nl> + if ( data . value . length = = = 0 ) { <nl> + dispatch ( { type : ' CLEAN_QUERY ' } ) <nl> + return <nl> + } <nl> - const re = new RegExp ( _ . escapeRegExp ( this . state . value ) , ' i ' ) <nl> + const re = new RegExp ( _ . escapeRegExp ( data . value ) , ' i ' ) <nl> const isMatch = ( result ) = > re . test ( result . title ) <nl> - this . setState ( { <nl> - isLoading : false , <nl> + dispatch ( { <nl> + type : ' FINISH_SEARCH ' , <nl> results : _ . filter ( source , isMatch ) , <nl> } ) <nl> } , 300 ) <nl> + } , [ ] ) <nl> + React . useEffect ( ( ) = > { <nl> + return ( ) = > { <nl> + clearTimeout ( timeoutRef . current ) <nl> } <nl> - <nl> - render ( ) { <nl> - const { isLoading , value , results } = this . state <nl> + } , [ ] ) <nl> return ( <nl> < Grid > <nl> < Grid . Column width = { 6 } > <nl> < Search <nl> - loading = { isLoading } <nl> - onResultSelect = { this . handleResultSelect } <nl> - onSearchChange = { _ . debounce ( this . handleSearchChange , 500 , { <nl> - leading : true , <nl> - } ) } <nl> + loading = { loading } <nl> + onResultSelect = { ( e , data ) = > <nl> + dispatch ( { type : ' UPDATE_SELECTION ' , selection : data . result . title } ) <nl> + } <nl> + onSearchChange = { handleSearchChange } <nl> + resultRenderer = { resultRenderer } <nl> results = { results } <nl> value = { value } <nl> - resultRenderer = { resultRenderer } <nl> / > <nl> < / Grid . Column > <nl> + <nl> < Grid . Column width = { 10 } > <nl> < Segment > <nl> < Header > State < / Header > <nl> < pre style = { { overflowX : ' auto ' } } > <nl> - { JSON . stringify ( this . state , null , 2 ) } <nl> + { JSON . stringify ( { loading , results , value } , null , 2 ) } <nl> < / pre > <nl> < Header > Options < / Header > <nl> < pre style = { { overflowX : ' auto ' } } > <nl> @ @ - 73 , 4 + 94 , 5 @ @ export default class SearchExampleStandard extends Component { <nl> < / Grid > <nl> ) <nl> } <nl> - } <nl> + <nl> + export default SearchExampleStandardCustom <nl> 
mmm a / docs / src / examples / modules / Search / Types / SearchExampleStandard . js <nl> ppp b / docs / src / examples / modules / Search / Types / SearchExampleStandard . js <nl> import faker from ' faker ' <nl> - import React , { Component } from ' react ' <nl> + import React from ' react ' <nl> import { Search , Grid , Header , Segment } from ' semantic - ui - react ' <nl> - const initialState = { isLoading : false , results : [ ] , value : ' ' } <nl> - <nl> const source = _ . times ( 5 , ( ) = > ( { <nl> title : faker . company . companyName ( ) , <nl> description : faker . company . catchPhrase ( ) , <nl> @ @ - 12 , 48 + 10 , 77 @ @ const source = _ . times ( 5 , ( ) = > ( { <nl> price : faker . finance . amount ( 0 , 100 , 2 , ' $ ' ) , <nl> } ) ) <nl> - export default class SearchExampleStandard extends Component { <nl> - state = initialState <nl> + const initialState = { <nl> + loading : false , <nl> + results : [ ] , <nl> + value : ' ' , <nl> + } <nl> + <nl> + function exampleReducer ( state , action ) { <nl> + switch ( action . type ) { <nl> + case ' CLEAN_QUERY ' : <nl> + return initialState <nl> + case ' START_SEARCH ' : <nl> + return { . . . state , loading : true , value : action . query } <nl> + case ' FINISH_SEARCH ' : <nl> + return { . . . state , loading : false , results : action . results } <nl> + case ' UPDATE_SELECTION ' : <nl> + return { . . . state , value : action . selection } <nl> + <nl> + default : <nl> + throw new Error ( ) <nl> + } <nl> + } <nl> - handleResultSelect = ( e , { result } ) = > this . setState ( { value : result . title } ) <nl> + function SearchExampleStandard ( ) { <nl> + const [ state , dispatch ] = React . useReducer ( exampleReducer , initialState ) <nl> + const { loading , results , value } = state <nl> - handleSearchChange = ( e , { value } ) = > { <nl> - this . setState ( { isLoading : true , value } ) <nl> + const timeoutRef = React . useRef ( ) <nl> + const handleSearchChange = React . useCallback ( ( e , data ) = > { <nl> + clearTimeout ( timeoutRef . current ) <nl> + dispatch ( { type : ' START_SEARCH ' , query : data . value } ) <nl> - setTimeout ( ( ) = > { <nl> - if ( this . state . value . length < 1 ) return this . setState ( initialState ) <nl> + timeoutRef . current = setTimeout ( ( ) = > { <nl> + if ( data . value . length = = = 0 ) { <nl> + dispatch ( { type : ' CLEAN_QUERY ' } ) <nl> + return <nl> + } <nl> - const re = new RegExp ( _ . escapeRegExp ( this . state . value ) , ' i ' ) <nl> + const re = new RegExp ( _ . escapeRegExp ( data . value ) , ' i ' ) <nl> const isMatch = ( result ) = > re . test ( result . title ) <nl> - this . setState ( { <nl> - isLoading : false , <nl> + dispatch ( { <nl> + type : ' FINISH_SEARCH ' , <nl> results : _ . filter ( source , isMatch ) , <nl> } ) <nl> } , 300 ) <nl> + } , [ ] ) <nl> + React . useEffect ( ( ) = > { <nl> + return ( ) = > { <nl> + clearTimeout ( timeoutRef . current ) <nl> } <nl> - <nl> - render ( ) { <nl> - const { isLoading , value , results } = this . state <nl> + } , [ ] ) <nl> return ( <nl> < Grid > <nl> < Grid . Column width = { 6 } > <nl> < Search <nl> - loading = { isLoading } <nl> - onResultSelect = { this . handleResultSelect } <nl> - onSearchChange = { _ . debounce ( this . handleSearchChange , 500 , { <nl> - leading : true , <nl> - } ) } <nl> + loading = { loading } <nl> + onResultSelect = { ( e , data ) = > <nl> + dispatch ( { type : ' UPDATE_SELECTION ' , selection : data . result . title } ) <nl> + } <nl> + onSearchChange = { handleSearchChange } <nl> results = { results } <nl> value = { value } <nl> / > <nl> < / Grid . Column > <nl> + <nl> < Grid . Column width = { 10 } > <nl> < Segment > <nl> < Header > State < / Header > <nl> < pre style = { { overflowX : ' auto ' } } > <nl> - { JSON . stringify ( this . state , null , 2 ) } <nl> + { JSON . stringify ( { loading , results , value } , null , 2 ) } <nl> < / pre > <nl> < Header > Options < / Header > <nl> < pre style = { { overflowX : ' auto ' } } > <nl> @ @ - 64 , 4 + 91 , 5 @ @ export default class SearchExampleStandard extends Component { <nl> < / Grid > <nl> ) <nl> } <nl> - } <nl> + <nl> + export default SearchExampleStandard <nl> 
mmm a / src / elements / Placeholder / Placeholder . js <nl> ppp b / src / elements / Placeholder / Placeholder . js <nl> import PlaceholderParagraph from ' . / PlaceholderParagraph ' <nl> / * * <nl> - * A placeholder is used to reserve splace for content that soon will appear in a layout . <nl> + * A placeholder is used to reserve space for content that soon will appear in a layout . <nl> * / <nl> function Placeholder ( props ) { <nl> const { children , className , content , fluid , inverted } = props <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> - [ Common Tests ] ( # common - tests ) <nl> - [ Usage ] ( # usage ) <nl> - [ isConformant ( required ) ] ( # isconformant - required ) <nl> + - [ Visual testing ] ( # visual - testing ) <nl> - [ State ] ( # state ) <nl> - [ AutoControlledComponent ] ( # autocontrolledcomponent ) <nl> - [ Documentation ] ( # documentation ) <nl> 
mmm a / docs / src / examples / collections / Table / Variations / TableExampleSortable . js <nl> ppp b / docs / src / examples / collections / Table / Variations / TableExampleSortable . js <nl> if ( state . column = = = action . column ) { <nl> return { <nl> . . . state , <nl> - data : state . data . reverse ( ) , <nl> + data : state . data . slice ( ) . reverse ( ) , <nl> direction : <nl> state . direction = = = ' ascending ' ? ' descending ' : ' ascending ' , <nl> } <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> + # # v2 . 0 . 2 ( 2021 - 01 - 13 ) <nl> + <nl> + # # # # : bug : Bug Fix <nl> + * [ # 4116 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / pull / 4116 ) fix ( Image ) : pass ` loading ` attribute to an ` img ` element ( [ @ noinkling ] ( https : / / github . com / noinkling ) ) <nl> + <nl> + # # # # : memo : Documentation <nl> + * [ # 4097 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / pull / 4097 ) docs ( Table ) : fix sort issue in TableExampleSortable ( [ @ Mental1993 ] ( https : / / github . com / Mental1993 ) ) <nl> + <nl> + # # # # : house : Internal <nl> + * [ # 4138 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / pull / 4138 ) chore : bump dependencies to allow React 17 in peerDependencies ( [ @ layershifter ] ( https : / / github . com / layershifter ) ) <nl> + * [ # 4031 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / pull / 4031 ) chore : support React 17 ( [ @ layershifter ] ( https : / / github . com / layershifter ) ) <nl> + <nl> + # # # # Committers : 3 <nl> + - Malcolm ( [ @ noinkling ] ( https : / / github . com / noinkling ) ) <nl> + - Oleksandr Fediashov ( [ @ layershifter ] ( https : / / github . com / layershifter ) ) <nl> + - Pechlivanis Dimitrios ( [ @ Mental1993 ] ( https : / / github . com / Mental1993 ) ) <nl> + <nl> # # [ v2 . 0 . 1 ] ( https : / / github . com / Semantic - Org / Semantic - UI - React / tree / v2 . 0 . 1 ) ( 2020 - 10 - 26 ) <nl> # # # # : bug : Bug Fix <nl> 
mmm a / docs / src / pages / Introduction . js <nl> ppp b / docs / src / pages / Introduction . js <nl> < / p > <nl> < p > <nl> Take a look at our <nl> - < a href = { ` $ { repoURL } / blob / master / src / lib / AutoControlledComponent . js ` } > <nl> + < a href = { ` $ { repoURL } / blob / master / src / lib / ModernAutoControlledComponent . js ` } > <nl> & nbsp ; <nl> - < code > AutoControlledComponent < / code > <nl> + < code > ModernAutoControlledComponent < / code > <nl> & nbsp ; <nl> < / a > <nl> to see how this was done . See the docs try it out live . <nl> 
mmm a / docs / src / examples / collections / Menu / Variations / MenuExampleStackable . js <nl> ppp b / docs / src / examples / collections / Menu / Variations / MenuExampleStackable . js <nl> return ( <nl> < Menu stackable > <nl> < Menu . Item > <nl> - < img src = ' / logo . png ' / > <nl> + < img alt = " logo " src = ' / logo . png ' / > <nl> < / Menu . Item > <nl> < Menu . Item <nl> 
mmm a / docs / src / examples / addons / TextArea / Usage / index . js <nl> ppp b / docs / src / examples / addons / TextArea / Usage / index . js <nl> < Segment > <nl> < Message warning > <nl> < Message . Header > Auto height < / Message . Header > <nl> - We don ' t support ` autoHeight ` more . If you need this feature you can use { ' ' } <nl> + We don ' t support ` autoHeight ` anymore . If you need this feature you can use { ' ' } <nl> < a <nl> href = ' https : / / www . npmjs . com / package / react - textarea - autosize ' <nl> rel = ' noopener noreferrer ' <nl> 
mmm a / src / addons / Confirm / Confirm . js <nl> ppp b / src / addons / Confirm / Confirm . js <nl> import Modal from ' . . / . . / modules / Modal ' <nl> / * * <nl> - * A Confirm modal gives the user a choice to confirm or cancel an action / <nl> + * A Confirm modal gives the user a choice to confirm or cancel an action . <nl> * @ see Modal <nl> * / <nl> class Confirm extends Component { <nl> 
mmm a / . github / CONTRIBUTING . md <nl> ppp b / . github / CONTRIBUTING . md <nl> } ) <nl> ` ` ` <nl> - The last argument to a common test is always ` options ` . You can configure the test here . Example , if your component requires certain props to render , you can pass in ` requiredProps ` : <nl> + The last argument to a common test is always ` options ` . You can configure the test here . For example , if your component requires certain props to render , you can pass in ` requiredProps ` : <nl> ` ` ` js <nl> import * as common from ' test / specs / commonTests ' <nl> @ @ - 419 , 7 + 419 , 7 @ @ This is the only required test . It ensures a consistent baseline for the framew <nl> # # # Visual testing <nl> - We are using [ Percy ] ( https : / / percy . io / ) and Cypress to perform visual testing of our components . To create a new visual <nl> + We are using [ Percy ] ( https : / / percy . io / ) and [ Cypress ] ( https : / / www . cypress . io / ) to perform visual testing of our components . To create a new visual <nl> test there should an example in our docs that can be served by Cypress and a corresponding Cypress test , for example : <nl> - ` cypress / integration / Popup / Popup . visual . js ` contains visual tests <nl> - ` docs / src / examples / modules / Popup / Visual / PopupVisualInsideModal . js ` contains an example that will be used for visual <nl> @ @ - 437 , 7 + 437 , 7 @ @ function MyComponent ( props ) { <nl> } <nl> ` ` ` <nl> - If you ' re component requires event handlers , it is a stateful class component . Want to know [ why ] [ 15 ] ? <nl> + If your component requires event handlers , it is a stateful class component . Want to know [ why ] [ 15 ] ? <nl> ` ` ` js <nl> class MyComponent extends Component { <nl> @ @ - 464 , 7 + 464 , 7 @ @ TODO <nl> - [ Props ] ( # props ) <nl> - [ Examples ] ( # examples ) <nl> - Our docs are generated from docblock comments , ` propTypes ` , and hand written examples . <nl> + Our docs are generated from docblock comments , ` propTypes ` , and hand - written examples . <nl> # # # Website <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Specify whether or not to force the unicode disable option . When supplied , all symbols in the output will be replaced <nl> by their plain text equivalents . <nl> + - ` - - global - var < key > = < value > ` < br / > <nl> + Allows the specification of global variables via the command line , in a key = value format . Multiple CLI global variables <nl> + can be added by using ` - - global - var ` multiple times , like so : ` - - global - var foo = bar - - global - var alpha = beta ` . <nl> + <nl> # # # # Configuring Reporters <nl> Reporters provide information about the current collection run in a format that is easy to both : disseminate and assimilate . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Specify whether or not to force the unicode disable option . When supplied , all symbols in the output will be replaced <nl> by their plain text equivalents . <nl> - - ` - - global - var < key > = < value > ` < br / > <nl> + - ` - - global - var " < global - variable - name > = < global - variable - value > " ` < br / > <nl> Allows the specification of global variables via the command line , in a key = value format . Multiple CLI global variables <nl> - can be added by using ` - - global - var ` multiple times , like so : ` - - global - var foo = bar - - global - var alpha = beta ` . <nl> + can be added by using ` - - global - var ` multiple times , like so : ` - - global - var " foo = bar " - - global - var " alpha = beta " ` . <nl> # # # # Configuring Reporters <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - ` - - timeout - request < ms > ` < br / > <nl> Specify the time ( in milliseconds ) to wait for requests to return a response . <nl> + - ` - - timeout - script < ms > ` < br / > <nl> + Specify the time ( in milliseconds ) to wait for scripts to complete execution . <nl> + <nl> - ` - k ` , ` - - insecure ` < br / > <nl> Disables SSL verification checks and allows self - signed SSL certificates . <nl> @ @ - 304 , 6 + 307 , 7 @ @ return of the ` newman . run ` function is a run instance , which emits run events th <nl> | options . iterationData | Path to the JSON or CSV file or URL to be used as data source when running multiple iterations on a collection . < br / > < br / > _Optional_ < br / > Type : ` string ` | <nl> | options . folder | The name or ID of the folder ( ItemGroup ) in the collection which would be run instead of the entire collection . < br / > < br / > _Optional_ < br / > Type : ` string ` | <nl> | options . timeoutRequest | Specify the time ( in milliseconds ) to wait for requests to return a response . < br / > < br / > _Optional_ < br / > Type : ` number ` , Default value : ` Infinity ` | <nl> + | options . timeoutScript | Specify the time ( in milliseconds ) to wait for scripts to return a response . < br / > < br / > _Optional_ < br / > Type : ` number ` | <nl> | options . delayRequest | Specify the time ( in milliseconds ) to wait for between subsequent requests . < br / > < br / > _Optional_ < br / > Type : ` number ` , Default value : ` 0 ` | <nl> | options . ignoreRedirects | This specifies whether newman would automatically follow 3xx responses from servers . < br / > < br / > _Optional_ < br / > Type : ` boolean ` , Default value : ` false ` | <nl> | options . insecure | Disables SSL verification checks and allows self - signed SSL certificates . < br / > < br / > _Optional_ < br / > Type : ` boolean ` , Default value : ` false ` | <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> | options | This is a required argument and it contains all information pertaining to running a collection . < br / > < br / > _Required_ < br / > Type : ` object ` | <nl> | options . collection | The collection is a required property of the ` options ` argument . It accepts an object representation of a Postman Collection which should resemble the schema mentioned at [ https : / / schema . getpostman . com / ] ( https : / / schema . getpostman . com / ) . The value of this property could also be an instance of Collection Object from the [ Postman Collection SDK ] ( https : / / github . com / postmanlabs / postman - collection ) . < br / > < br / > As ` string ` , one can provide a URL where the Collection JSON can be found ( e . g . [ Postman Cloud API ] ( https : / / api . getpostman . com / ) service ) or path to a local JSON file . < br / > < br / > _Required_ < br / > Type : ` object \ | string ` [ PostmanCollection ] ( https : / / github . com / postmanlabs / postman - collection / wiki # Collection ) | <nl> | options . environment | One can optionally pass an environment file path or URL as ` string ` to this property and that will be used to read Postman Environment Variables from . This property also accepts environment variables as an ` object ` . Environment files exported from Postman App can be directly used here . < br / > < br / > _Optional_ < br / > Type : ` object \ | string ` | <nl> + | options . envVar | One can optionally pass environment variables as an array of key - value string object pairs . It will be used to read Postman Environment Variables as well as overwrite environment variables from ` options . environments ` . < br / > < br / > _Optional_ < br / > Type : ` array \ | object ` | <nl> | options . globals | Postman Global Variables can be optionally passed on to a collection run in form of path to a file or URL . It also accepts variables as an ` object ` . < br / > < br / > _Optional_ < br / > Type : ` object \ | string ` | <nl> + | options . globalVar | One can optionally pass global environment variables as an array of key - value string object pairs . It will be used to read Postman Global Environment Variables as well as overwrite global environment variables from ` options . globals ` . < br / > < br / > _Optional_ < br / > Type : ` array \ | object ` | <nl> | options . iterationCount | Specify the number of iterations to run on the collection . This is usually accompanied by providing a data file reference as ` options . iterationData ` . < br / > < br / > _Optional_ < br / > Type : ` number ` , Default value : ` 1 ` | <nl> | options . iterationData | Path to the JSON or CSV file or URL to be used as data source when running multiple iterations on a collection . < br / > < br / > _Optional_ < br / > Type : ` string ` | <nl> | options . folder | The name or ID of the folder / folders ( ItemGroup ) in the collection which would be run instead of the entire collection . < br / > < br / > _Optional_ < br / > Type : ` string \ | array ` | <nl> @ @ - 338 , 6 + 340 , 10 @ @ newman . run ( { <nl> " _postman_exported_at " : " 2016 - 10 - 17T14 : 31 : 26 . 200Z " , <nl> " _postman_exported_using " : " Postman / 4 . 8 . 0 " <nl> } , <nl> + globalVar : [ <nl> + { " key " : " glboalSecret " , " value " : " globalSecretValue " } , <nl> + { " key " : " globalAnotherSecret " , " value " : ` $ { process . env . GLOBAL_ANOTHER_SECRET } ` } <nl> + ] , <nl> environment : { <nl> " id " : " 4454509f - 00c3 - fd32 - d56c - ac1537f31415 " , <nl> " name " : " test - env " , <nl> @ @ - 353 , 7 + 359 , 11 @ @ newman . run ( { <nl> " _postman_variable_scope " : " environment " , <nl> " _postman_exported_at " : " 2016 - 10 - 17T14 : 26 : 34 . 940Z " , <nl> " _postman_exported_using " : " Postman / 4 . 8 . 0 " <nl> - } <nl> + } , <nl> + envVar : [ <nl> + { " key " : " secret " , " value " : " secretValue " } , <nl> + { " key " : " anotherSecret " , " value " : ` $ { process . env . ANOTHER_SECRET } ` } <nl> + ] , <nl> } ) . on ( ' start ' , function ( err , args ) { / / on start of run , log to console <nl> console . log ( ' running a collection . . . ' ) ; <nl> } ) . on ( ' done ' , function ( err , summary ) { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> precedence and can be overridden by environment variables having the same name . <nl> - ` - d < source > ` , ` - - iteration - data < source > ` < br / > <nl> - Specify a data source file ( CSV ) to be used for iteration as a path to a file or as a URL . <nl> + Specify a data source file ( JSON or CSV ) to be used for iteration as a path to a file or as a URL . <nl> [ Read More ] ( https : / / learning . postman . com / docs / postman / collection - runs / working - with - data - files / ) <nl> - ` - n < number > ` , ` - - iteration - count < number > ` < br / > <nl> 
mmm a / README - dev . md <nl> ppp b / README - dev . md <nl> 1 . Start with Ubuntu 18 or run it in a [ virtual machine ] ( https : / / www . osboxes . org / ubuntu / ) <nl> 2 . Set github repos to pull and push over ssh : ` git config - - global url . ssh : / / git @ github . com / . insteadOf https : / / github . com / ` <nl> - To push branches to repos in the MinaProtocol or o1 - labs organisations , you must complete this step . These repositories do not accept the password authentication used by the https URLs . <nl> - 3 . Pull in our submodules : ` git submodule update - - init ` <nl> + 3 . Pull in our submodules : ` git submodule update - - init - - recursive ` <nl> - This might fail with ` git @ github . com : Permission denied ( publickey ) . ` . If that happens it means <nl> you need to [ set up SSH keys on your machine ] ( https : / / help . github . com / en / articles / generating - a - new - ssh - key - and - adding - it - to - the - ssh - agent ) . <nl> 4 . Run ` git config - - local - - add submodule . recurse true ` <nl> 
mmm a / docs / jss - syntax . md <nl> ppp b / docs / jss - syntax . md <nl> } <nl> ` ` ` <nl> + # # Basic at rules <nl> + <nl> + ` ` ` javascript <nl> + const styles = { <nl> + ' @ charset ' : ' " utf - 8 " ' , <nl> + ' @ import ' : ' url ( http : / / mysite . com / custom . css ) ' , <nl> + ' @ namespace ' : ' url ( http : / / mysite . com / xhtml ) ' <nl> + } <nl> + ` ` ` <nl> + <nl> + Compiles to : <nl> + <nl> + ` ` ` css <nl> + @ charset " utf - 8 " ; <nl> + @ import url ( http : / / mysite . com / custom . css ) ; <nl> + @ namespace url ( http : / / mysite . com / xhtml ) ; <nl> + ` ` ` <nl> + <nl> # # Alternative syntax for space and comma separated values <nl> To describe space or comma separated CSS values in a JavaScript way , we introduced an array based syntax . <nl> 
mmm a / docs / csp . md <nl> ppp b / docs / csp . md <nl> use : [ <nl> { <nl> loader : ' style - loader ' , <nl> - options : { attrs : { nonce : ' { { styleNonce } } ' } } <nl> + options : { attributes : { nonce : ' { { styleNonce } } ' } } <nl> } , <nl> ' css - loader ' <nl> ] <nl> @ @ - 109 , 7 + 109 , 7 @ @ const config = { <nl> use : [ <nl> { <nl> loader : ' style - loader ' , <nl> - options : { attrs : { nonce : ' { { styleNonce } } ' } } <nl> + options : { attributes : { nonce : ' { { styleNonce } } ' } } <nl> } , <nl> ' css - loader ' , <nl> ' sass - loader ' <nl> 
mmm a / docs / react - jss . md <nl> ppp b / docs / react - jss . md <nl> / / Will render styles first . <nl> const Label = ( { children } ) = > { <nl> const classes = useLabelStyles ( ) <nl> - return < label className = { classes . button } > { children } < / label > <nl> + return < label className = { classes . label } > { children } < / label > <nl> } <nl> const Button = ( ) = > { <nl> 
mmm a / packages / babel - preset - react - app / index . js <nl> ppp b / packages / babel - preset - react - app / index . js <nl> [ <nl> require . resolve ( ' babel - plugin - transform - regenerator ' ) , <nl> { <nl> - / / Async functions are converted to generators by babel - preset - latest <nl> + / / Async functions are converted to generators by babel - preset - env <nl> async : false , <nl> } , <nl> ] , <nl> 
mmm a / packages / react - scripts / template / README . md <nl> ppp b / packages / react - scripts / template / README . md <nl> expect ( wrapper ) . toContainReact ( welcome ) <nl> ` ` ` <nl> - To setup jest - enzyme with Create React App , follow the instructions for [ initializing your test environment ] ( # initializing - test - environment ) to import ` jest - enzyme ` . * * Note that currently only version 2 . x is compatible with Create React App . * * <nl> + To setup jest - enzyme with Create React App , follow the instructions for [ initializing your test environment ] ( # initializing - test - environment ) to import ` jest - enzyme ` . <nl> ` ` ` sh <nl> - npm install - - save - dev jest - enzyme @ 2 . x <nl> + npm install - - save - dev jest - enzyme <nl> ` ` ` <nl> ` ` ` js <nl> 
mmm a / packages / react - scripts / template / README . md <nl> ppp b / packages / react - scripts / template / README . md <nl> * [ Object Rest / Spread Properties ] ( https : / / github . com / tc39 / proposal - object - rest - spread ) ( ES2018 ) . <nl> * [ Dynamic import ( ) ] ( https : / / github . com / tc39 / proposal - dynamic - import ) ( stage 3 proposal ) <nl> * [ Class Fields and Static Properties ] ( https : / / github . com / tc39 / proposal - class - public - fields ) ( part of stage 3 proposal ) . <nl> - * [ JSX ] ( https : / / facebook . github . io / react / docs / introducing - jsx . html ) and [ Flow ] ( https : / / flowtype . org / ) syntax . <nl> + * [ JSX ] ( https : / / facebook . github . io / react / docs / introducing - jsx . html ) and [ Flow ] ( https : / / flow . org / ) syntax . <nl> Learn more about [ different proposal stages ] ( https : / / babeljs . io / docs / plugins / # presets - stage - x - experimental - presets - ) . <nl> @ @ - 886 , 20 + 886 , 20 @ @ Here is an example of adding a [ customized Bootstrap ] ( https : / / medium . com / @ tacoma <nl> Flow is a static type checker that helps you write code with fewer bugs . Check out this [ introduction to using static types in JavaScript ] ( https : / / medium . com / @ preethikasireddy / why - use - static - types - in - javascript - part - 1 - 8382da1e0adb ) if you are new to this concept . <nl> - Recent versions of [ Flow ] ( http : / / flowtype . org / ) work with Create React App projects out of the box . <nl> + Recent versions of [ Flow ] ( https : / / flow . org / ) work with Create React App projects out of the box . <nl> To add Flow to a Create React App project , follow these steps : <nl> 1 . Run ` npm install - - save flow - bin ` ( or ` yarn add flow - bin ` ) . <nl> 2 . Add ` " flow " : " flow " ` to the ` scripts ` section of your ` package . json ` . <nl> - 3 . Run ` npm run flow init ` ( or ` yarn flow init ` ) to create a [ ` . flowconfig ` file ] ( https : / / flowtype . org / docs / advanced - configuration . html ) in the root directory . <nl> + 3 . Run ` npm run flow init ` ( or ` yarn flow init ` ) to create a [ ` . flowconfig ` file ] ( https : / / flow . org / en / docs / config / ) in the root directory . <nl> 4 . Add ` / / @ flow ` to any files you want to type check ( for example , to ` src / App . js ` ) . <nl> Now you can run ` npm run flow ` ( or ` yarn flow ` ) to check the files for type errors . <nl> You can optionally use an IDE like [ Nuclide ] ( https : / / nuclide . io / docs / languages / flow / ) for a better integrated experience . <nl> In the future we plan to integrate it into Create React App even more closely . <nl> - To learn more about Flow , check out [ its documentation ] ( https : / / flowtype . org / ) . <nl> + To learn more about Flow , check out [ its documentation ] ( https : / / flow . org / ) . <nl> # # Adding a Router <nl> 
mmm a / docusaurus / docs / deployment . md <nl> ppp b / docusaurus / docs / deployment . md <nl> ` ` ` json <nl> { <nl> " scripts " : { <nl> - " build : staging " : " env - cmd . env . staging npm run build " <nl> + " build : staging " : " env - cmd - f . env . staging npm run build " <nl> } <nl> } <nl> ` ` ` <nl> 
mmm a / docusaurus / docs / adding - images - fonts - and - files . md <nl> ppp b / docusaurus / docs / adding - images - fonts - and - files . md <nl> ` ` ` <nl> This is handy if you don ' t want to load SVG as a separate file . Don ' t forget the curly braces in the import ! The ` ReactComponent ` import name is special and tells Create React App that you want a React component that renders an SVG , rather than its filename . <nl> + <nl> + > * * Tip : * * The imported SVG React Component accepts a ` title ` prop along with other props that a ` svg ` element accepts . Use this prop to add an accessbile title to your svg component . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> | [ ` @ putout / plugin - remove - unreachable - code ` ] ( / packages / plugin - remove - unreachable - code # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - unreachable - code . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - unreachable - code ) | <nl> | [ ` @ putout / plugin - remove - console ` ] ( / packages / plugin - remove - console # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - console . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - console ) | <nl> | [ ` @ putout / plugin - remove - empty ` ] ( / packages / plugin - remove - empty # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - empty . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - empty ) | <nl> - | [ ` @ putout / plugin - remove - empty - pattern ` ] ( / packages / plugin - remove - empty - pattern # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - empty - pattern . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - empty - pattern ) | <nl> | [ ` @ putout / plugin - remove - constant - conditions ` ] ( / packages / plugin - remove - constant - conditions # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - constant - conditions . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - constant - conditions ) | <nl> | [ ` @ putout / plugin - remove - boolean - from - assertions ` ] ( / packages / plugin - remove - boolean - from - assertions # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - boolean - from - assertions . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - boolean - from - assertions ) | <nl> | [ ` @ putout / plugin - remove - nested - blocks ` ] ( / packages / plugin - remove - nested - blocks # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / plugin - remove - nested - blocks . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / plugin - remove - nested - blocks ) | <nl> 
mmm a / packages / eslint / README . md <nl> ppp b / packages / eslint / README . md <nl> const { createPlugin } = require ( ' @ putout / eslint / create - plugin ' ) ; <nl> module . exports . rules = { <nl> - ' remove - duplicate - extensions ' : createPlugin ( ' remove - duplicate - extensions ' ) , <nl> + ' remove - duplicate - extensions ' : createPlugin ( require ( ' . / remove - duplicate - extensions ' ) ) , <nl> } ; <nl> ` ` ` <nl> 
mmm a / packages / eslint / README . md <nl> ppp b / packages / eslint / README . md <nl> } ; <nl> ` ` ` <nl> - # # # ` lint ( code , { fix , plugins } ) ` <nl> + # # # ` lint ( source , { fix , plugins } ) ` <nl> + <nl> + When you need to run * * ESLint * * with one plugin ( * rule * ) , just use ` lint ` it will do the thing . <nl> ` ` ` js <nl> const lint = require ( ' @ putout / eslint / lint ' ) ; <nl> 
mmm a / packages / eslint / README . md <nl> ppp b / packages / eslint / README . md <nl> ` ` ` js <nl> const lint = require ( ' @ putout / eslint / lint ' ) ; <nl> - const removeDebugger = require ( ' . / remove - debugger ' ) ; <nl> const [ code , places ] = lint ( ' debugger ' , { <nl> filename : ' index . js ' , <nl> 
mmm a / packages / eslint / README . md <nl> ppp b / packages / eslint / README . md <nl> ` ` ` js <nl> const lint = require ( ' @ putout / eslint / lint ' ) ; <nl> + const { createPlugin } = require ( ' @ putout / eslint / create - plugin ' ) ; <nl> const removeDebugger = require ( ' . / remove - debugger ' ) ; <nl> const [ code , places ] = lint ( ' debugger ' , { <nl> 
mmm a / docs / putout - script . md <nl> ppp b / docs / putout - script . md <nl> # # ` __args ` template value <nl> - The ` __args ` template value abstracts away a sequence of zero or more arguments . <nl> + The ` __args ` template value abstracts away a sequence of zero or more arguments , for ` ( __args ) = > __a ` : <nl> + <nl> + ` ` ` js <nl> + ( a , b , c ) = > a + b + c <nl> + ` ` ` <nl> + <nl> + ` __args ` can be linked . For example , the rule ` ( ( __args__a ) = > __c ( __args__a ) ) ( __args__b ) ` will find : <nl> + <nl> + ` ` ` js <nl> + ( ( a ) = > fn ( a ) ) ( value ) <nl> + ` ` ` <nl> + <nl> + But not : <nl> + <nl> + ` ` ` js <nl> + ( ( a ) = > fn ( 42 ) ) ( value ) <nl> + ` ` ` <nl> # # Function calls <nl> 
mmm a / docs / putout - script . md <nl> ppp b / docs / putout - script . md <nl> The double low dush template value ( ` __ ` ) abstracts away ` Identifiers ` , ` Expressions ` and ` Literals ` . <nl> + # # ` __a ` <nl> + <nl> + * * Linked template value * * ( ` __a ` ) abstracts away ` Identifiers ` , ` Expressions ` and ` Literals ` . <nl> + <nl> # # ` __args ` template value <nl> The ` __args ` template value abstracts away a sequence of zero or more arguments , for ` ( __args ) = > __a ` : <nl> @ @ - 40 , 7 + 44 , 9 @ @ The ` __args ` template value abstracts away a sequence of zero or more arguments , <nl> ( a , b , c ) = > a + b + c ; <nl> ` ` ` <nl> - ` __args ` can be linked . For example , the rule ` ( ( __args__a ) = > __c ( __args__a ) ) ( __args__b ) ` will find : <nl> + # # ` __args__a ` <nl> + <nl> + ` __args ` can be linked . * * Linked args * * can be used to link to values with the same ` Expressions ` , ` Identifiers ` or ` Literals ` ) : ` ( ( __args__a ) = > __c ( __args__a ) ) ( __args__b ) ` will find : <nl> ` ` ` js <nl> fn ( value ) ; <nl> 
mmm a / docs / putout - script . md <nl> ppp b / docs / putout - script . md <nl> } ; <nl> ` ` ` <nl> - # # ` __ ` template value <nl> + # # ` __ ` <nl> The double low dush template value ( ` __ ` ) abstracts away ` Identifiers ` , ` Expressions ` and ` Literals ` . <nl> # # ` __a ` <nl> - * * Linked template value * * ( ` __a ` ) abstracts away ` Identifiers ` , ` Expressions ` and ` Literals ` . <nl> + * * Linked Value * * ( ` __a ` ) abstracts away ` Identifiers ` , ` Expressions ` and ` Literals ` . <nl> - # # ` __args ` template value <nl> + # # ` __args ` <nl> - The ` __args ` template value abstracts away a sequence of zero or more arguments , for ` ( __args ) = > __a ` : <nl> + The ` __args ` value abstracts away a sequence of zero or more arguments , for ` ( __args ) = > __a ` : <nl> ` ` ` js <nl> ( a , b , c ) = > a + b + c ; <nl> 
mmm a / docs / the - book - of - ast . md <nl> ppp b / docs / the - book - of - ast . md <nl> + # The Book of AST <nl> When I started dealing with * * AST * * I had a lot of problems in understanding basic parts . I read [ * * ESTree * * ] ( https : / / github . com / estree / estree # readme ) standard , I read [ * * Babel * * ] ( https : / / babeljs . io / docs / en / babel - types # ) standard . They are very good ! Anyways they put the information in a very hurd to understand for novice way . <nl> 
mmm a / packages / engine - runner / README . md <nl> ppp b / packages / engine - runner / README . md <nl> Program : { <nl> exit ( ) { <nl> - console . log ( listStore ( ) ) ; <nl> + console . log ( pathStore ( ) ) ; <nl> / / returns <nl> [ ] ; <nl> } , <nl> 
mmm a / packages / engine - processor / README . md <nl> ppp b / packages / engine - processor / README . md <nl> } ; <nl> ` ` ` <nl> - Instead of ` find ` and ` fix ` you can use ` lint ` : <nl> + Instead of ` find ` and ` fix ` you can export ` lint ` : <nl> ` ` ` js <nl> + import eslint from ' @ putout / eslint ' ; <nl> + <nl> export const files = [ <nl> ' * . js ' , <nl> ] ; <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> } <nl> ` ` ` <nl> - And not bundled processors : <nl> + Not bundled processors : <nl> | Package | Version | <nl> | - - - - - - - - | - - - - - - - | <nl> - | [ ` @ putout / processor - typescript ` ] ( / packages / processor - typescript # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / processor - typescript . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / processor - typescript # readme ) | <nl> - | [ ` @ putout / processor - html ` ] ( / packages / processor - html # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / processor - html . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / processor - html # readme ) | <nl> + | [ ` @ putout / processor - typescript ` ] ( / packages / processor - typescript # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / processor - typescript . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / processor - typescript ) | <nl> + | [ ` @ putout / processor - html ` ] ( / packages / processor - html # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / processor - html . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / processor - html ) | <nl> | [ ` @ putout / processor - wasm ` ] ( / packages / processor - wasm # readme ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / @ putout / processor - wasm . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / @ putout / processor - wasm ) | <nl> - To enable it use : <nl> + External processors : <nl> + <nl> + | Package | Version | <nl> + | - - - - - - - - | - - - - - - - | <nl> + | [ ` putout - processor - typos ` ] ( https : / / github . com / putoutjs / putout - processor - typos ) | [ ! [ npm ] ( https : / / img . shields . io / npm / v / putout - processor - typos . svg ? maxAge = 86400 ) ] ( https : / / www . npmjs . com / package / putout - processor - typos ) | <nl> + <nl> + <nl> + To enable , install and use : <nl> ` ` ` json <nl> { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < / details > <nl> - < details > < summary > apply < code > await import < / code > < / summary > <nl> - <nl> - ` ` ` diff <nl> - - const { readFile } = import ( ' fs / promises ' ) ; <nl> - + const { readFile } = await import ( ' fs / promises ' ) ; <nl> - ` ` ` <nl> - <nl> - < / details > <nl> - <nl> < details > < summary > apply < code > if condition < / code > < / summary > <nl> ` ` ` diff <nl> @ @ - 1660 , 6 + 1651 , 15 @ @ async ( ) = > { <nl> < / details > <nl> + < details > < summary > apply < code > await import < / code > < / summary > <nl> + <nl> + ` ` ` diff <nl> + - const { readFile } = import ( ' fs / promises ' ) ; <nl> + + const { readFile } = await import ( ' fs / promises ' ) ; <nl> + ` ` ` <nl> + <nl> + < / details > <nl> + <nl> # # # Node . js <nl> < details > < summary > convert < code > fs . promises < / code > to < code > fs / promises < / code > for < a href = https : / / nodejs . org / dist / latest - v15 . x / docs / api / fs . html # fs_fs_promises_api > node . js < / a > < / summary > <nl> 
mmm a / packages / plugin - nodejs / README . md <nl> ppp b / packages / plugin - nodejs / README . md <nl> await readFile ( ' hello . txt ' , ' utf8 ' ) ; <nl> ` ` ` <nl> - When you want ot skip some declaration use ` dismiss ` : <nl> + When you want to skip some declaration use ` dismiss ` : <nl> ` ` ` json <nl> { <nl> 
mmm a / packages / plugin - split - nested - destructuring / README . md <nl> ppp b / packages / plugin - split - nested - destructuring / README . md <nl> [ NPMURL ] : https : / / npmjs . org / package / @ putout / plugin - split - nested - destructuring " npm " <nl> - > - Don ' t use nested destructuring on data that comes from any external data sources ( such as REST APIs , GraphQL endpoints or files ) . <nl> + > - Don ' t use nested destructuring on data that comes from any external data sources ( such as ` REST API ` s , ` GraphQL ` endpoints or files ) . <nl> > - Don ' t use nested destructuring on function arguments that have long or complicated signatures . <nl> > <nl> > ( c ) [ Destructuring in JavaScript : the not so good parts ] ( https : / / goodguydaniel . com / blog / destructuring - not - so - good - parts ) <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # # Magic Properties <nl> + > With the exception of ` $ el ` , magic properties are * * not available within ` x - data ` * * as the component isn ' t initialized yet . <nl> + <nl> - - - <nl> # # # ` $ el ` <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * Structure : * * ` < button x - on : [ event ] = " [ expression ] " > < / button > ` <nl> - ` x - on ` attaches an event listener to the element it ' s declared on . When that event is emitted , the JavaScript expression set as its value is executed . <nl> + ` x - on ` attaches an event listener to the element it ' s declared on . When that event is emitted , the JavaScript expression set as its value is executed . You can use ` x - on ` with any event available for the element you ' re adding the directive on , for a full list of events , see [ the Event reference on MDN ] ( https : / / developer . mozilla . org / en - US / docs / Web / Events ) for a list of possible values . <nl> If any data is modified in the expression , other element attributes " bound " to this data , will be updated . <nl> 
mmm a / docs / lib / Components / index . js <nl> ppp b / docs / lib / Components / index . js <nl> to : ' / components / badge / ' <nl> } , <nl> { <nl> - name : ' Breadscrumbs ' , <nl> + name : ' Breadcrumbs ' , <nl> to : ' / components / breadcrumbs / ' <nl> } , <nl> { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ availity - reactstrap - validation ] ( https : / / availity . github . io / availity - reactstrap - validation / ) <nl> - [ component - template ] ( https : / / reactstrap . github . io / component - template / ) <nl> - [ video - react ] ( https : / / video - react . github . io / ) <nl> + - [ CoreUI - Free - Bootstrap - Admin - Template ] ( https : / / github . com / mrholek / CoreUI - Free - Bootstrap - Admin - Template ) - [ demo ] ( http : / / coreui . io / demo / React_Demo / # / ) <nl> Submit a PR to add to this list ! <nl> 
mmm a / docs / lib / examples / Layout . js <nl> ppp b / docs / lib / examples / Layout . js <nl> < / Row > <nl> < Row > <nl> < Col xs = " 3 " > . col - 3 < / Col > <nl> - < Col xs = " auto " > . col - auto - variabe width content < / Col > <nl> + < Col xs = " auto " > . col - auto - variable width content < / Col > <nl> < Col xs = " 3 " > . col - 3 < / Col > <nl> < / Row > <nl> < Row > <nl> 
mmm a / docs / lib / Components / ButtonsPage . js <nl> ppp b / docs / lib / Components / ButtonsPage . js <nl> const ButtonExampleSource = require ( ' ! ! raw ! . . / examples / Button ' ) ; <nl> import ButtonOutline from ' . . / examples / ButtonOutline ' ; <nl> - const ButtonOutlineSource = require ( ' ! ! raw ! . . / examples / ButtonOutline ' ) <nl> + const ButtonOutlineSource = require ( ' ! ! raw ! . . / examples / ButtonOutline ' ) ; <nl> import ButtonStateful from ' . . / examples / ButtonStateful ' ; <nl> const ButtonStatefulSource = require ( ' ! ! raw ! . . / examples / ButtonStateful ' ) ; <nl> 
mmm a / docs / lib / Components / TablesPage . js <nl> ppp b / docs / lib / Components / TablesPage . js <nl> < h4 > Properties < / h4 > <nl> < pre > <nl> < PrismCode className = " language - jsx " > <nl> - { ` Card . propTypes = { <nl> + { ` Table . propTypes = { <nl> / / Pass in a Component to override default element <nl> tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> size : PropTypes . string , <nl> 
mmm a / docs / lib / examples / AlertDismiss . js <nl> ppp b / docs / lib / examples / AlertDismiss . js <nl> this . state = { <nl> visible : true <nl> - } <nl> + } ; <nl> + <nl> + this . onDismiss = this . onDismiss . bind ( this ) ; <nl> } <nl> - onDismiss = ( ) = > { <nl> + onDismiss ( ) { <nl> this . setState ( { visible : false } ) ; <nl> } <nl> 
mmm a / docs / lib / Components / ButtonDropdownPage . js <nl> ppp b / docs / lib / Components / ButtonDropdownPage . js <nl> < Example color = " success " text = " Success " / > <nl> < Example color = " info " text = " Info " / > <nl> < Example color = " warning " text = " Warning " / > <nl> - < Example color = " danger " text = " Darning " / > <nl> + < Example color = " danger " text = " Danger " / > <nl> < / div > <nl> < / div > <nl> < pre > <nl> @ @ - 100 , 7 + 100 , 7 @ @ DropdownToggle . propTypes = { <nl> < ExampleSplit color = " success " text = " Success " / > <nl> < ExampleSplit color = " info " text = " Info " / > <nl> < ExampleSplit color = " warning " text = " Warning " / > <nl> - < ExampleSplit color = " danger " text = " Darning " / > <nl> + < ExampleSplit color = " danger " text = " Danger " / > <nl> < / div > <nl> < / div > <nl> < pre > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ ! [ Build Status ] ( https : / / travis - ci . org / reactstrap / reactstrap . svg ? branch = master ) ] ( https : / / travis - ci . org / reactstrap / reactstrap ) [ ! [ Coverage Status ] ( https : / / coveralls . io / repos / github / reactstrap / reactstrap / badge . svg ? branch = master ) ] ( https : / / coveralls . io / github / reactstrap / reactstrap ? branch = master ) <nl> + [ ! [ CDNJS ] ( https : / / img . shields . io / cdnjs / v / reactstrap . svg ) ] ( https : / / cdnjs . com / libraries / reactstrap ) [ ! [ NPM Version ] ( https : / / img . shields . io / npm / v / reactstrap . svg ? branch = master ) ] ( https : / / www . npmjs . com / package / reactstrap ) [ ! [ Build Status ] ( https : / / travis - ci . org / reactstrap / reactstrap . svg ? branch = master ) ] ( https : / / travis - ci . org / reactstrap / reactstrap ) [ ! [ Coverage Status ] ( https : / / coveralls . io / repos / github / reactstrap / reactstrap / badge . svg ? branch = master ) ] ( https : / / coveralls . io / github / reactstrap / reactstrap ? branch = master ) [ ! [ License ] ( https : / / img . shields . io / npm / l / reactstrap . svg ) ] ( https : / / github . com / reactstrap / reactstrap / blob / master / LICENSE ) <nl> # reactstrap <nl> @ @ - 45 , 6 + 45 , 19 @ @ import { Button } from ' reactstrap ' ; <nl> Now you are ready to use the imported reactstrap components within your component hierarchy defined in the render method . Here is an example [ ` App . js ` ] ( https : / / gist . github . com / eddywashere / e13033c0e655ab7cda995f8bc77ce40d ) redone using reactstrap . <nl> + # # # CDN <nl> + <nl> + Reactstrap can be included directly in your application ' s bundle or excluded during compilation and linked directly to a CDN . <nl> + <nl> + ` ` ` html <nl> + https : / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 4 . 8 . 0 / reactstrap . min . js <nl> + ` ` ` <nl> + <nl> + > Note : When using the external CDN library , be sure to include the required dependencies as necessary * * prior * * to the Reactstrap library : <nl> + > * [ React ] ( https : / / cdnjs . com / libraries / react ) <nl> + > * [ ReactTransitionGroup ] ( https : / / unpkg . com / react - transition - group / dist / react - transition - group . min . js ) <nl> + <nl> + <nl> # # About the Project <nl> This library contains React Bootstrap 4 components that favor composition and control . The library does not depend on jQuery or Bootstrap javascript . However , [ Tether ] ( http : / / tether . io / ) is relied upon for advanced positioning of content like Tooltips , Popovers , and auto - flipping Dropdowns . <nl> 
mmm a / docs / lib / Home / index . js <nl> ppp b / docs / lib / Home / index . js <nl> < / pre > <nl> < p > Now you are ready to use the imported reactstrap components within your component hierarchy defined in the render method . Here is an example < a href = " https : / / gist . github . com / eddywashere / e13033c0e655ab7cda995f8bc77ce40d " target = " _blank " > < code > App . js < / code > < / a > redone using reactstrap . < / p > <nl> < h2 className = " mt - 5 " > CDN < / h2 > <nl> + < p > Reactstrap can be included directly in your application ' s bundle or excluded during compilation and linked directly to a CDN . < / p > <nl> < pre > <nl> < PrismCode className = " language - jsx " > <nl> - https : / / unpkg . com / reactstrap / dist / reactstrap . min . js <nl> + https : / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 4 . 8 . 0 / reactstrap . min . js <nl> < / PrismCode > <nl> < / pre > <nl> + < blockquote className = " blockquote " > <nl> + < p > <nl> + < strong > Note < / strong > : When using the external CDN library , be sure to include the required dependencies as necessary < strong > prior < / strong > to the Reactstrap library : <nl> + < / p > <nl> + < ul > <nl> + < li > < a href = " / / cdnjs . com / libraries / react " target = " _blank " > React < / a > < / li > <nl> + < li > < a href = " / / unpkg . com / react - transition - group / dist / react - transition - group . min . js " target = " _blank " > ReactTransitionGroup < / a > < / li > <nl> + < / ul > <nl> + < / blockquote > <nl> < p > Check out the demo < a href = " http : / / output . jsbin . com / dimive / latest " > here < / a > < / p > <nl> < h2 className = " mt - 5 " > About the Project < / h2 > <nl> < hr / > <nl> 
mmm a / docs / lib / Home / index . js <nl> ppp b / docs / lib / Home / index . js <nl> < pre > <nl> < PrismCode className = " language - bash " > <nl> { ` npm install bootstrap @ 4 . 0 . 0 - alpha . 6 - - save <nl> - npm install - - save reactstrap react - addons - transition - group react - addons - css - transition - group react react - dom ` } <nl> + npm install - - save reactstrap react - addons - transition - group react react - dom ` } <nl> < / PrismCode > <nl> < / pre > <nl> < p > Import Bootstrap CSS in the < code > src / index . js < / code > file : < / p > <nl> 
mmm a / docs / lib / Components / FormPage . js <nl> ppp b / docs / lib / Components / FormPage . js <nl> < / PrismCode > <nl> < / pre > <nl> + < h3 > Properties < / h3 > <nl> + < pre > <nl> + < PrismCode className = " language - jsx " > <nl> { ` Input . propTypes = { <nl> children : PropTypes . node , <nl> / / type can be things like text , password , ( typical input types ) as well as select and textarea , providing children as you normally would to those . <nl> @ @ - 58 , 6 + 61 , 8 @ @ export default class FormPage extends React . Component { <nl> className : PropTypes . string , <nl> cssModule : PropTypes . object , <nl> } ; ` } <nl> + < / PrismCode > <nl> + < / pre > <nl> < h3 > Form Grid < / h3 > <nl> < div className = " docs - example " > <nl> 
mmm a / docs / lib / Components / DropdownsPage . js <nl> ppp b / docs / lib / Components / DropdownsPage . js <nl> flip : PropTypes . bool , / / default : true , <nl> className : PropTypes . string , <nl> cssModule : PropTypes . object , <nl> + } ; <nl> + <nl> + DropdownItem . propTypes = { <nl> + children : PropTypes . node , <nl> + active : PropTypes . bool , <nl> + disabled : PropTypes . bool , <nl> + divider : PropTypes . bool , <nl> + tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> + header : PropTypes . bool , <nl> + onClick : PropTypes . func , <nl> + className : PropTypes . string , <nl> + cssModule : PropTypes . object , <nl> + toggle : PropTypes . bool / / default : true <nl> } ; ` } <nl> < / PrismCode > <nl> < / pre > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - dom / 16 . 0 . 0 / umd / react - dom . production . min . js " > < / script > <nl> < ! - - Optional dependencies - - > <nl> < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - transition - group / 2 . 2 . 1 / react - transition - group . min . js " > < / script > <nl> - < script type = " text / javascript " src = " / / unpkg . com / react - popper @ 0 . 7 . 3 / dist / react - popper . min . js " > < / script > <nl> + < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - popper / 0 . 7 . 4 / react - popper . min . js " > < / script > <nl> < ! - - Reactstrap - - > <nl> < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 - alpha . 3 / reactstrap . min . js " > < / script > <nl> < ! - - Lastly , include your app ' s bundle - - > <nl> 
mmm a / docs / lib / examples / ModalNested . js <nl> ppp b / docs / lib / examples / ModalNested . js <nl> this . state = { <nl> modal : false , <nl> nestedModal : false , <nl> + closeAll : false <nl> } ; <nl> this . toggle = this . toggle . bind ( this ) ; <nl> this . toggleNested = this . toggleNested . bind ( this ) ; <nl> + this . toggleAll = this . toggleAll . bind ( this ) ; <nl> } <nl> toggle ( ) { <nl> @ @ - 23 , 7 + 25 , 15 @ @ class ModalExample extends React . Component { <nl> toggleNested ( ) { <nl> this . setState ( { <nl> - nestedModal : ! this . state . nestedModal <nl> + nestedModal : ! this . state . nestedModal , <nl> + closeAll : false <nl> + } ) ; <nl> + } <nl> + <nl> + toggleAll ( ) { <nl> + this . setState ( { <nl> + nestedModal : ! this . state . nestedModal , <nl> + closeAll : true <nl> } ) ; <nl> } <nl> @ @ - 37 , 12 + 47 , 12 @ @ class ModalExample extends React . Component { <nl> Lorem ipsum dolor sit amet , consectetur adipisicing elit , sed do eiusmod tempor incididunt ut labore et dolore magna aliqua . Ut enim ad minim veniam , quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat . Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur . Excepteur sint occaecat cupidatat non proident , sunt in culpa qui officia deserunt mollit anim id est laborum . <nl> < br / > <nl> < Button color = " success " onClick = { this . toggleNested } > Show Nested Model < / Button > <nl> - < Modal isOpen = { this . state . nestedModal } toggle = { this . toggleNested } > <nl> + < Modal isOpen = { this . state . nestedModal } toggle = { this . toggleNested } onClosed = { this . state . closeAll & & this . toggle } > <nl> < ModalHeader > Nested Modal title < / ModalHeader > <nl> < ModalBody > Stuff and things < / ModalBody > <nl> < ModalFooter > <nl> < Button color = " primary " onClick = { this . toggleNested } > Done < / Button > { ' ' } <nl> - < Button color = " secondary " onClick = { this . toggle } > All Done < / Button > <nl> + < Button color = " secondary " onClick = { this . toggleAll } > All Done < / Button > <nl> < / ModalFooter > <nl> < / Modal > <nl> < / ModalBody > <nl> 
mmm a / docs / lib / examples / CarouselCustomTag . js <nl> ppp b / docs / lib / examples / CarouselCustomTag . js <nl> const items = [ <nl> { <nl> + id : 1 , <nl> altText : ' Slide 1 ' , <nl> caption : ' Slide 1 ' <nl> } , <nl> { <nl> + id : 2 , <nl> altText : ' Slide 2 ' , <nl> caption : ' Slide 2 ' <nl> } , <nl> { <nl> + id : 3 , <nl> altText : ' Slide 3 ' , <nl> caption : ' Slide 3 ' <nl> } <nl> @ @ - 66 , 6 + 69 , 7 @ @ class Example extends Component { <nl> < CarouselItem <nl> className = " custom - tag " <nl> tag = " div " <nl> + key = { item . id } <nl> onExiting = { this . onExiting } <nl> onExited = { this . onExited } <nl> > <nl> @ @ - 76 , 13 + 80 , 15 @ @ class Example extends Component { <nl> return ( <nl> < div > <nl> - < style > { ` <nl> - . custom - tag { <nl> + < style > <nl> + { <nl> + ` . custom - tag { <nl> max - width : 100 % ; <nl> height : 500px ; <nl> background : black ; <nl> + } ` <nl> } <nl> - ` } < / style > <nl> + < / style > <nl> < Carousel <nl> activeIndex = { activeIndex } <nl> next = { this . next } <nl> 
mmm a / docs / lib / Components / ProgressPage . js <nl> ppp b / docs / lib / Components / ProgressPage . js <nl> PropTypes . number , <nl> ] ) , <nl> animated : PropTypes . bool , <nl> - stripped : PropTypes . bool , <nl> + striped : PropTypes . bool , <nl> color : PropTypes . string , <nl> className : PropTypes . string , <nl> barClassName : PropTypes . string / / used to add class to the inner progress - bar element <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> ` ` ` <nl> Now you are ready to use the imported reactstrap components within your component hierarchy defined in the render <nl> - method . Here is an example [ ` App . js ` ] ( https : / / gist . github . com / eddywashere / e13033c0e655ab7cda995f8bc77ce40d ) redone <nl> + method . Here is an example [ ` App . js ` ] ( https : / / gist . github . com / Thomas - Smyth / 006fd507a7295f17a8473451938f9935 ) redone <nl> using reactstrap . <nl> # # # Dependencies <nl> 
mmm a / docs / lib / examples / InputGroupAddon . js <nl> ppp b / docs / lib / examples / InputGroupAddon . js <nl> - import { InputGroup , InputGroupAddon , Input } from ' reactstrap ' ; <nl> + import { InputGroup , InputGroupText , InputGroupAddon , Input } from ' reactstrap ' ; <nl> const Example = ( props ) = > { <nl> return ( <nl> 
mmm a / docs / lib / Home / index . js <nl> ppp b / docs / lib / Home / index . js <nl> < / pre > <nl> < p > Import Bootstrap CSS in the < code > src / index . js < / code > file : < / p > <nl> < pre > <nl> - < PrismCode className = " language - bash " > import ' bootstrap / dist / css / bootstrap . css ' ; < / PrismCode > <nl> + < PrismCode className = " language - bash " > import ' bootstrap / dist / css / bootstrap . min . css ' ; < / PrismCode > <nl> < / pre > <nl> < p > Import required reactstrap components within < code > src / App . js < / code > file or your custom component files : < / p > <nl> < pre > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * [ * * cdnjs * * ] ( https : / / cdnjs . com / libraries / reactstrap ) <nl> ` ` ` html <nl> < ! - - Main version - - > <nl> - < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 - alpha . 3 / reactstrap . min . js " > < / script > <nl> + < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 / reactstrap . min . js " > < / script > <nl> < ! - - All optional dependencies version - - > <nl> - < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 - alpha . 3 / reactstrap . full . min . js " > < / script > <nl> + < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 / reactstrap . full . min . js " > < / script > <nl> ` ` ` <nl> * [ * * unpkg * * ] ( https : / / unpkg . com / reactstrap / ) <nl> ` ` ` html <nl> < ! - - Main version - - > <nl> - < script src = " https : / / unpkg . com / reactstrap @ 5 . 0 . 0 - alpha . 3 / reactstrap . min . js " > < / script > <nl> + < script src = " https : / / unpkg . com / reactstrap @ 5 . 0 . 0 / dist / reactstrap . min . js " > < / script > <nl> < ! - - All optional dependencies version - - > <nl> - < script src = " https : / / unpkg . com / reactstrap @ 5 . 0 . 0 - alpha . 3 / reactstrap . full . min . js " > < / script > <nl> + < script src = " https : / / unpkg . com / reactstrap @ 5 . 0 . 0 / dist / reactstrap . full . min . js " > < / script > <nl> ` ` ` <nl> - > * * Note * * : To load a specific version of Reactstrap replace ` 5 . 0 . 0 - alpha . 3 ` with the version number . <nl> + > * * Note * * : To load a specific version of Reactstrap replace ` 5 . 0 . 0 ` with the version number . <nl> # # # # Versions <nl> @ @ - 128 , 9 + 128 , 9 @ @ Reactstrap has two primary distribution versions : <nl> < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - dom / 16 . 0 . 0 / umd / react - dom . production . min . js " > < / script > <nl> < ! - - Optional dependencies - - > <nl> < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - transition - group / 2 . 2 . 1 / react - transition - group . min . js " > < / script > <nl> - < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - popper / 0 . 7 . 4 / react - popper . min . js " > < / script > <nl> + < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / react - popper / 0 . 8 . 3 / react - popper . min . js " > < / script > <nl> < ! - - Reactstrap - - > <nl> - < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 - alpha . 3 / reactstrap . min . js " > < / script > <nl> + < script type = " text / javascript " src = " / / cdnjs . cloudflare . com / ajax / libs / reactstrap / 5 . 0 . 0 / reactstrap . min . js " > < / script > <nl> < ! - - Lastly , include your app ' s bundle - - > <nl> < script type = " text / javascript " src = " / assets / bundle . js " > < / script > <nl> < / head > <nl> 
mmm a / docs / lib / Components / ModalsPage . js <nl> ppp b / docs / lib / Components / ModalsPage . js <nl> autoFocus : PropTypes . bool , <nl> / / if modal should be centered vertically in viewport <nl> centered : PropTypes . bool , <nl> + / / corresponds to bootstrap ' s modal sizes , ie . ' lg ' or ' sm ' <nl> size : PropTypes . string , <nl> / / callback for toggling isOpen in the controlling component <nl> toggle : PropTypes . func , <nl> 
mmm a / docs / lib / examples / Dropdown . js <nl> ppp b / docs / lib / examples / Dropdown . js <nl> } <nl> toggle ( ) { <nl> - this . setState ( { <nl> - dropdownOpen : ! this . state . dropdownOpen <nl> - } ) ; <nl> + this . setState ( prevState = > ( { <nl> + dropdownOpen : ! prevState . dropdownOpen <nl> + } ) ) ; <nl> } <nl> render ( ) { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Install reactstrap and Bootstrap from NPM . Reactstrap does not include Bootstrap CSS so this needs to be installed as well : <nl> ` ` ` <nl> - npm install - - save bootstrap @ 4 . 0 . 0 <nl> - npm install - - save reactstrap @ next react @ ^ 16 . 0 . 0 react - dom @ ^ 16 . 0 . 0 <nl> + npm install - - save bootstrap @ 4 . 1 . 1 <nl> + npm install - - save reactstrap react @ ^ 16 . 3 . 2 react - dom @ ^ 16 . 3 . 2 <nl> ` ` ` <nl> Import Bootstrap CSS in the ` ` ` src / index . js ` ` ` file : <nl> 
mmm a / docs / lib / Components / CollapsePage . js <nl> ppp b / docs / lib / Components / CollapsePage . js <nl> import SectionTitle from ' . . / UI / SectionTitle ' ; <nl> import CollapseExample from ' . . / examples / Collapse ' ; <nl> + import UncontrolledCollapseExample from ' . . / examples / CollapseUncontrolled ' ; <nl> import CollapseEventsExample from ' . . / examples / CollapseEvents ' ; <nl> const CollapseExampleSource = require ( ' ! ! raw ! . . / examples / Collapse ' ) ; <nl> const CollapseEventsExampleSource = require ( ' ! ! raw ! . . / examples / CollapseEvents ' ) ; <nl> + const UncontrolledCollapseExampleSource = require ( ' ! ! raw ! . . / examples / CollapseUncontrolled ' ) ; <nl> + <nl> export default class CollapsePage extends React . Component { <nl> render ( ) { <nl> return ( <nl> @ @ - 60 , 6 + 63 , 12 @ @ export default class CollapsePage extends React . Component { <nl> pass a < code > toggler < / code > prop . The < code > toggler < / code > prop is a string which will run <nl> querySelectorAll to find dom elements which will trigger toggle . <nl> < / p > <nl> + < div className = " docs - example " > <nl> + < UncontrolledCollapseExample / > <nl> + < / div > <nl> + < pre > <nl> + < PrismCode className = " language - jsx " > { UncontrolledCollapseExampleSource } < / PrismCode > <nl> + < / pre > <nl> < / div > <nl> ) ; <nl> } <nl> 
mmm a / docs / lib / Components / CarouselPage . js <nl> ppp b / docs / lib / Components / CarouselPage . js <nl> < pre > <nl> < PrismCode className = " language - jsx " > <nl> { ` UncontrolledCarousel . propTypes = { <nl> - items : PropTypes . array , isRequired , <nl> + items : PropTypes . array . isRequired , <nl> indicators : PropTypes . bool , / / default : true <nl> controls : PropTypes . bool , / / default : true <nl> autoPlay : PropTypes . bool , / / default : true <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # Getting Started <nl> - Follow the [ create - react - app instructions ] ( https : / / github . com / facebookincubator / create - react - app # getting - started ) up to the ` Adding Bootstrap ` section and instead follow the reactstrap version of [ adding bootstrap ] ( # adding - bootstrap ) . <nl> + Follow the [ create - react - app instructions ] ( https : / / github . com / facebook / create - react - app / blob / master / packages / react - scripts / template / README . md ) * * up to * * the ` Adding Bootstrap ` section and instead follow the reactstrap version of [ adding bootstrap ] ( # adding - bootstrap ) . <nl> # # # tl ; dr <nl> 
mmm a / docs / lib / Components / FormPage . js <nl> ppp b / docs / lib / Components / FormPage . js <nl> addon : PropTypes . bool , <nl> className : PropTypes . string , <nl> cssModule : PropTypes . object , <nl> - } ; ` } <nl> - { ` CustomInput . propTypes = { <nl> + } ; <nl> + <nl> + CustomInput . propTypes = { <nl> className : PropTypes . string , <nl> id : PropTypes . oneOfType ( [ PropTypes . string , PropTypes . number ] ) . isRequired , <nl> type : PropTypes . string . isRequired , / / radio , checkbox , select , range . <nl> label : PropTypes . string , / / used for checkbox and radios <nl> inline : PropTypes . bool , <nl> - valid : PropTypes . bool , / / applied the is - invalid class when true , does nothing when false <nl> - invalid : PropTypes . bool , / / applied the is - valid class when true , does nothing when false <nl> + valid : PropTypes . bool , / / applied the is - valid class when true , does nothing when false <nl> + invalid : PropTypes . bool , / / applied the is - invalid class when true , does nothing when false <nl> bsSize : PropTypes . string , <nl> cssModule : PropTypes . object , <nl> children : PropTypes . oneOfType ( [ PropTypes . node , PropTypes . array , PropTypes . func ] ) , / / for type = " select " <nl> @ @ - 86 , 6 + 87 , 51 @ @ export default class FormPage extends React . Component { <nl> PropTypes . string , <nl> PropTypes . func , <nl> ] ) <nl> + } ; <nl> + <nl> + Form . propTypes = { <nl> + children : PropTypes . node , <nl> + inline : PropTypes . bool , <nl> + / / Pass in a Component to override default element <nl> + tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , / / default : ' form ' <nl> + innerRef : PropTypes . oneOfType ( [ PropTypes . object , PropTypes . func , PropTypes . string ] ) , <nl> + className : PropTypes . string , <nl> + cssModule : PropTypes . object , <nl> + } ; <nl> + <nl> + FormFeedback . propTypes = { <nl> + children : PropTypes . node , <nl> + / / Pass in a Component to override default element <nl> + tag : PropTypes . string , / / default : ' div ' <nl> + className : PropTypes . string , <nl> + cssModule : PropTypes . object , <nl> + valid : PropTypes . bool , / / default : undefined <nl> + tooltip : PropTypes . bool <nl> + } ; <nl> + <nl> + FormGroup . propTypes = { <nl> + children : PropTypes . node , <nl> + / / Applied the row class when true , does nothing when false <nl> + row : PropTypes . bool , <nl> + / / Applied the form - check class when true , form - group when false <nl> + check : PropTypes . bool , <nl> + inline : PropTypes . bool , <nl> + / / Applied the disabled class when the check and disabled props are true , does nothing when false <nl> + disabled : PropTypes . bool , <nl> + / / Pass in a Component to override default element <nl> + tag : PropTypes . string , / / default : ' div ' <nl> + className : PropTypes . string , <nl> + cssModule : PropTypes . object , <nl> + } ; <nl> + <nl> + FormText . propTypes = { <nl> + children : PropTypes . node , <nl> + inline : PropTypes . bool , <nl> + / / Pass in a Component to override default element <nl> + tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , / / default : ' small ' <nl> + color : PropTypes . string , / / default : ' muted ' <nl> + className : PropTypes . string , <nl> + cssModule : PropTypes . object , <nl> } ; ` } <nl> < / PrismCode > <nl> < / pre > <nl> 
mmm a / docs / lib / Components / CollapsePage . js <nl> ppp b / docs / lib / Components / CollapsePage . js <nl> < pre > <nl> < PrismCode className = " language - jsx " > <nl> { ` Collapse . propTypes = { <nl> - . . . Transition . propTypes , <nl> + . . . Transition . propTypes , / / see note below <nl> isOpen : PropTypes . bool , <nl> children : PropTypes . oneOfType ( [ <nl> PropTypes . arrayOf ( PropTypes . node ) , <nl> @ @ - 44 , 6 + 44 , 12 @ @ export default class CollapsePage extends React . Component { <nl> } ; ` } <nl> < / PrismCode > <nl> < / pre > <nl> + < p > <nl> + Collapse is wrapped in a < code > Transition < / code > component <nl> + from < code > react - transition - group / transition < / code > . Transition props are passed through to <nl> + this wrapper . Refer to the < code > Transition < / code > documentation for details : < a href = " http : / / reactcommunity . org / react - transition - group / transition / " > <nl> + http : / / reactcommunity . org / react - transition - group / transition / < / a > . <nl> + < / p > <nl> < SectionTitle > Events < / SectionTitle > <nl> < p > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Install reactstrap and Bootstrap from NPM . Reactstrap does not include Bootstrap CSS so this needs to be installed as well : <nl> ` ` ` <nl> - npm install - - save bootstrap @ 4 . 1 . 3 <nl> - npm install - - save reactstrap react @ ^ 16 . 3 . 2 react - dom @ ^ 16 . 3 . 2 <nl> + npm install - - save bootstrap <nl> + npm install - - save reactstrap react react - dom <nl> ` ` ` <nl> Import Bootstrap CSS in the ` ` ` src / index . js ` ` ` file : <nl> 
mmm a / docs / lib / examples / BreadcrumbNoList . js <nl> ppp b / docs / lib / examples / BreadcrumbNoList . js <nl> const Example = ( props ) = > { <nl> return ( <nl> < div > <nl> - < Breadcrumb tag = " nav " > <nl> + < Breadcrumb tag = " nav " listTag = " div " > <nl> < BreadcrumbItem tag = " a " href = " # " > Home < / BreadcrumbItem > <nl> < BreadcrumbItem tag = " a " href = " # " > Library < / BreadcrumbItem > <nl> < BreadcrumbItem tag = " a " href = " # " > Data < / BreadcrumbItem > <nl> 
mmm a / docs / lib / Components / ModalsPage . js <nl> ppp b / docs / lib / Components / ModalsPage . js <nl> PropTypes . bool , <nl> PropTypes . oneOf ( [ ' static ' ] ) <nl> ] ) , <nl> - / / allows for a node / componet to exist next to the modal ( outside of it ) . Useful for external close buttons <nl> + / / allows for a node / component to exist next to the modal ( outside of it ) . Useful for external close buttons <nl> / / external : PropTypes . node , <nl> / / called on componentDidMount <nl> onEnter : PropTypes . func , <nl> 
mmm a / src / Input . js <nl> ppp b / src / Input . js <nl> type : PropTypes . string , <nl> size : PropTypes . string , <nl> bsSize : PropTypes . string , <nl> - state : deprecated ( PropTypes . string , ' Please use the props " valid " and " invalid " to indicate the state . ' ) , <nl> + state : deprecated ( <nl> + PropTypes . string , <nl> + ' Please use the props " valid " and " invalid " to indicate the state . ' <nl> + ) , <nl> valid : PropTypes . bool , <nl> invalid : PropTypes . bool , <nl> tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> - innerRef : PropTypes . oneOfType ( [ PropTypes . object , PropTypes . func , PropTypes . string ] ) , <nl> + innerRef : PropTypes . oneOfType ( [ <nl> + PropTypes . object , <nl> + PropTypes . func , <nl> + PropTypes . string <nl> + ] ) , <nl> static : deprecated ( PropTypes . bool , ' Please use the prop " plaintext " ' ) , <nl> plaintext : PropTypes . bool , <nl> addon : PropTypes . bool , <nl> className : PropTypes . string , <nl> - cssModule : PropTypes . object , <nl> + cssModule : PropTypes . object <nl> } ; <nl> const defaultProps = { <nl> - type : ' text ' , <nl> + type : ' text ' <nl> } ; <nl> class Input extends React . Component { <nl> @ @ - 69 , 7 + 76 , 7 @ @ class Input extends React . Component { <nl> const fileInput = type = = = ' file ' ; <nl> const textareaInput = type = = = ' textarea ' ; <nl> const selectInput = type = = = ' select ' ; <nl> - let Tag = tag | | ( ( selectInput | | textareaInput ) ? type : ' input ' ) ; <nl> + let Tag = tag | | ( selectInput | | textareaInput ? type : ' input ' ) ; <nl> let formControlClass = ' form - control ' ; <nl> @ @ - 86 , 7 + 93 , 11 @ @ class Input extends React . Component { <nl> } <nl> } <nl> - if ( state & & typeof valid = = = ' undefined ' & & typeof invalid = = = ' undefined ' ) { <nl> + if ( <nl> + state & & <nl> + typeof valid = = = ' undefined ' & & <nl> + typeof invalid = = = ' undefined ' <nl> + ) { <nl> if ( state = = = ' danger ' ) { <nl> invalid = true ; <nl> } else if ( state = = = ' success ' ) { <nl> @ @ - 95 , 31 + 106 , 45 @ @ class Input extends React . Component { <nl> } <nl> if ( attributes . size & & isNotaNumber . test ( attributes . size ) ) { <nl> - warnOnce ( ' Please use the prop " bsSize " instead of the " size " to bootstrap \ ' s input sizing . ' ) ; <nl> + warnOnce ( <nl> + ' Please use the prop " bsSize " instead of the " size " to bootstrap \ ' s input sizing . ' <nl> + ) ; <nl> bsSize = attributes . size ; <nl> delete attributes . size ; <nl> } <nl> - const classes = mapToCssModules ( classNames ( <nl> + const classes = mapToCssModules ( <nl> + classNames ( <nl> className , <nl> invalid & & ' is - invalid ' , <nl> valid & & ' is - valid ' , <nl> bsSize ? ` form - control - $ { bsSize } ` : false , <nl> formControlClass <nl> - ) , cssModule ) ; <nl> + ) , <nl> + cssModule <nl> + ) ; <nl> if ( Tag = = = ' input ' | | ( tag & & typeof tag = = = ' function ' ) ) { <nl> attributes . type = type ; <nl> } <nl> - if ( attributes . children & & ! ( plaintext | | staticInput | | type = = = ' select ' | | typeof Tag ! = = ' string ' | | Tag = = = ' select ' ) ) { <nl> - warnOnce ( ` Input with a type of " $ { type } " cannot have children . Please use " value " / " defaultValue " instead . ` ) ; <nl> + if ( <nl> + attributes . children & & <nl> + ! ( <nl> + plaintext | | <nl> + staticInput | | <nl> + type = = = ' select ' | | <nl> + typeof Tag ! = = ' string ' | | <nl> + Tag = = = ' select ' <nl> + ) <nl> + ) { <nl> + warnOnce ( <nl> + ` Input with a type of " $ { type } " cannot have children . Please use " value " / " defaultValue " instead . ` <nl> + ) ; <nl> delete attributes . children ; <nl> } <nl> - return ( <nl> - < Tag { . . . attributes } ref = { innerRef } className = { classes } / > <nl> - ) ; <nl> + return < Tag { . . . attributes } ref = { innerRef } className = { classes } / > ; <nl> } <nl> } <nl> 
mmm a / docs / lib / Components / AlertsPage . js <nl> ppp b / docs / lib / Components / AlertsPage . js <nl> < SectionTitle > Alerts without fade < / SectionTitle > <nl> < p > <nl> - Fade can be disbaled using < code > fade = false < / code > . <nl> + Fade can be disabled using < code > fade = false < / code > . <nl> < / p > <nl> < div className = " docs - example " > <nl> < AlertFadelessExample / > <nl> 
mmm a / docs / lib / Components / ButtonsPage . js <nl> ppp b / docs / lib / Components / ButtonsPage . js <nl> < PrismCode className = " language - jsx " > <nl> { ` Button . propTypes = { <nl> active : PropTypes . bool , <nl> + ' aria - label ' : PropTypes . string , <nl> block : PropTypes . bool , <nl> color : PropTypes . string , / / default : ' secondary ' <nl> disabled : PropTypes . bool , <nl> + outline : PropTypes . bool , <nl> / / Pass in a Component to override default button element <nl> / / example : react - router Link <nl> / / default : ' button ' <nl> - tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> + tag : PropTypes . oneOfType ( [ <nl> + PropTypes . func , <nl> + PropTypes . string , <nl> + PropTypes . shape ( { $ $ typeof : PropTypes . symbol , render : PropTypes . func } ) , <nl> + PropTypes . arrayOf ( PropTypes . oneOfType ( [ <nl> + PropTypes . func , <nl> + PropTypes . string , <nl> + PropTypes . shape ( { $ $ typeof : PropTypes . symbol , render : PropTypes . func } ) , <nl> + ] ) ) <nl> + ] ) , <nl> / / ref will only get you a reference to the Button component , use innerRef to get a reference to the DOM element ( for things like focus management ) . <nl> - innerRef : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> + innerRef : PropTypes . oneOfType ( [ PropTypes . object , PropTypes . func , PropTypes . string ] ) , <nl> onClick : PropTypes . func , <nl> size : PropTypes . string , <nl> + children : PropTypes . node , <nl> + className : PropTypes . string , <nl> + cssModule : PropTypes . object , <nl> / / use close prop for BS4 close icon utility <nl> close : PropTypes . bool , <nl> + } <nl> + <nl> + Button . defaultProps = { <nl> + color : ' secondary ' , <nl> + tag : ' button ' , <nl> } ` } <nl> < / PrismCode > <nl> < / pre > <nl> 
mmm a / docs / lib / Components / AlertsPage . js <nl> ppp b / docs / lib / Components / AlertsPage . js <nl> isOpen : PropTypes . bool , / / default : true <nl> toggle : PropTypes . func , <nl> tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> + fade : PropTypes . bool , / / default : true <nl> / / Controls the transition of the alert fading in and out <nl> / / See [ Fade ] ( / components / fade / ) for more details <nl> transition : PropTypes . shape ( Fade . propTypes ) , <nl> 
mmm a / docs / lib / examples / InputGroupOverview . js <nl> ppp b / docs / lib / examples / InputGroupOverview . js <nl> < br / > <nl> < InputGroup > <nl> < InputGroupAddon addonType = " prepend " > $ < / InputGroupAddon > <nl> - < Input placeholder = " Amount " type = " number " step = " 1 " / > <nl> + < Input placeholder = " Amount " min = { 0 } max = { 100 } type = " number " step = " 1 " / > <nl> < InputGroupAddon addonType = " append " > . 00 < / InputGroupAddon > <nl> < / InputGroup > <nl> < / div > <nl> 
mmm a / docs / lib / UI / Content . js <nl> ppp b / docs / lib / UI / Content . js <nl> < div className = " docs - sidebar mb - 3 " > <nl> < h1 className = " h5 " > { title } < / h1 > <nl> < Nav className = " flex - column " > <nl> - { items . map ( item = > ( <nl> + { items . sort ( ( a , b ) = > a . name . localeCompare ( b . name ) ) . map ( item = > ( <nl> < NavItem key = { item . to } > <nl> < NavLink tag = { Link } to = { item . to } activeClassName = " active " > <nl> { item . name } <nl> 
mmm a / docs / lib / Components / DropdownsPage . js <nl> ppp b / docs / lib / Components / DropdownsPage . js <nl> styles : { <nl> . . . data . styles , <nl> overflow : ' auto ' , <nl> - maxHeight : 100 , <nl> + maxHeight : ' 100px ' , <nl> } , <nl> } ; <nl> } , <nl> 
mmm a / docs / lib / examples / InputGroupOverview . js <nl> ppp b / docs / lib / examples / InputGroupOverview . js <nl> < br / > <nl> < InputGroup > <nl> < Input placeholder = " username " / > <nl> - < InputGroupAddon addonType = " append " > @ example . com < / InputGroupAddon > <nl> + < InputGroupAddon addonType = " append " > <nl> + < InputGroupText > @ example . com < / InputGroupText > <nl> + < / InputGroupAddon > <nl> < / InputGroup > <nl> < br / > <nl> < InputGroup > <nl> 
mmm a / docs / lib / Components / ModalsPage . js <nl> ppp b / docs / lib / Components / ModalsPage . js <nl> modalTransition : PropTypes . shape ( Fade . propTypes ) , <nl> innerRef : PropTypes . object , <nl> / / if modal should be destructed / removed from DOM after closing <nl> - unmountOnClose : PropTypes . bool / / defaults to true <nl> + unmountOnClose : PropTypes . bool , / / defaults to true <nl> + / / if the element which triggered the modal to open should focused after the modal closes ( see example somewhere below ) <nl> + returnFocusAfterClose : PropTypes . bool / / defaults to true <nl> } ` } <nl> < / PrismCode > <nl> < / pre > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ Admin dashboard example app built with reactstrap ] ( https : / / github . com / reduction - admin / react - reduction ) - [ demo ] ( https : / / reduction - admin . firebaseapp . com / ) <nl> - [ DevExtreme React Grid ] ( https : / / devexpress . github . io / devextreme - reactive / react / grid / ) - It ' s a stateless data grid built on top of ` reactstrap ` with paging , sorting , filtering , grouping , selection , editing and virtual scrolling features . <nl> - [ DevExtreme React Chart ] ( https : / / devexpress . github . io / devextreme - reactive / react / chart / ) - A chart built on top of ` reactstrap ` that visualizes data using a variety of series types , including bar , line , area , scatter , pie , and more . <nl> + - [ reactstrap - scrollspy ] ( https : / / github . com / keidrun / reactstrap - scrollspy / ) - [ demo ] ( https : / / keidrun . github . io / reactstrap - scrollspy / ) <nl> Submit a PR to add to this list ! <nl> 
mmm a / docs / lib / examples / CardGroups . js <nl> ppp b / docs / lib / examples / CardGroups . js <nl> < / CardBody > <nl> < / Card > <nl> < Card > <nl> - < CardImg top width = " 100 % " src = " / assets / static318x180 . svg " alt = " Card image cap " / > <nl> + < CardImg top width = " 100 % " src = " / assets / 318x180 . svg " alt = " Card image cap " / > <nl> < CardBody > <nl> < CardTitle > Card title < / CardTitle > <nl> < CardSubtitle > Card subtitle < / CardSubtitle > <nl> 
mmm a / docs / lib / examples / Collapse . js <nl> ppp b / docs / lib / examples / Collapse . js <nl> import { Collapse , Button , CardBody , Card } from ' reactstrap ' ; <nl> const Example = ( props ) = > { <nl> - const [ collapse , setCollapse ] = useState ( false ) ; <nl> + const [ isOpen , setIsOpen ] = useState ( false ) ; <nl> - const toggle = ( ) = > setCollapse ( ! collapse ) ; <nl> + const toggle = ( ) = > setIsOpen ( ! isOpen ) ; <nl> return ( <nl> < div > <nl> < Button color = " primary " onClick = { toggle } style = { { marginBottom : ' 1rem ' } } > Toggle < / Button > <nl> - < Collapse isOpen = { collapse } > <nl> + < Collapse isOpen = { isOpen } > <nl> < Card > <nl> < CardBody > <nl> Anim pariatur cliche reprehenderit , <nl> 
mmm a / docs / lib / examples / CustomDropdown . js <nl> ppp b / docs / lib / examples / CustomDropdown . js <nl> < Dropdown isOpen = { dropdownOpen } toggle = { toggle } > <nl> < DropdownToggle <nl> tag = " span " <nl> - onClick = { toggle } <nl> data - toggle = " dropdown " <nl> aria - expanded = { dropdownOpen } <nl> > <nl> 
mmm a / docs / lib / examples / InputGroupOverview . js <nl> ppp b / docs / lib / examples / InputGroupOverview . js <nl> return ( <nl> < div > <nl> < InputGroup > <nl> - < InputGroupAddon addonType = " prepend " > @ < / InputGroupAddon > <nl> + < InputGroupAddon addonType = " prepend " > <nl> + < InputGroupText > @ < / InputGroupText > <nl> + < / InputGroupAddon > <nl> < Input placeholder = " username " / > <nl> < / InputGroup > <nl> < br / > <nl> 
mmm a / scripts / docs <nl> ppp b / scripts / docs <nl> echo - e " \ 033 [ 31 ; 1m $ 1  " <nl> } <nl> - if [ " $ TRAVIS_BRANCH " = = " master " ] & & [ " $ TRAVIS_PULL_REQUEST " = = " false " ] ; then <nl> + if [ " $ TRAVIS_BRANCH " = = " $ TRAVIS_TAG " ] & & [ " $ TRAVIS_PULL_REQUEST " = = " false " ] ; then <nl> echo " Deploying documentation " <nl> else <nl> success " Not building master branch . Skipping deploy . " <nl> 
mmm a / docs / lib / examples / FormGrid . js <nl> ppp b / docs / lib / examples / FormGrid . js <nl> < FormGroup row > <nl> < Label for = " exampleSelect " sm = { 2 } > Select < / Label > <nl> < Col sm = { 10 } > <nl> - < Input type = " select " name = " select " id = " exampleSelect " / > <nl> + < Input type = " select " name = " select " id = " exampleSelect " > <nl> + < option > 1 < / option > <nl> + < option > 2 < / option > <nl> + < option > 3 < / option > <nl> + < option > 4 < / option > <nl> + < option > 5 < / option > <nl> + < / Input > <nl> < / Col > <nl> < / FormGroup > <nl> < FormGroup row > <nl> < Label for = " exampleSelectMulti " sm = { 2 } > Select Multiple < / Label > <nl> < Col sm = { 10 } > <nl> - < Input type = " select " name = " selectMulti " id = " exampleSelectMulti " multiple / > <nl> + < Input type = " select " name = " selectMulti " id = " exampleSelectMulti " multiple > <nl> + < option > 1 < / option > <nl> + < option > 2 < / option > <nl> + < option > 3 < / option > <nl> + < option > 4 < / option > <nl> + < option > 5 < / option > <nl> + < / Input > <nl> < / Col > <nl> < / FormGroup > <nl> < FormGroup row > <nl> 
mmm a / docs / lib / Components / DropdownsPage . js <nl> ppp b / docs / lib / Components / DropdownsPage . js <nl> styles : { <nl> . . . data . styles , <nl> overflow : ' auto ' , <nl> - maxHeight : 100 , <nl> + maxHeight : ' 100px ' , <nl> } , <nl> } ; <nl> } , <nl> 
mmm a / docs / lib / Components / TooltipsPage . js <nl> ppp b / docs / lib / Components / TooltipsPage . js <nl> ] ) . isRequired , <nl> / / Where to inject the popper DOM node , default to body <nl> container : PropTypes . oneOfType ( [ PropTypes . string , PropTypes . func , DOMElement ] ) , <nl> - / / optionally override show / hide delays - default { show : 0 , hide : 250 } <nl> + / / optionally override show / hide delays - default { show : 0 , hide : 50 } <nl> delay : PropTypes . oneOfType ( [ <nl> PropTypes . shape ( { show : PropTypes . number , hide : PropTypes . number } ) , <nl> PropTypes . number <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Install reactstrap and Bootstrap from NPM . Reactstrap does not include Bootstrap CSS so this needs to be installed as well : <nl> ` ` ` <nl> - npm install - - save bootstrap <nl> - npm install - - save reactstrap react react - dom <nl> + npm i bootstrap <nl> + npm i reactstrap react react - dom <nl> ` ` ` <nl> Import Bootstrap CSS in the ` ` ` src / index . js ` ` ` file : <nl> 
mmm a / docs / lib / Components / ButtonDropdownPage . js <nl> ppp b / docs / lib / Components / ButtonDropdownPage . js <nl> < PrismCode className = " language - jsx " > <nl> { ` < ButtonDropdown isOpen = { isOpen } toggle = { toggle } > <nl> < Button id = " caret " color = " primary " > { this . props . text } < / Button > <nl> - < DropdownToggle caret color = " primary " / > <nl> + < DropdownToggle split color = " primary " / > <nl> < DropdownMenu > <nl> < DropdownItem header > Header < / DropdownItem > <nl> < DropdownItem disabled > Action < / DropdownItem > <nl> 
mmm a / docs / lib / Components / CollapsePage . js <nl> ppp b / docs / lib / Components / CollapsePage . js <nl> wanted without the need to manage / control the state of the component . { ' ' } <nl> < code > UncontrolledCollapse < / code > does not require an < code > isOpen < / code > prop . Instead <nl> pass a < code > toggler < / code > prop . The < code > toggler < / code > prop is a string which will run <nl> - querySelectorAll to find dom elements which will trigger toggle . <nl> + querySelectorAll to find dom elements which will trigger toggle . The < code > defaultOpen < / code > <nl> + prop controls the initial state . <nl> < / p > <nl> < div className = " docs - example " > <nl> < UncontrolledCollapseExample / > <nl> 
mmm a / docs / lib / Components / DropdownsPage . js <nl> ppp b / docs / lib / Components / DropdownsPage . js <nl> < PrismCode className = " language - jsx " > <nl> { ` Dropdown . propTypes = { <nl> a11y : PropTypes . bool , / / defaults to true . Set to false to enable more bootstrap like tabbing behavior <nl> + className : PropTypes . string , <nl> disabled : PropTypes . bool , <nl> direction : PropTypes . oneOf ( [ ' up ' , ' down ' , ' left ' , ' right ' ] ) , <nl> group : PropTypes . bool , <nl> 
mmm a / docs / lib / examples / InlineCheckboxes . js <nl> ppp b / docs / lib / examples / InlineCheckboxes . js <nl> return ( <nl> < Form > <nl> < FormGroup check inline > <nl> - < Label check > <nl> - < Input type = " checkbox " / > Some input <nl> + < Input id = " InlineCheckboxes - checkbox - 1 " type = " checkbox " / > <nl> + < Label for = " InlineCheckboxes - checkbox - 1 " check > <nl> + Some input <nl> < / Label > <nl> < / FormGroup > <nl> < FormGroup check inline > <nl> - < Label check > <nl> - < Input type = " checkbox " / > Some other input <nl> + < Input id = " InlineCheckboxes - checkbox - 2 " type = " checkbox " / > <nl> + < Label for = " InlineCheckboxes - checkbox - 2 " check > <nl> + Some other input <nl> < / Label > <nl> < / FormGroup > <nl> < / Form > <nl> @ @ - 19 , 4 + 21 , 3 @ @ const Example = ( props ) = > { <nl> } <nl> export default Example ; <nl> - <nl> \ No newline at end of file <nl> 
mmm a / stories / examples / Alert / Alert . js <nl> ppp b / stories / examples / Alert / Alert . js <nl> import { colors } from ' . . / options ' ; <nl> function Example ( args ) { <nl> - return < Alert { . . . args } dismiss = { ( ) = > { } } isOpen / > ; <nl> + return < Alert { . . . args } isOpen / > ; <nl> } <nl> Example . args = { <nl> 
mmm a / stories / Index . stories . mdx <nl> ppp b / stories / Index . stories . mdx <nl> < / Modal > <nl> ` ` ` <nl> + <nl> + # # # # CSSModule <nl> + <nl> + You can use ` cssModule ` to change the underlying component ' s default CSS className . This is an escape hatch <nl> + if you do not want to use the default bootstrap class . <nl> + <nl> + For example Button renders with a default class ` . btn ` . You can use <nl> + <nl> + ` ` ` jsx <nl> + < Button color = " primary " cssModule = { { btn : ' hyperspeed - btn ' } } > <nl> + primary <nl> + < / Button > <nl> + ` ` ` <nl> + <nl> + so that Button renders with ` . hyperspeed - btn ` instead of ` . btn ` . <nl> + <nl> + You can use ` setGlobalCssModule ` function to set custom classes globally . <nl> + <nl> + ` ` ` jsx <nl> + import { Util } from ' reactstrap ' ; <nl> + <nl> + Util . setGlobalCssModule ( { <nl> + btn : ' hyperspeed - btn ' , <nl> + } ) ; <nl> + ` ` ` <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> + Make sure you have the newest versions of Nuxt and Firebase installed and setup in your project . <nl> + <nl> + ` ` ` bash <nl> + yarn add nuxt # OR npm i nuxt <nl> + yarn add firebase # OR npm i firebase <nl> + ` ` ` <nl> + <nl> Install the module via NPM or Yarn : <nl> ` ` ` bash <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> static : false , / / default <nl> preload : false , / / default <nl> chunkName : process . env . NODE_ENV ! = = ' production ' ? ' firebase - auth ' : ' [ id ] ' , / / default <nl> - enablePersistence : true <nl> + enablePersistence : true , <nl> + settings : { <nl> + / / Firestore Settings <nl> + } <nl> } <nl> ` ` ` <nl> + # # # # settings <nl> + <nl> + Adds settings to your Firebase initialization , e . g . ` host ` or ` ssl ` . <nl> + See more [ here ] ( https : / / firebase . google . com / docs / reference / js / firebase . firestore . Settings ) . <nl> + <nl> # # # # enablePersistence <nl> Enables persistence in web apps . <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> chunkName : process . env . NODE_ENV ! = = ' production ' ? ' firebase - auth ' : ' [ id ] ' , / / default <nl> enablePersistence : true , <nl> settings : { <nl> - / / Firestore Settings <nl> + / / Firestore Settings - currently only works in SPA mode <nl> } <nl> } <nl> ` ` ` <nl> @ @ - 249 , 6 + 249 , 11 @ @ firestore : { <nl> Adds settings to your Firebase initialization , e . g . ` host ` or ` ssl ` . <nl> See more [ here ] ( https : / / firebase . google . com / docs / reference / js / firebase . firestore . Settings ) . <nl> + : : : danger <nl> + There seems to be an issue when using settings ( ) in Universal mode ( see [ this issue ] ( https : / / github . com / firebase / firebase - js - sdk / issues / 2733 ) ) . Therefore , settings currently only work in SPA mode . <nl> + : : : <nl> + <nl> + <nl> # # # # enablePersistence <nl> Enables persistence in web apps . <nl> 
mmm a / docs / guide / getting - started / README . md <nl> ppp b / docs / guide / getting - started / README . md <nl> onFirebaseHosting : false , <nl> services : { <nl> auth : { <nl> + persistence : ' local ' , <nl> initialize : { <nl> onAuthStateChangedMutation : " SET_AUTH_USER " , <nl> onAuthStateChangedAction : null , <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> } <nl> ` ` ` <nl> - # # # # # Server side Firebase client SDK login < Badge text = " EXPERIMENTAL " type = " error " / > <nl> + # # # # # Server side Firebase client SDK login < Badge text = " EXPERIMENTAL " type = " warning " / > <nl> Once you have [ properly setup the admin sdk ] ( # firebase - admin - authorization ) you can enable server side login to use firebase services on the server , e . g . to perform store hydration on page load . <nl> @ @ - 316 , 6 + 316 , 32 @ @ auth : { <nl> } <nl> ` ` ` <nl> + : : : warning Session persistence <nl> + <nl> + Make sure to initialize the nuxt build outside of the server request callback for session management to work properly : <nl> + <nl> + ` ` ` js <nl> + import express from ' express ' <nl> + import { Nuxt } from ' nuxt ' <nl> + <nl> + const server = express ( ) <nl> + <nl> + / / do this outside of the server callback so the nuxt build is kept in memory <nl> + const nuxt = new Nuxt ( { <nl> + dev : false , <nl> + buildDir : ' . nuxt ' <nl> + } ) <nl> + <nl> + server . use ( async ( req , res , next ) = > { <nl> + / / this will resolve immediately after the first render <nl> + await nuxt . ready ( ) <nl> + <nl> + nuxt . render ( req , res , next ) <nl> + } ) <nl> + ` ` ` <nl> + <nl> + : : : <nl> + <nl> : : : danger Do not use this feature for high traffic sites <nl> This module provides this feature to facilitate data hydration in SSR calls . <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> } <nl> ` ` ` <nl> - : : : warning Session persistence <nl> + : : : warning Programmatic server implementation <nl> - Make sure to initialize the nuxt build outside of the server request callback for session management to work properly : <nl> + If you are using an external server implementation to start nuxt programmatically : <nl> + <nl> + - The ` @ nuxtjs / firebase ` module has to be included in your server package ( ` yarn add @ nuxtjs / firebase ` ) . <nl> + - Make sure to initialize the nuxt build outside of the server request callback for session management to work properly : <nl> ` ` ` js <nl> import express from ' express ' <nl> 
mmm a / docs / . vuepress / config . js <nl> ppp b / docs / . vuepress / config . js <nl> ] , <nl> theme : ' carbon ' , <nl> themeConfig : { <nl> + algolia : { <nl> + apiKey : ' 26073a7590724b3efc377b3b7608f3e0 ' , <nl> + indexName : ' nuxtjs_firebase ' <nl> + } , <nl> carbonAds : { <nl> serve : " CE7D62JL " , <nl> placement : " packagesdeveoio " <nl> 
mmm a / docs / guide / getting - started / README . md <nl> ppp b / docs / guide / getting - started / README . md <nl> ] , <nl> / / Experimental Feature , use with caution . <nl> serverLogin : { <nl> - sessionLifetime : 60 * 60 * 1000 / / one hour <nl> + sessionLifetime : 60 * 60 * 1000 , / / one hour <nl> + loginDelay : 50 / / minimal recommended delay <nl> } <nl> } <nl> } , <nl> 
mmm a / docs / guide / introduction / README . md <nl> ppp b / docs / guide / introduction / README . md <nl> # # Disclaimer <nl> - This module is meant for easy and quick set - up of Firebase in a Nuxt project . Due to the nature of this module , it is possibly not optimal for websites that need to be super performant and / or SEO friendly , since the module adds the Firebase services to the global scope . If you wan ' t your website to be more performant , you ' d probably be better off by importing the services only in the files where you need them ( i . e . by NOT using this module ) . That being said , the difference might be marginal depending on your project . <nl> + This module is meant for easy and quick set - up of Firebase in a Nuxt project . Due to the nature of this module , it is possibly not optimal for websites that need to be super performant and / or SEO friendly , since the module adds the Firebase services to the global scope . If you want your website to be more performant , you ' d probably be better off by importing the services only in the files where you need them ( i . e . by NOT using this module ) . That being said , the difference might be marginal depending on your project . <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> # # # analytics <nl> - Initializes Firebase Storage and makes it available via ` $ fireAnalytics ` and ` $ fireAnalyticsObj ` . <nl> + Initializes Firebase Analytics and makes it available via ` $ fireAnalytics ` and ` $ fireAnalyticsObj ` . <nl> - Type : ` Boolean ` or ` Object ` <nl> - Default : ` false ` <nl> @ @ - 567 , 7 + 567 , 7 @ @ analytics : true <nl> # # # remoteConfig <nl> - Initializes Firebase Storage and makes it available via ` $ fireConfig ` and ` $ fireConfigObj ` . <nl> + Initializes Firebase Remote Config and makes it available via ` $ fireConfig ` and ` $ fireConfigObj ` . <nl> - Type : ` Boolean ` or ` Object ` <nl> - Default : ` false ` <nl> 
mmm a / docs / tutorials / ssr / README . md <nl> ppp b / docs / tutorials / ssr / README . md <nl> - ` emailVerified ` : If the email was verified <nl> - ` displayName ` : The users display name <nl> - ` allClaims ` : All claims from the [ admin . auth . DecodedIdToken ] ( https : / / firebase . google . com / docs / reference / admin / node / admin . auth . DecodedIdToken ) <nl> + - ` idToken ` : The current idToken <nl> : : : <nl> @ @ - 121 , 16 + 122 , 17 @ @ The server user object is not a full ` firebase . User ` , since it is reproduced fro <nl> / / Store action called nuxtServerInit : <nl> async nuxtServerInit ( { dispatch , commit } , { res } ) { <nl> if ( res & & res . locals & & res . locals . user ) { <nl> - const { allClaims : claims , . . . authUser } = res . locals . user <nl> + const { allClaims : claims , idToken : token , . . . authUser } = res . locals . user <nl> await dispatch ( ' onAuthStateChangedAction ' , { <nl> authUser , <nl> - claims <nl> + claims , <nl> + token <nl> } ) <nl> / / or <nl> - commit ( ' ON_AUTH_STATE_CHANGED_MUTATION ' , { authUser , claims } ) <nl> + commit ( ' ON_AUTH_STATE_CHANGED_MUTATION ' , { authUser , claims , token } ) <nl> } <nl> } <nl> ` ` ` <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> Adds settings to your Firebase initialization , e . g . ` host ` or ` ssl ` . <nl> See more [ here ] ( https : / / firebase . google . com / docs / reference / js / firebase . firestore . Settings ) . <nl> - : : : danger <nl> - There seems to be an issue when using settings ( ) in Universal mode ( see [ this issue ] ( https : / / github . com / firebase / firebase - js - sdk / issues / 2733 ) ) . Therefore , settings currently only work in SPA mode . <nl> + : : : warning Important <nl> + When using settings ( ) in Universal mode ( see [ this issue ] ( https : / / github . com / nuxt - community / firebase - module / issues / 116 ) ) , you need to set ` runInNewContext ` to ` false ` in your nuxt . config . js like so : <nl> + <nl> + ` ` ` js <nl> + / / Add this to your nuxt . config . js <nl> + render : { <nl> + bundleRenderer : { <nl> + runInNewContext : false <nl> + } <nl> + } , <nl> + ` ` ` <nl> : : : <nl> # # # functions <nl> 
mmm a / docs / guide / options / README . md <nl> ppp b / docs / guide / options / README . md <nl> ` ` ` js <nl> analytics : true <nl> + <nl> + / / or <nl> + <nl> + messaging : { <nl> + collectionEnabled : true , / / default <nl> + } <nl> ` ` ` <nl> # # # # collectionEnabled <nl> 
mmm a / docs / components / global / experimental - alert . vue <nl> ppp b / docs / components / global / experimental - alert . vue <nl> - < div > <nl> - < div data - v - 70167bf8 = " " class = " bg - teal - 100 border - teal - 500 border - l - 4 p - 4 mb - 4 mt - 4 " > <nl> - < div class = " flex items - start " > <nl> - < div class = " flex - shrink - 0 " > <nl> - < svg class = " fill - current h - 6 w - 6 text - teal - 500 mt - px " xmlns = " http : / / www . w3 . org / 2000 / svg " viewBox = " 0 0 20 20 " > < path d = " M2 . 93 17 . 07A10 10 0 1 1 17 . 07 2 . 93 10 10 0 0 1 2 . 93 17 . 07zm12 . 73 - 1 . 41A8 8 0 1 0 4 . 34 4 . 34a8 8 0 0 0 11 . 32 11 . 32zM9 11V9h2v6H9v - 4zm0 - 6h2v2H9V5z " / > < / svg > <nl> - < / div > <nl> - < div class = " flex - grow ml - 2 overflow - auto alert - content " > <nl> + < alert type = " info " > <nl> < b > Experimental Feature : < / b > Can be buggy , do not use in production ! <nl> - < / div > <nl> - < / div > <nl> - < / div > <nl> - < / div > <nl> + < / alert > <nl> < / template > <nl> < script > <nl> 
mmm a / docs / content / en / index . md <nl> ppp b / docs / content / en / index . md <nl> # # How does it work ? <nl> The module adds a plugin to your Nuxt . js application that handles the initialization of each Firebase service ( Authentication , Firestore , etc . ) . It then injects these services into the global context which makes them easily available throughout your application . <nl> - <nl> - # # Disclaimer <nl> - <nl> - This module is meant for easy and quick set - up of Firebase in a Nuxt project . Due to the nature of this module , it is possibly not optimal for websites that need to be super performant and / or SEO friendly , since the module adds the Firebase services to the global scope . If you want your website to be more performant , you ' d probably be better off by importing the services only in the files where you need them ( i . e . by NOT using this module ) . That being said , the difference might be marginal depending on your project . <nl> 
mmm a / docs / content / settings . json <nl> ppp b / docs / content / settings . json <nl> } , <nl> " github " : " nuxt - community / firebase - module " , <nl> - " twitter " : " nuxt_js " <nl> + " twitter " : " nuxt_js " , <nl> + " algolia " : { <nl> + " apiKey " : " 26073a7590724b3efc377b3b7608f3e0 " , <nl> + " indexName " : " nuxtjs_firebase " , <nl> + " langAttribute " : " lang " <nl> + } <nl> } <nl> 
mmm a / docs / content / en / service - options / auth . md <nl> ppp b / docs / content / en / service - options / auth . md <nl> A tutorial on how to set this up can be found [ here ] ( / tutorials / ssr ) . <nl> + < alert type = " info " > <nl> + < p > < b > Please Note : < / b > < / p > <nl> + < p > This < u > does not authenticate the Firebase instance on the server < / u > . While you will be able to know if a user is logged in or not and have access to its simplified properties , you < u > won ' t be able to do authenticated calls < / u > on server - side . < / p > < br > <nl> + < p > This means that all calls on server - side ( e . g . fetching data via Firestore in fetch - hooks ) , which are protected by security rules , will still fail with < i > insufficient privileges . < / i > < / p > <nl> + < br > <nl> + < p > Reason for this is that the Firebase JS SDK is a client - side library that is not built for authenticating multiple users . See the < nuxt - link to = " / service - options / auth # serverlogin " > serverLogin < / nuxt - link > option for an < b > experimental < / b > approach to solve this issue . < / p > <nl> + < / alert > <nl> + <nl> # # # ignorePaths <nl> The service worker session automatically ignores external resources , static files and HMR calls . <nl> 
mmm a / docs / content / en / service - options / auth . md <nl> ppp b / docs / content / en / service - options / auth . md <nl> Just add a mutation / action to your vuex store ( [ as seen below ] ( # onauthstatechangedmutation ) ) that handles what to do with the authUser object ( e . g . save it to the state or get user data from FireStore ) and then define the name of the action / mutation in the ` firebase . services . auth . initialize ` configuration as above . <nl> + < alert type = " info " > You can also use namespaces for your store actions / mutations like so : ` onAuthStateChangedAction : ' namespaceName / actionName ' ` . < / alert > <nl> + <nl> When onAuthStateChanged ( ) gets triggered by Firebase , the defined mutation / action will be called with the ` authUser ` and ` claims ` attributes as [ as seen below ] ( # onauthstatechangedmutation ) <nl> To unsubscribe from the listener simply call the ` $ fireAuthUnsubscribe ( ) ` function which is provided as a [ combined inject ] ( https : / / nuxtjs . org / guide / plugins # combined - inject ) . <nl> 
mmm a / docs / content / en / community / faq . md <nl> ppp b / docs / content / en / community / faq . md <nl> category : Community <nl> - - - <nl> - No FAQ ' s yet . Create an [ issue ] ( https : / / github . com / nuxt - community / firebase - module / issues ) if you have a question and we might add it to the FAQ . <nl> \ No newline at end of file <nl> + Create an [ issue ] ( https : / / github . com / nuxt - community / firebase - module / issues ) if you have a question and we might add it to the FAQ . <nl> + <nl> + # # How to add Firebase Polyfills ? <nl> + <nl> + If you want to add Firebase polyfills , you need to ceate a plugin and import the required polyfills like so : <nl> + <nl> + 1 . Creating ` / plugins / polyfills . js ` containing : <nl> + ` ` ` js <nl> + / / Import all polyfills <nl> + import ' @ firebase / polyfill ' ; <nl> + <nl> + / / Import specific polyfills : <nl> + import ' @ firebase / polyfill / node_modules / core - js / features / object / values ' ; <nl> + ` ` ` <nl> + <nl> + 2 . Add to your nuxt . config . js : <nl> + <nl> + ` ` ` js <nl> + plugins : [ <nl> + { src : ' ~ plugins / polyfills ' , mode : ' client ' } , <nl> + ] , <nl> + ` ` ` <nl> + <nl> + > References : <nl> + > [ Issue # 292 ] ( https : / / github . com / nuxt - community / firebase - module / issues / 292 ) <nl> + > [ Stack Overflow Question ] ( https : / / stackoverflow . com / questions / 62308061 / nuxt - firebase - ie - 11 - object - doesnt - support - property - or - method - values / 64062207 # 64062207 ) <nl> + <nl> + <nl> + # # How to use this module in SSR mode together with Strapi ? <nl> + <nl> + For Strapi to work together with this module , you need to ignore the Strapi API routes by adding them to the [ ignorePaths ] ( https : / / firebase . nuxtjs . org / service - options / auth # ignorepaths ) config like so : <nl> + <nl> + ` ` ` js <nl> + auth : { <nl> + ssr : { <nl> + / / . . . <nl> + ignorePaths : [ ' / api / ' ] / / or / ^ api \ / / <nl> + } <nl> + } <nl> + ` ` ` <nl> + <nl> + > References : <nl> + > [ Issue # 292 ] ( https : / / github . com / nuxt - community / firebase - module / issues / 292 ) <nl> \ No newline at end of file <nl> 
mmm a / docs / content / en / community / migrate . md <nl> ppp b / docs / content / en / community / migrate . md <nl> The helper function ` movePluginBeforeAuthHelper ` has been removed . <nl> If you need to run certain plugins AFTER Firebase has been initialized but BEFORE the ` onAuthStateChanged ( ) ` listener is set up , you can now use the ` subscribeManually : true ` config and then manually subscribe the ` onAuthStateChanged ( ) ` listener after your other plugins are initialized , as described [ here ] ( / service - options / auth # subscribemanually ) . <nl> + <nl> + # # # 6 - Fixed ` defaultConfig ` option in RemoteConfig <nl> + <nl> + Before v7 . 0 . 0 , the [ defaultConfig ] ( / service - options / remote - config ) option did not work if implemented as documented and needed to be set as a child of the ` settings ` object . <nl> + <nl> + This has been fixed and the ` defaultConfig ` now needs to be defined as documented as a child of the ` remote - config ` object . <nl> + <nl> + See [ issue 281 ] ( https : / / github . com / nuxt - community / firebase - module / issues / 281 ) . <nl> \ No newline at end of file <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> + # # [ 7 . 0 . 0 ] ( https : / / github . com / nuxt - community / firebase - module / compare / v6 . 1 . 1 . . . v7 . 0 . 0 ) ( 2020 - 10 - 31 ) <nl> + <nl> + <nl> + # # # Features <nl> + <nl> + * * * analytics . issupported : * * added check whether browser supports Firebase Analytics before init ( [ 52ec6ef ] ( https : / / github . com / nuxt - community / firebase - module / commit / 52ec6efa6c1cfbd0ddaac4a73676f948da4d807e ) ) <nl> + * * * auth : * * added initialize . subscribeManually and removed " helper " function ( [ 91ad279 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 91ad2792f142f7fcf22f0775242dc7330e485230 ) ) <nl> + * * * firebase - v8 : * * updated code to work with Firebase v8 + ( [ 4ae48b5 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 4ae48b51bc35f007c89bcc46febeded30f288893 ) ) <nl> + * * * functions : * * added emulatorHost option to Firebase Functions ( [ 08db302 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 08db302013fdac1213e783f6cd860ca62cc15cbe ) ) <nl> + * add support for lazy service loading ( [ 4e96d28 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 4e96d28a43014c85a01a0c4c953f756bd2ec0812 ) ) <nl> + <nl> + <nl> + # # # Bug Fixes <nl> + <nl> + * * * analytics : * * Fixed service naming issue ( [ addd317 ] ( https : / / github . com / nuxt - community / firebase - module / commit / addd317c7abf4ea9d70bd17943411f11cdaefac4 ) ) <nl> + * * * auth : * * Fixed initialize ( [ c4b203d ] ( https : / / github . com / nuxt - community / firebase - module / commit / c4b203d5a6d1aea521e70097a47c1b104b02c044 ) ) <nl> + * * * auth - credential : * * fixed auth - credential import ( require ) ( [ faeed48 ] ( https : / / github . com / nuxt - community / firebase - module / commit / faeed4803908d7a262ac73759b1608ad91a6ef95 ) ) <nl> + * * * auth - serverlogin : * * fixed serverLogin issue ( ctx . res missing ) ( [ edd1a75 ] ( https : / / github . com / nuxt - community / firebase - module / commit / edd1a755401fcd25886644554325dcaf6778e89d ) ) <nl> + * * * fireObj : * * fireObj was not injected in non - lazy + non - legacy mode ( [ dc66991 ] ( https : / / github . com / nuxt - community / firebase - module / commit / dc6699171c1e35552f7a02f093adb4ac329b9f46 ) ) <nl> + * * * initauth : * * async import of initAuth within auth plugin ( [ 36eb8f4 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 36eb8f490797f9cc7a03216f18806c1a93cd8700 ) ) <nl> + * * * initAuth : * * Fixed mmissing options in initAuth & small lazy mode fix ( [ 8e54384 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 8e54384dd1109439a0c33f358b1c30a009a27002 ) ) <nl> + * * * legacymodeinfo : * * fixed error ' Cannot use ' in ' operator to search for ' legacyMode ' in undefined ' ( [ 0684e64 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 0684e64bb708a2b4fdee23b2c3a6d8f73f117a68 ) ) <nl> + * * * loggerinfo : * * added module name to legyMode info log because it ' s not clear on multi - line log ( [ cb85c29 ] ( https : / / github . com / nuxt - community / firebase - module / commit / cb85c291dec1508068b34b5d363bde601cdd1318 ) ) <nl> + * * * naming : * * Improved readability by consistanly naming services constants ( [ 0d62e76 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 0d62e7618df69bb63fca01b7f3a3a214ed32d280 ) ) <nl> + * * * netlify : * * updated netlify . toml ( [ 26f5aa9 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 26f5aa9aaa0ad1ff4dc6903178547acc1904097c ) ) <nl> + * * * packageejson : * * missing comma ( [ a6669fc ] ( https : / / github . com / nuxt - community / firebase - module / commit / a6669fc872751077b3b089648e76276ac20f1512 ) ) <nl> + * * * remoteconfig : * * fixed ' defaultConfig ' being child of ' settings ' instead of main obj ( [ 7e1020c ] ( https : / / github . com / nuxt - community / firebase - module / commit / 7e1020c3c024c2b938f8a339a38d700036f46605 ) ) <nl> + * * * static : * * fixed static = true also dynamically importing the modules ( [ cf61833 ] ( https : / / github . com / nuxt - community / firebase - module / commit / cf61833da715799cf88914d45b8eed62993d6933 ) ) <nl> + * * * ts : * * Added ready ( ) to $ fire and added missing ' storage ' ( [ bb78d3a ] ( https : / / github . com / nuxt - community / firebase - module / commit / bb78d3a6e3348430201a0c8cf5220b981e6603db ) ) <nl> + * * * ts : * * Fixed $ fire . database ( [ 6bd9df9 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 6bd9df9560436d3db59afaa8a88391a779024520 ) ) <nl> + * make initAuth work again ( [ db8a467 ] ( https : / / github . com / nuxt - community / firebase - module / commit / db8a467db2e865c4ea0c570cce276bf635400368 ) ) <nl> + * review comments ( [ f5265ae ] ( https : / / github . com / nuxt - community / firebase - module / commit / f5265aecf210978ce333d6bd7621676a4ad12719 ) ) <nl> + * use existing injection name ( [ a6971ac ] ( https : / / github . com / nuxt - community / firebase - module / commit / a6971acc0d440b3553975e40a09d819d0d8c1077 ) ) <nl> + * use service mapping ( [ 33489a1 ] ( https : / / github . com / nuxt - community / firebase - module / commit / 33489a17a1f35d95680f79ac98d31a16c1412df5 ) ) <nl> + * use service mapping ( [ bd16287 ] ( https : / / github . com / nuxt - community / firebase - module / commit / bd1628735f333b448562b9eda5cc5a9d3e9d9e06 ) ) <nl> + <nl> # # # [ 6 . 1 . 1 ] ( https : / / github . com / nuxt - community / firebase - module / compare / v6 . 1 . 0 . . . v6 . 1 . 1 ) ( 2020 - 07 - 25 ) <nl> 
mmm a / . gitignore <nl> ppp b / . gitignore <nl> * . swo <nl> - node_modules / <nl> - build / <nl> - . DS_Store / <nl> - / coverage <nl> - coverage . json <nl> + <nl> + # Logs <nl> + logs <nl> + * . log <nl> + <nl> + # Runtime data <nl> + pids <nl> + * . pid <nl> + * . seed <nl> allFiredEvents <nl> scTopics <nl> + <nl> + # Coverage directory used by tools like istanbul <nl> + coverage <nl> + coverage . json <nl> + <nl> + # node - waf configuration <nl> + . lock - wscript <nl> + <nl> + # Dependency directory <nl> + node_modules <nl> + <nl> + # Debug log from npm <nl> + npm - debug . log <nl> + <nl> + # local env variables <nl> + . env <nl> + <nl> + # truffle build directory <nl> + build / <nl> + <nl> + # lol macs <nl> + . DS_Store / <nl> 
mmm a / CONTRIBUTING . md <nl> ppp b / CONTRIBUTING . md <nl> git checkout - b remove / some - file <nl> ` ` ` <nl> + If your branch is planned to fix an open issue , postfix your branch name with the issue number like ` fix / some - bug - # 123 ` . <nl> + <nl> We expect pull requests to be rebased to the master branch before merging : <nl> ` ` ` sh <nl> git remote add zep git @ github . com : OpenZeppelin / zeppelin - solidity . git <nl> 
mmm a / app / mixins / parent - name . js <nl> ppp b / app / mixins / parent - name . js <nl> parentName : computed ( ' routeName ' , function ( ) { <nl> const routeName = this . get ( ' routeName ' ) ; <nl> const routes = routeName . split ( ' . ' ) ; <nl> - return routes . slice ( 0 , 2 ) . join ( ' . ' ) ; <nl> + return routes . slice ( 0 , 3 ) . join ( ' . ' ) ; <nl> } ) <nl> } ) ; <nl> 
mmm a / config / environment . js <nl> ppp b / config / environment . js <nl> module . exports = function ( environment ) { <nl> - let ALGOLIA_APP_ID = process . env . ALGOLIA_APP_ID | | ' BH4D9OD16A ' ; <nl> - let ALGOLIA_API_KEY = process . env . ALGOLIA_API_KEY | | ' 92d3556bc9a494d48e7054fbb4c4ce6f ' ; <nl> + let ALGOLIA_APP_ID = process . env . ALGOLIA_APP_ID | | ' N4SO04CV0R ' ; <nl> + let ALGOLIA_API_KEY = process . env . ALGOLIA_API_KEY | | ' 0b28a7a3adf986fa5d402567d9d8b850 ' ; <nl> let ENV = { <nl> modulePrefix : ' ember - api - docs ' , <nl> 
mmm a / config / environment . js <nl> ppp b / config / environment . js <nl> module . exports = function ( environment ) { <nl> - let ALGOLIA_APP_ID = process . env . ALGOLIA_APP_ID | | ' N4SO04CV0R ' ; <nl> - let ALGOLIA_API_KEY = process . env . ALGOLIA_API_KEY | | ' 0b28a7a3adf986fa5d402567d9d8b850 ' ; <nl> + let ALGOLIA_APP_ID = process . env . ALGOLIA_APP_ID | | ' Y1OMR4C7MF ' ; <nl> + let ALGOLIA_API_KEY = process . env . ALGOLIA_API_KEY | | ' c35425b69b31be1bb4786f0a72146306 ' ; <nl> let ENV = { <nl> modulePrefix : ' ember - api - docs ' , <nl> 
mmm a / lib / nodemon . js <nl> ppp b / lib / nodemon . js <nl> } ) ; <nl> / / echo out notices about running state <nl> - if ( config . options . stdin & & config . options . restartable ) { <nl> - / / allow nodemon to restart when the use types ' rs \ n ' <nl> - process . stdin . resume ( ) ; <nl> - process . stdin . setEncoding ( ' utf8 ' ) ; <nl> - process . stdin . on ( ' data ' , function ( data ) { <nl> - data = ( data + ' ' ) . trim ( ) . toLowerCase ( ) ; <nl> - <nl> - / / if the keys entered match the restartable value , then restart ! <nl> - if ( data = = = config . options . restartable ) { <nl> - bus . emit ( ' restart ' ) ; <nl> - } <nl> - } ) ; <nl> - } else if ( config . options . stdin ) { <nl> - / / if ' restartable ' is disabled ( via a nodemon . json ) <nl> - / / then it ' s possible we ' re being used with a REPL <nl> + if ( config . options . stdin ) { <nl> / / so let ' s make sure we don ' t eat the key presses <nl> / / but also , since we ' re wrapping , watch out for <nl> - / / special keys , like ctrl + c x 2 or ' . exit ' or ctrl + d <nl> + / / special keys , like ctrl + c x 2 or ' . exit ' or ctrl + d or ctrl + l <nl> var ctrlC = false ; <nl> var buffer = ' ' ; <nl> + const rs = config . options . restartable ; <nl> + process . stdin . setEncoding ( ' utf8 ' ) ; <nl> process . stdin . on ( ' data ' , function ( data ) { <nl> - buffer + = data ; <nl> data = data . toString ( ) ; <nl> - var chr = data . charCodeAt ( 0 ) ; <nl> + buffer + = data ; <nl> + const chr = data . charCodeAt ( 0 ) ; <nl> + <nl> + / / if restartable , echo back <nl> + if ( rs ) { <nl> + if ( chr = = = 13 ) { <nl> + process . stdout . write ( ' \ n ' ) ; <nl> + } <nl> + / / this prevents cursor keys from working . <nl> + process . stdout . write ( String . fromCharCode ( chr ) ) ; <nl> + } <nl> + <nl> if ( chr = = = 3 ) { <nl> - if ( ctrlC ) { <nl> - process . exit ( ) ; <nl> + / / if restartable , assume ctrl + c will break immediately <nl> + if ( ctrlC | | rs ) { <nl> + process . exit ( rs ? 1 : 0 ) ; <nl> } <nl> ctrlC = true ; <nl> - } else if ( buffer = = = ' . exit ' | | chr = = = 4 ) { <nl> + return ; <nl> + } else if ( buffer = = = ' . exit ' | | chr = = = 4 ) { / / ctrl + d <nl> process . exit ( ) ; <nl> - } else if ( ctrlC | | chr = = = 10 ) { <nl> - ctrlC = false ; <nl> + } else if ( chr = = = 13 | | chr = = = 10 ) { / / enter / carriage return <nl> + const input = buffer . toString ( ) . trim ( ) . toLowerCase ( ) ; <nl> + if ( input = = = rs ) { <nl> + bus . emit ( ' restart ' ) ; <nl> + } <nl> + buffer = ' ' ; <nl> + } else if ( chr = = = 12 ) { / / ctrl + l <nl> + console . clear ( ) ; <nl> buffer = ' ' ; <nl> } <nl> + ctrlC = false ; <nl> } ) ; <nl> + if ( process . stdin . setRawMode ) { <nl> process . stdin . setRawMode ( true ) ; <nl> } <nl> + } <nl> if ( config . options . restartable ) { <nl> utils . log . info ( ' to restart at any time , enter ` ' + <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> bus . stdout = child . stdout ; <nl> bus . stderr = child . stderr ; <nl> } <nl> + <nl> + if ( shouldFork ) { <nl> + child . on ( ' message ' , function ( message , sendHandle ) { <nl> + bus . emit ( ' message ' , message , sendHandle ) ; <nl> + } ) ; <nl> + } <nl> } <nl> bus . emit ( ' start ' ) ; <nl> 
mmm a / src / build . js <nl> ppp b / src / build . js <nl> import * as kl from ' kolorist ' ; <nl> import { bundleProd } from ' . / bundler . js ' ; <nl> import { bundleStats } from ' . / lib / output - utils . js ' ; <nl> @ @ - 11 , 6 + 12 , 8 @ @ import { setCwd } from ' . / plugins / npm - plugin / registry . js ' ; <nl> export default async function build ( options = { } ) { <nl> options . out = options . out | | ' dist ' ; <nl> + await fs . rmdir ( options . out , { recursive : true } ) ; <nl> + <nl> / / @ todo remove this hack once registry . js is instantiable <nl> setCwd ( options . cwd ) ; <nl> 
mmm a / packages / create - wmr / src / index . js <nl> ppp b / packages / create - wmr / src / index . js <nl> import kleur from ' kleur ' ; <nl> import pkgInstall from ' pkg - install ' ; <nl> const { getPackageManager , install } = pkgInstall ; <nl> - const { dim , bold , cyan } = kleur ; <nl> + const { dim , bold , cyan , red } = kleur ; <nl> sade ( ' create - wmr [ dir ] ' , true ) <nl> . option ( ' - - eslint ' , ' Set up the Preact ESLint configuration ( takes a lot longer ) ' , false ) <nl> + . option ( ' - - yarn ' , ' Set up WMR using Yarn instead of NPM as the package manager ' , false ) <nl> . describe ( ' Initialize a WMR project ' ) <nl> . example ( ' npm init wmr . / some - directory ' ) <nl> . action ( async ( dir , opts ) = > { <nl> @ @ - 32 , 14 + 33 , 18 @ @ sade ( ' create - wmr [ dir ] ' , true ) <nl> color : ' yellow ' , <nl> text : ' installing WMR . . . ' <nl> } ) . start ( ) ; <nl> + const packageManager = opts . yarn ? ' yarn ' : ' npm ' ; <nl> / / @ ts - ignore - next <nl> - await getPackageManager ( { prefer : ' npm ' , cwd , dev : true , verbose : false } ) ; <nl> - await install ( [ ' wmr ' , ' preact - iso ' ] , { cwd } ) ; <nl> + await getPackageManager ( { prefer : packageManager } ) . catch ( ( ) = > { <nl> + process . stderr . write ( ` \ n $ { red ( ` $ { packageManager } cannot be found ` ) } \ n ` ) ; <nl> + process . exit ( 1 ) ; <nl> + } ) ; <nl> + await install ( [ ' wmr ' , ' preact - iso ' ] , { prefer : packageManager , cwd } ) ; <nl> spinner . succeed ( ' installed WMR . ' ) ; <nl> if ( opts . eslint ) { <nl> spinner . start ( ' installing eslint configuration . . . ' ) ; <nl> - await install ( [ ' eslint ' , ' eslint - config - preact ' ] , { cwd } ) ; <nl> + await install ( [ ' eslint ' , ' eslint - config - preact ' ] , { prefer : packageManager , cwd } ) ; <nl> spinner . succeed ( ' installed eslint . ' ) ; <nl> } <nl> @ @ - 55 , 18 + 60 , 20 @ @ sade ( ' create - wmr [ dir ] ' , true ) <nl> } <nl> const result = ` <nl> Start the development server : <nl> - $ { dim ( ' $ ' ) } $ { cyan ( ' npm start ' ) } <nl> + $ { dim ( ' $ ' ) } $ { cyan ( ` $ { packageManager } start ` ) } <nl> Create a production build : <nl> - $ { dim ( ' $ ' ) } $ { cyan ( ' npm run build ' ) } <nl> + $ { dim ( ' $ ' ) } $ { cyan ( ` $ { packageManager = = = ' npm ' ? ' npm run ' : ' yarn ' } build ` ) } <nl> Serve the app in production mode : <nl> - $ { dim ( ' $ PORT = 8080 ' ) } $ { cyan ( ' npm run serve ' ) } <nl> + $ { dim ( ' $ PORT = 8080 ' ) } $ { cyan ( ` $ { packageManager = = = ' npm ' ? ' npm run ' : ' yarn ' } serve ` ) } <nl> ` ; <nl> console . log ( ' \ n ' + result . trim ( ) . replace ( / ^ \ t \ t \ t / gm , ' ' ) + ' \ n ' ) ; <nl> if ( ! opts . eslint ) { <nl> console . log ( <nl> - ` \ n $ { bold ( ' To enable ESLint : ' ) } ( optional ) \ n $ { dim ( ' $ ' ) } $ { cyan ( ' npm i eslint eslint - config - preact ' ) } \ n ` <nl> + ` \ n $ { bold ( ' To enable ESLint : ' ) } ( optional ) \ n $ { dim ( ' $ ' ) } $ { cyan ( <nl> + ` $ { packageManager = = = ' npm ' ? ' npm i ' : ' yarn add ' } eslint eslint - config - preact ` <nl> + ) } \ n ` <nl> ) ; <nl> } <nl> } ) <nl> 
mmm a / src / plugins / process - global - plugin . js <nl> ppp b / src / plugins / process - global - plugin . js <nl> * / <nl> export default function processGlobalPlugin ( { NODE_ENV = ' development ' , env = { } } = { } ) { <nl> - const processObj = ` { env : $ { JSON . stringify ( { . . . env , NODE_ENV } ) } } ` ; <nl> + const processObj = JSON . stringify ( { browser : true , env : { . . . env , NODE_ENV } } ) ; <nl> return { <nl> name : ' process - global ' , <nl> 
mmm a / packages / wmr / src / lib / acorn - traverse . js <nl> ppp b / packages / wmr / src / lib / acorn - traverse . js <nl> } <nl> return Array . prototype . push . call ( this , comment ) ; <nl> } ; <nl> + opts . allowAwaitOutsideFunction = true ; <nl> isInitialParse = false ; <nl> } <nl> return parse ( code , opts ) ; <nl> 
mmm a / src / features / dataset - controls / DatasetControls . js <nl> ppp b / src / features / dataset - controls / DatasetControls . js <nl> } <nl> onRefresh = ( ) = > { <nl> - console . log ( " On Refresh for " + this . props . uuid ) <nl> const url = this . state . selected . url ; <nl> const dataset = this . state . selected ; <nl> this . fetchAndSetDataset ( url , dataset , this . state . username , this . state . password , this . state . token ) ; <nl> 
mmm a / src / features / tooltip / Tooltip . js <nl> ppp b / src / features / tooltip / Tooltip . js <nl> constructor ( props ) { <nl> super ( props ) <nl> this . state = { <nl> - title : " Title " , <nl> label : " Labels " , <nl> height : " 200px " , <nl> width : " 300px " , <nl> position : [ 200 , 200 ] , <nl> + note : { <nl> + id : ' ' , <nl> note : { <nl> title : ' ' , <nl> labels : [ ] , <nl> @ @ - 26 , 21 + 27 , 32 @ @ class TooltipControls extends React . Component { <nl> } <nl> } <nl> } <nl> + } <nl> handleChangeTitle = ( event ) = > { <nl> var note = { . . . this . state . note } <nl> - note . title = event . target . value <nl> + note . note . title = event . target . value <nl> this . setState ( { note } ) ; <nl> } <nl> handleChangeContent = ( event ) = > { <nl> var note = { . . . this . state . note } <nl> - note . content = event . target . value <nl> + note . note . content = event . target . value <nl> this . setState ( { note } ) ; <nl> } <nl> - saveNote = ( ) = > { <nl> - console . log ( this . state . note ) <nl> + saveNote = async ( ) = > { <nl> + if ( typeof ( this . props . data . CRVIZ . _SEARCH_KEY ) ! = = ' undefined ' ) { <nl> + var note = { . . . this . state . note } <nl> + note . id = await this . props . data . CRVIZ . _SEARCH_KEY <nl> + this . setState ( { note } ) ; <nl> + <nl> + this . props . addNote ( this . state . note ) ; <nl> + console . log ( this . props . notes ) <nl> + } <nl> + else { <nl> + console . log ( ' else ' ) <nl> + } <nl> } <nl> componentDidUpdate ( prevProps ) { <nl> @ @ - 105 , 10 + 117 , 10 @ @ class TooltipControls extends React . Component { <nl> } <nl> < div > <nl> < div > <nl> - < b > < h1 > < input style = { inputStyle } type = " text " value = { this . state . note . title } onChange = { this . handleChangeTitle } placeholder = " Title " / > < / h1 > < / b > <nl> + < b > < h1 > < input style = { inputStyle } type = " text " value = { this . state . note . note . title } onChange = { this . handleChangeTitle } placeholder = " Title " / > < / h1 > < / b > <nl> < h6 > { this . state . label } < / h6 > <nl> < / div > <nl> - < p > < input style = { inputStyle } type = " text " value = { this . state . note . content } onChange = { this . handleChangeContent } placeholder = " Take a note . . . " / > < / p > <nl> + < p > < input style = { inputStyle } type = " text " value = { this . state . note . note . content } onChange = { this . handleChangeContent } placeholder = " Take a note . . . " / > < / p > <nl> < div > <nl> < FontAwesomeIcon style = { { margin : " 10px " } } icon = { faTags } / > <nl> < FontAwesomeIcon style = { { color : " # 47cf38 " , margin : " 10px " } } icon = { faSave } onClick = { this . saveNote } / > <nl> 
mmm a / packages / kiwi - core / src / Tooltip / index . js <nl> ppp b / packages / kiwi - core / src / Tooltip / index . js <nl> const cloned = cloneVNode ( children [ 0 ] , h ) <nl> if ( cloned . componentOptions ) { <nl> clone = h ( cloned . componentOptions . Ctor , { <nl> + . . . cloned . data , <nl> props : cloned . componentOptions . propsData , <nl> attrs : { <nl> id : ` __wrapper - $ { this . tooltipId } ` <nl> 
mmm a / src / App . vue <nl> ppp b / src / App . vue <nl> < div class = " wrapper " > <nl> - < Tooltip placement = " top " label = " Abort " > <nl> + < Tooltip hasArrow placement = " top " label = " Abort " > <nl> < Button m = " 3 " variant = " ghost " variant - color = " gray " > Cancel < / Button > <nl> < / Tooltip > <nl> 
mmm a / packages / kiwi - core / src / Menu / MenuOption . js <nl> ppp b / packages / kiwi - core / src / Menu / MenuOption . js <nl> if ( this . isDisabled ) return <nl> if ( [ ' Enter ' , ' ' ] . includes ( event . key ) ) { <nl> event . preventDefault ( ) <nl> - this . handleSelect ( ) <nl> + this . handleSelect ( event ) <nl> } <nl> this . $ emit ( ' keydown ' , event ) <nl> @ @ - 239 , 6 + 239 , 12 @ @ const MenuOptionGroup = { <nl> nativeOn : { <nl> click : ( event ) = > { <nl> this . handleChange ( cloned . componentOptions . propsData [ ' value ' ] ) <nl> + } , <nl> + keydown : ( event ) = > { <nl> + if ( [ ' Enter ' , ' ' ] . includes ( event . key ) ) { <nl> + event . preventDefault ( ) <nl> + this . handleChange ( cloned . componentOptions . propsData [ ' value ' ] ) <nl> + } <nl> } <nl> } <nl> } , cloned . componentOptions . children ) <nl> @ @ - 257 , 6 + 263 , 12 @ @ const MenuOptionGroup = { <nl> nativeOn : { <nl> click : ( event ) = > { <nl> this . handleChange ( cloned . componentOptions . propsData [ ' value ' ] ) <nl> + } , <nl> + keydown : ( event ) = > { <nl> + if ( [ ' Enter ' , ' ' ] . includes ( event . key ) ) { <nl> + event . preventDefault ( ) <nl> + this . handleChange ( cloned . componentOptions . propsData [ ' value ' ] ) <nl> + } <nl> } <nl> } <nl> } , cloned . componentOptions . children ) <nl> 
mmm a / packages / kiwi - core / src / Popover / index . js <nl> ppp b / packages / kiwi - core / src / Popover / index . js <nl> methods : { <nl> closePopover ( ) { <nl> this . _isOpen = false <nl> + this . $ emit ( ' close ' ) <nl> } , <nl> openPopover ( ) { <nl> this . _isOpen = true <nl> + this . $ emit ( ' open ' ) <nl> } , <nl> toggleOpen ( ) { <nl> this . _isOpen = ! this . _isOpen <nl> + this . $ emit ( ' toggle ' , this . _isOpen ) <nl> } , <nl> / * * <nl> * Sets the trigger node value to reactive context <nl> 
mmm a / stories / 50 - Slider . stories . js <nl> ppp b / stories / 50 - Slider . stories . js <nl> - import { Box , Slider , SliderTrack , SliderFilledTrack , SliderThumb } from ' . . / packages / kiwi - core / src ' <nl> + import { Box , Slider , SliderTrack , SliderFilledTrack , SliderThumb , Icon } from ' . . / packages / kiwi - core / src ' <nl> storiesOf ( ' UI | Slider ' , module ) <nl> . add ( ' Basic Usage ' , ( ) = > ( { <nl> @ @ - 14 , 3 + 14 , 17 @ @ storiesOf ( ' UI | Slider ' , module ) <nl> < / Box > <nl> ` <nl> } ) ) <nl> + . add ( ' Customized Slider ' , ( ) = > ( { <nl> + components : { Box , Icon , Slider , SliderTrack , SliderFilledTrack , SliderThumb } , <nl> + template : ` <nl> + < Box w = " 300px " > <nl> + < Slider : defaultValue = " 30 " > <nl> + < SliderTrack bg = " red . 100 " / > <nl> + < SliderFilledTrack bg = " tomato " / > <nl> + < SliderThumb p = " 3 " d = " flex " alignItems = " center " justifyContent = " center " > <nl> + < Icon name = " coffee " color = " tomato " / > <nl> + < / SliderThumb > <nl> + < / Slider > <nl> + < / Box > <nl> + ` <nl> + } ) ) <nl> 
mmm a / . storybook / config . js <nl> ppp b / . storybook / config . js <nl> components : { ThemeProvider , ColorModeProvider , CSSReset , Canvas } <nl> } ) ) ; <nl> - / / automatically import all files ending in * . stories . js <nl> - configure ( require . context ( ' . . / stories ' , true , / \ . stories \ . js $ / ) , module ) ; <nl> + <nl> + function loadStories ( ) { <nl> + const req = require . context ( ' . . / packages / kiwi - core / src ' , true , / \ . stories \ . ( js | mdx ) $ / ) ; <nl> + req . keys ( ) . forEach ( filename = > req ( filename ) ) ; <nl> + } <nl> + <nl> + configure ( loadStories , module ) ; <nl> 
mmm a / . storybook / config . js <nl> ppp b / . storybook / config . js <nl> addParameters ( { <nl> options : { <nl> - theme : storyBookTheme <nl> + theme : storyBookTheme , <nl> + storySort : ( a , b ) = > <nl> + a [ 1 ] . kind = = = b [ 1 ] . kind ? 0 : a [ 1 ] . id . localeCompare ( b [ 1 ] . id , undefined , { numeric : true } ) , <nl> } <nl> } ) <nl> 
mmm a / tests / test - utils / test - utils . js <nl> ppp b / tests / test - utils / test - utils . js <nl> const utils = render ( { . . . defaults , . . . component } , . . . rest ) <nl> return { <nl> . . . utils , <nl> - asFragment : ( ) = > { <nl> + asFragment : ( innerHTML = utils . container . innerHTML ) = > { <nl> if ( typeof document . createRange = = = ' function ' ) { <nl> return document <nl> . createRange ( ) <nl> - . createContextualFragment ( utils . container . innerHTML ) <nl> + . createContextualFragment ( innerHTML ) <nl> } <nl> const template = document . createElement ( ' template ' ) <nl> - template . innerHTML = utils . container . innerHTML <nl> + template . innerHTML = innerHTML <nl> return template . content <nl> } <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / Drawer / index . js <nl> ppp b / packages / chakra - ui - core / src / Drawer / index . js <nl> type : Function , <nl> default : ( ) = > null <nl> } , <nl> + closeOnEsc : { <nl> + type : Boolean , <nl> + default : true <nl> + } , <nl> isFullHeight : { <nl> type : Boolean , <nl> default : true <nl> @ @ - 55 , 6 + 59 , 7 @ @ const Drawer = { <nl> props : { <nl> isOpen : this . isOpen , <nl> onClose : this . onClose , <nl> + closeOnEsc : this . closeOnEsc , <nl> initialFocusRef : this . initialFocusRef , <nl> finalFocusRef : this . finalFocusRef , <nl> formatIds : ( id ) = > ( { <nl> 
mmm a / packages / chakra - ui - core / src / Drawer / Drawer . stories . js <nl> ppp b / packages / chakra - ui - core / src / Drawer / Drawer . stories . js <nl> + import { Fragment , Input , Button , Drawer , DrawerBody , DrawerFooter , DrawerHeader , DrawerOverlay , DrawerContent , DrawerCloseButton } from ' . . ' <nl> + <nl> + storiesOf ( ' UI | Drawer ' , module ) <nl> + . add ( ' Drawer ' , ( ) = > ( { <nl> + components : { Fragment , Input , Button , Drawer , DrawerBody , DrawerFooter , DrawerHeader , DrawerOverlay , DrawerContent , DrawerCloseButton } , <nl> + data : ( ) = > ( { isOpen : false } ) , <nl> + methods : { <nl> + close ( ) { <nl> + this . isOpen = false <nl> + } <nl> + } , <nl> + template : ` <nl> + < Fragment > <nl> + < Button ref = " btnRef " @ click = " isOpen = true " > Open Drawer < / Button > <nl> + <nl> + < Drawer : isOpen = " isOpen " placement = " right " : on - close = " close " : initialFocusRef = " ( ) = > $ refs . inputInsideModal " > <nl> + < DrawerOverlay / > <nl> + < DrawerContent > <nl> + < DrawerCloseButton / > <nl> + < DrawerHeader > Create your account < / DrawerHeader > <nl> + <nl> + < DrawerBody > <nl> + < Input ref = " inputInsideModal " placeholder = " Type here . . . " / > <nl> + < / DrawerBody > <nl> + <nl> + < DrawerFooter > <nl> + < Button variant = " outline " mr = " 3 " @ click = " isOpen = false " > Cancel < / Button > <nl> + < Button color = " blue " > Save < / Button > <nl> + < / DrawerFooter > <nl> + < / DrawerContent > <nl> + < / Drawer > <nl> + < / Fragment > <nl> + ` <nl> + } ) ) <nl> 
mmm a / tests / test - utils / test - utils . js <nl> ppp b / tests / test - utils / test - utils . js <nl> } <nl> } <nl> + export function waitMs ( ms = 0 ) { <nl> + return new Promise ( resolve = > setTimeout ( resolve , ms ) ) <nl> + } <nl> + <nl> export { default as userEvent } from ' @ testing - library / user - event ' <nl> export { fireEvent } from ' @ testing - library / vue ' <nl> export { <nl> 
mmm a / packages / chakra - ui - core / src / CAlertDialog / CAlertDialog . js <nl> ppp b / packages / chakra - ui - core / src / CAlertDialog / CAlertDialog . js <nl> + * Hey ! Welcome to @ chakra - ui / vue AlertDialog <nl> + * <nl> + * AlertDialog component is used interrupt the user with <nl> + * a mandatory confirmation or action . <nl> + * <nl> + * An alert dialog is a modal dialog that interrupts the user ' s <nl> + * workflow to communicate an important message and acquire a response . <nl> + * Examples include action confirmation prompts and error message confirmations . <nl> + * The ` alertdialog ` role enables assistive technologies and browsers to <nl> + * distinguish alert dialogs from other dialogs so they have the option <nl> + * of giving alert dialogs special treatment , such as playing a system alert sound . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / alertdialog <nl> + * @ see Source link to source <nl> + * @ see A11y https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CAlertDialog / accessibility . md <nl> + * @ see WAI - ARIA https : / / www . w3 . org / TR / wai - aria - practices - 1 . 2 / # alertdialog <nl> + * / <nl> + <nl> + <nl> + <nl> import baseProps from ' . . / config / props ' <nl> import { forwardProps , HTMLElement } from ' . . / utils ' <nl> 
mmm a / packages / chakra - ui - core / src / CAvatar / CAvatar . js <nl> ppp b / packages / chakra - ui - core / src / CAvatar / CAvatar . js <nl> borderColor : borderColorStyle [ this . colorMode ] , <nl> rounded : ' full ' , <nl> . . . forwardProps ( this . $ props ) <nl> - } , <nl> - attrs : { <nl> - ' data - chakra - component ' : ' CAvatarBadge ' <nl> } <nl> } ) <nl> } <nl> @ @ - 83 , 8 + 80 , 7 @ @ const CAvatarName = { <nl> . . . forwardProps ( this . $ props ) <nl> } , <nl> attrs : { <nl> - ' aria - label ' : this . name , <nl> - ' data - chakra - component ' : ' CAvatarName ' <nl> + ' aria - label ' : this . name <nl> } <nl> } , [ this . name & & getInitials ( this . name ) ] ) <nl> } <nl> @ @ - 107 , 9 + 103 , 6 @ @ const CDefaultAvatar = { <nl> lineHeight : ' 1rem ' , <nl> . . . forwardProps ( this . $ props ) <nl> } , <nl> - attrs : { <nl> - ' data - chakra - component ' : ' CDefaultAvatar ' <nl> - } , <nl> domProps : { <nl> innerHTML : ` <nl> < svg fill = " # fff " viewBox = " 0 0 128 128 " role = " img " > <nl> @ @ - 211 , 10 + 204 , 10 @ @ export const CAvatar = { <nl> w : ' 100 % ' , <nl> h : ' 100 % ' , <nl> rounded : ' full ' , <nl> - objectFit : ' cover ' <nl> + objectFit : ' cover ' , <nl> + alt : this . name <nl> } , <nl> attrs : { <nl> - alt : this . name , <nl> src : this . src <nl> } <nl> } ) <nl> @ @ - 225 , 16 + 218 , 11 @ @ export const CAvatar = { <nl> return h ( CAvatarName , { <nl> props : { <nl> name : this . name , <nl> - w : _size , <nl> - h : _size <nl> + size : _size <nl> } <nl> } ) <nl> } else { <nl> return h ( CDefaultAvatar , { <nl> - props : { <nl> - w : ' 100 % ' , <nl> - h : ' 100 % ' <nl> - } , <nl> attrs : { <nl> ' aria - label ' : this . name <nl> } <nl> @ @ - 243 , 20 + 231 , 12 @ @ export const CAvatar = { <nl> } <nl> } <nl> - const { size , . . . avatarStyles } = avatarStyleProps <nl> - <nl> return h ( CBox , { <nl> props : { <nl> fontSize : fontSize , <nl> lineHeight : _size , <nl> - verticalAlign : ' top ' , <nl> - w : size , <nl> - h : size , <nl> - . . . avatarStyles , <nl> + . . . avatarStyleProps , <nl> . . . forwardProps ( this . $ props ) <nl> - } , <nl> - attrs : { <nl> - ' data - chakra - component ' : ' CAvatar ' <nl> } <nl> } , [ <nl> renderChildren ( ) , <nl> 
mmm a / packages / chakra - ui - core / src / CBox / CBox . js <nl> ppp b / packages / chakra - ui - core / src / CBox / CBox . js <nl> + * Hey ! Welcome to @ chakra - ui / vue Box <nl> + * <nl> + * Box is the most abstract component on top of which all <nl> + * other @ chakra - ui / vue components are built . By default , it renders a ` div ` element <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / box <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CBox / CBox . js <nl> + * / <nl> import { css } from ' emotion ' <nl> import { background , border , color , borderRadius , flexbox , grid , layout , position , shadow , space , typography , compose } from ' styled - system ' <nl> @ @ - 62 , 6 + 71 , 13 @ @ export const systemProps = compose ( <nl> clamp <nl> ) <nl> + / * * <nl> + * CBox component <nl> + * <nl> + * Abstract component on top of which all other Chakra components are built . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / box <nl> + * / <nl> const CBox = { <nl> name : ' CBox ' , <nl> inject : [ ' $ chakraTheme ' ] , <nl> 
mmm a / packages / chakra - ui - core / src / CBreadcrumb / CBreadcrumb . js <nl> ppp b / packages / chakra - ui - core / src / CBreadcrumb / CBreadcrumb . js <nl> + * Hey ! Welcome to @ chakra - ui / vue Breadcrumb <nl> + * <nl> + * Breadcrumbs , or a breadcrumb navigation , can help to enhance <nl> + * how users navigate to previous page levels of a website , <nl> + * especially if that website has many pages or products . <nl> + * <nl> + * A breadcrumb trail consists of a list of links to the parent pages <nl> + * of the current page in hierarchical order . It helps users find their <nl> + * place within a website or web application . Breadcrumbs are often <nl> + * placed horizontally before a page ' s main content . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / breadcrumb <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CBreadcrumb / CBreadcrumb . js <nl> + * / <nl> + <nl> + <nl> import { baseProps } from ' . . / config / props ' <nl> import { forwardProps , cloneVNodeElement , cleanChildren } from ' . . / utils ' <nl> import CBox from ' . . / CBox ' <nl> import CLink from ' . . / CLink ' <nl> + / * * <nl> + * CBreadcrumbSeparator component <nl> + * <nl> + * The visual separator between each breadcrumb link <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / breadcrumb <nl> + * / <nl> const CBreadcrumbSeparator = { <nl> name : ' CBreadcrumbSeparator ' , <nl> props : { <nl> @ @ - 25 , 6 + 49 , 13 @ @ const CBreadcrumbSeparator = { <nl> } <nl> } <nl> + / * * <nl> + * Span component <nl> + * <nl> + * Wrapper for text breadcrumbs <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / breadcrumb <nl> + * / <nl> const Span = { <nl> name : ' Span ' , <nl> props : { <nl> @ @ - 40 , 6 + 71 , 13 @ @ const Span = { <nl> } <nl> } <nl> + / * * <nl> + * CBreadcrumbLink component <nl> + * <nl> + * The breadcrumb link <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / breadcrumb <nl> + * / <nl> const CBreadcrumbLink = { <nl> name : ' CBreadcrumbLink ' , <nl> props : { <nl> @ @ - 58 , 6 + 96 , 13 @ @ const CBreadcrumbLink = { <nl> } <nl> } <nl> + / * * <nl> + * CBreadcrumbItem component <nl> + * <nl> + * Individual breadcrumb element containing a link and a divider . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / breadcrumb <nl> + * / <nl> const CBreadcrumbItem = { <nl> name : ' BreadcrumbItem ' , <nl> props : { <nl> @ @ - 109 , 6 + 154 , 13 @ @ const CBreadcrumbItem = { <nl> } <nl> } <nl> + / * * <nl> + * CBreadcrumb component <nl> + * <nl> + * The wrapper container for all breadcrumbs <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / breadcrumb <nl> + * / <nl> const CBreadcrumb = { <nl> name : ' Breadcrumb ' , <nl> props : { <nl> 
mmm a / packages / chakra - ui - core / src / CBreadcrumb / CBreadcrumb . js <nl> ppp b / packages / chakra - ui - core / src / CBreadcrumb / CBreadcrumb . js <nl> * / <nl> - <nl> import { baseProps } from ' . . / config / props ' <nl> import { forwardProps , cloneVNodeElement , cleanChildren } from ' . . / utils ' <nl> 
mmm a / packages / chakra - ui - core / src / CCheckbox / CCheckbox . js <nl> ppp b / packages / chakra - ui - core / src / CCheckbox / CCheckbox . js <nl> + * Hey ! Welcome to @ chakra - ui / vue Checkbox <nl> + * <nl> + * CCheckbox component is used in forms when a user needs to select multiple values from several options . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / checkbox <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCheckbox / CCheckbox . js <nl> + * @ see A11y https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCheckbox / accessibility . md <nl> + * @ see WAI - ARIA https : / / www . w3 . org / TR / wai - aria - practices - 1 . 2 / # button <nl> + * / <nl> + <nl> import { StringNumber , StringArray } from ' . . / config / props / props . types ' <nl> import { baseProps } from ' . . / config ' <nl> import { useVariantColorWarning , useId } from ' . . / utils ' <nl> 
mmm a / packages / chakra - ui - core / src / CReset / CReset . js <nl> ppp b / packages / chakra - ui - core / src / CReset / CReset . js <nl> props : { <nl> config : Object <nl> } , <nl> - mounted ( ) { <nl> + created ( ) { <nl> const { color , bg , borderColor , placeholderColor } = this . styleConfig [ this . colorMode ] <nl> useTailwindPreflight ( this . theme ) <nl> injectGlobal ( { <nl> 
mmm a / packages / chakra - ui - core / src / CCircularProgress / tests / __snapshots__ / CCircularProgress . test . js . snap <nl> ppp b / packages / chakra - ui - core / src / CCircularProgress / tests / __snapshots__ / CCircularProgress . test . js . snap <nl> aria - valuemax = " 100 " <nl> aria - valuemin = " 0 " <nl> aria - valuenow = " 40 " <nl> - class = " css - xqz7ss " <nl> + class = " css - 12d21aj " <nl> data - chakra - component = " CBox " <nl> data - testid = " CircularProgress " <nl> role = " progressbar " <nl> @ @ - 27 , 7 + 27 , 7 @ @ exports [ ` should render correctly 1 ` ] = ` <nl> stroke - width = " 11 . 111111111111112 " <nl> / > <nl> < circle <nl> - class = " css - 1h10kks " <nl> + class = " css - 19r75gt " <nl> cx = " 111 . 11111111111111 " <nl> cy = " 111 . 11111111111111 " <nl> data - chakra - component = " CBox " <nl> 
mmm a / packages / chakra - ui - core / src / CControlBox / CControlBox . js <nl> ppp b / packages / chakra - ui - core / src / CControlBox / CControlBox . js <nl> * > For this component to work , it should have a sibling input and be contained in a label <nl> * <nl> - * @ see Docs https : / / vue . chakra - ui . com / closebutton <nl> - * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCloseButton / CCloseButton . js <nl> - * @ see A11y https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCloseButton / accessibility . md <nl> + * @ see Docs https : / / vue . chakra - ui . com / controlbox <nl> + * @ see Strategy https : / / dev . to / lkopacz / create - custom - keyboard - accessible - checkboxes - 2036 <nl> * / <nl> import { css } from ' emotion ' <nl> 
mmm a / packages / chakra - ui - core / src / CEditable / CEditable . js <nl> ppp b / packages / chakra - ui - core / src / CEditable / CEditable . js <nl> + * Hey ! Welcome to @ chakra - ui / vue Editable <nl> + * <nl> + * EditableText is used for inline renaming of some text . <nl> + * <nl> + * It appears as normal UI text but transforms into a text <nl> + * input field when the user clicks or focuses on it . <nl> + * <nl> + * The text input inherits all font styling from its parent , <nl> + * to make the edit and read view transition seamless . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / editable <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CEditable / CEditable . js <nl> + * / <nl> + <nl> import styleProps , { baseProps } from ' . . / config / props ' <nl> import { isDef , getElement , useId , forwardProps } from ' . . / utils ' <nl> @ @ - 15 , 6 + 30 , 14 @ @ const sharedEditableProps = { <nl> mx : ' - 3px ' <nl> } <nl> + / * * <nl> + * CEditable component <nl> + * <nl> + * The wrapper for ` CEditable ` components . It provides context and state for the Editable components . <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / editable <nl> + * / <nl> const CEditable = { <nl> name : ' CEditable ' , <nl> props : { <nl> @ @ - 165 , 7 + 188 , 10 @ @ const CEditable = { <nl> } , <nl> render ( h ) { <nl> return h ( CBox , { <nl> - props : forwardProps ( this . $ props ) <nl> + props : forwardProps ( this . $ props ) , <nl> + attrs : { <nl> + ' data - chakra - component ' : ' CEditable ' <nl> + } <nl> } , [ <nl> this . $ scopedSlots . default ( { <nl> isEditing : this . isEditing , <nl> @ @ - 177 , 6 + 203 , 14 @ @ const CEditable = { <nl> } <nl> } <nl> + / * * <nl> + * CEditablePreview component <nl> + * <nl> + * The read - only view of the component . <nl> + * <nl> + * @ extends CPseudoBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / editable <nl> + * / <nl> const CEditablePreview = { <nl> name : ' CEditablePreview ' , <nl> inject : [ ' $ EditableContext ' ] , <nl> @ @ - 218 , 7 + 252 , 8 @ @ const CEditablePreview = { <nl> } , <nl> attrs : { <nl> ' aria - disabled ' : isDisabled , <nl> - tabIndex : this . tabIndex <nl> + tabIndex : this . tabIndex , <nl> + ' data - chakra - component ' : ' CEditablePreview ' <nl> } , <nl> nativeOn : { <nl> focus : onRequestEdit <nl> @ @ - 227 , 6 + 262 , 14 @ @ const CEditablePreview = { <nl> } <nl> } <nl> + / * * <nl> + * CEditableInput component <nl> + * <nl> + * The edit view of the component . It shows when you click or focus on the text . <nl> + * <nl> + * @ extends CPseudoBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / editable <nl> + * / <nl> const CEditableInput = { <nl> name : ' CEditableInput ' , <nl> inject : [ ' $ EditableContext ' ] , <nl> @ @ - 285 , 7 + 328 , 8 @ @ const CEditableInput = { <nl> disabled : isDisabled , <nl> ' aria - disabled ' : isDisabled , <nl> value , <nl> - placeholder <nl> + placeholder , <nl> + ' data - chakra - component ' : ' CEditableInput ' <nl> } <nl> } , this . $ slots . default ) <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CInputElement / CInputElement . js <nl> ppp b / packages / chakra - ui - core / src / CInputElement / CInputElement . js <nl> + * Hey ! Welcome to @ chakra - ui / vue CInputElement <nl> + * <nl> + * InputElement allows addition of add an icon or button inside the input component <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / input <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CInputElement / CInputElement . js <nl> + * / <nl> + <nl> import { baseProps } from ' . . / config ' <nl> import { inputSizes } from ' . . / CInput / utils / input . styles ' <nl> import CBox from ' . . / CBox ' <nl> @ @ - 13 , 6 + 22 , 14 @ @ const props = { <nl> disablePointerEvents : Boolean <nl> } <nl> + / * * <nl> + * CInputElement component <nl> + * <nl> + * allows addition of an icon or button inside the input component <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / input <nl> + * / <nl> const CInputElement = { <nl> name : ' CInputElement ' , <nl> props , <nl> @ @ - 35 , 11 + 52 , 22 @ @ const CInputElement = { <nl> zIndex : 2 , <nl> . . . ( this . disablePointerEvents & & { pointerEvents : ' none ' } ) , <nl> . . . placementProp <nl> + } , <nl> + attrs : { <nl> + ' data - chakra - component ' : ' CInputElement ' <nl> } <nl> } , this . $ slots . default ) <nl> } <nl> } <nl> + / * * <nl> + * CInputLeftElement component <nl> + * <nl> + * allows addition of an icon or button inside left of the input component <nl> + * <nl> + * @ extends CInputElement <nl> + * @ see Docs https : / / vue . chakra - ui . com / input <nl> + * / <nl> const CInputLeftElement = { <nl> name : ' CInputLeftElement ' , <nl> props , <nl> @ @ - 48 , 11 + 76 , 22 @ @ const CInputLeftElement = { <nl> props : { <nl> . . . forwardProps ( this . $ props ) , <nl> placement : ' left ' <nl> + } , <nl> + attrs : { <nl> + ' data - chakra - component ' : ' CInputLeftElement ' <nl> } <nl> } , this . $ slots . default ) <nl> } <nl> } <nl> + / * * <nl> + * CInputRightElement component <nl> + * <nl> + * allows addition of an icon or button inside right of the input component <nl> + * <nl> + * @ extends CInputElement <nl> + * @ see Docs https : / / vue . chakra - ui . com / input <nl> + * / <nl> const CInputRightElement = { <nl> name : ' CInputRightElement ' , <nl> props , <nl> @ @ - 61 , 6 + 100 , 9 @ @ const CInputRightElement = { <nl> props : { <nl> . . . forwardProps ( this . $ props ) , <nl> placement : ' right ' <nl> + } , <nl> + attrs : { <nl> + ' data - chakra - component ' : ' CInputRightElement ' <nl> } <nl> } , this . $ slots . default ) <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> ppp b / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> + * Hey ! Welcome to @ chakra - ui / vue CInputGroup <nl> + * <nl> + * CInputGroup allows grouping of input elements <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / input <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> + * / <nl> + <nl> import { StringArray } from ' . . / config / props / props . types ' <nl> import { baseProps } from ' . . / config ' <nl> import { inputSizes } from ' . . / CInput / utils / input . styles ' <nl> - import CBox from ' . . / CBox ' <nl> import { cloneVNode , forwardProps , kebabify } from ' . . / utils ' <nl> + import CBox from ' . . / CBox ' <nl> + <nl> + / * * <nl> + * CInputElement component <nl> + * <nl> + * allows grouping of input elements <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / input <nl> + * / <nl> const CInputGroup = { <nl> name : ' CInputGroup ' , <nl> inject : [ ' $ chakraTheme ' ] , <nl> @ @ - 67 , 7 + 85 , 7 @ @ const CInputGroup = { <nl> position : ' relative ' <nl> } , <nl> attrs : { <nl> - ' data - chakra - input - group ' : ' ' <nl> + ' data - chakra - component ' : ' CInputGroup ' <nl> } <nl> } , clones ) <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CMenu / CMenu . js <nl> ppp b / packages / chakra - ui - core / src / CMenu / CMenu . js <nl> role : { <nl> type : String , <nl> default : ' menuitem ' <nl> + } , <nl> + as : { <nl> + type : [ String , Object ] , <nl> + default : ' button ' <nl> } <nl> } , <nl> computed : { <nl> @ @ - 466 , 7 + 470 , 7 @ @ const CMenuItem = { <nl> const { focusableItems , focusAtIndex , closeOnSelect , closeMenu } = this . context <nl> return h ( CPseudoBox , { <nl> props : { <nl> - as : ' button ' <nl> + as : this . as <nl> } , <nl> attrs : { <nl> display : ' flex ' , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " push " : " git add - A & & git commit - m \ " chore ( lerna ) : publishing package \ " & & lerna version - - conventional - commits " , <nl> " clean " : " lerna run clean " , <nl> - " storybook " : " STORYBOOK_VUE_DEV_TOOLS = 1 start - storybook - p 9000 " , <nl> + " storybook " : " cross - env STORYBOOK_VUE_DEV_TOOLS = 1 start - storybook - p 9000 " , <nl> " storybook : devtools " : " vue - devtools " , <nl> " build - storybook " : " build - storybook - - quiet " , <nl> " deploy - storybook " : " storybook - to - ghpages - - - - out = . out " , <nl> 
mmm a / packages / chakra - ui - core / src / CImage / CImage . js <nl> ppp b / packages / chakra - ui - core / src / CImage / CImage . js <nl> render ( h ) { <nl> let imageProps <nl> if ( this . ignoreFallback ) { <nl> - imageProps = { src : this . src } <nl> + imageProps = { src : this . src , srcset : this . srcset } <nl> } else { <nl> - imageProps = { src : this . hasLoaded ? this . src : this . fallbackSrc } <nl> + imageProps = { src : this . hasLoaded ? this . src : this . fallbackSrc , srcset : this . srcset } <nl> } <nl> return h ( CNoSsr , [ <nl> h ( ' img ' , { <nl> 
mmm a / packages / chakra - ui - core / types / index . d . ts <nl> ppp b / packages / chakra - ui - core / types / index . d . ts <nl> import useToast from " . . / src / CToast " <nl> import { ToastFactory } from ' . . / src / CToast / CToast ' <nl> + type ChakraIcons = { [ name : string ] : Icon } ; <nl> + <nl> declare module ' vue / types / vue ' { <nl> export interface Vue { <nl> $ toast : ToastFactory <nl> $ chakra : { <nl> theme : Theme <nl> - icons : { [ name : string ] : Icon } <nl> + icons : ChakraIcons <nl> + } <nl> + } <nl> + } <nl> + <nl> + declare module ' . . / src / CColorModeProvider ' { <nl> + export interface Provides { <nl> + $ chakraColorMode : ( ) = > ' light ' | ' dark ' <nl> + $ toggleColorMode : ( ) = > void <nl> + } <nl> } <nl> - chakraColorMode : string <nl> - chakraToggleColorMode : string <nl> + <nl> + declare module ' . . / src / CThemeProvider ' { <nl> + export interface Provides { <nl> + $ chakraTheme : Theme <nl> + $ chakraIcons : ChakraIcons <nl> + $ chakraColorMode : ( ) = > ' light ' <nl> } <nl> } <nl> + export { Provides as CColorModeProvides } from ' . . / src / CColorModeProvider ' <nl> + export { Provides as CThemeProvides } from ' . . / src / CThemeProvider ' <nl> + <nl> export const useToast : typeof useToast <nl> export const defaultTheme : Theme <nl> export * from ' . / component ' <nl> 
mmm a / packages / razzle / config / createConfig . js <nl> ppp b / packages / razzle / config / createConfig . js <nl> const portOffset = clientOnly ? 0 : 1 ; <nl> const devServerPort = <nl> + ( process . env . PORT_DEV & & parseInt ( process . env . PORT_DEV ) ) | | <nl> ( process . env . PORT & & parseInt ( process . env . PORT ) + portOffset ) | | <nl> 3000 + portOffset ; <nl> 
mmm a / packages / razzle / config / createConfig . js <nl> ppp b / packages / razzle / config / createConfig . js <nl> const WebpackBar = require ( ' webpackbar ' ) ; <nl> const ManifestPlugin = require ( ' webpack - manifest - plugin ' ) ; <nl> const modules = require ( ' . / modules ' ) ; <nl> - const postcssLoadConfig = require ( ' postcss - load - config ' ) <nl> + const postcssLoadConfig = require ( ' postcss - load - config ' ) ; <nl> const logger = require ( ' razzle - dev - utils / logger ' ) ; <nl> const defaultPostCssOptions = { <nl> @ @ - 36 , 13 + 36 , 13 @ @ const defaultPostCssOptions = { <nl> const hasPostCssConfig = ( ) = > { <nl> try { <nl> - return ! ! postcssLoadConfig . sync ( ) <nl> + return ! ! postcssLoadConfig . sync ( ) ; <nl> } catch ( _error ) { <nl> - return false <nl> - } <nl> + return false ; <nl> } <nl> + } ; <nl> - const postCssOptions = hasPostCssConfig ( ) ? undefined : defaultPostCssOptions <nl> + const postCssOptions = hasPostCssConfig ( ) ? undefined : defaultPostCssOptions ; <nl> const webpackDevClientEntry = require . resolve ( <nl> ' razzle - dev - utils / webpackHotDevClient ' <nl> @ @ - 58 , 12 + 58 , 12 @ @ module . exports = ( <nl> port = 3000 , <nl> modify = null , <nl> modifyBabelOptions = null , <nl> - experimental = { } <nl> + experimental = { } , <nl> } , <nl> webpackObject , <nl> clientOnly = false , <nl> paths , <nl> - plugins = [ ] , <nl> + plugins = [ ] <nl> ) = > { <nl> return new Promise ( async resolve = > { <nl> / / Define some useful shorthands . <nl> @ @ - 73 , 7 + 73 , 6 @ @ module . exports = ( <nl> const IS_DEV = env = = = ' dev ' ; <nl> process . env . NODE_ENV = IS_PROD ? ' production ' : ' development ' ; <nl> - <nl> const shouldUseReactRefresh = experimental . reactRefresh ? true : false ; <nl> / / First we check to see if the user has a custom . babelrc file , otherwise <nl> @ @ - 83 , 13 + 82 , 13 @ @ module . exports = ( <nl> babelrc : true , <nl> cacheDirectory : true , <nl> presets : [ ] , <nl> - plugins : [ ] <nl> + plugins : [ ] , <nl> } ; <nl> if ( ! hasBabelRc ) { <nl> mainBabelOptions . presets . push ( require . resolve ( ' . . / babel ' ) ) ; <nl> if ( IS_DEV & & IS_WEB & & shouldUseReactRefresh ) { <nl> - mainBabelOptions . plugins . push ( require . resolve ( ' react - refresh / babel ' ) ) <nl> + mainBabelOptions . plugins . push ( require . resolve ( ' react - refresh / babel ' ) ) ; <nl> } <nl> } <nl> @ @ - 102 , 7 + 101 , 11 @ @ module . exports = ( <nl> console . log ( ' Using . babelrc defined in your app root ' ) ; <nl> } <nl> - const dotenv = getClientEnv ( target , { clearConsole , host , port , shouldUseReactRefresh } , paths ) ; <nl> + const dotenv = getClientEnv ( <nl> + target , <nl> + { clearConsole , host , port , shouldUseReactRefresh } , <nl> + paths <nl> + ) ; <nl> const portOffset = clientOnly ? 0 : 1 ; <nl> @ @ - 138 , 13 + 141 , 16 @ @ module . exports = ( <nl> additionalModulePaths <nl> ) , <nl> extensions : [ ' . mjs ' , ' . js ' , ' . jsx ' , ' . json ' , ' . ts ' , ' . tsx ' ] , <nl> - alias : Object . assign ( { <nl> + alias : Object . assign ( <nl> + { <nl> / / This is required so symlinks work during development . <nl> ' webpack / hot / poll ' : require . resolve ( ' webpack / hot / poll ' ) , <nl> / / Support React Native Web <nl> / / https : / / www . smashingmagazine . com / 2016 / 08 / a - glimpse - into - the - future - with - react - native - for - web / <nl> ' react - native ' : ' react - native - web ' , <nl> - } , additionalAliases ) , <nl> + } , <nl> + additionalAliases <nl> + ) , <nl> } , <nl> resolveLoader : { <nl> modules : [ paths . appNodeModules , paths . ownNodeModules ] , <nl> @ @ - 168 , 8 + 174 , 8 @ @ module . exports = ( <nl> { <nl> loader : require . resolve ( ' babel - loader ' ) , <nl> options : babelOptions , <nl> - } <nl> - ] <nl> + } , <nl> + ] , <nl> } , <nl> { <nl> exclude : [ <nl> @ @ - 375 , 6 + 381 , 10 @ @ module . exports = ( <nl> ) <nl> . filter ( Boolean ) ; <nl> + const chunkIds = [ ] . concat ( <nl> + . . . ( entry . chunks | | [ ] ) . map ( chunk = > chunk . ids ) <nl> + ) ; <nl> + <nl> const cssFiles = files <nl> . map ( item = > ( item . indexOf ( ' . css ' ) ! = = - 1 ? item : null ) ) <nl> . filter ( Boolean ) ; <nl> @ @ - 389 , 6 + 399 , 7 @ @ module . exports = ( <nl> [ name ] : { <nl> css : cssFiles , <nl> js : jsFiles , <nl> + chunks : chunkIds , <nl> } , <nl> } <nl> : acc ; <nl> @ @ - 453 , 14 + 464 , 13 @ @ module . exports = ( <nl> / / set this true will break HtmlWebpackPlugin <nl> multiStep : ! clientOnly , <nl> } ) , <nl> - shouldUseReactRefresh ? <nl> - new ReactRefreshWebpackPlugin ( { <nl> + shouldUseReactRefresh <nl> + ? new ReactRefreshWebpackPlugin ( { <nl> overlay : { <nl> entry : webpackDevClientEntry , <nl> } , <nl> } ) <nl> - : null <nl> - , <nl> + : null , <nl> new webpack . DefinePlugin ( dotenv . stringified ) , <nl> ] . filter ( x = > x ) ; <nl> @ @ - 613 , 24 + 623 , 27 @ @ module . exports = ( <nl> ] ; <nl> } <nl> - <nl> for ( const [ plugin , options ] of plugins ) { <nl> / / Check if plugin is a function . <nl> / / If it is , call it on the configs we created . <nl> if ( typeof plugin = = = ' function ' ) { <nl> - config = await Promise . resolve ( runPlugin ( <nl> + config = await Promise . resolve ( <nl> + runPlugin ( <nl> plugin , <nl> config , <nl> { target , dev : IS_DEV } , <nl> webpackObject , <nl> options <nl> - ) ) ; <nl> + ) <nl> + ) ; <nl> } <nl> } <nl> / / Check if razzle . config . js has a modify function . <nl> / / If it does , call it on the configs we created . <nl> if ( modify ) { <nl> - config = await Promise . resolve ( modify ( config , { target , dev : IS_DEV } , webpackObject ) ) ; <nl> + config = await Promise . resolve ( <nl> + modify ( config , { target , dev : IS_DEV } , webpackObject ) <nl> + ) ; <nl> } <nl> resolve ( config ) ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> exclude : webpackOptions . fileLoaderExlude , <nl> loader : require . resolve ( ' file - loader ' ) , <nl> options : { <nl> - name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ hash : 8 ] . [ ext ] ` , <nl> + name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ contenthash : 8 ] . [ ext ] ` , <nl> emitFile : IS_WEB , <nl> } , <nl> } , <nl> @ @ - 544 , 7 + 544 , 7 @ @ module . exports = ( <nl> loader : require . resolve ( ' url - loader ' ) , <nl> options : { <nl> limit : 10000 , <nl> - name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ hash : 8 ] . [ ext ] ` , <nl> + name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ contenthash : 8 ] . [ ext ] ` , <nl> emitFile : IS_WEB , <nl> } , <nl> } , <nl> @ @ - 844 , 8 + 844 , 8 @ @ module . exports = ( <nl> config . output = { <nl> path : paths . appBuildPublic , <nl> publicPath : dotenv . raw . PUBLIC_PATH | | ' / ' , <nl> - filename : ` $ { razzleOptions . jsPrefix } / bundle . [ chunkhash : 8 ] . js ` , <nl> - chunkFilename : ` $ { razzleOptions . jsPrefix } / [ name ] . [ chunkhash : 8 ] . chunk . js ` , <nl> + filename : ` $ { razzleOptions . jsPrefix } / bundle . [ contenthash : 8 ] . js ` , <nl> + chunkFilename : ` $ { razzleOptions . jsPrefix } / [ name ] . [ contenthash : 8 ] . chunk . js ` , <nl> libraryTarget : ' var ' , <nl> } ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> path : paths . appBuild , <nl> filename : ' assets . json ' , <nl> } ) , <nl> + / / Output all files in a manifest file called assets - manifest . json <nl> + / / in the build directory . <nl> + new ManifestPlugin ( { <nl> + fileName : path . join ( paths . appBuild , ' assets - manifest . json ' ) , <nl> + writeToFileEmit : true , <nl> + generate : ( seed , files ) = > { <nl> + const entrypoints = new Set ( ) ; <nl> + const noChunkFiles = new Set ( ) ; <nl> + files . forEach ( file = > { <nl> + if ( file . isChunk ) { <nl> + const groups = ( ( file . chunk | | { } ) . _groups | | [ ] ) <nl> + . forEach ( group = > entrypoints . add ( group ) ) ; <nl> + } else { <nl> + noChunkFiles . add ( file ) ; <nl> + } <nl> + } ) ; <nl> + const entries = [ . . . entrypoints ] ; <nl> + const entryArrayManifest = entries . reduce ( ( acc , entry ) = > { <nl> + const name = <nl> + ( entry . options | | { } ) . name | | <nl> + ( entry . runtimeChunk | | { } ) . name | | <nl> + entry . id ; <nl> + const files = [ ] <nl> + . concat ( <nl> + . . . ( entry . chunks | | [ ] ) . map ( chunk = > <nl> + chunk . files . map ( path = > config . output . publicPath + path ) <nl> + ) <nl> + ) <nl> + . filter ( Boolean ) ; <nl> + <nl> + const filesByType = files . reduce ( ( types , file ) = > { <nl> + const fileType = file . slice ( file . lastIndexOf ( ' . ' ) + 1 ) ; <nl> + types [ fileType ] = types [ fileType ] | | [ ] ; <nl> + types [ fileType ] . push ( file ) <nl> + return types ; <nl> + } , { } ) ; <nl> + <nl> + return name <nl> + ? { <nl> + . . . acc , <nl> + [ name ] : filesByType , <nl> + } <nl> + : acc ; <nl> + } , seed ) ; <nl> + entryArrayManifest [ ' noentry ' ] = [ . . . noChunkFiles ] . map ( file = > file . path ) . reduce ( ( types , file ) = > { <nl> + const fileType = file . slice ( file . lastIndexOf ( ' . ' ) + 1 ) ; <nl> + types [ fileType ] = types [ fileType ] | | [ ] ; <nl> + types [ fileType ] . push ( file ) <nl> + return types ; <nl> + } , { } ) ; <nl> + return entryArrayManifest ; <nl> + } , <nl> + } ) , <nl> / / Output our JS and CSS files in a manifest file called chunks . json <nl> / / in the build directory . <nl> / / based on https : / / github . com / danethurber / webpack - manifest - plugin / issues / 181 # issuecomment - 467907737 <nl> 
mmm a / test / fixtures / util . js <nl> ppp b / test / fixtures / util . js <nl> const path = require ( ' path ' ) ; <nl> - const rootDir = process . cwd ( ) ; <nl> + const glob = require ( ' glob ' ) ; <nl> + <nl> + const rootDir = path . join ( path . resolve ( __dirname ) , ' . . ' , ' . . ' ) ; <nl> + <nl> const fs = require ( ' fs - extra ' ) ; <nl> const silent = true ; <nl> + const getWorkspaceDirs = ( absolute = false ) = > { <nl> + const rootJson = JSON . parse ( fs . readFileSync ( path . join ( rootDir , ' package . json ' ) ) ) ; <nl> + const workspaceDirs = rootJson . workspaces . map ( item = > <nl> + glob . sync ( item , { cwd : rootDir , absolute : absolute } ) <nl> + ) . flat ( ) ; <nl> + return workspaceDirs ; <nl> + } ; <nl> + <nl> + const getWorkspacePackages = ( ) = > { <nl> + const packages = getWorkspaceDirs ( true ) <nl> + . map ( item = > JSON . parse ( fs . readFileSync ( path . join ( item , ' package . json ' ) ) ) . name ) ; <nl> + return packages ; <nl> + } ; <nl> + <nl> + const removeWorkspacePackages = ( fromPath ) = > { <nl> + const stagePath = fromPath | | process . cwd ( ) ; <nl> + const workspacePackages = getWorkspacePackages ( ) ; <nl> + const packageJson = path . join ( stagePath , ' package . json ' ) ; <nl> + <nl> + if ( fs . existsSync ( packageJson ) ) { <nl> + const packageJsonData = JSON . parse ( fs . readFileSync ( packageJson ) ) ; <nl> + <nl> + const newPackageJsonData = [ " dependencies " , " devDependencies " ] . reduce ( ( acc , depType ) = > { <nl> + if ( acc [ depType ] ) { <nl> + acc [ depType ] = Object . keys ( acc [ depType ] ) . reduce ( ( depsAcc , dep ) = > { <nl> + if ( workspacePackages . includes ( dep ) ) { <nl> + delete depsAcc [ dep ] ; <nl> + } <nl> + return depsAcc ; <nl> + } , acc [ depType ] ) ; <nl> + } <nl> + return acc ; <nl> + } , packageJsonData ) ; <nl> + <nl> + return fs . writeFileSync ( packageJson , JSON . stringify ( newPackageJsonData , null , ' ' ) ) ; <nl> + } <nl> + } ; <nl> + <nl> + const copyExample = ( exampleName , stageName ) = > { <nl> + const stagePath = path . join ( process . cwd ( ) , stageName ) ; <nl> + fs . copySync ( path . join ( rootDir , ' examples ' , exampleName ) , stagePath ) ; <nl> + return stagePath ; <nl> + } ; <nl> + <nl> + const yalcPublishAll = ( ) = > { <nl> + return getWorkspaceDirs ( ) . map ( dir = > shell . exec ( ` yalc publish $ { dir } ` ) ) <nl> + } ; <nl> + <nl> + const yalcAddAll = ( ) = > { <nl> + return getWorkspacePackages ( ) . map ( pkg = > shell . exec ( ` yalc add $ { pkg } ` ) ) <nl> + } ; <nl> + <nl> module . exports = { <nl> + getWorkspaceDirs : getWorkspaceDirs , <nl> + <nl> + getWorkspacePackages : getWorkspacePackages , <nl> + <nl> + removeWorkspacePackages : removeWorkspacePackages , <nl> + <nl> + yalcPublishAll : yalcPublishAll , <nl> + <nl> + yalcAddAll : yalcAddAll , <nl> + <nl> + yalcSetupStageWithExample : ( <nl> + stageName , <nl> + exampleName <nl> + ) = > { <nl> + <nl> + let silentState = shell . config . silent ; / / save old silent state <nl> + let verboseState = shell . config . verbose ; / / save old silent state <nl> + <nl> + shell . config . verbose = ! silent ; <nl> + shell . config . silent = silent ; <nl> + <nl> + const stagePath = copyExample ( exampleName , stageName ) ; <nl> + removeWorkspacePackages ( stagePath ) ; <nl> + <nl> + shell . cd ( stagePath ) ; <nl> + <nl> + shell . exec ( " yarn install " , { env : Object . assign ( process . env , { NODE_ENV : " development " } ) } ) ; <nl> + <nl> + yalcAddAll ( ) ; <nl> + <nl> + shell . config . verbose = verboseState ; <nl> + shell . config . silent = silentState ; <nl> + <nl> + return stagePath ; <nl> + } , <nl> + <nl> + copyExample : copyExample , <nl> + <nl> setupStage : ( stageName ) = > { <nl> const stagePath = path . join ( rootDir , stageName ) ; <nl> fs . ensureDirSync ( stagePath ) ; <nl> @ @ - 39 , 7 + 132 , 7 @ @ module . exports = { <nl> install = false , <nl> test = false <nl> ) = > { <nl> - const stagePath = path . join ( rootDir , stageName ) ; <nl> + const stagePath = path . join ( process . cwd ( ) , stageName ) ; <nl> const packagesPath = path . join ( rootDir , ' packages ' ) ; <nl> let silentState = shell . config . silent ; / / save old silent state <nl> @ @ - 48 , 10 + 141 , 11 @ @ module . exports = { <nl> shell . config . verbose = ! silent ; <nl> shell . config . silent = silent ; <nl> - fs . copySync ( path . join ( rootDir , ' examples ' , exampleName ) , stagePath ) ; <nl> + copyExample ( exampleName , stageName ) ; <nl> + <nl> shell . cd ( stagePath ) ; <nl> if ( install ) { <nl> - shell . exec ( " NODE_ENV = development yarn install " ) ; <nl> + shell . exec ( " yarn install " , { env : Object . assign ( process . env , { NODE_ENV : " development " } ) } ) ; <nl> } <nl> if ( symlink ) { <nl> fs . ensureSymlinkSync ( <nl> @ @ - 76 , 7 + 170 , 7 @ @ module . exports = { <nl> } <nl> } <nl> if ( test ) { <nl> - shell . exec ( " CI = true yarn run test " ) ; <nl> + shell . exec ( " yarn run test " , { env : Object . assign ( process . env , { CI : " true " } ) } ) ; <nl> } <nl> shell . config . verbose = verboseState ; <nl> 
mmm a / website / pages / docs / single - page - applications . md <nl> ppp b / website / pages / docs / single - page - applications . md <nl> + # Single Page Applications <nl> In addition to universal / isomorphic applications , Razzle can build single page ( or client - only ) applications . To do this , remove ` index . js ` and ` server . js ` from the src folder , and create an ` index . html ` file inside the public folder with the following template : <nl> - ` ` ` <nl> + ` ` ` html <nl> < ! DOCTYPE html > <nl> < html lang = " en " > <nl> < head > <nl> 
mmm a / website / pages / static - export . mdx <nl> ppp b / website / pages / static - export . mdx <nl> # # # # render ( ) <nl> behind the scenes razzle calls ` render ` function that exposed from ` static_export ` module and saves ` html ` string that you pass to ` res . json ( ) ` into a html file . for ` req ` object there is only one property that is ` url ` which contains the url that we are going to render and save it ' s result to the html file . <nl> + html file destination is relative to the ` req . url ` , for example if the url is ` / product / A ` html is going to get saved at ` / build / product / A / index . html ` . <nl> + <nl> + you should call ` renderToString ( ) ` ( or what ever your framework gives you to do SSR ) in this function send resonse to ` res . json ( ) ` <nl> + <nl> + ` ` ` js <nl> + export const render = ( req , res ) = > { <nl> + const html = ReactDOMServer . renderToString ( <nl> + < StaticRouter location = { req . url } > <nl> + < App / > <nl> + < / StaticRouter > <nl> + ) ; <nl> + <nl> + res . json ( { html } ) ; <nl> + } ; <nl> + ` ` ` <nl> + <nl> + ( you can re - export your ssr logic from server . js file and use it ` static_export ` ) <nl> # # # # routes ( ) <nl> you should also export a function called ` routes ` that returns an array of strings or a promise that will resolve array of strings . razzle will take the urls one by one and pass them one by one to ` render ` . <nl> + you should get all paths that your app has from your CMS in this method and return it at the end : <nl> - html file destination is relative to the ` req . url ` , for example if the url is ` / product / A ` html is going to get saved at ` / build / product / A / index . html ` . <nl> + ` ` ` js <nl> + export const routes = async ( ) = > { <nl> + / / data should be an array of strings [ " / " , " / product / A " , " / blog / 1 " , " / blog / 2 " ] <nl> + const { data } = await getAppPaths ( ) ; <nl> + return data ; <nl> + } ; <nl> + ` ` ` <nl> # # # # page data <nl> you may also need to save the data that your page uses to rehydrate the app on the client side . <nl> you can also pass the ` data ` along the ` html ` to ` res . json ( { html , data } ) ` and contents of data object will go inside the ` page - data . json ` file next to the html file . <nl> + ` ` ` js <nl> + export const render = async ( req , res ) = > { <nl> + const data = await getDataForRoute ( req . url ) ; <nl> + <nl> + const html = ReactDOMServer . renderToString ( <nl> + < StaticRouter location = { req . url } > <nl> + < App / > <nl> + < / StaticRouter > <nl> + ) ; <nl> + <nl> + res . json ( { html , data } ) ; <nl> + } ; <nl> + ` ` ` <nl> + <nl> + ( you should also change how your app fetches data on client - side , so it reads data from ` page - data . json ` ) <nl> + <nl> # # TypeScript Support <nl> Static export comes with typescript support out of the box , in order to use typescript rename ` static_export . js ` to ` static_export . ts ` and you are good to go ! <nl> 
mmm a / packages / razzle - plugin - eslint / index . js <nl> ppp b / packages / razzle - plugin - eslint / index . js <nl> config . module . rules = [ <nl> { <nl> - test : / \ . ( js | jsx | mjs ) $ / , <nl> + test : / \ . ( js | mjs | jsx | ts | tsx ) $ / , <nl> enforce : ' pre ' , <nl> loader : require . resolve ( ' eslint - loader ' ) , <nl> options : mainEslintOptions , <nl> 
mmm a / packages / razzle - plugin - eslint / index . js <nl> ppp b / packages / razzle - plugin - eslint / index . js <nl> const mainEslintOptions = { <nl> baseConfig : { <nl> extends : [ require . resolve ( ' eslint - config - react - app ' ) ] , <nl> - / / This setting can be removed once this commit is released : <nl> - / / https : / / github . com / facebook / create - react - app / commit / 005ee5b9525d476d2eb2dfb5b8afcd15b65dd5d2 <nl> - settings : { <nl> - react : { <nl> - version : ' detect ' , <nl> - } , <nl> - } , <nl> } , <nl> formatter : eslintFormatter , <nl> eslintPath : require . resolve ( ' eslint ' ) , <nl> @ @ - 33 , 7 + 26 , 6 @ @ module . exports = { <nl> } , <nl> . . . config . module . rules , <nl> ] ; <nl> - <nl> return config ; <nl> } , <nl> } ; <nl> 
mmm a / packages / razzle / config / paths . js <nl> ppp b / packages / razzle / config / paths . js <nl> / / Make sure any symlinks in the project folder are resolved : <nl> / / https : / / github . com / facebookincubator / create - react - app / issues / 637 <nl> - const appDirectory = fs . realpathSync ( process . cwd ( ) ) ; <nl> + const appDirectory = fs . realpathSync ( process . env . RAZZLE_APP_PATH | | process . cwd ( ) ) ; <nl> const resolveApp = relativePath = > path . resolve ( appDirectory , relativePath ) ; <nl> const envPublicUrl = process . env . PUBLIC_URL ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> ] <nl> } ; <nl> + webpackOptions . watchIgnorePaths = [ paths . appAssetsManifest , paths . appChunksManifest ] ; <nl> + <nl> for ( const [ plugin , pluginOptions ] of plugins ) { <nl> / / Check if . modifyWebpackConfig is a function . <nl> / / If it is , call it on the configs we created . <nl> @ @ - 658 , 8 + 660 , 8 @ @ module . exports = ( <nl> / / Ignore assets . json and chunks . json to avoid infinite recompile bug <nl> new webpack . WatchIgnorePlugin ( <nl> webpackMajor = = = 5 <nl> - ? { paths : [ paths . appAssetsManifest , paths . appChunksManifest ] } <nl> - : [ paths . appAssetsManifest , paths . appChunksManifest ] <nl> + ? { paths : webpackOptions . watchIgnorePaths } <nl> + : webpackOptions . watchIgnorePaths <nl> ) , <nl> ] . filter ( x = > x ) ; <nl> } <nl> 
mmm a / packages / razzle / config / loadPlugins . js <nl> ppp b / packages / razzle / config / loadPlugins . js <nl> return [ plugin , { } ] ; <nl> } <nl> + / / Support for not released plugins <nl> + if ( typeof plugin = = = ' object ' ) { <nl> + return [ plugin , { } ] ; <nl> + } <nl> + <nl> if ( typeof plugin . func = = = ' function ' ) { <nl> / / Used for writing plugin tests <nl> return [ plugin . func , plugin . options ] ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> webpackOptions . urlLoaderTest = [ / \ . bmp $ / , / \ . gif $ / , / \ . jpe ? g $ / , / \ . png $ / ] ; <nl> + webpackOptions . fileLoaderOutputName = ` $ { razzleOptions . mediaPrefix } / [ name ] . [ contenthash : 8 ] . [ ext ] ` ; <nl> + <nl> + webpackOptions . urlLoaderOutputName = ` $ { razzleOptions . mediaPrefix } / [ name ] . [ contenthash : 8 ] . [ ext ] ` ; <nl> + <nl> + webpackOptions . cssTest = [ / \ . css ( \ . map ) ? $ / ] ; <nl> + <nl> + webpackOptions . cssOutputFilename = ` $ { razzleOptions . cssPrefix } / [ name ] . [ contenthash : 8 ] . css ` ; <nl> + <nl> + webpackOptions . cssOutputChunkFilename = ` $ { razzleOptions . cssPrefix } / [ name ] . [ contenthash : 8 ] . chunk . css ` ; <nl> + <nl> + webpackOptions . jsTest = [ / \ . js ( \ . map ) ? $ / ] ; <nl> + <nl> webpackOptions . definePluginOptions = dotenv . stringified ; <nl> if ( IS_NODE ) { <nl> + <nl> + webpackOptions . jsOutputFilename = ` [ name ] . js ` ; <nl> + webpackOptions . jsOutputChunkFilename = ` [ name ] . chunk . js ` ; <nl> + <nl> if ( IS_DEV ) { <nl> } else { <nl> } <nl> } <nl> if ( IS_WEB ) { <nl> + <nl> if ( IS_DEV ) { <nl> + <nl> + webpackOptions . jsOutputFilename = ` $ { razzleOptions . jsPrefix } / [ name ] . js ` ; <nl> + webpackOptions . jsOutputChunkFilename = ` $ { razzleOptions . jsPrefix } / [ name ] . chunk . js ` ; <nl> + <nl> webpackOptions . splitChunksConfig = splitChunksConfigs . dev ; <nl> } else { <nl> + <nl> + webpackOptions . jsOutputFilename = ` $ { razzleOptions . jsPrefix } / [ name ] . [ contenthash : 8 ] . js ` ; <nl> + webpackOptions . jsOutputChunkFilename = ` $ { razzleOptions . jsPrefix } / [ name ] . [ contenthash : 8 ] . chunk . js ` ; <nl> + <nl> webpackOptions . splitChunksConfig = splitChunksConfigs . prod ; <nl> webpackOptions . terserPluginOptions = { <nl> terserOptions : { <nl> @ @ - 444 , 7 + 469 , 7 @ @ module . exports = ( <nl> exclude : webpackOptions . fileLoaderExclude , <nl> loader : require . resolve ( ' file - loader ' ) , <nl> options : { <nl> - name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ contenthash : 8 ] . [ ext ] ` , <nl> + name : webpackOptions . fileLoaderOutputName , <nl> emitFile : IS_WEB , <nl> } , <nl> } , <nl> @ @ - 456 , 7 + 481 , 7 @ @ module . exports = ( <nl> loader : require . resolve ( ' url - loader ' ) , <nl> options : { <nl> limit : 10000 , <nl> - name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ contenthash : 8 ] . [ ext ] ` , <nl> + name : webpackOptions . urlLoaderOutputName , <nl> emitFile : IS_WEB , <nl> } , <nl> } , <nl> @ @ - 539 , 7 + 564 , 8 @ @ module . exports = ( <nl> config . output = { <nl> path : paths . appBuild , <nl> publicPath : clientPublicPath , <nl> - filename : ' [ name ] . js ' , <nl> + filename : webpackOptions . jsOutputFilename , <nl> + chunkFilename : webpackOptions . jsOutputChunkFilename , <nl> libraryTarget : ' commonjs2 ' , <nl> } ; <nl> @ @ - 627 , 7 + 653 , 6 @ @ module . exports = ( <nl> generate : ( seed , files ) = > { <nl> const entrypoints = new Set ( ) ; <nl> const noChunkFiles = new Set ( ) ; <nl> - const noLongTermCacheFiles = new Set ( ) ; <nl> files . forEach ( file = > { <nl> if ( file . isChunk ) { <nl> const groups = ( <nl> @ @ - 636 , 10 + 661 , 6 @ @ module . exports = ( <nl> } else { <nl> noChunkFiles . add ( file ) ; <nl> } <nl> - console . log ( file ) <nl> - if ( file . path . indexOf ( file . name ) ! = = - 1 ) { <nl> - noLongTermCacheFiles . add ( file ) ; <nl> - } <nl> } ) ; <nl> const entries = [ . . . entrypoints ] ; <nl> const entryArrayManifest = entries . reduce ( ( acc , entry ) = > { <nl> @ @ - 681 , 8 + 702 , 6 @ @ module . exports = ( <nl> types [ fileType ] . push ( file ) ; <nl> return types ; <nl> } , { } ) ; <nl> - entryArrayManifest [ ' nocache ' ] = [ . . . noLongTermCacheFiles ] <nl> - . map ( file = > file . path ) ; <nl> return entryArrayManifest ; <nl> } , <nl> } ) <nl> @ @ - 704 , 8 + 723 , 8 @ @ module . exports = ( <nl> publicPath : clientPublicPath , <nl> pathinfo : true , <nl> libraryTarget : ' var ' , <nl> - filename : ` $ { razzleOptions . jsPrefix } / [ name ] . js ` , <nl> - chunkFilename : ` $ { razzleOptions . jsPrefix } / [ name ] . chunk . js ` , <nl> + filename : webpackOptions . jsOutputFilename , <nl> + chunkFilename : webpackOptions . jsOutputChunkFilename , <nl> devtoolModuleFilenameTemplate : info = > <nl> path . resolve ( info . resourcePath ) . replace ( / \ \ / g , ' / ' ) , <nl> } ; <nl> @ @ - 776 , 8 + 795 , 8 @ @ module . exports = ( <nl> config . output = { <nl> path : paths . appBuildPublic , <nl> publicPath : dotenv . raw . PUBLIC_PATH | | ' / ' , <nl> - filename : ` $ { razzleOptions . jsPrefix } / [ name ] . [ contenthash : 8 ] . js ` , <nl> - chunkFilename : ` $ { razzleOptions . jsPrefix } / [ name ] . [ contenthash : 8 ] . chunk . js ` , <nl> + filename : webpackOptions . jsOutputFilename , <nl> + chunkFilename : webpackOptions . jsOutputChunkFilename , <nl> libraryTarget : ' var ' , <nl> } ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> const nodeExternalsFunc = ( context , request , callback ) = > { <nl> if ( webpackOptions . notNodeExternalResMatch & & <nl> - webpackOptions . notNodeExternalResMatch ( request ) <nl> + webpackOptions . notNodeExternalResMatch ( request , context ) <nl> ) { <nl> if ( debugNodeExternals ) { <nl> console . log ( ` Not externalizing $ { request } ( using notNodeExternalResMatch ) ` ) ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> if ( IS_DEV ) { <nl> } else { <nl> + webpackOptions . terserPluginOptions = { } ; <nl> } <nl> } <nl> @ @ - 608 , 21 + 609 , 26 @ @ module . exports = ( <nl> / / We define environment variables that can be accessed globally in our <nl> new webpack . DefinePlugin ( webpackOptions . definePluginOptions ) , <nl> ] ; <nl> - / / in dev mode emitting one huge server file on every save is very slow <nl> + <nl> + config . entry = { <nl> + server : [ paths . appServerIndexJs ] , <nl> + } ; <nl> + <nl> if ( IS_PROD ) { <nl> / / Prevent creating multiple chunks for the server <nl> + / / in dev mode emitting one huge server file on every save is very slow <nl> + <nl> config . plugins . push ( <nl> new webpack . optimize . LimitChunkCountPlugin ( { <nl> maxChunks : 1 , <nl> } ) <nl> ) ; <nl> + config . optimization = { <nl> + minimize : true , <nl> + minimizer : [ <nl> + new TerserPlugin ( webpackOptions . terserPluginOptions ) <nl> + ] , <nl> } <nl> - <nl> - config . entry = { <nl> - server : [ paths . appServerIndexJs ] , <nl> - } ; <nl> - <nl> - if ( IS_PROD ) { <nl> if ( hasStaticExportJs ) { <nl> config . entry . static_export = [ paths . appStaticExportJs ] ; <nl> } <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> const path = require ( ' path ' ) ; <nl> const webpack = require ( ' webpack ' ) ; <nl> const crypto = require ( ' crypto ' ) ; <nl> + const util = require ( ' util ' ) ; <nl> const TerserPlugin = require ( ' terser - webpack - plugin ' ) ; <nl> const HtmlWebpackPlugin = require ( ' html - webpack - plugin ' ) ; <nl> const StartServerPlugin = require ( ' razzle - start - server - webpack - plugin ' ) ; <nl> @ @ - 337 , 6 + 338 , 11 @ @ module . exports = ( <nl> } ) ; <nl> } <nl> + if ( razzleOptions . debug . options ) { <nl> + console . log ( ` Printing webpack options for $ { target } target ` ) ; <nl> + console . log ( util . inspect ( webpackOptions , { depth : null } ) ) ; <nl> + } <nl> + <nl> const debugNodeExternals = razzleOptions . debug . nodeExternals ; <nl> const nodeExternalsFunc = ( context , request , callback ) = > { <nl> @ @ - 950 , 7 + 956 , 10 @ @ module . exports = ( <nl> paths , <nl> } ) ; <nl> } <nl> - <nl> + if ( razzleOptions . debug . config ) { <nl> + console . log ( ` Printing webpack config for $ { target } target ` ) ; <nl> + console . log ( util . inspect ( webpackConfig , { depth : null } ) ) ; <nl> + } <nl> resolve ( config ) ; <nl> } ) ; <nl> } ; <nl> 
mmm a / packages / razzle / config / babel - loader / razzle - babel - loader . js <nl> ppp b / packages / razzle / config / babel - loader / razzle - babel - loader . js <nl> isServer : opts . isServer , <nl> isModern : opts . isModern , <nl> hasModern : opts . hasModern , <nl> + supportsStaticESM : opts . supportsStaticESM , <nl> development : opts . development , <nl> shouldUseReactRefresh : opts . shouldUseReactRefresh , <nl> } ; <nl> @ @ - 101 , 6 + 102 , 7 @ @ module . exports = babelLoader . custom ( function ( babel ) { <nl> delete loader . distDir ; <nl> delete loader . isModern ; <nl> delete loader . hasModern ; <nl> + delete loader . supportsStaticESM ; <nl> delete loader . development ; <nl> delete loader . shouldUseReactRefresh ; <nl> return { loader , custom } ; <nl> @ @ - 112 , 6 + 114 , 7 @ @ module . exports = babelLoader . custom ( function ( babel ) { <nl> const isServer = customOptions . isServer ; <nl> const isModern = customOptions . isModern ; <nl> const hasModern = customOptions . hasModern ; <nl> + const supportsStaticESM = customOptions . supportsStaticESM ; <nl> const development = customOptions . development ; <nl> const shouldUseReactRefresh = customOptions . shouldUseReactRefresh ; <nl> @ @ - 134 , 6 + 137 , 7 @ @ module . exports = babelLoader . custom ( function ( babel ) { <nl> presetOptions . caller . isServer = isServer ; <nl> presetOptions . caller . isModern = isModern ; <nl> presetOptions . caller . isDev = development ; <nl> + presetOptions . caller . supportsStaticESM = supportsStaticESM ; <nl> const emitWarning = this . emitWarning . bind ( this ) ; <nl> Object . defineProperty ( presetOptions . caller , ' onWarning ' , { <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> ] , <nl> } ; <nl> + webpackOptions . nullNodeCss = false ; <nl> + <nl> for ( const [ plugin , pluginOptions ] of plugins ) { <nl> / / Check if . modifyWebpackConfig is a function . <nl> / / If it is , call it on the configs we created . <nl> @ @ - 532 , 7 + 534 , 9 @ @ module . exports = ( <nl> ? / / Style - loader does not work in Node . js without some crazy <nl> / / magic . Luckily we just need css - loader . <nl> [ <nl> - { <nl> + webpackOptions . nullNodeCss ? { <nl> + loader : require . resolve ( ' null - loader ' ) <nl> + } : { <nl> loader : require . resolve ( ' css - loader ' ) , <nl> options : { <nl> importLoaders : 1 , <nl> 
mmm a / packages / razzle / scripts / build . js <nl> ppp b / packages / razzle / scripts / build . js <nl> async ( { razzle , razzleOptions , webpackObject , plugins , paths } ) = > { <nl> const verbose = razzleOptions . verbose ; <nl> - if ( process . env . NODE_ENV = = = " production " & & ! cliArgs [ ' noninteractive ' ] ) { <nl> + if ( process . env . NODE_ENV = = = " production " & & ( process . env . RAZZLE_NONINTERACTIVE ! = = " true " & & ! cliArgs [ ' noninteractive ' ] ) ) { <nl> await inquirer . prompt ( [ <nl> { <nl> type : ' confirm ' , <nl> 
mmm a / packages / razzle / scripts / build . js <nl> ppp b / packages / razzle / scripts / build . js <nl> async ( { razzle , razzleOptions , webpackObject , plugins , paths } ) = > { <nl> const verbose = razzleOptions . verbose ; <nl> - if ( process . env . NODE_ENV = = = " production " & & ( process . env . RAZZLE_NONINTERACTIVE ! = = " true " & & ! cliArgs [ ' noninteractive ' ] ) ) { <nl> + if ( ! process . env . CI & & process . env . NODE_ENV = = = " production " & & ( process . env . RAZZLE_NONINTERACTIVE ! = = " true " & & ! cliArgs [ ' noninteractive ' ] ) ) { <nl> await inquirer . prompt ( [ <nl> { <nl> type : ' confirm ' , <nl> 
mmm a / packages / create - razzle - app / lib / utils / install . js <nl> ppp b / packages / create - razzle - app / lib / utils / install . js <nl> console . log ( messages . installing ( packages ) ) ; <nl> process . chdir ( projectPath ) ; <nl> - const stdio = ' pipe ' ; <nl> + const stdio = opts . verbose ? ' inherit ' : ' pipe ' ; <nl> return new Promise ( function ( resolve , reject ) { <nl> const stopInstallSpinner = output . wait ( ' Installing modules ' ) ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> const IS_SERVERLESS = / serverless / . test ( razzleOptions . buildType ) ; <nl> const IS_PROD = env = = = ' prod ' ; <nl> const IS_DEV = env = = = ' dev ' ; <nl> + const IS_DEV_ENV = process . env . NODE_ENV = = = ' development ' ; <nl> / / Contains various versions of the Webpack SplitChunksPlugin used in different build types <nl> const splitChunksConfigs = { <nl> @ @ - 465 , 13 + 466 , 13 @ @ module . exports = ( <nl> / / This is our base webpack config . <nl> let config = { <nl> / / Set webpack mode : <nl> - mode : IS_DEV ? ' development ' : ' production ' , <nl> + mode : IS_DEV | | IS_DEV_ENV ? ' development ' : ' production ' , <nl> / / Set webpack context to the current apps directory <nl> context : paths . appPath , <nl> / / Specify target ( either ' node ' or ' web ' ) <nl> target : target , <nl> / / Controversially , decide on sourcemaps . <nl> - devtool : IS_DEV ? ' cheap - module - source - map ' : razzleOptions . enableSourceMaps ? ' source - map ' : false , <nl> + devtool : IS_DEV | | IS_DEV_ENV ? ' cheap - module - source - map ' : razzleOptions . enableSourceMaps ? ' source - map ' : false , <nl> / / We need to tell webpack how to resolve both Razzle ' s node_modules and <nl> / / the users ' , so we use resolve and resolveLoader . <nl> resolve : { <nl> @ @ - 674 , 7 + 675 , 7 @ @ module . exports = ( <nl> if ( IS_PROD ) { <nl> / / Prevent creating multiple chunks for the server <nl> / / in dev mode emitting one huge server file on every save is very slow <nl> - <nl> + if ( ! IS_DEV_ENV ) { <nl> config . plugins . push ( <nl> new webpack . optimize . LimitChunkCountPlugin ( { <nl> maxChunks : 1 , <nl> @ @ - 686 , 6 + 687 , 7 @ @ module . exports = ( <nl> new TerserPlugin ( webpackOptions . terserPluginOptions ) <nl> ] , <nl> } <nl> + } <nl> if ( webpackMajor = = = 5 ) { <nl> config . optimization . emitOnErrors = razzleOptions . emitOnErrors ; <nl> } else { <nl> @ @ - 913 , 8 + 915 , 8 @ @ module . exports = ( <nl> / / Define production environment vars <nl> new webpack . DefinePlugin ( webpackOptions . definePluginOptions ) , <nl> miniCssExtractPlugin , <nl> - webpackMajor = = = 5 ? null : new webpack . HashedModuleIdsPlugin ( ) , <nl> - new webpack . optimize . AggressiveMergingPlugin ( ) , <nl> + IS_DEV_ENV | | webpackMajor = = = 5 ? null : new webpack . HashedModuleIdsPlugin ( ) , <nl> + IS_DEV_ENV ? null : new webpack . optimize . AggressiveMergingPlugin ( ) , <nl> hasPublicDir & & new CopyPlugin ( { <nl> patterns : [ <nl> { <nl> @ @ - 929 , 6 + 931 , 7 @ @ module . exports = ( <nl> } ) , <nl> ] . filter ( x = > x ) ; <nl> + if ( ! IS_DEV_ENV ) { <nl> config . optimization = { <nl> splitChunks : webpackOptions . splitChunksConfig , <nl> moduleIds : webpackMajor = = = 5 ? ' deterministic ' : ' hashed ' , <nl> @ @ - 961 , 6 + 964 , 7 @ @ module . exports = ( <nl> } ) <nl> ] , <nl> } <nl> + } <nl> if ( webpackMajor = = = 5 ) { <nl> config . optimization . emitOnErrors = razzleOptions . emitOnErrors ; <nl> } else { <nl> 
mmm a / src / routes / [ slug ] . svelte <nl> ppp b / src / routes / [ slug ] . svelte <nl> import { format } from ' date - fns ' <nl> + import { onMount } from ' svelte ' <nl> export let Post , metadata <nl> let created = format ( new Date ( metadata . createdDate ) , ' yyy MMM do ' ) <nl> let updated = format ( new Date ( metadata . updatedDate ) , ' yyy MMM do ' ) <nl> + <nl> + onMount ( ( ) = > { <nl> + let headingNodeList <nl> + let headings <nl> + headingNodeList = document . querySelectorAll ( ' h2 ' ) <nl> + <nl> + headings = Array . from ( headingNodeList ) . map ( h2 = > { <nl> + return { <nl> + label : h2 . innerText , <nl> + href : ` # $ { h2 . id } ` , <nl> + } <nl> + } ) <nl> + } ) <nl> < / script > <nl> < h1 class = " font - medium text - 5xl " > <nl> 
mmm a / src / app . html <nl> ppp b / src / app . html <nl> content = " width = device - width , initial - scale = 1 " <nl> / > <nl> + < script <nl> + src = " https : / / 4pvafmq . cheatsheets . xyz / script . js " <nl> + data - site = " WERPEKMT " <nl> + defer <nl> + > < / script > <nl> % svelte . head % <nl> < / head > <nl> < body > <nl> 
mmm a / sheets / javascript . md <nl> ppp b / sheets / javascript . md <nl> # # Checking for ` window ` <nl> - [ Optional chaining ] ( https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Operators / Optional_chaining ) can not be used on ` window ` . <nl> - It will throw an error when used on any undeclared root object , so no escaping the ` typeof window = = ' undefined ' ` check with a clever ` ? . ` . <nl> + Thanks to [ Nicky Meuleman ] for this one . <nl> + [ Optional chaining ] can not be used on ` window ` . It will throw an <nl> + error when used on any undeclared root object , so no escaping the <nl> + ` typeof window = = ' undefined ' ` check with a clever ` ? . ` . <nl> + <nl> + < ! - - Links - - > <nl> + <nl> + [ nicky meuleman ] : https : / / twitter . com / NMeuleman <nl> + [ optional chaining ] : <nl> + https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Operators / Optional_chaining <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentProps . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentProps . js <nl> import React , { Component , PropTypes } from ' react ' <nl> import { Label , Table } from ' src ' <nl> + import { SUI } from ' src / lib ' <nl> + <nl> + const descriptionExtraStyle = { <nl> + fontSize : ' 0 . 95em ' , <nl> + color : ' # 777 ' , <nl> + } <nl> / * * <nl> * Displays a table of a Component ' s PropTypes . <nl> @ @ - 20 , 6 + 26 , 19 @ @ export default class ComponentProps extends Component { <nl> meta : PropTypes . object , <nl> } <nl> + state = { <nl> + showEnumsFor : { } , <nl> + } <nl> + <nl> + toggleEnumsFor = ( prop ) = > ( ) = > { <nl> + this . setState ( { <nl> + showEnumsFor : { <nl> + . . . this . state . showEnumsFor , <nl> + [ prop ] : ! this . state . showEnumsFor [ prop ] , <nl> + } , <nl> + } ) <nl> + } <nl> + <nl> renderName = item = > < code > { item . name } < / code > <nl> requiredRenderer = item = > item . required & & < Label size = ' mini ' color = ' red ' circular > required < / Label > <nl> @ @ - 65 , 6 + 84 , 61 @ @ export default class ComponentProps extends Component { <nl> ) <nl> } <nl> + expandEnums = ( value ) = > { <nl> + const parts = value . split ( ' . ' ) <nl> + if ( parts [ 0 ] = = = ' SUI ' ) { <nl> + return SUI [ parts [ 1 ] ] <nl> + } <nl> + return value <nl> + } <nl> + <nl> + renderEnums = ( item ) = > { <nl> + if ( item . type ! = = ' { enum } ' ) return <nl> + <nl> + const { showEnumsFor } = this . state <nl> + const truncateAt = 30 <nl> + <nl> + if ( ! item . value ) return null <nl> + <nl> + const values = [ ] . concat ( item . value ) . reduce ( ( accumulator , v ) = > <nl> + accumulator . concat ( this . expandEnums ( _ . trim ( v . value | | v , ' . \ ' ' ) ) ) , <nl> + [ ] ) <nl> + <nl> + / / show all if there are few <nl> + if ( values . length < truncateAt ) { <nl> + return ( <nl> + < p style = { descriptionExtraStyle } > <nl> + < strong > Enums : < / strong > <nl> + { values . join ( ' , ' ) } <nl> + < / p > <nl> + ) <nl> + } <nl> + <nl> + / / add button to show more when there are many values and it is not toggled <nl> + if ( ! showEnumsFor [ item . name ] ) { <nl> + return ( <nl> + < p style = { descriptionExtraStyle } > <nl> + < strong > Enums : < / strong > <nl> + < a style = { { cursor : ' pointer ' } } onClick = { this . toggleEnumsFor ( item . name ) } > <nl> + Show all { values . length } <nl> + < / a > <nl> + < div > { values . slice ( 0 , truncateAt - 1 ) . join ( ' , ' ) } . . . < / div > <nl> + < / p > <nl> + ) <nl> + } <nl> + <nl> + / / add " show more " button when there are many <nl> + return ( <nl> + < p style = { descriptionExtraStyle } > <nl> + < strong > Enums : < / strong > <nl> + < a style = { { cursor : ' pointer ' } } onClick = { this . toggleEnumsFor ( item . name ) } > <nl> + Show less <nl> + < / a > <nl> + < div > { values . join ( ' , ' ) } < / div > <nl> + < / p > <nl> + ) <nl> + } <nl> + <nl> render ( ) { <nl> const { props : propsDefinition } = this . props <nl> const content = _ . sortBy ( _ . map ( propsDefinition , ( config , name ) = > { <nl> @ @ - 109 , 6 + 183 , 7 @ @ export default class ComponentProps extends Component { <nl> < Table . Cell > <nl> { item . description & & < p > { item . description } < / p > } <nl> { this . renderFunctionSignature ( item ) } <nl> + { this . renderEnums ( item ) } <nl> < / Table . Cell > <nl> < / Table . Row > <nl> ) ) } <nl> 
mmm a / src / elements / Input / Input . js <nl> ppp b / src / elements / Input / Input . js <nl> ' selected ' , ' defaultValue ' , ' defaultChecked ' , <nl> / / LIMITED HTML PROPS <nl> - ' autoComplete ' , ' autoFocus ' , ' checked ' , ' form ' , ' max ' , ' maxLength ' , ' min ' , <nl> + ' autoCapitalize ' , ' autoComplete ' , ' autoFocus ' , ' checked ' , ' form ' , ' max ' , ' maxLength ' , ' min ' , <nl> ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , ' type ' , ' value ' , <nl> / / Heads Up ! <nl> 
mmm a / src / lib / htmlInputPropsUtils . js <nl> ppp b / src / lib / htmlInputPropsUtils . js <nl> ' selected ' , ' defaultValue ' , ' defaultChecked ' , <nl> / / LIMITED HTML PROPS <nl> - ' autoCapitalize ' , ' autoComplete ' , ' autoFocus ' , ' checked ' , ' form ' , ' max ' , ' maxLength ' , ' min ' , ' multiple ' , <nl> - ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , ' type ' , ' value ' , <nl> + ' autoCapitalize ' , ' autoComplete ' , ' autoCorrect ' , ' autoFocus ' , ' checked ' , ' form ' , ' max ' , ' maxLength ' , ' min ' , <nl> + ' multiple ' , ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , ' type ' , ' value ' , <nl> / / Heads Up ! <nl> / / Do not pass disabled , it duplicates the SUI CSS opacity rule . <nl> 
mmm a / index . d . ts <nl> ppp b / index . d . ts <nl> export { default as StepGroup , StepGroupProps } from ' . / dist / commonjs / elements / Step / StepGroup ' ; <nl> export { default as StepTitle , StepTitleProps } from ' . / dist / commonjs / elements / Step / StepTitle ' ; <nl> + / / Generics <nl> + export * from ' . / dist / commonjs ' ; <nl> + <nl> / / Modules <nl> export { default as Accordion , AccordionProps } from ' . / dist / commonjs / modules / Accordion / Accordion ' ; <nl> export { default as AccordionContent , AccordionContentProps } from ' . / dist / commonjs / modules / Accordion / AccordionContent ' ; <nl> 
mmm a / src / addons / Portal / Portal . js <nl> ppp b / src / addons / Portal / Portal . js <nl> import PropTypes from ' prop - types ' <nl> - import { Children , cloneElement } from ' react ' <nl> + import React , { Children , cloneElement } from ' react ' <nl> import ReactDOM from ' react - dom ' <nl> import { <nl> @ @ - 11 , 6 + 11 , 7 @ @ import { <nl> makeDebugger , <nl> META , <nl> } from ' . . / . . / lib ' <nl> + import Ref from ' . . / Ref ' <nl> const debug = makeDebugger ( ' portal ' ) <nl> @ @ - 414 , 24 + 415 , 23 @ @ class Portal extends Component { <nl> _ . invoke ( this . props , ' onUnmount ' , null , this . props ) <nl> } <nl> - handleRef = ( c ) = > { <nl> - / / TODO : Replace findDOMNode with Ref component when it will be merged <nl> - this . triggerNode = ReactDOM . findDOMNode ( c ) / / eslint - disable - line react / no - find - dom - node <nl> - } <nl> + handleRef = c = > ( this . triggerNode = c ) <nl> render ( ) { <nl> const { trigger } = this . props <nl> if ( ! trigger ) return null <nl> - <nl> - return cloneElement ( trigger , { <nl> - ref : this . handleRef , <nl> + return ( <nl> + < Ref innerRef = { this . handleRef } > <nl> + { cloneElement ( trigger , { <nl> onBlur : this . handleTriggerBlur , <nl> onClick : this . handleTriggerClick , <nl> onFocus : this . handleTriggerFocus , <nl> onMouseLeave : this . handleTriggerMouseLeave , <nl> onMouseEnter : this . handleTriggerMouseEnter , <nl> - } ) <nl> + } ) } <nl> + < / Ref > <nl> + ) <nl> } <nl> } <nl> 
mmm a / src / lib / customPropTypes . js <nl> ppp b / src / lib / customPropTypes . js <nl> * Ensure a component can render as a give prop value . <nl> * / <nl> export const as = ( . . . args ) = > PropTypes . oneOfType ( [ <nl> - PropTypes . string , <nl> PropTypes . func , <nl> + PropTypes . string , <nl> + PropTypes . symbol , <nl> ] ) ( . . . args ) <nl> - <nl> / * * <nl> * Similar to PropTypes . oneOf but shows closest matches . <nl> * Word order is ignored allowing ` left chevron ` to match ` chevron left ` . <nl> 
mmm a / index . d . ts <nl> ppp b / index . d . ts <nl> StrictResponsiveProps , <nl> } from ' . / dist / commonjs / addons / Responsive ' <nl> export { default as Select , SelectProps } from ' . / dist / commonjs / addons / Select ' <nl> - export { default as TextArea , TextAreaProps } from ' . / dist / commonjs / addons / TextArea ' <nl> + export { default as TextArea , TextAreaProps , StrictTextAreaProps } from ' . / dist / commonjs / addons / TextArea ' <nl> export { <nl> default as TransitionablePortal , <nl> TransitionablePortalProps , <nl> 
mmm a / lib / cli / index . js <nl> ppp b / lib / cli / index . js <nl> var runParser = new argparse . ArgumentParser ( { <nl> debug : true , <nl> addHelp : false <nl> - } ) ; <nl> + } ) , <nl> + <nl> + / * * <nl> + * Parses ` = ` separated key - value pairs into Postman variable list like arrays . ` = ` characters in values are <nl> + * also supported . <nl> + * <nl> + * @ param { String } arg - The argument provided to ` - - global - var ` . <nl> + * @ returns { { key , value } } - The object representation of the current CLI variable . <nl> + * @ throws { Error } - An error is thrown for arguments that are not in the form foo = bar . <nl> + * / <nl> + cliVar = function ( arg ) { <nl> + var eqIndex = arg . indexOf ( ' = ' ) ; <nl> + <nl> + if ( eqIndex = = = - 1 ) { throw new Error ( ' CLI global vars must be specified in a ` key = value ` format ' ) ; } <nl> + <nl> + / / This is done instead of splitting by ` = ` to avoid chopping off ` = ` that could be present in the value <nl> + return { key : arg . slice ( 0 , eqIndex ) , value : arg . slice ( eqIndex + 1 ) } ; <nl> + } ; <nl> runParser . addArgument ( ' collection ' , { <nl> help : ' URL or path to a Postman Collection ' <nl> @ @ - 398 , 6 + 415 , 12 @ @ var _ = require ( ' lodash ' ) , <nl> defaultValue : false <nl> } ) ; <nl> + runParser . addArgument ( [ ' - - global - var ' ] , { <nl> + help : ' Allows the specification of global variables via the command line , in a key = value format ' , <nl> + type : cliVar , <nl> + action : ' append ' <nl> + } ) ; <nl> + <nl> return runParser ; <nl> } , <nl> 
mmm a / src / App . vue <nl> ppp b / src / App . vue <nl> < div class = " mb - 4 " > <nl> < h1 class = " logo " > <nl> - < img alt = " Logo " src = " . / assets / logo . png " width = " 50 " > <nl> + < router - link to = " / " > <nl> + < img alt = " Logo " src = " . / assets / logo . png " width = " 50 " / > <nl> Open Drinks <nl> + < / router - link > <nl> < / h1 > <nl> < / div > <nl> < footer class = " container mt - 4 text - center " > <nl> < hr / > <nl> - < div > View the source or contribute a drink recipe on < a href = " https : / / github . com / alfg / opendrinks " > GitHub < / a > ! < / div > <nl> + < div > <nl> + View the source or contribute a drink recipe on <nl> + < a <nl> + href = " https : / / github . com / alfg / opendrinks " <nl> + > GitHub < / a > ! <nl> + < / div > <nl> < a href = " https : / / www . netlify . com " > <nl> < img src = " https : / / www . netlify . com / img / global / badges / netlify - light . svg " alt = " Netlify " / > <nl> < / a > <nl> < style > <nl> # app { <nl> - font - family : ' Avenir ' , Helvetica , Arial , sans - serif ; <nl> + font - family : " Avenir " , Helvetica , Arial , sans - serif ; <nl> - webkit - font - smoothing : antialiased ; <nl> - moz - osx - font - smoothing : grayscale ; <nl> color : # 2c3e50 ; <nl> } <nl> . logo { <nl> - font - family : ' Pacifico ' , ' cursive ' ; <nl> + font - family : " Pacifico " , " cursive " ; <nl> + } <nl> + . logo a { <nl> + text - decoration : none ; <nl> + color : inherit ; <nl> } <nl> < / style > <nl> 
mmm a / src / components / RecipeFind . vue <nl> ppp b / src / components / RecipeFind . vue <nl> } <nl> if ( isIngredientsEnabled ) { <nl> - filtered = this . data <nl> - . filter ( recipe = > recipe . ingredients <nl> - . some ( i = > searchParts . includes ( i . ingredient . toLowerCase ( ) ) ) ) ; <nl> + filtered = this . data . filter ( recipe = > <nl> + searchParts . every ( s = > <nl> + recipe . ingredients . some ( i = > <nl> + i . ingredient . toLowerCase ( ) . includes ( s . toLowerCase ( ) ) <nl> + ) <nl> + ) <nl> + ) ; <nl> } <nl> if ( isKeywordsEnabled ) { <nl> - filtered = this . data <nl> - . filter ( recipe = > recipe . keywords & & recipe . keywords <nl> - . some ( i = > searchParts . includes ( i . toLowerCase ( ) ) ) ) ; <nl> + filtered = this . data . filter ( recipe = > <nl> + searchParts . every ( <nl> + s = > <nl> + recipe . keywords & & <nl> + recipe . keywords . some ( k = > <nl> + k . toLowerCase ( ) . includes ( s . toLowerCase ( ) ) <nl> + ) <nl> + ) <nl> + ) ; <nl> } <nl> / / Sort the results . <nl> filtered = filtered . sort ( ( recipeA , recipeB ) = > { <nl> / / Name - matches to the top if the user wanted to find a drink based on the name <nl> const hasName = recipeB . name . toLowerCase ( ) . indexOf ( this . search . toLowerCase ( ) ) > - 1 ? 1 : - 1 ; <nl> + const alphabetical = <nl> + recipeB . name . toLowerCase ( ) > recipeB . name . toLowerCase ( ) ? - 1 : 1 ; <nl> return ! isNameEnabled ? 0 : hasName ; <nl> } ) ; <nl> 
mmm a / tests / unit / views / Favorites . spec . js <nl> ppp b / tests / unit / views / Favorites . spec . js <nl> const localVue = createLocalVue ( ) ; <nl> localVue . use ( BootstrapVue ) ; <nl> - describe ( ' Favorites ' , ( ) = > { <nl> + describe ( ' Favorites ( Populated ) ' , ( ) = > { <nl> let wrapper ; <nl> beforeEach ( ( ) = > { <nl> @ @ - 34 , 3 + 34 , 23 @ @ describe ( ' Favorites ' , ( ) = > { <nl> expect ( favs . length = = = 1 ) . toBe ( true ) ; <nl> } ) ; <nl> } ) ; <nl> + <nl> + describe ( ' Favorites ( Empty ) ' , ( ) = > { <nl> + let wrapper ; <nl> + <nl> + beforeEach ( ( ) = > { <nl> + wrapper = mount ( Favorites , { <nl> + localVue , <nl> + router , <nl> + } ) ; <nl> + } ) ; <nl> + <nl> + test ( ' show correct empty state ' , ( ) = > { <nl> + localStorage . setItem ( ' favorites ' , JSON . stringify ( [ ] ) ) ; <nl> + wrapper = mount ( Favorites , { <nl> + localVue , <nl> + router , <nl> + } ) ; <nl> + expect ( wrapper . find ( ' . alert - info ' ) . html ( ) ) . toContain ( " You don ' t have any favorite drinks " ) ; <nl> + } ) ; <nl> + } ) ; <nl> 
mmm a / frontend / leaderboard / src / Postgres . re <nl> ppp b / frontend / leaderboard / src / Postgres . re <nl> LEFT JOIN public_keys AS pk2 ON ic . receiver_id = pk2 . id <nl> LEFT JOIN public_keys AS pk3 ON uc . fee_payer_id = pk3 . id <nl> LEFT JOIN public_keys AS pk4 ON uc . source_id = pk4 . id <nl> - LEFT JOIN public_keys AS pk5 ON uc . receiver_id = pk5 . id " ; <nl> + LEFT JOIN public_keys AS pk5 ON uc . receiver_id = pk5 . id <nl> + <nl> + WHERE height > = 335 " ; <nl> let createPool = pgConn = > { <nl> makePool ( { connectionString : pgConn , connectionTimeoutMillis : 5000 } ) ; <nl> 
mmm a / frontend / leaderboard / src / Metrics . re <nl> ppp b / frontend / leaderboard / src / Metrics . re <nl> let echoBotPublicKeys = [ <nl> " B62qndJi5mnRoBZ8SAYDM1oR2SgAk5WpZC8hGpJUZ4e64kDHGbFMeLJ " , <nl> ] ; <nl> + <nl> + let excludePublicKeys = [ ] ; <nl> + <nl> let calculateMetrics = blocks = > { <nl> let blocksCreated = getBlocksCreatedByUser ( blocks ) ; <nl> let transactionSent = getTransactionSentByUser ( blocks ) ; <nl> @ @ - 257 , 6 + 260 , 7 @ @ let calculateMetrics = blocks = > { <nl> throwAwayValues ( coinbaseReceiverChallenge ) , <nl> throwAwayValues ( createAndSendToken ) , <nl> ] ) <nl> + | > StringMap . filter ( ( key , _ ) = > { ! List . mem ( key , excludePublicKeys ) } ) <nl> | > StringMap . mapi ( ( key , _ ) = > <nl> { <nl> Types . Metrics . blocksCreated : StringMap . find_opt ( key , blocksCreated ) , <nl> 
mmm a / frontend / leaderboard / src / Points . re <nl> ppp b / frontend / leaderboard / src / Points . re <nl> Array . sort ( f , metricsArray ) ; <nl> Belt . Array . reverseInPlace ( metricsArray ) ; <nl> - metricsArray | > Array . iter ( Js . log ) ; <nl> + metricsArray <nl> + | > Array . iteri ( ( index , metric ) = > { <nl> + Js . log ( " index : " + + string_of_int ( index ) ) ; <nl> + Js . log ( " metric : " ) ; <nl> + Js . log ( metric ) ; <nl> + Js . log ( " \ n " ) ; <nl> + } ) ; <nl> let counter = ref ( 0 ) ; <nl> let topNArrayWithPoints = <nl> metricsArray <nl> - | > Array . mapi ( ( i , ( username , _ ) ) = > <nl> + | > Array . mapi ( ( i , ( username , metric ) ) = > <nl> if ( counter ^ > = Array . length ( threshholdPointsList ) ) { <nl> ( username , 0 ) ; <nl> } else { <nl> let ( place , points ) = threshholdPointsList [ counter ^ ] ; <nl> - if ( place = = i ) { <nl> + if ( i < Array . length ( metricsArray ) - 1 ) { <nl> + let challengeMetric = getMetricValue ( metric ) ; <nl> + let ( _ , nextMetric ) = metricsArray [ i + 1 ] ; <nl> + let nextChallengeMetric = getMetricValue ( nextMetric ) ; <nl> + <nl> + / / handle ties by comparing to the next metric <nl> + if ( challengeMetric ! = = nextChallengeMetric & & i > = place ) { <nl> counter : = counter ^ + 1 ; <nl> } ; <nl> + } ; <nl> ( username , points ) ; <nl> } <nl> ) ; <nl> 
mmm a / src / lib / cli_lib / commands . ml <nl> ppp b / src / lib / cli_lib / commands . ml <nl> ( let open Command . Let_syntax in <nl> let env = Secrets . Keypair . env in <nl> if Option . is_some ( Sys . getenv env ) then <nl> - printf " Using password from environment variable % s \ n " env ; <nl> + eprintf " Using password from environment variable % s \ n " env ; <nl> let % map_open privkey_path = Flag . privkey_write_path in <nl> Exceptions . handle_nicely <nl> @ @ fun ( ) - > <nl> @ @ - 150 , 7 + 150 , 7 @ @ module Vrf = struct <nl> ( let open Command . Let_syntax in <nl> let env = Secrets . Keypair . env in <nl> if Option . is_some ( Sys . getenv env ) then <nl> - printf " Using password from environment variable % s \ n " env ; <nl> + eprintf " Using password from environment variable % s \ n " env ; <nl> let % map_open privkey_path = Flag . privkey_write_path <nl> and global_slot = <nl> flag " - - global - slot " ~ doc : " NUM Global slot to evaluate the VRF for " <nl> @ @ - 241 , 7 + 241 , 7 @ @ module Vrf = struct <nl> ( let open Command . Let_syntax in <nl> let env = Secrets . Keypair . env in <nl> if Option . is_some ( Sys . getenv env ) then <nl> - printf " Using password from environment variable % s \ n " env ; <nl> + eprintf " Using password from environment variable % s \ n " env ; <nl> let % map_open privkey_path = Flag . privkey_write_path in <nl> Exceptions . handle_nicely <nl> @ @ fun ( ) - > <nl> 
mmm a / frontend / mina - signer / src / TSTypes . ts <nl> ppp b / frontend / mina - signer / src / TSTypes . ts <nl> export type uint64 = number | bigint | string ; <nl> - export declare type publicKey = string ; <nl> - export declare type privateKey = string ; <nl> - export declare type network = " mainnet " | " testnet " ; <nl> - export declare type signableData = message | stakeDelegation | payment ; <nl> + export type publicKey = string ; <nl> + export type privateKey = string ; <nl> + export type network = " mainnet " | " testnet " ; <nl> + export type signableData = message | stakeDelegation | payment ; <nl> - export declare type keypair = { <nl> + export type keypair = { <nl> readonly privateKey : privateKey ; <nl> readonly publicKey : publicKey ; <nl> } ; <nl> - export declare type message = { <nl> + export type message = { <nl> publicKey : publicKey ; <nl> message : string ; <nl> } ; <nl> - export declare type signature = { <nl> + export type signature = { <nl> readonly field : string ; <nl> readonly scalar : string ; <nl> } ; <nl> - export declare type signed < signableData > = { <nl> + export type signed < signableData > = { <nl> readonly signature : signature ; <nl> readonly data : signableData ; <nl> } ; <nl> - export declare type stakeDelegation = { <nl> + export type stakeDelegation = { <nl> readonly to : publicKey ; <nl> readonly from : publicKey ; <nl> readonly fee : uint64 ; <nl> @ @ - 35 , 7 + 35 , 7 @ @ export declare type stakeDelegation = { <nl> readonly validUntil ? : uint32 ; <nl> } ; <nl> - export declare type payment = { <nl> + export type payment = { <nl> readonly to : publicKey ; <nl> readonly from : publicKey ; <nl> readonly fee : uint64 ; <nl> 
mmm a / frontend / mina - signer / src / MinaSDK . ts <nl> ppp b / frontend / mina - signer / src / MinaSDK . ts <nl> payment : payment , <nl> privateKey : privateKey <nl> ) : signed < payment > { <nl> - const memo = payment . memo ? payment . memo : " " ; <nl> + const memo = payment . memo ? ? " " ; <nl> const fee = String ( payment . fee ) ; <nl> const nonce = String ( payment . nonce ) ; <nl> const amount = String ( payment . amount ) ; <nl> @ @ - 146 , 7 + 146 , 7 @ @ class Client { <nl> * / <nl> public verifyPayment ( signedPayment : signed < payment > ) : boolean { <nl> const payload = signedPayment . data ; <nl> - const memo = payload . memo ? payload . memo : " " ; <nl> + const memo = payload . memo ? ? " " ; <nl> const fee = String ( payload . fee ) ; <nl> const amount = String ( payload . amount ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> @ @ - 189 , 7 + 189 , 7 @ @ class Client { <nl> stakeDelegation : stakeDelegation , <nl> privateKey : privateKey <nl> ) : signed < stakeDelegation > { <nl> - const memo = stakeDelegation . memo ? stakeDelegation . memo : " " ; <nl> + const memo = stakeDelegation . memo ? ? " " ; <nl> const fee = String ( stakeDelegation . fee ) ; <nl> const nonce = String ( stakeDelegation . nonce ) ; <nl> const validUntil = String ( <nl> @ @ - 232 , 7 + 232 , 7 @ @ class Client { <nl> signedStakeDelegation : signed < stakeDelegation > <nl> ) : boolean { <nl> const payload = signedStakeDelegation . data ; <nl> - const memo = payload . memo ? payload . memo : " " ; <nl> + const memo = payload . memo ? ? " " ; <nl> const fee = String ( payload . fee ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> const validUntil = String ( <nl> @ @ - 265 , 7 + 265 , 7 @ @ class Client { <nl> * / <nl> public hashPayment ( signedPayment : signed < payment > ) : string { <nl> const payload = signedPayment . data ; <nl> - const memo = payload . memo ? payload . memo : " " ; <nl> + const memo = payload . memo ? ? " " ; <nl> const fee = String ( payload . fee ) ; <nl> const amount = String ( payload . amount ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> @ @ - 302 , 7 + 302 , 7 @ @ class Client { <nl> signedStakeDelegation : signed < stakeDelegation > <nl> ) : string { <nl> const payload = signedStakeDelegation . data ; <nl> - const memo = payload . memo ? payload . memo : " " ; <nl> + const memo = payload . memo ? ? " " ; <nl> const fee = String ( payload . fee ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> const validUntil = String ( <nl> 
mmm a / frontend / mina - signer / src / MinaSDK . ts <nl> ppp b / frontend / mina - signer / src / MinaSDK . ts <nl> - <nl> const JSOfOCaml_SDK = require ( " . / client_sdk . bc . js " ) ; <nl> const minaSDK = JSOfOCaml_SDK . minaSDK ; <nl> @ @ - 108 , 32 + 107 , 30 @ @ class Client { <nl> const fee = String ( payment . fee ) ; <nl> const nonce = String ( payment . nonce ) ; <nl> const amount = String ( payment . amount ) ; <nl> - const validUntil = String ( <nl> - payment . validUntil ? payment . validUntil : defaultValidUntil <nl> - ) ; <nl> + const validUntil = String ( payment . validUntil ? ? defaultValidUntil ) ; <nl> return { <nl> signature : minaSDK . signPayment ( this . network , privateKey , { <nl> common : { <nl> - fee : fee , <nl> + fee , <nl> feePayer : payment . from , <nl> - nonce : nonce , <nl> - validUntil : validUntil , <nl> - memo : memo , <nl> + nonce , <nl> + validUntil , <nl> + memo , <nl> } , <nl> paymentPayload : { <nl> source : payment . from , <nl> receiver : payment . to , <nl> - amount : amount , <nl> + amount , <nl> } , <nl> } ) . signature , <nl> data : { <nl> to : payment . to , <nl> from : payment . from , <nl> - fee : fee , <nl> - amount : amount , <nl> - nonce : nonce , <nl> - memo : memo , <nl> - validUntil : validUntil , <nl> + fee , <nl> + amount , <nl> + nonce , <nl> + memo , <nl> + validUntil , <nl> } , <nl> } ; <nl> } <nl> @ @ - 150 , 24 + 147 , 22 @ @ class Client { <nl> const fee = String ( payload . fee ) ; <nl> const amount = String ( payload . amount ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> - const validUntil = String ( <nl> - payload . validUntil ? payload . validUntil : defaultValidUntil <nl> - ) ; <nl> + const validUntil = String ( payload . validUntil ? ? defaultValidUntil ) ; <nl> return minaSDK . verifyPaymentSignature ( this . network , { <nl> sender : signedPayment . data . from , <nl> signature : signedPayment . signature , <nl> payment : { <nl> common : { <nl> - fee : fee , <nl> + fee , <nl> feePayer : payload . from , <nl> - nonce : nonce , <nl> - validUntil : validUntil , <nl> - memo : memo , <nl> + nonce , <nl> + validUntil , <nl> + memo , <nl> } , <nl> paymentPayload : { <nl> source : payload . from , <nl> receiver : payload . to , <nl> - amount : amount , <nl> + amount , <nl> } , <nl> } , <nl> } ) ; <nl> @ @ - 192 , 19 + 187 , 15 @ @ class Client { <nl> const memo = stakeDelegation . memo ? ? " " ; <nl> const fee = String ( stakeDelegation . fee ) ; <nl> const nonce = String ( stakeDelegation . nonce ) ; <nl> - const validUntil = String ( <nl> - stakeDelegation . validUntil <nl> - ? stakeDelegation . validUntil <nl> - : defaultValidUntil <nl> - ) ; <nl> + const validUntil = String ( stakeDelegation . validUntil ? ? defaultValidUntil ) ; <nl> return { <nl> signature : minaSDK . signStakeDelegation ( this . network , privateKey , { <nl> common : { <nl> - fee : fee , <nl> + fee , <nl> feePayer : stakeDelegation . from , <nl> - nonce : nonce , <nl> - validUntil : validUntil , <nl> - memo : memo , <nl> + nonce , <nl> + validUntil , <nl> + memo , <nl> } , <nl> delegationPayload : { <nl> newDelegate : stakeDelegation . to , <nl> @ @ - 214 , 10 + 205 , 10 @ @ class Client { <nl> data : { <nl> to : stakeDelegation . to , <nl> from : stakeDelegation . from , <nl> - fee : fee , <nl> - nonce : nonce , <nl> - memo : memo , <nl> - validUntil : validUntil , <nl> + fee , <nl> + nonce , <nl> + memo , <nl> + validUntil , <nl> } , <nl> } ; <nl> } <nl> @ @ - 235 , 19 + 226 , 17 @ @ class Client { <nl> const memo = payload . memo ? ? " " ; <nl> const fee = String ( payload . fee ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> - const validUntil = String ( <nl> - payload . validUntil ? payload . validUntil : defaultValidUntil <nl> - ) ; <nl> + const validUntil = String ( payload . validUntil ? ? defaultValidUntil ) ; <nl> return minaSDK . verifyStakeDelegationSignature ( this . network , { <nl> sender : signedStakeDelegation . data . from , <nl> signature : signedStakeDelegation . signature , <nl> stakeDelegation : { <nl> common : { <nl> - fee : fee , <nl> + fee , <nl> feePayer : payload . from , <nl> - nonce : nonce , <nl> - validUntil : validUntil , <nl> - memo : memo , <nl> + nonce , <nl> + validUntil , <nl> + memo , <nl> } , <nl> delegationPayload : { <nl> newDelegate : payload . to , <nl> @ @ - 269 , 9 + 258 , 7 @ @ class Client { <nl> const fee = String ( payload . fee ) ; <nl> const amount = String ( payload . amount ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> - const validUntil = String ( <nl> - payload . validUntil ? payload . validUntil : defaultValidUntil <nl> - ) ; <nl> + const validUntil = String ( payload . validUntil ? ? defaultValidUntil ) ; <nl> return minaSDK . hashPayment ( { <nl> sender : signedPayment . data . from , <nl> signature : signedPayment . signature , <nl> @ @ - 279 , 14 + 266 , 14 @ @ class Client { <nl> common : { <nl> fee : fee , <nl> feePayer : payload . from , <nl> - nonce : nonce , <nl> - validUntil : validUntil , <nl> - memo : memo , <nl> + nonce , <nl> + validUntil , <nl> + memo , <nl> } , <nl> paymentPayload : { <nl> source : payload . from , <nl> receiver : payload . to , <nl> - amount : amount , <nl> + amount , <nl> } , <nl> } , <nl> } ) ; <nl> @ @ - 305 , 19 + 292 , 17 @ @ class Client { <nl> const memo = payload . memo ? ? " " ; <nl> const fee = String ( payload . fee ) ; <nl> const nonce = String ( payload . nonce ) ; <nl> - const validUntil = String ( <nl> - payload . validUntil ? payload . validUntil : defaultValidUntil <nl> - ) ; <nl> + const validUntil = String ( payload . validUntil ? ? defaultValidUntil ) ; <nl> return minaSDK . hashStakeDelegation ( { <nl> sender : signedStakeDelegation . data . from , <nl> signature : signedStakeDelegation . signature , <nl> stakeDelegation : { <nl> common : { <nl> - fee : fee , <nl> + fee , <nl> feePayer : payload . from , <nl> - nonce : nonce , <nl> - validUntil : validUntil , <nl> - memo : memo , <nl> + nonce , <nl> + validUntil , <nl> + memo , <nl> } , <nl> delegationPayload : { <nl> newDelegate : payload . to , <nl> 
mmm a / frontend / mina - signer / README . md <nl> ppp b / frontend / mina - signer / README . md <nl> + # Mina Signer <nl> - This is a NodeJS client SDK that allows you to sign transactions and strings using Mina ' s keypairs for various specified networks . <nl> + This is a NodeJS SDK that allows you to sign strings , payments , and delegations using Mina ' s key pairs for various specified networks . <nl> # Install <nl> @ @ - 12 , 53 + 12 , 45 @ @ npm install - - save mina - signer <nl> # Usage <nl> - Typescript : <nl> - <nl> - ` ` ` typescript <nl> + ` ` ` js <nl> import Client from " mina - signer " ; <nl> const client = new Client ( { network : " mainnet " } ) ; <nl> - let keys = client . genKeys ( ) ; <nl> - let signed = client . signMessage ( " hello " , keys ) ; <nl> + <nl> + / / Generate keys <nl> + let keypair = client . genKeys ( ) ; <nl> + <nl> + / / Sign and verify message <nl> + let signed = client . signMessage ( " hello " , keypair ) ; <nl> if ( client . verifyMessage ( signed ) ) { <nl> console . log ( " Message was verified successfully " ) ; <nl> } <nl> + / / Sign and verify a payment <nl> let signedPayment = client . signPayment ( <nl> { <nl> - to : keys . publicKey , <nl> - from : keys . publicKey , <nl> + to : keypair . publicKey , <nl> + from : keypair . publicKey , <nl> amount : 1 , <nl> fee : 1 , <nl> nonce : 0 , <nl> } , <nl> - keys . privateKey <nl> + keypair . privateKey <nl> ) ; <nl> - ` ` ` <nl> - <nl> - NodeJS : <nl> - <nl> - ` ` ` javascript <nl> - const Client = require ( " mina - signer " ) ; <nl> - const client = new Client ( { network : " mainnet " } ) ; <nl> - let keys = client . genKeys ( ) ; <nl> - let signed = client . signMessage ( " hello " , keys ) ; <nl> - if ( client . verifyMessage ( signed ) ) { <nl> - console . log ( " Message was verified successfully " ) ; <nl> + if ( client . verifyPayment ( signedPayment ) ) { <nl> + console . log ( " Payment was verified successfully " ) ; <nl> } <nl> - let signedPayment = client . signPayment ( <nl> + / / Sign and verify a stake delegation <nl> + const signedDelegation = client . signStakeDelegation ( <nl> { <nl> - to : keys . publicKey , <nl> - from : keys . publicKey , <nl> - amount : 1 , <nl> - fee : 1 , <nl> - nonce : 0 , <nl> + to : keypair . publicKey , <nl> + from : keypair . publicKey , <nl> + fee : " 1 " , <nl> + nonce : " 0 " , <nl> } , <nl> - keys . privateKey <nl> + keypair . privateKey <nl> ) ; <nl> + if ( client . verifyStakeDelegation ( signedDelegation ) ) { <nl> + console . log ( " Delegation was verified successfully " ) ; <nl> + } <nl> ` ` ` <nl> - <nl> - # API Reference <nl> - <nl> - - [ Main API ] ( src / MinaSDK . d . ts ) <nl> - - [ Types ] ( src / TSTypes . ts ) <nl> 
mmm a / frontend / mina - signer / src / MinaSigner . ts <nl> ppp b / frontend / mina - signer / src / MinaSigner . ts <nl> private network : network ; <nl> constructor ( options : { network : network } ) { <nl> - if ( options . network ! = = " mainnet " & & options . network ! = = " testnet " ) { <nl> + const specifiedNetwork = options . network . toLowerCase ( ) ; <nl> + if ( specifiedNetwork ! = = " mainnet " & & specifiedNetwork ! = = " testnet " ) { <nl> throw " Invalid Specified Network " ; <nl> } <nl> - this . network = options . network ; <nl> + this . network = specifiedNetwork ; <nl> } <nl> / * * <nl> 
mmm a / frontend / mina - signer / src / MinaSigner . ts <nl> ppp b / frontend / mina - signer / src / MinaSigner . ts <nl> private network : network ; <nl> constructor ( options : { network : network } ) { <nl> + if ( ! options ? . network ) { <nl> + throw " Invalid Specified Network " ; <nl> + } <nl> const specifiedNetwork = options . network . toLowerCase ( ) ; <nl> if ( specifiedNetwork ! = = " mainnet " & & specifiedNetwork ! = = " testnet " ) { <nl> throw " Invalid Specified Network " ; <nl> 
mmm a / src / lib / fields_derivers_snapps / fields_derivers_snapps . ml <nl> ppp b / src / lib / fields_derivers_snapps / fields_derivers_snapps . ml <nl> iso_string obj ~ name : " Field " ~ doc : " String representing an Fp Field element " <nl> ~ to_string : Field . to_string ~ of_string : Field . of_string <nl> + let public_key obj : _ Unified_input . t = <nl> + iso_string obj ~ name : " Field " <nl> + ~ doc : " String representing a public key in base58 " <nl> + ~ to_string : Signature_lib . Public_key . Compressed . to_string <nl> + ~ of_string : Signature_lib . Public_key . Compressed . of_base58_check_exn <nl> + <nl> let int obj : _ Unified_input . t = <nl> let _a = Fields_derivers_graphql . Graphql_fields . int obj in <nl> let _b = Fields_derivers_json . To_yojson . int obj in <nl> @ @ - 153 , 6 + 159 , 7 @ @ include Derivers <nl> let % test_module " Test " = <nl> ( module struct <nl> module Field = Pickles . Impls . Step . Field . Constant <nl> + module Public_key = Signature_lib . Public_key . Compressed <nl> module Or_ignore_test = struct <nl> type ' a t = Check of ' a | Ignore [ @ @ deriving compare , sexp , equal ] <nl> @ @ - 225 , 4 + 232 , 31 @ @ let % test_module " Test " = <nl> let % test_unit " roundtrip json ' " = <nl> let open Derivers in <nl> [ % test_eq : V2 . t ] ( of_json v2 ( to_json v2 V2 . v ) ) V2 . v <nl> + <nl> + module V3 = struct <nl> + type t = { public_key : Public_key . t } <nl> + [ @ @ deriving compare , sexp , equal , fields ] <nl> + <nl> + let v = <nl> + { public_key = <nl> + Public_key . of_base58_check_exn <nl> + " B62qoTqMG41DFgkyQmY2Pos1x671Gfzs9k8NKqUdSg7wQasEV6qnXQP " <nl> + } <nl> + <nl> + let derivers obj = <nl> + let open Derivers in <nl> + Fields . make_creator obj ~ public_key : ! . public_key | > finish ~ name : " V3 " <nl> + end <nl> + <nl> + let v3 = V3 . derivers @ @ Derivers . o ( ) <nl> + <nl> + let % test_unit " to_json ' " = <nl> + let open Derivers in <nl> + [ % test_eq : string ] <nl> + ( Yojson . Safe . to_string ( to_json v3 V3 . v ) ) <nl> + { | { " publicKey " : " B62qoTqMG41DFgkyQmY2Pos1x671Gfzs9k8NKqUdSg7wQasEV6qnXQP " } | } <nl> + <nl> + let % test_unit " roundtrip json ' " = <nl> + let open Derivers in <nl> + [ % test_eq : V3 . t ] ( of_json v3 ( to_json v3 V3 . v ) ) V3 . v <nl> end ) <nl> 
mmm a / packages / jss - plugin - default - unit / src / defaultUnits . js <nl> ppp b / packages / jss - plugin - default - unit / src / defaultUnits . js <nl> ' font - size ' : px , <nl> ' font - size - delta ' : px , <nl> ' letter - spacing ' : px , <nl> + ' text - decoration - thickness ' : px , <nl> ' text - indent ' : px , <nl> ' text - stroke ' : px , <nl> ' text - stroke - width ' : px , <nl> 
mmm a / views / cube / cube_samplepack . pug <nl> ppp b / views / cube / cube_samplepack . pug <nl> . row <nl> . col - md - 6 <nl> h5 . card - title Sample Pack <nl> - . col - md - 6 <nl> - a . float - right ( href = ` / cube / samplepackimage / $ { cube_id } / $ { seed } ` ) Get Image <nl> + . col - md - 6 . text - right <nl> + a . btn . btn - success . mr - 2 ( href = ` / cube / samplepack / $ { cube_id } ` ) New Pack <nl> + a . btn . btn - success ( href = ` / cube / samplepackimage / $ { cube_id } / $ { seed } ` ) Get Image <nl> . card - body <nl> . samplepack . row <nl> if pack <nl> 
mmm a / src / header . js <nl> ppp b / src / header . js <nl> toString : function ( ) { return " nil " ; } , <nl> to_write : function ( ) { return " ( ) " ; } , <nl> to_array : function ( ) { return [ ] ; } , <nl> + to_set : function ( ) { return new BiwaScheme . Set ( ) ; } , <nl> length : function ( ) { return 0 ; } <nl> } ; <nl> 
mmm a / src / platforms / browser / dumper . js <nl> ppp b / src / platforms / browser / dumper . js <nl> } , <nl> dump_closure : function ( cls ) { <nl> + if ( ! cls ) return " * * BROKEN * * " ; <nl> if ( cls . length = = 0 ) return " [ ] " ; <nl> var cls_num = null ; <nl> @ @ - 127 , 7 + 128 , 7 @ @ BiwaScheme . Dumper = BiwaScheme . Class . create ( { <nl> } <nl> var c = _ . clone ( cls ) ; <nl> - var body = c . shift ( ) ; <nl> + var body = c . shift & & c . shift ( ) ; <nl> return [ <nl> " c " , cls_num , " < span class = ' dump_closure ' > free vars : < / span > " , <nl> this . dump_obj ( c ) , " < span class = ' dump_closure ' > body : < / span > " , <nl> 
mmm a / src / system / parser . js <nl> ppp b / src / system / parser . js <nl> + import { nil } from " . . / header . js " <nl> + import { inspect } from " . / _writer . js " <nl> + import Char from " . / char . js " <nl> import Class from " . / class . js " <nl> + import { BiwaError } from " . / error . js " <nl> import { Pair } from " . / pair . js " <nl> - import _ from " . . / deps / underscore - 1 . 10 . 2 - esm . js " <nl> + import { Sym } from " . / symbol . js " <nl> / / <nl> / / Parser <nl> @ @ - 16 , 7 + 21 , 7 @ @ const Parser = Class . create ( { <nl> return [ <nl> " # < Parser : " , <nl> this . i , " / " , this . tokens . length , " " , <nl> - BiwaScheme . inspect ( this . tokens ) , <nl> + inspect ( this . tokens ) , <nl> " > " <nl> ] . join ( " " ) ; <nl> } , <nl> @ @ - 39 , 7 + 44 , 7 @ @ const Parser = Class . create ( { <nl> if ( / ( . * \ | # ) / . test ( t ) ) { <nl> in_srfi_30_comment - - ; <nl> if ( in_srfi_30_comment < 0 ) { <nl> - throw new BiwaScheme . Error ( " Found an extra comment terminator : ` | # ' " ) <nl> + throw new BiwaError ( " Found an extra comment terminator : ` | # ' " ) <nl> } <nl> / / Push back the rest substring to input stream . <nl> return t . substring ( RegExp . $ 1 . length , t . length ) ; <nl> @ @ - 65 , 15 + 70 , 15 @ @ const Parser = Class . create ( { <nl> return r ; <nl> r = this . getObject ( ) ; <nl> - if ( r = = BiwaScheme . Parser . EOS ) <nl> - throw new BiwaScheme . Error ( " Readable object not found after S exression comment " ) ; <nl> + if ( r = = Parser . EOS ) <nl> + throw new BiwaError ( " Readable object not found after S exression comment " ) ; <nl> r = this . getObject ( ) ; <nl> return r ; <nl> } , <nl> getList : function ( close ) { <nl> - var list = BiwaScheme . nil , prev = list ; <nl> + var list = nil , prev = list ; <nl> while ( this . i < this . tokens . length ) { <nl> this . eatObjectsInSexpComment ( " Input stream terminated unexpectedly ( in list ) " ) ; <nl> @ @ - 85 , 12 + 90 , 12 @ @ const Parser = Class . create ( { <nl> if ( this . tokens [ this . i ] = = ' . ' ) { <nl> this . i + + ; <nl> var o = this . getObject ( ) ; <nl> - if ( o ! = BiwaScheme . Parser . EOS & & list ! = BiwaScheme . nil ) { <nl> + if ( o ! = Parser . EOS & & list ! = nil ) { <nl> prev . cdr = o ; <nl> } <nl> } else { <nl> - var cur = new BiwaScheme . Pair ( this . getObject ( ) , BiwaScheme . nil ) ; <nl> - if ( list = = BiwaScheme . nil ) list = cur ; <nl> + var cur = new Pair ( this . getObject ( ) , nil ) ; <nl> + if ( list = = nil ) list = cur ; <nl> else prev . cdr = cur ; <nl> prev = cur ; <nl> } <nl> @ @ - 115 , 14 + 120 , 14 @ @ const Parser = Class . create ( { <nl> eatObjectsInSexpComment : function ( err_msg ) { <nl> while ( this . tokens [ this . i ] = = ' # ; ' ) { <nl> this . i + + ; <nl> - if ( ( this . getObject ( ) = = BiwaScheme . Parser . EOS ) | | ( this . i > = this . tokens . length ) ) <nl> - throw new BiwaScheme . Error ( err_msg ) ; <nl> + if ( ( this . getObject ( ) = = Parser . EOS ) | | ( this . i > = this . tokens . length ) ) <nl> + throw new BiwaError ( err_msg ) ; <nl> } <nl> } , <nl> getObject0 : function ( ) { <nl> if ( this . i > = this . tokens . length ) <nl> - return BiwaScheme . Parser . EOS ; <nl> + return Parser . EOS ; <nl> var t = this . tokens [ this . i + + ] ; <nl> / / if ( t = = ' ) ' ) return null ; <nl> @ @ - 136 , 7 + 141 , 7 @ @ const Parser = Class . create ( { <nl> t = = " , @ " ? ' unquote - splicing ' : false ; <nl> if ( s | | t = = ' ( ' | | t = = ' # ( ' | | t = = ' [ ' | | t = = ' # [ ' | | t = = ' { ' | | t = = ' # { ' ) { <nl> - return s ? new BiwaScheme . Pair ( BiwaScheme . Sym ( s ) , new BiwaScheme . Pair ( this . getObject ( ) , BiwaScheme . nil ) ) <nl> + return s ? new Pair ( Sym ( s ) , new Pair ( this . getObject ( ) , nil ) ) <nl> : ( t = = ' ( ' | | t = = ' [ ' | | t = = ' { ' ) ? this . getList ( t ) : this . getVector ( t ) ; <nl> } <nl> else { <nl> @ @ - 164 , 32 + 169 , 32 @ @ const Parser = Class . create ( { <nl> } else if ( t = = ' # t ' | | t = = ' # T ' ) { <nl> return true ; <nl> } else if ( t . toLowerCase ( ) = = ' # \ \ newline ' ) { <nl> - return BiwaScheme . Char . get ( ' \ n ' ) ; <nl> + return Char . get ( ' \ n ' ) ; <nl> } else if ( t . toLowerCase ( ) = = ' # \ \ space ' ) { <nl> - return BiwaScheme . Char . get ( ' ' ) ; <nl> + return Char . get ( ' ' ) ; <nl> } else if ( t . toLowerCase ( ) = = ' # \ \ tab ' ) { <nl> - return BiwaScheme . Char . get ( ' \ t ' ) ; <nl> + return Char . get ( ' \ t ' ) ; <nl> } else if ( / ^ # \ \ . $ / . test ( t ) ) { <nl> - return BiwaScheme . Char . get ( t . charAt ( 2 ) ) ; <nl> + return Char . get ( t . charAt ( 2 ) ) ; <nl> } else if ( / ^ # \ \ x [ a - zA - Z0 - 9 ] + $ / . test ( t ) ) { <nl> var scalar = parseInt ( t . slice ( 3 ) , 16 ) ; <nl> / / R6RS 11 . 11 ( surrogate codepoints ) <nl> if ( scalar > = 0xD800 & & scalar < = 0xDFFF ) { <nl> - throw new BiwaScheme . Error ( " Character in Unicode excluded range . " ) ; <nl> + throw new BiwaError ( " Character in Unicode excluded range . " ) ; <nl> } <nl> / / ECMA - 262 4 . 3 . 16 - - Basically , strings are sequences of 16 - bit <nl> / / unsigned integers , so anything greater than 0xFFFF won ' t fit . <nl> / / NOTE : This violates R6RS which requires the full Unicode range ! <nl> else if ( scalar > 0xFFFF ) { <nl> - throw new BiwaScheme . Error ( " Character literal out of range . " ) ; <nl> + throw new BiwaError ( " Character literal out of range . " ) ; <nl> } else { <nl> - return BiwaScheme . Char . get ( String . fromCharCode ( scalar ) ) ; <nl> + return Char . get ( String . fromCharCode ( scalar ) ) ; <nl> } <nl> } else if ( / ^ \ " ( \ \ ( . | $ ) | [ ^ \ " \ \ ] ) * \ " ? $ / . test ( t ) ) { <nl> return t . replace ( / ( \ r ? \ n | \ \ n ) / g , " \ n " ) . replace ( / ^ \ " | \ \ ( . | $ ) | \ " $ / g , function ( $ 0 , $ 1 ) { <nl> return $ 1 ? $ 1 : ' ' ; <nl> } ) ; <nl> - } else return BiwaScheme . Sym ( t ) ; / / 2Do : validate ! ! <nl> + } else return Sym ( t ) ; / / 2Do : validate ! ! <nl> } <nl> } <nl> } ) ; <nl> 
mmm a / Makefile <nl> ppp b / Makefile <nl> src / platforms / browser / release_initializer . js <nl> BROWSER_FILES = \ <nl> - src / deps / jquery . js \ <nl> - src / deps / underscore . js \ <nl> - src / deps / underscore . string . js \ <nl> + # src / deps / jquery . js \ <nl> + # src / deps / underscore . js \ <nl> + # src / deps / underscore . string . js \ <nl> $ ( PLAIN_FILES ) <nl> all : build <nl> - build : release / biwascheme . js release / console_biwascheme . js release / node_biwascheme . js release / biwascheme - min . js release / biwascheme - plain . js release / biwascheme - plain - min . js <nl> + build : release / biwascheme . js release / node_biwascheme . js release / biwascheme - min . js <nl> $ ( VERSION_FILE ) : $ ( VERSION_FILE_IN ) $ ( BROWSER_FILES ) VERSION Makefile <nl> cat $ < | sed - e " s / @ GIT_COMMIT @ / ` git log - 1 - - pretty = format : % H ` / " | sed - e " s / @ VERSION @ / ` cat VERSION ` / " > $ @ <nl> release / biwascheme . js : $ ( VERSION_FILE ) $ ( BROWSER_FILES ) Makefile <nl> - cat $ ( VERSION_FILE ) > $ @ <nl> - cat $ ( BROWSER_FILES ) > > $ @ <nl> - @ echo " Wrote " $ @ <nl> + rollup - c <nl> release / biwascheme - min . js : release / biwascheme . js <nl> - npx - - no - install uglifyjs - o $ @ release / biwascheme . js - - comments <nl> - @ echo " Wrote " $ @ <nl> - <nl> - release / biwascheme - plain . js : $ ( VERSION_FILE ) $ ( PLAIN_FILES ) Makefile <nl> - cat $ ( VERSION_FILE ) > $ @ <nl> - cat $ ( PLAIN_FILES ) > > $ @ <nl> - @ echo " Wrote " $ @ <nl> - <nl> - release / biwascheme - plain - min . js : release / biwascheme - plain . js <nl> - npx - - no - install uglifyjs - o $ @ release / biwascheme - plain . js - - comments <nl> - @ echo " Wrote " $ @ <nl> - <nl> - release / console_biwascheme . js : $ ( VERSION_FILE ) $ ( CONSOLE_FILES ) Makefile <nl> - cat $ ( VERSION_FILE ) > $ @ <nl> - cat $ ( CONSOLE_FILES ) > > $ @ <nl> - @ echo " Wrote " $ @ <nl> + rollup - c <nl> release / node_biwascheme . js : src / platforms / node / module_preamble . js release / console_biwascheme . js src / platforms / node / module_postamble . js <nl> - cat src / platforms / node / module_preamble . js > $ @ <nl> - cat release / console_biwascheme . js > > $ @ <nl> - cat src / platforms / node / module_postamble . js > > $ @ <nl> - @ echo " Wrote " $ @ <nl> + rollup - c rollup - node . config . js <nl> # <nl> # Test <nl> 
mmm a / rollup . config . js <nl> ppp b / rollup . config . js <nl> + import { VERSION } from " . / src / version . js " ; <nl> + <nl> + const banner = ` / * <nl> + * BiwaScheme $ { VERSION } - R6RS / R7RS Scheme in JavaScript <nl> + * <nl> + * Copyright ( c ) 2007 - $ { ( new Date ) . getFullYear ( ) } Yutaka HARA ( http : / / www . biwascheme . org / ) <nl> + * Licensed under the MIT license . <nl> + * / ` <nl> export default { <nl> - plugins : [ <nl> - terser ( { output : { comments : / @ license / i } } ) , <nl> - ] , <nl> input : " src / main - browser . js " , <nl> output : [ <nl> { <nl> @ @ - 11 , 13 + 16 , 15 @ @ export default { <nl> format : " iife " , <nl> name : " BiwaScheme " , <nl> strict : false , <nl> + banner : banner , <nl> } , <nl> { <nl> file : " release / biwascheme - min . js " , <nl> format : " iife " , <nl> name : " BiwaScheme " , <nl> strict : false , <nl> - plugins : [ terser ( ) ] , <nl> + banner : banner , <nl> + plugins : [ terser ( { output : { comments : / Copyright / } } ) ] , <nl> } , <nl> ] <nl> } <nl> 
mmm a / demo / repl . html <nl> ppp b / demo / repl . html <nl> < / div > <nl> - < script type = " text / javascript " src = " . . / src / development_initializer . js " > < / script > <nl> - < script type = " text / javascript " > <nl> + < script type = " module " src = " . . / src / main - browser . js " > < / script > <nl> + < script type = " module " > <nl> var on_error = function ( e ) { <nl> BiwaScheme . Port . current_error . put_string ( e . message ) ; <nl> throw ( e ) ; <nl> } ; <nl> var biwascheme = new BiwaScheme . Interpreter ( on_error ) ; <nl> - function bs_eval ( ) { <nl> + window . bs_eval = function ( ) { <nl> $ ( " # bs - console " ) . empty ( ) ; <nl> var str = $ ( " # bs - input " ) . val ( ) ; <nl> 
mmm a / test / tracer . html <nl> ppp b / test / tracer . html <nl> < script type = " text / javascript " src = " ace / theme - dawn . js " charset = " utf - 8 " > < / script > <nl> < script type = " text / javascript " src = " ace / mode - clojure . js " charset = " utf - 8 " > < / script > <nl> - < script type = " text / javascript " src = " . . / src / development_initializer . js " charset = " utf - 8 " > < / script > <nl> - < script type = " text / javascript " > <nl> - var eval_it , dumper ; <nl> - <nl> - <nl> + < script type = " module " src = " . . / src / main - browser . js " charset = " utf - 8 " > < / script > <nl> + < script type = " module " > <nl> $ ( function ( ) { <nl> $ ( " # biwa_ver " ) . append ( " ( " + BiwaScheme . VERSION + " ) " ) ; <nl> var ClojureMode = require ( " ace / mode / clojure " ) . Mode ; <nl> editor . getSession ( ) . setMode ( new ClojureMode ( ) ) ; <nl> - eval_it = function ( ) { <nl> + window . eval_it = function ( ) { <nl> var show_error = function ( e ) { <nl> - Console . puts ( " Error : " + e . message ) ; <nl> + BiwaScheme . Console . puts ( " Error : " + e . message ) ; <nl> throw e ; <nl> } ; <nl> - dumper . reset ( ) ; <nl> + window . dumper . reset ( ) ; <nl> $ ( " # bs - console " ) . html ( " " ) ; <nl> var src = editor . getSession ( ) . getValue ( ) ; <nl> var intp = new BiwaScheme . Interpreter ( show_error ) ; <nl> try { <nl> var ret = intp . evaluate ( src ) ; <nl> - Console . puts ( " ; = > " + BiwaScheme . to_write ( ret ) ) ; <nl> + BiwaScheme . Console . puts ( " ; = > " + BiwaScheme . to_write ( ret ) ) ; <nl> } <nl> catch ( e ) { <nl> console . error ( e ) ; <nl> } <nl> - dumper . dump_move ( 1 ) ; <nl> + window . dumper . dump_move ( 1 ) ; <nl> } <nl> - dumper = new BiwaScheme . Dumper ( ) ; <nl> - BiwaScheme . Interpreter . dumper = dumper ; <nl> + window . dumper = new BiwaScheme . Dumper ( ) ; <nl> + BiwaScheme . Interpreter . dumper = window . dumper ; <nl> - eval_it ( ) ; <nl> + window . eval_it ( ) ; <nl> } ) ; <nl> < / script > <nl> 
mmm a / src / system / error . js <nl> ppp b / src / system / error . js <nl> import * as _ from " . . / deps / underscore - 1 . 10 . 2 - esm . js " <nl> + import { to_write } from " . / _writer . js " <nl> + import Class from " . / class . js " <nl> / / <nl> / / Errors <nl> / / <nl> const BiwaError = Class . create ( { <nl> - initialize : function ( msg ) { <nl> - this . message = " Error : " + msg ; <nl> + initialize : function ( msg , form = null ) { <nl> + const info = ( form = = = null ? " " : ` : $ { to_write ( form ) } ` ) ; <nl> + this . message = ` Error : $ { msg } $ { info } ` ; <nl> + this . form = form ; <nl> } , <nl> toString : function ( ) { <nl> return this . message ; <nl> 
mmm a / src / system / pair . js <nl> ppp b / src / system / pair . js <nl> return ary ; <nl> } , <nl> + / / Returns a new list made by applying ` func ` to each element <nl> + mapList : function ( func ) { <nl> + return array_to_list ( this . map ( func ) ) ; <nl> + } , <nl> + <nl> / / Destructively concat the given list to the receiver . <nl> / / The receiver must be a proper list . <nl> / / Returns the receiver . <nl> 
mmm a / src / system / pair . js <nl> ppp b / src / system / pair . js <nl> / / calls the given func passing each car of list <nl> / / returns cdr of last Pair <nl> + forEach : function ( func ) { <nl> + for ( var o = this ; o instanceof Pair ; o = o . cdr ) { <nl> + func ( o . car ) ; <nl> + } <nl> + return o ; <nl> + } , <nl> + <nl> + / / Alias of ` forEach ` ( for backward compatibility ) <nl> foreach : function ( func ) { <nl> for ( var o = this ; o instanceof Pair ; o = o . cdr ) { <nl> func ( o . car ) ; <nl> 
mmm a / test / tracer . html <nl> ppp b / test / tracer . html <nl> width : 500px ; <nl> height : 400px ; <nl> - float : left ; <nl> + } <nl> + # left { <nl> + float : left <nl> } <nl> div # bs - console { border : 1px solid black } <nl> < / style > <nl> < / head > <nl> < body > <nl> + < div id = " left " > <nl> < h1 > <nl> < a href = ' . . / index . html ' > BiwaScheme < / a > tracer <nl> < small id = " biwa_ver " > < / small > <nl> < input type = button value = " eval " onclick = " eval_it ( ) " > <nl> < div id = ' bs - console ' > < / div > <nl> + < / div > <nl> < input type = button value = " & lt ; & lt ; " onclick = " dumper . dump_move_to ( 0 ) " > <nl> < input type = button value = " & lt ; " onclick = " dumper . dump_move ( - 1 ) " > <nl> 
mmm a / test / tracer . html <nl> ppp b / test / tracer . html <nl> window . eval_it ( ) ; <nl> - } ) ; <nl> + document . addEventListener ( ' keydown ' , ( e ) = > { <nl> + switch ( e . key ) { <nl> + case ' j ' : window . dumper . dump_move ( + 1 ) ; break ; <nl> + case ' k ' : window . dumper . dump_move ( - 1 ) ; break ; <nl> + } <nl> + } ) ; <nl> + } ) <nl> < / script > <nl> < / body > <nl> < / html > <nl> 
mmm a / src / system / pair . js <nl> ppp b / src / system / pair . js <nl> this . cdr = cdr ; <nl> } <nl> - caar ( ) { return this . car . car ; } <nl> - cadr ( ) { return this . cdr . car ; } <nl> - cdar ( ) { return this . cdr . car ; } <nl> - cddr ( ) { return this . cdr . cdr ; } <nl> + / / Returns ` this . car . car ` . If ` err ` is given and ` this . car ` is not a pair , <nl> + / / throws ` err ` . <nl> + caar ( err ) { return this . _get ( [ " car " , " car " ] , err ) } <nl> + cadr ( err ) { return this . _get ( [ " cdr " , " car " ] , err ) } <nl> + cdar ( err ) { return this . _get ( [ " cdr " , " car " ] , err ) } <nl> + cddr ( err ) { return this . _get ( [ " cdr " , " cdr " ] , err ) } <nl> + _get ( props , err ) { <nl> + let x = this ; <nl> + props . forEach ( p = > { <nl> + if ( x . hasOwnProperty ( p ) ) { <nl> + return x [ p ] ; <nl> + } else if ( err ) { <nl> + throw err ; <nl> + } <nl> + } ) ; <nl> + return x ; <nl> + } <nl> first ( ) { return this . car ; } <nl> second ( ) { return this . cdr . car ; } <nl> 
mmm a / src / bootstrap - table . js <nl> ppp b / src / bootstrap - table . js <nl> iconsPrefix : ' fa ' , <nl> icons : { <nl> - paginationSwitchDown : ' fa - caret - square - o - down ' , <nl> - paginationSwitchUp : ' fa - caret - square - o - up ' , <nl> - refresh : ' fa - refresh ' , <nl> + paginationSwitchDown : ' fa - caret - square - down ' , <nl> + paginationSwitchUp : ' fa - caret - square - up ' , <nl> + refresh : ' fa - sync ' , <nl> toggleOff : ' fa - toggle - off ' , <nl> toggleOn : ' fa - toggle - on ' , <nl> columns : ' fa - th - list ' , <nl> 
mmm a / index . d . ts <nl> ppp b / index . d . ts <nl> - interface BootstrapTableHtml { <nl> - searchInput : string ; <nl> - searchButton : string ; <nl> - pagination : string [ ] ; <nl> - pageDropdown : string [ ] ; <nl> - inputGroup : string ; <nl> - toolbarDropdown : string [ ] ; <nl> - icon : string ; <nl> - pageDropdownItem : string ; <nl> - paginationItem : string ; <nl> - toolbarDropdownSeparator : string ; <nl> - dropdownCaret : string ; <nl> - searchClearButton : string ; <nl> - toolbarDropdownItem : string <nl> - } <nl> - <nl> interface BootstrapTableIcons { <nl> toggleOff : string ; <nl> clearSearch : string ; <nl> @ @ - 62 , 7 + 46 , 7 @ @ interface BootstrapTableEvents { <nl> ' scroll - body . bs . table ' : string <nl> } <nl> - interface BootstrapTableColumn { <nl> + export interface BootstrapTableColumn { <nl> sortName ? : any ; <nl> widthUnit ? : string ; <nl> sorter ? : any ; <nl> @ @ - 98 , 7 + 82 , 7 @ @ interface BootstrapTableColumn { <nl> cardVisible ? : boolean <nl> } <nl> - interface BootstrapTableLocale { <nl> + export interface BootstrapTableLocale { <nl> formatPaginationSwitchDown ? : ( ) = > string ; <nl> formatColumns ? : ( ) = > string ; <nl> @ @ - 141 , 7 + 125 , 7 @ @ interface BootstrapTableLocale { <nl> formatRecordsPerPage ( pageNumber : number ) : string <nl> } <nl> - interface BootstrapAjaxParams { <nl> + export interface BootstrapAjaxParams { <nl> cache : boolean ; <nl> data : { <nl> search : string ; <nl> @ @ - 157 , 7 + 141 , 7 @ @ interface BootstrapAjaxParams { <nl> success : ( results : any , textStatus ? : string , jqXHR ? : JQueryXHR ) = > any ; <nl> } <nl> - interface BootstrapTableOptions { <nl> + export interface BootstrapTableOptions { <nl> onCheck ? : ( row : any , $ element : JQuery < HTMLElement > ) = > boolean | undefined ; <nl> loadingFontSize ? : string ; <nl> onDblClickCell ? : ( field : string , value : any , row : any , $ element : JQuery < HTMLElement > ) = > boolean | undefined ; <nl> 
mmm a / static / sitemap_test . xml <nl> ppp b / static / sitemap_test . xml <nl> < priority > 0 . 80 < / priority > <nl> < / url > <nl> + < url > <nl> + < loc > https : / / www . operationcode . org / testing < / loc > <nl> + < lastmod > Sun Jul 14 2019 15 : 45 : 12 GMT + 0530 ( India Standard Time ) < / lastmod > <nl> + < priority > 0 . 80 < / priority > <nl> + < / url > <nl> < url > <nl> < loc > https : / / www . operationcode . org / who_we_serve < / loc > <nl> < lastmod > Tue Jul 09 2019 23 : 14 : 50 GMT + 0530 ( India Standard Time ) < / lastmod > <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " lint : scripts " : " eslint - - fix \ " * * / * . js \ " " , <nl> " lint : styles " : " stylelint - - fix \ " * * / * . css \ " " , <nl> - " precommit " : " lint - staged & & yarn test : changes & & node generate - sitemap . js & & git add . " , <nl> + " precommit " : " lint - staged & & yarn test : changes & & node generate - sitemap . js & & git add static / sitemap_test . xml " , <nl> " start " : " next start " , <nl> " storybook " : " start - storybook - s . / static - p 9001 - c . storybook " , <nl> " storybook : build " : " build - storybook - s . / static - c . storybook - o . storybook - dist " , <nl> 
mmm a / components / Form / MultiStepForm . js <nl> ppp b / components / Form / MultiStepForm . js <nl> onSubmit = { this . handleSubmit } <nl> render = { formikBag = > ( <nl> < Form className = { styles . MultiStepForm } onSubmit = { formikBag . handleSubmit } > <nl> - < CurrentStep { . . . formikBag } / > <nl> + < CurrentStep { . . . formikBag } stepNumber = { stepNumber } totalSteps = { steps . length } / > <nl> < div className = { styles . errorMessage } > <nl> { errorMessage & & < Alert type = " error " > { errorMessage } < / Alert > } <nl> 
mmm a / scripts / createComponent / builders . js <nl> ppp b / scripts / createComponent / builders . js <nl> / / Output generated for component ' s test file <nl> buildTestJs : componentName = > <nl> ` import React from ' react ' ; <nl> - import createSnapshotTest from ' test - utils / createSnapshotTest ' ; <nl> import { render , act } from ' @ testing - library / react ' ; <nl> import $ { componentName } from ' . . / $ { componentName } ' ; <nl> describe ( ' $ { componentName } ' , ( ) = > { <nl> - it ( ' should render with required props ' , ( ) = > { <nl> - createSnapshotTest ( < $ { componentName } > Test < / $ { componentName } > ) ; <nl> - } ) ; <nl> - <nl> - it ( ' should render with many props assigned ' , ( ) = > { <nl> - createSnapshotTest ( <nl> - < $ { componentName } className = " test - class " > <nl> - Test <nl> - < / $ { componentName } > , <nl> - ) ; <nl> - } ) ; <nl> - <nl> it ( ' should not render ' , ( ) = > { <nl> const { container } = render ( < $ { componentName } / > ) ; <nl> 
mmm a / components / SocialLoginGroup / SocialLoginGroup . css <nl> ppp b / components / SocialLoginGroup / SocialLoginGroup . css <nl> / * Github * / <nl> - . githubButton { <nl> + <nl> + / * WHITE * / <nl> + <nl> + / * . githubButton { <nl> color : # 24292e ; <nl> background : # eff3f6 ; <nl> transition : opacity 0 . 15s linear ; <nl> . githubButton : : before { <nl> border - right : # 1b1f23 1px solid ; <nl> - background : url ( " https : / / s3 - us - west - 2 . amazonaws . com / s . cdpn . io / 14082 / icon_github . png " ) 6px 6px <nl> + background - color : # eff3f6 ; <nl> + background - image : url ( " http : / / localhost : 3000 / static / images / icons / github_logo_black . svg " ) ; <nl> + background - repeat : no - repeat ; <nl> + } <nl> + <nl> + . githubButton : active , <nl> + . githubButton : hover , <nl> + . githubButton : focus { <nl> + opacity : 0 . 8 ; <nl> + cursor : pointer ; <nl> + } * / <nl> + <nl> + / * . githubButton { <nl> + color : # 24292e ; <nl> + background : # eff3f6 ; <nl> + transition : opacity 0 . 15s linear ; <nl> + border : 1px solid # 1b1f23 ; <nl> + } <nl> + <nl> + . githubButton : : before { <nl> + content : url ( " http : / / localhost : 3000 / static / images / icons / github_logo_black . svg " ) ; <nl> + border - right : # 1b1f23 1px solid ; <nl> + / * background - color : # eff3f6 ; <nl> + background - image : url ( " http : / / localhost : 3000 / static / images / icons / github_logo . svg " ) ; <nl> + background - repeat : no - repeat ; <nl> + } <nl> + <nl> + . githubButton : active , <nl> + . githubButton : hover , <nl> + . githubButton : focus { <nl> + opacity : 0 . 8 ; <nl> + cursor : pointer ; <nl> + } * / <nl> + <nl> + / * BLACK * / <nl> + . githubButton { <nl> + color : # eff3f6 ; <nl> + background : # 24292e ; <nl> + transition : opacity 0 . 15s linear ; <nl> + border : 1px solid # 1b1f23 ; <nl> + } <nl> + <nl> + . githubButton : : before { <nl> + border - right : # b0b0b0 1px solid ; <nl> + background : url ( " http : / / localhost : 3000 / static / images / icons / github_octocat_logo . svg " ) 4px 4px <nl> no - repeat ; <nl> } <nl> 
mmm a / common / constants / partners . js <nl> ppp b / common / constants / partners . js <nl> + export const PARTNER_TYPES = { <nl> + PAID : ' PAID ' , <nl> + KIND : ' IN - KIND ' , <nl> + } ; <nl> + <nl> const partners = [ <nl> { <nl> name : ' APEX Systems ' , <nl> logoSource : ` $ { s3 } partnerLogos / apex_systems . png ` , <nl> url : ' https : / / apexsystems . com ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' GitHub ' , <nl> logoSource : ` $ { s3 } partnerLogos / github . png ` , <nl> url : ' https : / / github . com ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' Slack ' , <nl> logoSource : ` $ { s3 } partnerLogos / slack . png ` , <nl> url : ' https : / / slack . com / ' , <nl> + type : PARTNER_TYPES . PAID , <nl> } , <nl> { <nl> name : ' Heroku ' , <nl> logoSource : ` $ { s3 } partnerLogos / heroku . png ` , <nl> url : ' https : / / heroku . com / ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' 1Password ' , <nl> logoSource : ` $ { s3 } partnerLogos / 1password . png ` , <nl> url : ' https : / / 1password . com / ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' US Bank ' , <nl> logoSource : ` $ { s3 } partnerLogos / usbank . png ` , <nl> url : ' https : / / usbank . com / index . html ' , <nl> + type : PARTNER_TYPES . PAID , <nl> } , <nl> { <nl> name : ' Threat Stack ' , <nl> logoSource : ` $ { s3 } partnerLogos / threat_stack . png ` , <nl> url : ' https : / / threatstack . com ' , <nl> + type : PARTNER_TYPES . PAID , <nl> } , <nl> { <nl> name : " O ' Reilly Media " , <nl> logoSource : ` $ { s3 } partnerLogos / oreilly . png ` , <nl> url : ' https : / / oreilly . com ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' HackerRank ' , <nl> logoSource : ` $ { s3 } partnerLogos / hackerrank . png ` , <nl> url : ' https : / / hackerrank . com ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' Zapier ' , <nl> logoSource : ` $ { s3 } partnerLogos / zapier . png ` , <nl> url : ' https : / / zapier . com ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> { <nl> name : ' LogRocket ' , <nl> logoSource : ` $ { s3 } partnerLogos / logrocket . png ` , <nl> url : ' https : / / logrocket . com / ' , <nl> + type : PARTNER_TYPES . KIND , <nl> } , <nl> ] ; <nl> 
mmm a / components / ReusableSections / SponsorsSection / SponsorsSection . js <nl> ppp b / components / ReusableSections / SponsorsSection / SponsorsSection . js <nl> - import Content from ' components / Content / Content ' ; <nl> + import Container from ' components / Container / Container ' ; <nl> + import Heading from ' components / Heading / Heading ' ; <nl> import PartnerLogoLink from ' components / PartnerLogoLink / PartnerLogoLink ' ; <nl> - import partners from ' common / constants / partners ' ; <nl> + import partners , { PARTNER_TYPES } from ' common / constants / partners ' ; <nl> + import styles from ' . / SponsorsSection . css ' ; <nl> + <nl> + const isPaidSponsor = partner = > partner . type = = = PARTNER_TYPES . PAID ; <nl> const SponsorsSection = ( ) = > ( <nl> - < Content <nl> - title = " Sponsors " <nl> - theme = " gray " <nl> - hasTitleUnderline <nl> - columns = { partners . map ( partner = > ( <nl> + < Container theme = " gray " > <nl> + < Heading text = " Sponsors " hasTitleUnderline headingLevel = { 3 } / > <nl> + <nl> + < Heading text = " Paid Sponsors " headingLevel = { 4 } / > <nl> + < p > <nl> + These sponsors have donated cash to help keep the mission going here at Operation Code . They <nl> + may or may not have also donated to our cause via others means . <nl> + < / p > <nl> + < div className = { styles . columnsContainer } > <nl> + { partners <nl> + . filter ( x = > isPaidSponsor ( x ) ) <nl> + . map ( partner = > ( <nl> + < PartnerLogoLink key = { partner . name } { . . . partner } size = " large " / > <nl> + ) ) } <nl> + < / div > <nl> + <nl> + < Heading text = " In - Kind Sponsors " headingLevel = { 4 } / > <nl> + < p > <nl> + The following organizations have helped Operation Code through services , products , <nl> + advertisements , scholarships , or sponsorships . We thank them for their contributions . <nl> + < / p > <nl> + < div className = { styles . columnsContainer } > <nl> + { partners <nl> + . filter ( x = > ! isPaidSponsor ( x ) ) <nl> + . map ( partner = > ( <nl> < PartnerLogoLink key = { partner . name } { . . . partner } / > <nl> ) ) } <nl> - / > <nl> + < / div > <nl> + < / Container > <nl> ) ; <nl> export default SponsorsSection ; <nl> 
mmm a / pages / donate . js <nl> ppp b / pages / donate . js <nl> < br / > <nl> < / div > <nl> < br / > <nl> - < iframe <nl> - title = " Donation Form " <nl> - src = " https : / / secure . lglforms . com / form_engine / s / BRtP7QUKyHOyEYsZROsRew " <nl> - height = " 1500px " <nl> - width = " 100 % " <nl> - style = { { <nl> - border : ' 1px solid transparent ' , <nl> - outline : ' 1px solid transparent ' , <nl> - } } <nl> + < script <nl> + src = " https : / / cdn . virtuoussoftware . com / virtuous . embed . min . js " <nl> + data - vform = " 48246BDA - 5B32 - 4206 - BA2B - E518574E4669 " <nl> + data - orgId = " 3423 " <nl> + data - isGiving = " true " <nl> + data - merchantType = " Virtuous " <nl> + data - dependencies = " [ ] " <nl> / > <nl> < / Container > <nl> < / > <nl> 
mmm a / src / tab / tab . js <nl> ppp b / src / tab / tab . js <nl> navClass : ' nav - tabs ' , <nl> activeClass : ' active ' <nl> } ; <nl> + var _tabsHash = { } ; <nl> + <nl> + var _addTabControl = function ( key , control ) <nl> + { <nl> + if ( ! _tabsHash [ key ] ) <nl> + _tabsHash [ key ] = control ; <nl> + } <nl> var controller = this . controller = function ( $ scope , $ element , $ attrs ) { <nl> var self = this ; <nl> @ @ - 91 , 6 + 98 , 8 @ @ angular . module ( ' mgcrea . ngStrap . tab ' , [ ] ) <nl> var $ tab = { } ; <nl> $ tab . defaults = defaults ; <nl> $ tab . controller = controller ; <nl> + $ tab . addTabControl = _addTabControl ; <nl> + $ tab . tabsHash = _tabsHash ; <nl> return $ tab ; <nl> } ; <nl> @ @ - 113 , 6 + 122 , 12 @ @ angular . module ( ' mgcrea . ngStrap . tab ' , [ ] ) <nl> var ngModelCtrl = controllers [ 0 ] ; <nl> var bsTabsCtrl = controllers [ 1 ] ; <nl> + / / Add a way for developers to access tab scope if needed . This allows for more fine grained control over what <nl> + / / tabs are available in the tab component <nl> + if ( attrs . tabKey ! = ' ' & & attrs . tabKey ! = undefined ) { <nl> + $ tab . addTabControl ( attrs . tabKey , bsTabsCtrl ) ; <nl> + } <nl> + <nl> / / ' ngModel ' does interfere with form validation <nl> / / and status , use ` bsActivePane ` instead to avoid it <nl> if ( ngModelCtrl ) { <nl> 
mmm a / src / component . js <nl> ppp b / src / component . js <nl> const dataExpression = dataAttr = = = ' ' ? ' { } ' : dataAttr <nl> const initExpression = this . $ el . getAttribute ( ' x - init ' ) <nl> - this . unobservedData = seedDataForCloning ? seedDataForCloning : saferEval ( dataExpression , { } ) <nl> + this . unobservedData = seedDataForCloning ? seedDataForCloning : saferEval ( dataExpression , { $ el : this . $ el } ) <nl> / * IE11 - ONLY : START * / <nl> / / For IE11 , add our magic properties to the original data for access . <nl> 
mmm a / src / Modal . js <nl> ppp b / src / Modal . js <nl> const propTypes = { <nl> isOpen : PropTypes . bool , <nl> size : PropTypes . string , <nl> - toggle : PropTypes . func . isRequired , <nl> + toggle : PropTypes . func , <nl> keyboard : PropTypes . bool , <nl> backdrop : PropTypes . oneOfType ( [ <nl> PropTypes . bool , <nl> @ @ - 90 , 7 + 90 , 7 @ @ class Modal extends React . Component { <nl> } <nl> handleEscape ( e ) { <nl> - if ( this . props . keyboard & & e . keyCode = = = 27 ) { <nl> + if ( this . props . keyboard & & e . keyCode = = = 27 & & this . props . toggle ) { <nl> this . props . toggle ( ) ; <nl> } <nl> } <nl> @ @ - 100 , 7 + 100 , 7 @ @ class Modal extends React . Component { <nl> const container = this . _dialog ; <nl> - if ( e . target & & ! container . contains ( e . target ) ) { <nl> + if ( e . target & & ! container . contains ( e . target ) & & this . props . toggle ) { <nl> this . props . toggle ( ) ; <nl> } <nl> } <nl> 
mmm a / src / utils . js <nl> ppp b / src / utils . js <nl> } ) ; <nl> return result ; <nl> } <nl> + <nl> + let warned = { } ; <nl> + <nl> + export function warnOnce ( message ) { <nl> + if ( ! warned [ message ] ) { <nl> + if ( typeof console ! = = ' undefined ' ) { <nl> + console . error ( message ) ; / / eslint - disable - line no - console <nl> + } <nl> + warned [ message ] = true ; <nl> + } <nl> + } <nl> + <nl> + export function deprecated ( propType , explanation ) { <nl> + return function validate ( props , propName , componentName , . . . rest ) { <nl> + if ( props [ propName ] ! = = null & & typeof props [ propName ] ! = = ' undefined ' ) { <nl> + warnOnce ( ` " $ { propName } " property of " $ { componentName } " has been deprecated . \ n $ { explanation } ` ) ; <nl> + } <nl> + <nl> + return propType ( props , propName , componentName , . . . rest ) ; <nl> + } ; <nl> + } <nl> 
mmm a / src / Modal . js <nl> ppp b / src / Modal . js <nl> const container = this . _dialog ; <nl> if ( e . target & & ! container . contains ( e . target ) & & this . props . toggle ) { <nl> - this . props . toggle ( ) ; <nl> + this . props . toggle ( e ) ; <nl> } <nl> } <nl> handleEscape ( e ) { <nl> if ( this . props . isOpen & & this . props . keyboard & & e . keyCode = = = 27 & & this . props . toggle ) { <nl> - this . props . toggle ( ) ; <nl> + this . props . toggle ( e ) ; <nl> } <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " cdn " : " dist / reactstrap . min . js " , <nl> " esnext " : " src " , <nl> + " sideEffects " : false , <nl> " scripts " : { <nl> " report - coverage " : " coveralls < . / coverage / lcov . info " , <nl> " test " : " cross - env BABEL_ENV = test react - scripts test - - env = jsdom " , <nl> 
mmm a / src / Input . js <nl> ppp b / src / Input . js <nl> } ; <nl> class Input extends React . Component { <nl> + constructor ( props ) { <nl> + super ( props ) ; <nl> + this . getRef = this . getRef . bind ( this ) ; <nl> + this . focus = this . focus . bind ( this ) ; <nl> + } <nl> + <nl> + getRef ( ref ) { <nl> + if ( this . props . innerRef ) { <nl> + this . props . innerRef ( ref ) ; <nl> + } <nl> + this . ref = ref ; <nl> + } <nl> + <nl> + focus ( ) { <nl> + if ( this . ref ) { <nl> + this . ref . focus ( ) ; <nl> + } <nl> + } <nl> + <nl> render ( ) { <nl> let { <nl> className , <nl> 
mmm a / src / Form . js <nl> ppp b / src / Form . js <nl> + import React , { Component } from ' react ' ; <nl> import PropTypes from ' prop - types ' ; <nl> import classNames from ' classnames ' ; <nl> import { mapToCssModules } from ' . / utils ' ; <nl> @ @ - 15 , 8 + 15 , 27 @ @ const propTypes = { <nl> const defaultProps = { <nl> tag : ' form ' , <nl> } ; <nl> + class Form extends Component { <nl> + constructor ( props ) { <nl> + super ( props ) ; <nl> + this . getRef = this . getRef . bind ( this ) ; <nl> + this . submit = this . submit . bind ( this ) ; <nl> + } <nl> - const Form = ( props ) = > { <nl> + getRef ( ref ) { <nl> + if ( this . props . innerRef ) { <nl> + this . props . innerRef ( ref ) ; <nl> + } <nl> + this . ref = ref ; <nl> + } <nl> + <nl> + submit ( ) { <nl> + if ( this . ref ) { <nl> + this . ref . submit ( ) ; <nl> + } <nl> + } <nl> + <nl> + render ( ) { <nl> const { <nl> className , <nl> cssModule , <nl> @ @ - 24 , 7 + 43 , 7 @ @ const Form = ( props ) = > { <nl> tag : Tag , <nl> innerRef , <nl> . . . attributes <nl> - } = props ; <nl> + } = this . props ; <nl> const classes = mapToCssModules ( classNames ( <nl> className , <nl> @ @ - 34 , 7 + 53 , 8 @ @ const Form = ( props ) = > { <nl> return ( <nl> < Tag { . . . attributes } ref = { innerRef } className = { classes } / > <nl> ) ; <nl> - } ; <nl> + } <nl> + } <nl> Form . propTypes = propTypes ; <nl> Form . defaultProps = defaultProps ; <nl> 
mmm a / src / utils . js <nl> ppp b / src / utils . js <nl> const fixedContent = document . querySelectorAll ( <nl> ' . fixed - top , . fixed - bottom , . is - fixed , . sticky - top ' <nl> ) [ 0 ] ; <nl> - const bodyPadding = fixedContent ? parseInt ( fixedContent . style . paddingRight | | 0 , 10 ) : 0 ; <nl> + const bodyPadding = fixedContent <nl> + ? parseInt ( fixedContent . style . paddingRight | | 0 , 10 ) <nl> + : 0 ; <nl> if ( isBodyOverflowing ( ) ) { <nl> setScrollbarWidth ( bodyPadding + scrollbarWidth ) ; <nl> @ @ - 50 , 7 + 52 , 10 @ @ export function setGlobalCssModule ( cssModule ) { <nl> export function mapToCssModules ( className = ' ' , cssModule = globalCssModule ) { <nl> if ( ! cssModule ) return className ; <nl> - return className . split ( ' ' ) . map ( c = > cssModule [ c ] | | c ) . join ( ' ' ) ; <nl> + return className <nl> + . split ( ' ' ) <nl> + . map ( c = > cssModule [ c ] | | c ) <nl> + . join ( ' ' ) ; <nl> } <nl> / * * <nl> @ @ - 98 , 7 + 103 , 9 @ @ export function warnOnce ( message ) { <nl> export function deprecated ( propType , explanation ) { <nl> return function validate ( props , propName , componentName , . . . rest ) { <nl> if ( props [ propName ] ! = = null & & typeof props [ propName ] ! = = ' undefined ' ) { <nl> - warnOnce ( ` " $ { propName } " property of " $ { componentName } " has been deprecated . \ n $ { explanation } ` ) ; <nl> + warnOnce ( <nl> + ` " $ { propName } " property of " $ { componentName } " has been deprecated . \ n $ { explanation } ` <nl> + ) ; <nl> } <nl> return propType ( props , propName , componentName , . . . rest ) ; <nl> @ @ - 108 , 7 + 115 , 10 @ @ export function deprecated ( propType , explanation ) { <nl> export function DOMElement ( props , propName , componentName ) { <nl> if ( ! ( props [ propName ] instanceof Element ) ) { <nl> return new Error ( <nl> - ' Invalid prop ` ' + propName + ' ` supplied to ` ' + componentName + <nl> + ' Invalid prop ` ' + <nl> + propName + <nl> + ' ` supplied to ` ' + <nl> + componentName + <nl> ' ` . Expected prop to be an instance of Element . Validation failed . ' <nl> ) ; <nl> } <nl> @ @ - 121 , 7 + 131 , 7 @ @ export const TransitionTimeouts = { <nl> Fade : 150 , / / $ transition - fade <nl> Collapse : 350 , / / $ transition - collapse <nl> Modal : 300 , / / $ modal - transition <nl> - Carousel : 600 , / / $ carousel - transition <nl> + Carousel : 600 / / $ carousel - transition <nl> } ; <nl> / / Duplicated Transition . propType keys to ensure that Reactstrap builds <nl> @ @ - 140 , 14 + 150 , 14 @ @ export const TransitionPropTypeKeys = [ <nl> ' onEntered ' , <nl> ' onExit ' , <nl> ' onExiting ' , <nl> - ' onExited ' , <nl> + ' onExited ' <nl> ] ; <nl> export const TransitionStatuses = { <nl> ENTERING : ' entering ' , <nl> ENTERED : ' entered ' , <nl> EXITING : ' exiting ' , <nl> - EXITED : ' exited ' , <nl> + EXITED : ' exited ' <nl> } ; <nl> export const keyCodes = { <nl> @ @ - 155 , 7 + 165 , 7 @ @ export const keyCodes = { <nl> space : 32 , <nl> tab : 9 , <nl> up : 38 , <nl> - down : 40 , <nl> + down : 40 <nl> } ; <nl> export const PopperPlacements = [ <nl> @ @ - 173 , 7 + 183 , 7 @ @ export const PopperPlacements = [ <nl> ' bottom - start ' , <nl> ' left - end ' , <nl> ' left ' , <nl> - ' left - start ' , <nl> + ' left - start ' <nl> ] ; <nl> export const canUseDOM = ! ! ( <nl> @ @ - 192 , 7 + 202 , 9 @ @ export function findDOMElements ( target ) { <nl> selection = document . querySelectorAll ( ` # $ { target } ` ) ; <nl> } <nl> if ( ! selection . length ) { <nl> - throw new Error ( ` The target ' $ { target } ' could not be identified in the dom , tip : check spelling ` ) ; <nl> + throw new Error ( <nl> + ` The target ' $ { target } ' could not be identified in the dom , tip : check spelling ` <nl> + ) ; <nl> } <nl> return selection ; <nl> } <nl> @ @ - 213 , 16 + 225 , 26 @ @ export function getTarget ( target ) { <nl> export const defaultToggleEvents = [ ' touchstart ' , ' click ' ] ; <nl> - export function addMultipleEventListeners ( els , handler , events ) { <nl> + export function addMultipleEventListeners ( _els , handler , _events ) { <nl> + let els = _els ; <nl> + if ( ! isArrayOrNodeList ( els ) ) { <nl> + els = [ els ] ; <nl> + } <nl> + <nl> + let events = _events ; <nl> + if ( typeof events = = = ' string ' ) { <nl> + events = events . split ( / \ s + / ) ; <nl> + } <nl> + <nl> if ( <nl> ! isArrayOrNodeList ( els ) | | <nl> typeof handler ! = = ' function ' | | <nl> ! Array . isArray ( events ) <nl> ) { <nl> throw new Error ( ` <nl> - The first argument of this function must be an array or NodeList . <nl> + The first argument of this function must be DOM node or an array on DOM nodes or NodeList . <nl> The second must be a function . <nl> - The third is an array of strings that represents DOM events <nl> + The third is a string or an array of strings that represents DOM events <nl> ` ) ; <nl> } <nl> events . forEach ( ( event ) = > { <nl> 
mmm a / src / Modal . js <nl> ppp b / src / Modal . js <nl> } <nl> init ( ) { <nl> + try { <nl> + this . _triggeringElement = document . activeElement ; <nl> + } catch ( err ) { <nl> + this . _triggeringElement = null ; <nl> + } <nl> this . _element = document . createElement ( ' div ' ) ; <nl> this . _element . setAttribute ( ' tabindex ' , ' - 1 ' ) ; <nl> this . _element . style . position = ' relative ' ; <nl> @ @ - 259 , 6 + 264 , 11 @ @ class Modal extends React . Component { <nl> this . _element = null ; <nl> } <nl> + if ( this . _triggeringElement ) { <nl> + this . _triggeringElement . focus ( ) ; <nl> + this . _triggeringElement = null ; <nl> + } <nl> + <nl> if ( this . bodyClassAdded ) { <nl> const modalOpenClassName = mapToCssModules ( ' modal - open ' , this . props . cssModule ) ; <nl> / / Use regex to prevent matching ` modal - open ` as part of a different class , e . g . ` my - modal - opened ` <nl> 
mmm a / src / Badge . js <nl> ppp b / src / Badge . js <nl> color : PropTypes . string , <nl> pill : PropTypes . bool , <nl> tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> + innerRef : PropTypes . oneOfType ( [ PropTypes . object , PropTypes . func , PropTypes . string ] ) , <nl> children : PropTypes . node , <nl> className : PropTypes . string , <nl> cssModule : PropTypes . object , <nl> @ @ - 23 , 6 + 24 , 7 @ @ const Badge = ( props ) = > { <nl> className , <nl> cssModule , <nl> color , <nl> + innerRef , <nl> pill , <nl> tag : Tag , <nl> . . . attributes <nl> @ @ - 40 , 7 + 42 , 7 @ @ const Badge = ( props ) = > { <nl> } <nl> return ( <nl> - < Tag { . . . attributes } className = { classes } / > <nl> + < Tag { . . . attributes } className = { classes } ref = { innerRef } / > <nl> ) ; <nl> } ; <nl> 
mmm a / src / CardBody . js <nl> ppp b / src / CardBody . js <nl> tag : PropTypes . oneOfType ( [ PropTypes . func , PropTypes . string ] ) , <nl> className : PropTypes . string , <nl> cssModule : PropTypes . object , <nl> + innerRef : PropTypes . oneOfType ( [ <nl> + PropTypes . object , <nl> + PropTypes . string , <nl> + PropTypes . func , <nl> + ] ) , <nl> } ; <nl> const defaultProps = { <nl> @ @ - 17 , 6 + 22 , 7 @ @ const CardBody = ( props ) = > { <nl> const { <nl> className , <nl> cssModule , <nl> + innerRef , <nl> tag : Tag , <nl> . . . attributes <nl> } = props ; <nl> @ @ - 26 , 7 + 32 , 7 @ @ const CardBody = ( props ) = > { <nl> ) , cssModule ) ; <nl> return ( <nl> - < Tag { . . . attributes } className = { classes } / > <nl> + < Tag { . . . attributes } className = { classes } ref = { innerRef } / > <nl> ) ; <nl> } ; <nl> 
mmm a / src / PopperContent . js <nl> ppp b / src / PopperContent . js <nl> modifiers = { extendedModifiers } <nl> placement = { placement } <nl> > <nl> - { ( { ref , style , placement , arrowProps } ) = > ( <nl> - < div ref = { ref } style = { style } className = { popperClassName } x - placement = { placement } > <nl> + { ( { ref , style , placement , outOfBoundaries , arrowProps } ) = > ( <nl> + < div ref = { ref } style = { style } className = { popperClassName } x - placement = { placement } x - out - of - boundaries = { outOfBoundaries ? ' true ' : undefined } > <nl> { children } <nl> { ! hideArrow & & < span ref = { arrowProps . ref } className = { arrowClassName } style = { arrowProps . style } / > } <nl> < / div > <nl> 
mmm a / lib / plugins / main . js <nl> ppp b / lib / plugins / main . js <nl> inject ( ' fireStore ' , fireStore ) <nl> inject ( ' fireStoreObj ' , fireStoreObj ) <nl> + const settings = options . services . firestore . settings <nl> + if ( settings ) { <nl> + fireStore . settings ( settings ) <nl> + } <nl> + <nl> const enablePersistence = options . services . firestore . enablePersistence <nl> if ( enablePersistence & & process . client ) { <nl> try { <nl> 
mmm a / lib / plugins / ssrAuth . js <nl> ppp b / lib / plugins / ssrAuth . js <nl> . . . res . locals , <nl> user : { <nl> . . . authUser , <nl> - allClaims : decodedToken <nl> + allClaims : decodedToken , <nl> + idToken , <nl> } <nl> } <nl> } <nl> 
mmm a / lib / plugins / services / analytics . js <nl> ppp b / lib / plugins / services / analytics . js <nl> - export default async function ( session ) { <nl> + export default async function ( session , firebase ) { <nl> / / Firebase Analytics can only be initiated on client side <nl> if ( ! process . client ) { <nl> return <nl> @ @ - 10 , 6 + 10 , 13 @ @ export default async function ( session ) { <nl> < % = writeImportStatement ( options ) % > <nl> < % } % > <nl> + / / Only initialize it if the Browser supports it <nl> + const isSupported = await firebase . analytics . isSupported ( ) <nl> + if ( ! isSupported ) { <nl> + console . info ( ' [ @ nuxtjs / firebase ] : Firebase Analytics was not initialized because it is not supported on this browser . ' ) <nl> + return <nl> + } <nl> + <nl> const analyticsService = session . < % = serviceMapping . id % > ( ) <nl> < % if ( ' collectionEnabled ' in serviceOptions ) { % > <nl> 
mmm a / packages / vega - typings / types / spec / config . d . ts <nl> ppp b / packages / vega - typings / types / spec / config . d . ts <nl> * / <nl> angle ? : number | SignalRef ; <nl> + / * * <nl> + * The start angle in radians for arc marks . <nl> + * / <nl> + startAngle ? : number | SignalRef ; <nl> + <nl> + / * * <nl> + * The start angle in radians for arc marks . <nl> + * / <nl> + endAngle ? : number | SignalRef ; <nl> + <nl> + / * * <nl> + * The inner radius in pixels of arc marks . <nl> + * <nl> + * @ minimum 0 <nl> + * __Default value : __ ` 0 ` <nl> + * / <nl> + innerRadius ? : number | SignalRef ; <nl> + <nl> + / * * <nl> + * The outer radius in pixels of arc marks . <nl> + * <nl> + * @ minimum 0 <nl> + * __Default value : __ ` 0 ` <nl> + * / <nl> + outerRadius ? : number | SignalRef ; <nl> + <nl> / * * <nl> * The vertical alignment of the text . One of ` " top " ` , ` " bottom " ` , ` " middle " ` , ` " alphabetic " ` . <nl> * <nl> 
mmm a / packages / vega - scale / src / caption . js <nl> ppp b / packages / vega - scale / src / caption . js <nl> import { Time , UTC } from ' . / scales / types ' ; <nl> - import { isDiscrete , isDiscretizing } from ' . / scales ' ; <nl> + import { isDiscrete , isDiscretizing , isTemporal } from ' . / scales ' ; <nl> + import { timeFormat , utcFormat } from ' vega - time ' ; <nl> import { isString , peek } from ' vega - util ' ; <nl> function format ( scale , specifier , formatType ) { <nl> const type = formatType | | scale . type ; <nl> / / replace abbreviated time specifiers to improve screen reader experience <nl> - if ( isString ( specifier ) & & ( type = = = Time | | type = = = UTC ) ) { <nl> + if ( isString ( specifier ) & & isTemporal ( type ) ) { <nl> specifier = specifier . replace ( / % a / g , ' % A ' ) . replace ( / % b / g , ' % B ' ) ; <nl> } <nl> - return ! specifier & & type = = = Time ? d = > new Date ( d ) . toLocaleString ( ) <nl> - : ! specifier & & type = = = UTC ? d = > new Date ( d ) . toUTCString ( ) <nl> + <nl> + return ! specifier & & type = = = Time ? timeFormat ( ' % A , % d % B % Y , % X ' ) <nl> + : ! specifier & & type = = = UTC ? utcFormat ( ' % A , % d % B % Y , % X UTC ' ) <nl> : labelFormat ( scale , 5 , null , specifier , formatType , true ) ; <nl> } <nl> 
mmm a / packages / vega - typings / types / spec / config . d . ts <nl> ppp b / packages / vega - typings / types / spec / config . d . ts <nl> / * * <nl> * Default [ color scheme ] ( https : / / vega . github . io / vega / docs / schemes / ) for categorical data . <nl> * / <nl> - category ? : RangeScheme | string [ ] ; <nl> + category ? : RangeScheme | Color [ ] ; <nl> / * * <nl> * Default [ color scheme ] ( https : / / vega . github . io / vega / docs / schemes / ) for diverging quantitative ramps . <nl> * / <nl> - diverging ? : RangeScheme | string [ ] ; <nl> + diverging ? : RangeScheme | Color [ ] ; <nl> / * * <nl> * Default [ color scheme ] ( https : / / vega . github . io / vega / docs / schemes / ) for quantitative heatmaps . <nl> * / <nl> - heatmap ? : RangeScheme | string [ ] ; <nl> + heatmap ? : RangeScheme | Color [ ] ; <nl> / * * <nl> * Default [ color scheme ] ( https : / / vega . github . io / vega / docs / schemes / ) for rank - ordered data . <nl> * / <nl> - ordinal ? : RangeScheme | string [ ] ; <nl> + ordinal ? : RangeScheme | Color [ ] ; <nl> / * * <nl> * Default [ color scheme ] ( https : / / vega . github . io / vega / docs / schemes / ) for sequential quantitative ramps . <nl> * / <nl> - ramp ? : RangeScheme | string [ ] ; <nl> + ramp ? : RangeScheme | Color [ ] ; <nl> / * * <nl> * Array of [ symbol ] ( https : / / vega . github . io / vega / docs / marks / symbol / ) names or paths for the default shape palette . <nl> * / <nl> 
mmm a / packages / vega - typings / types / runtime / index . d . ts <nl> ppp b / packages / vega - typings / types / runtime / index . d . ts <nl> } , <nl> ) ; <nl> + / / View Configuration <nl> + <nl> initialize ( container ? : Element | string , bindContainer ? : Element | string ) : this ; <nl> + <nl> finalize ( ) : this ; <nl> + loader ( loader : Loader ) : this ; <nl> + loader ( ) : Loader ; <nl> + <nl> logLevel ( level : number ) : this ; <nl> logLevel ( ) : number ; <nl> + <nl> logger ( logger : LoggerInterface ) : this ; <nl> logger ( ) : LoggerInterface ; <nl> renderer ( renderer : Renderers ) : this ; <nl> renderer ( ) : Renderers ; <nl> - loader ( loader : Loader ) : this ; <nl> - loader ( ) : Loader ; <nl> - <nl> - locale ( locale : LocaleFormatters ) : this ; <nl> - locale ( ) : LocaleFormatters ; <nl> + tooltip ( handler : TooltipHandler ) : this ; <nl> hover ( hoverSet ? : EncodeEntryName , leaveSet ? : EncodeEntryName ) : this ; <nl> - run ( encode ? : string ) : this ; <nl> - runAfter ( callback : ( view : this ) = > void , enqueue ? : boolean , priority ? : number ) : this ; <nl> - runAsync ( ) : Promise < View > ; <nl> - insert ( name : string , tuples : any ) : this ; <nl> - remove ( name : string , tuples : any ) : this ; <nl> - change ( name : string , changeset : Changeset ) : this ; <nl> - changeset ( ) : any ; <nl> - data ( name : string ) : any [ ] ; <nl> - data ( name : string , tuples : any ) : this ; <nl> description ( s : string ) : this ; <nl> description ( ) : string ; <nl> + background ( s : Color ) : this ; <nl> + background ( ) : Color ; <nl> + <nl> width ( w : number ) : this ; <nl> width ( ) : number ; <nl> height ( h : number ) : this ; <nl> height ( ) : number ; <nl> - origin ( ) : [ number , number ] ; <nl> - <nl> padding ( p : Padding ) : this ; <nl> padding ( ) : Padding ; <nl> resize ( ) : this ; <nl> - toImageURL ( type : string , scaleFactor ? : number ) : Promise < string > ; <nl> - toSVG ( scaleFactor ? : number ) : Promise < string > ; <nl> - toCanvas ( scaleFactor ? : number , options ? : ToCanvasOptions ) : Promise < HTMLCanvasElement > ; <nl> + / / Dataflow and Rendering <nl> + <nl> + runAsync ( ) : Promise < View > ; <nl> + <nl> + run ( encode ? : string ) : this ; <nl> + <nl> + runAfter ( callback : ( view : this ) = > void , enqueue ? : boolean , priority ? : number ) : this ; <nl> + <nl> + dirty ( item : any ) : void ; <nl> - signal ( name : string , value : SignalValue ) : this ; <nl> - signal ( name : string ) : SignalValue ; <nl> container ( ) : HTMLElement | null ; <nl> + <nl> scenegraph ( ) : Scene ; <nl> - addEventListener ( type : string , handler : EventListenerHandler ) : this ; <nl> - removeEventListener ( type : string , handler : EventListenerHandler ) : this ; <nl> - addSignalListener ( name : string , handler : SignalListenerHandler ) : this ; <nl> - removeSignalListener ( name : string , handler : SignalListenerHandler ) : this ; <nl> - addDataListener ( name : string , handler : DataListenerHandler ) : this ; <nl> - removeDataListener ( name : string , handler : DataListenerHandler ) : this ; <nl> - addResizeListener ( handler : ResizeHandler ) : this ; <nl> - removeResizeListener ( handler : ResizeHandler ) : this ; <nl> - tooltip ( handler : TooltipHandler ) : this ; <nl> + <nl> + origin ( ) : [ number , number ] ; <nl> + <nl> + / / Signals <nl> + <nl> + signal ( name : string , value : SignalValue ) : this ; <nl> + signal ( name : string ) : SignalValue ; <nl> getState ( options ? : { <nl> signals ? : ( name ? : string , operator ? : any ) = > boolean ; <nl> @ @ - 140 , 6 + 138 , 49 @ @ export class View { <nl> recurse ? : boolean ; <nl> } ) : { signals ? : any ; data ? : any } ; <nl> setState ( state : { signals ? : any ; data ? : any } ) : this ; <nl> + <nl> + addSignalListener ( name : string , handler : SignalListenerHandler ) : this ; <nl> + removeSignalListener ( name : string , handler : SignalListenerHandler ) : this ; <nl> + <nl> + / / Event Handling <nl> + <nl> + events ( source : any , type : any , filter ? : ( _ : any ) = > boolean ) : any ; <nl> + <nl> + addEventListener ( type : string , handler : EventListenerHandler ) : this ; <nl> + removeEventListener ( type : string , handler : EventListenerHandler ) : this ; <nl> + <nl> + addResizeListener ( handler : ResizeHandler ) : this ; <nl> + removeResizeListener ( handler : ResizeHandler ) : this ; <nl> + <nl> + globalCursor ( flag : boolean ) : any ; <nl> + <nl> + preventDefault ( flag : boolean ) : void ; <nl> + <nl> + / / Image Export <nl> + <nl> + toCanvas ( scaleFactor ? : number , options ? : ToCanvasOptions ) : Promise < HTMLCanvasElement > ; <nl> + toSVG ( scaleFactor ? : number ) : Promise < string > ; <nl> + toImageURL ( type : string , scaleFactor ? : number ) : Promise < string > ; <nl> + <nl> + / / Data and Scales <nl> + scale ( name : string ) : any ; <nl> + <nl> + data ( name : string ) : any [ ] ; <nl> + data ( name : string , tuples : any ) : this ; <nl> + <nl> + addDataListener ( name : string , handler : DataListenerHandler ) : this ; <nl> + removeDataListener ( name : string , handler : DataListenerHandler ) : this ; <nl> + <nl> + change ( name : string , changeset : Changeset ) : this ; <nl> + insert ( name : string , tuples : any ) : this ; <nl> + remove ( name : string , tuples : any ) : this ; <nl> + <nl> + / / Undocumented ( https : / / github . com / vega / vega / issues / 2844 , https : / / github . com / vega / vega / issues / 2845 ) <nl> + <nl> + locale ( locale : LocaleFormatters ) : this ; <nl> + locale ( ) : LocaleFormatters ; <nl> + <nl> + changeset ( ) : Changeset ; <nl> } <nl> export type ScenegraphEvent = MouseEvent | TouchEvent | KeyboardEvent ; <nl> 
mmm a / packages / vega - typings / types / runtime / index . d . ts <nl> ppp b / packages / vega - typings / types / runtime / index . d . ts <nl> externalContext ? : any ; <nl> } <nl> - export class View { <nl> - constructor ( <nl> - runtime : Runtime , <nl> - opt ? : { <nl> + export interface ViewOptions { <nl> background ? : Color ; <nl> bind ? : Element | string ; <nl> container ? : Element | string ; <nl> @ @ - 70 , 8 + 67 , 10 @ @ export class View { <nl> tooltip ? : TooltipHandler ; <nl> locale ? : LocaleFormatters ; <nl> expr ? : any ; <nl> - } , <nl> - ) ; <nl> + } <nl> + <nl> + export class View { <nl> + constructor ( runtime : Runtime , opt ? : ViewOptions ) ; <nl> / / View Configuration <nl> 
mmm a / packages / vega - typings / types / runtime / scene . d . ts <nl> ppp b / packages / vega - typings / types / runtime / scene . d . ts <nl> } ; <nl> x : number ; <nl> y : number ; <nl> + opacity ? : number ; <nl> } <nl> export type SceneAxis = SceneItem & { <nl> @ @ - 58 , 12 + 59 , 16 @ @ export type SceneAxis = SceneItem & { <nl> export type SceneRect = SceneItem & { <nl> fill : string ; <nl> + fillOpacity ? : number ; <nl> + stroke ? : string ; <nl> + strokeWidth ? : number ; <nl> + strokeOpacity ? : number ; <nl> height : number ; <nl> width : number ; <nl> + cornerRadius ? : number ; <nl> } ; <nl> export type SceneLine = SceneItem & { <nl> - opacity : number ; <nl> stroke : string ; <nl> strokeWidth : number ; <nl> x2 : number ; <nl> @ @ - 84 , 9 + 89 , 12 @ @ export type SceneGroup = SceneItem & { <nl> export type SceneSymbol = SceneItem & { <nl> fill : string ; <nl> + fillOpacity ? : number ; <nl> shape : string ; <nl> size : number ; <nl> - strokeWidth : number ; <nl> + stroke ? : string ; <nl> + strokeWidth ? : number ; <nl> + strokeOpacity ? : number ; <nl> } ; <nl> export type SceneTextBaseline = ' top ' | ' middle ' | ' bottom ' ; <nl> 
mmm a / packages / rnv / src / platformTools / tizen / index . js <nl> ppp b / packages / rnv / src / platformTools / tizen / index . js <nl> return { } ; <nl> } ; <nl> + const DEFAULT_SECURITY_PROFILE_NAME = ' RNVanillaCert ' ; <nl> + const DEFAULT_CERTIFICATE_NAME = ' tizen_author ' ; <nl> + const DEFAULT_CERTIFICATE_NAME_WITH_EXTENSION = ` $ { DEFAULT_CERTIFICATE_NAME } . p12 ` ; <nl> + <nl> export const configureTizenGlobal = c = > new Promise ( ( resolve , reject ) = > { <nl> logTask ( ' configureTizenGlobal ' ) ; <nl> / / Check Tizen Cert <nl> / / if ( isPlatformActive ( c , TIZEN ) | | isPlatformActive ( c , TIZEN_WATCH ) ) { <nl> - const tizenAuthorCert = path . join ( <nl> - c . paths . workspace . dir , <nl> - ' tizen_author . p12 ' <nl> - ) ; <nl> + const tizenAuthorCert = path . join ( c . paths . workspace . dir , DEFAULT_CERTIFICATE_NAME_WITH_EXTENSION ) ; <nl> if ( fs . existsSync ( tizenAuthorCert ) ) { <nl> - logDebug ( ' tizen_author . p12 file exists ! ' ) ; <nl> + logDebug ( ` $ { DEFAULT_CERTIFICATE_NAME_WITH_EXTENSION } file exists ! ` ) ; <nl> resolve ( ) ; <nl> } else { <nl> logWarning ( <nl> - ' tizen_author . p12 file missing ! Creating one for you . . . ' <nl> + ` $ { DEFAULT_CERTIFICATE_NAME_WITH_EXTENSION } file missing ! Creating one for you . . . ` <nl> ) ; <nl> createDevelopTizenCertificate ( c ) <nl> . then ( ( ) = > resolve ( ) ) <nl> @ @ - 109 , 12 + 110 , 20 @ @ export const listTizenTargets = async ( c , name ) = > { <nl> export const createDevelopTizenCertificate = c = > new Promise ( ( resolve , reject ) = > { <nl> logTask ( ' createDevelopTizenCertificate ' ) ; <nl> + const certDirPath = c . paths . workspace . dir ; <nl> + const certFilename = DEFAULT_CERTIFICATE_NAME ; <nl> + const certPassword = ' 1234 ' ; <nl> + <nl> execCLI ( <nl> c , <nl> CLI_TIZEN , <nl> - ` certificate - - $ { c . paths . workspace . dir } - a rnv - f tizen_author - p 1234 ` <nl> + ` certificate - - $ { certDirPath } - a rnv - f $ { certFilename } - p $ { certPassword } ` , <nl> ) <nl> - . then ( ( ) = > addDevelopTizenCertificate ( c ) ) <nl> + . then ( ( ) = > addDevelopTizenCertificate ( c , { <nl> + profileName : DEFAULT_SECURITY_PROFILE_NAME , <nl> + certPath : path . join ( certDirPath , ` $ { certFilename } . p12 ` ) , <nl> + certPassword , <nl> + } ) ) <nl> . then ( ( ) = > resolve ( ) ) <nl> . catch ( ( e ) = > { <nl> logError ( e ) ; <nl> @ @ - 122 , 16 + 131 , 14 @ @ export const createDevelopTizenCertificate = c = > new Promise ( ( resolve , reject ) <nl> } ) ; <nl> } ) ; <nl> - export const addDevelopTizenCertificate = c = > new Promise ( ( resolve ) = > { <nl> + export const addDevelopTizenCertificate = ( c , secureProfileConfig ) = > new Promise ( ( resolve ) = > { <nl> logTask ( ' addDevelopTizenCertificate ' ) ; <nl> + const { profileName , certPath , certPassword } = secureProfileConfig | | { } ; <nl> execCLI ( <nl> c , <nl> CLI_TIZEN , <nl> - ` security - profiles add - n RNVanillaCert - a $ { path . join ( <nl> - c . paths . workspace . dir , <nl> - ' tizen_author . p12 ' <nl> - ) } - p 1234 ` <nl> + ` security - profiles add - n $ { profileName } - a $ { certPath } - p $ { certPassword } ` , <nl> ) <nl> . then ( ( ) = > resolve ( ) ) <nl> . catch ( ( e ) = > { <nl> @ @ - 285 , 7 + 292 , 7 @ @ export const runTizen = async ( c , platform , target ) = > { <nl> const tOut = path . join ( tDir , ' output ' ) ; <nl> const tId = platformConfig . id ; <nl> const wgt = ` $ { platformConfig . appName } . wgt ` ; <nl> - const certProfile = platformConfig . certificateProfile ? ? ' RNVanillaCert ' ; <nl> + const certProfile = platformConfig . certificateProfile ? ? DEFAULT_SECURITY_PROFILE_NAME ; <nl> let deviceID ; <nl> @ @ - 472 , 7 + 479 , 7 @ @ export const buildTizenProject = async ( c , platform ) = > { <nl> if ( ! c . program . hosted ) { <nl> const tOut = path . join ( tDir , ' output ' ) ; <nl> const tBuild = path . join ( tDir , ' build ' ) ; <nl> - const certProfile = platformConfig . certificateProfile ? ? ' RNVanillaCert ' ; <nl> + const certProfile = platformConfig . certificateProfile ? ? DEFAULT_SECURITY_PROFILE_NAME ; <nl> await execCLI ( c , CLI_TIZEN , ` build - web - - $ { tDir } - out $ { tBuild } ` ) ; <nl> await execCLI ( <nl> 
mmm a / packages / rnv / src / core / engineManager / index . js <nl> ppp b / packages / rnv / src / core / engineManager / index . js <nl> + import { logDebug , logTask , logInitTask , logExitTask , chalk , logInfo , logError } from ' . . / systemManager / logger ' ; <nl> import { getConfigProp } from ' . . / common ' ; <nl> import Analytics from ' . . / systemManager / analytics ' ; <nl> - import { <nl> - executePipe <nl> - } from ' . . / projectManager / buildHooks ' ; <nl> + import { executePipe } from ' . . / projectManager / buildHooks ' ; <nl> import { inquirerPrompt } from ' . . / . . / cli / prompt ' ; <nl> const REGISTERED_ENGINES = [ ] ; <nl> @ @ - 131 , 6 + 129 , 7 @ @ export const findSuitableTask = async ( c ) = > { <nl> } ; <nl> } ) ; <nl> } ) ; <nl> + <nl> const taskInstances = Object . values ( suitableTaskInstances ) ; <nl> let tasks ; <nl> let defaultCmd = ' new ' ; <nl> @ @ - 161 , 34 + 160 , 76 @ @ export const findSuitableTask = async ( c ) = > { <nl> if ( c . subCommand ) task + = ` $ { c . subCommand } ` ; <nl> let suitableEngines = REGISTERED_ENGINES . filter ( engine = > engine . hasTask ( task ) ) ; <nl> + const isAutoComplete = ! suitableEngines . length & & ! ! c . command ; <nl> + const message = isAutoComplete ? ` Autocomplete action for " $ { c . command } " ` : ` Pick a subCommand for $ { c . command } ` ; <nl> if ( ! suitableEngines . length ) { <nl> - const supportedSubtasks = { } ; <nl> + / / Get all supported tasks <nl> + const supportedSubtasksArr = [ ] ; <nl> REGISTERED_ENGINES . forEach ( ( engine ) = > { <nl> engine . getSubTasks ( task ) . forEach ( ( taskInstance ) = > { <nl> - const taskKey = taskInstance . task . replace ( task , ' ' ) . trim ( ) ; <nl> - const desc = taskInstance . description ? ` ( $ { taskInstance . description } ) ` : ' ' ; <nl> - const key = ` $ { taskKey } $ { chalk ( ) . grey ( desc ) } ` ; <nl> - supportedSubtasks [ key ] = { <nl> + const taskKey = isAutoComplete ? taskInstance . task : taskInstance . task . split ( ' ' ) [ 1 ] ; <nl> + <nl> + supportedSubtasksArr . push ( { <nl> + desc : taskInstance . description ? . toLowerCase ? . ( ) , <nl> taskKey <nl> - } ; <nl> } ) ; <nl> } ) ; <nl> + } ) ; <nl> + const supportedSubtasks = { } ; <nl> + / / Normalize task options <nl> + const supportedSubtasksFilter = { } ; <nl> + supportedSubtasksArr . forEach ( ( tsk ) = > { <nl> + const mergedTask = supportedSubtasksFilter [ tsk . taskKey ] ; <nl> + if ( ! mergedTask ) { <nl> + supportedSubtasksFilter [ tsk . taskKey ] = tsk ; <nl> + } else if ( ! mergedTask . desc . includes ( tsk . desc ) ) { <nl> + mergedTask . desc + = ` , $ { tsk . desc } ` ; <nl> + } <nl> + } ) ; <nl> + / / Generate final list object <nl> + Object . values ( supportedSubtasksFilter ) . forEach ( ( v ) = > { <nl> + const desc = v . desc ? ` ( $ { v . desc } ) ` : ' ' ; <nl> + const key = ` $ { v . taskKey } $ { chalk ( ) . grey ( desc ) } ` ; <nl> + supportedSubtasks [ key ] = { <nl> + taskKey : v . taskKey <nl> + } ; <nl> + } ) ; <nl> + <nl> const subTasks = Object . keys ( supportedSubtasks ) ; <nl> if ( subTasks . length ) { <nl> const { subCommand } = await inquirerPrompt ( { <nl> type : ' list ' , <nl> name : ' subCommand ' , <nl> - message : ` Pick a subCommand for $ { c . command } ` , <nl> + message , <nl> choices : subTasks , <nl> } ) ; <nl> - <nl> + if ( isAutoComplete ) { <nl> + task = supportedSubtasks [ subCommand ] . taskKey ; <nl> + c . command = task . split ( ' ' ) [ 0 ] ; <nl> + c . subCommand = task . split ( ' ' ) [ 1 ] ; <nl> + if ( c . subCommand ) { <nl> + task = ` $ { c . command } $ { c . subCommand } ` ; <nl> + } else { <nl> + task = ` $ { c . command } ` ; <nl> + } <nl> + } else { <nl> c . subCommand = supportedSubtasks [ subCommand ] . taskKey ; <nl> task = ` $ { c . command } $ { c . subCommand } ` ; <nl> + } <nl> + <nl> + <nl> suitableEngines = REGISTERED_ENGINES . filter ( engine = > engine . hasTask ( task ) ) ; <nl> } <nl> } <nl> + if ( ! suitableEngines . length ) { <nl> + logError ( ` could not find suitable task for $ { chalk ( ) . white ( c . command ) } ` ) ; <nl> + c . command = null ; <nl> + c . subCommand = null ; <nl> + return findSuitableTask ( c ) ; <nl> + } <nl> + <nl> if ( ! c . platform ) { <nl> const supportedPlatforms = { } ; <nl> suitableEngines . forEach ( ( engine ) = > { <nl> 
mmm a / packages / rnv - engine - rn / src / sdks / sdk - xcode / xcodeParser . js <nl> ppp b / packages / rnv - engine - rn / src / sdks / sdk - xcode / xcodeParser . js <nl> } <nl> if ( excludedArchs ) { <nl> + const tempExcludedArchs = [ ] ; <nl> + <nl> + if ( typeof excludedArchs . forEach = = = ' function ' ) { <nl> + excludedArchs . forEach ( ( arch ) = > { <nl> + if ( typeof arch = = = ' string ' ) tempExcludedArchs . push ( arch ) ; <nl> + if ( typeof arch = = = ' object ' ) { <nl> + Object . keys ( arch ) . forEach ( ( key ) = > { <nl> + xcodeProj . updateBuildProperty ( <nl> + ` " EXCLUDED_ARCHS [ $ { key } ] " ` , <nl> + ` " $ { arch [ key ] } " ` <nl> + ) ; <nl> + } ) ; <nl> + } <nl> + } ) ; <nl> + } <nl> + <nl> + if ( tempExcludedArchs . length ) { <nl> xcodeProj . updateBuildProperty ( <nl> ' EXCLUDED_ARCHS ' , <nl> - ` " $ { excludedArchs . join ( ' ' ) } " ` <nl> + ` " $ { tempExcludedArchs . join ( ' ' ) } " ` <nl> ) ; <nl> } <nl> + } <nl> xcodeProj . updateBuildProperty ( <nl> 
mmm a / packages / rnv / pluginTemplates / renative . plugins . json <nl> ppp b / packages / rnv / pluginTemplates / renative . plugins . json <nl> " @ lightningjs / sdk " : { <nl> " version " : " 3 . 0 . 0 " <nl> + } , <nl> + " react - native - carplay " : { <nl> + " version " : " 2 . 0 . 0 " , <nl> + " ios " : { <nl> + " path " : " node_modules / react - native - carplay " , <nl> + " podName " : " react - native - carplay " , <nl> + " appDelegateImports " : [ " CarPlay " , " react_native_carplay " ] , <nl> + " appDelegateExtensions " : [ " CPApplicationDelegate " ] , <nl> + " appDelegateMethods " : { <nl> + " application " : { <nl> + " didConnectCarInterfaceController " : [ <nl> + " RNCarPlay . connect ( with : interfaceController , window : window ) " <nl> + ] , <nl> + " didDisconnectCarInterfaceController " : [ " RNCarPlay . disconnect ( ) " ] <nl> + } <nl> + } <nl> + } <nl> } <nl> } <nl> } <nl> 
mmm a / packages / rnv - engine - lightning / src / sdks / sdk - lightning / index . js <nl> ppp b / packages / rnv - engine - lightning / src / sdks / sdk - lightning / index . js <nl> } ; <nl> export const buildLightningProject = async ( c ) = > { <nl> + const { platform } = c ; <nl> logTask ( ' buildLightningProject ' ) ; <nl> const entryFile = getConfigProp ( c , c . platform , ' entryFile ' ) ; <nl> + const target = getConfigProp ( c , platform , ' target ' , ' es6 ' ) ; <nl> - await executeAsync ( c , ' lng dist ' , { <nl> + await executeAsync ( c , ` lng dist - - $ { target } ` , { <nl> stdio : ' inherit ' , <nl> silent : false , <nl> env : { <nl> 
mmm a / packages / rnv - engine - lightning / src / sdks / sdk - lightning / index . js <nl> ppp b / packages / rnv - engine - lightning / src / sdks / sdk - lightning / index . js <nl> + import path from ' path ' ; <nl> + import { Common , Constants , EngineManager , Exec , FileUtils , Logger , PlatformManager , ProjectManager , SDKManager } from ' rnv ' ; <nl> + import semver from ' semver ' ; <nl> + const { TIZEN } = Constants ; <nl> + const { isPlatformActive } = PlatformManager ; <nl> const { logTask } = Logger ; <nl> const { executeAsync } = Exec ; <nl> - const { getPlatformBuildDir , getConfigProp } = Common ; <nl> + const { <nl> + getPlatformBuildDir , getConfigProp , addSystemInjects , getAppVersion , getPlatformProjectDir , getAppTitle , getAppId , getAppDescription <nl> + } = Common ; <nl> const { generateEnvVars } = EngineManager ; <nl> + const { copyAssetsFolder , copyBuildsFolder } = ProjectManager ; <nl> + const { writeCleanFile } = FileUtils ; <nl> export const runLightningProject = async ( c , target ) = > { <nl> logTask ( ' runLightningProject ' , ` target : $ { target } ` ) ; <nl> @ @ - 41 , 7 + 49 , 47 @ @ export const buildLightningProject = async ( c ) = > { <nl> return true ; <nl> } ; <nl> - <nl> - export const configureLightningProject = async ( ) = > { <nl> + export const configureLightningProject = async ( c ) = > { <nl> logTask ( ' configureLightningProject ' ) ; <nl> + const { platform } = c ; <nl> + c . runtime . platformBuildsProjectPath = ` $ { getPlatformBuildDir ( c ) } ` ; <nl> + if ( ! isPlatformActive ( c , platform ) ) { <nl> + return ; <nl> + } <nl> + await copyAssetsFolder ( c , platform ) ; <nl> + await _configureProject ( c ) ; <nl> + return copyBuildsFolder ( c , platform ) ; <nl> } ; <nl> + <nl> + const _configureProject = c = > new Promise ( ( resolve ) = > { <nl> + logTask ( ' _configureProject ' ) ; <nl> + const { platform } = c ; <nl> + const p = c . buildConfig . platforms [ platform ] ; <nl> + <nl> + const injects = platform = = = TIZEN ? [ <nl> + { pattern : ' { { PACKAGE } } ' , override : p . package } , <nl> + { pattern : ' { { ID } } ' , override : p . id } , <nl> + { pattern : ' { { APP_NAME } } ' , override : p . appName } , <nl> + { pattern : ' { { APP_VERSION } } ' , override : semver . coerce ( getAppVersion ( c , platform ) ) } <nl> + ] : [ <nl> + { pattern : ' { { APPLICATION_ID } } ' , override : getAppId ( c , platform ) . toLowerCase ( ) } , <nl> + { pattern : ' { { APP_TITLE } } ' , override : getAppTitle ( c , platform ) } , <nl> + { pattern : ' { { APP_VERSION } } ' , override : semver . coerce ( getAppVersion ( c , platform ) ) } , <nl> + { pattern : ' { { APP_DESCRIPTION } } ' , override : getAppDescription ( c , platform ) } , <nl> + { pattern : ' { { APP_BG_COLOR } } ' , override : getConfigProp ( c , platform , ' bgColor ' , ' # fff ' ) } , <nl> + { pattern : ' { { APP_ICON_COLOR } } ' , override : getConfigProp ( c , platform , ' iconColor ' , ' # 000 ' ) } , <nl> + { pattern : ' { { APP_VENDOR } } ' , override : getConfigProp ( c , platform , ' vendor ' , ' Pavel Jacko ' ) } <nl> + ] ; <nl> + <nl> + addSystemInjects ( c , injects ) ; <nl> + <nl> + const configFile = platform = = = TIZEN ? ' config . xml ' : ' appinfo . json ' ; <nl> + const file = path . join ( getPlatformProjectDir ( c ) , configFile ) ; <nl> + writeCleanFile ( <nl> + file , <nl> + file , <nl> + injects , null , c <nl> + ) ; <nl> + <nl> + resolve ( ) ; <nl> + } ) ; <nl> 
mmm a / packages / rnv - engine - lightning / src / sdks / sdk - lightning / index . js <nl> ppp b / packages / rnv - engine - lightning / src / sdks / sdk - lightning / index . js <nl> import { Common , Constants , EngineManager , Exec , FileUtils , Logger , PlatformManager , ProjectManager , SDKManager } from ' rnv ' ; <nl> import semver from ' semver ' ; <nl> - const { TIZEN } = Constants ; <nl> + const { TIZEN , CLI_TIZEN , CLI_WEBOS_ARES_PACKAGE } = Constants ; <nl> const { isPlatformActive } = PlatformManager ; <nl> - const { logTask } = Logger ; <nl> - const { executeAsync } = Exec ; <nl> + const { chalk , logTask , logSuccess } = Logger ; <nl> + const { executeAsync , execCLI } = Exec ; <nl> const { <nl> getPlatformBuildDir , getConfigProp , addSystemInjects , getAppVersion , getPlatformProjectDir , getAppTitle , getAppId , getAppDescription <nl> } = Common ; <nl> @ @ - 14 , 6 + 14 , 8 @ @ const { generateEnvVars } = EngineManager ; <nl> const { copyAssetsFolder , copyBuildsFolder } = ProjectManager ; <nl> const { writeCleanFile } = FileUtils ; <nl> + const { DEFAULT_SECURITY_PROFILE_NAME } = SDKManager . Tizen ; <nl> + <nl> export const runLightningProject = async ( c , target ) = > { <nl> logTask ( ' runLightningProject ' , ` target : $ { target } ` ) ; <nl> const entryFile = getConfigProp ( c , c . platform , ' entryFile ' ) ; <nl> @ @ - 32 , 10 + 34 , 17 @ @ export const runLightningProject = async ( c , target ) = > { <nl> } ; <nl> export const buildLightningProject = async ( c ) = > { <nl> - const { platform } = c ; <nl> logTask ( ' buildLightningProject ' ) ; <nl> + <nl> + const { platform } = c ; <nl> + const platformConfig = c . buildConfig . platforms [ platform ] ; <nl> + <nl> const entryFile = getConfigProp ( c , c . platform , ' entryFile ' ) ; <nl> const target = getConfigProp ( c , platform , ' target ' , ' es6 ' ) ; <nl> + const tBuild = getPlatformProjectDir ( c ) ; <nl> + <nl> + const tOut = path . join ( tBuild , ' output ' ) ; <nl> + const certProfile = platformConfig . certificateProfile ? ? DEFAULT_SECURITY_PROFILE_NAME ; <nl> await executeAsync ( c , ` lng dist - - $ { target } ` , { <nl> stdio : ' inherit ' , <nl> @ @ - 46 , 6 + 55 , 25 @ @ export const buildLightningProject = async ( c ) = > { <nl> . . . generateEnvVars ( c ) , <nl> } <nl> } ) ; <nl> + <nl> + if ( platform = = = TIZEN ) { <nl> + await execCLI ( <nl> + c , <nl> + CLI_TIZEN , <nl> + ` package - - $ { tBuild } - s $ { certProfile } - t wgt - o $ { tOut } ` <nl> + ) ; <nl> + <nl> + logSuccess ( <nl> + ` Your WGT package is located in $ { chalk ( ) . cyan ( tOut ) } . ` <nl> + ) ; <nl> + } else { <nl> + await execCLI ( c , CLI_WEBOS_ARES_PACKAGE , ` - o $ { tOut } $ { tBuild } - n ` ) ; <nl> + <nl> + logSuccess ( <nl> + ` Your IPK package is located in $ { chalk ( ) . cyan ( tOut ) } . ` <nl> + ) ; <nl> + } <nl> + <nl> return true ; <nl> } ; <nl> 
mmm a / packages / rnv - engine - rn - electron / src / sdks / sdk - electron / index . js <nl> ppp b / packages / rnv - engine - rn - electron / src / sdks / sdk - electron / index . js <nl> import { spawn } from ' child_process ' ; <nl> - import { Exec , WebpackUtils , FileUtils , Common , Logger , Constants , Resolver , PlatformManager , ProjectManager } from ' rnv ' ; <nl> + import path from ' path ' ; <nl> + import { Common , Constants , Exec , FileUtils , Logger , PlatformManager , ProjectManager , Resolver , WebpackUtils } from ' rnv ' ; <nl> const { createPlatformBuild , isPlatformActive } = PlatformManager ; <nl> const { executeAsync } = Exec ; <nl> @ @ - 247 , 7 + 247 , 7 @ @ const exportElectron = async ( c ) = > { <nl> ` npx electron - builder - - config $ { path . join ( <nl> platformBuildDir , <nl> ' electronConfig . json ' <nl> - ) } ` <nl> + ) } - $ { c . platform [ 0 ] } ` <nl> ) ; <nl> logSuccess ( <nl> 
mmm a / packages / rnv / src / core / constants . ts <nl> ppp b / packages / rnv / src / core / constants . ts <nl> analyzer : { <nl> description : ' Enable real - time bundle analyzer ' <nl> } , <nl> + xcodebuildArgs : { <nl> + value : ' value ' , <nl> + isRequired : true , <nl> + description : ' pass down custom xcodebuild arguments ' <nl> + } , <nl> xcodebuildArchiveArgs : { <nl> value : ' value ' , <nl> isRequired : true , <nl> 
mmm a / packages / sdk - apple / src / index . js <nl> ppp b / packages / sdk - apple / src / index . js <nl> p . push ( ' - derivedDataPath ' ) ; <nl> p . push ( buildPath ) ; <nl> } <nl> - if ( ! ps . includes ( ' - destination ' ) ) { <nl> + / / - arch / - sdk params are not compatible with - destination <nl> + if ( ! ps . includes ( ' - destination ' ) & & ! ps . includes ( ' - arch ' ) ) { <nl> p . push ( ' - destination ' ) ; <nl> if ( platform = = = MACOS ) { <nl> p . push ( ` platform = $ { destinationPlatform } ` ) ; <nl> 
mmm a / packages / sdk - apple / src / plistParser . js <nl> ppp b / packages / sdk - apple / src / plistParser . js <nl> isObject , <nl> isArray , <nl> isBool , <nl> - isString <nl> + isString , <nl> + isNumber <nl> } = ObjectUtils ; <nl> const { <nl> getAppFolder , <nl> @ @ - 207 , 8 + 208 , 11 @ @ const _parseObject = ( obj , level ) = > { <nl> output + = ` $ { space } < / dict > \ n ` ; <nl> } else if ( isString ( obj ) ) { <nl> output + = ` $ { space } < string > $ { obj } < / string > \ n ` ; <nl> + } else if ( isNumber ( obj ) & & Number . isInteger ( obj ) ) { <nl> + output + = ` $ { space } < integer > $ { obj } < / integer > \ n ` ; <nl> } <nl> + <nl> return output ; <nl> } ; <nl> 
mmm a / components / Glo / index . js <nl> ppp b / components / Glo / index . js <nl> - import ' glo / js / coordinates . js ' ; <nl> - import ' glo / js / node_group . js ' ; <nl> - import ' glo / js / canvas . js ' ; <nl> - import ' glo / js / node_generation . js ' ; <nl> - import ' glo / js / edge_generation . js ' ; <nl> - import ' glo / js / helpers . js ' ; <nl> - import ' glo / js / glo . js ' ; <nl> - import ' glo / js / api . js ' ; <nl> - import ' glo / js / techniques . js ' ; <nl> - import ' glo / js / figures . js ' ; <nl> - <nl> - import * as d3 from ' d3 ' ; <nl> + import d3 from ' glo / node_modules / d3 ' ; <nl> + import GLO from ' glo ' ; <nl> import VisComponent from ' . . / . . / VisComponent ' ; <nl> + const colorNodes = ( glo , field , type ) = > { <nl> + glo . glo . node_attr ( { <nl> + [ field ] : type <nl> + } ) ; <nl> + <nl> + glo . glo . color_nodes_by ( field ) ; <nl> + } ; <nl> + <nl> export default class Glo extends VisComponent { <nl> - constructor ( el , { nodes , edges , width = 960 , height = 540 } ) { <nl> + constructor ( el , { nodes , edges , nodeAttr , edgeAttr , width = 960 , height = 540 } ) { <nl> super ( el ) ; <nl> / / Empty the top - level div . <nl> @ @ - 32 , 15 + 29 , 85 @ @ export default class Glo extends VisComponent { <nl> / / Construct a GLO object . <nl> this . glo = new GLO . GLO ( d3 . select ( this . svg ) ) <nl> . nodes ( nodes ) <nl> - . edges ( edges ) <nl> - . draw ( ) ; <nl> - <nl> - console . log ( ' Glo . constructor ( ) ' ) ; <nl> - console . log ( ' this . glo ' , this . glo ) ; <nl> + . edges ( edges ) ; <nl> } <nl> render ( ) { <nl> - console . log ( ' Glo . render ( ) ' ) ; <nl> - console . log ( ' GLO object ' , GLO ) ; <nl> + this . glo . draw ( ) ; <nl> + } <nl> + <nl> + colorNodesDiscrete ( field ) { <nl> + colorNodes ( this , field , ' discrete ' ) ; <nl> + } <nl> + <nl> + colorNodesContinuous ( field ) { <nl> + colorNodes ( this , field , ' continuous ' ) ; <nl> + } <nl> + <nl> + colorNodesDefault ( ) { <nl> + this . glo . color_nodes_by_constant ( ) ; <nl> + } <nl> + <nl> + sizeNodes ( field ) { <nl> + this . glo . node_attr ( { <nl> + [ field ] : ' continuous ' <nl> + } ) ; <nl> + <nl> + this . glo . size_nodes_by ( field ) ; <nl> + } <nl> + <nl> + sizeNodesDefault ( ) { <nl> + this . glo . size_nodes_by_constant ( ) ; <nl> + } <nl> + <nl> + distributeNodes ( axis , attr = null ) { <nl> + if ( attr = = = null ) { <nl> + this . glo . evenly_distribute_nodes_on ( axis ) ; <nl> + } else { <nl> + this . glo . evenly_distribute_nodes_on ( axis , { <nl> + by : attr <nl> + } ) ; <nl> + } <nl> + } <nl> + <nl> + positionNodes ( axis , value ) { <nl> + this . glo . node_attr ( { <nl> + [ value ] : ' continuous ' <nl> + } ) ; <nl> + <nl> + this . glo . position_nodes_on ( axis , value ) ; <nl> + } <nl> + <nl> + forceDirected ( ) { <nl> + this . glo . apply_force_directed_algorithm_to_nodes ( ) ; <nl> + } <nl> + <nl> + showEdges ( ) { <nl> + this . glo . show_all_edges ( ) ; <nl> + } <nl> + <nl> + hideEdges ( ) { <nl> + this . glo . hide_edges ( ) ; <nl> + } <nl> + <nl> + fadeEdges ( ) { <nl> + this . glo . show_edges_as_faded ( ) ; <nl> + } <nl> + <nl> + solidEdges ( ) { <nl> + this . hideEdges ( ) ; <nl> + this . showEdges ( ) ; <nl> + } <nl> + <nl> + incidentEdges ( ) { <nl> + this . glo . show_incident_edges ( ) ; <nl> + } <nl> + <nl> + curvedEdges ( ) { <nl> + this . glo . display_edges_as_curved_lines ( ) ; <nl> + } <nl> + <nl> + straightEdges ( ) { <nl> + this . glo . display_edges_as_straight_lines ( ) ; <nl> } <nl> } <nl> 
mmm a / VisComponent / index . js <nl> ppp b / VisComponent / index . js <nl> this . el = el ; <nl> } <nl> + render ( ) { <nl> + throw new Error ( ' " render ( ) is pure abstract " ' ) ; <nl> + } <nl> + <nl> + update ( ) { <nl> + throw new Error ( ' " update ( ) is pure abstract " ' ) ; <nl> + } <nl> + <nl> + destroy ( ) { <nl> + throw new Error ( ' " destroy ( ) " is pure abstract " ' ) ; <nl> + } <nl> + <nl> empty ( ) { <nl> select ( this . el ) <nl> . selectAll ( ' * ' ) <nl> . remove ( ) ; <nl> } <nl> - render ( ) { <nl> - throw new Error ( ' " render ( ) is pure abstract " ' ) ; <nl> - } <nl> - <nl> get serializationFormats ( ) { <nl> return [ ] ; <nl> } <nl> 
mmm a / VisComponent / mixin / VegaChart . js <nl> ppp b / VisComponent / mixin / VegaChart . js <nl> } ) ; <nl> } <nl> + update ( options ) { <nl> + let promise = this . chart ; <nl> + <nl> + Object . assign ( this . options , options ) ; <nl> + <nl> + if ( this . options . data ) { <nl> + promise = promise . then ( chart = > { <nl> + chart . data ( ' data ' ) <nl> + . remove ( ( ) = > true ) <nl> + . insert ( this . options . data ) ; <nl> + } ) ; <nl> + } <nl> + <nl> + if ( this . options . width ) { <nl> + this . width = this . options . width ; <nl> + } <nl> + <nl> + if ( this . options . height ) { <nl> + this . height = this . options . height ; <nl> + } <nl> + <nl> + return promise ; <nl> + } <nl> + <nl> + destroy ( ) { <nl> + this . empty ( ) ; <nl> + delete this . chart ; <nl> + } <nl> + <nl> get serializationFormats ( ) { <nl> return [ ' png ' , ' svg ' ] ; <nl> } <nl> 
mmm a / plugins / vega / ScatterPlot / index . js <nl> ppp b / plugins / vega / ScatterPlot / index . js <nl> } <nl> } <nl> + if ( this . options . xScale ) { <nl> + spec . encoding . x . scale = this . options . xScale ; <nl> + } <nl> + <nl> + if ( this . options . yScale ) { <nl> + spec . encoding . y . scale = this . options . yScale ; <nl> + } <nl> + <nl> return spec ; <nl> } <nl> } <nl> 
mmm a / plugins / vega / ScatterPlot / index . js <nl> ppp b / plugins / vega / ScatterPlot / index . js <nl> spec . encoding . y . scale = this . options . yScale ; <nl> } <nl> + if ( this . options . xAxis ) { <nl> + spec . encoding . x . axis = this . options . xAxis ; <nl> + } <nl> + <nl> + if ( this . options . yAxis ) { <nl> + spec . encoding . y . axis = this . options . yAxis ; <nl> + } <nl> + <nl> return spec ; <nl> } <nl> } <nl> 
mmm a / circle . yml <nl> ppp b / circle . yml <nl> # Install flake8 for Python linting . <nl> - sudo pip install flake8 <nl> + # Inject npm token into environment . <nl> + - echo " / / registry . npmjs . org / : _authToken = $ NPM_TOKEN " > > ~ / . npmrc <nl> + <nl> cache_directories : <nl> - node_modules <nl> 
mmm a / src / lib / run - webpack . js <nl> ppp b / src / lib / run - webpack . js <nl> const prodBuild = ( env , config ) = > { <nl> let ssrOutputPath = path . resolve ( __dirname , ' ssr - build / ' ) ; <nl> + let pluginNameFilter = ( plugin , name ) = > plugin . constructor & & plugin . constructor . name = = = name ; <nl> let ssrConfig = ( config ) = > { <nl> let newConfig = Object . assign ( { } , config , { <nl> target : ' node ' , <nl> entry : path . resolve ( env . cwd , env . src | | ' src ' , ' index . js ' ) , <nl> - plugins : config . plugins . filter ( c = > ! ( c . constructor & & c . constructor . name = = = ' HtmlWebpackPlugin ' ) ) , <nl> + plugins : config . plugins . filter ( p = > ! pluginNameFilter ( p , ' HtmlWebpackPlugin ' ) ) <nl> + . filter ( p = > ! pluginNameFilter ( p , ' SWPrecacheWebpackPlugin ' ) ) , <nl> } ) ; <nl> newConfig . output . path = ssrOutputPath ; <nl> @ @ - 56 , 9 + 58 , 10 @ @ const prodBuild = ( env , config ) = > { <nl> return newConfig ; <nl> } ; <nl> - let compiler = webpack ( config ) ; <nl> - let runCompiler = ( ) = > new Promise ( ( resolve , reject ) = > { <nl> - console . log ( ' Running production build . . . ' ) ; <nl> + <nl> + let compiler = env . prerender ? webpack ( [ config , ssrConfig ( config ) ] ) : webpack ( config ) ; <nl> + <nl> + return new Promise ( ( resolve , reject ) = > { <nl> compiler . run ( ( err , stats ) = > { <nl> if ( err ) reject ( err ) ; <nl> else { <nl> @ @ - 67 , 19 + 70 , 6 @ @ const prodBuild = ( env , config ) = > { <nl> } <nl> } ) ; <nl> } ) ; <nl> - <nl> - let ssrCompiler = webpack ( ssrConfig ( config ) ) ; <nl> - let runSsrCompiler = ( ) = > new Promise ( ( resolve , reject ) = > { <nl> - console . log ( ' Running SSR build . . . ' ) ; <nl> - rimraf . sync ( ssrOutputPath ) ; <nl> - ssrCompiler . run ( ( err ) = > { <nl> - if ( err ) return reject ( err ) ; <nl> - / / Timeout for plugins that work on ` after - emit ` event of webpack <nl> - setTimeout ( ( ) = > resolve ( ) , 20 ) ; <nl> - } ) ; <nl> - } ) ; <nl> - <nl> - return env . prerender ? runSsrCompiler ( ) . then ( runCompiler ) : runCompiler ( ) ; <nl> } ; <nl> export function showStats ( stats ) { <nl> 
mmm a / src / lib / webpack / run - webpack . js <nl> ppp b / src / lib / webpack / run - webpack . js <nl> let serverAddr = ` $ { protocol } : / / $ { host } : $ { chalk . bold ( port ) } ` ; <nl> let localIpAddr = ` $ { protocol } : / / $ { ip . address ( ) } : $ { chalk . bold ( port ) } ` ; <nl> - process . stdout . write ( chalk . green ( ' \ nCompiled successfully ! ! \ n \ n ' ) ) ; <nl> + if ( stats . hasErrors ( ) ) { <nl> + process . stdout . write ( chalk . red ( ' \ Build failed ! \ n \ n ' ) ) ; <nl> + } else { <nl> + process . stdout . write ( chalk . green ( ' \ nCompiled successfully ! \ n \ n ' ) ) ; <nl> + } <nl> + <nl> if ( userPort ! = = port ) { <nl> process . stdout . write ( ` Port $ { chalk . bold ( userPort ) } is in use , using $ { chalk . bold ( port ) } instead \ n \ n ` ) ; <nl> } <nl> @ @ - 71 , 7 + 76 , 8 @ @ const prodBuild = async ( env ) = > { <nl> return await new Promise ( ( resolve , reject ) = > { <nl> compiler . run ( ( err , stats ) = > { <nl> if ( err | | stats . hasErrors ( ) ) { <nl> - reject ( err | | stats . toJson ( ) . errors . join ( ' \ n ' ) ) ; <nl> + showStats ( stats ) ; <nl> + reject ( chalk . red ( ' Build failed ! ' ) ) ; <nl> } <nl> else { <nl> / / Timeout for plugins that work on ` after - emit ` event of webpack <nl> @ @ - 82 , 16 + 88 , 16 @ @ const prodBuild = async ( env ) = > { <nl> } ; <nl> export function showStats ( stats ) { <nl> - let info = stats . toJson ( ) ; <nl> + let info = stats . toJson ( " errors - only " ) ; <nl> if ( stats . hasErrors ( ) ) { <nl> - info . errors . forEach ( message = > { <nl> - process . stderr . write ( message + ' \ n ' ) ; <nl> + info . errors . map ( stripBabelLoaderPrefix ) . forEach ( message = > { <nl> + process . stderr . write ( chalk . red ( message ) + ' \ n ' ) ; <nl> } ) ; <nl> } <nl> if ( stats . hasWarnings ( ) ) { <nl> - info . warnings . forEach ( message = > { <nl> + info . warnings . map ( stripBabelLoaderPrefix ) . forEach ( message = > { <nl> process . stderr . write ( chalk . yellow ( message ) + ' \ n ' ) ; <nl> } ) ; <nl> } <nl> @ @ - 109 , 8 + 115 , 8 @ @ export function writeJsonStats ( stats ) { <nl> jsonStats = ( jsonStats . children & & jsonStats . children [ 0 ] ) | | jsonStats ; <nl> - jsonStats . modules . forEach ( normalizeModule ) ; <nl> - jsonStats . chunks . forEach ( c = > c . modules . forEach ( normalizeModule ) ) ; <nl> + jsonStats . modules . forEach ( stripBabelLoaderFromModuleNames ) ; <nl> + jsonStats . chunks . forEach ( c = > c . modules . forEach ( stripBabelLoaderFromModuleNames ) ) ; <nl> return fs . writeFile ( outputPath , JSON . stringify ( jsonStats ) ) <nl> . then ( ( ) = > { <nl> @ @ - 121 , 20 + 127 , 20 @ @ export function writeJsonStats ( stats ) { <nl> } ) ; <nl> } <nl> - const normalizeModule = m = > { <nl> + const stripBabelLoaderFromModuleNames = m = > { <nl> const keysToNormalize = [ ' identifier ' , ' name ' , ' module ' , ' moduleName ' , ' moduleIdentifier ' ] ; <nl> keysToNormalize . forEach ( key = > { <nl> if ( key in m ) { <nl> - m [ key ] = normalizeName ( m [ key ] ) ; <nl> + m [ key ] = stripBabelLoaderPrefix ( m [ key ] ) ; <nl> } <nl> } ) ; <nl> if ( m . reasons ) { <nl> - m . reasons . forEach ( normalizeModule ) ; <nl> + m . reasons . forEach ( stripBabelLoaderFromModuleNames ) ; <nl> } <nl> return m ; <nl> } ; <nl> - const normalizeName = p = > p . substr ( p . lastIndexOf ( ' ! ' ) + 1 ) ; <nl> + const stripBabelLoaderPrefix = log = > log . replace ( / @ ? \ s * ( \ . \ / ~ \ / babel - loader \ / lib \ ? { [ \ s \ S ] * ? } ! ) / g , ' ' ) ; <nl> 
mmm a / packages / cli / lib / lib / webpack / webpack - base - config . js <nl> ppp b / packages / cli / lib / lib / webpack / webpack - base - config . js <nl> ' . css ' , <nl> ' . wasm ' , <nl> ] , <nl> - alias : { <nl> + alias : Object . assign ( <nl> + { <nl> style : source ( ' style ' ) , <nl> ' preact - cli - entrypoint ' : source ( ' index ' ) , <nl> / / preact - compat aliases for supporting React dependencies : <nl> @ @ - 133 , 6 + 134 , 8 @ @ module . exports = function ( env ) { <nl> ' @ preact / async - loader / async ' <nl> ) , <nl> } , <nl> + compat ! = = ' preact - compat ' ? { ' preact - compat ' : compat } : { } <nl> + ) , <nl> } , <nl> resolveLoader : { <nl> 
mmm a / html / src / localization / strings / en . json <nl> ppp b / html / src / localization / strings / en . json <nl> " action " : " Action " <nl> } <nl> + } , <nl> + " vr " : { <nl> + " status " : { <nl> + " timer " : " Timer : " , <nl> + " players " : " Players : " , <nl> + " cpu " : " CPU : " , <nl> + " online " : " Online : " , <nl> + " devices " : { <nl> + " left " : " L : " , <nl> + " right " : " R : " <nl> + } <nl> + } <nl> } <nl> } <nl> 
mmm a / src / lib / isJWT . js <nl> ppp b / src / lib / isJWT . js <nl> - const jwt = / ^ [ a - zA - Z0 - 9 \ - _ ] + \ . [ a - zA - Z0 - 9 \ - _ ] + \ . [ a - zA - Z0 - 9 \ - _ ] + $ / ; <nl> + const jwt = / ^ ( [ A - Za - z0 - 9 \ - _ ~ + \ / ] + [ = ] { 0 , 2 } ) \ . ( [ A - Za - z0 - 9 \ - _ ~ + \ / ] + [ = ] { 0 , 2 } ) ( ? : \ . ( [ A - Za - z0 - 9 \ - _ ~ + \ / ] + [ = ] { 0 , 2 } ) ) ? $ / ; <nl> export default function isJWT ( str ) { <nl> assertString ( str ) ; <nl> 
mmm a / src / lib / isEmail . js <nl> ppp b / src / lib / isEmail . js <nl> / * eslint - disable max - len * / <nl> / * eslint - disable no - control - regex * / <nl> - const displayName = / ^ [ a - z \ d ! # \ $ % & ' \ * \ + \ - \ / = \ ? \ ^ _ ` { \ | } ~ \ . \ u00A0 - \ uD7FF \ uF900 - \ uFDCF \ uFDF0 - \ uFFEF ] + [ a - z \ d ! # \ $ % & ' \ * \ + \ - \ / = \ ? \ ^ _ ` { \ | } ~ \ , \ . \ u00A0 - \ uD7FF \ uF900 - \ uFDCF \ uFDF0 - \ uFFEF \ s ] * < ( . + ) > $ / i ; <nl> + const splitNameAddress = / ^ ( [ ^ \ x00 - \ x1F \ x7F - \ x9F \ cX ] + ) < ( . + ) > $ / i ; <nl> const emailUserPart = / ^ [ a - z \ d ! # \ $ % & ' \ * \ + \ - \ / = \ ? \ ^ _ ` { \ | } ~ ] + $ / i ; <nl> const gmailUserPart = / ^ [ a - z \ d ] + $ / ; <nl> const quotedEmailUser = / ^ ( [ \ s \ x01 - \ x08 \ x0b \ x0c \ x0e - \ x1f \ x7f \ x21 \ x23 - \ x5b \ x5d - \ x7e ] | ( \ \ [ \ x01 - \ x09 \ x0b \ x0c \ x0d - \ x7f ] ) ) * $ / i ; <nl> @ @ - 23 , 14 + 23 , 60 @ @ const quotedEmailUserUtf8 = / ^ ( [ \ s \ x01 - \ x08 \ x0b \ x0c \ x0e - \ x1f \ x7f \ x21 \ x23 - \ x5b \ x5 <nl> / * eslint - enable max - len * / <nl> / * eslint - enable no - control - regex * / <nl> + / * * <nl> + * Validate display name according to the RFC2822 : https : / / tools . ietf . org / html / rfc2822 # appendix - A . 1 . 2 <nl> + * @ param { String } display_name <nl> + * / <nl> + function validateDisplayName ( display_name ) { <nl> + const trim_quotes = display_name . match ( / ^ " ( . + ) " $ / i ) ; <nl> + const display_name_without_quotes = trim_quotes ? trim_quotes [ 1 ] : display_name ; <nl> + <nl> + / / display name with only spaces is not valid <nl> + if ( ! display_name_without_quotes . trim ( ) ) { <nl> + return false ; <nl> + } <nl> + <nl> + / / check whether display name contains illegal character <nl> + const contains_illegal = / [ \ . " ; < > ] / . test ( display_name_without_quotes ) ; <nl> + if ( contains_illegal ) { <nl> + / / if contains illegal characters , <nl> + / / must to be enclosed in double - quotes , otherwise it ' s not a valid display name <nl> + if ( ! trim_quotes ) { <nl> + return false ; <nl> + } <nl> + <nl> + / / the quotes in display name must start with character symbol \ <nl> + const all_start_with_back_slash = <nl> + display_name_without_quotes . split ( ' " ' ) . length = = = display_name_without_quotes . split ( ' \ \ " ' ) . length ; <nl> + if ( ! all_start_with_back_slash ) { <nl> + return false ; <nl> + } <nl> + } <nl> + <nl> + return true ; <nl> + } <nl> + <nl> + <nl> export default function isEmail ( str , options ) { <nl> assertString ( str ) ; <nl> options = merge ( options , default_email_options ) ; <nl> if ( options . require_display_name | | options . allow_display_name ) { <nl> - const display_email = str . match ( displayName ) ; <nl> + const display_email = str . match ( splitNameAddress ) ; <nl> if ( display_email ) { <nl> - str = display_email [ 1 ] ; <nl> + let display_name ; <nl> + [ , display_name , str ] = display_email ; <nl> + / / sometimes need to trim the last space to get the display name <nl> + / / because there may be a space between display name and email address <nl> + / / eg . myname < address @ gmail . com > <nl> + / / the display name is ` myname ` instead of ` myname ` , so need to trim the last space <nl> + if ( display_name . endsWith ( ' ' ) ) { <nl> + display_name = display_name . substr ( 0 , display_name . length - 1 ) ; <nl> + } <nl> + <nl> + if ( ! validateDisplayName ( display_name ) ) { <nl> + return false ; <nl> + } <nl> } else if ( options . require_display_name ) { <nl> return false ; <nl> } <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * * contains ( str , seed ) * * * | check if the string contains the seed . <nl> * * equals ( str , comparison ) * * | check if the string matches the comparison . <nl> * * isAfter ( str [ , date ] ) * * | check if the string is a date that ' s after the specified date ( defaults to now ) . <nl> - * * isAlpha ( str [ , locale ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . <nl> - * * isAlphanumeric ( str [ , locale ] ) * * | check if the string contains only letters and numbers . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . <nl> + * * isAlpha ( str [ , locale ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . <nl> + * * isAlphanumeric ( str [ , locale ] ) * * | check if the string contains only letters and numbers . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . <nl> * * isAscii ( str ) * * | check if the string contains ASCII chars only . <nl> * * isBase32 ( str ) * * | check if a string is base32 encoded . <nl> * * isBase64 ( str ) * * | check if a string is base64 encoded . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * contains ( str , seed [ , options ] ) * * | check if the string contains the seed . < br / > < br / > ` options ` is an object that defaults to ` { ignoreCase : false } ` . < br / > ` ignoreCase ` specified whether the case of the substring be same or not . <nl> * * equals ( str , comparison ) * * | check if the string matches the comparison . <nl> * * isAfter ( str [ , date ] ) * * | check if the string is a date that ' s after the specified date ( defaults to now ) . <nl> - * * isAlpha ( str [ , locale ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . <nl> - * * isAlphanumeric ( str [ , locale ] ) * * | check if the string contains only letters and numbers . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . <nl> + * * isAlpha ( str [ , locale ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' , ' vi - VN ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . <nl> + * * isAlphanumeric ( str [ , locale ] ) * * | check if the string contains only letters and numbers . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' , ' vi - VN ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . <nl> * * isAscii ( str ) * * | check if the string contains ASCII chars only . <nl> * * isBase32 ( str ) * * | check if a string is base32 encoded . <nl> * * isBase64 ( str [ , options ] ) * * | check if a string is base64 encoded . options is optional and defaults to ` { urlSafe : false } ` < br / > when ` urlSafe ` is true it tests the given base64 encoded string is [ url safe ] ( https : / / base64 . guru / standards / base64url ) <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * contains ( str , seed [ , options ] ) * * | check if the string contains the seed . < br / > < br / > ` options ` is an object that defaults to ` { ignoreCase : false } ` . < br / > ` ignoreCase ` specified whether the case of the substring be same or not . <nl> * * equals ( str , comparison ) * * | check if the string matches the comparison . <nl> * * isAfter ( str [ , date ] ) * * | check if the string is a date that ' s after the specified date ( defaults to now ) . <nl> - * * isAlpha ( str [ , locale ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa ' , ' fa - AF ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' , ' vi - VN ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . <nl> - * * isAlphanumeric ( str [ , locale ] ) * * | check if the string contains only letters and numbers . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa ' , ' fa - AF ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' , ' vi - VN ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . <nl> + * * isAlpha ( str [ , locale ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' az - AZ ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa ' , ' fa - AF ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' , ' vi - VN ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . <nl> + * * isAlphanumeric ( str [ , locale ] ) * * | check if the string contains only letters and numbers . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' az - AZ ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' fa ' , ' fa - AF ' , ' fa - IR ' , ' he ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' , ' vi - VN ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . <nl> * * isAscii ( str ) * * | check if the string contains ASCII chars only . <nl> * * isBase32 ( str ) * * | check if a string is base32 encoded . <nl> * * isBase64 ( str [ , options ] ) * * | check if a string is base64 encoded . options is optional and defaults to ` { urlSafe : false } ` < br / > when ` urlSafe ` is true it tests the given base64 encoded string is [ url safe ] ( https : / / base64 . guru / standards / base64url ) <nl> 
mmm a / src / lib / isStrongPassword . js <nl> ppp b / src / lib / isStrongPassword . js <nl> const upperCaseRegex = / ^ [ A - Z ] $ / ; <nl> const lowerCaseRegex = / ^ [ a - z ] $ / ; <nl> const numberRegex = / ^ [ 0 - 9 ] $ / ; <nl> - const symbolRegex = / ^ [ - # ! $ % ^ & * ( ) _ + | ~ = ` { } \ [ \ ] : " ; ' < > ? , . \ / ] $ / ; <nl> + const symbolRegex = / ^ [ - # ! $ @ % ^ & * ( ) _ + | ~ = ` { } \ [ \ ] : " ; ' < > ? , . \ / ] $ / ; <nl> const defaultOptions = { <nl> minLength : 8 , <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * contains ( str , seed [ , options ] ) * * | check if the string contains the seed . < br / > < br / > ` options ` is an object that defaults to ` { ignoreCase : false , minOccurrences : 1 } ` . < br / > Options : < br / > ` ignoreCase ` : Ignore case when doing comparison , default false < br / > ` minOccurences ` : Minimum number of occurrences for the seed in the string . Defaults to 1 . <nl> * * equals ( str , comparison ) * * | check if the string matches the comparison . <nl> * * isAfter ( str [ , date ] ) * * | check if the string is a date that ' s after the specified date ( defaults to now ) . <nl> - * * isAlpha ( str [ , locale , options ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' bn ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> - * * isAlphanumeric ( str [ , locale , options ] ) * * | check if the string contains only letters and numbers ( a - zA - Z0 - 9 ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bn ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> + * * isAlpha ( str [ , locale , options ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' bn ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ja - JP ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> + * * isAlphanumeric ( str [ , locale , options ] ) * * | check if the string contains only letters and numbers ( a - zA - Z0 - 9 ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bn ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ja - JP ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> * * isAscii ( str ) * * | check if the string contains ASCII chars only . <nl> * * isBase32 ( str [ , options ] ) * * | check if a string is base32 encoded . ` options ` is optional and defaults to ` { crockford : false } ` . < br / > When ` crockford ` is true it tests the given base32 encoded string using [ Crockford ' s base32 alternative ] ( http : / / www . crockford . com / base32 . html ) . <nl> * * isBase58 ( str ) * * | check if a string is base58 encoded . <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * contains ( str , seed [ , options ] ) * * | check if the string contains the seed . < br / > < br / > ` options ` is an object that defaults to ` { ignoreCase : false , minOccurrences : 1 } ` . < br / > Options : < br / > ` ignoreCase ` : Ignore case when doing comparison , default false < br / > ` minOccurences ` : Minimum number of occurrences for the seed in the string . Defaults to 1 . <nl> * * equals ( str , comparison ) * * | check if the string matches the comparison . <nl> * * isAfter ( str [ , date ] ) * * | check if the string is a date that ' s after the specified date ( defaults to now ) . <nl> - * * isAlpha ( str [ , locale , options ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' bn ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ja - JP ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> - * * isAlphanumeric ( str [ , locale , options ] ) * * | check if the string contains only letters and numbers ( a - zA - Z0 - 9 ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bn ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ja - JP ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> + * * isAlpha ( str [ , locale , options ] ) * * | check if the string contains only letters ( a - zA - Z ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' bn ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ko - KR ' , ' ja - JP ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphaLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> + * * isAlphanumeric ( str [ , locale , options ] ) * * | check if the string contains only letters and numbers ( a - zA - Z0 - 9 ) . < br / > < br / > Locale is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bn ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' el - GR ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fa - IR ' , ' fi - FI ' , ' fr - CA ' , ' fr - FR ' , ' he ' , ' hi - IN ' , ' hu - HU ' , ' it - IT ' , ' ko - KR ' , ' ja - JP ' , ' ku - IQ ' , ' nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' si - LK ' , ' sl - SI ' , ' sk - SK ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` ) and defaults to ` en - US ` . Locale list is ` validator . isAlphanumericLocales ` . options is an optional object that can be supplied with the following key ( s ) : ignore which can either be a String or RegExp of characters to be ignored e . g . " - " will ignore spaces and - ' s . <nl> * * isAscii ( str ) * * | check if the string contains ASCII chars only . <nl> * * isBase32 ( str [ , options ] ) * * | check if a string is base32 encoded . ` options ` is optional and defaults to ` { crockford : false } ` . < br / > When ` crockford ` is true it tests the given base32 encoded string using [ Crockford ' s base32 alternative ] ( http : / / www . crockford . com / base32 . html ) . <nl> * * isBase58 ( str ) * * | check if a string is base58 encoded . <nl> 
mmm a / src / browser / transport . js <nl> ppp b / src / browser / transport . js <nl> } <nl> } <nl> + / * global RollbarProxy * / <nl> + function _proxyRequest ( json , callback ) { <nl> + var rollbarProxy = new RollbarProxy ( ) ; <nl> + rollbarProxy . sendJsonPayload ( <nl> + json , <nl> + function ( _msg ) { / * do nothing * / } , / / eslint - disable - line no - unused - vars <nl> + function ( err ) { <nl> + callback ( new Error ( err ) ) ; <nl> + } <nl> + ) ; <nl> + } <nl> + <nl> function _makeRequest ( accessToken , url , method , data , callback , requestFactory ) { <nl> + if ( typeof RollbarProxy ! = = ' undefined ' ) { <nl> + return _proxyRequest ( data , callback ) ; <nl> + } <nl> + <nl> var request ; <nl> if ( requestFactory ) { <nl> request = requestFactory ( ) ; <nl> 
mmm a / src / browser / rollbar . js <nl> ppp b / src / browser / rollbar . js <nl> captureIp : true , <nl> inspectAnonymousErrors : true , <nl> ignoreDuplicateErrors : true , <nl> - wrapGlobalEventHandlers : true <nl> + wrapGlobalEventHandlers : false <nl> } ; <nl> module . exports = Rollbar ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test " : " jest - - config = jest_config / jest . config . json - - coverage - - forceExit | | true " , <nl> " dev " : " node webpack_config / server . js " , <nl> + " start " : " npm run dev " , <nl> " ssr " : " nodemon - - exec BABEL_ENV = ssr babel - node . / src / server " , <nl> " precommit " : " npm run test " , <nl> " prepush " : " echo \ " $ ( tput bold ) $ ( tput setaf 5 ) Hello , my name is React - Semantic - UI - Starter , and I am happy to see that you use this project : ) $ ( tput sgr 0 ) \ " " , <nl> 
mmm a / webpack_config / webpack . prod . js <nl> ppp b / webpack_config / webpack . prod . js <nl> + <nl> const exec = require ( ' child_process ' ) . execSync <nl> const webpack = require ( ' webpack ' ) <nl> const ExtractTextPlugin = require ( ' extract - text - webpack - plugin ' ) <nl> @ @ - 7 , 14 + 8 , 14 @ @ const SriPlugin = require ( ' webpack - subresource - integrity ' ) <nl> const I18nPlugin = require ( ' i18n - webpack - plugin ' ) <nl> const CompressionPlugin = require ( ' compression - webpack - plugin ' ) <nl> const OptimizeCssAssetsPlugin = require ( ' optimize - css - assets - webpack - plugin ' ) <nl> - const BabiliPlugin = require ( ' babili - webpack - plugin ' ) <nl> + / / const BabiliPlugin = require ( ' babili - webpack - plugin ' ) <nl> const ProgressPlugin = require ( ' webpack / lib / ProgressPlugin ' ) <nl> const ManifestPlugin = require ( ' webpack - manifest - plugin ' ) <nl> const OfflinePlugin = require ( ' offline - plugin ' ) <nl> const PreloadWebpackPlugin = require ( ' preload - webpack - plugin ' ) <nl> const FaviconsWebpackPlugin = require ( ' favicons - webpack - plugin ' ) <nl> - / / See comments about ShakePlugin below : <nl> - / / const ShakePlugin = require ( ' webpack - common - shake ' ) . Plugin <nl> + const UglifyJSPlugin = require ( ' uglifyjs - webpack - plugin ' ) <nl> + const ShakePlugin = require ( ' webpack - common - shake ' ) . Plugin <nl> / / const git = require ( ' git - rev - sync ' ) <nl> let languages = require ( ' . . / i18n ' ) <nl> @ @ - 34 , 6 + 35 , 7 @ @ exec ( ' rm - rf dist / ' ) <nl> / / use hash filename to support long - term caching <nl> base . output . filename = ' [ name ] . [ chunkhash : 8 ] . js ' <nl> + base . output . crossOriginLoading = ' anonymous ' <nl> base . devtool = ' cheap - source - map ' <nl> base . module . rules . push ( <nl> { <nl> @ @ - 77 , 11 + 79 , 7 @ @ base . plugins . push ( <nl> allChunks : true <nl> } ) , <nl> new webpack . optimize . ModuleConcatenationPlugin ( ) , <nl> - / / <nl> - / / FIXME : I ' m getting error from this issue https : / / github . com / indutny / webpack - common - shake / issues / 7 <nl> - / / Probably . it ' s a problem of a plugin , so it ' s temporarily commented <nl> - / / new ShakePlugin ( ) , <nl> - / / <nl> + new ShakePlugin ( ) , <nl> new OptimizeCssAssetsPlugin ( ) , <nl> / / NOTE : Prepack currently in alpha , be carefull with it <nl> / / new PrepackWebpackPlugin ( ) , <nl> @ @ - 105 , 8 + 103 , 7 @ @ base . plugins . push ( <nl> name : ' manifest ' <nl> } ) , <nl> new webpack . BannerPlugin ( { <nl> - banner : <nl> - ' hash : [ hash ] , chunkhash : [ chunkhash ] , name : [ name ] , filebase : [ filebase ] , query : [ query ] , file : [ file ] ' <nl> + banner : ' React - Semantic . UI - Starter . MIT License . Copyright ( c ) 2017 Copyright Vladimir Metnew . All Rights Reserved . https : / / github . com / Metnew / react - semantic . ui - starter ' <nl> } ) , <nl> / / XXX : this plugin is cool , but there is a one big issue : <nl> / / It sets invalid url to browserconfig . xml and manifest . json in index . html . <nl> @ @ - 115 , 7 + 112 , 7 @ @ base . plugins . push ( <nl> new FaviconsWebpackPlugin ( { <nl> / / add theme - color property <nl> background : config . manifest . theme , <nl> - prefix : ` icons ` , <nl> + prefix : ` icons / ` , <nl> logo : path . resolve ( __dirname , ' . . / static / images / logo . png ' ) , <nl> title : config . title , <nl> / / Inject the html into the html - webpack - plugin <nl> @ @ - 134 , 32 + 131 , 24 @ @ base . plugins . push ( <nl> windows : true <nl> } <nl> } ) , <nl> - new BabiliPlugin ( ) , <nl> - / / XXX : https : / / github . com / webpack - contrib / uglifyjs - webpack - plugin <nl> - / / XXX : uglify - js 3 . * doesn ' t working with es6 currently ! <nl> - / / new UglifyJsPlugin ( { <nl> - / / sourceMap : true , <nl> - / / compress : { <nl> - / / warnings : false <nl> - / / } , <nl> - / / output : { <nl> - / / comments : false <nl> - / / } <nl> - / / } ) , <nl> - / / <nl> - / / <nl> - / / NOTE : you can uncomment this option . <nl> - / / I think it ' s unnecessary for small app , because it slows page finish loading . <nl> - / / new PreloadWebpackPlugin ( { <nl> - / / rel : ' preload ' , <nl> - / / as : ' script ' , <nl> - / / include : ' asyncChunks ' <nl> - / / } ) , <nl> - / / <nl> - / / <nl> + / / NOTE : temporarily comment babiliplugin , because it breaks build on Linux Alpine <nl> + / / new BabiliPlugin ( ) , <nl> + new UglifyJSPlugin ( { <nl> + sourceMap : true , <nl> + compress : { <nl> + warnings : false <nl> + } , <nl> + output : { <nl> + comments : false <nl> + } <nl> + } ) , <nl> + new PreloadWebpackPlugin ( { <nl> + rel : ' preload ' , <nl> + as : ' script ' , <nl> + include : ' asyncChunks ' <nl> + } ) , <nl> / / create manifest . json <nl> new ManifestPlugin ( { fileName : ' manifest . json ' , cache : config . manifest } ) , <nl> - / / <nl> / / AppCache + ServiceWorkers <nl> new OfflinePlugin ( { <nl> safeToUseOptionalCaches : true , <nl> @ @ - 177 , 13 + 166 , 13 @ @ base . plugins . push ( <nl> } ) , <nl> new CompressionPlugin ( { <nl> algorithm : ' gzip ' <nl> - } ) <nl> + } ) , <nl> / / https : / / caniuse . com / # feat = subresource - integrity <nl> / / NOTE : please , read about SRI before using it ! <nl> - / / new SriPlugin ( { <nl> - / / hashFuncNames : [ ' sha256 ' , ' sha384 ' ] , <nl> - / / enabled : process . env . NODE_ENV = = = ' production ' <nl> - / / } ) <nl> + new SriPlugin ( { <nl> + hashFuncNames : [ ' sha256 ' , ' sha384 ' ] , <nl> + enabled : process . env . NODE_ENV = = = ' production ' <nl> + } ) <nl> ) <nl> / / minimize webpack output <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " db " : " nodemon . / db " , <nl> " docs " : " esdoc & & serve . / esdoc " , <nl> - " build " : " webpack - - config webpack_config / webpack . prod . js " , <nl> + " build " : " npm run build_client & & npm run build_server " , <nl> + " build_client " : " webpack - - config webpack_config / webpack . prod . js " , <nl> + " build_server " : " babel src / server - d src / server_build " , <nl> " test " : " jest - - config = jest_config / jest . config . json - - coverage - - forceExit | | true " , <nl> " dev " : " node webpack_config / server . js " , <nl> - " start " : " BABEL_ENV = ssr babel - node . / src / server " , <nl> - " ssr " : " nodemon - - exec BABEL_ENV = ssr babel - node . / src / server " , <nl> + " start " : " NODE_ENV = production IS_SSR = true node . / src / server_build " , <nl> + " ssr " : " nodemon - - exec IS_SSR = true node . / src / server " , <nl> " precommit " : " npm run test " , <nl> " prepush " : " echo \ " $ ( tput bold ) $ ( tput setaf 5 ) Hello , my name is React - Semantic - UI - Starter , and I am happy to see that you use this project : ) $ ( tput sgr 0 ) \ " " , <nl> " lint : styles " : " stylelint . / src / common / * * / * . scss - s scss - - config . / . stylelintrc - - fix " , <nl> 
mmm a / webpack_config / webpack . base . js <nl> ppp b / webpack_config / webpack . base . js <nl> const path = require ( ' path ' ) <nl> const webpack = require ( ' webpack ' ) <nl> - const CopyWebpackPlugin = require ( ' copy - webpack - plugin ' ) <nl> const languages = require ( ' . . / i18n ' ) <nl> const config = require ( ' . / config ' ) <nl> @ @ - 40 , 7 + 39 , 9 @ @ module . exports = { <nl> containers : ` $ { config . srcCommonPath } / containers / ` , <nl> reducers : ` $ { config . srcCommonPath } / reducers / ` , <nl> routing : ` $ { config . srcCommonPath } / routing / ` , <nl> - styles : ` $ { config . srcCommonPath } / styles / ` <nl> + styles : ` $ { config . srcCommonPath } / styles / ` , <nl> + static : path . join ( __dirname , ' . . / static ' ) , <nl> + images : path . join ( __dirname , ' . . / static / images ' ) <nl> } , <nl> modules : [ <nl> / / places where to search for required modules <nl> @ @ - 70 , 33 + 71 , 39 @ @ module . exports = { <nl> } , <nl> { <nl> test : / \ . ( ico | eot | otf | webp | ttf | woff | woff2 ) $ / i , <nl> - use : ` file - loader ? limit = 100000 & name = assets / [ name ] . [ hash ] . [ ext ] ` <nl> + use : ` file - loader ? limit = 100000 & name = assets / [ name ] . [ hash : 8 ] . [ ext ] ` <nl> } , <nl> { <nl> - test : / \ . ( jpe ? g | png | gif | svg ) $ / i , <nl> + test : / \ . ( jpe ? g | png | gif | svg ) $ / , <nl> use : [ <nl> - ` file - loader ? limit = 100000 & name = assets / [ name ] . [ hash ] . [ ext ] ` <nl> - / / NOTE : it looks like there is an issue using img - loader in some environments <nl> + { <nl> + loader : ' url - loader ' , <nl> + options : { <nl> + limit : 8192 , <nl> + / / path : ' / images ' , <nl> + name : ' images / [ name ] . [ hash : 8 ] . [ ext ] ' <nl> + } <nl> + } , <nl> + ' img - loader ' <nl> + ] <nl> + } <nl> + / / NOTE : LQIP loader doesn ' t work with file - loader and url - loader : ( <nl> + / / ` npm i - - save - dev lqip - loader ` <nl> + / / { <nl> + / / test : / \ . ( jpe ? g | png ) $ / i , <nl> + / / enforce : ' pre ' , <nl> + / / loaders : [ <nl> / / { <nl> - / / loader : ' img - loader ' , <nl> + / / loader : ' lqip - loader ' , <nl> / / options : { <nl> - / / enabled : true , <nl> - / / optipng : true <nl> + / / path : ' / images - lqip ' , / / your image going to be in media folder in the output dir <nl> + / / name : ' [ name ] - lqip . [ hash : 8 ] . [ ext ] ' / / you can use [ hash ] . [ ext ] too if you wish <nl> / / } <nl> / / } <nl> - ] <nl> - } <nl> + / / ] <nl> + / / } <nl> ] <nl> } , <nl> - plugins : [ <nl> - new webpack . DefinePlugin ( definePluginArgs ) , <nl> - new CopyWebpackPlugin ( [ <nl> - { <nl> - from : path . join ( __dirname , ' . . / static ' ) , <nl> - / / Fix path for demo <nl> - to : ' . / ' <nl> - } <nl> - ] ) <nl> - ] , <nl> + plugins : [ new webpack . DefinePlugin ( definePluginArgs ) ] , <nl> target : ' web ' <nl> } <nl> 
mmm a / src / server / index . js <nl> ppp b / src / server / index . js <nl> global . window = { <nl> addEventListener : ( ) = > { } <nl> } <nl> + const { BASE_API , PORT } = process . env <nl> + process . env . BASE_API = BASE_API ? BASE_API : ' / api / v1 ' <nl> + process . env . PORT = PORT ? PORT : 4000 <nl> global . i18n = ( ) = > { } <nl> global . fetch = require ( ' node - fetch ' ) <nl> require ( ' . / server ' ) <nl> 
mmm a / src / server / server . js <nl> ppp b / src / server / server . js <nl> import API from ' . / api ' <nl> import useSSR from ' . / ssr ' <nl> - <nl> - const httpPort = process . env . PORT | | 3000 <nl> - <nl> - / / add handler for non - static requests <nl> - app . use ( ' / api / v1 ' , API ) <nl> - / / SSR <nl> + / / see src / server / index . js <nl> + const { PORT , BASE_API } = process . env <nl> + / / Add API route <nl> + app . use ( BASE_API , API ) <nl> + / / Add SSR handler <nl> app . get ( ' * ' , useSSR ) <nl> - <nl> - app . listen ( httpPort , ( ) = > { <nl> + / / Start server <nl> + app . listen ( PORT , ( ) = > { <nl> console . log ( ` SSR ON PORT $ { httpPort } ! SSR ! ` ) <nl> } ) <nl> 
mmm a / src / server / express / index . js <nl> ppp b / src / server / express / index . js <nl> + / / Express - related stuff <nl> import express from ' express ' <nl> import expressHelmet from ' helmet ' <nl> import compression from ' compression ' <nl> import path from ' path ' <nl> import fs from ' fs ' <nl> import cookieParser from ' cookie - parser ' <nl> + import morgan from ' morgan ' <nl> + / / Application - related stuff <nl> + / / Do you remember that we use webpack aliases provided by cool babel plugin in . babelrc <nl> + import { JWT_TOKEN } from ' common / api ' <nl> / / <nl> const language = process . env . APP_LANGUAGE | | ' en ' <nl> const distPath = ` . . / . . / . . / dist / $ { language } ` <nl> const app = express ( ) <nl> / / add express stuff <nl> app . use ( compression ( ) ) <nl> + app . use ( morgan ( ' dev ' ) ) <nl> app . use ( cookieParser ( ) ) <nl> app . use ( <nl> express . static ( path . join ( __dirname , distPath ) , { <nl> @ @ - 21 , 4 + 26 , 18 @ @ app . use ( <nl> app . disable ( ' x - powered - by ' ) <nl> app . use ( expressHelmet ( ) ) <nl> + / / Auth - related middleware , check that user is logged in and token is valid <nl> + app . use ( ( req , res , next ) = > { <nl> + / / Of course , you can make auth with jwt or cookies or session only <nl> + / / It ' s a starter project and I implemented a hardcoded solution <nl> + const token = req . cookies [ JWT_TOKEN ] <nl> + const isLoggedIn = token = = = ' nothing ' <nl> + console . log ( ` USER IS LOGGED IN : $ { isLoggedIn ? ' YES ' : ' NO ' } ` ) <nl> + req . user = { <nl> + token , <nl> + isLoggedIn <nl> + } <nl> + next ( ) <nl> + } ) <nl> + <nl> export default app <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import fs from ' fs ' <nl> - / / React stuff <nl> + / / React - related stuff <nl> import React from ' react ' <nl> import { render } from ' rapscallion ' <nl> import Helmet from ' react - helmet ' <nl> import { StaticRouter } from ' react - router ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> / / Application <nl> - import { configureStore , configureRootComponent } from ' common ' <nl> - import { JWT_TOKEN } from ' api ' <nl> + / / Do you remember that we use webpack aliases provided by cool babel plugin ? <nl> + / / ( take a look at . babelrc ) <nl> + import { configureStore , configureRootComponent } from ' common / index ' <nl> / / <nl> const language = process . env . APP_LANGUAGE | | ' en ' <nl> const distPath = ` . . / . . / . . / dist / $ { language } ` <nl> @ @ - 24 , 17 + 25 , 12 @ @ const indexHTMLFileContent = ( function ( ) { <nl> export default function ( req , res ) { <nl> - / / Auth stuff <nl> - const { cookies } = req <nl> - const token = cookies [ JWT_TOKEN ] <nl> - / / <nl> - / / <nl> - / / HERE SHOULD BE CHECK THAT TOKEN IS VALID <nl> - / / <nl> - / / <nl> - const isTokenValid = true <nl> - const initialState = isTokenValid <nl> - ? { me : { auth : { token , isLoggedIn : true } } } <nl> + / / Auth - related stuff <nl> + / / NOTE : check ` server / express / index . js ` for more info <nl> + const { user } = req <nl> + const { isLoggedIn , token } = user <nl> + const initialState = isLoggedIn <nl> + ? { me : { auth : { isLoggedIn , token } } } <nl> : { } <nl> / / <nl> const sheet = new ServerStyleSheet ( ) <nl> 
mmm a / webpack_config / server . js <nl> ppp b / webpack_config / server . js <nl> const path = require ( ' path ' ) <nl> const express = require ( ' express ' ) <nl> + const httpProxy = require ( ' http - proxy ' ) <nl> const webpack = require ( ' webpack ' ) <nl> const webpackConfig = require ( ' . / webpack . dev ' ) <nl> const config = require ( ' . / config ' ) <nl> @ @ - 8 , 6 + 9 , 7 @ @ const LogPlugin = require ( ' . / log - plugin ' ) <nl> const open = require ( ' open ' ) <nl> const app = express ( ) <nl> + const apiProxy = httpProxy . createProxyServer ( ) <nl> const port = config . port <nl> webpackConfig . entry . client = [ <nl> @ @ - 38 , 6 + 40 , 7 @ @ const devMiddleWare = require ( ' webpack - dev - middleware ' ) ( compiler , { <nl> ' Access - Control - Allow - Headers ' : ' * ' <nl> } <nl> } ) <nl> + <nl> app . use ( devMiddleWare ) <nl> app . use ( <nl> require ( ' webpack - hot - middleware ' ) ( compiler , { <nl> @ @ - 57 , 6 + 60 , 17 @ @ app . get ( ' * ' , ( req , res ) = > { <nl> } ) <nl> } ) <nl> + / / Proxy api requests <nl> + app . use ( process . env . BASE_API , function ( req , res ) { <nl> + req . url = req . baseUrl <nl> + apiProxy . web ( req , res , { <nl> + target : { <nl> + port : 4000 , <nl> + host : ' localhost ' <nl> + } <nl> + } ) <nl> + } ) <nl> + <nl> app . listen ( port ) <nl> open ( ` http : / / localhost : $ { port } ` ) <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> } <nl> ] , <nl> - " react - hot - loader / babel " , <nl> - " syntax - dynamic - import " , <nl> - [ <nl> - " babel - plugin - webpack - alias " , <nl> - { <nl> - " config " : " . / webpack_config / webpack . base . js " , <nl> - " findConfig " : true <nl> - } <nl> - ] , <nl> - " dynamic - import - node " <nl> + " syntax - dynamic - import " <nl> ] , <nl> " presets " : [ " es2015 " , " react " , " stage - 0 " ] , <nl> " env " : { <nl> " production " : { <nl> " presets " : [ " react - optimize " ] <nl> + } , <nl> + " development " : { <nl> + " plugins " : [ <nl> + " react - hot - loader / babel " <nl> + ] <nl> } <nl> } <nl> } <nl> 
mmm a / . eslintrc . json <nl> ppp b / . eslintrc . json <nl> " extends " : [ " plugin : react / recommended " , " standard " ] , <nl> " parser " : " babel - eslint " , <nl> - " plugins " : [ <nl> - " react " , <nl> - " babel " <nl> - ] , <nl> + " plugins " : [ " react " , " babel " ] , <nl> " parserOptions " : { <nl> " ecmaFeatures " : { <nl> " jsx " : true , <nl> " no - tabs " : 0 <nl> } , <nl> " globals " : { <nl> - " i18n " : true <nl> + " i18n " : true , <nl> + " Raven " : true , <nl> + " ga " : true <nl> } <nl> } <nl> 
mmm a / src / server / api / auth / index . js <nl> ppp b / src / server / api / auth / index . js <nl> + import jwt from ' jsonwebtoken ' <nl> + import chalk from ' chalk ' <nl> + / / import validator from ' validator ' <nl> + / / { isLength , trim , isAlphanumeric , escape } <nl> const router = Router ( ) <nl> / / define the home page route <nl> router . post ( ' / ' , ( req , res ) = > { <nl> - res . json ( { token : ' nothing ' } ) <nl> + / / const { username , password } = req . body <nl> + / / const usernameValidated = validator . isLength ( 0 , 36 ) . is <nl> + / / const passwordValidated = <nl> + const data = { username : ' cool_username_for_testing ' } <nl> + jwt . sign ( data , process . env . JWT_SECRET , ( err , token ) = > { <nl> + if ( err ) { <nl> + throw new Error ( <nl> + ` Cant create JWT token based on input data : $ { JSON . stringify ( data ) } ` , <nl> + err <nl> + ) <nl> + } <nl> + console . log ( chalk . yellow ( ` Generated token for user : $ { data . username } ` ) ) <nl> + res . json ( { token } ) <nl> + } ) <nl> } ) <nl> export default router <nl> 
mmm a / src / server / index . js <nl> ppp b / src / server / index . js <nl> - / / NOTE : uncomment these lines below if you use scss / sass ! <nl> - / / require . extensions [ ' . scss ' ] = ( ) = > { } <nl> - / / require . extensions [ ' . css ' ] = ( ) = > { } <nl> - global . window = { <nl> - addEventListener : ( ) = > { } <nl> - } <nl> - const { BASE_API , PORT } = process . env <nl> - process . env . BASE_API = BASE_API ? BASE_API : ' / api / v1 ' <nl> - process . env . PORT = PORT ? PORT : 4000 <nl> - global . i18n = ( ) = > { } <nl> - global . fetch = require ( ' node - fetch ' ) <nl> + global . i18n = str = > str <nl> + global . fetch = require ( ' isomorphic - fetch ' ) <nl> + <nl> + / / import app <nl> require ( ' . / server ' ) <nl> 
mmm a / src / server / server . js <nl> ppp b / src / server / server . js <nl> import API from ' . / api ' <nl> import useSSR from ' . / ssr ' <nl> - / / see src / server / index . js <nl> - const { PORT , BASE_API } = process . env <nl> + import chalk from ' chalk ' <nl> + <nl> + const { BASE_API , PORT } = process . env <nl> / / Add API route <nl> app . use ( BASE_API , API ) <nl> / / Add SSR handler <nl> - app . get ( ' * ' , useSSR ) <nl> + app . use ( useSSR ) <nl> / / Start server <nl> app . listen ( PORT , ( ) = > { <nl> - console . log ( ` Server is running on $ { PORT } port ! ` ) <nl> + console . log ( chalk . green ( ` \ nServer is running on $ { PORT } port ! \ n ` ) ) <nl> } ) <nl> 
mmm a / src / common / components / addons / RouteAuth / index . jsx <nl> ppp b / src / common / components / addons / RouteAuth / index . jsx <nl> componentWillMount ( ) { <nl> const { lazy , component } = this . props <nl> if ( lazy ) { <nl> + console . log ( ' Component is lazy , loading . . . ' ) <nl> this . load ( ) <nl> } else { <nl> this . setState ( { componentLoaded : true , componentToRender : component } ) <nl> @ @ - 49 , 6 + 50 , 9 @ @ class RouteAuth extends Component { <nl> component : componentToRender | | null <nl> } <nl> + console . log ( ` User has access to " $ { path } " path : $ { canAccess ( path ) ? ' YES ' : ' NO ' } ` ) <nl> + console . log ( ` Route ' s component loaded and ready to be mounted : $ { componentLoaded ? ' YES ' : ' NO ' } ` ) <nl> + <nl> if ( componentLoaded ) { <nl> return canAccess ( path ) <nl> ? < Route { . . . routeProps } / > <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> filename : ' [ name ] . [ chunkhash : 8 ] . css ' , <nl> allChunks : true <nl> } ) , <nl> - new OptimizeCssAssetsPlugin ( ) , <nl> + new OptimizeCssAssetsPlugin ( { <nl> + cssProcessorOptions : { <nl> + safe : true , <nl> + discardComments : { <nl> + removeAll : true <nl> + } <nl> + } <nl> + } ) , <nl> / / NOTE : ModuleConcatenationPlugin doesn ' t work on linux alpine , <nl> / / I got an error trying to deploy this app to zeit ' s ` now ` when i use this plugin <nl> / / new webpack . optimize . ModuleConcatenationPlugin ( ) , <nl> @ @ - 114 , 17 + 121 , 15 @ @ base . plugins . push ( <nl> name : ' manifest ' <nl> } ) , <nl> new webpack . BannerPlugin ( { <nl> - banner : <nl> - ' React - Semantic . UI - Starter . MIT License . Copyright ( c ) 2017 Copyright Vladimir Metnew . All Rights Reserved . https : / / github . com / Metnew / react - semantic . ui - starter ' <nl> + banner : config . banner <nl> } ) , <nl> - / / XXX : this plugin seems cool , but there are few big issues : <nl> + / / XXX : this plugin looks cool , but there are few big issues : <nl> / / 1 . It sets invalid url to browserconfig . xml and manifest . json in index . html . <nl> / / E . g : in generated index . html you can see : <nl> / / < meta name = " msapplication - config " content = " browserconfig . xml " > <nl> / / 2 . It looks like generated images aren ' t minified . ( not sure ) <nl> + / / 3 . plugin is deprecated ( at least look like it ' s deprecated ) ! <nl> / / NOTE : It would be better to generate favicons without this plugin . <nl> - / / <nl> - / / <nl> new FaviconsWebpackPlugin ( { <nl> / / add theme - color property <nl> background : config . manifest . theme , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " docs " : " esdoc & & serve . / esdoc " , <nl> " build " : " npm run frontend_build & & npm run server_build " , <nl> - " dev " : " concurrently \ " npm run server_dev \ " \ " npm run frontend_dev \ " " , <nl> + " dev " : " concurrently - p \ " [ { name } ] \ " - n \ " SERVER , FRONTEND \ " - c \ " cyan . bold , magenta . bold \ " \ " npm run server_dev \ " \ " npm run frontend_dev \ " " , <nl> " server_dev " : " webpack - - config webpack_config / server / webpack . dev . babel . js " , <nl> " server_build " : " NODE_ENV = production webpack - - config webpack_config / server / webpack . prod . babel . js " , <nl> " test " : " jest - - config = jest_config / jest . config . json - - coverage - - forceExit | | true " , <nl> 
mmm a / webpack_config / client / webpack . base . js <nl> ppp b / webpack_config / client / webpack . base . js <nl> const webpack = require ( ' webpack ' ) <nl> const config = require ( ' . . / config ' ) <nl> - process . env . BASE_API = process . env . BASE_API | | ' / api / v1 ' <nl> + const { BASE_API , NODE_ENV , GA_ID , SENTRY_PUBLIC_DSN } = process . ENV <nl> let definePluginArgs = { <nl> - ' process . env . NODE_ENV ' : JSON . stringify ( process . env . NODE_ENV ) , <nl> - ' process . env . BASE_API ' : JSON . stringify ( process . env . BASE_API ) , <nl> - ' process . env . SENTRY_PUBLIC_DSN ' : JSON . stringify ( process . env . SENTRY_PUBLIC_DSN ) , <nl> + ' process . env . NODE_ENV ' : JSON . stringify ( NODE_ENV ) , <nl> + ' process . env . BASE_API ' : JSON . stringify ( BASE_API | | ' / api / v1 ' ) , <nl> + ' process . env . GA_ID ' : JSON . stringify ( GA_ID ) , <nl> + ' process . env . SENTRY_PUBLIC_DSN ' : JSON . stringify ( SENTRY_PUBLIC_DSN ) , <nl> ' process . env . BROWSER ' : JSON . stringify ( true ) <nl> } <nl> 
mmm a / src / client / index . jsx <nl> ppp b / src / client / index . jsx <nl> require ( ' common / pwa ' ) <nl> } else if ( process . env . NODE_ENV = = = ' development ' ) { <nl> / / Devtools <nl> - / / whyDidYouUpdate package is temporary broken , waiting for a patch <nl> - / / const { whyDidYouUpdate } = require ( ' why - did - you - update ' ) <nl> - / / whyDidYouUpdate ( React ) <nl> + / / NOTE : whyDidYouUpdate package is temporary broken , waiting for a patch . <nl> + <nl> + / * eslint - disable * / <nl> + / / XXX : But if you really want to run ` why - did - you - update ` <nl> + / / You can uncomment this block : <nl> + / * <nl> + Object . defineProperty ( React , ' createClass ' , { <nl> + set : nextCreateClass = > { <nl> + createClass = nextCreateClass <nl> + } <nl> + } ) <nl> + <nl> + const { whyDidYouUpdate } = require ( ' why - did - you - update ' ) <nl> + whyDidYouUpdate ( React ) <nl> + * / <nl> + / * eslint - enable * / <nl> window . Perf = require ( ' react - addons - perf ' ) <nl> } <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> / / NOTE : ModuleConcatenationPlugin doesn ' t work on linux alpine , <nl> / / I got an error trying to deploy this app to zeit ' s ` now ` when i use this plugin <nl> / / Maybe , I got this error because of certain memory limit in ` now ` instance <nl> - / / new webpack . optimize . ModuleConcatenationPlugin ( ) , <nl> + new webpack . optimize . ModuleConcatenationPlugin ( ) , <nl> new ShakePlugin ( ) , <nl> / / NOTE : you can use BabiliPlugin as an alternative to UglifyJSPlugin <nl> / / new BabiliPlugin ( ) , <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> let languages = config . i18n <nl> const languageName = APP_LANGUAGE | | ' en ' <nl> - exec ( ' rm - rf dist / client ' ) <nl> + exec ( ` rm - rf $ { config . distPath } / client / $ { languageName } ` ) <nl> / / NOTE : you can track versions with gitHash and store your build <nl> / / in dist folder with path like : / dist / < gitHash > / { yourFilesHere } <nl> / / const gitHash = git . short ( ) / / <nl> @ @ - 178 , 20 + 178 , 16 @ @ base . plugins . push ( <nl> template : path . resolve ( config . srcCommonPath , ' index . ejs ' ) , <nl> filename : path . resolve ( base . output . path , ' index . html ' ) , <nl> chunksSortMode : ' dependency ' <nl> - } ) , <nl> - new OfflinePlugin ( { <nl> + } ) <nl> + / / new OfflinePlugin ( { <nl> / / responseStrategy : ' network - first ' , <nl> / / safeToUseOptionalCaches : false , <nl> / / caches : { <nl> / / main : [ ' vendor . * . css ' , ' vendor . * . js ' ] <nl> / / } , <nl> / / excludes : [ ' . htaccess ' ] , <nl> - AppCache : false , <nl> - / / ServiceWorker : { <nl> - / / navigateFallbackURL : ' / ? offline = true ' , <nl> - / / events : true <nl> - / / } <nl> - } ) <nl> + / / AppCache : false <nl> + / / } ) <nl> ) <nl> / / minimize webpack output <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> / / Do you want to use bundle analyzer ? <nl> if ( ANALYZE_BUNDLE ) { <nl> - base . plugins . push ( new BundleAnalyzerPlugin ( ) ) <nl> + base . plugins . push ( new BundleAnalyzerPlugin ( { analyzerMode : ' static ' } ) ) <nl> } <nl> / / NOTE : if language was set , then build only this language <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> test : / \ . ( js | jsx ) $ / , <nl> use : ' babel - loader ' , <nl> exclude : [ / node_modules / ] <nl> + } , <nl> + / / NOTE : LQIP loader doesn ' t work with file - loader and url - loader : ( <nl> + / / ` npm i - - save - dev lqip - loader ` <nl> + / / { <nl> + / / test : / \ . ( jpe ? g | png ) $ / i , <nl> + / / enforce : ' pre ' , <nl> + / / loaders : [ <nl> + / / { <nl> + / / loader : ' lqip - loader ' , <nl> + / / options : { <nl> + / / path : ' / images - lqip ' , / / your image going to be in media folder in the output dir <nl> + / / name : ' [ name ] - lqip . [ hash : 8 ] . [ ext ] ' / / you can use [ hash ] . [ ext ] too if you wish <nl> + / / } <nl> + / / } <nl> + / / ] <nl> + / / } <nl> + { <nl> + test : / \ . ( jpe ? g | png | gif | svg ) $ / , <nl> + use : [ <nl> + { <nl> + loader : ' url - loader ' , <nl> + options : { <nl> + limit : 25000 , <nl> + name : ' images / [ name ] . [ hash : 8 ] . [ ext ] ' <nl> + } <nl> + } , <nl> + ' img - loader ' <nl> + ] <nl> } <nl> ] <nl> } , <nl> @ @ - 91 , 13 + 119 , 7 @ @ module . exports = { <nl> new webpack . NamedModulesPlugin ( ) , <nl> new webpack . BannerPlugin ( { <nl> banner : config . banner <nl> - } ) , <nl> - / / Server can ' t process require of your styles / images / fonts <nl> - new webpack . NormalModuleReplacementPlugin ( <nl> - / \ . ( css | sass | less | jpg | png | gif | scss ) $ / , <nl> - ' node - noop ' <nl> - ) <nl> - / / new webpack . IgnorePlugin ( / \ . ( css | sass | less | jpg | png | gif | scss ) $ / ) <nl> + } ) <nl> ] , <nl> node : { <nl> __dirname : true , <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> exec ( ` rm - rf $ { config . distPath } / client / $ { languageName } ` ) <nl> / / NOTE : you can track versions with gitHash and store your build <nl> - / / in dist folder with path like : / dist / < gitHash > / { yourFilesHere } <nl> + / / in dist folder with path like : / dist / client / < gitHash > / < languageName > / { yourFilesHere } <nl> / / const gitHash = git . short ( ) / / <nl> / / use hash filename to support long - term caching <nl> @ @ - 182 , 15 + 182 , 17 @ @ base . plugins . push ( <nl> new OfflinePlugin ( { <nl> publicPath : ' / ' , <nl> caches : { <nl> - main : [ ' vendor . * . js ' , ' vendor . * . css ' , ' manifest . * . js ' , ' client . * . js ' ] <nl> - } , <nl> - excludes : [ ' / ' , ' ' ] , <nl> - externals : [ ' / auth ' ] , <nl> - rewrites : ( ) = > { <nl> - return ' ' <nl> + main : [ ' vendor . * . js ' , ' vendor . * . css ' , ' manifest . * . js ' , ' client . * . js ' , ' assets / icons . * . * ' ] <nl> } , <nl> + excludes : [ ' * * / . * ' , ' * * / * . map ' ] , <nl> + externals : [ <nl> + ' / ' , <nl> + ' / auth ' , <nl> + ' https : / / fonts . googleapis . com / css ? family = Lato : 400 , 700 , 400italic , 700italic & subset = latin ' <nl> + ] , <nl> ServiceWorker : { <nl> - navigateFallbackURL : ' / auth ' , <nl> + events : true , <nl> + navigateFallbackURL : ' / auth ? offline = true ' , <nl> navigateFallbackForRedirects : false <nl> } , <nl> AppCache : false <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> ] ) <nl> } , <nl> plugins : isomorphicWebpackConfig . plugins . concat ( [ <nl> + new webpack . NormalModuleReplacementPlugin ( <nl> + / \ . ( css | sass | less | scss ) $ / , <nl> + ' node - noop ' <nl> + ) , <nl> new webpack . DefinePlugin ( definePluginArgs ) <nl> ] ) , <nl> node : { <nl> 
mmm a / src / common / containers / App / index . jsx <nl> ppp b / src / common / containers / App / index . jsx <nl> import Header from ' components / views / Header ' <nl> import { CLOSE_SIDEBAR , OPEN_SIDEBAR , WINDOW_RESIZE } from ' actions / layout ' <nl> import { LOGOUT_AUTH } from ' actions / auth ' <nl> - import { routes } from ' routing ' <nl> import { <nl> PageLayout , <nl> MainLayout , <nl> @ @ - 22 , 6 + 21 , 8 @ @ import { <nl> class App extends Component { <nl> static propTypes = { <nl> children : PropTypes . node . isRequired , <nl> + / / Routes of app passed as props in ` Root ` <nl> + routes : PropTypes . array . isRequired , <nl> / / React - router ` withRouter ` props <nl> location : PropTypes . object , <nl> history : PropTypes . object , <nl> @ @ - 118 , 7 + 119 , 7 @ @ class App extends Component { <nl> * @ return { Array } array of routes that will be rendered in sidebar menu <nl> * / <nl> getSidebarRouting ( ) { <nl> - const sidebarRouting = routes . filter ( a = > a . sidebarVisible ) . map ( a = > { <nl> + const sidebarRouting = this . props . routes . filter ( a = > a . sidebarVisible ) . map ( a = > { <nl> const { path , name , icon , external , strict , exact } = a <nl> const b = { path , name , icon , external , strict , exact } <nl> return b <nl> @ @ - 132 , 7 + 133 , 7 @ @ class App extends Component { <nl> * @ return { String } page title <nl> * / <nl> getPageTitle ( pathname ) { <nl> - const matchedRoutes = routes . filter ( a = > matchPath ( pathname , a ) ) <nl> + const matchedRoutes = this . props . routes . filter ( a = > matchPath ( pathname , a ) ) <nl> const currentRoute = matchedRoutes [ 0 ] | | { } <nl> const title = currentRoute . name | | ' 404 ' <nl> return title <nl> 
mmm a / src / common / components / views / Root / index . jsx <nl> ppp b / src / common / components / views / Root / index . jsx <nl> < Provider store = { store } key = { Math . random ( ) } > <nl> < ThemeProvider theme = { theme } > <nl> < Router { . . . routerProps } key = { Math . random ( ) } > <nl> - < App > <nl> + < App routes = { routes } > <nl> < RoutingWrapper store = { store } routes = { routes } / > <nl> < / App > <nl> < / Router > <nl> 
mmm a / webpack_config / client / webpack . base . js <nl> ppp b / webpack_config / client / webpack . base . js <nl> resolve : { <nl> alias : isomorphicWebpackConfig . resolve . alias , <nl> modules : isomorphicWebpackConfig . resolve . modules , <nl> - extensions : isomorphicWebpackConfig . resolve . extensions . concat ( [ ' . css ' , ' . scss ' ] ) <nl> + extensions : isomorphicWebpackConfig . resolve . extensions . concat ( [ ' . css ' , ' . scss ' , ' . sass ' ] ) <nl> } , <nl> module : { <nl> rules : isomorphicWebpackConfig . module . rules . concat ( [ <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> const loadLazyComponent = url = > { <nl> return async cb = > { <nl> - const loadComponent = await import ( / * webpackMode : " lazy - once " , webpackChunkName : " lazy - containers " * / ` containers / $ { url } / index . jsx ` ) <nl> + const str = ` containers / $ { url } / index . jsx ` <nl> + if ( process . env . BROWSER ) { <nl> + const loadComponent = await import ( / * webpackMode : " lazy - once " , webpackChunkName : " lazy - containers " * / str ) <nl> + return loadComponent <nl> + } <nl> + const loadComponent = await import ( / * webpackMode : " eager " , webpackChunkName : " lazy - containers " * / str ) <nl> return loadComponent <nl> } <nl> } <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> " development " : { <nl> " plugins " : [ <nl> - " react - hot - loader / babel " <nl> + " react - hot - loader / babel " , <nl> + [ <nl> + " babel - plugin - webpack - alias " , <nl> + { <nl> + " config " : " . / webpack_config / client / webpack . base . js " , <nl> + " findConfig " : true <nl> + } <nl> + ] <nl> + ] <nl> + } , <nl> + " test " : { <nl> + " plugins " : [ <nl> + [ <nl> + " babel - plugin - webpack - alias " , <nl> + { <nl> + " config " : " . / webpack_config / webpack . isomorphic . js " , <nl> + " findConfig " : true <nl> + } <nl> + ] <nl> ] <nl> } <nl> } <nl> 
mmm a / . eslintrc . json <nl> ppp b / . eslintrc . json <nl> - " extends " : [ " plugin : react / recommended " , " standard " ] , <nl> + " extends " : [ <nl> + " plugin : react / recommended " , <nl> + " plugin : jsx - a11y / recommended " , <nl> + " standard " <nl> + ] , <nl> " parser " : " babel - eslint " , <nl> - " plugins " : [ " react " , " babel " ] , <nl> + " plugins " : [ " react " , " babel " , " jsx - a11y " ] , <nl> " parserOptions " : { <nl> " ecmaFeatures " : { <nl> " jsx " : true , <nl> " node " : true <nl> } , <nl> " rules " : { <nl> - " no - unused - vars " : 1 , <nl> + " no - unused - vars " : 0 , <nl> " no - tabs " : 0 , <nl> " indent " : [ 2 , " tab " ] <nl> } , <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> import i18n from ' . . / i18n ' <nl> import manifest from ' . / assets / manifest ' <nl> - function ternary ( a , b ) { <nl> - return a ? a : b <nl> - } <nl> + let { <nl> + BASE_API , <nl> + APP_LANGUAGE , <nl> + NODE_ENV , <nl> + SENTRY_DSN_PUBLIC , <nl> + GA_ID , <nl> + JWT_SECRET , <nl> + DIST_PATH , <nl> + SENTRY_DSN , <nl> + PORT <nl> + } = process . env <nl> / / Vars for both server and frontend <nl> - const BASE_API = ternary ( process . env . BASE_API , ' / api / v1 ' ) <nl> - const APP_LANGUAGE = ternary ( process . env . APP_LANGUAGE , ' en ' ) <nl> - const NODE_ENV = ternary ( process . env . NODE_ENV , ' development ' ) <nl> + BASE_API = BASE_API | | ' / api / v1 ' <nl> + APP_LANGUAGE = APP_LANGUAGE | | ' en ' <nl> + NODE_ENV = NODE_ENV | | ' development ' <nl> / / Vars for frontend only <nl> - const SENTRY_DSN_PUBLIC = ternary ( process . env . SENTRY_DSN_PUBLIC ) <nl> - const GA_ID = ternary ( process . env . GA_ID ) <nl> / / Paths <nl> const rootPath = path . join ( __dirname , ' . . / ' ) / / = " / " <nl> @ @ - 26 , 11 + 32 , 9 @ @ const srcPath = path . join ( rootPath , ' . / src ' ) / / = " / src " <nl> const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> / / Vars for server only <nl> - const DIST_PATH = ternary ( process . env . DIST_PATH , path . join ( distPath , ' . / client ' , APP_LANGUAGE ) ) <nl> - const JWT_SECRET = ternary ( process . env . JWT_SECRET , ' secret ' ) <nl> - const SENTRY_DSN = ternary ( process . env . SENTRY_DSN ) <nl> - const PORT = ternary ( process . env . PORT , 4000 ) <nl> - <nl> + DIST_PATH = DIST_PATH | | path . join ( distPath , ' . / client ' , APP_LANGUAGE ) <nl> + JWT_SECRET = JWT_SECRET | | ' secret ' <nl> + PORT = PORT | | 4000 <nl> export default { <nl> title : ' React - Semantic . UI - Starter ' , <nl> @ @ - 57 , 5 + 61 , 24 @ @ export default { <nl> banner : <nl> ' MIT License . Copyright ( c ) 2017 Vladimir Metnew All Rights Reserved . Repo : https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> / / your manifest . json <nl> - manifest <nl> + manifest , <nl> + vendor : [ <nl> + ' react ' , <nl> + ' react - dom ' , <nl> + ' redux ' , <nl> + ' history ' , <nl> + ' react - router ' , <nl> + ' react - router - dom ' , <nl> + ' react - router - redux ' , <nl> + ' semantic - ui - react ' , <nl> + ' redux - thunk ' , <nl> + ' react - helmet ' , <nl> + ' lodash ' , <nl> + ' normalizr ' , <nl> + ' js - cookie ' , <nl> + ' prop - types ' , <nl> + ' store2 ' , <nl> + ' styled - components ' <nl> + ] , <nl> + polyfills : [ ' promise - polyfill ' , ' isomorphic - fetch ' ] <nl> } <nl> 
mmm a / webpack_config / server / webpack . dev . babel . js <nl> ppp b / webpack_config / server / webpack . dev . babel . js <nl> import webpack from ' webpack ' <nl> - / / import _ from ' lodash ' <nl> import config from ' . . / config ' <nl> import baseWebpackConfig from ' . / webpack . base ' <nl> import WebpackShellPlugin from ' webpack - shell - plugin ' <nl> import FriendlyErrors from ' friendly - errors - webpack - plugin ' <nl> - const plugins = [ <nl> - new WebpackShellPlugin ( { <nl> - onBuildEnd : [ ` nodemon $ { path . join ( config . distPath , ' / server ' , config . APP_LANGUAGE ) } ` ] <nl> - } ) , <nl> - / / new webpack . HotModuleReplacementPlugin ( ) , <nl> - new webpack . NoEmitOnErrorsPlugin ( ) , <nl> - new FriendlyErrors ( ) <nl> - ] <nl> + const plugins = [ ] <nl> const build = Object . assign ( { } , baseWebpackConfig , { <nl> - / / entry : config . entry . concat ( [ ' webpack / hot / poll ? 1000 ' ] ) , <nl> devtool : ' eval - source - map ' , <nl> watch : true , <nl> plugins : baseWebpackConfig . plugins . concat ( plugins ) <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> " development " : { <nl> " plugins " : [ <nl> - " react - hot - loader / babel " , <nl> - [ <nl> - " babel - plugin - webpack - alias " , <nl> - { <nl> - " config " : " . / webpack_config / client / webpack . base . js " , <nl> - " findConfig " : true <nl> - } <nl> - ] <nl> + " react - hot - loader / babel " <nl> ] <nl> } , <nl> " test " : { <nl> " plugins " : [ <nl> + " dynamic - import - node " , <nl> [ <nl> - " babel - plugin - webpack - alias " , <nl> + " module - resolver " , <nl> { <nl> - " config " : " . / webpack_config / webpack . isomorphic . js " , <nl> - " findConfig " : true <nl> + " root " : [ " . / " ] , <nl> + " alias " : { <nl> + " actions " : " . / src / common / actions " , <nl> + " api " : " . / src / common / api " , <nl> + " components " : " . / src / common / components " , <nl> + " containers " : " . / src / common / containers " , <nl> + " reducers " : " . / src / common / reducers " , <nl> + " routing " : " . / src / common / routing " <nl> + } , <nl> + " extensions " : [ " . js " , " . jsx " , " . json " ] <nl> } <nl> ] <nl> ] <nl> 
mmm a / src / common / reducers / posts / index . test . js <nl> ppp b / src / common / reducers / posts / index . test . js <nl> } <nl> } <nl> + const LOCATION_CHANGE_TO_ITSELF = { <nl> + type : actions . LOCATION_CHANGE , <nl> + payload : { <nl> + pathname : ' / ' <nl> + } <nl> + } <nl> + <nl> describe ( ' POSTS REDUCER ' , ( ) = > { <nl> it ( ' should return the initial state ' , ( ) = > { <nl> expect ( reducer ( undefined , { x : ' string ' } ) ) . toEqual ( initialState ) <nl> @ @ - 72 , 8 + 79 , 16 @ @ describe ( ' POSTS REDUCER ' , ( ) = > { <nl> it ( ' should handle LOCATION_CHANGE to other paths ' , ( ) = > { <nl> const customState = { <nl> . . . initialState , <nl> - lol : 3 <nl> + hello : ' world ' <nl> } <nl> expect ( reducer ( customState , LOCATION_CHANGE_TO_INBOX ) ) . toEqual ( initialState ) <nl> } ) <nl> + <nl> + it ( ' should handle LOCATION_CHANGE to own path ' , ( ) = > { <nl> + const customState = { <nl> + . . . initialState , <nl> + hello : ' world ' <nl> + } <nl> + expect ( reducer ( customState , LOCATION_CHANGE_TO_ITSELF ) ) . toEqual ( customState ) <nl> + } ) <nl> } ) <nl> 
mmm a / webpack_config / server . js <nl> ppp b / webpack_config / server . js <nl> import path from ' path ' <nl> import express from ' express ' <nl> - import httpProxy from ' http - proxy ' <nl> import webpack from ' webpack ' <nl> - import webpackConfig from ' . / client / webpack . dev . babel ' <nl> - import config from ' . / config ' <nl> - import LogPlugin from ' . / log - plugin ' <nl> - import open from ' open ' <nl> - <nl> - const apiProxy = httpProxy . createProxyServer ( ) <nl> - const app = express ( ) <nl> - const port = 3000 <nl> - <nl> - webpackConfig . entry . client = [ <nl> - ' react - hot - loader / patch ' , <nl> - ' webpack - hot - middleware / client ? reload = true ' , <nl> - webpackConfig . entry . client <nl> - ] <nl> - <nl> - webpackConfig . plugins . push ( new LogPlugin ( port ) ) <nl> + import webpackDevMiddleware from ' webpack - dev - middleware ' <nl> + import webpackHotMiddleware from ' webpack - hot - middleware ' <nl> + import webpackHotFullStack from ' webpack - hot - fullstack - middleware ' <nl> + import WriteFilePlugin from ' write - file - webpack - plugin ' <nl> + import client from ' . / client / webpack . dev . babel ' <nl> + import server from ' . / server / webpack . dev . babel ' <nl> + / / Webpack plugins <nl> + import LogPlugin from ' . / assets / log - plugin ' <nl> + import FriendlyErrors from ' friendly - errors - webpack - plugin ' <nl> + / / Configs for MultiCompiler <nl> + const webpackConfig = [ client , server ] <nl> + / / Get MultiCompiler <nl> + const compiler = webpack ( webpackConfig ) <nl> + / / Apply some commonly used plugins <nl> + compiler . apply ( new FriendlyErrors ( ) ) <nl> + compiler . apply ( new LogPlugin ( ) ) <nl> + compiler . apply ( new webpack . NoEmitOnErrorsPlugin ( ) ) <nl> + / / Create devMiddleWare <nl> + const devMiddleWare = webpackDevMiddleware ( compiler , { <nl> + serverRenderer : true , <nl> + publicPath : webpackConfig [ 0 ] . output . publicPath , <nl> + quiet : false , <nl> + noInfo : true <nl> + } ) <nl> - let compiler <nl> + / / NOTE : Every time we apply our compiled code to development server <nl> + / / We add new middlewares from new code , but don ' t remove old middlewares from old code <nl> - try { <nl> - compiler = webpack ( webpackConfig ) <nl> - } catch ( err ) { <nl> - console . log ( err . message ) <nl> - process . exit ( 1 ) <nl> + / / Number of middlewares that our app should has <nl> + let prevSize = null <nl> + / * * <nl> + * @ desc Adds dev middlewares + your code to the instance of express server <nl> + * @ param { Function } app - Express dev server to which compiled code will be applied <nl> + * @ param { Function } wss - WebSocket server , allow you send event to client to re - render the page <nl> + * / <nl> + export default function ( app , wss ) { <nl> + / * * <nl> + * @ desc Function that executes after your server - side code compiles <nl> + * @ param { Function } serverSideCode - compiled server - side code <nl> + * / <nl> + const done = serverSideCode = > { <nl> + / / Get current stack of the app ( e . g . applied middlewares ) <nl> + const { stack } = app . _router <nl> + const { length } = stack <nl> + prevSize = prevSize | | length <nl> + if ( length > prevSize ) { <nl> + / / Remove old compiled code <nl> + app . _router . stack = stack . slice ( 0 , prevSize ) <nl> } <nl> - <nl> - const devMiddleWare = require ( ' webpack - dev - middleware ' ) ( compiler , { <nl> - publicPath : webpackConfig . output . publicPath , <nl> - / / @ Metnew : personally I prefer ` quite : " true " ` <nl> - quiet : false , <nl> - hot : true , <nl> - inline : true , <nl> - headers : { <nl> - ' Access - Control - Allow - Origin ' : ' * ' , <nl> - ' Access - Control - Allow - Methods ' : ' * ' , <nl> - ' Access - Control - Allow - Headers ' : ' * ' <nl> + / / Apply newly compiled code <nl> + serverSideCode ( app ) <nl> + / / wss . on ( ' connection ' , ( ws , req ) = > { <nl> + / / console . log ( ' FIRE ' , req . url ) <nl> + / / ws . send ( ' reload ' ) <nl> + / / } ) <nl> } <nl> - } ) <nl> app . use ( devMiddleWare ) <nl> app . use ( <nl> - require ( ' webpack - hot - middleware ' ) ( compiler , { <nl> + webpackHotMiddleware ( <nl> + compiler . compilers . find ( compiler = > compiler . name = = = ' client ' ) , <nl> + { <nl> log : console . log <nl> - } ) <nl> + } <nl> ) <nl> - <nl> - const mfs = devMiddleWare . fileSystem <nl> - const file = path . join ( webpackConfig . output . path , ' index . html ' ) <nl> - <nl> - devMiddleWare . waitUntilValid ( ) <nl> - <nl> - app . get ( ' * ' , ( req , res ) = > { <nl> - devMiddleWare . waitUntilValid ( ( ) = > { <nl> - const html = mfs . readFileSync ( file ) <nl> - res . end ( html ) <nl> - } ) <nl> - } ) <nl> - <nl> - / / Proxy api requests to BASE_API <nl> - app . use ( config . BASE_API , function ( req , res ) { <nl> - / * * <nl> - * / / req . baseUrl - The URL path on which a router instance was mounted . <nl> - * { @ link https : / / expressjs . com / ru / 4x / api . html # req . baseUrl } <nl> - * / <nl> - req . url = req . baseUrl + req . url <nl> - apiProxy . web ( req , res , { <nl> - target : { <nl> - port : 4000 , <nl> - host : ' localhost ' <nl> + ) <nl> + webpackHotFullStack ( { compiler , done } ) <nl> } <nl> - } ) <nl> - } ) <nl> - <nl> - app . listen ( port ) <nl> - <nl> - open ( ` http : / / localhost : $ { port } ` ) <nl> 
mmm a / src / common / actions / auth / index . test . js <nl> ppp b / src / common / actions / auth / index . test . js <nl> * @ arg { Function } done - is a callback that you need to execute , <nl> * If your action performing async task ( e . g . request to API ) <nl> * / <nl> - it ( ' creates LOGIN_AUTH_SUCCESS when LOGIN_AUTH was successful ' , done = > { <nl> + test ( ' creates LOGIN_AUTH_SUCCESS when LOGIN_AUTH was successful ' , function ( done ) { <nl> / / Create expected output of your action <nl> const expectedActions = { <nl> type : actions . LOGIN_AUTH_SUCCESS , <nl> @ @ - 26 , 12 + 26 , 45 @ @ describe ( ' Auth actions ' , ( ) = > { <nl> } <nl> / / Create store for testing <nl> const store = mockStore ( { } ) <nl> + / / try { <nl> / / Dispatch action <nl> - return store . dispatch ( actions . LOGIN_AUTH ) . then ( res = > { <nl> + store <nl> + . dispatch ( actions . LOGIN_AUTH ) <nl> + . then ( res = > { <nl> + / / That means that there is no server that can respond to the request <nl> + / / NOTE : <nl> + if ( ! res . errors ) { <nl> + console . error ( ` There is no server that can respond to the ' / auth ' request ! ` ) <nl> + expect ( true ) . toEqual ( true ) <nl> + return done ( ) <nl> + } <nl> / / Compare expected and real outputs <nl> expect ( res ) . toEqual ( expectedActions ) <nl> / / Call ` done ( ) ` callback , because action is async <nl> done ( ) <nl> } ) <nl> } ) <nl> + <nl> + test ( ' creates LOGIN_AUTH_FAIL when LOGIN_AUTH was unsuccessful ' , function ( done ) { <nl> + / / Create expected output of your action <nl> + const expectedActions = { <nl> + type : actions . LOGIN_AUTH_FAIL , <nl> + result : { <nl> + errors : { } <nl> + } <nl> + } <nl> + / / Create store for testing <nl> + const store = mockStore ( { } ) <nl> + / / try { <nl> + / / Dispatch action <nl> + store <nl> + . dispatch ( actions . LOGIN_AUTH ) <nl> + . then ( res = > { <nl> + <nl> + / / Compare expected and real outputs <nl> + expect ( res . type ) . toEqual ( expectedActions . type ) <nl> + / / Call ` done ( ) ` callback , because action is async <nl> + done ( ) <nl> + } ) <nl> + } ) <nl> } ) <nl> 
mmm a / webpack_config / client / webpack . dev . babel . js <nl> ppp b / webpack_config / client / webpack . dev . babel . js <nl> import webpack from ' webpack ' <nl> - import HtmlWebpackPlugin from ' html - webpack - plugin ' <nl> import baseWebpackConfig from ' . / webpack . base ' <nl> - import FriendlyErrors from ' friendly - errors - webpack - plugin ' <nl> + import WriteFilePlugin from ' write - file - webpack - plugin ' <nl> + / / import AutoDllPlugin from ' autodll - webpack - plugin ' <nl> import config from ' . . / config ' <nl> import _ from ' lodash ' <nl> @ @ - 19 , 7 + 19 , 6 @ @ const loaders = { <nl> sass : { loader : ' sass - loader ' , options : { sourceMap : true } } <nl> } <nl> - baseWebpackConfig . devtool = ' eval - source - map ' <nl> baseWebpackConfig . module . rules . push ( <nl> { <nl> test : / \ . css $ / , <nl> @ @ - 37 , 16 + 36 , 16 @ @ baseWebpackConfig . module . rules . push ( <nl> } <nl> ) <nl> + baseWebpackConfig . entry . client = [ <nl> + ' react - hot - loader / patch ' , <nl> + ' webpack - hot - middleware / client ? reload = true ' , <nl> + baseWebpackConfig . entry . client <nl> + ] <nl> + <nl> / / add dev plugins <nl> baseWebpackConfig . plugins . push ( <nl> - / / add index . html <nl> - new HtmlWebpackPlugin ( { <nl> - title : config . title , <nl> - template : path . resolve ( config . rootPath , ' webpack_config ' , ' assets ' , ' index . ejs ' ) <nl> - } ) , <nl> new webpack . HotModuleReplacementPlugin ( ) , <nl> - new webpack . NoEmitOnErrorsPlugin ( ) , <nl> - new FriendlyErrors ( ) <nl> + new WriteFilePlugin ( ) <nl> ) <nl> export default baseWebpackConfig <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> let { <nl> BASE_API , <nl> - APP_LANGUAGE , <nl> NODE_ENV , <nl> SENTRY_DSN_PUBLIC , <nl> GA_ID , <nl> JWT_SECRET , <nl> - DIST_PATH , <nl> + CLIENT_DIST_PATH , <nl> SENTRY_DSN , <nl> PORT <nl> } = process . env <nl> / / Vars for both server and frontend <nl> BASE_API = BASE_API | | ' / api / v1 ' <nl> - APP_LANGUAGE = APP_LANGUAGE | | ' en ' <nl> NODE_ENV = NODE_ENV | | ' development ' <nl> / / Vars for frontend only <nl> @ @ - 32 , 22 + 30 , 25 @ @ const srcPath = path . join ( rootPath , ' . / src ' ) / / = " / src " <nl> const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> / / Vars for server only <nl> - DIST_PATH = DIST_PATH | | path . join ( distPath , ' . / client ' , APP_LANGUAGE ) <nl> + CLIENT_DIST_PATH = CLIENT_DIST_PATH | | path . join ( distPath , ' . / client ' ) <nl> JWT_SECRET = JWT_SECRET | | ' secret ' <nl> PORT = PORT | | 4000 <nl> + / / compute isProduction based on NODE_ENV <nl> + const isProduction = process . env . NODE_ENV = = = ' production ' <nl> + <nl> export default { <nl> title : ' React - Semantic . UI - Starter ' , <nl> publicPath : ' / ' , <nl> / / i18n object <nl> i18n , <nl> + isProduction , <nl> / / Env vars <nl> BASE_API , <nl> - APP_LANGUAGE , <nl> NODE_ENV , <nl> SENTRY_DSN_PUBLIC , <nl> GA_ID , <nl> - DIST_PATH , <nl> + CLIENT_DIST_PATH , <nl> JWT_SECRET , <nl> SENTRY_DSN , <nl> PORT , <nl> 
mmm a / webpack_config / server . js <nl> ppp b / webpack_config / server . js <nl> + / * * <nl> + * @ file <nl> + * / <nl> import path from ' path ' <nl> import express from ' express ' <nl> import webpack from ' webpack ' <nl> import webpackDevMiddleware from ' webpack - dev - middleware ' <nl> import webpackHotMiddleware from ' webpack - hot - middleware ' <nl> - import webpackHotFullStack from ' webpack - hot - fullstack - middleware ' <nl> + import webpackHotFullStack from ' webpack - get - code - on - done ' <nl> import WriteFilePlugin from ' write - file - webpack - plugin ' <nl> + import config from ' . / config ' <nl> import client from ' . / client / webpack . dev . babel ' <nl> import server from ' . / server / webpack . dev . babel ' <nl> / / Webpack plugins <nl> @ @ - 17 , 7 + 20 , 7 @ @ const webpackConfig = [ client , server ] <nl> const compiler = webpack ( webpackConfig ) <nl> / / Apply some commonly used plugins <nl> compiler . apply ( new FriendlyErrors ( ) ) <nl> - compiler . apply ( new LogPlugin ( ) ) <nl> + compiler . apply ( new LogPlugin ( config . PORT ) ) <nl> compiler . apply ( new webpack . NoEmitOnErrorsPlugin ( ) ) <nl> / / Create devMiddleWare <nl> const devMiddleWare = webpackDevMiddleware ( compiler , { <nl> @ @ - 33 , 11 + 36 , 10 @ @ const devMiddleWare = webpackDevMiddleware ( compiler , { <nl> / / Number of middlewares that our app should has <nl> let prevSize = null <nl> / * * <nl> - * @ desc Adds dev middlewares + your code to the instance of express server <nl> - * @ param { Function } app - Express dev server to which compiled code will be applied <nl> - * @ param { Function } wss - WebSocket server , allow you send event to client to re - render the page <nl> + * @ desc Adds dev middlewares + your code to an express server instance <nl> + * @ param { ExpressServer } app - Express dev server to which compiled code will be applied <nl> * / <nl> - export default function ( app , wss ) { <nl> + export default function ( app ) { <nl> / * * <nl> * @ desc Function that executes after your server - side code compiles <nl> * @ param { Function } serverSideCode - compiled server - side code <nl> @ @ - 53 , 10 + 55 , 6 @ @ export default function ( app , wss ) { <nl> } <nl> / / Apply newly compiled code <nl> serverSideCode ( app ) <nl> - / / wss . on ( ' connection ' , ( ws , req ) = > { <nl> - / / console . log ( ' FIRE ' , req . url ) <nl> - / / ws . send ( ' reload ' ) <nl> - / / } ) <nl> } <nl> app . use ( devMiddleWare ) <nl> @ @ - 68 , 5 + 66 , 6 @ @ export default function ( app , wss ) { <nl> } <nl> ) <nl> ) <nl> - webpackHotFullStack ( { compiler , done } ) <nl> + const serverCompiler = compiler . compilers . find ( compiler = > compiler . name = = = ' server ' ) <nl> + webpackHotFullStack ( serverCompiler , done ) <nl> } <nl> 
mmm a / src / common / api / utils / xhr_wrapper . js <nl> ppp b / src / common / api / utils / xhr_wrapper . js <nl> - export default function requestWrapper ( method ) { <nl> - return async function ( url , data = null , params = { } ) { <nl> - if ( method = = = ' GET ' ) { <nl> - / / It ' s a GET response <nl> - / / GET doesn ' t have data <nl> - params = data <nl> - data = null <nl> - } else if ( data = = = Object ( data ) ) { <nl> - / / ( data = = = Object ( data ) ) = = = _ . isObject ( data ) <nl> - data = JSON . stringify ( data ) <nl> - } else { <nl> - throw new Error ( ` XHR invalid , check $ { method } on $ { url } ` ) <nl> + / * * <nl> + * Create request wrapper for certain method <nl> + * @ param { String } method - Request method <nl> + * @ return { Function } <nl> + * / <nl> + export default function ( method ) { <nl> + / * * <nl> + * Creates request to ` url ` with ` data ` <nl> + * @ param { String } url Request URL <nl> + * @ param { Object } [ data = null ] Data for Request <nl> + * @ return { Object } Request response <nl> + * / <nl> + return async ( url , data = null ) = > { <nl> + / / get decorated url and request params <nl> + const { URL , request } = decorateRequest ( { method , url , data } ) <nl> + / / create request ! <nl> + return fetch ( URL , request ) . then ( checkStatus ) . then ( parseJSON ) . catch ( err = > { <nl> + console . error ( err ) <nl> + return err <nl> + } ) <nl> } <nl> - <nl> + } <nl> + / * * <nl> + * Create <nl> + * @ param { String } method - Request method <nl> + * @ param { String } url - Request URL <nl> + * @ param { Object } [ data = null ] - Data for Request <nl> + * @ return { Object } - Decorated request params <nl> + * / <nl> + function decorateRequest ( { method , url , data } ) { <nl> / / Default params for fetch = method + ( Content - Type ) <nl> const defaults = { <nl> method , <nl> @ @ - 25 , 41 + 41 , 44 @ @ export default function requestWrapper ( method ) { <nl> ' Content - Type ' : ' application / json ; charset = UTF - 8 ' <nl> } <nl> } <nl> - <nl> - / / Check that req url is relative and request was sent to our domain <nl> - if ( ! / ( http | https ) : \ / \ / / . test ( url ) ) { <nl> - console . log ( ` Request $ { url } was sent to our domain ` ) <nl> const token = getLocalToken ( ) <nl> - if ( token ) { <nl> - defaults . headers . Authorization = ` JWT $ { token } ` <nl> - } <nl> - url = process . env . BASE_API + url <nl> - } else { <nl> - console . log ( ` Request $ { url } was sent to external domain ` ) <nl> - / / Request was set to an external domain <nl> - } <nl> + const isRequestToExternalResource = / ( http | https ) : \ / \ / / . test ( url ) <nl> + const URL = isRequestToExternalResource ? url : process . env . BASE_API + url <nl> + <nl> + const requestAuthDecoration = <nl> + ! isRequestToExternalResource & & token <nl> + ? { headers : { Authorization : ` JWT $ { getLocalToken ( ) } ` } } <nl> + : { } <nl> - if ( data ) { <nl> - defaults . body = data <nl> + const requesDataDecoration = data ? { body : JSON . stringify ( data ) } : { } <nl> + const request = Object . assign ( <nl> + { } , <nl> + defaults , <nl> + requestAuthDecoration , <nl> + requesDataDecoration <nl> + ) <nl> + <nl> + if ( ! isRequestToExternalResource ) { <nl> + console . log ( ` Request $ { url } was sent to our domain ` , request ) <nl> + } else { <nl> + console . log ( ` Request $ { url } was sent to external domain ` , request ) <nl> } <nl> - const paramsObj = Object . assign ( { } , defaults , { headers : params } ) <nl> - return fetch ( url , paramsObj ) <nl> - . then ( checkStatus ) <nl> - . then ( parseJSON ) <nl> - . catch ( err = > { <nl> - console . error ( err ) <nl> - return err <nl> - } ) <nl> + return { <nl> + request , <nl> + URL <nl> } <nl> } <nl> - / / Checks response status in production env <nl> + / * * <nl> + * Checks response status <nl> + * @ param { Object } response - Response <nl> + * @ return { Object } - Response <nl> + * / <nl> function checkStatus ( response ) { <nl> const { status } = response <nl> if ( status > = 200 & & status < 300 ) { <nl> / / Everything is ok <nl> - return response <nl> } else if ( status > = 300 & & status < 400 ) { <nl> / / 300 Multiple Choices <nl> / / 301 - Moved Permanently , <nl> @ @ - 68 , 7 + 87 , 6 @ @ function checkStatus ( response ) { <nl> / / 307 - Temporary Redirect <nl> } else if ( status = = = 400 ) { <nl> / / Probably is a validation error <nl> - return response <nl> } else if ( status = = = 403 | | status = = = 401 ) { <nl> / / 401 - Forbidden <nl> / / 403 - Unauthorized <nl> @ @ - 76 , 19 + 94 , 18 @ @ function checkStatus ( response ) { <nl> resetLocalToken ( ) <nl> } else if ( status = = = 404 ) { <nl> / / Not Found <nl> - return response <nl> } else if ( status > = 500 ) { <nl> / / Server error <nl> - return response <nl> } <nl> + return response <nl> } <nl> / * * <nl> - / / middlewares <nl> + * middlewares <nl> * 1 . parse response <nl> * 2 . add " ok " property to result <nl> * 3 . return request result <nl> - * @ param { Object } res - response from server <nl> + * @ param { Object } res - Response from resource <nl> * @ return { Object } response result with " ok " property <nl> * / <nl> async function parseJSON ( res ) { <nl> @ @ - 99 , 7 + 116 , 7 @ @ async function parseJSON ( res ) { <nl> return { data : { } , ok : false } <nl> } <nl> - / / Simplest validation ever , ahah : ) <nl> + / / Simplest validation ever <nl> if ( ! res . ok ) { <nl> return { data : json , ok : false } <nl> } <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> " plugins " : [ <nl> - " lodash " , <nl> + [ " lodash " , { " id " : [ " lodash " , " semantic - ui - react " ] } ] , <nl> [ <nl> " transform - runtime " , <nl> { <nl> " moduleName " : " babel - runtime " <nl> } <nl> ] , <nl> - " transform - decorators - legacy " , <nl> " syntax - dynamic - import " <nl> ] , <nl> - " presets " : [ " es2015 " , " react " , " stage - 0 " ] , <nl> + " presets " : [ " es2015 " , " react " , " stage - 0 " , " flow " ] , <nl> " env " : { <nl> " production " : { <nl> " presets " : [ " react - optimize " ] <nl> } , <nl> " development " : { <nl> - " plugins " : [ <nl> - " react - hot - loader / babel " <nl> - ] <nl> + " plugins " : [ " react - hot - loader / babel " ] <nl> } , <nl> " test " : { <nl> " plugins " : [ <nl> 
mmm a / . eslintrc . json <nl> ppp b / . eslintrc . json <nl> " extends " : [ <nl> + " plugin : flowtype / recommended " , <nl> " plugin : react / recommended " , <nl> " plugin : jsx - a11y / recommended " , <nl> " standard " <nl> ] , <nl> " parser " : " babel - eslint " , <nl> - " plugins " : [ " react " , " babel " , " jsx - a11y " ] , <nl> + " plugins " : [ " react " , " babel " , " jsx - a11y " , " flowtype " ] , <nl> " parserOptions " : { <nl> " ecmaFeatures " : { <nl> " jsx " : true , <nl> " i18n " : true , <nl> " Raven " : true , <nl> " ga " : true <nl> + } , <nl> + " settings " : { <nl> + " flowtype " : { <nl> + " onlyFilesWithFlowAnnotation " : false <nl> + } <nl> } <nl> } <nl> 
mmm a / src / client / index . jsx <nl> ppp b / src / client / index . jsx <nl> import ' semantic - ui - css / semantic . css ' <nl> - import ' styles / global ' <nl> / / Fetch and promise polyfill <nl> import ' promise - polyfill ' <nl> - import ' whatwg - fetch ' <nl> + import ' isomorphic - fetch ' <nl> / / Application <nl> - import { render } from ' react - dom ' <nl> - import { configureStore , configureRootComponent } from ' common / index . jsx ' <nl> + import React from ' react ' <nl> + import ReactDOM , { render } from ' react - dom ' <nl> + import { configureApp , configureRootComponent } from ' common / app ' <nl> if ( process . env . NODE_ENV = = = ' production ' ) { <nl> require ( ' common / pwa ' ) <nl> @ @ - 29 , 13 + 29 , 21 @ @ if ( process . env . NODE_ENV = = = ' production ' ) { <nl> * / <nl> / * eslint - enable * / <nl> window . Perf = require ( ' react - addons - perf ' ) <nl> - } <nl> - const preloadedState = window . __PRELOADED_STATE__ | | { } <nl> - delete window . __PRELOADED_STATE__ <nl> + / / NOTE : a11y doesnt work with SSR and React throws warnings like : <nl> + / / " React attempted to reuse markup in a container but the checksum was invalid " <nl> + / / a11y adds " id " attribute to the root container ( # app ) of your app and triggers re - rendering <nl> + / / <nl> + / * * { @ link https : / / github . com / reactjs / react - a11y } * / <nl> + / / const a11y = require ( ' react - a11y ' ) <nl> + / / a11y ( React , { ReactDOM } ) <nl> + } <nl> - const store = configureStore ( preloadedState ) <nl> - const RootComponent = configureRootComponent ( { store } ) <nl> + const initialState = window . __INITIAL_STATE__ | | { } <nl> + / / NOTE : V8 doesn ' t optimize ` delete ` <nl> + / / delete window . __INITIAL_STATE__ <nl> + const propsForRoot = configureApp ( { initialState } ) <nl> + const RootComponent = configureRootComponent ( propsForRoot ) <nl> render ( RootComponent , document . getElementById ( ' app ' ) ) <nl> if ( module . hot ) { <nl> 
mmm a / src / common / containers / Users / index . jsx <nl> ppp b / src / common / containers / Users / index . jsx <nl> + * @ flow <nl> + * / <nl> import React , { Component } from ' react ' <nl> import { connect } from ' react - redux ' <nl> import PropTypes from ' prop - types ' <nl> @ @ - 6 , 16 + 9 , 18 @ @ import { Loader } from ' semantic - ui - react ' <nl> import { GET_USERS } from ' actions / users ' <nl> import UsersComponent from ' . / components ' <nl> - class Users extends Component { <nl> - static propTypes = { <nl> - users : PropTypes . object . isRequired , <nl> - getUsers : PropTypes . func . isRequired , <nl> - isUsersLoaded : PropTypes . bool . isRequired , <nl> - isUsersLoading : PropTypes . bool . isRequired , <nl> - usersCount : PropTypes . number . isRequired <nl> - } <nl> + type DefaultProps = any <nl> + type Props = { <nl> + users : any , <nl> + getUsers : ( ) = > void , <nl> + isUsersLoaded : boolean , <nl> + isUsersLoading : boolean , <nl> + usersCount : number <nl> + } <nl> + type State = any <nl> - componentWillMount ( ) { <nl> + class Users extends Component < DefaultProps , Props , State > { <nl> + componentDidMount ( ) { <nl> this . props . getUsers ( ) <nl> } <nl> 
mmm a / src / common / components / addons / RoutingWrapper / index . jsx <nl> ppp b / src / common / components / addons / RoutingWrapper / index . jsx <nl> + / * * <nl> + * @ flow <nl> + * / <nl> + import * as React from ' react ' <nl> import PropTypes from ' prop - types ' <nl> import { Switch , Redirect } from ' react - router - dom ' <nl> + import type { RouteItem } from ' routing ' <nl> import LazyLoad from ' components / addons / LazyLoad ' <nl> + type DefaultProps = any <nl> + type Props = { <nl> + routes : RouteItem [ ] , <nl> + store : Object <nl> + } <nl> + <nl> / * * <nl> * Returns application routing with protected by AuthCheck func routes <nl> * @ desc This function returns JSX , so we can think about it as " stateless component " <nl> * @ param { Function } authCheck checks is user logged in <nl> * / <nl> - export default class RoutingWrapper extends Component { <nl> - static propTypes = { <nl> - routes : PropTypes . array , <nl> - store : PropTypes . object <nl> - } <nl> - <nl> + export default class RoutingWrapper extends React . Component < DefaultProps , Props > { <nl> / * * <nl> * Checks Auth logic . Is user allowed to visit certain path ? <nl> * @ param { String } path next path to visit <nl> * @ return { Bool } is user allowed to visit next location ? <nl> * check RouteAuth component . <nl> * / <nl> - authCheck ( path ) { <nl> + authCheck ( path : string ) : boolean { <nl> const { store } = this . props <nl> const { isLoggedIn } = store . getState ( ) . me . auth <nl> const authPath = ' / auth ' <nl> 
mmm a / src / common / components / addons / RouteAuth / index . jsx <nl> ppp b / src / common / components / addons / RouteAuth / index . jsx <nl> - import PropTypes from ' prop - types ' <nl> + / * * <nl> + * @ flow <nl> + * / <nl> + import * as React from ' react ' <nl> import { Route , Redirect } from ' react - router - dom ' <nl> / * * <nl> * Component that protects route from unauthorized users . <nl> * / <nl> - class RouteAuth extends Component { <nl> - static propTypes = { <nl> - canAccess : PropTypes . func , <nl> - path : PropTypes . string <nl> - } <nl> - render ( ) { <nl> - const { canAccess , path } = this . props <nl> - <nl> - console . log ( <nl> - ` User has access to " $ { path } " path : $ { canAccess ( path ) ? ' YES ' : ' NO ' } ` <nl> - ) <nl> - <nl> - return canAccess ( path ) ? < Route { . . . this . props } / > : < Redirect to = " / auth " / > <nl> + type Props = { <nl> + canAccess : ( string ) = > boolean , <nl> + path : string <nl> } <nl> + <nl> + const RouteAuth = ( props : Props ) = > { <nl> + const { canAccess , path } = props <nl> + return canAccess ( path ) ? < Route { . . . props } / > : < Redirect to = " / auth " / > <nl> } <nl> export default RouteAuth <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> + * @ flow <nl> + * / <nl> + import * as React from ' react ' <nl> import { Route } from ' react - router - dom ' <nl> import { Users , Dashboard , Login } from ' containers ' <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> @ @ - 18 , 6 + 22 , 17 @ @ const loadLazyComponent = url = > { <nl> } <nl> } <nl> + export type RouteItem = { <nl> + path : string , <nl> + exact ? : boolean , <nl> + strict ? : boolean , <nl> + icon ? : string , <nl> + name ? : string , <nl> + sidebarVisible ? : boolean , <nl> + tag ? : React . Node , <nl> + component ? : React . Node <nl> + } <nl> + <nl> export const routes = [ <nl> { <nl> path : ' / ' , <nl> 
mmm a / src / server / index . js <nl> ppp b / src / server / index . js <nl> - global . fetch = require ( ' node - fetch ' ) <nl> + / * * <nl> + * @ flow <nl> + * @ file <nl> + * / <nl> + import express from ' express ' <nl> + import chalk from ' chalk ' <nl> + / / import serverDecorator from ' . / server ' <nl> + const app : any = express ( ) <nl> + const PORT : number = process . env . PORT | | 3000 <nl> + const serverModulePath = <nl> + process . env . NODE_ENV = = = ' production ' <nl> + ? ' . / server ' / / Decorate server with all middlewares / routes for production <nl> + : ' . . / . . / webpack_config / server ' / / Mount our server - side code to dev server <nl> - / / Import app <nl> - require ( ' . / server ' ) <nl> + const createServer : Function = require ( serverModulePath ) . default <nl> + createServer ( app ) <nl> + <nl> + / / Start server <nl> + app . listen ( PORT , ( ) = > { <nl> + console . log ( chalk . green ( ` SERVER IS LISTENING ON $ { PORT } ` ) ) <nl> + } ) <nl> 
mmm a / src / server / server . js <nl> ppp b / src / server / server . js <nl> + / * <nl> + * @ flow <nl> + * / <nl> + import addMiddlewares from ' . / middlewares ' <nl> import API from ' . / api ' <nl> - import useSSR from ' . / ssr ' <nl> - import chalk from ' chalk ' <nl> + import SSR from ' . / ssr ' <nl> + import fetch from ' isomorphic - fetch ' <nl> - const { BASE_API , PORT } = process . env <nl> - / / Add API route <nl> - app . use ( BASE_API , API ) <nl> - / / Add SSR handler <nl> - app . use ( useSSR ) <nl> - / / Start server <nl> - app . listen ( PORT , ( ) = > { <nl> - console . log ( chalk . magenta ( ` \ nServer is running on $ { PORT } port ! \ n ` ) ) <nl> - } ) <nl> + global . fetch = fetch <nl> + <nl> + / * * <nl> + * Mount API , SSR and middlewares to app . <nl> + * @ param { Object } app - Express server instance <nl> + * @ return { Object } - Decorated server instance <nl> + * / <nl> + export default ( app : Object ) : Object = > { <nl> + / / Add global middlewares <nl> + addMiddlewares ( app ) <nl> + / / Add API <nl> + app . use ( ' / api / v1 ' , API ) <nl> + / / Add SSR <nl> + app . use ( SSR ) <nl> + return app <nl> + } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " promise - polyfill " : " 6 . 0 . 2 " , <nl> " prop - types " : " ^ 15 . 5 . 10 " , <nl> + " query - string " : " ^ 5 . 0 . 0 " , <nl> " rapscallion " : " ^ 2 . 1 . 13 " , <nl> " react " : " ^ 15 . 6 . 1 " , <nl> " react - dom " : " ^ 15 . 6 . 1 " , <nl> " babel - plugin - lodash " : " ^ 3 . 2 . 11 " , <nl> " babel - plugin - module - resolver " : " ^ 2 . 7 . 1 " , <nl> " babel - plugin - syntax - dynamic - import " : " ^ 6 . 18 . 0 " , <nl> - " babel - plugin - transform - decorators - legacy " : " ^ 1 . 3 . 4 " , <nl> " babel - plugin - transform - react - jsx " : " ^ 6 . 24 . 1 " , <nl> " babel - plugin - transform - regenerator " : " ^ 6 . 24 . 1 " , <nl> " babel - plugin - transform - runtime " : " ^ 6 . 23 . 0 " , <nl> " circular - dependency - plugin " : " ^ 3 . 0 . 0 " , <nl> " commitizen " : " ^ 2 . 9 . 6 " , <nl> " compression - webpack - plugin " : " ^ 1 . 0 . 0 " , <nl> - " concurrently " : " ^ 3 . 5 . 0 " , <nl> " css - loader " : " ^ 0 . 28 . 4 " , <nl> " enzyme " : " ^ 2 . 9 . 1 " , <nl> " eslint " : " ^ 4 . 4 . 1 " , <nl> " node - sass " : " ^ 4 . 5 . 3 " , <nl> " open " : " 0 . 0 . 5 " , <nl> " optimize - css - assets - webpack - plugin " : " ^ 3 . 0 . 0 " , <nl> + " optimize - js - plugin " : " 0 . 0 . 4 " , <nl> " postcss " : " ^ 6 . 0 . 9 " , <nl> " postcss - browser - reporter " : " ^ 0 . 5 . 0 " , <nl> " postcss - cssnext " : " ^ 3 . 0 . 2 " , <nl> " postcss - loader " : " ^ 2 . 0 . 6 " , <nl> " postcss - reporter " : " ^ 5 . 0 . 0 " , <nl> " preload - webpack - plugin " : " ^ 1 . 2 . 3 " , <nl> + " pug " : " ^ 2 . 0 . 0 - rc . 3 " , <nl> + " pug - loader " : " ^ 2 . 3 . 0 " , <nl> " react - a11y " : " ^ 0 . 3 . 4 " , <nl> " react - addons - perf " : " ^ 15 . 4 . 2 " , <nl> " react - addons - test - utils " : " ^ 15 . 6 . 0 " , <nl> } , <nl> " optionalDependencies " : { <nl> " babili - webpack - plugin " : " ^ 0 . 1 . 2 " , <nl> - " esdoc " : " ^ 1 . 0 . 1 " , <nl> " purify - css " : " ^ 1 . 2 . 5 " , <nl> " purifycss - webpack " : " ^ 0 . 7 . 0 " , <nl> " prepack - webpack - plugin " : " ^ 1 . 1 . 0 " , <nl> " webpack - shell - plugin " : " ^ 0 . 5 . 0 " , <nl> - " git - rev - sync " : " ^ 1 . 9 . 1 " , <nl> - " glob " : " ^ 7 . 1 . 2 " , <nl> - " flow - runtime " : " ^ 0 . 14 . 0 " , <nl> - " babel - plugin - flow - runtime " : " ^ 0 . 11 . 1 " <nl> + " git - rev - sync " : " ^ 1 . 9 . 1 " <nl> } , <nl> " scripts " : { <nl> " build " : " npm run frontend_build & & npm run server_build " , <nl> " frontend_build " : " NODE_ENV = production webpack - - config webpack_config / client / webpack . prod . babel . js " , <nl> " test " : " NODE_ENV = test jest - - config = jest_config / jest . config . json - - coverage - - forceExit | | true " , <nl> " start " : " node . / dist / server / $ { APP_LANGUAGE : = en } " , <nl> - " precommit " : " echo \ " $ ( tput bold ) $ ( tput setaf 5 ) It ' d be better to run tests before commit . $ ( tput sgr 0 ) \ " t " , <nl> - " prepush " : " echo \ " $ ( tput bold ) $ ( tput setaf 5 ) I hope you tested app . $ ( tput sgr 0 ) \ " " , <nl> " lint : styles " : " stylelint . / src / common / * * / * . scss - s scss - - config . / . stylelintrc - - fix " , <nl> " lint : scripts " : " eslint - c . / . eslintrc . json . / src . / webpack_config - - ignore - pattern dist " , <nl> " flow " : " flow " , <nl> " cz " : " git - cz " , <nl> " release " : " standard - version " , <nl> + " precommit " : " echo \ " $ ( tput bold ) $ ( tput setaf 5 ) It ' d be better to run tests before commit . $ ( tput sgr 0 ) \ " t " , <nl> + " prepush " : " echo \ " $ ( tput bold ) $ ( tput setaf 5 ) I hope you tested app . $ ( tput sgr 0 ) \ " " , <nl> " commitmsg " : " validate - commit - msg " <nl> } , <nl> " engines " : { <nl> 
mmm a / src / common / api / utils / normalize . js <nl> ppp b / src / common / api / utils / normalize . js <nl> import { normalize , schema } from ' normalizr ' <nl> import _ from ' lodash ' <nl> @ @ - 11 , 7 + 12 , 7 @ @ import _ from ' lodash ' <nl> / / XXX : normalization is recommended , but not a must <nl> / / you styill can write a bunch of custom code in your reducers to normalize every reqests <nl> - export const normalizeArrayOfItems = array = > { <nl> + export const normalizeArrayOfItems = ( array : Array < any > ) = > { <nl> / / Flat array , if it had 2 levels of depth <nl> const flatArray = _ . flatten ( array ) <nl> / / Create schema for field , e . g field is ` data ` <nl> @ @ - 22 , 6 + 23 , 6 @ @ export const normalizeArrayOfItems = array = > { <nl> const normalizedData = normalize ( flatArray , dataListSchema ) <nl> / / Get ` data ` entities <nl> const entities = normalizedData . entities . data <nl> - const count = normalizedData . result . length <nl> + const count : number = normalizedData . result . length <nl> return { entities , count } <nl> } <nl> 
mmm a / src / common / reducers / index . js <nl> ppp b / src / common / reducers / index . js <nl> import { combineReducers } from ' redux ' <nl> import { routerReducer } from ' react - router - redux ' <nl> + import type { State as AuthState } from ' reducers / auth ' <nl> + import type { State as LayoutState } from ' reducers / layout ' <nl> + import type { State as EntitiesPostsState } from ' reducers / posts ' <nl> + import type { State as EntitiesUsersState } from ' reducers / users ' <nl> + <nl> import { layout } from ' . / layout ' <nl> import { posts } from ' . / posts ' <nl> import { users } from ' . / users ' <nl> @ @ - 16 , 3 + 22 , 7 @ @ export default combineReducers ( { <nl> } ) , <nl> routing : routerReducer <nl> } ) <nl> + <nl> + export type GlobalState = { layout : LayoutState } & { me : { auth : AuthState } } & { <nl> + entities : { posts : EntitiesPostsState , users : EntitiesUsersState } <nl> + } <nl> 
mmm a / webpack_config / webpack . isomorphic . js <nl> ppp b / webpack_config / webpack . isomorphic . js <nl> / / Aliases that both server and client use <nl> / / Probably , it ' s a bad example , because here we defined only client ' s aliases . <nl> alias : { <nl> + i18n : ` $ { srcCommonPath } / i18n / ` , <nl> actions : ` $ { srcCommonPath } / actions / ` , <nl> api : ` $ { srcCommonPath } / api / ` , <nl> components : ` $ { srcCommonPath } / components / ` , <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> extensions : isomorphicWebpackConfig . resolve . extensions , <nl> modules : isomorphicWebpackConfig . resolve . modules , <nl> alias : { <nl> - . . . isomorphicWebpackConfig . resolve . alias <nl> + . . . isomorphicWebpackConfig . resolve . alias , <nl> + ' webpack - assets ' : ` $ { CLIENT_DIST_PATH } / webpack - assets . json ` , <nl> + ' favicons - assets ' : ` $ { CLIENT_DIST_PATH } / favicons - stats . json ` <nl> / / create_server : createServerAliasPath <nl> } <nl> } , <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> * @ desc <nl> * / <nl> - import * as React from ' react ' <nl> + import React , { type Node } from ' react ' <nl> import fs from ' fs ' <nl> import { renderToString } from ' react - dom / server ' <nl> import Helmet from ' react - helmet ' <nl> import createHistory from ' history / createMemoryHistory ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureApp , configureRootComponent } from ' common / app ' <nl> - <nl> - const DLLScripts = <nl> - process . env . NODE_ENV = = = ' production ' <nl> - ? ' ' <nl> - : ` <nl> - < script src = " / polyfills . js " > < / script > <nl> - < script src = " / vendor . js " > < / script > <nl> - ` <nl> - / / This function makes server rendering of asset references consistent with different webpack chunk / entry confiugrations <nl> - function normalizeAssets ( assets ) { <nl> - return Array . isArray ( assets ) ? assets : [ assets ] <nl> - } <nl> + import IndexHTMLComponent from ' . / IndexHTMLComponent ' <nl> + import assets from ' webpack - assets ' <nl> + import faviconsAssets from ' favicons - assets ' <nl> export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> - const stats = fs . readFileSync ( <nl> - ` $ { process . env . CLIENT_DIST_PATH } / stats . json ` , <nl> - ' utf8 ' <nl> - ) <nl> const { isLoggedIn , token } = req . user <nl> const initialState : Object = isLoggedIn <nl> ? { me : { auth : { isLoggedIn , token } } } <nl> @ @ - 34 , 74 + 21 , 27 @ @ export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> const sheet = new ServerStyleSheet ( ) <nl> const location : string = req . url <nl> const context = { } <nl> - const { store , history , routes } = configureApp ( { initialState } ) <nl> - const RootComponent : React . Node = configureRootComponent ( { <nl> + const { store , history , routes } = configureApp ( initialState ) <nl> + const RootComponent : Node = configureRootComponent ( { <nl> store , <nl> history , <nl> routes , <nl> SSR : { location , context } <nl> } ) <nl> - const App : React . Node = ( <nl> + const App : Node = ( <nl> < StyleSheetManager sheet = { sheet . instance } > <nl> { RootComponent } <nl> < / StyleSheetManager > <nl> ) <nl> const css = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> - console . log ( preloadedState ) <nl> - const app : string = renderToString ( App ) <nl> - const { assetsByChunkName } : Object = JSON . parse ( stats ) <nl> - const html = getHtml ( { <nl> - app , <nl> + const props = { <nl> css , <nl> + assets , <nl> + faviconsAssets , <nl> initialState : preloadedState , <nl> - assetsByChunkName <nl> - } ) <nl> - res . send ( html ) <nl> + App <nl> } <nl> - <nl> - / * * <nl> - * Get html <nl> - * @ param { [ type ] } app [ description ] <nl> - * @ param { [ type ] } css [ description ] <nl> - * @ param { [ type ] } initialState [ description ] <nl> - * @ param { [ type ] } assetsByChunkName [ description ] <nl> - * @ return { String } [ description ] <nl> - * / <nl> - const getHtml = ( { app , css , initialState , assetsByChunkName } ) = > { <nl> - const stringifiedState : string = JSON . stringify ( initialState ) <nl> - const safeStringifiedState : string = stringifiedState . replace ( / < / g , ' \ \ u003c ' ) <nl> - return ` <nl> - < ! doctype html > <nl> - < html > <nl> - < head > <nl> - < meta charset = " utf - 8 " > <nl> - < title > Noir < / title > <nl> - < meta http - equiv = " X - UA - Compatible " content = " IE = edge , chrome = 1 " > <nl> - < meta name = " description " content = " Production - ready , performance - first , template built with React / Redux / React - Semantic - UI " > <nl> - < meta name = " viewport " content = " width = device - width , initial - scale = 1 . 0 " > <nl> - < base href = " / " / > <nl> - < meta name = " theme - color " content = " < % = htmlWebpackPlugin . options . theme_color % > " / > <nl> - < meta name = " msapplication - tap - highlight " content = " no " > <nl> - < link rel = " manifest " href = " manifest . json " > <nl> - $ { css } <nl> - $ { normalizeAssets ( assetsByChunkName . client ) <nl> - . filter ( path = > path . endsWith ( ' . css ' ) ) <nl> - . map ( path = > ` < link rel = " stylesheet " href = " $ { path } " / > ` ) <nl> - . join ( ' \ n ' ) } <nl> - < / head > <nl> - < body > <nl> - < div id = " app " > $ { app } < / div > <nl> - < script > window . __INITIAL_STATE__ = $ { safeStringifiedState } < / script > <nl> - $ { DLLScripts } <nl> - $ { normalizeAssets ( assetsByChunkName . client ) <nl> - . filter ( path = > path . endsWith ( ' . js ' ) ) <nl> - . map ( path = > ` < script src = " $ { path } " > < / script > ` ) <nl> - . join ( ' \ n ' ) } <nl> - < noscript > <nl> - You are using outdated browser . You can install modern browser here : < a href = " http : / / outdatedbrowser . com / " > http : / / outdatedbrowser . com < / a > . <nl> - < / noscript > <nl> - < / body > <nl> - < / html > <nl> - ` <nl> + const html : string = renderToString ( < IndexHTMLComponent { . . . props } / > ) <nl> + res . send ( html ) <nl> } <nl> 
mmm a / webpack_config / client / webpack . base . js <nl> ppp b / webpack_config / client / webpack . base . js <nl> import webpack from ' webpack ' <nl> import config from ' . . / config ' <nl> import isomorphicWebpackConfig from ' . . / webpack . isomorphic ' <nl> - import { StatsWriterPlugin } from ' webpack - stats - plugin ' <nl> / / import ManifestPlugin from ' webpack - manifest - plugin ' <nl> + import AssetsPlugin from ' assets - webpack - plugin ' <nl> + import FaviconsWebpackPlugin from ' favicons - webpack - plugin ' <nl> import WebpackAssetsManifest from ' webpack - assets - manifest ' <nl> - <nl> const { <nl> GA_ID , <nl> SENTRY_PUBLIC_DSN , <nl> + CLIENT_DIST_PATH , <nl> NODE_ENV , <nl> srcPath , <nl> distPath , <nl> publicPath , <nl> - isProduction <nl> + isProduction , <nl> + title , <nl> + manifest <nl> } = config <nl> const exec = childProcess . execSync <nl> - exec ( ` rm - rf $ { config . distPath } / client ` ) <nl> + exec ( ` rm - rf $ { CLIENT_DIST_PATH } ` ) <nl> const definePluginArgs = { <nl> ' process . env . GA_ID ' : JSON . stringify ( GA_ID ) , <nl> @ @ - 40 , 7 + 43 , 7 @ @ const baseBuild = { <nl> output : { <nl> filename , <nl> publicPath , <nl> - path : path . join ( distPath , ' . / client ' ) , <nl> + path : CLIENT_DIST_PATH , <nl> chunkFilename : ' [ name ] . [ chunkhash : 6 ] . js ' , <nl> crossOriginLoading : ' anonymous ' <nl> } , <nl> @ @ - 95 , 10 + 98 , 42 @ @ const baseBuild = { <nl> } , <nl> plugins : isomorphicWebpackConfig . plugins . concat ( [ <nl> new webpack . DefinePlugin ( definePluginArgs ) , <nl> - new StatsWriterPlugin ( { <nl> - filename : ' stats . json ' / / Default <nl> + new AssetsPlugin ( { <nl> + path : CLIENT_DIST_PATH <nl> + } ) , <nl> + / / NOTE : this plugin is good , but there are few big issues : <nl> + / / 1 . It sets invalid url to browserconfig . xml and manifest . json in index . html . <nl> + / / E . g : in generated index . html you can see : <nl> + / / < meta name = " msapplication - config " content = " browserconfig . xml " > <nl> + / / 2 . It looks like generated images aren ' t minified . ( not sure ) <nl> + / / NOTE : It would be better to generate favicons without this plugin . <nl> + new FaviconsWebpackPlugin ( { <nl> + / / add theme - color property <nl> + background : manifest . theme , <nl> + prefix : ` favicons / ` , <nl> + logo : path . resolve ( config . rootPath , ' . / static / images / logo . png ' ) , <nl> + title , <nl> + emitStats : true , <nl> + statsFilename : ' favicons - stats . json ' , <nl> + / / Inject the html into the html - webpack - plugin <nl> + inject : false , <nl> + / / which icons should be generated ( see https : / / github . com / haydenbleasel / favicons # usage ) <nl> + icons : { <nl> + android : true , <nl> + appleIcon : true , <nl> + appleStartup : true , <nl> + coast : false , <nl> + favicons : true , <nl> + firefox : true , <nl> + opengraph : false , <nl> + twitter : true , <nl> + yandex : false , <nl> + windows : true <nl> + } <nl> } ) , <nl> - new WebpackAssetsManifest ( { writeToDisk : true } ) <nl> + new WebpackAssetsManifest ( { <nl> + assets : config . manifest <nl> + } ) <nl> ] ) , <nl> target : ' web ' <nl> } <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> import ExtractTextPlugin from ' extract - text - webpack - plugin ' <nl> - import HtmlWebpackPlugin from ' html - webpack - plugin ' <nl> - import SriPlugin from ' webpack - subresource - integrity ' <nl> import CompressionPlugin from ' compression - webpack - plugin ' <nl> import OptimizeCssAssetsPlugin from ' optimize - css - assets - webpack - plugin ' <nl> - / / import BabiliPlugin = require ( ' babili - webpack - plugin ' <nl> import AutoDllPlugin from ' autodll - webpack - plugin ' <nl> import ProgressPlugin from ' webpack / lib / ProgressPlugin ' <nl> import OfflinePlugin from ' offline - plugin ' <nl> - import PreloadWebpackPlugin from ' preload - webpack - plugin ' <nl> - import FaviconsWebpackPlugin from ' favicons - webpack - plugin ' <nl> import UglifyJSPlugin from ' uglifyjs - webpack - plugin ' <nl> import { Plugin as ShakePlugin } from ' webpack - common - shake ' <nl> import OptimizeJsPlugin from ' optimize - js - plugin ' <nl> @ @ - 21 , 15 + 16 , 13 @ @ import path from ' path ' <nl> import { BundleAnalyzerPlugin } from ' webpack - bundle - analyzer ' <nl> import base from ' . / webpack . base ' <nl> import config from ' . . / config ' <nl> - / / <nl> - const { ANALYZE_BUNDLE } = config <nl> / / NOTE : you can track versions with gitHash and store your build <nl> / / in dist folder with path like : / dist / client / < gitHash > / { yourFilesHere } <nl> / / const gitHash = git . short ( ) <nl> / / Do you want to use bundle analyzer ? <nl> - if ( ANALYZE_BUNDLE ) { <nl> + if ( config . ANALYZE_BUNDLE ) { <nl> base . plugins . push ( new BundleAnalyzerPlugin ( { analyzerMode : ' static ' } ) ) <nl> } <nl> @ @ - 118 , 48 + 111 , 6 @ @ base . plugins . push ( <nl> new webpack . optimize . CommonsChunkPlugin ( { <nl> name : ' manifest ' <nl> } ) , <nl> - / / NOTE : this plugin is good , but there are few big issues : <nl> - / / 1 . It sets invalid url to browserconfig . xml and manifest . json in index . html . <nl> - / / E . g : in generated index . html you can see : <nl> - / / < meta name = " msapplication - config " content = " browserconfig . xml " > <nl> - / / 2 . It looks like generated images aren ' t minified . ( not sure ) <nl> - / / 3 . plugin is deprecated ( at least look like it ' s deprecated ) ! <nl> - / / NOTE : It would be better to generate favicons without this plugin . <nl> - new FaviconsWebpackPlugin ( { <nl> - / / add theme - color property <nl> - background : config . manifest . theme , <nl> - prefix : ` favicons / ` , <nl> - logo : path . resolve ( config . rootPath , ' . / static / images / logo . png ' ) , <nl> - title : config . title , <nl> - / / Inject the html into the html - webpack - plugin <nl> - inject : false , <nl> - / / which icons should be generated ( see https : / / github . com / haydenbleasel / favicons # usage ) <nl> - icons : { <nl> - android : true , <nl> - appleIcon : true , <nl> - appleStartup : true , <nl> - coast : false , <nl> - favicons : true , <nl> - firefox : true , <nl> - opengraph : false , <nl> - twitter : true , <nl> - yandex : false , <nl> - windows : true <nl> - } <nl> - } ) , <nl> - / / <nl> - / / generate < link rel = " preload " > tags for async chunks <nl> - new PreloadWebpackPlugin ( { <nl> - rel : ' preload ' , <nl> - as : ' script ' , <nl> - include : ' asyncChunks ' <nl> - } ) , <nl> - / / https : / / caniuse . com / # feat = subresource - integrity <nl> - / / NOTE : please , read about SRI before using it ! <nl> - new SriPlugin ( { <nl> - hashFuncNames : [ ' sha256 ' , ' sha384 ' ] , <nl> - enabled : true <nl> - } ) , <nl> new CompressionPlugin ( { <nl> algorithm : ' gzip ' <nl> } ) , <nl> 
mmm a / src / common / components / parts / Root / index . jsx <nl> ppp b / src / common / components / parts / Root / index . jsx <nl> import React , { Component } from ' react ' <nl> - import PropTypes from ' prop - types ' <nl> import { Provider } from ' react - redux ' <nl> - import { APPLICATION_INIT } from ' actions ' <nl> + / / import { I18nextProvider } from ' react - i18next ' / / as we build ourself via webpack <nl> + import { APPLICATION_INIT } from ' actions / common ' <nl> import { ThemeProvider } from ' styled - components ' <nl> import theme from ' styles / theme ' <nl> import App from ' containers / App ' <nl> import RoutingWrapper from ' components / addons / RoutingWrapper ' <nl> + import { getWindowInnerWidth } from ' const ' <nl> + import type { RouteItem } from ' types ' <nl> - const Router = <nl> - process . env . BROWSER = = = true <nl> + const Router = process . env . BROWSER <nl> ? require ( ' react - router - redux ' ) . ConnectedRouter <nl> : require ( ' react - router ' ) . StaticRouter <nl> - export default class Root extends Component { <nl> - static propTypes = { <nl> - store : PropTypes . object , <nl> - SSR : PropTypes . object , <nl> - history : PropTypes . object , <nl> - routes : PropTypes . array <nl> + type Props = { <nl> + store : Object , <nl> + SSR : { <nl> + location ? : Object , <nl> + context ? : Object <nl> + } , <nl> + history : any , <nl> + routes : Array < RouteItem > <nl> } <nl> + export default class Root extends Component { <nl> + props : Props <nl> + <nl> static defaultProps = { <nl> SSR : { } <nl> } <nl> componentWillMount ( ) { <nl> const { store } = this . props <nl> - store . dispatch ( { type : APPLICATION_INIT } ) <nl> + const innerWidth : number = getWindowInnerWidth ( window ) <nl> + store . dispatch ( { type : APPLICATION_INIT , payload : { innerWidth } } ) <nl> } <nl> render ( ) { <nl> @ @ - 37 , 6 + 45 , 7 @ @ export default class Root extends Component { <nl> : { location : SSR . location , context : SSR . context } <nl> / / key = { Math . random ( ) } = hack for HMR from https : / / github . com / webpack / webpack - dev - server / issues / 395 <nl> return ( <nl> + / / < I18nextProvider i18n = { { } } > <nl> < Provider store = { store } key = { Math . random ( ) } > <nl> < ThemeProvider theme = { theme } > <nl> < Router { . . . routerProps } key = { Math . random ( ) } > <nl> @ @ - 46 , 6 + 55 , 7 @ @ export default class Root extends Component { <nl> < / Router > <nl> < / ThemeProvider > <nl> < / Provider > <nl> + / / < / I18nextProvider > <nl> ) <nl> } <nl> } <nl> 
mmm a / src / common / components / parts / Root / index . jsx <nl> ppp b / src / common / components / parts / Root / index . jsx <nl> import React , { Component } from ' react ' <nl> import { Provider } from ' react - redux ' <nl> - / / import { I18nextProvider } from ' react - i18next ' / / as we build ourself via webpack <nl> + import { IntlProvider } from ' react - intl ' / / as we build ourself via webpack <nl> import { APPLICATION_INIT } from ' actions / common ' <nl> import { ThemeProvider } from ' styled - components ' <nl> import theme from ' styles / theme ' <nl> @ @ - 39 , 13 + 39 , 13 @ @ export default class Root extends Component { <nl> render ( ) { <nl> const { SSR , store , history , routes } = this . props <nl> - const routerProps = <nl> - process . env . BROWSER = = = true <nl> + const routerProps = process . env . BROWSER <nl> ? { history } <nl> : { location : SSR . location , context : SSR . context } <nl> / / key = { Math . random ( ) } = hack for HMR from https : / / github . com / webpack / webpack - dev - server / issues / 395 <nl> + <nl> return ( <nl> - / / < I18nextProvider i18n = { { } } > <nl> + < IntlProvider locale = " en - US " messages = { { } } > <nl> < Provider store = { store } key = { Math . random ( ) } > <nl> < ThemeProvider theme = { theme } > <nl> < Router { . . . routerProps } key = { Math . random ( ) } > <nl> @ @ - 55 , 7 + 55 , 7 @ @ export default class Root extends Component { <nl> < / Router > <nl> < / ThemeProvider > <nl> < / Provider > <nl> - / / < / I18nextProvider > <nl> + < / IntlProvider > <nl> ) <nl> } <nl> } <nl> 
mmm a / src / common / components / parts / Header / index . jsx <nl> ppp b / src / common / components / parts / Header / index . jsx <nl> import PropTypes from ' prop - types ' <nl> import { Icon , Popup } from ' semantic - ui - react ' <nl> + import { FormattedMessage , FormattedDate } from ' react - intl ' <nl> + <nl> import { isEqual } from ' lodash ' <nl> import { <nl> StyledHeader , <nl> @ @ - 56 , 7 + 58 , 16 @ @ class Header extends React . Component { <nl> < Icon name = " github " size = " large " link fitted / > <nl> < / HeaderButton > <nl> } <nl> - content = { ` RSUIS on @ Github ` } <nl> + content = { <nl> + < FormattedMessage <nl> + id = " Header . Popup . HeaderButton " <nl> + defaultMessage = { ` Hello { name } , today is { today , date } ` } <nl> + values = { { <nl> + name : < b > user < / b > , <nl> + today : Date . now ( ) <nl> + } } <nl> + / > <nl> + } <nl> inverted <nl> / > <nl> < / HeaderInner > <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> * @ desc <nl> * / <nl> - import React , { type Node } from ' react ' <nl> - import fs from ' fs ' <nl> + import React from ' react ' <nl> + import { readFileSync } from ' fs ' <nl> + import path from ' path ' <nl> + import { sync as globSync } from ' glob ' <nl> import { renderToString } from ' react - dom / server ' <nl> import Helmet from ' react - helmet ' <nl> import createHistory from ' history / createMemoryHistory ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> - import { configureApp , configureRootComponent } from ' common / app ' <nl> + import { configureRootComponent , configureApp } from ' common / app ' <nl> import IndexHTMLComponent from ' . / IndexHTMLComponent ' <nl> + import type { Node } from ' react ' <nl> import assets from ' webpack - assets ' <nl> import faviconsAssets from ' favicons - assets ' <nl> + const translations = globSync ( ' locals / * . json ' ) <nl> + . map ( filename = > [ <nl> + path . basename ( filename , ' . json ' ) , <nl> + readFileSync ( filename , ' utf8 ' ) <nl> + ] ) <nl> + . map ( ( [ locale , file ] ) = > [ locale , JSON . parse ( file ) ] ) <nl> + . reduce ( ( collection , [ locale , messages ] ) = > { <nl> + collection [ locale ] = messages <nl> + return collection <nl> + } , { } ) <nl> export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> const { isLoggedIn , token } = req . user <nl> const initialState : Object = isLoggedIn <nl> @ @ - 28 , 12 + 41 , 12 @ @ export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> routes , <nl> SSR : { location , context } <nl> } ) <nl> - const App : Node = ( <nl> + const App : string = renderToString ( <nl> < StyleSheetManager sheet = { sheet . instance } > <nl> { RootComponent } <nl> < / StyleSheetManager > <nl> ) <nl> - const css = sheet . getStyleTags ( ) <nl> + const css : string = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> const props = { <nl> css , <nl> @ @ - 42 , 6 + 55 , 6 @ @ export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> initialState : preloadedState , <nl> App <nl> } <nl> - const html : string = renderToString ( < IndexHTMLComponent { . . . props } / > ) <nl> + const html : string = IndexHTMLComponent ( props ) <nl> res . send ( html ) <nl> } <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> " containers " : " . / src / common / containers " , <nl> " reducers " : " . / src / common / reducers " , <nl> - " routing " : " . / src / common / routing " <nl> + " routing " : " . / src / common / routing " , <nl> + " styles " : " . / src / common / styles " , <nl> + " images " : " . / static / images " <nl> } , <nl> " extensions " : [ " . js " , " . jsx " , " . json " ] <nl> } <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> let nodeModules = { } <nl> fs <nl> . readdirSync ( ' node_modules ' ) <nl> - . filter ( function ( x ) { <nl> + . filter ( x = > { <nl> return [ ' . bin ' ] . indexOf ( x ) = = = - 1 <nl> } ) <nl> - . forEach ( function ( mod ) { <nl> + . forEach ( mod = > { <nl> nodeModules [ mod ] = ' commonjs ' + mod <nl> } ) <nl> @ @ - 67 , 8 + 67 , 8 @ @ const baseWebpackConfig = { <nl> alias : { <nl> . . . isomorphicWebpackConfig . resolve . alias , <nl> ' webpack - assets ' : ` $ { CLIENT_DIST_PATH } / webpack - assets . json ` , <nl> - ' favicons - assets ' : ` $ { CLIENT_DIST_PATH } / favicons - stats . json ` <nl> - / / create_server : createServerAliasPath <nl> + ' favicons - assets ' : ` $ { CLIENT_DIST_PATH } / favicons - stats . json ` , <nl> + locals : ` $ { config . rootPath } / locals ` <nl> } <nl> } , <nl> module : { <nl> 
mmm a / jest_config / jest . config . json <nl> ppp b / jest_config / jest . config . json <nl> " setupFiles " : [ " < rootDir > / jest_config / setupJest . js " ] , <nl> " automock " : false , <nl> - " moduleNameMapper " : { } <nl> + " moduleNameMapper " : { <nl> + " \ \ . ( jpg | jpeg | png | gif | eot | otf | webp | svg | ttf | woff | woff2 | mp4 | webm | wav | mp3 | m4a | aac | oga ) $ " : " < rootDir > / jest_config / __mocks__ / fileMock . js " , <nl> + " \ \ . ( css | less ) $ " : " < rootDir > / jest_config / __mocks__ / styleMock . js " <nl> + } , <nl> + " coveragePathIgnorePatterns " : [ " style . jsx " , " / styles " ] <nl> } <nl> 
mmm a / src / common / components / parts / Header / index . test . jsx <nl> ppp b / src / common / components / parts / Header / index . test . jsx <nl> + import Header from ' components / parts / Header ' <nl> + import { shallow } from ' enzyme ' <nl> + import toJson from ' enzyme - to - json ' <nl> + <nl> + const props = { <nl> + title : ' Dashboard ' , <nl> + toggleSidebar : ( ) = > ( { } ) , <nl> + isLoggedIn : true , <nl> + isMobile : false <nl> + } <nl> + <nl> + describe ( ' Header component ' , ( ) = > { <nl> + it ( ' same snapshot at Dashboard on non - mobile screen ' , ( ) = > { <nl> + const component = shallow ( < Header { . . . props } / > ) <nl> + expect ( toJson ( component ) ) . toMatchSnapshot ( ) <nl> + } ) <nl> + } ) <nl> 
mmm a / src / common / components / parts / Footer / index . test . jsx <nl> ppp b / src / common / components / parts / Footer / index . test . jsx <nl> + import Footer from ' components / parts / Footer ' <nl> + import { shallow } from ' enzyme ' <nl> + import toJson from ' enzyme - to - json ' <nl> + <nl> + describe ( ' Footer component ' , ( ) = > { <nl> + it ( ' same snapshot ' , ( ) = > { <nl> + const component = shallow ( < Footer / > ) <nl> + expect ( toJson ( component ) ) . toMatchSnapshot ( ) <nl> + } ) <nl> + } ) <nl> 
mmm a / src / common / components / parts / Sidebar / index . test . jsx <nl> ppp b / src / common / components / parts / Sidebar / index . test . jsx <nl> + import Sidebar from ' components / parts / Sidebar ' <nl> + import { shallow } from ' enzyme ' <nl> + import toJson from ' enzyme - to - json ' <nl> + import { routes as routing } from ' routing ' <nl> + <nl> + const props = { <nl> + isMobile : true , <nl> + logout : ( ) = > ( { } ) , <nl> + routing , <nl> + open : true <nl> + } <nl> + <nl> + describe ( ' Sidebar component ' , ( ) = > { <nl> + it ( ' same snapshot if Sidebar is open and it is on mobile screen ' , ( ) = > { <nl> + const component = shallow ( < Sidebar { . . . props } / > ) <nl> + expect ( toJson ( component ) ) . toMatchSnapshot ( ) <nl> + } ) <nl> + } ) <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> import React from ' react ' <nl> import { Route } from ' react - router - dom ' <nl> - import Dashboard from ' containers / Dashboard ' <nl> - import Login from ' containers / Login ' <nl> - import Users from ' containers / Users ' <nl> - <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> import { createBrowserHistory , createMemoryHistory } from ' history ' <nl> import type { RouteItem } from ' types ' <nl> + const getHistory = ( ) = > { <nl> + if ( process . env . BROWSER ) { <nl> + return createMemoryHistory ( ) <nl> + } <nl> + return createBrowserHistory ( ) <nl> + } <nl> + <nl> export const history = getHistory ( ) <nl> - const loadLazyComponent = ( url : string ) = > { <nl> - return async ( cb : Function ) = > { <nl> + const loadLazyComponent = ( url : string ) = > async ( ) = > { <nl> / / NOTE : there isn ' t any duplication here <nl> / / Read Webpack docs about code - splitting for more info . <nl> if ( process . env . BROWSER ) { <nl> @ @ - 24 , 26 + 26 , 27 @ @ const loadLazyComponent = ( url : string ) = > { <nl> const loadComponent = await import ( / * webpackMode : " eager " , webpackChunkName : " lazy - containers " * / ` containers / $ { url } / index . jsx ` ) <nl> return loadComponent <nl> } <nl> - } <nl> export const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / ' , <nl> exact : true , <nl> + lazy : true , <nl> icon : ' newspaper ' , <nl> name : ' Dashboard ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : Dashboard <nl> + component : loadLazyComponent ( ' Dashboard ' ) <nl> } , <nl> { <nl> path : ' / users ' , <nl> name : ' Users ' , <nl> exact : true , <nl> + lazy : true , <nl> icon : ' users ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : Users <nl> + component : loadLazyComponent ( ' Users ' ) <nl> } , <nl> { <nl> external : true , <nl> @ @ - 55 , 8 + 58 , 9 @ @ export const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / auth ' , <nl> name : ' Auth ' , <nl> + lazy : true , <nl> tag : Route , <nl> - component : Login <nl> + component : loadLazyComponent ( ' Login ' ) <nl> } , <nl> { <nl> path : ' / users / : id ' , <nl> @ @ - 67 , 11 + 71 , 3 @ @ export const routes : Array < RouteItem > = [ <nl> component : loadLazyComponent ( ' UserItem ' ) <nl> } <nl> ] <nl> - <nl> - function getHistory ( ) { <nl> - const basename = ' ' <nl> - if ( process . env . BROWSER ! = = true ) { <nl> - return createMemoryHistory ( ) <nl> - } <nl> - return createBrowserHistory ( { basename } ) <nl> - } <nl> 
mmm a / src / common / actions / posts / index . js <nl> ppp b / src / common / actions / posts / index . js <nl> } <nl> } <nl> - export const GET_POSTS = ( ) = > async dispatch = > { <nl> + export const GET_POSTS = ( userId : number ) = > async dispatch = > { <nl> dispatch ( { type : GET_POSTS_PENDING } ) <nl> - const result = await getPostsAPI ( ) <nl> + const result = await getPostsAPI ( userId ) <nl> if ( resultOK ( result ) ) { <nl> dispatch ( { type : GET_POSTS_SUCCESS , payload : result . data } ) <nl> } else { <nl> 
mmm a / src / common / components / addons / RouteAuth / index . test . jsx <nl> ppp b / src / common / components / addons / RouteAuth / index . test . jsx <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> import { shallow } from ' enzyme ' <nl> import toJson from ' enzyme - to - json ' <nl> + import { routes as routing } from ' routing ' <nl> - const props = { <nl> - path : ' / ' , <nl> - canAccess : ( ) = > ( { } ) <nl> - } <nl> - <nl> - const notInboxPath = ' / auth ' <nl> - const inboxPath = ' / inbox ' <nl> const accessToInboxOnly = path = > { <nl> return path = = = ' / inbox ' <nl> } <nl> @ @ - 17 , 17 + 11 , 27 @ @ const accessExceptInbox = path = > { <nl> return path ! = = ' / inbox ' <nl> } <nl> - describe ( ' RouteAuth component ' , ( ) = > { <nl> - it ( ' creates < Redirect / > if user dont have access ' , done = > { <nl> - <nl> - } ) <nl> + const sampleRouteItem = routing . filter ( a = > a . component & & a . tag ) [ 0 ] <nl> - it ( ' creates component if user have access ' , done = > { <nl> - <nl> - } ) <nl> - const gotRedirect = { <nl> - path : inboxPath , <nl> - canAccess : accessExceptInbox <nl> - } <nl> - const component = shallow ( < RouteAuth { . . . gotRedirect } / > ) <nl> + describe ( ' RouteAuth component ' , ( ) = > { <nl> + / / it ( ' creates < Redirect / > if user dont have access ' , done = > { <nl> + / / const gotRedirect = { <nl> + / / . . . sampleRouteItem , <nl> + / / canAccess : accessExceptInbox , <nl> + / / path : ' / inbox ' <nl> + / / } <nl> + / / const component = shallow ( < RouteAuth { . . . gotRedirect } / > ) <nl> + / / done ( ) <nl> + / / } ) <nl> + / / <nl> + / / it ( ' creates component if user have access ' , done = > { <nl> + / / const gotComponent = { <nl> + / / . . . sampleRouteItem , <nl> + / / canAccess : accessToInboxOnly , <nl> + / / path : ' / inbox ' <nl> + / / } <nl> + / / const component = shallow ( < RouteAuth { . . . gotComponent } / > ) <nl> + / / console . log ( component ) <nl> + / / done ( ) <nl> + / / } ) <nl> } ) <nl> 
mmm a / src / server / ssr / IndexHTMLComponent . jsx <nl> ppp b / src / server / ssr / IndexHTMLComponent . jsx <nl> App : string , <nl> initialState : Object , <nl> assets : Object , <nl> - faviconsAssets : Object <nl> + faviconsAssets : Object , <nl> + translation : Object <nl> } <nl> / / renderToString <nl> const DLLScripts = <nl> @ @ - 20 , 16 + 21 , 18 @ @ const IndexHTMLComponent = ( { <nl> App , <nl> initialState , <nl> assets , <nl> - faviconsAssets <nl> + faviconsAssets , <nl> + translation <nl> } : args ) = > { <nl> const stringifiedState : string = JSON . stringify ( initialState ) <nl> + const stringifiedTranslation : string = JSON . stringify ( translation ) <nl> const safeStringifiedState : string = stringifiedState . replace ( / < / g , ' \ \ u003c ' ) <nl> const createBody = ( ) = > { <nl> const html = ` <nl> < div id = " app " > $ { App } < / div > <nl> < script > window . __INITIAL_STATE__ = $ { safeStringifiedState } < / script > <nl> - < script > window . __I18N__ = $ { safeStringifiedState } < / script > <nl> + < script > window . __I18N__ = $ { stringifiedTranslation } < / script > <nl> $ { DLLScripts } <nl> $ { Object . keys ( assets ) <nl> . filter ( bundleName = > assets [ bundleName ] . js ) <nl> 
mmm a / src / server / middlewares / auth . js <nl> ppp b / src / server / middlewares / auth . js <nl> export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> req . user = { <nl> token : null , <nl> + lang : ' en ' , <nl> isLoggedIn : false <nl> } <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> collection [ locale ] = messages <nl> return collection <nl> } , { } ) <nl> + <nl> export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> - const { isLoggedIn , token } = req . user <nl> + const { isLoggedIn , token , lang } = req . user <nl> const initialState : Object = isLoggedIn <nl> ? { me : { auth : { isLoggedIn , token } } } <nl> : { } <nl> @ @ - 53 , 6 + 54 , 7 @ @ export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> assets , <nl> faviconsAssets , <nl> initialState : preloadedState , <nl> + translation : translations [ lang ] , <nl> App <nl> } <nl> const html : string = IndexHTMLComponent ( props ) <nl> 
mmm a / src / common / components / parts / Sidebar / index . jsx <nl> ppp b / src / common / components / parts / Sidebar / index . jsx <nl> import { Menu , Icon } from ' semantic - ui - react ' <nl> import { NavLink } from ' react - router - dom ' <nl> + import Logo from ' components / elements / Logo ' <nl> import { <nl> StyledSidebar , <nl> SidebarLogo , <nl> @ @ - 10 , 9 + 11 , 7 @ @ import { <nl> SidebarLogoutItem <nl> } from ' . / style ' <nl> import { Spacer } from ' styles / base ' <nl> - <nl> import type { RouteItem } from ' types ' <nl> - / / require ( ' . / index . scss ' ) <nl> type Props = { <nl> open : boolean , <nl> @ @ - 71 , 12 + 70 , 11 @ @ export default class SidebarComponent extends Component { <nl> / / ? require ( ' images / logo . png ' ) <nl> / / : require ( ' images / logo . png ' ) . preSrc <nl> / / <nl> - const logoImg = require ( ' images / logo . png ' ) <nl> return ( <nl> < StyledSidebar { . . . sidebarProps } > <nl> < SidebarLogoContainer href = " https : / / github . com / Metnew / react - semantic . ui - starter " > <nl> - < SidebarLogo src = { logoImg } alt = " logo " shape = " circular " centered / > <nl> + < SidebarLogo alt = " logo " shape = " circular " centered / > <nl> < / SidebarLogoContainer > <nl> { routes } <nl> < Spacer / > <nl> 
mmm a / src / server / api / auth / index . js <nl> ppp b / src / server / api / auth / index . js <nl> / / Define the home page route <nl> router . post ( ' / ' , ( req , res ) = > { <nl> - / / Const { username , password } = req . body <nl> - const data = { username : ' cool_username_for_testing ' } <nl> + const lang = req . body . lang | | ' en ' <nl> + const data = { username : ' cool_username_for_testing ' , lang } <nl> jwt . sign ( data , process . env . JWT_SECRET , { expiresIn : ' 7d ' } , ( err , token ) = > { <nl> if ( err ) { <nl> throw new Error ( <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> nodeModules [ mod ] = ' commonjs ' + mod <nl> } ) <nl> - / / const createServerAlias = ! isProduction <nl> - / / ? ' . . / . . / webpack_config / server ' <nl> - / / : ' . / server ' <nl> - / / <nl> - / / const createServerAliasPath = path . join ( config . srcPath , ' . / server ' , createServerAlias ) <nl> - <nl> const baseWebpackConfig = { <nl> name : ' server ' , <nl> entry , <nl> @ @ - 68 , 7 + 62 , 8 @ @ const baseWebpackConfig = { <nl> . . . isomorphicWebpackConfig . resolve . alias , <nl> ' webpack - assets ' : ` $ { CLIENT_DIST_PATH } / webpack - assets . json ` , <nl> ' favicons - assets ' : ` $ { CLIENT_DIST_PATH } / favicons - stats . json ` , <nl> - locals : ` $ { config . rootPath } / locals ` <nl> + locals : ` $ { config . rootPath } / locals ` , <nl> + ssl : ` $ { config . srcPath } / server / config / ssl ` <nl> } <nl> } , <nl> module : { <nl> 
mmm a / src / server / ssr / IndexHTMLComponent . jsx <nl> ppp b / src / server / ssr / IndexHTMLComponent . jsx <nl> initialState : Object , <nl> assets : Object , <nl> faviconsAssets : Object , <nl> - translation : Object <nl> + i18n : Object <nl> } <nl> / / renderToString <nl> const DLLScripts = <nl> @ @ - 22 , 22 + 22 , 21 @ @ const IndexHTMLComponent = ( { <nl> initialState , <nl> assets , <nl> faviconsAssets , <nl> - translation <nl> + i18n <nl> } : args ) = > { <nl> const stringifiedState : string = JSON . stringify ( initialState ) <nl> - const stringifiedTranslation : string = JSON . stringify ( translation ) <nl> + const stringifiedI18N : string = JSON . stringify ( i18n ) <nl> const safeStringifiedState : string = stringifiedState . replace ( / < / g , ' \ \ u003c ' ) <nl> const createBody = ( ) = > { <nl> const html = ` <nl> < div id = " app " > $ { App } < / div > <nl> < script > window . __INITIAL_STATE__ = $ { safeStringifiedState } < / script > <nl> - < script > window . __I18N__ = $ { stringifiedTranslation } < / script > <nl> + < script > window . __I18N__ = $ { stringifiedI18N } < / script > <nl> $ { DLLScripts } <nl> $ { Object . keys ( assets ) <nl> . filter ( bundleName = > assets [ bundleName ] . js ) <nl> . map ( bundleName = > { <nl> - console . log ( bundleName ) <nl> const path = assets [ bundleName ] . js <nl> return ` < script src = " $ { path } " type = " text / javascript " > < / script > ` <nl> } ) <nl> @ @ - 74 , 7 + 73 , 7 @ @ const IndexHTMLComponent = ( { <nl> return html <nl> } <nl> - return ` < html lang = " en " > <nl> + return ` < html lang = " $ { i18n . lang } " > <nl> < head > $ { createHead ( ) } < head > <nl> < body > <nl> $ { createBody ( ) } <nl> 
mmm a / src / common / containers / Login / index . jsx <nl> ppp b / src / common / containers / Login / index . jsx <nl> const mapDispatchToProps = dispatch = > ( { <nl> login ( data ) { <nl> - dispatch ( LOGIN_AUTH ( data ) ) <nl> + const language = navigator & & navigator . language <nl> + const payload = { . . . data , lang : language } <nl> + dispatch ( LOGIN_AUTH ( payload ) ) <nl> } <nl> } ) <nl> 
mmm a / src / common / app / configure_root . jsx <nl> ppp b / src / common / app / configure_root . jsx <nl> import ' styles / global ' <nl> type Props = { <nl> + i18n : Object , <nl> store : Object , / / unconfigured store <nl> SSR : { <nl> / / SSR options , see ` / server ` for more info <nl> @ @ - 24 , 9 + 25 , 9 @ @ type Props = { <nl> * Configure Root component . <nl> * / <nl> - const configureRootComponent = ( { store , SSR , history , routes } : Props ) = > { <nl> - const props = { store , SSR , history , routes } <nl> + const configureRootComponent = ( props : Props ) = > { <nl> if ( module . hot ) { <nl> + const { store } = props <nl> / / Enable Webpack hot module replacement for reducers <nl> module . hot . accept ( ' reducers ' , ( ) = > { <nl> const nextRootReducer = require ( ' reducers ' ) . default <nl> 
mmm a / src / server / server . js <nl> ppp b / src / server / server . js <nl> / / Add global middlewares <nl> addMiddlewares ( app ) <nl> / / Add API <nl> - app . use ( ' / api / v1 ' , API ) <nl> + app . use ( process . env . BASE_API , API ) <nl> / / Add SSR <nl> app . use ( SSR ) <nl> return app <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " query - string " : " ^ 5 . 0 . 0 " , <nl> " rapscallion " : " ^ 2 . 1 . 13 " , <nl> + " raven " : " ^ 2 . 1 . 2 " , <nl> " react " : " ^ 15 . 6 . 1 " , <nl> " react - dom " : " ^ 15 . 6 . 1 " , <nl> " react - helmet " : " ^ 5 . 2 . 0 " , <nl> " redux " : " ^ 3 . 7 . 2 " , <nl> " redux - persist " : " ^ 4 . 9 . 1 " , <nl> " redux - thunk " : " ^ 2 . 2 . 0 " , <nl> + " reselect " : " ^ 3 . 0 . 1 " , <nl> " semantic - ui - css " : " ^ 2 . 2 . 12 " , <nl> " semantic - ui - react " : " ^ 0 . 73 . 0 " , <nl> " spdy " : " ^ 3 . 4 . 7 " , <nl> " i18n - webpack - plugin " : " ^ 1 . 0 . 0 " , <nl> " img - loader " : " ^ 2 . 0 . 0 " , <nl> " jest " : " ^ 21 . 0 . 2 " , <nl> + " nock " : " ^ 9 . 0 . 14 " , <nl> " node - sass " : " ^ 4 . 5 . 3 " , <nl> " open " : " 0 . 0 . 5 " , <nl> " optimize - css - assets - webpack - plugin " : " ^ 3 . 1 . 1 " , <nl> 
mmm a / src / server / index . dev . js <nl> ppp b / src / server / index . dev . js <nl> * / <nl> import express from ' express ' <nl> + import http from ' http ' <nl> import spdy from ' spdy ' <nl> import chalk from ' chalk ' <nl> / / Mount our server - side code to dev server <nl> - import server from ' . . / . . / webpack_config / server ' <nl> + import server from ' . . / . . / webpack_config / devServer ' <nl> import { serverOptions as options } from ' . / config / index . dev ' <nl> const app : express $ Application = express ( ) <nl> - const PORT : number = + process . env . PORT | | 3000 <nl> + const httpsPORT : number = + process . env . PORT | | 3000 <nl> + const httpPort : number = + process . env . PORT | | 3000 - 443 <nl> server ( app ) <nl> - spdy . createServer ( options , app ) . listen ( PORT , ( ) = > { <nl> - console . log ( chalk . green ( ` SERVER IS LISTENING ON $ { PORT } ` ) ) <nl> + spdy . createServer ( options , app ) . listen ( httpsPORT , ( ) = > { <nl> + console . log ( <nl> + chalk . red ( ` HTTPS SERVER IS LISTENING ON https : / / 127 . 0 . 0 . 1 : $ { httpsPORT } ` ) <nl> + ) <nl> + } ) <nl> + <nl> + http . createServer ( app ) . listen ( httpPort , ( ) = > { <nl> + console . log ( <nl> + chalk . green ( ` HTTP SERVER IS LISTENING ON http : / / localhost : $ { httpPort } ` ) <nl> + ) <nl> } ) <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> / / NOTE : there isn ' t any duplication here <nl> / / Read Webpack docs about code - splitting for more info . <nl> if ( process . env . BROWSER ) { <nl> - const loadComponent = await import ( / * webpackMode : " lazy - once " , webpackChunkName : " lazy - containers " * / ` containers / $ { url } / index . jsx ` ) <nl> + const loadComponent = await import ( / * webpackMode : " lazy " , webpackChunkName : " [ request ] . lazy " * / ` containers / $ { url } / index . jsx ` ) <nl> return loadComponent <nl> } <nl> - const loadComponent = await import ( / * webpackMode : " eager " , webpackChunkName : " lazy - containers " * / ` containers / $ { url } / index . jsx ` ) <nl> + const loadComponent = await import ( / * webpackMode : " eager " * / ` containers / $ { url } / index . jsx ` ) <nl> return loadComponent <nl> } <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> * / <nl> import React from ' react ' <nl> - import { readFileSync } from ' fs ' / / readFile <nl> - import path from ' path ' <nl> + import chalk from ' chalk ' <nl> / / import _ from ' lodash ' <nl> - import { sync as globSync } from ' glob ' <nl> import { renderToString } from ' react - dom / server ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> / / import { addLocaleData } from ' react - intl ' <nl> import HtmlComponent from ' . / HtmlComponent ' <nl> + / / $ FlowFixMe <nl> import assets from ' webpack - assets ' <nl> + / / $ FlowFixMe <nl> import faviconsAssets from ' favicons - assets ' <nl> - import type { Node } from ' react ' <nl> - <nl> - const translations = globSync ( ' locals / * . json ' ) <nl> - . map ( filename = > [ <nl> - path . basename ( filename , ' . json ' ) , <nl> - readFileSync ( filename , ' utf8 ' ) <nl> - ] ) <nl> - . map ( ( [ locale , file ] ) = > [ locale , JSON . parse ( file ) ] ) <nl> - . reduce ( ( collection , [ locale , messages ] ) = > { <nl> - collection [ locale ] = messages <nl> - return collection <nl> - } , { } ) <nl> + import getI18nData from ' server / i18n ' <nl> export default ( req : express $ Request , res : express $ Response ) = > { <nl> - const { isLoggedIn , token , lang } = req . user <nl> + const { isLoggedIn , lang } = req . user <nl> + const { isMobile } = req . useragent <nl> + console . log ( chalk . cyan ( ` MOBILE DEVICE : $ { isMobile } ` , JSON . stringify ( req . useragent ) , lang ) ) <nl> + const meState = { auth : { isLoggedIn } } <nl> + const layoutState = { isMobile } <nl> const initialState : Object = isLoggedIn <nl> - ? { me : { auth : { isLoggedIn , token } } } <nl> - : { } <nl> - const localeData = require ( ' react - intl / locale - data / ' + ( lang | | ' en ' ) ) <nl> - const i18n = { <nl> - lang , <nl> - localeData , <nl> - locale : lang , <nl> - messages : translations [ lang ] <nl> - } <nl> - / / <nl> + ? { me : meState , layout : layoutState } <nl> + : { layout : layoutState } <nl> + const i18n = getI18nData ( lang ) <nl> const sheet = new ServerStyleSheet ( ) <nl> const location : string = req . url <nl> const context = { } <nl> const { store , history , routes } = configureApp ( initialState ) <nl> - const RootComponent : Node = configureRootComponent ( { <nl> + const RootComponent : React $ Node = configureRootComponent ( { <nl> store , <nl> history , <nl> routes , <nl> 
mmm a / src / server / middlewares / index . js <nl> ppp b / src / server / middlewares / index . js <nl> import cookieParser from ' cookie - parser ' <nl> import bodyParser from ' body - parser ' <nl> import morgan from ' morgan ' <nl> + import useragent from ' express - useragent ' <nl> import authMiddleware from ' . / auth ' <nl> export default ( app : express $ Application ) : express $ Application = > { <nl> @ @ - 22 , 6 + 23 , 7 @ @ export default ( app : express $ Application ) : express $ Application = > { <nl> } ) <nl> ) <nl> app . use ( bodyParser . json ( ) ) <nl> + app . use ( useragent . express ( ) ) <nl> app . use ( authMiddleware ) <nl> return app <nl> 
mmm a / src / common / api / LocalStorageCookiesSvc / index . js <nl> ppp b / src / common / api / LocalStorageCookiesSvc / index . js <nl> import * as store from ' store2 ' <nl> import Cookies from ' js - cookie ' <nl> + import decodeJWT from ' jwt - decode ' <nl> export const JWT_TOKEN = ' JWT_TOKEN ' <nl> @ @ - 18 , 4 + 19 , 9 @ @ export function setLocalToken ( token : string ) { <nl> Cookies . set ( JWT_TOKEN , token , { expires : 365 } ) <nl> } <nl> + export function getInfoFromJWT ( ) { <nl> + const token = getLocalToken ( ) <nl> + return decodeJWT ( token ) <nl> + } <nl> + <nl> export const isLoggedIn = ( ) = > ! ! getLocalToken ( ) <nl> 
mmm a / src / common / containers / App / index . jsx <nl> ppp b / src / common / containers / App / index . jsx <nl> } from ' . / style ' <nl> import type { RouteItem } from ' types ' <nl> import type { GlobalState } from ' reducers ' <nl> - import type { Node } from ' react ' <nl> type Props = { <nl> - children : Node , <nl> + children : React $ Node , <nl> / / Routes of app passed as props in ` Root ` <nl> routes : Array < RouteItem > , <nl> / / React - router ` withRouter ` props <nl> @ @ - 57 , 6 + 56 , 7 @ @ class App extends Component { <nl> const { isLoggedIn } = this . props <nl> if ( process . env . BROWSER ) { <nl> const { handleWindowResize } = this . props <nl> + handleWindowResize ( ) <nl> window . addEventListener ( ' resize ' , handleWindowResize ) <nl> } <nl> this . checkAppAuthLogic ( isLoggedIn ) <nl> 
mmm a / src / common / api / utils / xhr_wrapper . js <nl> ppp b / src / common / api / utils / xhr_wrapper . js <nl> * / <nl> - import { <nl> - getLocalToken , <nl> - resetLocalToken <nl> - } from ' api / LocalStorageCookiesSvc ' <nl> + import { getLocalToken , resetLocalToken } from ' api / LocalStorageCookiesSvc ' <nl> + import fetch from ' isomorphic - fetch ' <nl> import _ from ' lodash ' <nl> / * * <nl> 
mmm a / src / common / components / parts / Header / style . jsx <nl> ppp b / src / common / components / parts / Header / style . jsx <nl> import { media } from ' styles / utils ' <nl> import { Button } from ' semantic - ui - react ' <nl> - <nl> export const StyledHeader = styled . header ` <nl> background : $ { props = > props . theme . primaryColor } ; <nl> border - bottom : 1px solid $ { props = > props . theme . primaryColorDark } ; <nl> @ @ - 12 , 11 + 11 , 8 @ @ export const StyledHeader = styled . header ` <nl> justify - content : center ; <nl> flex - direction : column ; <nl> width : 100 % ; <nl> - position : fixed ; <nl> z - index : 444 ; <nl> - $ { media . md ` <nl> height : 65px ; <nl> - ` } ; <nl> $ { media . lg ` <nl> height : 72px ; <nl> ` } ; <nl> @ @ - 24 , 7 + 20 , 6 @ @ export const StyledHeader = styled . header ` <nl> export const HeaderInner = styled . div ` <nl> display : flex ; <nl> padding : 0 15px ; <nl> - $ { ' XXX : maybe it \ ' s better to use ` em ` s ? ' } <nl> ` <nl> export const PageTitle = styled . span ` <nl> 
mmm a / src / common / reducers / auth / index . js <nl> ppp b / src / common / reducers / auth / index . js <nl> - import { <nl> - isLoggedIn as hasLocalToken , <nl> - getLocalToken <nl> - } from ' api / LocalStorageCookiesSvc ' <nl> + import { isLoggedIn as hasLocalToken } from ' api / LocalStorageCookiesSvc ' <nl> import { <nl> LOGIN_AUTH_FAIL , <nl> LOGIN_AUTH_PENDING , <nl> @ @ - 23 , 7 + 20 , 6 @ @ export type State = { <nl> isLoading : boolean , <nl> isLoaded : boolean , <nl> isLoggedIn : boolean , <nl> - token : string | null , <nl> errors : Object <nl> } <nl> @ @ - 38 , 7 + 34 , 6 @ @ export const initialState : State = { <nl> isLoading : false , <nl> isLoaded : false , <nl> isLoggedIn : hasLocalToken ( ) , <nl> - token : getLocalToken ( ) , <nl> errors : { } <nl> } <nl> @ @ - 52 , 7 + 47 , 6 @ @ export function auth ( state : State = initialState , action : Action ) : State { <nl> isLoading : false , <nl> isLoaded : true , <nl> isLoggedIn : false , <nl> - token : null , <nl> errors : { } <nl> } <nl> } <nl> @ @ - 63 , 18 + 57 , 15 @ @ export function auth ( state : State = initialState , action : Action ) : State { <nl> isLoading : false , <nl> isLoaded : true , <nl> isLoggedIn : false , <nl> - token : null , <nl> errors <nl> } <nl> } <nl> case LOGIN_AUTH_SUCCESS : { <nl> - const { token } = action . payload <nl> return { <nl> . . . state , <nl> isLoading : false , <nl> isLoaded : true , <nl> - isLoggedIn : true , <nl> - token <nl> + isLoggedIn : true <nl> } <nl> } <nl> case LOGIN_AUTH_PENDING : { <nl> 
mmm a / src / common / reducers / layout / index . js <nl> ppp b / src / common / reducers / layout / index . js <nl> UI_CLOSE_SIDEBAR , <nl> UI_WINDOW_RESIZE <nl> } from ' actions / layout ' <nl> - import { LOCATION_CHANGE , APPLICATION_INIT } from ' actions / common ' <nl> + import { LOCATION_CHANGE } from ' actions / common ' <nl> / / <nl> import type { LOCATION_CHANGE_TYPE , APPLICATION_INIT_TYPE } from ' actions / common ' <nl> import type { <nl> @ @ - 42 , 11 + 42 , 13 @ @ export function layout ( state : State = initialState , action : Action ) : State { <nl> return { isMobileSM , isMobileXS , isMobile } <nl> } <nl> switch ( action . type ) { <nl> - case APPLICATION_INIT : <nl> - case UI_WINDOW_RESIZE : <nl> + case UI_WINDOW_RESIZE : { <nl> + const { innerWidth } = action . payload <nl> + const mobileStates = computeMobileStatuses ( innerWidth ) <nl> return { <nl> . . . state , <nl> - . . . computeMobileStatuses ( action . payload . innerWidth ) <nl> + . . . mobileStates <nl> + } <nl> } <nl> case UI_OPEN_SIDEBAR : <nl> return { <nl> 
mmm a / src / server / ssr / HtmlComponent . jsx <nl> ppp b / src / server / ssr / HtmlComponent . jsx <nl> + import serealize from ' serialize - javascript ' <nl> + <nl> type args = { <nl> css : string , <nl> App : string , <nl> @ @ - 24 , 8 + 26 , 8 @ @ const HtmlComponent = ( { <nl> faviconsAssets , <nl> i18n <nl> } : args ) = > { <nl> - const stringifiedState : string = JSON . stringify ( initialState ) <nl> - const stringifiedI18N : string = JSON . stringify ( i18n ) <nl> + const stringifiedState : string = serealize ( initialState ) <nl> + const stringifiedI18N : string = serealize ( i18n ) <nl> const safeStringifiedState : string = stringifiedState . replace ( / < / g , ' \ \ u003c ' ) <nl> const createBody = ( ) = > { <nl> 
mmm a / src / server / i18n / index . js <nl> ppp b / src / server / i18n / index . js <nl> import { readFileSync } from ' fs ' / / readFile <nl> import path from ' path ' <nl> import { sync as globSync } from ' glob ' <nl> / / import { addLocaleData } from ' react - intl ' <nl> import enLocaleData from ' react - intl / locale - data / en ' <nl> import ruLocaleData from ' react - intl / locale - data / ru ' <nl> + import type { i18nConfigObject } from ' types ' <nl> const translations = globSync ( ' locals / * . json ' ) <nl> - . map ( filename = > [ <nl> + . map ( ( filename : string ) = > [ <nl> path . basename ( filename , ' . json ' ) , <nl> readFileSync ( filename , ' utf8 ' ) <nl> ] ) <nl> @ @ - 24 , 7 + 26 , 7 @ @ const summaryLocaleData = { <nl> export const defaultLanguage = ' en ' <nl> export const supportedLanguages = [ ' en ' , ' ru ' ] <nl> - export default lang = > { <nl> + export default ( lang : string ) : i18nConfigObject = > { <nl> console . log ( lang ) <nl> return { <nl> lang , <nl> 
mmm a / src / common / types / index . js <nl> ppp b / src / common / types / index . js <nl> tag ? : React $ Node | Function , <nl> component ? : React $ Node | Function <nl> } <nl> + <nl> + export type i18nConfigObject = { <nl> + messages : Object , <nl> + localeData : Object , <nl> + locale : string , <nl> + lang ? : string <nl> + } <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> " plugins " : [ <nl> - [ " lodash " , { " id " : [ " lodash " , " semantic - ui - react " ] } ] , <nl> + [ " lodash " , { " id " : [ " lodash " ] } ] , <nl> [ <nl> " transform - runtime " , <nl> { <nl> " moduleName " : " babel - runtime " <nl> } <nl> ] , <nl> - " syntax - dynamic - import " <nl> + " syntax - dynamic - import " , <nl> + [ <nl> + " babel - plugin - styled - components " , <nl> + { <nl> + " preprocess " : true , <nl> + " ssr " : true <nl> + } <nl> + ] <nl> + ] , <nl> + " presets " : [ <nl> + [ <nl> + " env " , <nl> + { <nl> + " targets " : { <nl> + " browsers " : [ " last 2 versions " , " > 1 % " ] <nl> + } <nl> + } <nl> + ] , <nl> + " es2015 " , <nl> + " stage - 1 " , <nl> + " react " , <nl> + " flow " <nl> ] , <nl> - " presets " : [ " es2015 " , " react " , " stage - 0 " , " flow " ] , <nl> " env " : { <nl> " production " : { <nl> " presets " : [ " react - optimize " ] <nl> 
mmm a / src / client / index . jsx <nl> ppp b / src / client / index . jsx <nl> / / Styles <nl> - import ' semantic - ui - css / semantic . css ' <nl> - / / Fetch and promise polyfill <nl> + / / If you want full SUI CSS : <nl> + / / import ' semantic - ui - css / semantic . css ' <nl> + / / If you want only some components from SUI : <nl> + import ' semantic - ui - css / components / button . css ' <nl> + import ' semantic - ui - css / components / card . css ' <nl> + import ' semantic - ui - css / components / container . css ' <nl> + import ' semantic - ui - css / components / dimmer . css ' <nl> + import ' semantic - ui - css / components / divider . css ' <nl> + import ' semantic - ui - css / components / dropdown . css ' <nl> + import ' semantic - ui - css / components / grid . css ' <nl> + import ' semantic - ui - css / components / header . css ' <nl> + import ' semantic - ui - css / components / flag . css ' <nl> + import ' semantic - ui - css / components / form . css ' <nl> + import ' semantic - ui - css / components / item . css ' <nl> + import ' semantic - ui - css / components / icon . css ' <nl> + import ' semantic - ui - css / components / image . css ' <nl> + import ' semantic - ui - css / components / input . css ' <nl> + import ' semantic - ui - css / components / menu . css ' <nl> + import ' semantic - ui - css / components / label . css ' <nl> + import ' semantic - ui - css / components / loader . css ' <nl> + import ' semantic - ui - css / components / reset . css ' <nl> + import ' semantic - ui - css / components / sidebar . css ' <nl> + import ' semantic - ui - css / components / site . css ' <nl> + import ' semantic - ui - css / components / statistic . css ' <nl> + / / promise polyfill <nl> import ' promise - polyfill ' <nl> - import ' isomorphic - fetch ' <nl> / / Application <nl> import { render } from ' react - dom ' <nl> import { configureApp , configureRootComponent } from ' common / app ' <nl> import { persistStore } from ' redux - persist ' <nl> + import type { GlobalState } from ' reducers ' <nl> + import type { i18nConfigObject } from ' types ' <nl> if ( process . env . NODE_ENV = = = ' production ' ) { <nl> require ( ' common / pwa ' ) <nl> } else if ( process . env . NODE_ENV = = = ' development ' ) { <nl> / / Devtools <nl> - / / NOTE : whyDidYouUpdate package is temporary broken , waiting for a patch . <nl> - <nl> + / / NOTE : whyDidYouUpdate package is temporarily broken , waiting for a patch . <nl> / * eslint - disable * / <nl> / / NOTE : But if you really want to run ` why - did - you - update ` <nl> / / You can uncomment this block : <nl> @ @ - 28 , 8 + 52 , 7 @ @ if ( process . env . NODE_ENV = = = ' production ' ) { <nl> whyDidYouUpdate ( React ) <nl> * / <nl> / * eslint - enable * / <nl> - window . Perf = require ( ' react - addons - perf ' ) <nl> - <nl> + / / window . Perf = require ( ' react - addons - perf ' ) <nl> / / NOTE : a11y doesnt work with SSR and React throws warnings like : <nl> / / " React attempted to reuse markup in a container but the checksum was invalid " <nl> / / a11y adds " id " attribute to the root container ( # app ) of your app and triggers re - rendering <nl> @ @ - 39 , 8 + 62 , 8 @ @ if ( process . env . NODE_ENV = = = ' production ' ) { <nl> / / a11y ( React , { ReactDOM } ) <nl> } <nl> - const initialState = window . __INITIAL_STATE__ | | { } <nl> - const i18n = window . __I18N__ | | { } <nl> + const initialState : GlobalState = window . __INITIAL_STATE__ | | { } <nl> + const i18n : i18nConfigObject = window . __I18N__ | | { } <nl> / / NOTE : V8 doesn ' t optimize ` delete ` <nl> / / delete window . __INITIAL_STATE__ <nl> const { store , routes , history } = configureApp ( initialState ) <nl> 
mmm a / src / common / components / parts / Root / index . jsx <nl> ppp b / src / common / components / parts / Root / index . jsx <nl> import React , { Component } from ' react ' <nl> import { Provider } from ' react - redux ' <nl> - import { IntlProvider , defineMessages , addLocaleData } from ' react - intl ' / / as we build ourself via webpack <nl> + import { IntlProvider , defineMessages , addLocaleData } from ' react - intl ' <nl> import { APPLICATION_INIT } from ' actions / common ' <nl> import { ThemeProvider } from ' styled - components ' <nl> import theme from ' styles / theme ' <nl> import App from ' containers / App ' <nl> import RoutingWrapper from ' components / addons / RoutingWrapper ' <nl> - import { getWindowInnerWidth } from ' const ' <nl> - import type { RouteItem } from ' types ' <nl> + import type { RouteItem , i18nConfigObject } from ' types ' <nl> const Router = process . env . BROWSER <nl> ? require ( ' react - router - redux ' ) . ConnectedRouter <nl> @ @ - 16 , 10 + 15 , 7 @ @ const Router = process . env . BROWSER <nl> type Props = { <nl> store : Object , <nl> - i18n : { <nl> - messages : Object , <nl> - locale : string <nl> - } , <nl> + i18n : i18nConfigObject , <nl> SSR : { <nl> location ? : Object , <nl> context ? : Object <nl> @ @ - 37 , 9 + 33 , 8 @ @ export default class Root extends Component { <nl> componentWillMount ( ) { <nl> const { store , i18n } = this . props <nl> - const innerWidth : number = getWindowInnerWidth ( window ) <nl> - store . dispatch ( { type : APPLICATION_INIT , payload : { innerWidth } } ) <nl> - addLocaleData ( [ . . . i18n . localeData ] ) <nl> + store . dispatch ( { type : APPLICATION_INIT } ) <nl> + addLocaleData ( i18n . localeData ) <nl> } <nl> render ( ) { <nl> @ @ - 55 , 9 + 50 , 9 @ @ export default class Root extends Component { <nl> locale = { i18n . locale } <nl> messages = { defineMessages ( i18n . messages ) } <nl> > <nl> - < Provider store = { store } key = { Math . random ( ) } > <nl> + < Provider store = { store } key = { Date . now ( ) } > <nl> < ThemeProvider theme = { theme } > <nl> - < Router { . . . routerProps } key = { Math . random ( ) } > <nl> + < Router { . . . routerProps } > <nl> < App routes = { routes } > <nl> < RoutingWrapper store = { store } routes = { routes } / > <nl> < / App > <nl> 
mmm a / src / common / containers / App / index . jsx <nl> ppp b / src / common / containers / App / index . jsx <nl> import { LOGOUT_AUTH } from ' actions / auth ' <nl> import { getAuthState , getLayoutState } from ' selectors ' <nl> import { getWindowInnerWidth } from ' const ' <nl> + import ReactGA from ' react - ga ' <nl> / / Import styled components <nl> import { <nl> PageLayout , <nl> @ @ - 85 , 24 + 86 , 9 @ @ class App extends Component { <nl> / / } <nl> / / <nl> / / NOTE : uncomment if you use Google Analytics <nl> - / / if ( process . env . GA_ID ) { <nl> - / / const script = document . createElement ( ' script ' ) <nl> - / / script . type = ' text / javascript ' <nl> - / / script . async = true <nl> - / / script . crossorigin = ' anonymous ' <nl> - / / script . onload = ( ) = > { <nl> - / / window . ga = <nl> - / / window . ga | | <nl> - / / function ( ) { <nl> - / / ; ( ga . q = ga . q | | [ ] ) . push ( arguments ) <nl> - / / } <nl> - / / ga . l = Number ( new Date ( ) ) <nl> - / / ga ( ' create ' , process . env . GA_ID , ' auto ' ) <nl> - / / ga ( ' send ' , ' pageview ' ) <nl> - / / } <nl> - / / script . src = ' https : / / www . google - analytics . com / analytics . js ' <nl> - / / document . body . appendChild ( script ) <nl> - / / } <nl> + if ( process . env . GA_ID ) { <nl> + ReactGA . initialize ( process . env . GA_ID ) <nl> + } <nl> } <nl> / * * <nl> 
mmm a / src / common / components / parts / Header / index . jsx <nl> ppp b / src / common / components / parts / Header / index . jsx <nl> * @ flow <nl> * / <nl> - import React from ' react ' <nl> - import { Icon , Popup } from ' semantic - ui - react ' <nl> - <nl> + import React , { Component } from ' react ' <nl> + import { Icon , Dropdown , Flag } from ' semantic - ui - react ' <nl> import { isEqual } from ' lodash ' <nl> + / / import { FormattedMessage } from ' react - intl ' <nl> import { <nl> StyledHeader , <nl> HeaderInner , <nl> @ @ - 13 , 6 + 13 , 7 @ @ import { <nl> HeaderButton <nl> } from ' . / style ' <nl> import { Spacer } from ' styles / base ' <nl> + import Headroom from ' react - headroom ' <nl> type Props = { <nl> title : string , <nl> @ @ - 21 , 7 + 22 , 7 @ @ type Props = { <nl> isMobile : boolean <nl> } <nl> - class Header extends React . Component { <nl> + class Header extends Component { <nl> props : Props <nl> shouldComponentUpdate ( nextProps : Props ) { <nl> return ! isEqual ( nextProps , this . props ) <nl> @ @ - 29 , 8 + 30 , 14 @ @ class Header extends React . Component { <nl> render ( ) { <nl> const { title , toggleSidebar , isLoggedIn , isMobile } = this . props <nl> + const options = [ { key : 1 , text : ' EN ' } , { key : 2 , text : ' RU ' } ] <nl> + const selectedLanguage = { <nl> + text : ' ru ' , <nl> + icon : ' ru ' <nl> + } <nl> return ( <nl> + < Headroom > <nl> < StyledHeader > <nl> < HeaderInner > <nl> { isLoggedIn & & <nl> @ @ - 42 , 27 + 49 , 25 @ @ class Header extends React . Component { <nl> { title } <nl> < / PageTitle > <nl> < Spacer / > <nl> - < Popup <nl> - trigger = { <nl> - < HeaderButton <nl> - id = " header - button " <nl> - icon <nl> - as = { ' a ' } <nl> - aria - label = " github - header - link - button " <nl> - href = " https : / / github . com / Metnew / noir " <nl> - basic <nl> - circular <nl> + < Dropdown <nl> + text = { selectedLanguage . text } <nl> + icon = { < Flag name = " ru " / > } <nl> + floating <nl> + labeled <nl> + button <nl> + className = " icon " <nl> > <nl> - < Icon name = " github " size = " large " link fitted / > <nl> - < / HeaderButton > <nl> - } <nl> - content = { <nl> - ` Star this project ! ` <nl> - } <nl> - inverted <nl> - / > <nl> + < Dropdown . Menu > <nl> + < Dropdown . Header icon = " globe " content = " Select Language " / > <nl> + < Dropdown . Divider / > <nl> + < Dropdown . Item flag = " us " text = " EN " / > <nl> + < Dropdown . Item flag = " ru " text = " RU " / > <nl> + < / Dropdown . Menu > <nl> + < / Dropdown > <nl> + { / * < Flag name = " " / > * / } <nl> < / HeaderInner > <nl> < / StyledHeader > <nl> + < / Headroom > <nl> ) <nl> } <nl> } <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> SENTRY_DSN_PUBLIC , <nl> GA_ID , <nl> JWT_SECRET , <nl> + ANALYZE_BUNDLE , <nl> SENTRY_DSN , <nl> PORT <nl> } = process . env <nl> @ @ - 42 , 6 + 43 , 7 @ @ export default { <nl> BASE_API , <nl> NODE_ENV , <nl> SENTRY_DSN_PUBLIC , <nl> + ANALYZE_BUNDLE , <nl> GA_ID , <nl> CLIENT_DIST_PATH , <nl> JWT_SECRET , <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import chalk from ' chalk ' <nl> / / import _ from ' lodash ' <nl> - import { renderToString } from ' react - dom / server ' <nl> + import { render as renderToString } from ' rapscallion ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> / / import { addLocaleData } from ' react - intl ' <nl> @ @ - 16 , 16 + 16 , 16 @ @ import assets from ' webpack - assets ' <nl> import faviconsAssets from ' favicons - assets ' <nl> import getI18nData from ' server / i18n ' <nl> - export default ( req : express $ Request , res : express $ Response ) = > { <nl> - const { isLoggedIn , lang } = req . user <nl> + export default async ( req : express $ Request , res : express $ Response ) = > { <nl> + const { isLoggedIn , language } = req . user <nl> const { isMobile } = req . useragent <nl> - console . log ( chalk . cyan ( ` MOBILE DEVICE : $ { isMobile } ` , JSON . stringify ( req . useragent ) , lang ) ) <nl> + console . log ( chalk . cyan ( ` MOBILE DEVICE : $ { isMobile } ` ) ) <nl> const meState = { auth : { isLoggedIn } } <nl> const layoutState = { isMobile } <nl> const initialState : Object = isLoggedIn <nl> ? { me : meState , layout : layoutState } <nl> : { layout : layoutState } <nl> - const i18n = getI18nData ( lang ) <nl> + const i18n = getI18nData ( language ) <nl> const sheet = new ServerStyleSheet ( ) <nl> const location : string = req . url <nl> const context = { } <nl> @ @ - 37 , 11 + 37 , 11 @ @ export default ( req : express $ Request , res : express $ Response ) = > { <nl> i18n , <nl> SSR : { location , context } <nl> } ) <nl> - const App : string = renderToString ( <nl> + const App : string = await renderToString ( <nl> < StyleSheetManager sheet = { sheet . instance } > <nl> { RootComponent } <nl> < / StyleSheetManager > <nl> - ) <nl> + ) . toPromise ( ) <nl> const css : string = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> const props = { <nl> @ @ - 53 , 6 + 53 , 9 @ @ export default ( req : express $ Request , res : express $ Response ) = > { <nl> App <nl> } <nl> - const html : string = HtmlComponent ( props ) <nl> - res . send ( html ) <nl> + res . writeHead ( 200 , { <nl> + ' Content - Type ' : ' text / html ' <nl> + } ) <nl> + <nl> + HtmlComponent ( props ) . toStream ( ) . pipe ( res ) <nl> } <nl> 
mmm a / src / server / ssr / HtmlComponent . jsx <nl> ppp b / src / server / ssr / HtmlComponent . jsx <nl> import serealize from ' serialize - javascript ' <nl> - <nl> + import { template } from ' rapscallion ' <nl> type args = { <nl> css : string , <nl> App : string , <nl> @ @ - 29 , 29 + 29 , 28 @ @ const HtmlComponent = ( { <nl> const stringifiedState : string = serealize ( initialState ) <nl> const stringifiedI18N : string = serealize ( i18n ) <nl> const safeStringifiedState : string = stringifiedState . replace ( / < / g , ' \ \ u003c ' ) <nl> - <nl> - const createBody = ( ) = > { <nl> - const html = ` <nl> - < div id = " app " > $ { App } < / div > <nl> - < script > window . __INITIAL_STATE__ = $ { safeStringifiedState } < / script > <nl> - < script > window . __I18N__ = $ { stringifiedI18N } < / script > <nl> - $ { DLLScripts } <nl> - $ { Object . keys ( assets ) <nl> - . filter ( bundleName = > assets [ bundleName ] . js ) <nl> + const wrapFuncs = { <nl> + css : ( { path } ) = > ` < link rel = " stylesheet " href = " $ { path } " / > ` , <nl> + js : ( { path } ) = > ` < script src = " $ { path } " type = " text / javascript " > < / script > ` <nl> + } <nl> + const getTags = assets = > funcs = > ext = > { <nl> + const assetsOrdered = [ ' manifest ' , ' vendor ' , ' client ' ] <nl> + return Object . keys ( assets ) <nl> + . filter ( bundleName = > assets [ bundleName ] [ ext ] ) <nl> + . sort ( ( a , b ) = > assetsOrdered . indexOf ( a ) > assetsOrdered . indexOf ( b ) ) <nl> . map ( bundleName = > { <nl> - const path = assets [ bundleName ] . js <nl> - return ` < script src = " $ { path } " type = " text / javascript " > < / script > ` <nl> + const path = assets [ bundleName ] [ ext ] <nl> + return funcs [ ext ] ( { path } ) <nl> } ) <nl> - . join ( ' ' ) } <nl> - < noscript > <nl> - You are using outdated browser . You can install modern browser here : { ' ' } <nl> - < a href = " http : / / outdatedbrowser . com / " > http : / / outdatedbrowser . com < / a > . <nl> - < / noscript > ` <nl> - return html <nl> + . join ( ' ' ) <nl> } <nl> + const getTagsFromAssets = getTags ( assets ) ( wrapFuncs ) <nl> + const cssTags = getTagsFromAssets ( ' css ' ) <nl> + const jsTags = getTagsFromAssets ( ' js ' ) <nl> - const createHead = ( ) = > { <nl> - const html = ` <nl> + return template ` <nl> + < html lang = " $ { i18n . lang } " > <nl> + < head > <nl> < meta charset = " utf - 8 " / > <nl> < title > Noir < / title > <nl> < meta httpEquiv = " X - UA - Compatible " content = " IE = edge , chrome = 1 " / > <nl> @ @ - 63 , 22 + 62 , 20 @ @ const HtmlComponent = ( { <nl> < base href = " / " / > <nl> < meta name = " msapplication - tap - highlight " content = " no " / > <nl> < link rel = " manifest " href = " manifest . json " / > <nl> - $ { faviconsAssets . html & & faviconsAssets . html . join ( ' ' ) } <nl> + $ { faviconsAssets & & faviconsAssets . html & & faviconsAssets . html . join ( ' ' ) } <nl> $ { css } <nl> - $ { Object . keys ( assets ) <nl> - . filter ( bundleName = > assets [ bundleName ] . css ) <nl> - . map ( bundleName = > { <nl> - const path = assets [ bundleName ] . css <nl> - return ` < link rel = " stylesheet " href = " $ { path } " / > ` <nl> - } ) <nl> - . join ( ' ' ) } ` <nl> - return html <nl> - } <nl> - <nl> - return ` < html lang = " $ { i18n . lang } " > <nl> - < head > $ { createHead ( ) } < head > <nl> + $ { cssTags } <nl> + < head > <nl> < body > <nl> - $ { createBody ( ) } <nl> + < div id = " app " > $ { App } < / div > <nl> + < script > window . __INITIAL_STATE__ = $ { safeStringifiedState } < / script > <nl> + < script > window . __I18N__ = $ { stringifiedI18N } < / script > <nl> + $ { DLLScripts } <nl> + $ { jsTags } <nl> + < noscript > <nl> + You are using outdated browser . You can install modern browser here : <nl> + < a href = " http : / / outdatedbrowser . com / " > http : / / outdatedbrowser . com < / a > . <nl> + < / noscript > <nl> < / body > <nl> < / html > ` <nl> } <nl> 
mmm a / src / server / index . js <nl> ppp b / src / server / index . js <nl> * / <nl> import express from ' express ' <nl> + import http from ' http ' <nl> import spdy from ' spdy ' <nl> import chalk from ' chalk ' <nl> - / / <nl> + / / Mount our server - side code to server <nl> import server from ' . / server ' <nl> import { serverOptions as options } from ' . / config ' <nl> + <nl> const app : express $ Application = express ( ) <nl> - const PORT : number = + process . env . PORT | | 3000 <nl> + const httpsPORT : number = + process . env . PORT | | 3030 <nl> + const httpPORT : number = + process . env . PORT | | 3000 <nl> + <nl> + server ( app ) <nl> - const decoratedProductionServer = server ( app ) <nl> + spdy . createServer ( options , app ) . listen ( httpsPORT , ( ) = > { <nl> + console . log ( <nl> + chalk . red ( ` HTTPS SERVER IS LISTENING ON https : / / 127 . 0 . 0 . 1 : $ { httpsPORT } ` ) <nl> + ) <nl> + } ) <nl> - spdy . createServer ( options , decoratedProductionServer ) . listen ( PORT , ( ) = > { <nl> - console . log ( chalk . green ( ` SERVER IS LISTENING ON $ { PORT } ` ) ) <nl> + http . createServer ( app ) . listen ( httpPORT , ( ) = > { <nl> + console . log ( <nl> + chalk . green ( ` HTTP SERVER IS LISTENING ON http : / / localhost : $ { httpPORT } ` ) <nl> + ) <nl> } ) <nl> 
mmm a / . babelrc <nl> ppp b / . babelrc <nl> { <nl> " helpers " : false , <nl> - " polyfill " : false , <nl> + " polyfill " : true , <nl> " regenerator " : true , <nl> " moduleName " : " babel - runtime " <nl> } <nl> } <nl> } <nl> ] , <nl> - " es2015 " , <nl> " stage - 1 " , <nl> " react " , <nl> " flow " <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import chalk from ' chalk ' <nl> / / import _ from ' lodash ' <nl> - import { render as renderToString } from ' rapscallion ' <nl> + import { renderToNodeStream , renderToStaticNodeStream } from ' react - dom / server ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> / / import { addLocaleData } from ' react - intl ' <nl> @ @ - 37 , 11 + 37 , 12 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> i18n , <nl> SSR : { location , context } <nl> } ) <nl> - const App : string = await renderToString ( <nl> + const stream = renderToNodeStream ( <nl> < StyleSheetManager sheet = { sheet . instance } > <nl> { RootComponent } <nl> < / StyleSheetManager > <nl> - ) . toPromise ( ) <nl> + ) <nl> + <nl> const css : string = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> const props = { <nl> @ @ - 49 , 13 + 50 , 18 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> assets , <nl> faviconsAssets , <nl> initialState : preloadedState , <nl> - i18n , <nl> - App <nl> + i18n <nl> } <nl> + const { beforeAppTag , afterAppTag } = HtmlComponent ( props ) <nl> res . writeHead ( 200 , { <nl> ' Content - Type ' : ' text / html ' <nl> } ) <nl> + res . write ( beforeAppTag ) <nl> + stream . pipe ( res , { end : false } ) <nl> - HtmlComponent ( props ) . toStream ( ) . pipe ( res ) <nl> + stream . on ( ' end ' , ( ) = > { <nl> + res . write ( afterAppTag ) <nl> + res . end ( ) <nl> + } ) <nl> } <nl> 
mmm a / src / server / ssr / HtmlComponent . jsx <nl> ppp b / src / server / ssr / HtmlComponent . jsx <nl> import serealize from ' serialize - javascript ' <nl> - import { template } from ' rapscallion ' <nl> type args = { <nl> css : string , <nl> - App : string , <nl> initialState : Object , <nl> assets : Object , <nl> faviconsAssets : Object , <nl> @ @ - 20 , 7 + 18 , 6 @ @ const DLLScripts = <nl> const HtmlComponent = ( { <nl> css , <nl> - App , <nl> initialState , <nl> assets , <nl> faviconsAssets , <nl> @ @ - 34 , 10 + 31 , 11 @ @ const HtmlComponent = ( { <nl> js : ( { path } ) = > ` < script src = " $ { path } " type = " text / javascript " > < / script > ` <nl> } <nl> const getTags = assets = > funcs = > ext = > { <nl> + / / sort assets to be injected in right order <nl> const assetsOrdered = [ ' manifest ' , ' vendor ' , ' client ' ] <nl> return Object . keys ( assets ) <nl> . filter ( bundleName = > assets [ bundleName ] [ ext ] ) <nl> - . sort ( ( a , b ) = > assetsOrdered . indexOf ( a ) > assetsOrdered . indexOf ( b ) ) <nl> + . sort ( ( a , b ) = > assetsOrdered . indexOf ( a ) - assetsOrdered . indexOf ( b ) ) <nl> . map ( bundleName = > { <nl> const path = assets [ bundleName ] [ ext ] <nl> return funcs [ ext ] ( { path } ) <nl> @ @ - 48 , 8 + 46 , 8 @ @ const HtmlComponent = ( { <nl> const cssTags = getTagsFromAssets ( ' css ' ) <nl> const jsTags = getTagsFromAssets ( ' js ' ) <nl> - return template ` <nl> - < html lang = " $ { i18n . lang } " > <nl> + return { <nl> + beforeAppTag : ` < html lang = " $ { i18n . lang } " > <nl> < head > <nl> < meta charset = " utf - 8 " / > <nl> < title > Noir < / title > <nl> @ @ - 66 , 8 + 64 , 8 @ @ const HtmlComponent = ( { <nl> $ { css } <nl> $ { cssTags } <nl> < head > <nl> - < body > <nl> - < div id = " app " > $ { App } < / div > <nl> + < body > ` , <nl> + afterAppTag : ` <nl> < script > window . __INITIAL_STATE__ = $ { safeStringifiedState } < / script > <nl> < script > window . __I18N__ = $ { stringifiedI18N } < / script > <nl> $ { DLLScripts } <nl> @ @ - 79 , 5 + 77 , 6 @ @ const HtmlComponent = ( { <nl> < / body > <nl> < / html > ` <nl> } <nl> + } <nl> export default HtmlComponent <nl> 
mmm a / src / common / components / parts / Header / index . jsx <nl> ppp b / src / common / components / parts / Header / index . jsx <nl> * / <nl> import React , { Component } from ' react ' <nl> - import { Icon , Dropdown , Flag } from ' semantic - ui - react ' <nl> + import { Icon } from ' semantic - ui - react ' <nl> import { isEqual } from ' lodash ' <nl> / / import { FormattedMessage } from ' react - intl ' <nl> import { <nl> @ @ - 30 , 41 + 30 , 19 @ @ class Header extends Component { <nl> render ( ) { <nl> const { title , toggleSidebar , isLoggedIn , isMobile } = this . props <nl> - const options = [ { key : 1 , text : ' EN ' } , { key : 2 , text : ' RU ' } ] <nl> - const selectedLanguage = { <nl> - text : ' ru ' , <nl> - icon : ' ru ' <nl> - } <nl> return ( <nl> < Headroom > <nl> < StyledHeader > <nl> < HeaderInner > <nl> { isLoggedIn & & <nl> - isMobile & & <nl> + isMobile & & ( <nl> < Navicon onClick = { toggleSidebar } > <nl> < Icon name = " content " / > <nl> - < / Navicon > } <nl> - < PageTitle > <nl> - { title } <nl> - < / PageTitle > <nl> + < / Navicon > <nl> + ) } <nl> + < PageTitle > { title } < / PageTitle > <nl> < Spacer / > <nl> - < Dropdown <nl> - text = { selectedLanguage . text } <nl> - icon = { < Flag name = " ru " / > } <nl> - floating <nl> - labeled <nl> - button <nl> - className = " icon " <nl> - > <nl> - < Dropdown . Menu > <nl> - < Dropdown . Header icon = " globe " content = " Select Language " / > <nl> - < Dropdown . Divider / > <nl> - < Dropdown . Item flag = " us " text = " EN " / > <nl> - < Dropdown . Item flag = " ru " text = " RU " / > <nl> - < / Dropdown . Menu > <nl> - < / Dropdown > <nl> - { / * < Flag name = " " / > * / } <nl> < / HeaderInner > <nl> < / StyledHeader > <nl> < / Headroom > <nl> 
mmm a / src / server / middlewares / auth . js <nl> ppp b / src / server / middlewares / auth . js <nl> import chalk from ' chalk ' <nl> import jwt from ' jsonwebtoken ' <nl> + import { supportedLanguages , defaultLanguage } from ' . . / i18n ' <nl> import { JWT_TOKEN } from ' common / api / LocalStorageCookiesSvc ' <nl> / * * <nl> * Auth - related middleware . <nl> @ @ - 11 , 10 + 12 , 15 @ @ import { JWT_TOKEN } from ' common / api / LocalStorageCookiesSvc ' <nl> * @ param { Response } res <nl> * @ param { Function } next <nl> * / <nl> - export default ( req : express $ Request , res : express $ Response , next : ( ) = > void ) = > { <nl> + export default ( <nl> + req : express $ Request , <nl> + res : express $ Response , <nl> + next : ( ) = > void <nl> + ) = > { <nl> + const language : string = req . acceptsLanguages ( supportedLanguages ) | | defaultLanguage <nl> req . user = { <nl> token : null , <nl> - lang : ' en ' , <nl> + language , <nl> isLoggedIn : false <nl> } <nl> @ @ - 23 , 15 + 29 , 17 @ @ export default ( req : express $ Request , res : express $ Response , next : ( ) = > void ) = <nl> return next ( ) <nl> } <nl> - console . log ( chalk . blue ( ' USER HAS TOKEN ' ) ) <nl> + console . log ( chalk . blue ( ' USER HAS JWT TOKEN ' ) ) <nl> jwt . verify ( token , process . env . JWT_SECRET , ( err , decoded ) = > { <nl> if ( err ) { <nl> console . log ( chalk . red ( ' CANT DECODE JWT TOKEN ! ' , err ) ) <nl> } else { <nl> console . log ( chalk . magenta ( ' TOKEN SUCCESSFULLY DECODED ' ) ) <nl> + / / NOTE : set user language in jwt token that may helps handling i18n efficiently <nl> + const { username } = decoded <nl> req . user = { <nl> - . . . decoded , <nl> token , <nl> + username , <nl> isLoggedIn : true <nl> } <nl> } <nl> 
mmm a / locals / en . json <nl> ppp b / locals / en . json <nl> - " Header . Popup . HeaderButton " : " Hello { name } " <nl> + " Dashboard . Text " : " Hello HELLOOOO " <nl> } <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> JWT_SECRET , <nl> ANALYZE_BUNDLE , <nl> SENTRY_DSN , <nl> - PORT <nl> + HTTP_PORT , <nl> + HTTPS_PORT <nl> } = process . env <nl> / / Vars for both server and frontend <nl> @ @ - 29 , 7 + 30 , 8 @ @ const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> / / Vars for server only <nl> const CLIENT_DIST_PATH = path . join ( distPath , ' . / client ' ) / / = " / dist / client " <nl> JWT_SECRET = JWT_SECRET | | ' secret ' <nl> - PORT = PORT | | 3000 <nl> + HTTP_PORT = HTTP_PORT | | 3000 <nl> + HTTPS_PORT = HTTPS_PORT | | 3030 <nl> / / compute isProduction based on NODE_ENV <nl> const isProduction = process . env . NODE_ENV = = = ' production ' <nl> @ @ - 48 , 7 + 50 , 8 @ @ export default { <nl> CLIENT_DIST_PATH , <nl> JWT_SECRET , <nl> SENTRY_DSN , <nl> - PORT , <nl> + HTTPS_PORT , <nl> + HTTP_PORT , <nl> / / It ' s better to define pathes in one file <nl> / / and then use everywhere across app <nl> srcPath , <nl> @ @ - 76 , 7 + 79 , 8 @ @ export default { <nl> ' js - cookie ' , <nl> ' prop - types ' , <nl> ' store2 ' , <nl> - ' styled - components ' <nl> + ' styled - components ' , <nl> + ' react - headroom ' <nl> ] , <nl> polyfills : [ ' promise - polyfill ' , ' isomorphic - fetch ' ] <nl> } <nl> 
mmm a / locals / en . json <nl> ppp b / locals / en . json <nl> - " Dashboard . Text " : " Hello HELLOOOO " <nl> + " Dashboard . h1 " : " Noir . " , <nl> + " Dashboard . h2 - 1 " : " Intro " , <nl> + " Dashboard . h2 - 2 " : " How it works ? " , <nl> + " Dashboard . h3 - 1 " : " Hello , this is Noir . " , <nl> + " Dashboard . h3 - 2 " : " Hello , this is Noir . " , <nl> + " Dashboard . p - 1 " : " How it works ? " , <nl> + " Dashboard . p - 2 " : " Hello , this is Noir . " <nl> } <nl> 
mmm a / src / client / index . jsx <nl> ppp b / src / client / index . jsx <nl> import ' semantic - ui - css / components / grid . css ' <nl> import ' semantic - ui - css / components / header . css ' <nl> import ' semantic - ui - css / components / form . css ' <nl> - import ' semantic - ui - css / components / item . css ' <nl> import ' semantic - ui - css / components / icon . css ' <nl> import ' semantic - ui - css / components / image . css ' <nl> import ' semantic - ui - css / components / input . css ' <nl> import ' semantic - ui - css / components / menu . css ' <nl> import ' semantic - ui - css / components / label . css ' <nl> + import ' semantic - ui - css / components / list . css ' <nl> import ' semantic - ui - css / components / loader . css ' <nl> import ' semantic - ui - css / components / reset . css ' <nl> import ' semantic - ui - css / components / sidebar . css ' <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import React from ' react ' <nl> import chalk from ' chalk ' <nl> - / / import _ from ' lodash ' <nl> - import { renderToNodeStream , renderToStaticNodeStream } from ' react - dom / server ' <nl> + import { renderToNodeStream } from ' react - dom / server ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> - / / import { addLocaleData } from ' react - intl ' <nl> import HtmlComponent from ' . / HtmlComponent ' <nl> / / $ FlowFixMe <nl> import assets from ' webpack - assets ' <nl> @ @ - 58 , 9 + 56 , 11 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> ' Content - Type ' : ' text / html ' <nl> } ) <nl> res . write ( beforeAppTag ) <nl> + res . write ( ` < div id = " app " > ` ) <nl> stream . pipe ( res , { end : false } ) <nl> stream . on ( ' end ' , ( ) = > { <nl> + res . write ( ' < / div > ' ) <nl> res . write ( afterAppTag ) <nl> res . end ( ) <nl> } ) <nl> 
mmm a / src / server / i18n / index . js <nl> ppp b / src / server / i18n / index . js <nl> import path from ' path ' <nl> import { sync as globSync } from ' glob ' <nl> + import chokidar from ' chokidar ' <nl> / / import { addLocaleData } from ' react - intl ' <nl> import enLocaleData from ' react - intl / locale - data / en ' <nl> import ruLocaleData from ' react - intl / locale - data / ru ' <nl> import type { i18nConfigObject } from ' types ' <nl> - const translations = globSync ( ' locals / * . json ' ) <nl> + const getTranslations = ( ) = > { <nl> + return globSync ( ' locals / * . json ' ) <nl> . map ( ( filename : string ) = > [ <nl> path . basename ( filename , ' . json ' ) , <nl> readFileSync ( filename , ' utf8 ' ) <nl> @ @ - 17 , 6 + 19 , 17 @ @ const translations = globSync ( ' locals / * . json ' ) <nl> acc [ locale ] = messages <nl> return acc <nl> } , { } ) <nl> + } <nl> + <nl> + let translations = getTranslations ( ) <nl> + if ( process . env . NODE_ENV = = = ' development ' ) { <nl> + / / re - update locals if they were changed ( in development ) <nl> + const watcher = chokidar . watch ( ' locals / * . json ' ) <nl> + <nl> + watcher . on ( ' all ' , ( ) = > { <nl> + translations = getTranslations ( ) <nl> + } ) <nl> + } <nl> export const defaultLanguage = ' en ' <nl> export const supportedLanguages = [ ' en ' , ' ru ' ] <nl> 
mmm a / src / server / config / index . js <nl> ppp b / src / server / config / index . js <nl> import { readFileSync } from ' fs ' <nl> / / If you want quick SSL for prototyping : <nl> - / / import pseudossl from ' pseudossl ' <nl> + / / NOTE : you should use own SSL certs in production ! <nl> + let key = ' ' <nl> + let cert = ' ' <nl> + <nl> + <nl> + if ( process . env . NODE_ENV = = = ' development ' ) { <nl> + / / REMOVE THESE LINES IF YOU HAVE VALID CERT AND KEY FOR DEVELOPMENT <nl> + const pseudossl = require ( ' pseudossl ' ) <nl> + key = pseudossl . key <nl> + cert = pseudossl . cert <nl> + } else { <nl> + key = readFileSync ( path . join ( __dirname , ' . / ssl / server . key ' ) ) <nl> + cert = readFileSync ( path . join ( __dirname , ' . / ssl / server . crt ' ) ) <nl> + } <nl> export const serverOptions = { <nl> - key : readFileSync ( path . join ( __dirname , ' . / ssl / server . key ' ) ) , <nl> - cert : readFileSync ( path . join ( __dirname , ' . / ssl / server . crt ' ) ) <nl> + key , <nl> + cert <nl> } <nl> 
mmm a / src / common / types / index . js <nl> ppp b / src / common / types / index . js <nl> - export type PostItem = { <nl> - title : string , <nl> - body : string , <nl> - userId : number , <nl> - id : number <nl> - } <nl> - <nl> - export type UserItem = { <nl> - id : number , <nl> - name : string , <nl> - username : string , <nl> - email : string , <nl> - address : { <nl> - street : string , <nl> - suite : string , <nl> - city : string , <nl> - zipcode : string , <nl> - geo : { <nl> - lat : string , <nl> - lng : string <nl> - } <nl> - } , <nl> - phone : string , <nl> - website : string , <nl> - company : { <nl> - name : string , <nl> - catchPhrase : string , <nl> - bs : string <nl> - } <nl> + export type LinkItem = { <nl> + link : string , <nl> + header : string , <nl> + desc : string , <nl> + icon : string <nl> } <nl> export type RouteItem = { <nl> 
mmm a / src / common / styles / base . jsx <nl> ppp b / src / common / styles / base . jsx <nl> - export const TextCenter = styled . div ` text - align : center ; ` <nl> - <nl> - export const Hidden = elem = > { <nl> - return styled ( elem ) ` <nl> - display : none ; <nl> - ` <nl> - } <nl> - <nl> export const Spacer = styled . span ` flex - grow : 1 ; ` <nl> 
mmm a / src / common / styles / utils . jsx <nl> ppp b / src / common / styles / utils . jsx <nl> } <nl> const iWantToUseEm = true <nl> + / / NOTE : This grid don ' t match SUI ' s grid . <nl> + / / NOTE : RSUI has < Responsive > element ! <nl> + / / You might don ' t need media template function for styled - components <nl> const sizes = _ . mapValues ( <nl> { <nl> xs : 0 , / / Extra small screen / phone <nl> @ @ - 15 , 13 + 18 , 13 @ @ const sizes = _ . mapValues ( <nl> xl : 1200 / / Extra large screen / wide desktop <nl> } , <nl> ( value , key ) = > { <nl> - / / NOTE : Please , read more about ` em ` , before switching to it <nl> + / / NOTE : Please , read more about ` em ` before switching <nl> / / https : / / stackoverflow . com / questions / 22228568 / switching - to - em - based - media - queries <nl> return iWantToUseEm ? pxToEm ( value ) : value + ' px ' <nl> } <nl> ) <nl> - / / FIXME : @ Metnew : dirty - hardcode version of media template ! <nl> + / / FIXME : @ Metnew : this block may be rewritten more elegant ( like the code below , from off docs ) <nl> export const media = { <nl> xs : ( . . . args ) = > css ` <nl> @ media only screen and ( max - width : $ { sizes . sm } ) { <nl> @ @ - 66 , 6 + 69 , 7 @ @ export const media = { <nl> } <nl> / / NOTE : from official docs , but it looks like a black - voodoo - magic <nl> + / / # # # # <nl> / / / / iterate through the sizes and create a media template <nl> / / export const media = Object . keys ( sizes ) . reduce ( ( accumulator , label , i ) = > { <nl> / / console . log ( accumulator , label ) <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> import { Route } from ' react - router - dom ' <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> + import Dashboard from ' containers / Dashboard ' <nl> + import Links from ' containers / Links ' <nl> + import Login from ' containers / Login ' <nl> import type { RouteItem } from ' types ' <nl> const loadLazyComponentFnConstructor = ( url : string ) = > async ( ) = > { <nl> @ @ - 14 , 26 + 17 , 25 @ @ const loadLazyComponentFnConstructor = ( url : string ) = > async ( ) = > { <nl> return loadComponent <nl> } <nl> + / / FIXME : sidebar routes and app routes should be separated ! <nl> const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / ' , <nl> exact : true , <nl> - lazy : true , <nl> icon : ' newspaper ' , <nl> name : ' Dashboard ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : loadLazyComponentFnConstructor ( ' Dashboard ' ) <nl> + component : Dashboard <nl> } , <nl> { <nl> - path : ' / users ' , <nl> - name : ' Users ' , <nl> + path : ' / links ' , <nl> + name : ' Links ' , <nl> exact : true , <nl> - lazy : true , <nl> - icon : ' users ' , <nl> + icon : ' bookmark ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : loadLazyComponentFnConstructor ( ' Users ' ) <nl> + component : Links <nl> } , <nl> { <nl> external : true , <nl> @ @ - 45 , 17 + 47 , 8 @ @ const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / auth ' , <nl> name : ' Auth ' , <nl> - lazy : true , <nl> tag : Route , <nl> - component : loadLazyComponentFnConstructor ( ' Login ' ) <nl> - } , <nl> - { <nl> - path : ' / users / : id ' , <nl> - name : ' User ' , <nl> - lazy : true , <nl> - exact : true , <nl> - tag : RouteAuth , <nl> - component : loadLazyComponentFnConstructor ( ' UserItem ' ) <nl> + component : Login <nl> } <nl> ] <nl> 
mmm a / src / common / reducers / index . js <nl> ppp b / src / common / reducers / index . js <nl> import type { State as AuthState } from ' reducers / auth ' <nl> import type { State as LayoutState } from ' reducers / layout ' <nl> - import type { State as EntitiesPostsState } from ' reducers / posts ' <nl> - import type { State as EntitiesUsersState } from ' reducers / users ' <nl> + import type { State as EntitiesLinksState } from ' reducers / links ' <nl> import { layout } from ' . / layout ' <nl> - import { posts } from ' . / posts ' <nl> - import { users } from ' . / users ' <nl> + import { links } from ' . / links ' <nl> import { auth } from ' . / auth ' <nl> / / Root reducer <nl> @ @ - 17 , 12 + 15 , 11 @ @ export default combineReducers ( { <nl> layout , <nl> me : combineReducers ( { auth } ) , <nl> entities : combineReducers ( { <nl> - posts , <nl> - users <nl> + links <nl> } ) , <nl> routing : routerReducer <nl> } ) <nl> export type GlobalState = { layout : LayoutState } & { me : { auth : AuthState } } & { <nl> - entities : { posts : EntitiesPostsState , users : EntitiesUsersState } <nl> + entities : { links : EntitiesLinksState } <nl> } <nl> 
mmm a / src / common / containers / Dashboard / index . jsx <nl> ppp b / src / common / containers / Dashboard / index . jsx <nl> import React , { Component } from ' react ' <nl> import { connect } from ' react - redux ' <nl> - import { Loader } from ' semantic - ui - react ' <nl> import { Helmet } from ' react - helmet ' <nl> - / / <nl> import DashboardComponent from ' . / components ' <nl> - import { GET_POSTS } from ' actions / posts ' <nl> - import { getEntitiesPostsState } from ' selectors ' <nl> + <nl> import type { GlobalState } from ' reducers ' <nl> - type Props = { <nl> - posts : Object , <nl> - postsLoaded : boolean , <nl> - postsLoading : boolean , <nl> - count : number , <nl> - getPosts : ( ) = > void <nl> - } <nl> + type Props = any <nl> class Dashboard extends Component { <nl> props : Props <nl> - componentDidMount ( ) { <nl> - this . props . getPosts ( ) <nl> - } <nl> - <nl> render ( ) { <nl> - const { posts , postsLoaded , postsLoading , count } = this . props <nl> return ( <nl> < div > <nl> < Helmet > <nl> < title > Noir : Dashboard < / title > <nl> < / Helmet > <nl> - { postsLoaded <nl> - ? < DashboardComponent <nl> - { . . . { posts , postsLoaded , postsLoading , count } } <nl> - / > <nl> - : < Loader active > Loading . . . < / Loader > } <nl> + < DashboardComponent / > <nl> < / div > <nl> ) <nl> } <nl> } <nl> function mapStateToProps ( state : GlobalState ) { <nl> - const postsState = getEntitiesPostsState ( state ) <nl> - const postsLoaded = postsState . isLoaded <nl> - const postsLoading = postsState . isLoading <nl> - const posts = postsState . entities <nl> - const { count } = postsState <nl> - return { <nl> - posts , <nl> - postsLoading , <nl> - postsLoaded , <nl> - count <nl> - } <nl> + return { } <nl> } <nl> function mapDispatchToProps ( dispatch ) { <nl> - return { <nl> - getPosts ( ) { <nl> - dispatch ( GET_POSTS ( ) ) <nl> - } <nl> - } <nl> + return { } <nl> } <nl> export default connect ( mapStateToProps , mapDispatchToProps ) ( Dashboard ) <nl> 
mmm a / src / common / containers / Dashboard / components / index . jsx <nl> ppp b / src / common / containers / Dashboard / components / index . jsx <nl> import React , { Component } from ' react ' <nl> - import { Card , Grid } from ' semantic - ui - react ' <nl> - import _ from ' lodash ' <nl> - import DashboardCardComponent from ' . / DashboardCardComponent ' <nl> - import type { PostItem } from ' types ' <nl> - <nl> - type Props = { <nl> - posts : Object , <nl> - postsLoaded : boolean , <nl> - postsLoading : boolean , <nl> - count : number <nl> - } <nl> + import { Grid , Header } from ' semantic - ui - react ' <nl> + import { FormattedMessage } from ' react - intl ' <nl> export default class DashboardComponent extends Component { <nl> - props : Props <nl> - <nl> - shouldComponentUpdate ( nextProps : Props ) { <nl> - const { posts } = this . props <nl> - const nextPosts = nextProps . posts <nl> - return ! _ . isEqual ( posts , nextPosts ) <nl> - } <nl> - <nl> render ( ) { <nl> - const { posts , postsLoaded } = this . props <nl> - <nl> return ( <nl> < Grid columns = { 1 } > <nl> < Grid . Row centered > <nl> < Grid . Column width = { 16 } > <nl> - { postsLoaded & & <nl> - < Card . Group itemsPerRow = { 3 } doubling stackable > <nl> - { _ . map ( posts , ( post : PostItem , i ) = > <nl> - < DashboardCardComponent { . . . post } key = { i } / > <nl> - ) } <nl> - < / Card . Group > } <nl> + < Header as = " h1 " > <nl> + < FormattedMessage id = " Dashboard . h1 " / > <nl> + < / Header > <nl> + < Header as = " h2 " > <nl> + < FormattedMessage id = " Dashboard . h2 - 1 " / > <nl> + < / Header > <nl> + < p > <nl> + < FormattedMessage id = " Dashboard . p - 1 " / > <nl> + < / p > <nl> + < Header as = " h2 " > <nl> + < FormattedMessage id = " Dashboard . h2 - 2 " / > <nl> + < / Header > <nl> + < p > <nl> + < FormattedMessage id = " Dashboard . p - 2 " / > <nl> + < / p > <nl> < / Grid . Column > <nl> < / Grid . Row > <nl> < / Grid > <nl> 
mmm a / src / server / api / links . json <nl> ppp b / src / server / api / links . json <nl> " header " : " SSR + Webpack ( in development ) " , <nl> " desc " : <nl> - " Step by step guide with working example of hot - reloaded server and client with SSR with Webpack in development . " <nl> + " Step by step guide with working example of server and client with hot - reloading and SSR with Webpack ( in development ) . " <nl> } , <nl> { <nl> - " link " : " https : / / github . com / Metnew / tiny - universal - example " , <nl> + " link " : " https : / / github . com / Metnew / noir " , <nl> " icon " : " bug " , <nl> - " header " : " How to test actions and reducers ? " , <nl> - " desc " : " How to test actions and reducers ? " <nl> + " header " : " Testing " , <nl> + " desc " : " How to test actions , reducers , components ? " <nl> } , <nl> { <nl> " link " : " https : / / github . com / Metnew / noir " , <nl> " icon " : " paint brush " , <nl> - " header " : " Why semantic - ui - react ? " <nl> + " header " : " Why semantic - ui - react ? " , <nl> + " desc " : " Notes about SUI . Why SUIR is a good ( or bad ) choise . " <nl> } , <nl> { <nl> " link " : " " , <nl> " icon " : " globe " , <nl> " header " : " How i18n works ? " , <nl> - " desc " : " i18n configuration and how to customize it in own project " <nl> + " desc " : " How i18n is implemented and how to customize it . " <nl> } , <nl> { <nl> " header " : " How Webpack is configured ? " , <nl> " icon " : " code " , <nl> " link " : " " , <nl> " desc " : <nl> - " Webpack configuration for server / client in production and development " <nl> + " Webpack configuration for server / client in production and development . " <nl> } , <nl> { <nl> " link " : " " , <nl> " icon " : " terminal " , <nl> - " header " : " npm scripts " , <nl> - " desc " : " npm scripts under the hood and ENV vars " <nl> + " header " : " npm scripts and ENV vars " , <nl> + " desc " : " Docs about every npm script and ENV variable . " <nl> } , <nl> { <nl> " link " : " " , <nl> " icon " : " folder " , <nl> " header " : " Folder structure " , <nl> - " desc " : " Why this folder structure and how to adapt it for own project " <nl> + " desc " : " Why this folder structure and how to adapt it in own project . " <nl> } <nl> ] <nl> 
mmm a / jest_config / setupJest . js <nl> ppp b / jest_config / setupJest . js <nl> + import { configure } from ' enzyme ' <nl> + import Adapter from ' enzyme - adapter - react - 16 ' <nl> global . fetch = require ( ' isomorphic - fetch ' ) <nl> process . env . BASE_API = process . env . BASE_API | | ' http : / / localhost : 4000 / api / v1 ' <nl> process . env . BROWSER = false <nl> + <nl> + const adapter = new Adapter ( ) <nl> + configure ( { adapter } ) <nl> 
mmm a / src / common / components / parts / Header / index . jsx <nl> ppp b / src / common / components / parts / Header / index . jsx <nl> * @ flow <nl> * / <nl> - import React , { Component } from ' react ' <nl> + import React from ' react ' <nl> import { Icon } from ' semantic - ui - react ' <nl> - import { isEqual } from ' lodash ' <nl> / / import { FormattedMessage } from ' react - intl ' <nl> import { <nl> StyledHeader , <nl> @ @ - 22 , 15 + 21 , 7 @ @ type Props = { <nl> isMobile : boolean <nl> } <nl> - class Header extends Component { <nl> - props : Props <nl> - shouldComponentUpdate ( nextProps : Props ) { <nl> - return ! isEqual ( nextProps , this . props ) <nl> - } <nl> - <nl> - render ( ) { <nl> - const { title , toggleSidebar , isLoggedIn , isMobile } = this . props <nl> - <nl> + const Header = ( { title , toggleSidebar , isLoggedIn , isMobile } : Props ) = > { <nl> return ( <nl> < Headroom > <nl> < StyledHeader > <nl> @ @ - 48 , 6 + 39 , 5 @ @ class Header extends Component { <nl> < / Headroom > <nl> ) <nl> } <nl> - } <nl> export default Header <nl> 
mmm a / src / common / components / addons / RouteAuth / index . test . jsx <nl> ppp b / src / common / components / addons / RouteAuth / index . test . jsx <nl> + import { Route , Redirect } from ' react - router - dom ' <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> import { shallow } from ' enzyme ' <nl> - import toJson from ' enzyme - to - json ' <nl> import { routes as routing } from ' routing ' <nl> const accessToInboxOnly = path = > { <nl> @ @ - 13 , 25 + 13 , 24 @ @ const accessExceptInbox = path = > { <nl> const sampleRouteItem = routing . filter ( a = > a . component & & a . tag ) [ 0 ] <nl> - xdescribe ( ' RouteAuth component ' , ( ) = > { <nl> - it ( ' creates < Redirect / > if user dont have access ' , done = > { <nl> + describe ( ' RouteAuth component ' , ( ) = > { <nl> + it ( ' creates < Redirect / > if user doesn \ ' t have access ' , ( ) = > { <nl> const gotRedirect = { <nl> . . . sampleRouteItem , <nl> canAccess : accessExceptInbox , <nl> path : ' / inbox ' <nl> } <nl> const component = shallow ( < RouteAuth { . . . gotRedirect } / > ) <nl> - done ( ) <nl> + expect ( component . equals ( < Redirect to = " / auth " / > ) ) . toBe ( true ) <nl> } ) <nl> - it ( ' creates component if user have access ' , done = > { <nl> + it ( ' creates < Route / > if user has access ' , ( ) = > { <nl> const gotComponent = { <nl> . . . sampleRouteItem , <nl> canAccess : accessToInboxOnly , <nl> path : ' / inbox ' <nl> } <nl> const component = shallow ( < RouteAuth { . . . gotComponent } / > ) <nl> - console . log ( component ) <nl> - done ( ) <nl> + expect ( component . equals ( < Route { . . . gotComponent } / > ) ) . toBe ( true ) <nl> } ) <nl> } ) <nl> 
mmm a / src / common / api / LocalStorageCookiesSvc / index . js <nl> ppp b / src / common / api / LocalStorageCookiesSvc / index . js <nl> - import * as store from ' store2 ' <nl> import Cookies from ' js - cookie ' <nl> + / / By default , we don ' t use localStorage , but store2 is already installed <nl> + / / But we use redux - persist ( syncs localStorage with redux state ) <nl> + / / import store from ' store2 ' <nl> import decodeJWT from ' jwt - decode ' <nl> export const JWT_TOKEN = ' JWT_TOKEN ' <nl> export function getLocalToken ( ) : string | null { <nl> - return store . get ( JWT_TOKEN ) | | Cookies . get ( JWT_TOKEN ) <nl> + return Cookies . get ( JWT_TOKEN ) <nl> } <nl> export function resetLocalToken ( ) { <nl> - store . remove ( JWT_TOKEN ) <nl> Cookies . remove ( JWT_TOKEN ) <nl> } <nl> export function setLocalToken ( token : string ) { <nl> - store . set ( JWT_TOKEN , token ) <nl> Cookies . set ( JWT_TOKEN , token , { expires : 365 } ) <nl> } <nl> 
mmm a / src / common / actions / auth / index . test . js <nl> ppp b / src / common / actions / auth / index . test . js <nl> import thunk from ' redux - thunk ' <nl> + import nock from ' nock ' <nl> / / Import all redux actions <nl> import { <nl> LOGIN_AUTH_SUCCESS , <nl> @ @ - 17 , 6 + 18 , 7 @ @ const middlewares = [ thunk ] <nl> const mockStore = configureMockStore ( middlewares ) <nl> const loginPending = { <nl> + meta : null , <nl> type : LOGIN_AUTH_PENDING <nl> } <nl> @ @ - 25 , 15 + 27 , 20 @ @ describe ( ' Auth actions ' , ( ) = > { <nl> * @ arg { Function } done - is a callback that you need to execute , <nl> * If your action performing async task ( e . g . request to API ) <nl> * / <nl> - xtest ( ' creates LOGIN_AUTH_SUCCESS when LOGIN_AUTH was successful ' , done = > { <nl> + test ( ' creates LOGIN_AUTH_SUCCESS when LOGIN_AUTH was successful ' , done = > { <nl> + const successPayload = { <nl> + token : ' nothing ' <nl> + } <nl> + <nl> + nock ( ' http : / / localhost : 3000 / api / v1 ' ) <nl> + . post ( ' / auth ' ) <nl> + . reply ( 200 , successPayload ) <nl> / / Create expected output of your action <nl> const expectedActions = [ <nl> loginPending , <nl> { <nl> type : LOGIN_AUTH_SUCCESS , <nl> - payload : { <nl> - token : ' nothing ' <nl> - } <nl> + payload : successPayload <nl> } <nl> ] <nl> / / Create store for testing <nl> @ @ - 47 , 17 + 54 , 25 @ @ describe ( ' Auth actions ' , ( ) = > { <nl> } ) <nl> } ) <nl> - xtest ( ' creates LOGIN_AUTH_FAIL when LOGIN_AUTH was unsuccessful ' , done = > { <nl> + test ( ' creates LOGIN_AUTH_FAIL when LOGIN_AUTH was unsuccessful ' , done = > { <nl> / / Create expected output of your action <nl> + const errorPayload = { <nl> + errors : { } <nl> + } <nl> + <nl> const expectedActions = [ <nl> loginPending , <nl> { <nl> type : LOGIN_AUTH_FAIL , <nl> - payload : { <nl> - errors : { } <nl> - } <nl> + error : true , <nl> + meta : null , <nl> + payload : errorPayload <nl> } <nl> ] <nl> + <nl> + nock ( ' http : / / localhost : 3000 / api / v1 ' ) <nl> + . post ( ' / auth ' ) <nl> + . reply ( 400 , errorPayload ) <nl> / / Create store for testing <nl> const store = mockStore ( { } ) <nl> / / Dispatch action <nl> 
mmm a / src / common / actions / links / index . test . js <nl> ppp b / src / common / actions / links / index . test . js <nl> const mockStore = configureMockStore ( middlewares ) <nl> const pending = { <nl> + meta : null , <nl> type : GET_LINKS_PENDING <nl> } <nl> - describe ( ' USERS actions ' , ( ) = > { <nl> - it ( ' creates GET_LINKS_SUCCESS when GET_LINKS was successful ' , async done = > { <nl> + describe ( ' Links actions ' , ( ) = > { <nl> + it ( ' creates GET_LINKS_SUCCESS when GET_LINKS was successful ' , done = > { <nl> const store = mockStore ( { } ) <nl> const samplePayload = [ <nl> { <nl> @ @ - 24 , 30 + 25 , 38 @ @ describe ( ' USERS actions ' , ( ) = > { <nl> header : ' string ' <nl> } <nl> ] <nl> - nock ( ' https : / / github . com / Metnew ' ) <nl> - . get ( ' / noir / * ' ) <nl> + nock ( ' http : / / localhost : 3000 / api / v1 ' ) <nl> + . get ( ' / links ' ) <nl> . reply ( 200 , samplePayload ) <nl> return store . dispatch ( GET_LINKS ( ) ) . then ( res = > { <nl> const actions = store . getActions ( ) <nl> const success = { <nl> + meta : null , <nl> type : GET_LINKS_SUCCESS , <nl> payload : samplePayload <nl> } <nl> const expectedActions = [ pending , success ] <nl> - expect ( actions ) . toMatchObject ( expectedActions ) <nl> + expect ( actions ) . toEqual ( expectedActions ) <nl> done ( ) <nl> } ) <nl> } ) <nl> - xit ( ' creates GET_LINKS_FAIL when GET_LINKS was unsuccessful ' , done = > { <nl> + it ( ' creates GET_LINKS_FAIL when GET_LINKS was unsuccessful ' , async done = > { <nl> + const errorPayload = { errors : { } } <nl> + nock ( ' http : / / localhost : 3000 / api / v1 ' ) <nl> + . get ( ' / links ' ) <nl> + . reply ( 400 , errorPayload ) <nl> + <nl> const store = mockStore ( { } ) <nl> - return store . dispatch ( GET_LINKS ( 1 ) ) . then ( res = > { <nl> + await store . dispatch ( GET_LINKS ( ) ) <nl> const actions = store . getActions ( ) <nl> const fail = { <nl> + meta : null , <nl> type : GET_LINKS_FAIL , <nl> - payload : { } <nl> + error : true , <nl> + payload : errorPayload <nl> } <nl> const expectedActions = [ pending , fail ] <nl> @ @ - 55 , 4 + 64 , 3 @ @ describe ( ' USERS actions ' , ( ) = > { <nl> done ( ) <nl> } ) <nl> } ) <nl> - } ) <nl> 
mmm a / src / common / actions / utils / index . js <nl> ppp b / src / common / actions / utils / index . js <nl> - import Awral from ' awral ' <nl> + import Awral from ' . / awral ' <nl> / * * <nl> * ` parseJSON ( ) ` adds property " ok " <nl> * that identicates that response is OK <nl> @ @ - 12 , 6 + 12 , 11 @ @ import Awral from ' awral ' <nl> const check = ( result : Object = { ok : false } ) : boolean = > result . ok <nl> const beforeCheck = a = > a <nl> const afterCheck = a = > a . data <nl> + / / disable dispatch of GET_LINKS_FINALLY <nl> + const finallyAction = null <nl> + / / disable dispatch of GET_LINKS_BEFORE_PENDING <nl> + const beforePending = null <nl> + <nl> / * * <nl> Create default Awral <nl> Awral is not recommended for production usage now <nl> @ @ - 20 , 4 + 25 , 4 @ @ const afterCheck = a = > a . data <nl> Awral is 880B gzipped ! <nl> { @ link https : / / github . com / Metnew / awral } <nl> * / <nl> - export const awral = Awral . of ( { check , beforeCheck , afterCheck } ) <nl> + export const awral = Awral . of ( { check , beforeCheck , afterCheck , finally : finallyAction , beforePending } ) <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " description " : " Advanced universal React starter built with a scale in mind . " , <nl> " dependencies " : { <nl> - " awral " : " ^ 1 . 1 . 2 " , <nl> + " awral " : " ^ 1 . 2 . 0 " , <nl> " body - parser " : " ^ 1 . 18 . 2 " , <nl> " chalk " : " ^ 2 . 2 . 0 " , <nl> " chokidar " : " ^ 1 . 7 . 0 " , <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> / / $ FlowFixMe <nl> import faviconsAssets from ' favicons - assets ' <nl> import getI18nData from ' server / i18n ' <nl> + import { matchPath } from ' react - router ' <nl> export default async ( req : express $ Request , res : express $ Response ) = > { <nl> const { isLoggedIn , language } = req . user <nl> @ @ - 50 , 6 + 51 , 18 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> initialState : preloadedState , <nl> i18n <nl> } <nl> + <nl> + / / FIXME : how to replace ` let ` and ` for ` ? <nl> + let lazyRoutes = routes . filter ( a = > a . lazy ) <nl> + for ( var i = 0 ; i < lazyRoutes . length ; i + + ) { <nl> + let route = routes [ i ] <nl> + if ( matchPath ( req . url , route ) ) { <nl> + route . component = await routes [ i ] . component ( ) . default <nl> + route . lazy = false <nl> + break <nl> + } <nl> + } <nl> + <nl> const { beforeAppTag , afterAppTag } = HtmlComponent ( props ) <nl> res . writeHead ( 200 , { <nl> 
mmm a / src / server / middlewares / index . js <nl> ppp b / src / server / middlewares / index . js <nl> import bodyParser from ' body - parser ' <nl> import morgan from ' morgan ' <nl> import useragent from ' express - useragent ' <nl> + import Raven from ' raven ' <nl> import authMiddleware from ' . / auth ' <nl> export default ( app : express $ Application ) : express $ Application = > { <nl> + / / Must configure Raven before doing anything else with it <nl> + Raven . config ( process . env . SENTRY_DSN ) . install ( ) <nl> + / / The request handler must be the first middleware on the app <nl> + app . use ( Raven . requestHandler ( ) ) <nl> + / / remove x - powered - by <nl> + app . disable ( ' x - powered - by ' ) <nl> / / Add express stuff <nl> app . use ( helmet ( ) ) <nl> app . use ( compression ( ) ) <nl> @ @ - 25 , 6 + 32 , 23 @ @ export default ( app : express $ Application ) : express $ Application = > { <nl> app . use ( bodyParser . json ( ) ) <nl> app . use ( useragent . express ( ) ) <nl> app . use ( authMiddleware ) <nl> + / / The error handler must be before any other error middleware <nl> + app . use ( Raven . errorHandler ( ) ) <nl> + / / Optional fallthrough error handler <nl> + / / eslint - disable - next - line <nl> + app . use ( function onError ( <nl> + err , <nl> + req : express $ Request , <nl> + res : express $ Response , <nl> + next : express $ NextFunction <nl> + ) { <nl> + / / NOTE : @ Metnew : line disabled by ESlint , because err is already handled by sentry <nl> + / / <nl> + / / The error id is attached to ` res . sentry ` to be returned <nl> + / / and optionally displayed to the user for support . <nl> + res . statusCode = 500 <nl> + res . end ( res . sentry + ' \ n ' ) <nl> + } ) <nl> return app <nl> } <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> import { Route } from ' react - router - dom ' <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> - import Dashboard from ' containers / Dashboard ' <nl> - import Login from ' containers / Login ' <nl> + / / import Dashboard from ' containers / Dashboard ' <nl> + / / import Login from ' containers / Login ' <nl> import type { RouteItem } from ' types ' <nl> const loadLazyComponentFnConstructor = ( url : string ) = > async ( ) = > { <nl> @ @ - 24 , 8 + 24 , 9 @ @ const routes : Array < RouteItem > = [ <nl> icon : ' newspaper ' , <nl> name : ' Dashboard ' , <nl> sidebarVisible : true , <nl> + lazy : true , <nl> tag : RouteAuth , <nl> - component : Dashboard <nl> + component : loadLazyComponentFnConstructor ( ' Dashboard ' ) <nl> } , <nl> { <nl> path : ' / links ' , <nl> @ @ - 47 , 8 + 48 , 9 @ @ const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / auth ' , <nl> name : ' Auth ' , <nl> + lazy : true , <nl> tag : Route , <nl> - component : Login <nl> + component : loadLazyComponentFnConstructor ( ' Login ' ) <nl> } <nl> ] <nl> 
mmm a / src / common / components / addons / RoutingWrapper / index . jsx <nl> ppp b / src / common / components / addons / RoutingWrapper / index . jsx <nl> import React , { Component } from ' react ' <nl> import { Switch , Redirect } from ' react - router - dom ' <nl> - import LazyLoad from ' components / addons / LazyLoad ' <nl> import { getAuthState } from ' selectors ' <nl> import type { RouteItem } from ' types ' <nl> @ @ - 44 , 30 + 43 , 19 @ @ export default class RoutingWrapper extends Component { <nl> render ( ) { <nl> const { routes } = this . props <nl> const onlyRoutes = routes . filter ( <nl> - a = > a . tag | | a . component | | a . lazy | | ! a . external <nl> + a = > a . tag | | a . component | | ! a . external <nl> ) <nl> / / render components that are inside Switch ( main view ) <nl> const routesRendered = onlyRoutes . map ( ( a : RouteItem , i ) = > { <nl> / / get tag for Route . <nl> - / / is it " RouteAuth " ` protected route ` or " Route " ? <nl> + / / is it " RouteAuth " ( e . g . ` protected route ` ) or " Route " ? <nl> const Tag = a . tag <nl> - const { path , exact , strict , component , lazy } = a <nl> - / / can visitor access this route ? <nl> - / / this function determinates is user allowed to visit route <nl> + const { path , exact , strict , component } = a <nl> + / / Determinates is user allowed to visit certain route <nl> const canAccess = this . authCheck . bind ( this ) <nl> - / / select only props that we need <nl> - const b = { path , exact , strict , canAccess } <nl> + / / Select only props that we need <nl> + const b = { canAccess , path , exact , strict , component } <nl> - if ( lazy ) { <nl> - const routeToRenderLazy = ( <nl> - < Tag { . . . b } key = { i } > <nl> - < LazyLoad component = { component } / > <nl> - < / Tag > <nl> - ) <nl> - return routeToRenderLazy <nl> - } <nl> - <nl> - / / it can be Route or RouteAuth <nl> return < Tag key = { i } { . . . b } component = { component } / > <nl> } ) <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> + import React from ' react ' <nl> import { Route } from ' react - router - dom ' <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> - / / import Dashboard from ' containers / Dashboard ' <nl> - / / import Login from ' containers / Login ' <nl> + import { asyncComponent } from ' react - async - component ' <nl> + import { Loader } from ' semantic - ui - react ' <nl> import type { RouteItem } from ' types ' <nl> - const loadLazyComponentFnConstructor = ( url : string ) = > async ( ) = > { <nl> + const importCreator = ( url : string ) = > async ( ) = > { <nl> / / NOTE : there isn ' t any duplication here <nl> / / Read Webpack docs about code - splitting for more info . <nl> if ( process . env . BROWSER ) { <nl> - const loadComponent = await import ( / * webpackMode : " lazy " , webpackChunkName : " [ request ] . lazy " * / ` containers / $ { url } / index . jsx ` ) <nl> - return loadComponent <nl> + const resolve = import ( / * webpackMode : " lazy " , webpackChunkName : " [ request ] . lazy " * / ` containers / $ { url } / index . jsx ` ) <nl> + return resolve <nl> } <nl> - const loadComponent = await import ( / * webpackMode : " eager " * / ` containers / $ { url } / index . jsx ` ) <nl> - return loadComponent <nl> + const resolve = import ( / * webpackMode : " eager " * / ` containers / $ { url } / index . jsx ` ) <nl> + return resolve <nl> + } <nl> + <nl> + const asyncComponentCreator = url = > { <nl> + const resolve = importCreator ( url ) <nl> + return asyncComponent ( { <nl> + resolve , <nl> + LoadingComponent ( ) { <nl> + return < Loader > Loading . . . < / Loader > <nl> + } <nl> + } ) <nl> } <nl> / / FIXME : sidebar routes and app routes should be separated ! <nl> @ @ - 24 , 19 + 35 , 17 @ @ const routes : Array < RouteItem > = [ <nl> icon : ' newspaper ' , <nl> name : ' Dashboard ' , <nl> sidebarVisible : true , <nl> - lazy : true , <nl> tag : RouteAuth , <nl> - component : loadLazyComponentFnConstructor ( ' Dashboard ' ) <nl> + component : asyncComponentCreator ( ' Dashboard ' ) <nl> } , <nl> { <nl> path : ' / links ' , <nl> name : ' Links ' , <nl> exact : true , <nl> - lazy : true , <nl> icon : ' bookmark ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : loadLazyComponentFnConstructor ( ' Links ' ) <nl> + component : asyncComponentCreator ( ' Links ' ) <nl> } , <nl> { <nl> external : true , <nl> @ @ - 48 , 9 + 57 , 8 @ @ const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / auth ' , <nl> name : ' Auth ' , <nl> - lazy : true , <nl> tag : Route , <nl> - component : loadLazyComponentFnConstructor ( ' Login ' ) <nl> + component : asyncComponentCreator ( ' Login ' ) <nl> } <nl> ] <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " file - loader " : " ^ 1 . 1 . 5 " , <nl> " flow - bin " : " ^ 0 . 57 . 3 " , <nl> + " form - data " : " ^ 2 . 3 . 1 " , <nl> " friendly - errors - webpack - plugin " : " ^ 1 . 6 . 1 " , <nl> " html - webpack - plugin " : " ^ 2 . 30 . 1 " , <nl> " husky " : " ^ 0 . 14 . 3 " , <nl> 
mmm a / src / common / app / configure_app . js <nl> ppp b / src / common / app / configure_app . js <nl> import { routerMiddleware } from ' react - router - redux ' <nl> / / / / Application <nl> import rootReducer from ' reducers ' <nl> - import { history , routes } from ' routing ' <nl> + import { history , getRoutes } from ' routing ' <nl> / / <nl> / * * <nl> * Configure application store <nl> @ @ - 36 , 6 + 36 , 7 @ @ const configureStore = ( initialState : Object ) = > { <nl> * @ return { Object } Object containting configured store , routes , history <nl> * / <nl> export default ( initialState : Object ) = > { <nl> + const routes = getRoutes ( ) <nl> const store = configureStore ( initialState ) <nl> return { <nl> store , <nl> 
mmm a / src / common / components / addons / RoutingWrapper / index . jsx <nl> ppp b / src / common / components / addons / RoutingWrapper / index . jsx <nl> render ( ) { <nl> const { routes } = this . props <nl> - const onlyRoutes = routes . filter ( <nl> - a = > a . tag | | a . component | | ! a . external <nl> - ) <nl> / / render components that are inside Switch ( main view ) <nl> - const routesRendered = onlyRoutes . map ( ( a : RouteItem , i ) = > { <nl> - / / get tag for Route . <nl> - / / is it " RouteAuth " ( e . g . ` protected route ` ) or " Route " ? <nl> + const routesRendered = routes . map ( ( a : RouteItem , i ) = > { <nl> + / / Get tag for Route . <nl> + / / Is it " RouteAuth " ( e . g . ` protected route ` ) or " Route " ? <nl> const Tag = a . tag <nl> - const { path , exact , strict , component } = a <nl> / / Determinates is user allowed to visit certain route <nl> const canAccess = this . authCheck . bind ( this ) <nl> / / Select only props that we need <nl> - const b = { canAccess , path , exact , strict , component } <nl> + const b = { canAccess , . . . a } <nl> - return < Tag key = { i } { . . . b } component = { component } / > <nl> + return < Tag key = { i } { . . . b } / > <nl> } ) <nl> return ( <nl> < Switch > <nl> { routesRendered } <nl> - < Redirect to = " / " / > <nl> < / Switch > <nl> ) <nl> } <nl> 
mmm a / src / common / reducers / links / index . js <nl> ppp b / src / common / reducers / links / index . js <nl> entities : [ ] , <nl> errors : { } , <nl> isLoading : false , <nl> - isLoaded : false <nl> + isLoaded : false , <nl> + count : 0 <nl> } <nl> export function links ( state : State = initialState , action : Action ) : State { <nl> @ @ - 38 , 11 + 39 , 13 @ @ export function links ( state : State = initialState , action : Action ) : State { <nl> } <nl> case GET_LINKS_SUCCESS : { <nl> const entities = action . payload <nl> + const count = entities . length <nl> return { <nl> . . . state , <nl> isLoaded : true , <nl> isLoading : false , <nl> - entities <nl> + entities , <nl> + count <nl> } <nl> } <nl> case GET_LINKS_FAIL : { <nl> @ @ - 51 , 7 + 54 , 9 @ @ export function links ( state : State = initialState , action : Action ) : State { <nl> . . . state , <nl> errors , <nl> isLoaded : true , <nl> - isLoading : false <nl> + isLoading : false , <nl> + entities : [ ] , <nl> + count : 0 <nl> } <nl> } <nl> default : <nl> 
mmm a / src / common / containers / App / style . jsx <nl> ppp b / src / common / containers / App / style . jsx <nl> export const MainLayout = styled . div ` <nl> display : flex ; <nl> flex - direction : column ; <nl> - min - height : calc ( 100 % - 65px ) ; <nl> color : $ { props = > props . theme . primaryTextColor } ; <nl> background - color : $ { props = > props . theme . primaryColorText } ; <nl> - $ { media . lg ` <nl> - min - height : calc ( 100 % - 72px ) ; <nl> - ` } ; <nl> + $ { ' 100 % - Header height - Footer height ' } ; <nl> + height : 100 % ; <nl> + max - height : calc ( 100 % - 72px ) ; <nl> ` <nl> export const MainContent = styled . main ` <nl> + height : 100 % ; <nl> display : flex ; <nl> flex - grow : 1 ; <nl> padding - left : 1rem ; <nl> @ @ - 25 , 6 + 25 , 7 @ @ export const MainContent = styled . main ` <nl> / / $ { ' ' / * height : 100 % ; * / } <nl> export const SidebarSemanticPusherStyled = styled ( Sidebar . Pusher ) ` <nl> - webkit - overflow - scrolling : touch ; <nl> + $ { ' ' } <nl> : : - webkit - scrollbar { <nl> width : 0px ! important ; <nl> @ @ - 40 , 6 + 41 , 7 @ @ export const SidebarSemanticPushableStyled = styled ( Sidebar . Pushable ) ` <nl> / / Margin - just to fill empty space <nl> export const MainContainer = styled ( Container ) ` <nl> + height : 100 % ; <nl> margin - top : 2em ; <nl> margin - bottom : 1em ; <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> import { Route } from ' react - router - dom ' <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> import { asyncComponent } from ' react - async - component ' <nl> - import { Loader } from ' semantic - ui - react ' <nl> + import { Loader , Dimmer , Header , Icon } from ' semantic - ui - react ' <nl> + import _ from ' lodash ' <nl> import type { RouteItem } from ' types ' <nl> + function asyncComponentCreator ( url ) { <nl> const importCreator = ( url : string ) = > async ( ) = > { <nl> - / / NOTE : there isn ' t any duplication here <nl> / / Read Webpack docs about code - splitting for more info . <nl> if ( process . env . BROWSER ) { <nl> const resolve = import ( / * webpackMode : " lazy " , webpackChunkName : " [ request ] . lazy " * / ` containers / $ { url } / index . jsx ` ) <nl> @ @ - 17 , 17 + 18 , 35 @ @ const importCreator = ( url : string ) = > async ( ) = > { <nl> return resolve <nl> } <nl> - const asyncComponentCreator = url = > { <nl> - const resolve = importCreator ( url ) <nl> return asyncComponent ( { <nl> - resolve , <nl> + resolve : importCreator ( url ) , <nl> LoadingComponent ( ) { <nl> - return < Loader > Loading . . . < / Loader > <nl> - } <nl> + return ( <nl> + < Dimmer active > <nl> + < Loader size = " large " active > <nl> + Loading page . . . <nl> + < / Loader > <nl> + < / Dimmer > <nl> + ) <nl> + } , <nl> + ErrorComponent ( ) { <nl> + return ( <nl> + < Dimmer active > <nl> + < Header inverted as = " h2 " icon textAlign = " center " > <nl> + < Icon name = " refresh " / > <nl> + Refresh <nl> + < Header . Subheader > Got error while loading page . < / Header . Subheader > <nl> + < / Header > <nl> + < / Dimmer > <nl> + ) <nl> + } , <nl> + autoResolveES2015Default : true , <nl> + env : process . env . BROWSER ? ' browser ' : ' node ' , <nl> + serverMode : ' resolve ' <nl> } ) <nl> } <nl> - / / FIXME : sidebar routes and app routes should be separated ! <nl> + function routingFnCreator ( useFor : ' sidebar ' | ' routing ' | ' all ' = ' all ' ) { <nl> const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / ' , <nl> @ @ - 57 , 9 + 76 , 41 @ @ const routes : Array < RouteItem > = [ <nl> { <nl> path : ' / auth ' , <nl> name : ' Auth ' , <nl> + exact : true , <nl> tag : Route , <nl> component : asyncComponentCreator ( ' Login ' ) <nl> } <nl> + / / find the way to add / remove routes conditionally <nl> + / / { <nl> + / / name : ' 404 ' , <nl> + / / tag : RouteAuth , <nl> + / / component : asyncComponentCreator ( ' NotFound ' ) <nl> + / / } <nl> ] <nl> - export default routes <nl> + const fns = { <nl> + / / Returns routing for sidebar menu <nl> + sidebar ( x : Array < RouteItem > = routes ) { <nl> + return x <nl> + . filter ( a = > a . sidebarVisible ) <nl> + . map ( a = > <nl> + _ . pick ( a , [ ' path ' , ' name ' , ' icon ' , ' external ' , ' strict ' , ' exact ' ] ) <nl> + ) <nl> + } , <nl> + / / Returns routing for React - Router <nl> + routing ( x : Array < RouteItem > = routes ) { <nl> + return x <nl> + . filter ( a = > ! a . sidebarVisible ) <nl> + . map ( a = > _ . pick ( a , [ ' path ' , ' name ' , ' strict ' , ' exact ' , ' component ' , ' tag ' ] ) ) <nl> + } , <nl> + all ( ) { <nl> + return routes <nl> + } <nl> + } <nl> + <nl> + return fns [ useFor ] <nl> + } <nl> + <nl> + export const getRoutes = routingFnCreator ( ) <nl> + export const getSidebarRoutes = routingFnCreator ( ' sidebar ' ) <nl> + export const getRouterRoutes = routingFnCreator ( ' routing ' ) <nl> 
mmm a / src / common / containers / Links / index . jsx <nl> ppp b / src / common / containers / Links / index . jsx <nl> type Props = { <nl> links : Object , <nl> getLinks : ( ) = > void , <nl> - isLinksLoading : boolean <nl> + isLinksLoading : boolean , <nl> + isLinksLoaded : boolean <nl> } <nl> class Links extends Component { <nl> props : Props <nl> + <nl> componentDidMount ( ) { <nl> + const { isLinksLoaded } = this . props <nl> + if ( ! isLinksLoaded ) { <nl> this . getLinks ( ) <nl> } <nl> + } <nl> getLinks ( ) { <nl> this . props . getLinks ( ) <nl> @ @ - 34 , 7 + 39 , 7 @ @ class Links extends Component { <nl> < title > Noir : Links < / title > <nl> < / Helmet > <nl> { isLinksLoading ? ( <nl> - < Loader active > Loading . . . < / Loader > <nl> + < Loader active > Loading data . . . < / Loader > <nl> ) : ( <nl> < LinksComponent links = { links } / > <nl> ) } <nl> @ @ - 47 , 8 + 52 , 8 @ @ function mapStateToProps ( state : GlobalState ) { <nl> const linksState = getEntitiesLinksState ( state ) <nl> const links = linksState . entities <nl> const isLinksLoading = linksState . isLoading <nl> - <nl> - return { links , isLinksLoading } <nl> + const isLinksLoaded = linksState . isLoaded <nl> + return { links , isLinksLoading , isLinksLoaded } <nl> } <nl> const mapDispatchToProps = dispatch = > ( { <nl> 
mmm a / src / client / index . jsx <nl> ppp b / src / client / index . jsx <nl> import ' promise - polyfill ' <nl> import ' isomorphic - fetch ' <nl> / / Application <nl> + import React from ' react ' <nl> import { hydrate } from ' react - dom ' <nl> + import { AsyncComponentProvider } from ' react - async - component ' <nl> + import asyncBootstrapper from ' react - async - bootstrapper ' <nl> import { configureApp , configureRootComponent } from ' common / app ' <nl> import type { GlobalState } from ' reducers ' <nl> import type { i18nConfigObject } from ' types ' <nl> @ @ - 39 , 7 + 42 , 8 @ @ if ( process . env . NODE_ENV = = = ' production ' ) { <nl> const initialState : GlobalState = window . __INITIAL_STATE__ | | { } <nl> const i18n : i18nConfigObject = window . __I18N__ | | { } <nl> - / / NOTE : V8 doesn ' t optimize code with ` delete ` <nl> + const asyncState : Object = window . __ASYNC_STATE__ | | { } <nl> + / / NOTE : V8 doesn ' t optimize ` delete ` <nl> / / delete window . __INITIAL_STATE__ <nl> const { store , routes , history } = configureApp ( initialState ) <nl> const RootComponent = configureRootComponent ( { <nl> @ @ - 49 , 7 + 53 , 16 @ @ const RootComponent = configureRootComponent ( { <nl> i18n <nl> } ) <nl> - hydrate ( RootComponent , document . getElementById ( ' app ' ) ) <nl> + const app = ( <nl> + < AsyncComponentProvider rehydrateState = { asyncState } > <nl> + { RootComponent } <nl> + < / AsyncComponentProvider > <nl> + ) <nl> + <nl> + asyncBootstrapper ( app ) . then ( ( ) = > { <nl> + console . log ( ' FROM SERVER : ' , document . getElementById ( ' app ' ) . innerHTML ) <nl> + hydrate ( app , document . getElementById ( ' app ' ) ) <nl> + } ) <nl> if ( module . hot ) { <nl> module . hot . accept ( ) <nl> 
mmm a / src / common / styles / global . jsx <nl> ppp b / src / common / styles / global . jsx <nl> box - sizing : border - box ; <nl> } <nl> + body { <nl> + margin : 0 ; <nl> + padding : 0 ; <nl> + overflow - x : hidden ; <nl> + min - width : 320px ; <nl> + background : white ; <nl> + font - family : ' Lato ' , ' Helvetica Neue ' , Arial , Helvetica , sans - serif ; <nl> + font - size : 14px ; <nl> + line - height : 1 . 4285em ; <nl> + color : rgba ( 0 , 0 , 0 , 0 . 87 ) ; <nl> + } <nl> + <nl> + . pushable { <nl> + height : 100 % ; <nl> + overflow - x : hidden ; <nl> + padding : 0em ! important ; <nl> + - webkit - transform : translate3d ( 0 , 0 , 0 ) ; <nl> + transform : translate3d ( 0 , 0 , 0 ) ; <nl> + } <nl> + <nl> $ { ' ' / * body : : - webkit - scrollbar { <nl> width : 0 ; <nl> } <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import React from ' react ' <nl> import chalk from ' chalk ' <nl> + import _ from ' lodash ' <nl> import { renderToNodeStream } from ' react - dom / server ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> + import asyncBootstrapper from ' react - async - bootstrapper ' <nl> + import { AsyncComponentProvider , createAsyncContext } from ' react - async - component ' <nl> import HtmlComponent from ' . / HtmlComponent ' <nl> / / $ FlowFixMe <nl> import assets from ' webpack - assets ' <nl> @ @ - 36 , 45 + 39 , 48 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> i18n , <nl> SSR : { location , context } <nl> } ) <nl> - const stream = renderToNodeStream ( <nl> + const asyncContext = createAsyncContext ( ) <nl> + <nl> + const app = ( <nl> + < AsyncComponentProvider asyncContext = { asyncContext } > <nl> < StyleSheetManager sheet = { sheet . instance } > <nl> { RootComponent } <nl> < / StyleSheetManager > <nl> + < / AsyncComponentProvider > <nl> ) <nl> + / / console . log ( _ . find ( routes , a = > matchPath ( req . url , a ) ) ) <nl> + const noRequestURLMatch = ! ! _ . find ( routes , a = > matchPath ( req . url , a ) ) <nl> + <nl> + asyncBootstrapper ( app ) . then ( ( ) = > { <nl> + const appStream = renderToNodeStream ( app ) <nl> const css : string = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> + <nl> + const asyncState = asyncContext . getState ( ) <nl> const props = { <nl> css , <nl> assets , <nl> faviconsAssets , <nl> + asyncState , <nl> initialState : preloadedState , <nl> i18n <nl> } <nl> - / / FIXME : how to replace ` let ` and ` for ` ? <nl> - let lazyRoutes = routes . filter ( a = > a . lazy ) <nl> - for ( var i = 0 ; i < lazyRoutes . length ; i + + ) { <nl> - let route = routes [ i ] <nl> - if ( matchPath ( req . url , route ) ) { <nl> - route . component = await routes [ i ] . component ( ) . default <nl> - route . lazy = false <nl> - break <nl> - } <nl> - } <nl> - <nl> const { beforeAppTag , afterAppTag } = HtmlComponent ( props ) <nl> + const responseStatusCode = noRequestURLMatch ? 404 : 200 <nl> - res . writeHead ( 200 , { <nl> + res . writeHead ( responseStatusCode , { <nl> ' Content - Type ' : ' text / html ' <nl> } ) <nl> res . write ( beforeAppTag ) <nl> res . write ( ` < div id = " app " > ` ) <nl> - stream . pipe ( res , { end : false } ) <nl> + appStream . pipe ( res , { end : false } ) <nl> - stream . on ( ' end ' , ( ) = > { <nl> + appStream . on ( ' end ' , ( ) = > { <nl> res . write ( ' < / div > ' ) <nl> res . write ( afterAppTag ) <nl> res . end ( ) <nl> } ) <nl> + } ) <nl> } <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import asyncBootstrapper from ' react - async - bootstrapper ' <nl> import { AsyncComponentProvider , createAsyncContext } from ' react - async - component ' <nl> import HTMLComponent from ' . / HTMLComponent ' <nl> - / / $ FlowFixMe <nl> - import assets from ' webpack - assets ' <nl> - / / $ FlowFixMe <nl> - import faviconsAssets from ' favicons - assets ' <nl> import getI18nData from ' server / i18n ' <nl> import { matchPath } from ' react - router ' <nl> + import getStats from ' . / stats ' <nl> + <nl> + / / it ' s better to define these objs in global scope ( less memory consumption ) <nl> + let { assets , faviconsAssets } = { } <nl> + getStats ( ) . then ( result = > { <nl> + assets = result . assets <nl> + faviconsAssets = result . faviconsAssets <nl> + } ) <nl> export default async ( req : express $ Request , res : express $ Response ) = > { <nl> const { isLoggedIn , language } = req . user <nl> 
mmm a / src / server / ssr / stats . js <nl> ppp b / src / server / ssr / stats . js <nl> import fs from ' fs ' <nl> + import chokidar from ' chokidar ' <nl> let cache = { } <nl> async function getFile ( path ) { <nl> / / Cache file forever <nl> if ( cache [ path ] ) { <nl> - console . log ( ' from cache ' ) <nl> return Promise . resolve ( cache [ path ] ) <nl> } <nl> return new Promise ( ( resolve , reject ) = > { <nl> - / / Give Webpack some time on first stats generation <nl> - setTimeout ( ( ) = > { <nl> + / / This ` readFile ` func is looking like it escaped from procedure programming <nl> + const readFile = ( ) = > { <nl> fs . readFile ( path , ' utf8 ' , ( err , data ) = > { <nl> if ( err ) { <nl> throw err <nl> @ @ - 21 , 7 + 21 , 17 @ @ async function getFile ( path ) { <nl> cache [ path ] = json <nl> resolve ( json ) <nl> } ) <nl> - } , 4000 ) <nl> + } <nl> + / / does file exist ? <nl> + fs . access ( path , fs . constants . R_OK , err = > { <nl> + if ( err ) { <nl> + / / No . Watch for changes , resolve on ` add ` . <nl> + chokidar . watch ( path ) . on ( ' add ' , readFile ) <nl> + } else { <nl> + / / Yes . resolve ! <nl> + readFile ( ) <nl> + } <nl> + } ) <nl> } ) <nl> } <nl> 
mmm a / src / common / containers / Links / index . jsx <nl> ppp b / src / common / containers / Links / index . jsx <nl> class Links extends Component { <nl> props : Props <nl> - componentDidMount ( ) { <nl> - const { isLinksLoaded } = this . props <nl> + async asyncBootstrap ( ) { <nl> + const { isLinksLoaded , getLinks } = this . props <nl> if ( ! isLinksLoaded ) { <nl> - this . getLinks ( ) <nl> + await getLinks ( ) <nl> } <nl> + return true <nl> } <nl> - getLinks ( ) { <nl> - this . props . getLinks ( ) <nl> + componentDidMount ( ) { <nl> + const { isLinksLoaded , getLinks } = this . props <nl> + if ( ! isLinksLoaded ) { <nl> + getLinks ( ) <nl> + } <nl> } <nl> render ( ) { <nl> @ @ - 57 , 8 + 61 , 8 @ @ function mapStateToProps ( state : GlobalState ) { <nl> } <nl> const mapDispatchToProps = dispatch = > ( { <nl> - getLinks ( ) { <nl> - dispatch ( GET_LINKS ( ) ) <nl> + async getLinks ( ) { <nl> + return dispatch ( GET_LINKS ( ) ) <nl> } <nl> } ) <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> import manifest from ' . . / static / manifest ' <nl> const { <nl> - BASE_API = ' / api / v1 ' , <nl> + BASE_API = ' http : / / localhost : 3000 / api / v1 ' , <nl> NODE_ENV = ' development ' , <nl> SENTRY_PUBLIC_DSN , <nl> GA_ID , <nl> 
mmm a / src / server / server . js <nl> ppp b / src / server / server . js <nl> / / Add global middlewares <nl> addMiddlewares ( app ) <nl> / / Add API <nl> - app . use ( process . env . BASE_API , API ) <nl> + app . use ( process . env . API_PREFIX , API ) <nl> / / Add SSR <nl> app . use ( SSR ) <nl> return app <nl> 
mmm a / src / common / selectors / index . js <nl> ppp b / src / common / selectors / index . js <nl> + import { createSelector } from ' reselect ' <nl> import type { State as AuthState } from ' reducers / auth ' <nl> import type { State as LayoutState } from ' reducers / layout ' <nl> import type { State as EntitiesLinksState } from ' reducers / links ' <nl> import type { GlobalState } from ' reducers ' <nl> - export const getAuthState = ( state : GlobalState ) : AuthState = > state . me . auth <nl> + export const getAuthState = ( state : GlobalState ) : AuthState = > state . auth <nl> export const getLayoutState = ( state : GlobalState ) : LayoutState = > state . layout <nl> - export const getEntitiesLinksState = ( state : GlobalState ) : EntitiesLinksState = > state . entities . links <nl> + export const getEntitiesLinksState = ( state : GlobalState ) : EntitiesLinksState = > <nl> + state . entities . links <nl> - const defaultWindowInnerWidth = 1025 <nl> export const getWindowInnerWidth = ( window : Object ) : number = > { <nl> + const defaultWindowInnerWidth = 1025 <nl> return window & & window . innerWidth <nl> ? window . innerWidth <nl> : defaultWindowInnerWidth <nl> } <nl> + <nl> + export const getLayoutMobileStatuses = createSelector ( <nl> + getLayoutState , <nl> + ( { innerWidth } ) = > { <nl> + const isMobile : boolean = innerWidth < 1025 / / 1024px - breakpoint <nl> + const isMobileXS : boolean = innerWidth < 481 <nl> + const isMobileSM : boolean = innerWidth > 480 & & innerWidth < 767 <nl> + return { isMobileSM , isMobileXS , isMobile } <nl> + } <nl> + ) <nl> 
mmm a / src / common / containers / Links / index . jsx <nl> ppp b / src / common / containers / Links / index . jsx <nl> import { connect } from ' react - redux ' <nl> import Helmet from ' react - helmet ' <nl> - import { Loader } from ' semantic - ui - react ' <nl> + import { Loader , Grid , List } from ' semantic - ui - react ' <nl> import { GET_LINKS } from ' actions / links ' <nl> - import LinksComponent from ' . / components ' <nl> + import LinkItem from ' . / components / LinkItem ' <nl> import { getEntitiesLinksState } from ' selectors ' <nl> + import _ from ' lodash ' <nl> import type { GlobalState } from ' reducers ' <nl> type Props = { <nl> @ @ - 17 , 16 + 18 , 22 @ @ type Props = { <nl> isLinksLoaded : boolean <nl> } <nl> - class Links extends Component < Props > { <nl> - componentDidMount ( ) { <nl> - const { isLinksLoaded } = this . props <nl> + class Links extends Component { <nl> + props : Props <nl> + <nl> + async asyncBootstrap ( ) { <nl> + const { isLinksLoaded , getLinks } = this . props <nl> if ( ! isLinksLoaded ) { <nl> - this . getLinks ( ) <nl> + await getLinks ( ) <nl> } <nl> + return true <nl> } <nl> - getLinks ( ) { <nl> - this . props . getLinks ( ) <nl> + componentDidMount ( ) { <nl> + const { isLinksLoaded , getLinks } = this . props <nl> + if ( ! isLinksLoaded ) { <nl> + getLinks ( ) <nl> + } <nl> } <nl> render ( ) { <nl> @ @ - 39 , 7 + 46 , 15 @ @ class Links extends Component < Props > { <nl> { isLinksLoading ? ( <nl> < Loader active > Loading data . . . < / Loader > <nl> ) : ( <nl> - < LinksComponent links = { links } / > <nl> + < Grid stackable > <nl> + < Grid . Column width = { 16 } > <nl> + < List relaxed divided animated > <nl> + { _ . map ( links , ( link : LinkItem , i ) = > { <nl> + return < LinkItem key = { i } item = { link } / > <nl> + } ) } <nl> + < / List > <nl> + < / Grid . Column > <nl> + < / Grid > <nl> ) } <nl> < / div > <nl> ) <nl> @ @ - 49 , 14 + 64 , 14 @ @ class Links extends Component < Props > { <nl> function mapStateToProps ( state : GlobalState ) { <nl> const linksState = getEntitiesLinksState ( state ) <nl> const links = linksState . entities <nl> - const isLinksLoading = linksState . isLoading <nl> - const isLinksLoaded = linksState . isLoaded <nl> + const isLinksLoading = linksState . fetchStatus = = = ' loading ' <nl> + const isLinksLoaded = linksState . fetchStatus = = = ' loaded ' <nl> return { links , isLinksLoading , isLinksLoaded } <nl> } <nl> const mapDispatchToProps = dispatch = > ( { <nl> - getLinks ( ) { <nl> - dispatch ( GET_LINKS ( ) ) <nl> + async getLinks ( ) { <nl> + return dispatch ( GET_LINKS ( ) ) <nl> } <nl> } ) <nl> 
mmm a / src / common / actions / auth / index . js <nl> ppp b / src / common / actions / auth / index . js <nl> { @ link https : / / github . com / Metnew / awral } <nl> * / <nl> const awralLogin = awral . of ( { <nl> - success ( { payload , dispatch } ) { <nl> + success ( { payload , dispatch , meta } ) { <nl> setLocalToken ( payload . token ) <nl> - dispatch ( { type : LOGIN_AUTH_SUCCESS , payload } ) <nl> + dispatch ( { type : LOGIN_AUTH_SUCCESS , payload , meta } ) <nl> } <nl> } ) <nl> 
mmm a / src / common / actions / layout / index . js <nl> ppp b / src / common / actions / layout / index . js <nl> - export const UI_OPEN_SIDEBAR = ' UI_OPEN_SIDEBAR ' <nl> - export const UI_CLOSE_SIDEBAR = ' UI_CLOSE_SIDEBAR ' <nl> + export const UI_TOGGLE_SIDEBAR = ' UI_TOGGLE_SIDEBAR ' <nl> export const UI_WINDOW_RESIZE = ' UI_WINDOW_RESIZE ' <nl> - export const CLOSE_SIDEBAR = ( ) = > ( { <nl> - type : UI_CLOSE_SIDEBAR <nl> - } ) <nl> - <nl> - export const OPEN_SIDEBAR = ( ) = > ( { <nl> - type : UI_OPEN_SIDEBAR <nl> + export const TOGGLE_SIDEBAR = ( ) = > ( { <nl> + type : UI_TOGGLE_SIDEBAR <nl> } ) <nl> export const WINDOW_RESIZE = ( innerWidth : number ) = > ( { <nl> @ @ - 18 , 8 + 13 , 7 @ @ export const WINDOW_RESIZE = ( innerWidth : number ) = > ( { <nl> } <nl> } ) <nl> - export type UI_OPEN_SIDEBAR_TYPE = { type : ' UI_OPEN_SIDEBAR ' } <nl> - export type UI_CLOSE_SIDEBAR_TYPE = { type : ' UI_CLOSE_SIDEBAR ' } <nl> + export type UI_TOGGLE_SIDEBAR_TYPE = { type : ' UI_TOGGLE_SIDEBAR ' } <nl> export type UI_WINDOW_RESIZE_TYPE = { <nl> type : ' UI_WINDOW_RESIZE ' , <nl> payload : { innerWidth : number } <nl> 
mmm a / src / common / components / parts / Header / index . jsx <nl> ppp b / src / common / components / parts / Header / index . jsx <nl> import { Icon } from ' semantic - ui - react ' <nl> import { withRouter , matchPath } from ' react - router ' <nl> import _ from ' lodash ' <nl> - import { OPEN_SIDEBAR } from ' actions / layout ' <nl> + import { TOGGLE_SIDEBAR } from ' actions / layout ' <nl> import { <nl> StyledHeader , <nl> HeaderInner , <nl> Navicon , <nl> PageTitle <nl> - / / HeaderButton <nl> } from ' . / style ' <nl> import { Spacer } from ' styles / base ' <nl> import { getMetaRoutes } from ' routing ' <nl> - import { getAuthState , getLayoutState } from ' selectors ' <nl> + import { getAuthState , getLayoutMobileStatuses } from ' selectors ' <nl> import Headroom from ' react - headroom ' <nl> type Props = { <nl> @ @ - 46 , 13 + 45 , 11 @ @ const Header = ( { title , toggleSidebar , isLoggedIn , isMobile } : Props ) = > { <nl> } <nl> const mapStateToProps = ( state , props ) = > { <nl> - console . log ( props ) <nl> const { location : { pathname } } = props <nl> const currentRoute = _ . find ( getMetaRoutes ( ) , a = > matchPath ( pathname , a ) ) | | { } <nl> - console . log ( currentRoute ) <nl> const title = currentRoute . meta . name <nl> const { isLoggedIn } = getAuthState ( state ) <nl> - const { isMobile } = getLayoutState ( state ) <nl> + const { isMobile } = getLayoutMobileStatuses ( state ) <nl> return { <nl> title , <nl> isLoggedIn , <nl> @ @ - 62 , 7 + 59 , 7 @ @ const mapStateToProps = ( state , props ) = > { <nl> const mapDispatchToProps = dispatch = > ( { <nl> toggleSidebar ( ) { <nl> - dispatch ( OPEN_SIDEBAR ( ) ) <nl> + dispatch ( TOGGLE_SIDEBAR ( ) ) <nl> } <nl> } ) <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import React from ' react ' <nl> import _ from ' lodash ' <nl> - import { renderToNodeStream } from ' react - dom / server ' <nl> + import { renderToString } from ' react - dom / server ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> import asyncBootstrapper from ' react - async - bootstrapper ' <nl> @ @ - 12 , 23 + 12 , 21 @ @ import { AsyncComponentProvider , createAsyncContext } from ' react - async - component ' <nl> import HTMLComponent from ' . / HTMLComponent ' <nl> import getI18nData from ' server / i18n ' <nl> import { matchPath } from ' react - router ' <nl> - import getStats from ' . / stats ' <nl> + import { getRouterRoutes } from ' routing ' <nl> + import getAssets from ' . / stats ' <nl> export default async ( req : express $ Request , res : express $ Response ) = > { <nl> - / / probably , it ' d better to define these objs in global scope <nl> - const { assets , faviconsAssets } = await getStats ( ) <nl> - const { isLoggedIn , language } = req . user <nl> - const meState = { auth : { isLoggedIn } } <nl> - const initialState : Object = { me : meState } <nl> + const assets = await getAssets ( ) <nl> + const { language } = req . user <nl> + const initialState : Object = { } <nl> const i18n = getI18nData ( language ) <nl> const sheet = new ServerStyleSheet ( ) <nl> const location : string = req . url <nl> const context = { } <nl> - const { store , history , routes } = configureApp ( initialState ) <nl> + const { store , history } = configureApp ( initialState ) <nl> const RootComponent : React $ Node = configureRootComponent ( { <nl> store , <nl> history , <nl> - routes , <nl> i18n , <nl> SSR : { location , context } <nl> } ) <nl> @ @ - 42 , 37 + 40 , 25 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> < / AsyncComponentProvider > <nl> ) <nl> + const routes = getRouterRoutes ( ) <nl> / / if true - > throw 404 , if match found - > 200 <nl> const noRequestURLMatch = ! _ . find ( routes , a = > matchPath ( req . url , a . path ) ) <nl> asyncBootstrapper ( app ) . then ( ( ) = > { <nl> - const appStream = renderToNodeStream ( app ) <nl> + const renderedApp = renderToString ( app ) <nl> const css : string = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> + const responseStatusCode = noRequestURLMatch ? 404 : 200 <nl> const asyncState = asyncContext . getState ( ) <nl> const props = { <nl> css , <nl> assets , <nl> - faviconsAssets , <nl> asyncState , <nl> initialState : preloadedState , <nl> + app : renderedApp , <nl> i18n <nl> } <nl> - const { beforeAppTag , afterAppTag } = HTMLComponent ( props ) <nl> - const responseStatusCode = noRequestURLMatch ? 404 : 200 <nl> - <nl> - res . writeHead ( responseStatusCode , { <nl> - ' Content - Type ' : ' text / html ' <nl> - } ) <nl> - res . write ( beforeAppTag ) <nl> - res . write ( ` < div id = " app " > ` ) <nl> - appStream . pipe ( res , { end : false } ) <nl> - <nl> - appStream . on ( ' end ' , ( ) = > { <nl> - res . write ( ' < / div > ' ) <nl> - res . write ( afterAppTag ) <nl> - res . end ( ) <nl> - } ) <nl> + res . status ( responseStatusCode ) . send ( HTMLComponent ( props ) ) <nl> } ) <nl> } <nl> 
mmm a / src / common / api / utils / index . js <nl> ppp b / src / common / api / utils / index . js <nl> - export { get , post } from ' . / xhr_wrapper ' <nl> + / * * <nl> + * @ flow <nl> + * @ file Simple fetch wrapper <nl> + * / <nl> + import fetch from ' isomorphic - fetch ' <nl> + <nl> + / / USAGE : <nl> + export const get = requestWrapper ( ' GET ' ) <nl> + / / get ( ' https : / / www . google . com ' , options ) <nl> + export const post = requestWrapper ( ' POST ' ) <nl> + / / post ( ' https : / / www . google . com ' , data ) <nl> + <nl> + / / Create request wrapper for certain method <nl> + function requestWrapper ( method : ' GET ' | ' POST ' | ' DELETE ' | ' PUT ' | ' PATCH ' ) { <nl> + / / Creates request to ` url ` with ` data ` <nl> + return async ( url : string , data : any = null ) = > { <nl> + const body = data ? { body : JSON . stringify ( data ) } : { } <nl> + <nl> + const request = { <nl> + method , <nl> + headers : { } , <nl> + mode : process . env . NODE_ENV = = = ' development ' ? ' cors ' : ' same - origin ' , <nl> + . . . body <nl> + } <nl> + <nl> + return fetch ( url , request ) <nl> + . then ( checkStatus ) <nl> + . then ( parseJSON ) <nl> + . catch ( ( err : any ) = > err ) <nl> + } <nl> + } <nl> + <nl> + async function parseJSON ( res : Response ) : Object { <nl> + let json : Object <nl> + const { status } = res <nl> + / / status response field in return object <nl> + try { <nl> + json = await res . json ( ) <nl> + } catch ( e ) { <nl> + if ( res . status = = = 204 ) { <nl> + return { ok : true , data : { } , status } <nl> + } <nl> + return { ok : false , status } <nl> + } <nl> + if ( ! res . ok ) { <nl> + return { data : json , ok : false , status } <nl> + } <nl> + return { data : json , ok : true , status } <nl> + } <nl> + <nl> + function checkStatus ( response : Response ) : Response { <nl> + const { status } = response <nl> + if ( status > = 200 & & status < 300 ) { <nl> + / / Everything is ok <nl> + } else if ( status > = 300 & & status < 400 ) { <nl> + / / 300 - Multiple Choices <nl> + / / 301 - Moved Permanently , <nl> + / / 302 - Found , Moved Temporarily <nl> + / / 304 - not modified <nl> + / / 307 - Temporary Redirect <nl> + } else if ( status = = = 400 ) { <nl> + / / Probably is a validation error <nl> + } else if ( status = = = 403 | | status = = = 401 ) { <nl> + / / 401 - Forbidden <nl> + / / 403 - Unauthorized <nl> + } else if ( status = = = 404 ) { <nl> + / / Not Found <nl> + } else if ( status > = 500 ) { <nl> + / / Server error <nl> + } <nl> + return response <nl> + } <nl> 
mmm a / src / common / components / Root / index . jsx <nl> ppp b / src / common / components / Root / index . jsx <nl> ? require ( ' react - router - redux ' ) . ConnectedRouter <nl> : require ( ' react - router ' ) . StaticRouter <nl> - export default class Root extends Component < Props > { <nl> + let initAlready = false <nl> + / / react - async - bootstrapper renders < Root / > twice , because it ' s based on react - tree - walker <nl> + / / react - tree - walker walks in React node tree and resolves promises . <nl> + / / This behaviour allow apps to make server - side data fetching . <nl> + / / But this approach has 2 drawbacks : <nl> + / / Root rendered twice + APPLICATION_INIT dispatched twice <nl> + / / ` initAlready ` ensures that ` APPLICATION_INIT ` was dispatched only once . <nl> + class Root extends Component < Props > { <nl> static defaultProps = { <nl> SSR : { } <nl> } <nl> componentWillMount ( ) { <nl> const { store , i18n } = this . props <nl> + if ( ! initAlready ) { <nl> store . dispatch ( { type : APPLICATION_INIT } ) <nl> addLocaleData ( i18n . localeData ) <nl> } <nl> + initAlready = true <nl> + } <nl> render ( ) { <nl> + if ( ! initAlready ) { <nl> + return null <nl> + } <nl> const { SSR , store , history , i18n } = this . props <nl> const routerProps = process . env . BROWSER <nl> ? { history } <nl> @ @ - 59 , 3 + 72 , 5 @ @ export default class Root extends Component < Props > { <nl> ) <nl> } <nl> } <nl> + <nl> + export default Root <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> / / Returns ` name ` + ` path ` . used in Header <nl> meta ( ) { <nl> return routes <nl> - . map ( a = > _ . pick ( a , [ ' path ' , ' name ' ] ) ) <nl> + . map ( a = > _ . pick ( a , [ ' path ' , ' name ' , ' exact ' , ' strict ' ] ) ) <nl> } <nl> } <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> * / <nl> import React from ' react ' <nl> + import Helmet from ' react - helmet ' <nl> import { renderToString } from ' react - dom / server ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> import { configureRootComponent , configureApp } from ' common / app ' <nl> @ @ - 33 , 9 + 34 , 7 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> const app = ( <nl> < AsyncComponentProvider asyncContext = { asyncContext } > <nl> - < StyleSheetManager sheet = { sheet . instance } > <nl> - { RootComponent } <nl> - < / StyleSheetManager > <nl> + < StyleSheetManager sheet = { sheet . instance } > { RootComponent } < / StyleSheetManager > <nl> < / AsyncComponentProvider > <nl> ) <nl> @ @ - 45 , 6 + 44 , 7 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> asyncBootstrapper ( app ) . then ( ( ) = > { <nl> const renderedApp = renderToString ( app ) <nl> + const helmet = Helmet . renderStatic ( ) <nl> const css : string = sheet . getStyleTags ( ) <nl> const preloadedState : Object = store . getState ( ) <nl> const responseStatusCode = noRequestURLMatch ? 404 : 200 <nl> @ @ - 55 , 7 + 55 , 8 @ @ export default async ( req : express $ Request , res : express $ Response ) = > { <nl> asyncState , <nl> initialState : preloadedState , <nl> app : renderedApp , <nl> - i18n <nl> + i18n , <nl> + helmet <nl> } <nl> res . status ( responseStatusCode ) . send ( HTMLComponent ( props ) ) <nl> 
mmm a / src / common / containers / NotFound / index . jsx <nl> ppp b / src / common / containers / NotFound / index . jsx <nl> return ( <nl> < NotFoundLayout > <nl> < Header as = " h2 " icon textAlign = " center " > <nl> - < Icon name = " users " circular / > <nl> - < Header . Content > 404 < / Header . Content > <nl> + < Icon name = " warning sign " circular / > <nl> + < Header . Content > Thank you Mario ! < / Header . Content > <nl> < Header . Subheader > <nl> - < Link to = " / " > Dashboard lives here < / Link > <nl> + < Link to = " / " > But our princess is in another castle . < / Link > <nl> < / Header . Subheader > <nl> < / Header > <nl> < / NotFoundLayout > <nl> 
mmm a / webpack_config / client / webpack . base . js <nl> ppp b / webpack_config / client / webpack . base . js <nl> import isomorphicWebpackConfig from ' . . / webpack . isomorphic ' <nl> import AssetsPlugin from ' assets - webpack - plugin ' <nl> import WebpackAssetsManifest from ' webpack - assets - manifest ' <nl> - const { GA_ID , SENTRY_PUBLIC_DSN , CLIENT_STATIC_PATH , srcPath , publicPath , isProduction , manifest , distPath } = config <nl> + import CopyWebpackPlugin from ' copy - webpack - plugin ' <nl> + <nl> + const { <nl> + GA_ID , <nl> + SENTRY_PUBLIC_DSN , <nl> + CLIENT_STATIC_PATH , <nl> + srcPath , <nl> + publicPath , <nl> + rootPath , <nl> + isProduction , <nl> + manifest , <nl> + distPath <nl> + } = config <nl> rimraf ( ` $ { distPath } / client ` , { } , ( ) = > { } ) <nl> @ @ - 58 , 7 + 70 , 13 @ @ const baseBuild = { <nl> } ) , <nl> new WebpackAssetsManifest ( { <nl> assets : manifest <nl> - } ) <nl> + } ) , <nl> + new CopyWebpackPlugin ( [ <nl> + { <nl> + from : ` $ { rootPath } / static / public ` , <nl> + to : ' . / ' <nl> + } <nl> + ] ) <nl> ] ) , <nl> target : ' web ' <nl> } <nl> 
mmm a / src / utils / popup / popup - manager . js <nl> ppp b / src / utils / popup / popup - manager . js <nl> } <nl> } <nl> } ; <nl> - ! Vue . prototype . $ isServer & & window . addEventListener ( ' keydown ' , function ( event ) { <nl> - if ( event . keyCode = = = 27 ) { / / ESC <nl> + <nl> + const getTopPopup = function ( ) { <nl> + if ( Vue . prototype . $ isServer ) return ; <nl> if ( PopupManager . modalStack . length > 0 ) { <nl> - const topItem = PopupManager . modalStack [ PopupManager . modalStack . length - 1 ] ; <nl> - if ( ! topItem ) return ; <nl> - const instance = PopupManager . getInstance ( topItem . id ) ; <nl> - if ( instance . closeOnPressEscape ) { <nl> - instance . handleClose <nl> - ? instance . handleClose ( ) <nl> - : ( instance . handleAction ? instance . handleAction ( ' cancel ' ) : instance . close ( ) ) ; <nl> + const topPopup = PopupManager . modalStack [ PopupManager . modalStack . length - 1 ] ; <nl> + if ( ! topPopup ) return ; <nl> + const instance = PopupManager . getInstance ( topPopup . id ) ; <nl> + <nl> + return instance ; <nl> } <nl> + } ; <nl> + <nl> + if ( ! Vue . prototype . $ isServer ) { <nl> + / / handle ` esc ` key when the popup is shown <nl> + window . addEventListener ( ' keydown ' , function ( event ) { <nl> + if ( event . keyCode = = = 27 ) { <nl> + const topPopup = getTopPopup ( ) ; <nl> + <nl> + if ( topPopup & & topPopup . closeOnPressEscape ) { <nl> + topPopup . handleClose <nl> + ? topPopup . handleClose ( ) <nl> + : ( topPopup . handleAction ? topPopup . handleAction ( ' cancel ' ) : topPopup . close ( ) ) ; <nl> } <nl> } <nl> } ) ; <nl> + / / keep focusing inside the popup by ` tab ` key <nl> + document . addEventListener ( ' focusin ' , function ( event ) { <nl> + const topPopup = getTopPopup ( ) ; <nl> + <nl> + if ( topPopup & & ! topPopup . $ el . contains ( event . target ) ) { <nl> + event . stopPropagation ( ) ; <nl> + topPopup . $ el . focus ( ) ; <nl> + } <nl> + } ) ; <nl> + } <nl> + <nl> export default PopupManager ; <nl> 
mmm a / packages / menu / src / menu . vue <nl> ppp b / packages / menu / src / menu . vue <nl> } , <nl> watch : { <nl> - defaultActive ( value ) { <nl> - const item = this . items [ value ] ; <nl> - if ( item ) { <nl> - this . activeIndex = item . index ; <nl> - this . initOpenedMenu ( ) ; <nl> - } else { <nl> - this . activeIndex = ' ' ; <nl> - } <nl> + defaultActive : ' updateActiveIndex ' , <nl> - } , <nl> defaultOpeneds ( value ) { <nl> if ( ! this . collapse ) { <nl> this . openedMenus = value ; <nl> } <nl> } , <nl> + <nl> collapse ( value ) { <nl> if ( value ) this . openedMenus = [ ] ; <nl> } <nl> } , <nl> methods : { <nl> + updateActiveIndex ( ) { <nl> + const item = this . items [ this . defaultActive ] ; <nl> + if ( item ) { <nl> + this . activeIndex = item . index ; <nl> + this . initOpenedMenu ( ) ; <nl> + } else { <nl> + this . activeIndex = null ; <nl> + } <nl> + } , <nl> + <nl> getMigratingConfig ( ) { <nl> return { <nl> props : { <nl> if ( this . mode = = = ' horizontal ' ) { <nl> new Menubar ( this . $ el ) ; / / eslint - disable - line <nl> } <nl> + this . $ watch ( ' items ' , this . updateActiveIndex ) ; <nl> } <nl> } ; <nl> < / script > <nl> 
mmm a / jest . config . js <nl> ppp b / jest . config . js <nl> - testEnvironment : " jsdom " , <nl> + testEnvironment : ' jsdom ' , <nl> transform : { <nl> - " ^ . + \ \ . vue $ " : " vue - jest " , <nl> - " ^ . + \ \ js $ " : " babel - jest " , <nl> + ' ^ . + \ \ . vue $ ' : ' vue - jest ' , <nl> + ' ^ . + \ \ js $ ' : ' babel - jest ' <nl> } , <nl> - moduleFileExtensions : [ " vue " , " js " , " json " , " jsx " , " ts " , " tsx " , " node " ] , <nl> - testMatch : [ " * * / tests / ? ( * . ) + ( test ) . [ jt ] s ? ( x ) " ] , <nl> - } ; <nl> + moduleFileExtensions : [ ' vue ' , ' js ' , ' json ' , ' jsx ' , ' ts ' , ' tsx ' , ' node ' ] , <nl> + testMatch : [ ' * * / tests / ? ( * . ) + ( test ) . [ jt ] s ? ( x ) ' ] , <nl> + moduleNameMapper : { <nl> + ' ^ element - ui ( . * ) $ ' : ' < rootDir > $ 1 ' , <nl> + ' ^ main ( . * ) $ ' : ' < rootDir > / src $ 1 ' <nl> + } <nl> + } <nl> 
mmm a / src / utils / resize - event . js <nl> ppp b / src / utils / resize - event . js <nl> import ResizeObserver from ' resize - observer - polyfill ' <nl> const isServer = typeof window = = = ' undefined ' <nl> @ @ - 14 , 6 + 15 , 36 @ @ const resizeHandler = function ( entries ) { <nl> } <nl> } <nl> + export const useResizeEvent = ( ) = > { <nl> + let element = null <nl> + <nl> + const addResizeListener = ( fn ) = > { <nl> + element . __resizeListeners__ . push ( fn ) <nl> + } <nl> + <nl> + const removeResizeListener = ( fn ) = > { <nl> + if ( ! element | | ! element . __resizeListeners__ ) return <nl> + element . __resizeListeners__ . splice ( element . __resizeListeners__ . indexOf ( fn ) , 1 ) <nl> + if ( ! element . __resizeListeners__ . length ) { <nl> + element . __ro__ . disconnect ( ) <nl> + } <nl> + } <nl> + onMounted ( ( ) = > { <nl> + element = getCurrentInstance ( ) . vnode . el <nl> + if ( isServer ) return <nl> + if ( ! element . __resizeListeners__ ) { <nl> + element . __resizeListeners__ = [ ] <nl> + element . __ro__ = new ResizeObserver ( resizeHandler ) <nl> + element . __ro__ . observe ( element ) <nl> + } <nl> + } ) <nl> + <nl> + return { <nl> + addResizeListener , <nl> + removeResizeListener <nl> + } <nl> + } <nl> + <nl> / * istanbul ignore next * / <nl> export const addResizeListener = function ( element , fn ) { <nl> if ( isServer ) return <nl> 
mmm a / test / unit / tests / use / component . test . js <nl> ppp b / test / unit / tests / use / component . test . js <nl> + import { createComponent , unmountComponent } from ' main / use / component . js ' <nl> describe ( ' component ' , ( ) = > { <nl> describe ( ' createComponent ' , ( ) = > { <nl> @ @ - 19 , 5 + 19 , 16 @ @ describe ( ' component ' , ( ) = > { <nl> expect ( $ cf ) . toBeCalled ( ) <nl> expect ( instance . ctx . $ el . innerHTML ) . toBe ( ' foo ' ) <nl> } ) <nl> + <nl> + it ( ' the specified component should be destroyed ' , ( ) = > { <nl> + const Comp = { <nl> + template : ' < div > foo < / div > ' <nl> + } <nl> + <nl> + const instance = createComponent ( Comp ) <nl> + expect ( instance . isMounted ) . toBe ( true ) <nl> + unmountComponent ( instance ) <nl> + expect ( instance . isUnmounted ) . toBe ( true ) <nl> + } ) <nl> } ) <nl> } ) <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test : watch " : " npm run build : theme & & cross - env BABEL_ENV = test karma start test / unit / karma . conf . js " , <nl> " test : unit " : " jest " , <nl> - " build : next " : " rollup - c " <nl> + " build : next " : " rollup - c " , <nl> + " release " : " node scripts / release . js " <nl> } , <nl> " faas " : [ <nl> { <nl> " babel - preset - stage - 2 " : " ^ 6 . 24 . 1 " , <nl> " babel - regenerator - runtime " : " ^ 6 . 5 . 0 " , <nl> " chai " : " ^ 4 . 2 . 0 " , <nl> + " chalk " : " ^ 4 . 1 . 0 " , <nl> " chokidar " : " ^ 1 . 7 . 0 " , <nl> " copy - webpack - plugin " : " ^ 5 . 0 . 0 " , <nl> " coveralls " : " ^ 3 . 0 . 3 " , <nl> " cp - cli " : " ^ 1 . 0 . 2 " , <nl> " cross - env " : " ^ 3 . 1 . 3 " , <nl> " css - loader " : " ^ 2 . 1 . 0 " , <nl> + " enquirer " : " ^ 2 . 3 . 6 " , <nl> " es6 - promise " : " ^ 4 . 0 . 5 " , <nl> " eslint " : " ^ 7 . 7 . 0 " , <nl> " eslint - config - prettier " : " ^ 6 . 11 . 0 " , <nl> " eslint - plugin - promise " : " ^ 4 . 2 . 1 " , <nl> " eslint - plugin - standard " : " ^ 4 . 0 . 1 " , <nl> " eslint - plugin - vue " : " ^ 6 . 2 . 2 " , <nl> + " execa " : " ^ 4 . 0 . 3 " , <nl> " file - loader " : " ^ 1 . 1 . 11 " , <nl> " file - save " : " ^ 0 . 2 . 0 " , <nl> " gulp " : " ^ 4 . 0 . 0 " , <nl> " markdown - it - chain " : " ^ 1 . 3 . 0 " , <nl> " markdown - it - container " : " ^ 2 . 0 . 0 " , <nl> " mini - css - extract - plugin " : " ^ 0 . 4 . 1 " , <nl> + " minimist " : " ^ 1 . 2 . 5 " , <nl> " mitt " : " ^ 2 . 1 . 0 " , <nl> " mocha " : " ^ 6 . 0 . 2 " , <nl> " node - sass " : " ^ 4 . 11 . 0 " , <nl> 
mmm a / packages / dropdown / src / __tests__ / Dropdown . spec . js <nl> ppp b / packages / dropdown / src / __tests__ / Dropdown . spec . js <nl> - import DropdownMenu from ' . . / dropdown - menu . vue ' <nl> - import DropdownItem from ' . . / dropdown - item . vue ' <nl> - <nl> + import ' @ testing - library / jest - dom ' <nl> import { mount } from ' @ vue / test - utils ' <nl> import { nextTick , ref } from ' vue ' <nl> import sinon from ' sinon ' <nl> + import Dropdown from ' . . / dropdown . vue ' <nl> + import DropdownMenu from ' . . / dropdown - menu . vue ' <nl> + import DropdownItem from ' . . / dropdown - item . vue ' <nl> + <nl> const components = { <nl> ElDropdown : Dropdown , <nl> ElDropdownMenu : DropdownMenu , <nl> ElDropdownItem : DropdownItem <nl> } <nl> + jest . useFakeTimers ( ) <nl> + <nl> const wait = ( time = 300 ) = > { <nl> - return new Promise ( ( resolve ) = > { <nl> - setTimeout ( resolve , time ) <nl> - } ) <nl> + jest . runAllTimers ( ) <nl> } <nl> describe ( ' Dropdown ' , ( ) = > { <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> const { value , type , emitComponentInstance } = e <nl> if ( type = = = BROADCAST ) { <nl> if ( isChildComponent ( currentComponentInstance , emitComponentInstance ) ) { <nl> - handler & & handler ( value ) <nl> + handler & & handler ( . . . value ) <nl> } <nl> } else if ( type = = = DISPATCH ) { <nl> if ( isChildComponent ( emitComponentInstance , currentComponentInstance ) ) { <nl> - handler & & handler ( value ) <nl> + handler & & handler ( . . . value ) <nl> } <nl> } else { <nl> - handler & & handler ( value ) <nl> + handler & & handler ( . . . value ) <nl> } <nl> } <nl> @ @ - 32 , 19 + 32 , 19 @ @ export function useEmitter ( ) { <nl> emitter . on ( type , handleWrapper ) <nl> } <nl> - function broadcast ( type , evt ) { <nl> + function broadcast ( type , . . . args ) { <nl> emitter . emit ( type , { <nl> type : BROADCAST , <nl> emitComponentInstance : currentComponentInstance , <nl> - value : evt <nl> + value : args <nl> } ) <nl> } <nl> - function dispatch ( type , evt ) { <nl> + function dispatch ( type , . . . args ) { <nl> emitter . emit ( type , { <nl> type : DISPATCH , <nl> emitComponentInstance : currentComponentInstance , <nl> - value : evt <nl> + value : args <nl> } ) <nl> } <nl> @ @ - 52 , 9 + 52 , 9 @ @ export function useEmitter ( ) { <nl> emitter . off ( type , handler [ wrapper ] ) <nl> } <nl> - function emit ( type , evt ) { <nl> + function emit ( type , . . . args ) { <nl> emitter . emit ( type , { <nl> - value : evt <nl> + value : args <nl> } ) <nl> } <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> } <nl> function once ( type , handler ) { <nl> - const handleOn = ( ) = > { <nl> - handler & & handler ( ) <nl> + const handleOn = ( . . . args ) = > { <nl> + handler & & handler ( . . . args ) <nl> off ( type , handleOn ) <nl> } <nl> on ( type , handleOn ) <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> emitter . off ( type , handler [ wrapper ] ) <nl> } <nl> - function emit ( type , . . . args ) { <nl> - emitter . emit ( type , { <nl> - value : args <nl> - } ) <nl> - } <nl> - <nl> function once ( type , handler ) { <nl> const handleOn = ( . . . args ) = > { <nl> handler & & handler ( . . . args ) <nl> @ @ - 71 , 7 + 65 , 6 @ @ export function useEmitter ( ) { <nl> broadcast , <nl> dispatch , <nl> off , <nl> - emit , <nl> once <nl> } <nl> } <nl> 
mmm a / src / entry . js <nl> ppp b / src / entry . js <nl> import ElIcon from ' . . / packages / icon ' <nl> import ElBreadcrumb from ' . . / packages / breadcrumb ' <nl> import ElBreadcrumbItem from ' . . / packages / breadcrumb - item ' <nl> + import ElBacktop from ' . . / packages / backtop ' <nl> import { version } from ' . . / package . json ' <nl> const components = [ <nl> @ @ - 19 , 7 + 20 , 8 @ @ const components = [ <nl> ElLink , <nl> ElIcon , <nl> ElBreadcrumb , <nl> - ElBreadcrumbItem <nl> + ElBreadcrumbItem , <nl> + ElBacktop <nl> ] <nl> const install = ( app ) = > { <nl> @ @ - 42 , 7 + 44 , 8 @ @ export { <nl> ElLink , <nl> ElIcon , <nl> ElBreadcrumb , <nl> - ElBreadcrumbItem <nl> + ElBreadcrumbItem , <nl> + ElBacktop <nl> } <nl> export default elementUI <nl> 
mmm a / src / entry . js <nl> ppp b / src / entry . js <nl> ] <nl> const install = ( app , opts = { } ) = > { <nl> - app . config . globalProperties . $ ELEMENT = { <nl> - size : opts . size | | ' ' , <nl> - zIndex : opts . zIndex | | 2000 <nl> - } <nl> + app . use ( setupGlobalOptions ( opts ) ) <nl> components . forEach ( ( component ) = > { <nl> app . use ( component ) <nl> } ) <nl> } <nl> + const setupGlobalOptions = ( opts = { } ) = > { <nl> + return ( app ) = > { <nl> + app . config . globalProperties . $ ELEMENT = { <nl> + size : opts . size | | ' ' , <nl> + zIndex : opts . zIndex | | 2000 <nl> + } <nl> + } <nl> + } <nl> + <nl> const elementUI = { <nl> version , <nl> install <nl> @ @ - 271 , 7 + 277 , 8 @ @ export { <nl> usePrompt , <nl> useConfirm , <nl> useNotify , <nl> - install <nl> + install , <nl> + setupGlobalOptions <nl> } <nl> export default elementUI <nl> 
mmm a / packages / message - box / index . js <nl> ppp b / packages / message - box / index . js <nl> export function useMsgbox ( ) { <nl> return { <nl> - msgbox : MessageBox , <nl> - alert : MessageBox . alert , <nl> - confirm : MessageBox . confirm , <nl> - prompt : MessageBox . prompt <nl> + $ msgbox : MessageBox , <nl> + $ alert : MessageBox . alert , <nl> + $ confirm : MessageBox . confirm , <nl> + $ prompt : MessageBox . prompt <nl> } <nl> } <nl> 
mmm a / types / icon . d . ts <nl> ppp b / types / icon . d . ts <nl> + export const ElIcon : IIcon <nl> / * * Icon Component * / <nl> - export declare class ElIcon extends ElementUIComponent { <nl> + export interface IIcon extends ElementUIComponent { <nl> / * * Icon name * / <nl> name : string <nl> } <nl> 
mmm a / src / entry . js <nl> ppp b / src / entry . js <nl> import ElMain from ' . . / packages / main ' <nl> import ElIcon from ' . . / packages / icon ' <nl> import ElButton from ' . . / packages / button ' <nl> + import ElButtonGroup from ' . . / packages / button - group ' <nl> import ElLink from ' . . / packages / link ' <nl> / / Form <nl> import ElRadio from ' . . / packages / radio ' <nl> @ @ - 102 , 6 + 103 , 7 @ @ const components = [ <nl> ElAlert , <nl> ElContainer , <nl> ElButton , <nl> + ElButtonGroup , <nl> ElSwitch , <nl> ElProgress , <nl> ElLink , <nl> @ @ - 205 , 6 + 207 , 7 @ @ export { <nl> ElMain , <nl> ElAlert , <nl> ElButton , <nl> + ElButtonGroup , <nl> ElSwitch , <nl> ElProgress , <nl> ElLink , <nl> 
mmm a / packages / element3 / packages / switch / __tests__ / Switch . spec . js <nl> ppp b / packages / element3 / packages / switch / __tests__ / Switch . spec . js <nl> expect ( wrapper . emitted ( ' update : modelValue ' ) ) . toEqual ( [ [ ' 3 ' ] ] ) <nl> } ) <nl> + it ( ' handleClick ' , async ( ) = > { <nl> + const wrapper = mount ( Switch , { <nl> + props : { <nl> + isChecked : true , <nl> + disabled : false , <nl> + activeValue : ' 2 ' , <nl> + inactiveValue : ' 3 ' <nl> + } <nl> + } ) <nl> + await wrapper . find ( ' . el - switch ' ) . trigger ( ' click ' ) <nl> + expect ( wrapper . emitted ( ' update : modelValue ' ) ) . toEqual ( [ [ ' 3 ' ] , [ ' 2 ' ] ] ) <nl> + expect ( wrapper . emitted ( ' update : change ' ) ) . toEqual ( [ [ ' 2 ' ] ] ) <nl> + } ) <nl> } ) <nl> 
mmm a / packages / element3 / src / components / Table / src / Table . vue <nl> ppp b / packages / element3 / src / components / Table / src / Table . vue <nl> < thead > <nl> < tr > <nl> - < template v - for = " ( column , index ) in columns " : key = " index " > <nl> + < template v - for = " ( column , index ) in tableHeads " : key = " index " > <nl> < th > { { column . label } } < / th > <nl> < / template > <nl> < / tr > <nl> < / tr > <nl> < / template > <nl> < / tbody > <nl> + < slot > < / slot > <nl> < / table > <nl> < / template > <nl> - <nl> < script > <nl> - import { computed , defineComponent , unref } from ' vue ' <nl> + import { <nl> + computed , <nl> + defineComponent , <nl> + ref , <nl> + provide , <nl> + getCurrentInstance , <nl> + toRefs <nl> + } from ' vue ' <nl> export default defineComponent ( { <nl> name : ' ElNewTable ' , <nl> props : [ ' data ' ] , <nl> - setup ( props , { slots } ) { <nl> - const columns = computed ( ( ) = > { <nl> - const tableColumns = slots . default ( ) <nl> + setup ( props ) { <nl> + const { data } = toRefs ( props ) <nl> + <nl> + useProvide ( ) <nl> + <nl> + const { columns , registryColumn } = useColumns ( ) <nl> + const { tableHeads } = useTableHeads ( columns ) <nl> + const { rows } = useRows ( data , tableHeads ) <nl> + <nl> + return { <nl> + registryColumn , <nl> + tableHeads , <nl> + rows <nl> + } <nl> + } <nl> + } ) <nl> + <nl> + function useProvide ( ) { <nl> + const instance = getCurrentInstance ( ) <nl> + <nl> + provide ( ' table ' , instance . proxy ) <nl> + } <nl> + <nl> + function useColumns ( ) { <nl> + const columns = ref ( [ ] ) <nl> + function registryColumn ( column ) { <nl> + columns . value . push ( column ) <nl> + } <nl> - return tableColumns . map ( ( columnsVnode ) = > { <nl> - const { prop , label } = columnsVnode . props <nl> + return { <nl> + columns , <nl> + registryColumn <nl> + } <nl> + } <nl> + <nl> + function useTableHeads ( columns ) { <nl> + const tableHeads = computed ( ( ) = > { <nl> + return columns . value . map ( ( columnVM ) = > { <nl> + const { prop , label } = columnVM . props <nl> return { <nl> prop , <nl> label <nl> @ @ - 35 , 22 + 75 , 25 @ @ export default defineComponent ( { <nl> } ) <nl> } ) <nl> - function createRows ( columns ) { <nl> - return computed ( ( ) = > { <nl> - return props . data . map ( ( item ) = > { <nl> - return columns . reduce ( ( result , { prop : key } ) = > { <nl> + return { <nl> + tableHeads <nl> + } <nl> + } <nl> + <nl> + function useRows ( data , tableHeads ) { <nl> + const rows = computed ( ( ) = > { <nl> + return data . value . map ( ( item ) = > { <nl> + return tableHeads . value . reduce ( ( result , { prop : key } ) = > { <nl> result [ key ] = item [ key ] <nl> return result <nl> } , { } ) <nl> } ) <nl> } ) <nl> - } <nl> - <nl> - const rows = createRows ( unref ( columns ) ) <nl> - return { columns , rows } <nl> + return { <nl> + rows <nl> + } <nl> } <nl> - } ) <nl> < / script > <nl> < style > < / style > <nl> 
mmm a / src / components / link / Link . vue <nl> ppp b / src / components / link / Link . vue <nl> type ? : LinkType <nl> underline ? : boolean <nl> disabled ? : boolean <nl> + href ? : string <nl> } <nl> const props = withDefaults ( defineProps < LinkProps > ( ) , { <nl> @ @ - 27 , 7 + 28 , 11 @ @ const classes = useClasses ( props ) <nl> < / script > <nl> < template > <nl> - < a class = " el - link " : class = " classes " > <nl> + < a <nl> + class = " el - link " <nl> + : class = " classes " <nl> + : href = " disabled ? null : href " <nl> + > <nl> < span v - if = " $ slots . default " class = " el - link - - inner " > <nl> < slot / > <nl> < / span > <nl> 
mmm a / src / components / button / Button . vue <nl> ppp b / src / components / button / Button . vue <nl> type buttonType = ' primary ' | ' success ' | ' warning ' | ' danger ' | ' info ' | ' text ' <nl> type buttonSize = ' medium ' | ' small ' | ' mini ' <nl> - type ButtonRound = true | false <nl> - <nl> interface ButtonProps { <nl> type ? : buttonType <nl> size ? : buttonSize <nl> - round ? : ButtonRound <nl> + round ? : boolean <nl> + plain ? : boolean <nl> } <nl> const props = defineProps < ButtonProps > ( ) <nl> @ @ - 20 , 7 + 19 , 10 @ @ function useClasses ( props ) { <nl> return [ <nl> props . type ? ` el - button - - $ { props . type } ` : ' ' , <nl> props . size ? ` el - button - - $ { props . size } ` : ' ' , <nl> - props . round ? ' is - round ' : ' ' , <nl> + { <nl> + ' is - round ' : props . round , <nl> + ' is - plain ' : props . plain , <nl> + } , <nl> ] <nl> } ) <nl> } <nl> 
mmm a / src / components / button / __test__ / button . spec . ts <nl> ppp b / src / components / button / __test__ / button . spec . ts <nl> expect ( getByRole ( ' button ' ) ) . not . toHaveClass ( ' is - circle ' ) <nl> } ) <nl> + describe ( ' set button disabled ' , ( ) = > { <nl> + it ( ' by props . disabled ' , async ( ) = > { <nl> + const { getByRole , rerender } = render ( Button , { <nl> + props : { <nl> + disabled : true , <nl> + } , <nl> + } ) <nl> + <nl> + const buttonElement = getByRole ( ' button ' ) <nl> + <nl> + expect ( buttonElement ) . toHaveClass ( ' is - disabled ' ) <nl> + expect ( buttonElement ) . toHaveAttribute ( ' disabled ' ) <nl> + <nl> + await rerender ( { <nl> + disabled : false , <nl> + } ) <nl> + expect ( getByRole ( ' button ' ) ) . not . toHaveClass ( ' is - disabled ' ) <nl> + expect ( getByRole ( ' button ' ) ) . not . toHaveAttribute ( ' disabled ' ) <nl> + } ) <nl> + } ) <nl> + <nl> + describe ( ' set button icon ' , ( ) = > { <nl> + it ( ' set props icon ' , ( ) = > { <nl> + const { getByTestId } = render ( Button , { <nl> + props : { <nl> + icon : ' el - icon - edit ' , <nl> + } , <nl> + } ) <nl> + expect ( getByTestId ( ' icon ' ) ) . toBeInTheDocument ( ) <nl> + } ) <nl> + <nl> + it ( ' if loading is true , the icon will not be displayed ' , ( ) = > { <nl> + const { getByTestId , queryByTestId } = render ( Button , { <nl> + props : { <nl> + loading : true , <nl> + icon : ' el - icon - edit ' , <nl> + } , <nl> + } ) <nl> + expect ( queryByTestId ( ' icon ' ) ) . not . toBeInTheDocument ( ) <nl> + expect ( getByTestId ( ' loadingIcon ' ) ) . toBeInTheDocument ( ) <nl> + } ) <nl> + } ) <nl> + <nl> + / / button autofocus <nl> + it ( ' set button autofocus ' , ( ) = > { <nl> + const { getByRole } = render ( Button , { <nl> + props : { <nl> + autofocus : true , <nl> + } , <nl> + } ) <nl> + <nl> + expect ( getByRole ( ' button ' ) ) . toHaveAttribute ( ' autofocus ' ) <nl> + } ) <nl> + <nl> / / native type : button | reset | submit <nl> it ( ' set button native type ' , ( ) = > { <nl> const { getByRole } = render ( Button , { <nl> 
mmm a / src / index . ts <nl> ppp b / src / index . ts <nl> import { ElLink } from ' . / components / link / ' <nl> import { ElIcon } from ' . / components / icon / ' <nl> import { ElBadge } from ' . / components / badge / ' <nl> - import { ElButton } from ' . / components / Button / ' <nl> + import { ElButton } from ' . / components / button / ' <nl> import ' / theme / src / icon . scss ' <nl> const components = [ <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> $ table - dark - accent - bg : rgba ( $ white , . 05 ) ! default ; <nl> $ table - dark - hover - bg : rgba ( $ white , . 075 ) ! default ; <nl> $ table - dark - border - color : lighten ( $ gray - 900 , 7 . 5 % ) ! default ; <nl> - $ table - dark - color : $ body - bg ! default ; <nl> + $ table - dark - color : $ white ! default ; <nl> $ table - striped - order : odd ! default ; <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> $ blockquote - small - font - size : $ small - font - size ! default ; <nl> $ blockquote - font - size : $ font - size - base * 1 . 25 ! default ; <nl> + $ hr - margin - y : $ spacer ! default ; <nl> $ hr - color : inherit ! default ; <nl> $ hr - height : $ border - width ! default ; <nl> $ hr - opacity : . 25 ! default ; <nl> @ @ - 446 , 8 + 447 , 6 @ @ $ list - inline - padding : . 5rem ! default ; <nl> $ mark - bg : # fcf8e3 ! default ; <nl> - $ hr - margin - y : $ spacer ! default ; <nl> - <nl> / / Tables <nl> / / <nl> 
mmm a / scss / mixins / _grid . scss <nl> ppp b / scss / mixins / _grid . scss <nl> } <nl> + @ if $ grid - row - columns > 0 { <nl> @ for $ i from 1 through $ grid - row - columns { <nl> . row - cols # { $ infix } - # { $ i } { <nl> @ include row - cols ( $ i ) ; <nl> } <nl> } <nl> + } <nl> . col # { $ infix } - auto { <nl> @ include make - col - auto ( ) ; <nl> 
mmm a / scss / _functions . scss <nl> ppp b / scss / _functions . scss <nl> / / Used to ensure the min - width of the lowest breakpoint starts at 0 . <nl> @ mixin _assert - starts - at - zero ( $ map , $ map - name : " $ grid - breakpoints " ) { <nl> + @ if length ( $ map ) > 0 { <nl> $ values : map - values ( $ map ) ; <nl> $ first - value : nth ( $ values , 1 ) ; <nl> @ if $ first - value ! = 0 { <nl> @ warn " First breakpoint in # { $ map - name } must start at 0 , but starts at # { $ first - value } . " ; <nl> } <nl> } <nl> + } <nl> / / Internal Bootstrap function to turn maps into its negative variant . <nl> / / It prefixes the keys with ` n ` and makes the value negative . <nl> 
mmm a / scss / _functions . scss <nl> ppp b / scss / _functions . scss <nl> $ _luminance - list : . 0008 . 001 . 0011 . 0013 . 0015 . 0017 . 002 . 0022 . 0025 . 0027 . 003 . 0033 . 0037 . 004 . 0044 . 0048 . 0052 . 0056 . 006 . 0065 . 007 . 0075 . 008 . 0086 . 0091 . 0097 . 0103 . 011 . 0116 . 0123 . 013 . 0137 . 0144 . 0152 . 016 . 0168 . 0176 . 0185 . 0194 . 0203 . 0212 . 0222 . 0232 . 0242 . 0252 . 0262 . 0273 . 0284 . 0296 . 0307 . 0319 . 0331 . 0343 . 0356 . 0369 . 0382 . 0395 . 0409 . 0423 . 0437 . 0452 . 0467 . 0482 . 0497 . 0513 . 0529 . 0545 . 0561 . 0578 . 0595 . 0612 . 063 . 0648 . 0666 . 0685 . 0704 . 0723 . 0742 . 0762 . 0782 . 0802 . 0823 . 0844 . 0865 . 0887 . 0908 . 0931 . 0953 . 0976 . 0999 . 1022 . 1046 . 107 . 1095 . 1119 . 1144 . 117 . 1195 . 1221 . 1248 . 1274 . 1301 . 1329 . 1356 . 1384 . 1413 . 1441 . 147 . 15 . 1529 . 1559 . 159 . 162 . 1651 . 1683 . 1714 . 1746 . 1779 . 1812 . 1845 . 1878 . 1912 . 1946 . 1981 . 2016 . 2051 . 2086 . 2122 . 2159 . 2195 . 2232 . 227 . 2307 . 2346 . 2384 . 2423 . 2462 . 2502 . 2542 . 2582 . 2623 . 2664 . 2705 . 2747 . 2789 . 2831 . 2874 . 2918 . 2961 . 3005 . 305 . 3095 . 314 . 3185 . 3231 . 3278 . 3325 . 3372 . 3419 . 3467 . 3515 . 3564 . 3613 . 3663 . 3712 . 3763 . 3813 . 3864 . 3916 . 3968 . 402 . 4072 . 4125 . 4179 . 4233 . 4287 . 4342 . 4397 . 4452 . 4508 . 4564 . 4621 . 4678 . 4735 . 4793 . 4851 . 491 . 4969 . 5029 . 5089 . 5149 . 521 . 5271 . 5333 . 5395 . 5457 . 552 . 5583 . 5647 . 5711 . 5776 . 5841 . 5906 . 5972 . 6038 . 6105 . 6172 . 624 . 6308 . 6376 . 6445 . 6514 . 6584 . 6654 . 6724 . 6795 . 6867 . 6939 . 7011 . 7084 . 7157 . 7231 . 7305 . 7379 . 7454 . 7529 . 7605 . 7682 . 7758 . 7835 . 7913 . 7991 . 807 . 8148 . 8228 . 8308 . 8388 . 8469 . 855 . 8632 . 8714 . 8796 . 8879 . 8963 . 9047 . 9131 . 9216 . 9301 . 9387 . 9473 . 956 . 9647 . 9734 . 9823 . 9911 1 ; <nl> - @ function color - contrast ( $ background , $ color - contrast - dark : $ color - contrast - dark , $ color - contrast - light : $ color - contrast - light ) { <nl> + @ function color - contrast ( $ background , $ color - contrast - dark : $ color - contrast - dark , $ color - contrast - light : $ color - contrast - light , $ min - contrast - ratio : $ min - contrast - ratio ) { <nl> $ foregrounds : $ color - contrast - light , $ color - contrast - dark , $ white , $ black ; <nl> $ contrast - ratios : ( ) ; <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> $ warning : $ yellow ! default ; <nl> $ danger : $ red ! default ; <nl> $ light : $ gray - 100 ! default ; <nl> - $ dark : $ gray - 800 ! default ; <nl> + $ dark : $ gray - 900 ! default ; <nl> / / scss - docs - start theme - colors - map <nl> $ theme - colors : ( <nl> 
mmm a / scss / mixins / _breakpoints . scss <nl> ppp b / scss / mixins / _breakpoints . scss <nl> } <nl> + / / Name of the previous breakpoint , or null for the first breakpoint . <nl> + / / <nl> + / / > > breakpoint - before ( lg ) <nl> + / / md <nl> + / / > > breakpoint - next ( lg , ( xs : 0 , sm : 576px , md : 768px , lg : 992px , xl : 1200px ) ) <nl> + / / md <nl> + / / > > breakpoint - next ( lg , $ breakpoint - names : ( xs sm md lg xl ) ) <nl> + / / md <nl> + @ function breakpoint - before ( $ name , $ breakpoints : $ grid - breakpoints , $ breakpoint - names : map - keys ( $ breakpoints ) ) { <nl> + $ n : index ( $ breakpoint - names , $ name ) ; <nl> + @ return if ( $ n ! = null and $ n < length ( $ breakpoint - names ) , nth ( $ breakpoint - names , $ n - 1 ) , null ) ; <nl> + } <nl> + <nl> / / Minimum breakpoint width . Null for the smallest ( first ) breakpoint . <nl> / / <nl> / / > > breakpoint - min ( sm , ( xs : 0 , sm : 576px , md : 768px , lg : 992px , xl : 1200px ) ) <nl> 
mmm a / scss / _utilities . scss <nl> ppp b / scss / _utilities . scss <nl> class : border , <nl> values : map - merge ( $ theme - colors , ( " white " : $ white ) ) <nl> ) , <nl> + " border - top - color " : ( <nl> + property : border - top - color , <nl> + class : border - top , <nl> + values : map - merge ( $ theme - colors , ( " white " : $ white ) ) <nl> + ) , <nl> + " border - right - color " : ( <nl> + property : border - right - color , <nl> + class : border - right , <nl> + values : map - merge ( $ theme - colors , ( " white " : $ white ) ) <nl> + ) , <nl> + " border - bottom - color " : ( <nl> + property : border - bottom - color , <nl> + class : border - bottom , <nl> + values : map - merge ( $ theme - colors , ( " white " : $ white ) ) <nl> + ) , <nl> + " border - left - color " : ( <nl> + property : border - right - color , <nl> + class : border - left , <nl> + values : map - merge ( $ theme - colors , ( " white " : $ white ) ) <nl> + ) , <nl> " border - width " : ( <nl> property : border - width , <nl> class : border , <nl> values : $ border - widths <nl> ) , <nl> + " border - top - width " : ( <nl> + property : border - top - width , <nl> + class : border - top , <nl> + values : $ border - widths <nl> + ) , <nl> + " border - right - width " : ( <nl> + property : border - right - width , <nl> + class : border - right , <nl> + values : $ border - widths <nl> + ) , <nl> + " border - bottom - width " : ( <nl> + property : border - bottom - width , <nl> + class : border - bottom , <nl> + values : $ border - widths <nl> + ) , <nl> + " border - left - width " : ( <nl> + property : border - left - width , <nl> + class : border - left , <nl> + values : $ border - widths <nl> + ) , <nl> / / Sizing utilities <nl> " width " : ( <nl> property : width , <nl> 
mmm a / scss / mixins / _utilities . scss <nl> ppp b / scss / mixins / _utilities . scss <nl> $ property - class - modifier : if ( $ key , if ( $ property - class = = " " and $ infix = = " " , " " , " - " ) + $ key , " " ) ; <nl> + / / Generate also CSS Variable <nl> + $ generate - vars : if ( map - has - key ( $ utility , vars ) , map - get ( $ utility , vars ) , " false " ) ; <nl> + <nl> @ if map - get ( $ utility , rfs ) { <nl> / / Inside the media query <nl> @ if $ is - rfs - media - query { <nl> } <nl> . # { $ property - class + $ infix + $ property - class - modifier } { <nl> @ each $ property in $ properties { <nl> + @ if $ generate - vars = = true { <nl> # { $ property } : var ( - - # { $ variable - prefix } # { $ property - class + $ infix + $ property - class - modifier } , $ value ) if ( $ enable - important - utilities , ! important , null ) ; <nl> } <nl> + @ else { <nl> + # { $ property } : $ value if ( $ enable - important - utilities , ! important , null ) ; <nl> + } <nl> + } <nl> } <nl> @ each $ pseudo in $ state { <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> $ primary - 25 : # ccc7f6 ! default ; <nl> $ secondary - dark : # 212233 ! default ; <nl> - $ secondary : # 3c4b64 ! default ; <nl> + $ secondary : # 9da5b1 ! default ; <nl> $ secondary - 50 : # 9da5b1 ! default ; <nl> $ secondary - 25 : # ced2d8 ! default ; <nl> @ @ - 115 , 9 + 115 , 9 @ @ $ theme - colors : ( <nl> / / scss - docs - end theme - colors - map <nl> / / Text colors <nl> - $ high - emphasis - dark : rgba ( $ black , . 87 ) ! default ; <nl> - $ medium - emphasis - dark : rgba ( $ black , . 6 ) ! default ; <nl> - $ disabled - dark : rgba ( $ black , . 38 ) ! default ; <nl> + $ high - emphasis - dark : rgba ( shift - color ( $ gray - base , + 26 ) , . 87 ) ! default ; <nl> + $ medium - emphasis - dark : rgba ( shift - color ( $ gray - base , + 26 ) , . 6 ) ! default ; <nl> + $ disabled - dark : rgba ( shift - color ( $ gray - base , + 26 ) , . 38 ) ! default ; <nl> $ high - emphasis - light : rgba ( $ white , . 87 ) ! default ; <nl> $ medium - emphasis - light : rgba ( $ white , . 6 ) ! default ; <nl> @ @ - 399 , 7 + 399 , 7 @ @ $ border - widths : ( <nl> 5 : 5px <nl> ) ! default ; <nl> - $ border - color : $ gray - 300 ! default ; <nl> + $ border - color : $ gray - 200 ! default ; <nl> $ border - radius : . 25rem ! default ; <nl> $ border - radius - sm : . 2rem ! default ; <nl> @ @ - 454 , 6 + 454 , 8 @ @ $ font - size - lg : $ font - size - base * 1 . 25 ! default ; <nl> $ font - weight - lighter : lighter ! default ; <nl> $ font - weight - light : 300 ! default ; <nl> $ font - weight - normal : 400 ! default ; <nl> + $ font - weight - medium : 500 ! default ; <nl> + $ font - weight - semibold : 600 ! default ; <nl> $ font - weight - bold : 700 ! default ; <nl> $ font - weight - bolder : bolder ! default ; <nl> @ @ - 486 , 7 + 488 , 7 @ @ $ headings - font - family : null ! default ; <nl> $ headings - font - style : null ! default ; <nl> $ headings - font - weight : 500 ! default ; <nl> $ headings - line - height : 1 . 2 ! default ; <nl> - $ headings - color : null ! default ; <nl> + $ headings - color : unset ! default ; <nl> / / scss - docs - start display - headings <nl> $ display - font - sizes : ( <nl> @ @ - 750 , 7 + 752 , 7 @ @ $ form - check - input - width : 1em ! default ; <nl> $ form - check - min - height : $ font - size - base * $ line - height - base ! default ; <nl> $ form - check - padding - start : $ form - check - input - width + . 5em ! default ; <nl> $ form - check - margin - bottom : . 125rem ! default ; <nl> - $ form - check - label - color : null ! default ; <nl> + $ form - check - label - color : unset ! default ; <nl> $ form - check - label - cursor : null ! default ; <nl> $ form - check - transition : background - color . 15s ease - in - out , background - position . 15s ease - in - out , border - color . 15s ease - in - out , box - shadow . 15s ease - in - out ! default ; <nl> @ @ - 1074 , 9 + 1076 , 9 @ @ $ card - inner - border - radius : subtract ( $ card - border - radius , $ card - border - w <nl> $ card - cap - padding - y : $ card - spacer - y / 2 ! default ; <nl> $ card - cap - padding - x : $ card - spacer - x ! default ; <nl> $ card - cap - bg : rgba ( $ black , . 03 ) ! default ; <nl> - $ card - cap - color : null ! default ; <nl> + $ card - cap - color : unset ! default ; <nl> $ card - height : null ! default ; <nl> - $ card - color : null ! default ; <nl> + $ card - color : unset ! default ; <nl> $ card - bg : $ white ! default ; <nl> $ card - img - overlay - padding : $ spacer ! default ; <nl> @ @ - 1179 , 7 + 1181 , 7 @ @ $ toast - max - width : 350px ! default ; <nl> $ toast - padding - x : . 75rem ! default ; <nl> $ toast - padding - y : . 5rem ! default ; <nl> $ toast - font - size : . 875rem ! default ; <nl> - $ toast - color : null ! default ; <nl> + $ toast - color : unset ! default ; <nl> $ toast - background - color : rgba ( $ white , . 85 ) ! default ; <nl> $ toast - border - width : 1px ! default ; <nl> $ toast - border - color : rgba ( 0 , 0 , 0 , . 1 ) ! default ; <nl> @ @ - 1217 , 7 + 1219 , 7 @ @ $ modal - dialog - margin - y - sm - up : 1 . 75rem ! default ; <nl> $ modal - title - line - height : $ line - height - base ! default ; <nl> - $ modal - content - color : null ! default ; <nl> + $ modal - content - color : unset ! default ; <nl> $ modal - content - bg : $ white ! default ; <nl> $ modal - content - border - color : rgba ( $ black , . 2 ) ! default ; <nl> $ modal - content - border - width : $ border - width ! default ; <nl> @ @ - 1308 , 7 + 1310 , 7 @ @ $ progress - bar - transition : width . 6s ease ! default ; <nl> / / List group <nl> / / scss - docs - start list - group - variables <nl> - $ list - group - color : null ! default ; <nl> + $ list - group - color : unset ! default ; <nl> $ list - group - bg : $ white ! default ; <nl> $ list - group - border - color : rgba ( $ black , . 125 ) ! default ; <nl> $ list - group - border - width : $ border - width ! default ; <nl> @ @ - 1430 , 7 + 1432 , 7 @ @ $ breadcrumb - padding - y : 0 ! default ; <nl> $ breadcrumb - padding - x : 0 ! default ; <nl> $ breadcrumb - item - padding - x : . 5rem ! default ; <nl> $ breadcrumb - margin - bottom : 1rem ! default ; <nl> - $ breadcrumb - bg : null ! default ; <nl> + $ breadcrumb - bg : unset ! default ; <nl> $ breadcrumb - divider - color : $ gray - 600 ! default ; <nl> $ breadcrumb - active - color : $ gray - 600 ! default ; <nl> $ breadcrumb - divider : quote ( " / " ) ! default ; <nl> @ @ - 1605 , 4 + 1607 , 4 @ @ $ kbd - font - size : $ code - font - size ! default ; <nl> $ kbd - color : $ high - emphasis - light ! default ; <nl> $ kbd - bg : $ gray - 900 ! default ; <nl> - $ pre - color : null ! default ; <nl> + $ pre - color : unset ! default ; <nl> 
mmm a / scss / _reboot . scss <nl> ppp b / scss / _reboot . scss <nl> margin : 0 ; / / 1 <nl> font - family : $ font - family - base ; <nl> - @ include font - size ( $ font - size - base ) ; <nl> + @ include font - size ( var ( - - # { $ variable - prefix } font - size - base , $ font - size - base ) ) ; <nl> font - weight : $ font - weight - base ; <nl> line - height : $ line - height - base ; <nl> color : var ( - - # { $ variable - prefix } body - color , $ body - color ) ; <nl> 
mmm a / scss / _utilities . scss <nl> ppp b / scss / _utilities . scss <nl> light : $ font - weight - light , <nl> lighter : $ font - weight - lighter , <nl> normal : $ font - weight - normal , <nl> + medium : $ font - weight - medium , <nl> + semibold : $ font - weight - semibold , <nl> bold : $ font - weight - bold , <nl> bolder : $ font - weight - bolder <nl> ) <nl> @ @ - 492 , 8 + 494 , 15 @ @ $ utilities : map - merge ( <nl> " black - 50 " : rgba ( $ black , . 5 ) , <nl> " white - 50 " : rgba ( $ white , . 5 ) , <nl> " reset " : inherit , <nl> + " high - emphasis - light " : $ high - emphasis - light , <nl> + " medium - emphasis - light " : $ medium - emphasis - light , <nl> + " disabled - light " : $ disabled - light , <nl> + " high - emphasis - dark " : $ high - emphasis - dark , <nl> + " medium - emphasis - dark " : $ medium - emphasis - dark , <nl> + " disabled - dark " : $ disabled - dark <nl> ) <nl> - ) <nl> + ) , <nl> + vars : true <nl> ) , <nl> " line - height " : ( <nl> property : line - height , <nl> @ @ - 515 , 7 + 524 , 8 @ @ $ utilities : map - merge ( <nl> " white " : $ white , <nl> " transparent " : transparent <nl> ) <nl> - ) <nl> + ) , <nl> + vars : true <nl> ) , <nl> " gradient " : ( <nl> property : background - image , <nl> 
mmm a / scss / _utilities . scss <nl> ppp b / scss / _utilities . scss <nl> " border " : ( <nl> property : border , <nl> values : ( <nl> - null : $ border - width solid $ border - color , <nl> + null : $ border - width solid $ var ( - - # { $ variable - prefix } border - color , $ border - color ) , <nl> 0 : 0 , <nl> ) <nl> ) , <nl> " border - top " : ( <nl> property : border - top , <nl> values : ( <nl> - null : $ border - width solid $ border - color , <nl> + null : $ border - width solid $ var ( - - # { $ variable - prefix } border - color , $ border - color ) , <nl> 0 : 0 , <nl> ) <nl> ) , <nl> @ @ - 103 , 14 + 103 , 14 @ @ $ utilities : map - merge ( <nl> property : border - right , <nl> class : border - end , <nl> values : ( <nl> - null : $ border - width solid $ border - color , <nl> + null : $ border - width solid $ var ( - - # { $ variable - prefix } border - color , $ border - color ) , <nl> 0 : 0 , <nl> ) <nl> ) , <nl> " border - bottom " : ( <nl> property : border - bottom , <nl> values : ( <nl> - null : $ border - width solid $ border - color , <nl> + null : $ border - width solid $ var ( - - # { $ variable - prefix } border - color , $ border - color ) , <nl> 0 : 0 , <nl> ) <nl> ) , <nl> @ @ - 118 , 12 + 118 , 12 @ @ $ utilities : map - merge ( <nl> property : border - left , <nl> class : border - start , <nl> values : ( <nl> - null : $ border - width solid $ border - color , <nl> + null : $ border - width solid $ var ( - - # { $ variable - prefix } border - color , $ border - color ) , <nl> 0 : 0 , <nl> ) <nl> ) , <nl> - " border - color " : ( <nl> - property : border - color , <nl> + " var ( - - # { $ variable - prefix } border - color , $ border - color ) " : ( <nl> + property : var ( - - # { $ variable - prefix } border - color , $ border - color ) , <nl> class : border , <nl> values : map - merge ( $ theme - colors , ( " white " : $ white ) ) <nl> ) , <nl> 
mmm a / scss / _functions . scss <nl> ppp b / scss / _functions . scss <nl> @ return if ( $ l1 > $ l2 , ( $ l1 + . 05 ) / ( $ l2 + . 05 ) , ( $ l2 + . 05 ) / ( $ l1 + . 05 ) ) ; <nl> } <nl> + @ function contrast - ratio - correction ( $ color , $ background , $ scale , $ state ) { <nl> + @ if ( $ enable - contrast - ratio - correction ) { <nl> + $ contrast - ratio : contrast - ratio ( $ background , $ color ) ; <nl> + @ if $ contrast - ratio < $ min - contrast - ratio { <nl> + @ if $ enable - contrast - ratio - warnings { <nl> + @ warn " # { $ state } contrast ratio # { $ contrast - ratio } . " ; <nl> + } <nl> + @ return mix ( $ color , color - contrast ( $ background ) , abs ( $ scale ) ) ; <nl> + } <nl> + } <nl> + @ return $ color ; <nl> + } <nl> + <nl> / / Return WCAG2 . 0 relative luminance <nl> / / See https : / / www . w3 . org / WAI / GL / wiki / Relative_luminance <nl> / / See https : / / www . w3 . org / TR / WCAG20 - TECHS / G17 . html # G17 - tests <nl> 
mmm a / scss / mixins / _utilities . scss <nl> ppp b / scss / mixins / _utilities . scss <nl> } <nl> + / / Use class prefix if present <nl> + $ property - class - prefix : if ( map - has - key ( $ utility , prefix ) , map - get ( $ utility , prefix ) , null ) ; <nl> + $ property - class - prefix : if ( $ property - class - prefix = = null , " " , $ property - class - prefix ) ; <nl> + <nl> / / Use custom class if present <nl> $ property - class : if ( map - has - key ( $ utility , class ) , map - get ( $ utility , class ) , nth ( $ properties , 1 ) ) ; <nl> $ property - class : if ( $ property - class = = null , " " , $ property - class ) ; <nl> $ property - class - modifier : if ( $ key , if ( $ property - class = = " " and $ infix = = " " , " " , " - " ) + $ key , " " ) ; <nl> / / Generate also CSS Variable <nl> - $ generate - vars : if ( map - has - key ( $ utility , vars ) , map - get ( $ utility , vars ) , " false " ) ; <nl> - $ generate - rtl : if ( map - has - key ( $ utility , rtl ) , map - get ( $ utility , rtl ) , " false " ) ; <nl> + $ generate - vars : if ( map - has - key ( $ utility , vars ) , map - get ( $ utility , vars ) , false ) ; <nl> + $ generate - only - vars : if ( map - has - key ( $ utility , only - vars ) , map - get ( $ utility , only - vars ) , false ) ; <nl> + <nl> + / / Generate RTL version <nl> + $ generate - rtl : if ( map - has - key ( $ utility , rtl ) , map - get ( $ utility , rtl ) , false ) ; <nl> @ if map - get ( $ utility , rfs ) { <nl> / / Inside the media query <nl> @ if $ is - rtl = = false { <nl> / * rtl : begin : remove * / <nl> } <nl> - . # { $ property - class + $ infix + $ property - class - modifier } { <nl> + . # { $ property - class - prefix + $ property - class + $ infix + $ property - class - modifier } { <nl> @ each $ property in $ properties { <nl> - @ if $ generate - vars = = true { <nl> + @ if $ generate - vars = = true or $ generate - only - vars = = true { <nl> + @ if $ generate - only - vars { <nl> + # { $ property } : var ( - - # { $ variable - prefix } # { $ key } ) if ( $ enable - important - utilities , ! important , null ) ; <nl> + } <nl> + @ else { <nl> # { $ property } : var ( - - # { $ variable - prefix } # { $ key } , $ value ) if ( $ enable - important - utilities , ! important , null ) ; <nl> } <nl> + } <nl> @ else { <nl> @ if $ generate - rtl = = true { <nl> @ include ltr - rtl ( $ property , $ value , null , null , if ( $ enable - important - utilities , ! important , null ) ) ; <nl> 
mmm a / scss / mixins / _forms . scss <nl> ppp b / scss / mixins / _forms . scss <nl> @ if ( $ state = = " valid " or $ state = = " invalid " ) { <nl> . was - validated # { if ( & , " & " , " " ) } : # { $ state } , <nl> - # { if ( & , " & " , " " ) } . is - # { $ state } { <nl> + # { if ( & , " & " , " " ) } . is - # { $ state } , # { if ( & , " & " , " " ) } . ng - # { $ state } { <nl> @ content ; <nl> } <nl> } @ else { <nl> - # { if ( & , " & " , " " ) } . is - # { $ state } { <nl> + # { if ( & , " & " , " " ) } . is - # { $ state } , # { if ( & , " & " , " " ) } . ng - # { $ state } { <nl> @ content ; <nl> } <nl> } <nl> 
mmm a / src / react / Functions / EventStatusTexts . js <nl> ppp b / src / react / Functions / EventStatusTexts . js <nl> return " SEPA credit transfer " ; <nl> case " EBA_SDD " : <nl> return " SEPA direct debit " ; <nl> + case " CHECKOUT_MERCHANT " : <nl> + return " top up " ; <nl> } <nl> return paymentType ; <nl> } ; <nl> 
mmm a / packages / veui / src / components / Schedule . vue <nl> ppp b / packages / veui / src / components / Schedule . vue <nl> < button type = " button " : disabled = " realDisabled | | hour . isDisabled " <nl> : class = " mergeClass ( { ' veui - schedule - selected ' : hour . isSelected } , week [ i ] , j ) " <nl> - : ref = " ` $ { week [ i ] } - $ { j } ` " <nl> + : ref = " ` hour - $ { week [ i ] } - $ { j } ` " <nl> @ mousedown = " handleMousedown ( i , j ) " <nl> @ mouseenter = " handleHover ( i , j ) " <nl> - @ mouseup = " pick ( ) " > < slot name = " hour " : day = " week [ i ] " : hour = " j " / > < / button > <nl> + @ mouseup = " pick " <nl> + @ keydown . space . enter = " handleMousedown ( i , j ) " <nl> + @ keyup . space . enter = " pick " <nl> + @ keydown . up . prevent = " moveFocus ( ( i + 6 ) % 7 , j ) " <nl> + @ keydown . right . prevent = " moveFocus ( i , ( j + 25 ) % 24 ) " <nl> + @ keydown . down . prevent = " moveFocus ( ( i + 1 ) % 7 , j ) " <nl> + @ keydown . left . prevent = " moveFocus ( i , ( j + 23 ) % 24 ) " > < slot name = " hour " : day = " week [ i ] " : hour = " j " / > < / button > <nl> < / td > <nl> < / tr > <nl> < / table > <nl> @ @ - 239 , 7 + 245 , 7 @ @ export default { <nl> if ( ! current ) { <nl> return null <nl> } <nl> - return ` $ { current . day } - $ { current . hour } ` <nl> + return ` hour - $ { current . day } - $ { current . hour } ` <nl> } , <nl> currentLabel ( ) { <nl> let current = this . current <nl> @ @ - 366 , 6 + 372 , 15 @ @ export default { <nl> this . $ delete ( this . localSelected , day ) <nl> } <nl> this . $ emit ( ' select ' , this . localSelected ) <nl> + } , <nl> + moveFocus ( dayIndex , hour ) { <nl> + let day = this . week [ dayIndex ] <nl> + this . handleHover ( dayIndex , hour ) <nl> + <nl> + let el = ( this . $ refs [ ` hour - $ { day } - $ { hour } ` ] | | [ ] ) [ 0 ] <nl> + if ( el & & typeof el . focus = = = ' function ' ) { <nl> + el . focus ( ) <nl> + } <nl> } <nl> } <nl> } <nl> 
mmm a / packages / veui / src / components / Tree / _TreeNode . vue <nl> ppp b / packages / veui / src / components / Tree / _TreeNode . vue <nl> : class = " { ' veui - tree - item - expanded ' : option . expanded } " <nl> @ click = " click ( option , [ ] , index , depth ) " > <nl> - < slot name = " item " : option = " option " : index = " index " : depth = " depth " > <nl> + < slot name = " item " : item = " option " : index = " index " : depth = " depth " > <nl> < span class = " veui - tree - item - expand - switcher " <nl> v - if = " option . children & & option . children . length " <nl> @ click . stop = " toggle ( option , index , depth ) " > <nl> < veui - icon : name = " icons . collapsed " / > <nl> < / span > <nl> < div class = " veui - tree - item - label " > <nl> - < slot name = " item - label " : option = " option " : index = " index " : depth = " depth " > { { option . label } } < / slot > <nl> + < slot name = " item - label " : item = " option " : index = " index " : depth = " depth " > { { option . label } } < / slot > <nl> < / div > <nl> < / slot > <nl> < / div > <nl> < template slot = " item " slot - scope = " props " > <nl> < slot name = " item " v - bind = " props " > <nl> < span class = " veui - tree - item - expand - switcher " <nl> - v - if = " props . option . children & & props . option . children . length " <nl> - @ click . stop = " toggle ( props . option , props . index , depth + 1 ) " > <nl> + v - if = " props . item . children & & props . item . children . length " <nl> + @ click . stop = " toggle ( props . item , props . index , depth + 1 ) " > <nl> < veui - icon : name = " icons . collapsed " / > <nl> < / span > <nl> < div class = " veui - tree - item - label " > <nl> - < slot name = " item - label " v - bind = " props " > { { props . option . label } } < / slot > <nl> + < slot name = " item - label " v - bind = " props " > { { props . item . label } } < / slot > <nl> < / div > <nl> < / slot > <nl> < / template > <nl> 
mmm a / packages / veui / src / components / Toast . vue <nl> ppp b / packages / veui / src / components / Toast . vue <nl> < transition name = " veui - toast " > <nl> - < div : ui = " ui " class = " veui - toast " : class = " ` veui - toast - $ { type } ` " > <nl> + < div <nl> + : ui = " ui " <nl> + class = " veui - toast " <nl> + : class = " ` veui - toast - $ { type } ` " <nl> + role = " alert " > <nl> < veui - icon class = " veui - toast - icon " : name = " icons [ type ] " / > <nl> < span class = " veui - toast - message " > { { message } } < / span > <nl> < / div > <nl> 
mmm a / packages / veui / src / directives / resize . js <nl> ppp b / packages / veui / src / directives / resize . js <nl> - import { debounce , throttle , isObject , assign } from ' lodash ' <nl> + import { debounce , throttle , isObject , assign , isEqual , find } from ' lodash ' <nl> const modeMap = { <nl> debounce , <nl> @ @ - 7 , 35 + 7 , 36 @ @ const modeMap = { <nl> } <nl> function attach ( el , { value , oldValue , arg = 150 , modifiers } ) { <nl> + let mode = find ( Object . keys ( modeMap ) , mode = > modifiers [ mode ] ) <nl> let options = { <nl> delay : arg , <nl> - mode : Object . keys ( modifiers ) [ 0 ] , <nl> - handler : value <nl> + mode , <nl> + handler : value , <nl> + leading : modifiers . leading <nl> } <nl> if ( isObject ( value ) ) { <nl> assign ( options , value ) <nl> } <nl> let fn = modeMap [ options . mode ] <nl> - let cb = fn ? fn ( options . handler , options . delay ) : options . handler <nl> + let cb = fn ? fn ( options . handler , options . delay , options . leading ) : options . handler <nl> if ( ! oldValue ) { <nl> el . __veui_resize_handler__ = cb <nl> addListener ( el , cb ) <nl> } else { <nl> let oldOptions = { <nl> - delay : 150 , <nl> - mode : null , <nl> - handler : oldValue <nl> + delay : arg , <nl> + mode , <nl> + handler : oldValue , <nl> + leading : modifiers . leading <nl> } <nl> if ( isObject ( oldValue ) ) { <nl> assign ( oldOptions , oldValue ) <nl> } <nl> - let changed = oldValue . delay ! = = options . delay | | <nl> - oldValue . mode ! = = options . mode | | <nl> - oldValue . handler ! = = options . handler <nl> + let changed = isEqual ( oldValue , options ) <nl> if ( changed ) { <nl> let oldCb = el . __veui_resize_handler__ <nl> 
mmm a / contracts / token / StandardToken . sol <nl> ppp b / contracts / token / StandardToken . sol <nl> / * * <nl> * @ title Standard ERC20 token <nl> * <nl> - * @ dev Implemantation of the basic standard token . <nl> + * @ dev Implementation of the basic standard token . <nl> * @ dev https : / / github . com / ethereum / EIPs / issues / 20 <nl> * @ dev Based on code by FirstBlood : https : / / github . com / Firstbloodio / token / blob / master / smart_contract / FirstBloodToken . sol <nl> * / <nl> 
mmm a / truffle - config . js <nl> ppp b / truffle - config . js <nl> new HDWalletProvider ( mnemonic , rpcEndpoint ) ; <nl> const infuraProvider = network = > providerWithMnemonic ( <nl> - process . env . MNEMONIC , <nl> + process . env . MNEMONIC | | ' ' , <nl> ` https : / / $ { network } . infura . io / $ { process . env . INFURA_API_KEY } ` <nl> ) ; <nl> 
mmm a / contracts / ownership / rbac / RBAC . sol <nl> ppp b / contracts / ownership / rbac / RBAC . sol <nl> contract RBAC { <nl> using Roles for Roles . Role ; <nl> - mapping ( string = > Roles . Role ) internal roles ; <nl> + mapping ( string = > Roles . Role ) private roles ; <nl> event LogRoleAdded ( address addr , string roleName ) ; <nl> event LogRoleRemoved ( address addr , string roleName ) ; <nl> 
mmm a / test / TokenDestructible . test . js <nl> ppp b / test / TokenDestructible . test . js <nl> let destructible ; <nl> beforeEach ( async function ( ) { <nl> - destructible = await TokenDestructible . new ( { fron : accounts [ 0 ] , value : web3 . toWei ( ' 10 ' , ' ether ' ) } ) ; <nl> + destructible = await TokenDestructible . new ( { <nl> + from : accounts [ 0 ] , <nl> + value : web3 . toWei ( ' 10 ' , ' ether ' ) , <nl> + } ) ; <nl> } ) ; <nl> it ( ' should send balance to owner after destruction ' , async function ( ) { <nl> 
mmm a / . soliumrc . json <nl> ppp b / . soliumrc . json <nl> " plugins " : [ " security " ] , <nl> " rules " : { <nl> - " indentation " : [ " error " , 2 ] , <nl> " quotes " : [ " error " , " double " ] , <nl> - " security / enforce - explicit - visibility " : [ " error " ] , <nl> - " security / no - block - members " : [ " warning " , [ " timestamp " ] ] <nl> + " indentation " : [ " error " , 2 ] , <nl> + " arg - overflow " : [ " warning " , 3 ] , <nl> + " security / enforce - explicit - visibility " : [ " error " ] <nl> } <nl> } <nl> 
mmm a / config / environment . js <nl> ppp b / config / environment . js <nl> ENV . contentSecurityPolicy = { <nl> " default - src " : " ' self ' * . fastly . net " , <nl> - " connect - src " : " ' self ' https : / / s3 . amazonaws . com * . algolia . net * . fastly . net " , <nl> + " connect - src " : " ' self ' https : / / s3 . amazonaws . com * . algolia . net * . algolianet . com * . fastly . net " , <nl> " script - src " : " ' self ' unsafe - inline use . typekit . net ' sha256 - 36n / xkZHEzq3lo4O + 0jXMYbl + dWu3C8orOFHtcAH6HU = ' * . fastly . net https : / / www . google - analytics . com " , <nl> " font - src " : " ' self ' data : / / * https : / / fonts . gstatic . com * . fastly . net " , <nl> " img - src " : " ' self ' data : / / * * . fastly . net https : / / www . google - analytics . com " , <nl> 
mmm a / app / routes / project - version / classes / class . js <nl> ppp b / app / routes / project - version / classes / class . js <nl> import getLastVersion from ' . . / . . / . . / utils / get - last - version ' ; <nl> + const { Inflector : { inflector } } = Ember ; <nl> + <nl> export default Ember . Route . extend ( { <nl> model ( params ) { <nl> @ @ - 10 , 8 + 12 , 8 @ @ export default Ember . Route . extend ( { <nl> let lastVersion = getLastVersion ( versions ) ; <nl> let className = params [ ' class ' ] . substr ( 0 , params [ ' class ' ] . lastIndexOf ( ' . ' ) ) ; <nl> / / peel off the . html <nl> - console . log ( ' params ' , params , className ) ; <nl> let id = ` ember - $ { lastVersion } - $ { className } ` ; <nl> + <nl> return Ember . RSVP . hash ( { <nl> project : Ember . RSVP . resolve ( project ) , <nl> version : Ember . RSVP . resolve ( lastVersion ) , <nl> @ @ - 23 , 12 + 25 , 12 @ @ export default Ember . Route . extend ( { <nl> } ; <nl> } ) <nl> . catch ( ( ) = > { <nl> - / / return this . store . find ( ' namespace ' , id ) . then ( ( classData ) = > { <nl> - / / return { <nl> - / / type : ' namespace ' , <nl> - / / data : classData <nl> - / / } ; <nl> - / / } ) ; <nl> + return this . store . find ( ' namespace ' , id ) . then ( ( classData ) = > { <nl> + return { <nl> + type : ' namespace ' , <nl> + data : classData <nl> + } ; <nl> + } ) ; <nl> } ) <nl> . catch ( ( e ) = > { <nl> return this . transitionTo ( ' project - version ' ) ; <nl> @ @ - 41 , 7 + 43 , 7 @ @ export default Ember . Route . extend ( { <nl> } , <nl> redirect ( model ) { <nl> - return this . transitionTo ( ` project - version . $ { model . classData . type } ` , model . project . id , model . version , model . classData . data . get ( ' name ' ) ) ; <nl> + return this . transitionTo ( ` project - version . $ { inflector . pluralize ( model . classData . type ) } . $ { model . classData . type } ` , model . project . id , model . version , model . classData . data . get ( ' name ' ) ) ; <nl> } , <nl> serialize ( model ) { <nl> 
mmm a / app / routes / project - version . js <nl> ppp b / app / routes / project - version . js <nl> endingRoute = ` classes / $ { className } ` ; <nl> break ; <nl> } <nl> - case ' project - version . classes . index ' : { <nl> + case ' project - version . classes . class . index ' : { <nl> const className = this . modelFor ( ' project - version . classes . class ' ) . get ( ' name ' ) ; <nl> endingRoute = ` classes / $ { className } ` ; <nl> break ; <nl> } <nl> - case ' project - version . modules . index ' : { <nl> - const moduleName = this . pasramsFor ( ' project - version . modules . module ' ) . module ; <nl> + case ' project - version . modules . module . index ' : { <nl> + const moduleName = this . paramsFor ( ' project - version . modules . module ' ) . module ; <nl> endingRoute = ` modules / $ { moduleName } ` ; <nl> break ; <nl> } <nl> - case ' project - version . namespaces . index ' : { <nl> + case ' project - version . namespaces . namespace . index ' : { <nl> const namespaceName = this . paramsFor ( ' project - version . namespaces . namespace ' ) . namespace ; <nl> endingRoute = ` namespaces / $ { namespaceName } ` ; <nl> break ; <nl> 
mmm a / app / templates / components / search - input . hbs <nl> ppp b / app / templates / components / search - input . hbs <nl> onfocus = { { action ' onfocus ' } } <nl> onblur = { { action ' onblur ' } } <nl> - placeholder = " Search the guides " <nl> + placeholder = " Search " <nl> > <nl> { { ! - - Search results dropdown - - } } <nl> 
mmm a / app / components / search - input . js <nl> ppp b / app / components / search - input . js <nl> const projectVersion = get ( this , ' _projectVersion ' ) ; <nl> / / Hide and don ' t run query if there ' s no search query <nl> - / / if ( ! query ) { <nl> - / / return set ( this , ' _focused ' , false ) ; <nl> - / / } <nl> + if ( ! query ) { <nl> + return set ( this , ' _focused ' , false ) ; <nl> + } <nl> const params = { <nl> hitsPerPage : 15 , <nl> 
mmm a / app / components / search - input / dropdown . js <nl> ppp b / app / components / search - input / dropdown . js <nl> import Component from ' @ ember / component ' ; <nl> import { get , computed } from ' @ ember / object ' ; <nl> import { A } from ' @ ember / array ' ; <nl> @ @ - 30 , 7 + 29 , 7 @ @ export default Component . extend ( { <nl> const lvl0Group = get ( this , ' results ' ) . reduce ( ( previous , current ) = > { <nl> / / Remap all lowercase usages of ' guides ' to ' Guides ' <nl> - let lvl0 = capitalize ( get ( current , ' hierarchy . lvl0 ' ) ) ; <nl> + let lvl0 = get ( current , ' hierarchy . lvl0 ' ) ; <nl> / / If lvl0 doesn ' t exist in the resulting object , create the array <nl> if ( ! previous [ lvl0 ] ) { <nl> previous [ lvl0 ] = A ( ) ; <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - The app in this repository , which fetches and displays the API docs data . It is what you see at <nl> [ https : / / emberjs . com / api ] ( https : / / emberjs . com / api ) <nl> - The YUIdoc code comments found in the <nl> - [ Ember . js codebase ] ( https : / / github . com / ember . js ) , where the informational content of the API documentation can be edited <nl> + [ Ember . js codebase ] ( https : / / github . com / emberjs / ember . js ) , where the informational content of the API documentation can be edited <nl> - The data generator that serializes code comments into JSONAPI and <nl> deploys the result , <nl> [ ember - jsonapi - docs ] ( https : / / github . com / ember - learn / ember - jsonapi - docs ) <nl> 
mmm a / test / components / datagrid / datagrid . e2e - spec . js <nl> ppp b / test / components / datagrid / datagrid . e2e - spec . js <nl> return ( <nl> ` # datagrid . datagrid - wrapper tbody tr : nth - child ( $ { row } ) ` + <nl> ` td : nth - child ( $ { column } ) ` + <nl> - ` [ role = " checkbox " ] $ { checkedState } ` <nl> + ` $ { checkedState } ` <nl> ) ; <nl> } , <nl> removeRowButton : ( ) = > ' # remove - btn ' <nl> @ @ - 1285 , 7 + 1285 , 7 @ @ describe ( ' Datagrid mixed selection tests ' , ( ) = > { <nl> } <nl> } ) ; <nl> - fdescribe ( ' Datagrid multiselect tests ' , ( ) = > { <nl> + describe ( ' Datagrid multiselect tests ' , ( ) = > { <nl> beforeEach ( async ( ) = > { <nl> await utils . setPage ( ' / components / datagrid / example - multiselect . html ? theme = classic & layout = nofrills ' ) ; <nl> @ @ - 1363 , 27 + 1363 , 24 @ @ fdescribe ( ' Datagrid multiselect tests ' , ( ) = > { <nl> await browser . wait ( until . presenceOf ( $ ( S . gridColumn ( { row : 1 , column : 2 } ) ) ) ) ; <nl> await $ ( S . gridColumn ( { row : 1 , column : 2 } ) ) . click ( ) ; <nl> await browser . wait ( until . presenceOf ( $ ( S . gridRowCheckbox ( { row : 1 , checked : true } ) ) ) ) ; <nl> - <nl> / / select row 2 <nl> await browser . wait ( until . presenceOf ( $ ( S . gridColumn ( { row : 2 , column : 2 } ) ) ) ) ; <nl> await $ ( S . gridColumn ( { row : 2 , column : 2 } ) ) . click ( ) ; <nl> await browser . wait ( until . presenceOf ( $ ( S . gridRowCheckbox ( { row : 2 , checked : true } ) ) ) ) ; <nl> - <nl> expect ( await element ( by . css ( ' . selection - count ' ) ) . getText ( ) ) . toEqual ( ' 2 Selected ' ) ; <nl> - <nl> / / sort ascending <nl> await browser . wait ( <nl> - until . presenceOf ( ' # datagrid . datagrid - header th . is - sortable : nth - child ( 2 ) . datagrid - header - text ' ) <nl> + until . presenceOf ( $ ( ' # datagrid . datagrid - header th . is - sortable : nth - child ( 2 ) . datagrid - header - text ' ) ) <nl> ) ; <nl> await element ( by . css ( ' # datagrid . datagrid - header th . is - sortable : nth - child ( 2 ) . datagrid - header - text ' ) ) . click ( ) ; <nl> / / sort descending <nl> await browser . wait ( <nl> - until . presenceOf ( ' # datagrid . datagrid - header th . is - sorted - asc : nth - child ( 2 ) . datagrid - header - text ' ) <nl> + until . presenceOf ( $ ( ' # datagrid . datagrid - header th . is - sorted - asc : nth - child ( 2 ) . datagrid - header - text ' ) ) <nl> ) ; <nl> await element ( by . css ( ' # datagrid . datagrid - header th . is - sorted - asc : nth - child ( 2 ) . datagrid - header - text ' ) ) . click ( ) ; <nl> await browser . wait ( <nl> - until . presenceOf ( ' # datagrid . datagrid - header th . is - sorted - desc : nth - child ( 2 ) . datagrid - header - text ' ) <nl> + until . presenceOf ( $ ( ' # datagrid . datagrid - header th . is - sorted - desc : nth - child ( 2 ) . datagrid - header - text ' ) ) <nl> ) ; <nl> / / select another row now that sort is flipped <nl> 
mmm a / src / components / searchfield / searchfield . js <nl> ppp b / src / components / searchfield / searchfield . js <nl> const wrapperElem = this . wrapper [ 0 ] ; <nl> if ( this . settings . tabbable & & wrapperElem . contains ( active ) & & $ ( active ) . is ( ' button . close ' ) ) { <nl> - return false ; <nl> + return true ; <nl> } <nl> / / If another element inside the Searchfield Wrapper is focused , the entire component <nl> 
mmm a / src / components / searchfield / _searchfield . scss <nl> ppp b / src / components / searchfield / _searchfield . scss <nl> top : 0 ; <nl> } <nl> } <nl> + <nl> + / * * <nl> + * align large searchfield search icon <nl> + * / <nl> + . header > . full - searchfield - container . searchfield - wrapper { <nl> + & > svg . icon : nth - child ( 1 ) { <nl> + height : 100 % ; <nl> + top : 50 % ; <nl> + transform : translateY ( - 50 % ) ; <nl> + } <nl> + } <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> $ { repo_owner } / $ { repo_name } <nl> env : <nl> AWF_AUTH_TOKEN : $ { { secrets . AWF_AUTH_TOKEN } } <nl> - TLS_SECRET : $ { { secrets . TLS_SECRET } } <nl> shell : bash <nl> - name : Dump GitHub context <nl> 
mmm a / src / charts / html - legend . js <nl> ppp b / src / charts / html - legend . js <nl> - / / import { event } from ' d3 - selection ' ; <nl> import { pluck , utils } from ' . . / core / utils ' ; <nl> import { config } from ' . . / core / config ' ; <nl> @ @ - 209 , 7 + 208 , 7 @ @ export class HtmlLegend { <nl> . attr ( ' tabindex ' , 0 ) ; <nl> tabElements <nl> - . on ( ' keydown ' , d = > { <nl> + . on ( ' keydown ' , config . _d3compat . eventHandler ( ( d , event ) = > { <nl> / / trigger only if d is an object <nl> if ( event . keyCode = = = 13 & & typeof d = = = ' object ' ) { <nl> d . chart . legendToggle ( d ) <nl> @ @ - 219 , 7 + 218 , 7 @ @ export class HtmlLegend { <nl> d . chart . legendToggle ( d ) <nl> event . preventDefault ( ) ; <nl> } <nl> - } ) <nl> + } ) ) <nl> . on ( ' focus ' , d = > { <nl> this . _parent . legendHighlight ( d ) ; <nl> } ) <nl> 
mmm a / src / core / config . js <nl> ppp b / src / core / config . js <nl> this . _renderlet = null ; <nl> - this . _d3compat = { <nl> - eventHandler : handler = > function eventHandler ( a , b ) { <nl> - console . warn ( ' No d3 . js compatbility event handler registered , defaulting to v6 behavior . ' ) ; <nl> - handler . call ( this , b , a ) ; <nl> - } , <nl> - nester : ( { key , sortKeys , sortValues , entries } ) = > { <nl> - throw new Error ( ' No d3 . js compatbility nester registered , load v5 or v6 compability layer . ' ) ; <nl> - } , <nl> - pointer : ( ) = > { throw new Error ( ' No d3 . js compatbility pointer registered , load v5 or v6 compability layer . ' ) ; } <nl> - } ; <nl> - <nl> / * * <nl> * If this boolean is set truthy , all transitions will be disabled , and changes to the charts will happen <nl> * immediately . <nl> @ @ - 84 , 4 + 73 , 13 @ @ export const config = new Config ( ) ; <nl> / * * <nl> * d3 . js compatiblity layer <nl> * / <nl> - export const d3compat = { } ; <nl> + export const d3compat = { <nl> + eventHandler : handler = > function eventHandler ( a , b ) { <nl> + console . warn ( ' No d3 . js compatbility event handler registered , defaulting to v6 behavior . ' ) ; <nl> + handler . call ( this , b , a ) ; <nl> + } , <nl> + nester : ( { key , sortKeys , sortValues , entries } ) = > { <nl> + throw new Error ( ' No d3 . js compatbility nester registered , load v5 or v6 compability layer . ' ) ; <nl> + } , <nl> + pointer : ( ) = > { throw new Error ( ' No d3 . js compatbility pointer registered , load v5 or v6 compability layer . ' ) ; } <nl> + } ; <nl> 
mmm a / lib / utils / index . js <nl> ppp b / lib / utils / index . js <nl> isRequired : ( function ( ) { <nl> var p = module . parent ; <nl> while ( p ) { <nl> + / / in electron . js engine it happens <nl> + if ( p . filename = = = undefined ) { <nl> + return true ; <nl> + } <nl> if ( p . filename . indexOf ( ' bin ' + path . sep + ' nodemon . js ' ) ! = = - 1 ) { <nl> return false ; <nl> } <nl> 
mmm a / lib / nodemon . js <nl> ppp b / lib / nodemon . js <nl> } <nl> if ( settings . help ) { <nl> + process . stdout . _handle . setBlocking ( true ) ; / / nodejs / node # 6456 <nl> console . log ( help ( settings . help ) ) ; <nl> if ( ! config . required ) { <nl> process . exit ( 0 ) ; <nl> 
mmm a / lib / config / load . js <nl> ppp b / lib / config / load . js <nl> } catch ( e ) { <nl> console . error ( e ) ; <nl> utils . log . fail ( ' Failed to parse config ' + filename ) ; <nl> + process . exit ( 1 ) ; <nl> } <nl> / / options values will overwrite settings <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> & & executable [ executable . length - 1 ] ! = = ' \ " ' ) { <nl> / / remove all quotes from executable ( possible backward compat hacks ) <nl> executable = executable . replace ( / \ " / g , ' ' ) ; <nl> - <nl> - / / add quotes to beginning and end of executable <nl> - executable = ' \ " ' + executable + ' \ " ' ; <nl> } <nl> } <nl> 
mmm a / lib / config / exec . js <nl> ppp b / lib / config / exec . js <nl> / / BIG NOTE : user can ' t do this : nodemon - e * . js <nl> / / because the terminal will automatically expand the glob against <nl> / / the file system : ( <nl> - extension = ( extension . match ( / [ ^ , . \ s ] + / g ) | | [ ] ) . join ( ' , ' ) ; <nl> + extension = ( extension . match ( / [ ^ , * \ s ] + / g ) | | [ ] ) <nl> + . map ( ext = > ext . replace ( / ^ \ . / , ' ' ) ) <nl> + . join ( ' , ' ) ; <nl> options . ext = extension ; <nl> 
mmm a / doc / cli / help . txt <nl> ppp b / doc / cli / help . txt <nl> - h , - - help . . . . . . . . . . . . . . . you ' re looking at it . <nl> - - help < topic > . . . . . . . . . . . help on a specific feature . Try " - - help topics " . <nl> + - - signal < signal > . . . . . . . . use specified kill signal instead of default ( ex . SIGTERM ) <nl> - - < your args > . . . . . . . . . . . to tell nodemon stop slurping arguments . <nl> Note : if the script is omitted , nodemon will try to read " main " from <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> } , <nl> " engines " : { <nl> - " node " : " > = 0 . 8 " <nl> + " node " : " > = 6 " <nl> } , <nl> " repository " : { <nl> " type " : " git " , <nl> " ps - tree " : " ^ 1 . 1 . 0 " , <nl> " touch " : " ^ 3 . 1 . 0 " , <nl> " undefsafe " : " 0 . 0 . 3 " , <nl> - " update - notifier " : " ^ 2 . 2 . 0 " <nl> + " update - notifier " : " ^ 2 . 3 . 0 " <nl> } , <nl> " version " : " 0 . 0 . 0 - development " <nl> } <nl> 
mmm a / doc / cli / help . txt <nl> ppp b / doc / cli / help . txt <nl> - C , - - on - change - only . . . . . execute script on change only , not startup <nl> - - no - colors . . . . . . . . . . . . . . disable color output <nl> + - - signal < signal > . . . . . . . . use specified kill signal instead of default ( ex . SIGTERM ) <nl> - d , - - delay n . . . . . . . . . . . . debounce restart for " n " seconds . <nl> - - exitcrash . . . . . . . . . . . . . . exit on crash , allows use of nodemon with daemon <nl> tools like forever . js . <nl> - v , - - version . . . . . . . . . . . . current nodemon version . <nl> - h , - - help . . . . . . . . . . . . . . . you ' re looking at it . <nl> - - help < topic > . . . . . . . . . . . help on a specific feature . Try " - - help topics " . <nl> - - - signal < signal > . . . . . . . . use specified kill signal instead of default ( ex . SIGTERM ) <nl> - - < your args > . . . . . . . . . . . to tell nodemon stop slurping arguments . <nl> Note : if the script is omitted , nodemon will try to read " main " from <nl> Examples : <nl> $ nodemon server . js <nl> - $ nodemon - - config my / custom / nodemon . json server . js <nl> $ nodemon - w . . / foo server . js apparg1 apparg2 <nl> - $ PORT = 8000 nodemon - - debug - brk server . js <nl> $ nodemon - - exec python app . py <nl> $ nodemon - - exec " make build " - e " styl hbs " <nl> - $ nodemon app . js - - - v <nl> + $ nodemon app . js - - - - inspect <nl> For more details see http : / / github . com / remy / nodemon / <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - ' 8 ' <nl> - ' 6 ' <nl> before_install : <nl> - - if [ " $ TRAVIS_BRANCH " = = " master " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> + - if [ " $ TRAVIS_BRANCH " = = " master " ] ; then export _authToken = $ NPM_TOKEN ; fi <nl> after_success : <nl> - npm run semantic - release <nl> branches : <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> } ) ; <nl> } <nl> - if ( executable = = = ' node ' ) { <nl> + if ( executable = = = ' node ' & & utils . version . major > 4 ) { <nl> var forkArgs = cmd . args . slice ( 1 ) ; <nl> var env = utils . merge ( options . execOptions . env , process . env ) ; <nl> stdio . push ( ' ipc ' ) ; <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> } ) ; <nl> } <nl> - if ( executable = = = ' node ' & & utils . version . major > 4 ) { <nl> + if ( <nl> + / / this is a hack to avoid forking if there ' s a node argument being passed <nl> + / / it ' s a short term fix , and I ' m not 100 % sure that ` fork ` is the right way <nl> + cmd . args [ 0 ] . indexOf ( ' - ' ) = = = - 1 & & <nl> + executable = = = ' node ' & & <nl> + utils . version . major > 4 <nl> + ) { <nl> var forkArgs = cmd . args . slice ( 1 ) ; <nl> var env = utils . merge ( options . execOptions . env , process . env ) ; <nl> stdio . push ( ' ipc ' ) ; <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> if ( <nl> / / this is a hack to avoid forking if there ' s a node argument being passed <nl> / / it ' s a short term fix , and I ' m not 100 % sure that ` fork ` is the right way <nl> - cmd . args [ 0 ] . indexOf ( ' - ' ) = = = - 1 & & <nl> + ( cmd . args [ 0 ] | | ' ' ) . indexOf ( ' - ' ) = = = - 1 & & <nl> executable = = = ' node ' & & <nl> utils . version . major > 4 <nl> ) { <nl> 
mmm a / lib / monitor / watch . js <nl> ppp b / lib / monitor / watch . js <nl> / / if there ' s no matches , then test to see if the changed file is the <nl> / / running script , if so , let ' s allow a restart <nl> + if ( config . options . execOptions . script ) { <nl> const script = path . resolve ( config . options . execOptions . script ) ; <nl> if ( matched . result . length = = = 0 & & script ) { <nl> const length = script . length ; <nl> @ @ - 155 , 6 + 156 , 7 @ @ function filterAndRestart ( files ) { <nl> } <nl> } ) <nl> } <nl> + } <nl> utils . log . detail ( ' changes after filters ( before / after ) : ' + <nl> [ files . length , matched . result . length ] . join ( ' / ' ) ) ; <nl> 
mmm a / lib / monitor / match . js <nl> ppp b / lib / monitor / match . js <nl> / / sort the rules by highest specificity ( based on number of slashes ) <nl> / / ignore rules ( ! ) get sorted highest as they take precedent <nl> / / TODO actually check separator rules work on windows <nl> + const cwd = process . cwd ( ) ; <nl> var rules = monitor . sort ( function ( a , b ) { <nl> var r = b . split ( path . sep ) . length - a . split ( path . sep ) . length ; <nl> var aIsIgnore = a . slice ( 0 , 1 ) = = = ' ! ' ; <nl> @ @ - 154 , 8 + 155 , 13 @ @ function match ( files , monitor , ext ) { <nl> } <nl> if ( s . slice ( 0 , 2 ) = = = ' . . ' ) { <nl> - return path . resolve ( process . cwd ( ) , s ) ; <nl> + return path . resolve ( cwd , s ) ; <nl> } <nl> + <nl> + if ( s . indexOf ( cwd ) = = = 0 ) { <nl> + return s ; <nl> + } <nl> + <nl> return ' * * ' + ( prefix ! = = path . sep ? path . sep : ' ' ) + s ; <nl> } ) ; <nl> @ @ - 172 , 6 + 178 , 8 @ @ function match ( files , monitor , ext ) { <nl> } <nl> files . forEach ( function ( file ) { <nl> + file = path . resolve ( cwd , file ) ; <nl> + <nl> var matched = false ; <nl> for ( var i = 0 ; i < rules . length ; i + + ) { <nl> if ( rules [ i ] . slice ( 0 , 1 ) = = = ' ! ' ) { <nl> @ @ - 205 , 6 + 213 , 8 @ @ function match ( files , monitor , ext ) { <nl> } <nl> matched = true ; <nl> break ; <nl> + } else { <nl> + / / utils . log . detail ( ' no match : ' + rules [ i ] , file ) ; <nl> } <nl> } <nl> } <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> var stdio = [ ' pipe ' , ' pipe ' , ' pipe ' ] ; <nl> if ( config . options . stdout ) { <nl> - stdio = [ ' pipe ' , <nl> - process . stdout , <nl> - process . stderr , ] ; <nl> + stdio = [ ' pipe ' , process . stdout , process . stderr ] ; <nl> + } <nl> + <nl> + if ( config . options . stdin = = = false ) { <nl> + stdio = [ process . stdin , process . stdout , process . stderr ] ; <nl> } <nl> var sh = ' sh ' ; <nl> 
mmm a / bin / nodemon . js <nl> ppp b / bin / nodemon . js <nl> / / checks for available update and returns an instance <nl> var pkg = JSON . parse ( fs . readFileSync ( __dirname + ' / . . / package . json ' ) ) ; <nl> - require ( ' update - notifier ' ) ( { <nl> - pkg : Object . assign ( pkg , { version : ' 0 . 0 . 0 ' } ) , <nl> - } ) . notify ( ) ; <nl> + if ( pkg . version . indexOf ( ' 0 . 0 . 0 ' ) ! = = 0 ) { <nl> + require ( ' update - notifier ' ) ( { pkg } ) . notify ( ) ; <nl> + } <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> } ) ; <nl> } <nl> + const firstArg = cmd . args [ 0 ] | | ' ' ; <nl> + <nl> if ( <nl> / / this is a hack to avoid forking if there ' s a node argument being passed <nl> / / it ' s a short term fix , and I ' m not 100 % sure that ` fork ` is the right way <nl> - ( cmd . args [ 0 ] | | ' ' ) . indexOf ( ' - ' ) = = = - 1 & & <nl> + firstArg . indexOf ( ' - ' ) = = = - 1 & & <nl> + firstArg ! = = ' inspect ' & & <nl> executable = = = ' node ' & & <nl> utils . version . major > 4 <nl> ) { <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> var args = runCmd ? utils . stringify ( executable , cmd . args ) : ' : ' ; <nl> var spawnArgs = [ sh , [ shFlag , args ] ] ; <nl> - debug ( ' spawning ' , args ) ; <nl> if ( utils . version . major = = = 0 & & utils . version . minor < 8 ) { <nl> / / use the old spawn args : - \ <nl> @ @ - 95 , 10 + 94 , 15 @ @ function run ( options ) { <nl> env : env , <nl> stdio : stdio , <nl> } ) ; <nl> + utils . log . detail ( ' forking ' ) ; <nl> + debug ( forkArgs ) ; <nl> } else { <nl> + utils . log . detail ( ' spawning ' ) ; <nl> child = spawn . apply ( null , spawnArgs ) ; <nl> + debug ( spawnArgs ) ; <nl> } <nl> + <nl> if ( config . required ) { <nl> var emit = { <nl> stdout : function ( data ) { <nl> @ @ - 257 , 6 + 261 , 10 @ @ function run ( options ) { <nl> process . stdin . resume ( ) ; <nl> / / FIXME decide whether or not we need to decide the encoding <nl> / / process . stdin . setEncoding ( ' utf8 ' ) ; <nl> + <nl> + / / swallow the stdin error if it happens <nl> + / / ref : https : / / github . com / remy / nodemon / issues / 1195 <nl> + child . stdin . on ( ' error ' , ( ) = > { } ) ; <nl> process . stdin . pipe ( child . stdin ) ; <nl> bus . once ( ' exit ' , function ( ) { <nl> 
mmm a / lib / config / load . js <nl> ppp b / lib / config / load . js <nl> / / if we didn ' t pick up a nodemon . json file & there ' s no cli ignores <nl> / / then try loading an old style . nodemonignore file <nl> if ( config . loaded . length = = = 0 ) { <nl> - / / TODO decide whether this is just confusing . . . <nl> - var legacy = loadLegacyIgnore . bind ( null , options , ready ) ; <nl> + var legacy = loadLegacyIgnore . bind ( null , options , config , ready ) ; <nl> / / first try . nodemonignore , if that doesn ' t exist , try nodemon - ignore <nl> return legacy ( ' . nodemonignore ' , function ( ) { <nl> @ @ - 118 , 11 + 117 , 12 @ @ function load ( settings , options , config , callback ) { <nl> * @ param { String } filename ignore file ( . nodemonignore or nodemon - ignore ) <nl> * @ param { Function } fail ( optional ) failure callback <nl> * / <nl> - function loadLegacyIgnore ( options , success , filename , fail ) { <nl> + function loadLegacyIgnore ( options , config , success , filename , fail ) { <nl> var ignoreFile = path . join ( process . cwd ( ) , filename ) ; <nl> exists ( ignoreFile , function ( exists ) { <nl> if ( exists ) { <nl> + config . loaded . push ( ignoreFile ) ; <nl> return parse ( ignoreFile , function ( error , rules ) { <nl> options . ignore = rules . raw ; <nl> success ( options ) ; <nl> @ @ - 172 , 6 + 172 , 12 @ @ function loadFile ( options , config , dir , ready ) { <nl> } <nl> var filename = options . configFile | | path . join ( dir , ' nodemon . json ' ) ; <nl> + <nl> + if ( config . loaded . indexOf ( filename ) ! = = - 1 ) { <nl> + / / don ' t bother re - parsing the same config file <nl> + return callback ( { } ) ; <nl> + } <nl> + <nl> fs . readFile ( filename , ' utf8 ' , function ( err , data ) { <nl> if ( err ) { <nl> if ( err . code = = = ' ENOENT ' ) { <nl> @ @ - 188 , 7 + 194 , 9 @ @ function loadFile ( options , config , dir , ready ) { <nl> try { <nl> settings = JSON . parse ( data . toString ( ' utf8 ' ) . replace ( / ^ \ uFEFF / , ' ' ) ) ; <nl> + if ( ! filename . endsWith ( ' package . json ' ) | | settings . nodemonConfig ) { <nl> config . loaded . push ( filename ) ; <nl> + } <nl> } catch ( e ) { <nl> console . error ( e ) ; <nl> utils . log . fail ( ' Failed to parse config ' + filename ) ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " semantic - release " : " semantic - release pre & & npm publish & & semantic - release post " , <nl> " prepush " : " npm run lint " , <nl> - " postinstall " : " node - e \ " console . log ( ' \ \ u001b [ 32mLove nodemon ? You can now support the project via the open collective : \ \ u001b [ 22m \ \ u001b [ 39m \ \ n > \ \ u001b [ 96m \ \ u001b [ 1mhttps : / / opencollective . com / nodemon / donate \ \ u001b [ 0m \ \ n ' ) \ " " <nl> + " postinstall " : " node - e \ " console . log ( ' \ \ u001b [ 32mLove nodemon ? You can now support the project via the open collective : \ \ u001b [ 22m \ \ u001b [ 39m \ \ n > \ \ u001b [ 96m \ \ u001b [ 1mhttps : / / opencollective . com / nodemon / donate \ \ u001b [ 0m \ \ n ' ) \ " | | exit 0 " <nl> } , <nl> " devDependencies " : { <nl> " @ commitlint / cli " : " ^ 3 . 1 . 3 " , <nl> 
mmm a / lib / monitor / watch . js <nl> ppp b / lib / monitor / watch . js <nl> } <nl> var watchOptions = { <nl> + ignorePermissionErrors : true , <nl> cwd : process . cwd ( ) , / / use cwd for relative path ignore <nl> ignored : ignored , <nl> persistent : true , <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> child . stdin . on ( ' error ' , ( ) = > { } ) ; <nl> process . stdin . pipe ( child . stdin ) ; <nl> } else { <nl> + if ( child . stdout ) { <nl> child . stdout . pipe ( process . stdout ) ; <nl> + } else { <nl> + utils . log . error ( ` running an unsupported version of node $ { process . version } ` ) ; <nl> + utils . log . error ( ' nodemon may not work as expected - please consider upgrading to LTS ' ) ; <nl> + } <nl> } <nl> bus . once ( ' exit ' , function ( ) { <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> stdio : stdio , <nl> } <nl> + var executable = cmd . executable ; <nl> + <nl> if ( utils . isWindows ) { <nl> + / / if the exec includes a forward slash , reverse it for windows compat <nl> + / / but * only * apply to the first command , and none of the arguments . <nl> + / / ref # 1251 and # 1236 <nl> + if ( executable . indexOf ( ' / ' ) ! = = - 1 ) { <nl> + executable = executable . split ( ' ' ) . map ( ( e , i ) = > { <nl> + if ( i = = = 0 ) { <nl> + return path . normalize ( e ) ; <nl> + } <nl> + return e ; <nl> + } ) . join ( ' ' ) ; <nl> + } <nl> / / taken from npm ' s cli : https : / / git . io / vNFD4 <nl> sh = process . env . comspec | | ' cmd ' ; <nl> shFlag = ' / d / s / c ' ; <nl> spawnOptions . windowsVerbatimArguments = true ; <nl> } <nl> - var executable = cmd . executable ; <nl> var args = runCmd ? utils . stringify ( executable , cmd . args ) : ' : ' ; <nl> var spawnArgs = [ sh , [ shFlag , args ] , spawnOptions ] ; <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> stdio = [ process . stdin , process . stdout , process . stderr ] ; <nl> } <nl> - const sh = ' sh ' ; <nl> - const shFlag = ' - c ' ; <nl> + var sh = ' sh ' ; <nl> + var shFlag = ' - c ' ; <nl> const binPath = process . cwd ( ) + ' / node_modules / . bin ' ; <nl> 
mmm a / lib / monitor / watch . js <nl> ppp b / lib / monitor / watch . js <nl> var promises = [ ] ; <nl> var watchedFiles = [ ] ; <nl> - dirs . forEach ( function ( dir ) { <nl> - var promise = new Promise ( function ( resolve ) { <nl> - var dotFilePattern = / [ / \ \ ] \ . / ; <nl> + const promise = new Promise ( function ( resolve ) { <nl> + const dotFilePattern = / [ / \ \ ] \ . / ; <nl> var ignored = Array . from ( rootIgnored ) ; <nl> + const addDotFile = dirs . filter ( dir = > dir . match ( dotFilePattern ) ) ; <nl> / / don ' t ignore dotfiles if explicitly watched . <nl> - if ( ! dir . match ( dotFilePattern ) ) { <nl> + if ( addDotFile . length = = = 0 ) { <nl> ignored . push ( dotFilePattern ) ; <nl> } <nl> + dirs = dirs . map ( dir = > { <nl> / / if the directory is a file , it somehow causes <nl> / / windows to lose the filename upon change <nl> if ( fs . statSync ( dir ) . isFile ( ) ) { <nl> dir = path . dirname ( dir ) ; <nl> } <nl> + return dir ; <nl> + } ) ; <nl> + <nl> var watchOptions = { <nl> ignorePermissionErrors : true , <nl> - cwd : dir , <nl> + cwd : process . cwd ( ) , / / dir , <nl> ignored : ignored , <nl> persistent : true , <nl> usePolling : config . options . legacyWatch | | false , <nl> @ @ - 73 , 7 + 77 , 7 @ @ function watch ( ) { <nl> } <nl> var watcher = chokidar . watch ( <nl> - dir , <nl> + dirs , <nl> Object . assign ( { } , watchOptions , config . watchOptions | | { } ) <nl> ) ; <nl> @ @ - 114 , 10 + 118 , 12 @ @ function watch ( ) { <nl> watchers . push ( watcher ) ; <nl> } ) ; <nl> - promises . push ( promise ) ; <nl> - } ) ; <nl> - return Promise . all ( promises ) . then ( function ( res ) { <nl> + return promise . catch ( e = > { <nl> + setTimeout ( ( ) = > { <nl> + throw e ; <nl> + } ) ; <nl> + } ) . then ( function ( res ) { <nl> utils . log . detail ( ` watching $ { watchedFiles . length } file $ { <nl> watchedFiles . length = = = 1 ? ' ' : ' s ' } ` ) ; <nl> return watchedFiles ; <nl> 
mmm a / lib / config / load . js <nl> ppp b / lib / config / load . js <nl> if ( ! options . script & & ! options . exec ) { <nl> var found = findAppScript ( ) ; <nl> if ( found ) { <nl> + if ( ! options . args ) { <nl> + options . args = [ ] ; <nl> + } <nl> / / if the script is found as a result of not being on the command <nl> / / line , then we move any of the pre double - dash args in execArgs <nl> const n = options . scriptPosition | | options . args . length ; <nl> 
mmm a / lib / utils / index . js <nl> ppp b / lib / utils / index . js <nl> var p = module . parent ; <nl> while ( p ) { <nl> / / in electron . js engine it happens <nl> - if ( p . filename = = = undefined ) { <nl> + if ( ! p . filename ) { <nl> return true ; <nl> } <nl> if ( p . filename . indexOf ( ' bin ' + path . sep + ' nodemon . js ' ) ! = = - 1 ) { <nl> 
mmm a / lib / nodemon . js <nl> ppp b / lib / nodemon . js <nl> utils . log . detail ( ' reading config ' + file ) ; <nl> } ) ; <nl> - / / echo out notices about running state <nl> - if ( config . options . stdin ) { <nl> + if ( config . options . stdin & & config . options . restartable ) { <nl> + / / allow nodemon to restart when the use types ' rs \ n ' <nl> + process . stdin . resume ( ) ; <nl> + process . stdin . setEncoding ( ' utf8 ' ) ; <nl> + process . stdin . on ( ' data ' , data = > { <nl> + const str = data . toString ( ) . trim ( ) . toLowerCase ( ) ; <nl> + <nl> + / / if the keys entered match the restartable value , then restart ! <nl> + if ( str = = = config . options . restartable ) { <nl> + bus . emit ( ' restart ' ) ; <nl> + } else if ( data . charCodeAt ( 0 ) = = = 12 ) { / / ctrl + l <nl> + console . clear ( ) ; <nl> + } <nl> + } ) ; <nl> + } else if ( config . options . stdin ) { <nl> / / so let ' s make sure we don ' t eat the key presses <nl> / / but also , since we ' re wrapping , watch out for <nl> / / special keys , like ctrl + c x 2 or ' . exit ' or ctrl + d or ctrl + l <nl> var ctrlC = false ; <nl> var buffer = ' ' ; <nl> - const rs = config . options . restartable ; <nl> - process . stdin . setEncoding ( ' utf8 ' ) ; <nl> process . stdin . on ( ' data ' , function ( data ) { <nl> data = data . toString ( ) ; <nl> buffer + = data ; <nl> const chr = data . charCodeAt ( 0 ) ; <nl> / / if restartable , echo back <nl> - if ( rs ) { <nl> - if ( chr = = = 13 ) { <nl> - process . stdout . write ( ' \ n ' ) ; <nl> - } <nl> - / / this intentionally prevents cursor keys from working . <nl> - process . stdout . write ( String . fromCharCode ( chr ) ) ; <nl> - } <nl> - <nl> if ( chr = = = 3 ) { <nl> if ( ctrlC ) { <nl> process . exit ( 0 ) ; <nl> } <nl> - / / if restartable , assume ctrl + c will break immediately <nl> - if ( rs ) { <nl> - bus . emit ( ' quit ' , 130 ) ; <nl> - } <nl> ctrlC = true ; <nl> return ; <nl> - } else if ( ! rs & & ( buffer = = = ' . exit ' | | chr = = = 4 ) ) { / / ctrl + d <nl> + } else if ( buffer = = = ' . exit ' | | chr = = = 4 ) { / / ctrl + d <nl> process . exit ( ) ; <nl> } else if ( chr = = = 13 | | chr = = = 10 ) { / / enter / carriage return <nl> - const input = buffer . toString ( ) . trim ( ) . toLowerCase ( ) ; <nl> - if ( input = = = rs ) { <nl> - bus . emit ( ' restart ' ) ; <nl> - } <nl> buffer = ' ' ; <nl> } else if ( chr = = = 12 ) { / / ctrl + l <nl> console . clear ( ) ; <nl> @ @ - 144 , 7 + 139 , 6 @ @ function nodemon ( settings ) { <nl> } <nl> ctrlC = false ; <nl> } ) ; <nl> - process . stdin . resume ( ) ; <nl> if ( process . stdin . setRawMode ) { <nl> process . stdin . setRawMode ( true ) ; <nl> } <nl> 
mmm a / lib / utils / index . js <nl> ppp b / lib / utils / index . js <nl> args . map ( function ( arg ) { <nl> / / if an argument contains a space , we want to show it with quotes <nl> / / around it to indicate that it is a single argument <nl> - if ( arg . indexOf ( ' ' ) = = = - 1 ) { <nl> + if ( arg . length > 0 & & arg . indexOf ( ' ' ) = = = - 1 ) { <nl> return arg ; <nl> } <nl> / / this should correctly escape nested quotes <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> const shouldFork = <nl> ! config . options . spawn & & <nl> ! inBinPath & & <nl> - firstArg . indexOf ( ' - ' ) = = = - 1 & & / / don ' t fork if there ' s a node exec arg <nl> + ! ( firstArg . indexOf ( ' - ' ) = = = 0 ) & & / / don ' t fork if there ' s a node exec arg <nl> firstArg ! = = ' inspect ' & & / / don ' t fork it ' s ` inspect ` debugger <nl> executable = = = ' node ' & & / / only fork if node <nl> utils . version . major > 4 / / only fork if node version > 4 <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> if ( signal = = = config . signal | | code = = = 0 ) { <nl> / / this was a clean exit , so emit exit , rather than crash <nl> debug ( ' bus . emit ( exit ) via ' + config . signal ) ; <nl> - bus . emit ( ' exit ' ) ; <nl> + bus . emit ( ' exit ' , signal ) ; <nl> / / exit the monitor , but do it gracefully <nl> if ( signal = = = config . signal ) { <nl> 
mmm a / lib / nodemon . js <nl> ppp b / lib / nodemon . js <nl> } ) . filter ( Boolean ) . join ( ' ' ) ; <nl> if ( ignoring ) utils . log . detail ( ' ignoring : ' + ignoring ) ; <nl> - utils . log . info ( ' watching : ' + config . options . monitor . map ( function ( rule ) { <nl> - return rule . slice ( 0 , 1 ) ! = = ' ! ' ? rule : false ; <nl> + utils . log . info ( ' watching dir ( s ) : ' + config . options . monitor . map ( function ( rule ) { <nl> + if ( rule . slice ( 0 , 1 ) ! = = ' ! ' ) { <nl> + try { <nl> + rule = path . relative ( process . cwd ( ) , rule ) ; <nl> + } catch ( e ) { } <nl> + <nl> + return rule ; <nl> + } <nl> + <nl> + return false ; <nl> } ) . filter ( Boolean ) . join ( ' ' ) ) ; <nl> utils . log . detail ( ' watching extensions : ' + ( config . options . execOptions . ext | | ' ( all ) ' ) ) ; <nl> 
mmm a / lib / nodemon . js <nl> ppp b / lib / nodemon . js <nl> return false ; <nl> } ) . filter ( Boolean ) . join ( ' ' ) ) ; <nl> - utils . log . detail ( ' watching extensions : ' + ( config . options . execOptions . ext | | ' ( all ) ' ) ) ; <nl> + utils . log . info ( ' watching extensions : ' + ( config . options . execOptions . ext | | ' ( all ) ' ) ) ; <nl> if ( config . options . dump ) { <nl> utils . log . _log ( ' log ' , ' - - - - - - - - - - - - - - ' ) ; <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> var path = require ( ' path ' ) ; <nl> var signals = require ( ' . / signals ' ) ; <nl> + function waitForSubprocesses ( subprocesses , callback ) { <nl> + if ( Array . isArray ( subprocesses ) & & subprocesses . length > 0 ) { <nl> + / / check if all old subprocesses have been terminated <nl> + exec ( ' kill - 0 ' + subprocesses . join ( ' ' ) , ( error ) = > { <nl> + const returnCode = error ? error . code : 0 ; <nl> + if ( returnCode < 126 ) { / / ignore command not found error <nl> + const stillRunning = subprocesses . length - returnCode ; <nl> + if ( stillRunning > 0 ) { <nl> + utils . log . status ( ' still waiting for ' + stillRunning + <nl> + ' subprocess ( es ) to finish . . . ' ) ; <nl> + setTimeout ( waitForSubprocesses . bind ( this , subprocesses , callback ) , <nl> + 100 ) ; <nl> + return ; <nl> + } <nl> + } <nl> + callback ( ) ; <nl> + } ) ; <nl> + } else { <nl> + callback ( ) ; <nl> + } <nl> + } <nl> + <nl> function run ( options ) { <nl> var cmd = config . command . raw ; <nl> @ @ - 341 , 17 + 363 , 24 @ @ function kill ( child , signal , callback ) { <nl> / / configured signal ( default : SIGUSR2 ) signal , which fixes # 335 <nl> / / note that psTree also works if ` ps ` is missing by looking in / proc <nl> const sig = signal . replace ( ' SIG ' , ' ' ) ; <nl> - psTree ( child . pid , function ( err , kids ) { <nl> + psTree ( child . pid , function ( err , subprocesses ) { <nl> if ( psTree . hasPS ) { <nl> - spawn ( ' kill ' , [ ' - s ' , sig , child . pid ] . concat ( kids ) ) <nl> + spawn ( ' kill ' , [ ' - s ' , sig ] . concat ( subprocesses ) ) <nl> + . on ( ' close ' , waitForSubprocesses . bind ( this , subprocesses , <nl> + function ( ) { <nl> + spawn ( ' kill ' , [ ' - s ' , sig , child . pid ] ) <nl> . on ( ' close ' , callback ) ; <nl> + } ) ) ; <nl> } else { <nl> / / make sure we kill from smallest to largest <nl> - const pids = kids . concat ( child . pid ) . sort ( ) ; <nl> + const pids = subprocesses . slice ( ) . sort ( ) ; <nl> pids . forEach ( pid = > { <nl> exec ( ' kill - ' + signals [ signal ] + ' ' + pid , ( ) = > { } ) ; <nl> } ) ; <nl> + waitForSubprocesses ( subprocesses , function ( ) { <nl> + exec ( ' kill - ' + signals [ signal ] + ' ' + child . pid , ( ) = > { } ) ; <nl> callback ( ) ; <nl> + } ) <nl> } <nl> } ) ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " update - notifier " : " ^ 4 . 0 . 0 " <nl> } , <nl> - " version " : " 0 . 0 . 0 - development " <nl> + " version " : " 0 . 0 . 0 - development " , <nl> + " funding " : { <nl> + " type " : " opencollective " , <nl> + " url " : " https : / / opencollective . com / nodemon " <nl> + } <nl> } <nl> 
mmm a / bin / postinstall . js <nl> ppp b / bin / postinstall . js <nl> function main ( ) { <nl> - if ( process . env . SUPPRESS_SUPPORT | | process . env . OPENCOLLECTIVE_HIDE ) { <nl> + if ( process . env . SUPPRESS_SUPPORT | | process . env . OPENCOLLECTIVE_HIDE | | process . env . CI ) { <nl> return ; <nl> } <nl> 
mmm a / lib / nodemon . js <nl> ppp b / lib / nodemon . js <nl> } <nl> if ( settings . help ) { <nl> + if ( process . stdout . isTTY ) { <nl> process . stdout . _handle . setBlocking ( true ) ; / / nodejs / node # 6456 <nl> + } <nl> console . log ( help ( settings . help ) ) ; <nl> if ( ! config . required ) { <nl> process . exit ( 0 ) ; <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> / / We are using the standalone ' windows - kill ' executable to send the <nl> / / standard POSIX signal ' SIGINT ' to the node process . This fixes # 1720 . <nl> const windowsKill = path . normalize ( <nl> - ` $ { process . cwd ( ) } / node_modules / nodemon / bin / windows - kill . exe ` <nl> + ` $ { __dirname } / . . / . . / bin / windows - kill . exe ` <nl> ) ; <nl> / / We have to detach the ' windows - kill ' execution completely from this <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> var psTree = require ( ' pstree . remy ' ) ; <nl> var path = require ( ' path ' ) ; <nl> var signals = require ( ' . / signals ' ) ; <nl> + const osRelease = require ( ' os ' ) . release ( ) ; <nl> function run ( options ) { <nl> var cmd = config . command . raw ; <nl> @ @ - 312 , 11 + 313 , 18 @ @ function kill ( child , signal , callback ) { <nl> } <nl> if ( utils . isWindows ) { <nl> + const taskKill = ( ) = > { <nl> + try { <nl> + exec ( ' taskkill / pid ' + child . pid + ' / T / F ' ) ; <nl> + } catch ( e ) { <nl> + utils . log . error ( " Could not shutdown sub process cleanly " ) ; <nl> + } <nl> + } <nl> / / We are handling a ' SIGKILL ' POSIX signal under Windows the <nl> / / same way it is handled on a UNIX system : We are performing <nl> / / a hard shutdown without waiting for the process to clean - up . <nl> - if ( signal = = = ' SIGKILL ' ) { <nl> + if ( signal = = = ' SIGKILL ' | | osRelease < 10 ) { <nl> debug ( ' terminating process group by force : % s ' , child . pid ) ; <nl> @ @ - 324 , 7 + 332 , 7 @ @ function kill ( child , signal , callback ) { <nl> / / process group ( ' / t ' ) of the child ( ' / pid ' ) by force ( ' / f ' ) . <nl> / / We need to end all sub processes , because the ' child ' <nl> / / process in this context is actually a cmd . exe wrapper . <nl> - exec ( ` taskkill / f / t / pid $ { child . pid } ` ) ; <nl> + taskKill ( ) ; <nl> callback ( ) ; <nl> return ; <nl> } <nl> @ @ - 357 , 9 + 365 , 13 @ @ function kill ( child , signal , callback ) { <nl> / / Therefore we are using ' start ' to create a new cmd . exe context . <nl> / / The ' / min ' option hides the new terminal window and the ' / wait ' <nl> / / option lets the process wait for the command to finish . <nl> + try { <nl> execSync ( <nl> ` start " windows - kill " / min / wait " $ { windowsKill } " - SIGINT $ { processId } ` <nl> ) ; <nl> + } catch ( e ) { <nl> + taskKill ( ) ; <nl> + } <nl> callback ( ) ; <nl> } else { <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> var psTree = require ( ' pstree . remy ' ) ; <nl> var path = require ( ' path ' ) ; <nl> var signals = require ( ' . / signals ' ) ; <nl> - const osRelease = require ( ' os ' ) . release ( ) ; <nl> + const osRelease = parseInt ( require ( ' os ' ) . release ( ) . split ( " . " ) [ 0 ] , 10 ) ; <nl> function run ( options ) { <nl> var cmd = config . command . raw ; <nl> 
mmm a / lib / spawn . js <nl> ppp b / lib / spawn . js <nl> const utils = require ( ' . / utils ' ) ; <nl> const merge = utils . merge ; <nl> const bus = utils . bus ; <nl> @ @ - 10 , 26 + 11 , 43 @ @ module . exports = function spawnCommand ( command , config , eventArgs ) { <nl> stdio = [ ' pipe ' , process . stdout , process . stderr ] ; <nl> } <nl> + const env = merge ( process . env , { FILENAME : eventArgs [ 0 ] } ) ; <nl> + <nl> var sh = ' sh ' ; <nl> var shFlag = ' - c ' ; <nl> - <nl> - if ( utils . isWindows ) { <nl> - sh = ' cmd ' ; <nl> - shFlag = ' / c ' ; <nl> - } <nl> - <nl> + var spawnOptions = { <nl> + env : merge ( config . options . execOptions . env , env ) , <nl> + stdio : stdio , <nl> + } ; <nl> if ( ! Array . isArray ( command ) ) { <nl> command = [ command ] ; <nl> } <nl> - const args = command . join ( ' ' ) ; <nl> + if ( utils . isWindows ) { <nl> + / / if the exec includes a forward slash , reverse it for windows compat <nl> + / / but * only * apply to the first command , and none of the arguments . <nl> + / / ref # 1251 and # 1236 <nl> + command = command . map ( executable = > { <nl> + if ( executable . indexOf ( ' / ' ) = = = - 1 ) { <nl> + return executable ; <nl> + } <nl> - const env = merge ( process . env , { FILENAME : eventArgs [ 0 ] } ) ; <nl> - const child = spawn ( sh , [ shFlag , args ] , { <nl> - env : merge ( config . options . execOptions . env , env ) , <nl> - stdio : stdio , <nl> + return executable . split ( ' ' ) . map ( ( e , i ) = > { <nl> + if ( i = = = 0 ) { <nl> + return path . normalize ( e ) ; <nl> + } <nl> + return e ; <nl> + } ) . join ( ' ' ) ; <nl> } ) ; <nl> + / / taken from npm ' s cli : https : / / git . io / vNFD4 <nl> + sh = process . env . comspec | | ' cmd ' ; <nl> + shFlag = ' / d / s / c ' ; <nl> + spawnOptions . windowsVerbatimArguments = true ; <nl> + } <nl> + <nl> + const args = command . join ( ' ' ) ; <nl> + const child = spawn ( sh , [ shFlag , args ] , spawnOptions ) ; <nl> if ( config . required ) { <nl> var emit = { <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> } <nl> } ; <nl> - / / We are handling a ' SIGKILL ' POSIX signal under Windows the <nl> + / / We are handling a ' SIGKILL ' , ' SIGUSR2 ' and ' SIGUSR1 ' POSIX signal under Windows the <nl> / / same way it is handled on a UNIX system : We are performing <nl> / / a hard shutdown without waiting for the process to clean - up . <nl> - if ( signal = = = ' SIGKILL ' | | osRelease < 10 ) { <nl> + if ( signal = = = ' SIGKILL ' | | osRelease < 10 | | signal = = = ' SIGUSR2 ' | | signal = = = " SIGUSR1 " ) { <nl> debug ( ' terminating process group by force : % s ' , child . pid ) ; <nl> / / We are using the taskkill utility to terminate the whole <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> const spawnOptions = { <nl> env : Object . assign ( { } , process . env , options . execOptions . env , { <nl> - PATH : binPath + ' : ' + process . env . PATH , <nl> + PATH : binPath + path . delimiter + process . env . PATH , <nl> } ) , <nl> stdio : stdio , <nl> } ; <nl> 
mmm a / src / server . js <nl> ppp b / src / server . js <nl> - import { parse as parseUrl } from ' url ' ; <nl> import ws from ' ws ' ; <nl> - import polka from ' polka ' ; <nl> import sirv from ' sirv ' ; <nl> + import polka from ' polka ' ; <nl> + import parse from ' @ polka / url ' ; <nl> import compression from ' . / lib / polkompress . js ' ; <nl> / * * <nl> @ @ - 32 , 7 + 32 , 7 @ @ export default function server ( { cwd , out , compress = true } = { } ) { <nl> } ; <nl> app . server . on ( ' upgrade ' , ( req , socket , head ) = > { <nl> - const pathname = parseUrl ( req . url ) . pathname ; <nl> + const pathname = parse ( req ) . pathname ; <nl> if ( pathname = = ' / _hmr ' ) { <nl> app . ws . handleUpgrade ( req , socket , head , ws = > { <nl> ws . emit ( ' connection ' , ws , req ) ; <nl> 
mmm a / src / server . js <nl> ppp b / src / server . js <nl> app . use ( sirv ( overlayDir , { dev : true } ) ) ; <nl> } <nl> - const servePublic = sirv ( cwd | | ' ' , { dev : true } ) ; <nl> - app . use ( servePublic ) ; <nl> / / SPA nav fallback <nl> - app . use ( ( req , res , next ) = > { <nl> - if ( ! / text \ / html / . test ( req . headers . accept ) ) return next ( ) ; <nl> - / / @ ts - ignore <nl> - req . path = ' / ' ; <nl> - servePublic ( req , res , next ) ; <nl> - } ) ; <nl> + app . use ( <nl> + sirv ( cwd | | ' ' , { <nl> + ignores : [ ' @ npm ' ] , <nl> + single : true , <nl> + dev : true <nl> + } ) <nl> + ) ; <nl> return app ; <nl> } <nl> 
mmm a / types . d . ts <nl> ppp b / types . d . ts <nl> } <nl> declare var module : NodeModule ; <nl> - declare module ' * . css ' { const url : string ; export default url ; } <nl> - declare module ' * . scss ' { const url : string ; export default url ; } <nl> - declare module ' * . sass ' { const url : string ; export default url ; } <nl> - declare module ' * . styl ' { const url : string ; export default url ; } <nl> - <nl> / * * Maps authored classNames to their CSS Modules - suffixed generated classNames . * / <nl> - interface Mapping { [ key : string ] : string ; } <nl> + type Mapping = Record < string , string > ; <nl> declare module ' * . module . css ' { const mapping : Mapping ; export default mapping ; } <nl> declare module ' * . module . scss ' { const mapping : Mapping ; export default mapping ; } <nl> declare module ' * . module . sass ' { const mapping : Mapping ; export default mapping ; } <nl> declare module ' * . module . styl ' { const mapping : Mapping ; export default mapping ; } <nl> + declare module ' * . css ' { const url : string ; export default url ; } <nl> + declare module ' * . scss ' { const url : string ; export default url ; } <nl> + declare module ' * . sass ' { const url : string ; export default url ; } <nl> + declare module ' * . styl ' { const url : string ; export default url ; } <nl> + <nl> / / Import Prefixes <nl> declare module ' json : ' ; <nl> declare module ' css : ' ; <nl> 
mmm a / src / lib / prerender . js <nl> ppp b / src / lib / prerender . js <nl> / / Prevent Rollup from transforming ` import ( ) ` here . <nl> const $ import = new Function ( ' s ' , ' return import ( s ) ' ) ; <nl> - const m = await $ import ( script ) ; <nl> + const m = await $ import ( ' file : / / / ' + script ) ; <nl> const doPrerender = m . prerender ; <nl> / / const App = m . default | | m [ Object . keys ( m ) [ 0 ] ] ; <nl> 
mmm a / src / plugins / public - path - plugin . js <nl> ppp b / src / plugins / public - path - plugin . js <nl> name : ' public - path ' , <nl> resolveFileUrl ( assetInfo ) { <nl> if ( ! publicPath | | ( filter & & ! filter ( assetInfo ) ) ) return null ; <nl> - const { fileName } = assetInfo ; <nl> - return JSON . stringify ( posix . join ( publicPath , fileName ) ) ; <nl> + <nl> + let output = posix . join ( publicPath , assetInfo . fileName ) ; <nl> + if ( / ^ ( https ? : ) ? \ / \ / / . test ( publicPath ) ) { <nl> + output = new URL ( assetInfo . fileName , publicPath ) . href ; <nl> + } <nl> + <nl> + return JSON . stringify ( output ) ; <nl> } <nl> } ; <nl> } <nl> 
mmm a / src / lib / prerender . js <nl> ppp b / src / lib / prerender . js <nl> * @ param { object } options <nl> * @ property { string } [ cwd = ' . ' ] <nl> * @ property { string } [ out = ' . cache ' ] <nl> + * @ property { string } publicPath <nl> * / <nl> - export function prerender ( { cwd = ' . ' , out = ' . cache ' } ) { <nl> + export function prerender ( { cwd = ' . ' , out = ' . cache ' , publicPath } ) { <nl> const w = new Worker ( <nl> ` ( $ { workerCode } ) ( require ( ' worker_threads ' ) . workerData ) <nl> . then ( r = > require ( ' worker_threads ' ) . parentPort . postMessage ( [ 1 , r ] ) ) <nl> . catch ( err = > require ( ' worker_threads ' ) . parentPort . postMessage ( [ 0 , err & & err . stack | | err + ' ' ] ) ) ` , <nl> { <nl> eval : true , <nl> - workerData : { cwd , out } , <nl> + workerData : { cwd , out , publicPath } , <nl> / / execArgv : [ ' - - experimental - modules ' ] , <nl> stderr : true <nl> } <nl> @ @ - 28 , 7 + 29 , 7 @ @ export function prerender ( { cwd = ' . ' , out = ' . cache ' } ) { <nl> } ) ; <nl> } <nl> - async function workerCode ( { cwd , out } ) { <nl> + async function workerCode ( { cwd , out , publicPath } ) { <nl> / * global globalThis * / <nl> const path = require ( ' path ' ) ; <nl> @ @ - 67 , 6 + 68 , 7 @ @ async function workerCode ( { cwd , out } ) { <nl> throw Error ( ` Unable to detect < script src = " entry . js " > in your index . html . ` ) ; <nl> } <nl> / / script = new URL ( ` . . / dist / $ { script . replace ( / ^ ( \ . ? \ / ) ? / g , ' ' ) } ` , selfUrl ) . href ; <nl> + script = script . replace ( publicPath , ' ' ) ; <nl> script = path . resolve ( cwd , out , script . replace ( / ^ ( \ . ? \ / ) ? / g , ' ' ) ) ; <nl> / / Prevent Rollup from transforming ` import ( ) ` here . <nl> 
mmm a / src / plugins / public - path - plugin . js <nl> ppp b / src / plugins / public - path - plugin . js <nl> let output = posix . join ( publicPath , assetInfo . fileName ) ; <nl> if ( / ^ ( https ? : ) ? \ / \ / / . test ( publicPath ) ) { <nl> - output = new URL ( assetInfo . fileName , publicPath ) . href ; <nl> + const isFull = / ^ https : \ / \ / / . test ( publicPath ) ; <nl> + const root = isFull ? publicPath : ' https : ' + publicPath ; <nl> + output = new URL ( assetInfo . fileName , root ) . href . substring ( isFull ? 0 : 6 ) ; <nl> } <nl> return JSON . stringify ( output ) ; <nl> 
mmm a / src / plugins / optimize - graph - plugin . js <nl> ppp b / src / plugins / optimize - graph - plugin . js <nl> let rep = typeof newUrl = = = ' function ' ? newUrl ( url , fn , quote ) : newUrl ; <nl> if ( rep = = = false ) return ' null ' ; <nl> if ( typeof rep = = = ' string ' ) { <nl> - if ( publicPath ) rep = posix . join ( publicPath , rep ) ; <nl> - rep = JSON . stringify ( rep ) ; <nl> + rep = publicPath ? toImport ( publicPath , rep , true ) : JSON . stringify ( rep ) ; <nl> } <nl> return ` $ { fn } ( $ { rep } ) ` ; <nl> } <nl> @ @ - 185 , 6 + 184 , 23 @ @ class ChunkGraph { <nl> } <nl> } <nl> + / * * <nl> + * @ param { string } publicPath <nl> + * @ param { string } filename <nl> + * @ param { boolean } [ toJSON ] <nl> + * / <nl> + function toImport ( publicPath , filename , toJSON ) { <nl> + let value = posix . join ( publicPath , filename ) ; <nl> + <nl> + if ( / ^ ( https ? : ) ? \ / \ / / . test ( publicPath ) ) { <nl> + const isFull = / ^ https : \ / \ / / . test ( publicPath ) ; <nl> + const root = isFull ? publicPath : ' https : ' + publicPath ; <nl> + value = new URL ( filename , root ) . href . substring ( isFull ? 0 : 6 ) ; <nl> + } <nl> + <nl> + return toJSON ? JSON . stringify ( value ) : value ; <nl> + } <nl> + <nl> / * * <nl> * Merge together CSS assets that are only used by the same parent chunk <nl> * @ param { ChunkGraph } graph <nl> @ @ - 331 , 6 + 347 , 7 @ @ function hoistCascadedCss ( graph , { cssMinSize } ) { <nl> meta . styleLoadFn = DEFAULT_STYLE_LOAD_FN ; <nl> parentChunk . code + = ' \ n ' + DEFAULT_STYLE_LOAD_IMPL ; <nl> } <nl> + <nl> const url = JSON . stringify ( posix . join ( graph . publicPath , fileName ) ) ; <nl> parentChunk . code + = ` \ n $ { meta . styleLoadFn } ( $ { url } ) ; ` ; <nl> } <nl> @ @ - 373 , 7 + 390 , 9 @ @ function hoistTransitiveImports ( graph ) { <nl> appendCode + = ' \ n ' + DEFAULT_STYLE_LOAD_IMPL ; <nl> } <nl> if ( DEBUG ) console . log ( ` Preloading CSS for import ( $ { spec } ) : $ { css } ` ) ; <nl> - preloads . push ( . . . css . map ( f = > ` $ { meta . styleLoadFn } ( $ { JSON . stringify ( posix . join ( graph . publicPath , f ) ) } ) ` ) ) ; <nl> + preloads . push ( <nl> + . . . css . map ( f = > ` $ { meta . styleLoadFn } ( $ { toImport ( graph . publicPath , f , true ) } ) ` ) <nl> + ) ; <nl> } <nl> const js = deps . js . get ( spec ) ; <nl> 
mmm a / src / plugins / optimize - graph - plugin . js <nl> ppp b / src / plugins / optimize - graph - plugin . js <nl> } else { <nl> / / @ TODO : this branch is actually unreachable <nl> if ( DEBUG ) console . log ( ` Hoisting CSS " $ { f } " imported by $ { id } into parent HTML . ` ) ; <nl> - const url = JSON . stringify ( posix . join ( graph . publicPath , f ) ) ; <nl> + const url = toImport ( graph . publicPath , f , true ) ; <nl> asset . source = getAssetSource ( asset ) . replace ( / < \ / head > / , ` < link rel = " stylesheet " href = $ { url } > < / head > ` ) ; <nl> } <nl> } <nl> @ @ - 348 , 7 + 348 , 7 @ @ function hoistCascadedCss ( graph , { cssMinSize } ) { <nl> parentChunk . code + = ' \ n ' + DEFAULT_STYLE_LOAD_IMPL ; <nl> } <nl> - const url = JSON . stringify ( posix . join ( graph . publicPath , fileName ) ) ; <nl> + const url = toImport ( graph . publicPath , fileName , true ) ; <nl> parentChunk . code + = ` \ n $ { meta . styleLoadFn } ( $ { url } ) ; ` ; <nl> } <nl> break ; <nl> @ @ - 400 , 6 + 400 , 7 @ @ function hoistTransitiveImports ( graph ) { <nl> if ( DEBUG ) console . log ( ` Preloading JS for import ( $ { spec } ) : $ { js } ` ) ; <nl> preloads . push ( <nl> . . . js . map ( f = > { <nl> + / / TODO : should have ` toImport ( . . . ) ` somewhere here <nl> let rel = posix . relative ( posix . dirname ( ' / ' + fileName ) , posix . join ( graph . publicPath , f ) ) ; <nl> if ( ! rel . startsWith ( ' . ' ) ) rel = ' . / ' + rel ; <nl> return ` import ( $ { JSON . stringify ( rel ) } ) ` ; <nl> 
mmm a / src / cli . js <nl> ppp b / src / cli . js <nl> . option ( ' - - cwd ' , ' The working directory - equivalent to " ( cd FOO & & wmr ) " ' ) <nl> . command ( ' build ' , ' make a production build ' ) <nl> . option ( ' - - prerender ' , ' Pre - render the application to HTML ' ) <nl> - . option ( ' - - minify ' , ' Minify built assets ( default : enabled ) ' ) <nl> . action ( opts = > { <nl> opts . minify = opts . minify ! = = false & & ! / false | 0 / . test ( opts . minify ) ; <nl> run ( build ( opts ) ) ; <nl> 
mmm a / test / production . test . js <nl> ppp b / test / production . test . js <nl> describe ( ' config . publicPath ' , ( ) = > { <nl> it ( ' should respect ` config . publicPath ` value ' , async ( ) = > { <nl> - await loadFixture ( ' publicPath ' , env ) ; <nl> + await loadFixture ( ' publicpath ' , env ) ; <nl> instance = await runWmr ( env . tmp . path , ' build ' ) ; <nl> const code = await instance . done ; <nl> console . info ( instance . output . join ( ' \ n ' ) ) ; <nl> 
mmm a / src / plugins / optimize - graph - plugin . js <nl> ppp b / src / plugins / optimize - graph - plugin . js <nl> if ( DEBUG ) console . log ( ` Preloading JS for import ( $ { spec } ) : $ { js } ` ) ; <nl> preloads . push ( <nl> . . . js . map ( f = > { <nl> - / / TODO : should have ` toImport ( . . . ) ` somewhere here <nl> + if ( / ^ ( https ? : ) ? \ / \ / / . test ( graph . publicPath ) ) { <nl> + return ` import ( $ { toImport ( graph . publicPath , f ) } ) ` ; <nl> + } <nl> let rel = posix . relative ( posix . dirname ( ' / ' + fileName ) , posix . join ( graph . publicPath , f ) ) ; <nl> if ( ! rel . startsWith ( ' . ' ) ) rel = ' . / ' + rel ; <nl> return ` import ( $ { JSON . stringify ( rel ) } ) ` ; <nl> 
mmm a / packages / preact - iso / router . d . ts <nl> ppp b / packages / preact - iso / router . d . ts <nl> } <nl> declare module ' preact ' { <nl> - export interface Attributes extends RoutableProps { } <nl> + namespace JSX { <nl> + interface IntrinsicAttributes extends RoutableProps { } <nl> + } <nl> } <nl> 
mmm a / packages / preact - iso / package . json <nl> ppp b / packages / preact - iso / package . json <nl> " module " : " . / index . js " , <nl> " types " : " . / index . d . ts " , <nl> + " type " : " module " , <nl> " exports " : { <nl> " . " : " . / index . js " , <nl> " . / router " : " . / router . js " , <nl> " devDependencies " : { <nl> " preact " : " ^ 10 . 5 . 7 " , <nl> " preact - render - to - string " : " ^ 5 . 1 . 12 " <nl> + } , <nl> + " peerDependencies " : { <nl> + " preact " : " > = 10 " , <nl> + " preact - render - to - string " : " > = 5 " <nl> } <nl> } <nl> \ No newline at end of file <nl> 
mmm a / packages / preact - iso / index . d . ts <nl> ppp b / packages / preact - iso / index . d . ts <nl> import { PrerenderOptions } from ' . / prerender ' ; <nl> + export { Router , LocationProvider , useLoc , useLocation } from ' . / router ' ; <nl> + export { default as lazy , ErrorBoundary } from ' . / lazy ' ; <nl> + export { default as hydrate } from ' . / hydrate ' ; <nl> + <nl> export default function prerender ( vnode : VNode , options ? : PrerenderOptions ) : Promise < { html : string , links : Set < string > } > ; <nl> 
mmm a / packages / create - wmr / src / index . js <nl> ppp b / packages / create - wmr / src / index . js <nl> const origCwd = process . cwd ( ) ; <nl> let cwd = process . cwd ( ) ; <nl> if ( dir ) { <nl> - if ( ( await fs . stat ( dir ) ) . isDirectory ( ) & & ! opts . force ) { <nl> + try { <nl> + ( await fs . stat ( dir ) ) . isDirectory ( ) ; <nl> + if ( ! opts . force ) { <nl> process . stderr . write ( <nl> - ` $ { red ( ` Refusing to overwrite directory ! Please specify a different directory or use the ' - - force ' flag ` ) } \ n ` <nl> + ` $ { red ( <nl> + ` Refusing to overwrite directory ! Please specify a different directory or use the ' - - force ' flag ` <nl> + ) } \ n ` <nl> ) ; <nl> process . exit ( 1 ) ; <nl> } <nl> + } catch { } <nl> cwd = resolve ( cwd , dir | | ' . ' ) ; <nl> await fs . mkdir ( cwd , { recursive : true } ) ; <nl> process . chdir ( cwd ) ; <nl> 
mmm a / packages / create - wmr / src / index . js <nl> ppp b / packages / create - wmr / src / index . js <nl> process . exit ( 1 ) ; <nl> } <nl> cwd = resolve ( cwd , dir | | ' . ' ) ; <nl> + try { <nl> await fs . mkdir ( cwd , { recursive : true } ) ; <nl> + } catch { <nl> + process . stderr . write ( <nl> + ` $ { red ( <nl> + ` There is already a file with the same name as the directory you specified . Please provide a different directory name ` <nl> + ) } \ n ` <nl> + ) ; <nl> + process . exit ( 1 ) ; <nl> + } <nl> process . chdir ( cwd ) ; <nl> } <nl> const ctx = { <nl> 
mmm a / packages / create - wmr / tpl / tsconfig . json <nl> ppp b / packages / create - wmr / tpl / tsconfig . json <nl> " downlevelIteration " : true <nl> } , <nl> - " files " : [ " . / node_modules / wmr / index . d . ts " ] , <nl> + " include " : [ " node_modules / wmr / index . d . ts " ] , <nl> " typeAcquisition " : { <nl> " enable " : true <nl> } <nl> 
mmm a / packages / create - wmr / tpl / tsconfig . json <nl> ppp b / packages / create - wmr / tpl / tsconfig . json <nl> " downlevelIteration " : true <nl> } , <nl> - " include " : [ " node_modules / wmr / index . d . ts " ] , <nl> + " include " : [ " node_modules / wmr / types . d . ts " ] , <nl> " typeAcquisition " : { <nl> " enable " : true <nl> } <nl> 
mmm a / packages / wmr / src / lib / ~ publish . js <nl> ppp b / packages / wmr / src / lib / ~ publish . js <nl> const pkg = JSON . parse ( read ( ' package . json ' ) ) ; <nl> copy ( ' package . json ' , ' . package . json ' ) ; <nl> - const { name , version , bin , author , contributors , repository , dependencies , types , files , engines , main } = pkg ; <nl> + const { name , version , bin , type , author , contributors , repository , dependencies , types , files , engines , main } = pkg ; <nl> const normalized = { <nl> name , <nl> version , <nl> bin , <nl> + type , <nl> main , <nl> author , <nl> contributors , <nl> 
mmm a / packages / wmr / src / plugins / copy - assets - plugin . js <nl> ppp b / packages / wmr / src / plugins / copy - assets - plugin . js <nl> const IGNORE_FILES = [ <nl> ' . ' , <nl> + ' . d . ts ' , <nl> ' node_modules ' , <nl> ' package . json ' , <nl> ' package - lock . json ' , <nl> @ @ - 72 , 12 + 73 , 19 @ @ export default function copyAssetsPlugin ( { cwd = ' . ' } = { } ) { <nl> async function readdirRecursive ( rootDir , ignore = [ ] ) { <nl> const files = [ ] ; <nl> const noDotFiles = ignore . includes ( ' . ' ) ; <nl> + const noDeclarationFiles = ignore . includes ( ' . d . ts ' ) ; <nl> const r = async dir = > { <nl> const p = [ ] ; <nl> const wdir = join ( rootDir , dir ) ; <nl> for ( const f of await fs . readdir ( wdir , { withFileTypes : true } ) ) { <nl> const name = join ( dir , f . name ) ; <nl> - if ( ( noDotFiles & & f . name [ 0 ] = = = ' . ' ) | | ignore . includes ( f . name ) | | ignore . includes ( ' / ' + name ) ) continue ; <nl> + if ( <nl> + ( noDotFiles & & f . name [ 0 ] = = = ' . ' ) | | <nl> + ( noDeclarationFiles & & / \ . d \ . ts $ / . test ( f . name ) ) | | <nl> + ignore . includes ( f . name ) | | <nl> + ignore . includes ( ' / ' + name ) <nl> + ) <nl> + continue ; <nl> if ( f . isFile ( ) ) files . push ( name ) ; <nl> else if ( f . isDirectory ( ) ) p . push ( r ( name ) ) ; <nl> } <nl> 
mmm a / packages / wmr / src / cli . js <nl> ppp b / packages / wmr / src / cli . js <nl> / / global options <nl> prog <nl> - . option ( ' - - public ' , ' Your web app root directory ( default : . / public ) ' ) <nl> - . option ( ' - - out ' , ' Where to store generated files ( default : . / dist ) ' ) <nl> . option ( ' - - cwd ' , ' The working directory - equivalent to " ( cd FOO & & wmr ) " ' ) <nl> / / Setting env variables isn ' t common knowledege for many windows users . Much <nl> / / easier to pass a flag to our binary instead . <nl> @ @ - 24 , 6 + 22 , 8 @ @ prog <nl> prog <nl> . command ( ' build ' , ' make a production build ' ) <nl> + . option ( ' - - public ' , ' Your web app root directory ( default : . / public ) ' ) <nl> + . option ( ' - - out ' , ' Where to store generated files ( default : . / dist ) ' ) <nl> . option ( ' - - prerender ' , ' Pre - render the application to HTML ' ) <nl> . option ( ' - - sourcemap ' , ' Enable Source Maps ' ) <nl> . option ( ' - - visualize ' , ' Launch interactive bundle visualizer ' ) <nl> @ @ - 46 , 6 + 46 , 7 @ @ prog <nl> prog <nl> . command ( ' start ' , ' Start a development server ' , { default : true } ) <nl> + . option ( ' - - public ' , ' Your web app root directory ( default : . / public ) ' ) <nl> . option ( ' - - port , - p ' , ' HTTP port to listen on ( default : $ PORT or 8080 ) ' ) <nl> . option ( ' - - host ' , ' HTTP host to listen on ( default : localhost ) ' ) <nl> . option ( ' - - http2 ' , ' Use HTTP / 2 ( default : false ) ' ) <nl> 
mmm a / packages / wmr / src / lib / normalize - options . js <nl> ppp b / packages / wmr / src / lib / normalize - options . js <nl> out : resolve ( ' . ' ) , <nl> hmr : false , <nl> rewriteNodeImports : false , <nl> - format : pkg ? . type = = = ' module ' ? ' es ' : ' commonjs ' <nl> + format : pkg & & pkg . type = = = ' module ' ? ' es ' : ' commonjs ' <nl> } ) ; <nl> } <nl> 
mmm a / packages / wmr / src / lib / normalize - options . js <nl> ppp b / packages / wmr / src / lib / normalize - options . js <nl> / / ignore error , reading aliases from package . json is an optional feature <nl> } <nl> - const EXTENSIONS = [ ' . js ' , ' . ts ' , ' . mjs ' ] ; <nl> + const EXTENSIONS = [ ' . ts ' , ' . js ' , ' . mjs ' ] ; <nl> let custom ; <nl> let initialError ; <nl> 
mmm a / packages / wmr / src / plugins / optimize - graph - plugin . js <nl> ppp b / packages / wmr / src / plugins / optimize - graph - plugin . js <nl> / * * @ typedef { import ( ' rollup ' ) . OutputAsset } Asset * / <nl> / * * @ typedef { Asset & { referencedFiles ? : string [ ] , importedIds ? : string [ ] } } ExtendedAsset * / <nl> - const DEBUG = hasDebugFlag ( ) ; <nl> + let DEBUG ; <nl> const DEFAULT_STYLE_LOAD_FN = ' $ w_s $ ' ; <nl> const DEFAULT_STYLE_LOAD_IMPL = ` function $ w_s $ ( e , t ) { typeof document = = ' undefined ' ? wmr . ssr . head . elements . add ( { type : ' link ' , props : { rel : ' stylesheet ' , href : e } } ) : document . querySelector ( ' link [ rel = stylesheet ] [ href = " ' + e + ' " ] ' ) | | ( ( t = document . createElement ( " link " ) ) . rel = " stylesheet " , t . href = e , document . head . appendChild ( t ) ) } ` ; <nl> @ @ - 24 , 6 + 24 , 7 @ @ const DEFAULT_STYLE_LOAD_IMPL = ` function $ w_s $ ( e , t ) { typeof document = = ' undefined <nl> * @ returns { import ( ' rollup ' ) . Plugin } <nl> * / <nl> export default function optimizeGraphPlugin ( { publicPath = ' ' , cssMinSize = 1000 } = { } ) { <nl> + DEBUG = hasDebugFlag ( ) ; <nl> return { <nl> name : ' optimize - graph ' , <nl> async generateBundle ( _ , bundle ) { <nl> 
mmm a / packages / wmr / src / lib / polkompress . js <nl> ppp b / packages / wmr / src / lib / polkompress . js <nl> listeners . forEach ( p = > on . apply ( res , p ) ) ; <nl> } <nl> - if ( pendingStatus ) writeHead . call ( res , pendingStatus ) ; <nl> + writeHead . call ( res , pendingStatus | | res . statusCode ) ; <nl> } <nl> const { end , write , on , writeHead } = res ; <nl> 
mmm a / packages / wmr / src / plugins / wmr / client . js <nl> ppp b / packages / wmr / src / plugins / wmr / client . js <nl> document . body . appendChild ( iframe ) ; <nl> return iframe ; <nl> } <nl> + <nl> + / * * <nl> + * Removes the debug SW installed by Preact - CLI if it is active . <nl> + * Overlap between WMR and Preact - CLI users shows this is a semi - common <nl> + * and recurring issue . <nl> + * / <nl> + if ( ' serviceWorker ' in navigator ) { <nl> + navigator . serviceWorker . getRegistrations ( ) . then ( registrations = > { <nl> + for ( const registration of registrations ) { <nl> + if ( registration . active ? . scriptURL . endsWith ( ' / sw - debug . js ' ) ) { <nl> + registration . unregister ( ) ; <nl> + } <nl> + } <nl> + } ) ; <nl> + } <nl> 
mmm a / packages / wmr / src / lib / acorn - traverse . js <nl> ppp b / packages / wmr / src / lib / acorn - traverse . js <nl> / / We can drop the whole matched string if it only contains <nl> / / whitespace characters , because that means we ' re at the <nl> / / beginning or at the end of the JSXText node <nl> - const replacement = / [ ^ \ s ] / . test ( value ) ? ' ' : ' ' ; <nl> - value = value . replace ( / \ s * \ n + \ s * / g , replacement ) ; <nl> + if ( / [ ^ \ s ] / . test ( value ) ) { <nl> + value = value . replace ( / ( ^ \ s * \ n \ s * | \ s * \ n \ s * $ ) / g , ' ' ) ; <nl> + value = value . replace ( / \ s * \ n + \ s * / g , ' ' ) ; <nl> + } else { <nl> + value = value . replace ( / \ s * \ n + \ s * / g , ' ' ) ; <nl> + } <nl> } <nl> children . push ( TYPES . stringLiteral ( value ) ) ; <nl> } <nl> 
mmm a / packages / wmr / src / lib / prerender . js <nl> ppp b / packages / wmr / src / lib / prerender . js <nl> const SCRIPT_TAG = / < script ( ? : \ s [ ^ > ] * ? ) ? \ s + src = ( [ ' " ] ? ) ( [ ^ > ] * ? ) \ 1 ( ? : \ s [ ^ > ] * ? ) ? > / g ; <nl> let match ; <nl> - while ( ( match = SCRIPT_TAG . exec ( tpl ) ) ) { <nl> + while ( ( match = SCRIPT_TAG . exec ( tpl ) ) & & ! script ) { <nl> / / Ignore external urls <nl> if ( ! match | | / ^ ( ? : https ? | file | data ) / . test ( match [ 2 ] ) ) continue ; <nl> 
mmm a / packages / wmr / src / lib / normalize - options . js <nl> ppp b / packages / wmr / src / lib / normalize - options . js <nl> / / Files in the output directory are served if no middleware overrides them : <nl> options . overlayDir = options . out ; <nl> - / / Ensure the output directory exists so that writeFile ( ) doesn ' t have to create it : <nl> - / / Note : awaiting the promise later lets it run in parallel with the CWD check below . <nl> - const ensureOutDirPromise = fs . mkdir ( options . out , { recursive : true } ) . catch ( err = > { <nl> - console . warn ( ` Warning : Failed to create output directory : $ { err . message } ` ) ; <nl> - } ) ; <nl> - <nl> options . public = options . public | | ' public ' ; <nl> options . publicPath = options . publicPath | | ' / ' ; <nl> @ @ - 81 , 7 + 75 , 6 @ @ export async function normalizeOptions ( options , mode , configWatchFiles = [ ] ) { <nl> } <nl> let prevPublicFolder = options . public ; <nl> - await ensureOutDirPromise ; <nl> const pkgFile = resolve ( options . cwd , ' package . json ' ) ; <nl> let pkg ; <nl> @ @ - 192 , 6 + 185 , 11 @ @ export async function normalizeOptions ( options , mode , configWatchFiles = [ ] ) { <nl> } <nl> } <nl> + / / Ensure the output directory exists so that writeFile ( ) doesn ' t have to create it <nl> + await fs . mkdir ( options . out , { recursive : true } ) . catch ( err = > { <nl> + console . warn ( ` Warning : Failed to create output directory : $ { err . message } ` ) ; <nl> + } ) ; <nl> + <nl> if ( options . aliases & & Object . keys ( options . aliases ) . length > 0 ) { <nl> deprecated ( <nl> ' Found " aliases " property in WMR \ ' s configuration . It will be removed in a future version of WMR . Please switch to " alias " instead . ' <nl> 
mmm a / packages / wmr / src / lib / prerender . js <nl> ppp b / packages / wmr / src / lib / prerender . js <nl> let head = { lang : ' ' , title : ' ' , elements : new Set ( ) } ; <nl> globalThis . wmr = { ssr : { head } } ; <nl> + / / @ ts - ignore <nl> + globalThis . fetch = async url = > { <nl> + const text = ( ) = > fs . readFile ( ` $ { out } / $ { String ( url ) . replace ( / ^ \ / / , ' ' ) } ` , ' utf - 8 ' ) ; <nl> + return { text , json : ( ) = > text ( ) . then ( JSON . parse ) } ; <nl> + } ; <nl> + <nl> / / Prevent Rollup from transforming ` import ( ) ` here . <nl> const $ import = new Function ( ' s ' , ' return import ( s ) ' ) ; <nl> const m = await $ import ( ' file : / / / ' + script ) ; <nl> 
mmm a / packages / wmr / test / production . test . js <nl> ppp b / packages / wmr / test / production . test . js <nl> it ( ' should serve the demo app ' , async ( ) = > { <nl> await loadFixture ( ' . . / . . / . . / . . / examples / demo ' , env ) ; <nl> for ( const d of [ ' dist ' , ' node_modules ' , ' . cache ' ] ) { <nl> + try { <nl> await fs . rmdir ( path . join ( env . tmp . path , d ) , { recursive : true } ) ; <nl> + } catch { } <nl> } <nl> instance = await runWmr ( env . tmp . path , ' build ' , ' - - prerender ' ) ; <nl> const code = await instance . done ; <nl> 
mmm a / Dockerfile . gh <nl> ppp b / Dockerfile . gh <nl> LABEL maintainer = " rashley - iqt < rashley @ iqt . org > " <nl> - RUN apk update <nl> - RUN git config - - global user . email " clewis @ iqt . org " <nl> - RUN git config - - global user . name " Charlie Lewis " <nl> + RUN apk update & & apk add git <nl> + RUN git config - - global user . email " rashley @ iqt . org " <nl> + RUN git config - - global user . name " rashley - iqt " <nl> COPY . / app <nl> WORKDIR / app <nl> 
mmm a / src / epics / epic . test . js <nl> ppp b / src / epics / epic . test . js <nl> import { createEpicMiddleware } from ' redux - observable ' ; <nl> import { of } from ' rxjs ' ; <nl> - import { QueryParseError } from ' lunr ' ; <nl> - <nl> import rootEpic from ' . / root - epic ' <nl> import { setDataset } from ' . . / domain / dataset ' <nl> import { loadDataset } from " . / load - dataset - epic " <nl> 
mmm a / src / features / dataset - controls / DatasetControls . js <nl> ppp b / src / features / dataset - controls / DatasetControls . js <nl> var host = window . location . host ; <nl> var hostname = window . location . hostname ; <nl> - var port = ' 80 ' ; <nl> + var port = ' 32795 ' ; <nl> const radix = 10 ; <nl> if ( host . indexOf ( ' : ' ) > - 1 ) { <nl> port = String ( parseInt ( host . split ( " : " ) [ 1 ] , radix ) - 1 ) ; <nl> @ @ - 183 , 7 + 183 , 7 @ @ class DatasetControls extends React . Component { <nl> refreshTimerRunning : true <nl> } ) ; <nl> const authHeader = buildAuthHeader ( this . state . username , this . state . password , this . state . token ) ; <nl> - const url = this . state . url ; <nl> + const url = this . state . selected . url ; <nl> const interval = this . state . refreshInterval ; <nl> this . props . startRefresh ( { ' url ' : url , ' header ' : authHeader , ' interval ' : interval } ) ; <nl> } <nl> 
mmm a / src / features / dataset - controls / DatasetControls . js <nl> ppp b / src / features / dataset - controls / DatasetControls . js <nl> var host = window . location . host ; <nl> var hostname = window . location . hostname ; <nl> - var port = ' 32795 ' ; <nl> + var port = ' 80 ' ; <nl> const radix = 10 ; <nl> if ( host . indexOf ( ' : ' ) > - 1 ) { <nl> port = String ( parseInt ( host . split ( " : " ) [ 1 ] , radix ) - 1 ) ; <nl> 
mmm a / src / App . module . css <nl> ppp b / src / App . module . css <nl> display : flex ; <nl> flex - direction : column ; <nl> + height : 100 % <nl> } <nl> : global ( . darkTheme ) . controls { <nl> flex : 1 1 ; <nl> transition : transform 0 . 25s ; <nl> transform : translateZ ( 0 ) ; <nl> + height : 100 % <nl> } <nl> input [ name = hideControls ] { <nl> 
mmm a / src / features / dataset - controls / DatasetControls . js <nl> ppp b / src / features / dataset - controls / DatasetControls . js <nl> refreshInterval : numInt , <nl> } ) ; <nl> } <nl> + else if ( ! interval ) { <nl> + this . setState ( { <nl> + refreshInterval : null , <nl> + } ) ; <nl> + } <nl> } <nl> render ( ) { <nl> 
mmm a / src / features / dataset - controls / DatasetControls . js <nl> ppp b / src / features / dataset - controls / DatasetControls . js <nl> this . props . removeDataset ( { owner : this . props . uuid } ) ; <nl> this . props . removeSearchIndex ( { owner : this . props . uuid } ) ; <nl> - this . props . setHierarchyConfig ( [ ] ) ; <nl> - this . props . colorBy ( null ) ; <nl> - this . props . showNodes ( true ) ; <nl> this . props . stopRefresh ( ) ; <nl> const showUrlEntry = dataset = = = CUSTOM_DATASET ; <nl> @ @ - 125 , 8 + 122 , 6 @ @ class DatasetControls extends React . Component { <nl> } <nl> onUpload = ( file ) = > { <nl> - this . props . setHierarchyConfig ( [ ] ) ; <nl> - this . props . colorBy ( null ) ; <nl> this . props . uploadDataset ( { ' owner ' : this . props . uuid , ' file ' : file } ) ; <nl> this . props . stopRefresh ( ) ; <nl> this . setState ( { <nl> @ @ - 363 , 8 + 358 , 11 @ @ DatasetControls . defaultProps = { <nl> uuid : uuidv4 ( ) , <nl> datasets : [ ] , <nl> dataset : null , <nl> + hierarchyConfig : [ ] , <nl> + configHasChanged : false , <nl> isFetching : false , <nl> lastUpdated : new Date ( ) , <nl> + <nl> } ; <nl> DatasetControls . propTypes = { <nl> @ @ - 386 , 6 + 384 , 8 @ @ DatasetControls . propTypes = { <nl> isFetching : PropTypes . bool , <nl> lastUpdated : PropTypes . instanceOf ( Date ) , <nl> setError : PropTypes . func . isRequired , <nl> + hierarchyConfig : PropTypes . array , <nl> + configHasChanged : PropTypes . bool <nl> } ; <nl> const mapStateToProps = ( state , ownProps ) = > { <nl> 
mmm a / src / epics / index - dataset - epic . js <nl> ppp b / src / epics / index - dataset - epic . js <nl> return flattened ; <nl> for ( var key in ds ) { <nl> - var item = { ' id ' : key } ; <nl> + var item = { ' CRVIZ_SEARCH_REF ' : key } ; <nl> for ( var f in cfg . fields ) { <nl> var field = cfg . fields [ f ] ; <nl> @ @ - 88 , 13 + 88 , 14 @ @ const generateIndex = ( payload ) = > { <nl> ? payload . configuration : configurationFor ( dataset ) ; <nl> var flat = flattenDataset ( dataset , configuration ) ; <nl> const idx = lunr ( function ( ) { <nl> - this . ref ( ' id ' ) ; <nl> + this . ref ( ' CRVIZ_SEARCH_REF ' ) ; <nl> if ( configuration & & configuration . fields ) { <nl> const filteredFields = configuration . fields . filter ( f = > ! f . displayName . includes ( " / " ) ) <nl> filteredFields . map ( ( field ) = > { return this . field ( field . displayName . toLowerCase ( ) ) ; } ) <nl> } <nl> flat . map ( ( item ) = > { return this . add ( item ) ; } ) <nl> } ) ; <nl> + <nl> return { owner : owner , index : idx } ; <nl> } ; <nl> 
mmm a / src / App . js <nl> ppp b / src / App . js <nl> < div > <nl> < span className = { style . centerSpan } > <nl> { options . action = = = IMPORT & & <nl> - < div className = " button circular " title = " Ok " onClick = { this . processOptions } > <nl> + < div className = " button circular " title = " Ok " <nl> + disabled = { options . action = = = IMPORT & & ! this . state . selectedFile } <nl> + onClick = { this . processOptions } > <nl> < FontAwesomeIcon icon = { faCheck } / > <nl> < / div > <nl> } <nl> 
mmm a / src / features / visualization / d3 - viz / append - circles . js <nl> ppp b / src / features / visualization / d3 - viz / append - circles . js <nl> const maxTextWidth = 0 . 80 * getLabelWidth ( datum ) ; <nl> const maxTextHeight = 0 . 80 * datum . labelSize ; <nl> const minFontScale = 10 ; <nl> - const maxFontScale = 75 ; <nl> + const maxFontScale = 125 ; <nl> let boxWidth = node . getBBox ( ) . width ; <nl> let boxHeight = node . getBBox ( ) . height ; <nl> @ @ - 115 , 9 + 115 , 20 @ @ const scaleAndTrimToLabelWidth = ( node , datum , initialFontScale ) = > { <nl> / / scale to height <nl> if ( ( boxHeight > maxTextHeight ) ) { <nl> - const heightScale = Math . abs ( ( boxHeight - maxTextHeight ) / maxTextHeight ) ; <nl> - const widthScale = Math . abs ( ( boxWidth - maxTextWidth ) / maxTextWidth ) ; <nl> - fontScale = Math . max ( minFontScale , Math . min ( heightScale * initialFontScale , widthScale * initialFontScale , maxFontScale ) ) ; <nl> + const heightScale = 1 - Math . abs ( ( boxHeight - maxTextHeight ) / boxHeight ) ; <nl> + fontScale = Math . max ( minFontScale , heightScale * initialFontScale ) ; <nl> + if ( datum . data . fieldValue = = = " File server " ) { <nl> + console . log ( " boxHeight : % o " , boxHeight ) ; <nl> + console . log ( " maxTextHeight : % o " , maxTextHeight ) ; <nl> + console . log ( " initialFontScale : % o " , initialFontScale ) ; <nl> + console . log ( " fontScale : % o " , fontScale ) ; <nl> + } <nl> + select ( node ) <nl> + . style ( ' font - size ' , ( d , i , nodes ) = > fontScale + " % " ) <nl> + . text ( labelText ) ; <nl> + } else if ( boxHeight < 0 . 75 * maxTextHeight ) { <nl> + const heightScale = 1 + Math . abs ( ( boxHeight - maxTextHeight ) / maxTextHeight ) ; <nl> + fontScale = Math . min ( maxFontScale , heightScale * initialFontScale ) ; <nl> select ( node ) <nl> . style ( ' font - size ' , ( d , i , nodes ) = > fontScale + " % " ) <nl> . text ( labelText ) ; <nl> @ @ - 127 , 15 + 138 , 11 @ @ const scaleAndTrimToLabelWidth = ( node , datum , initialFontScale ) = > { <nl> / / trim to width <nl> if ( boxWidth > maxTextWidth ) <nl> { <nl> - const lengthToTrimTo = Math . trunc ( ( ( boxWidth - maxTextWidth ) / maxTextWidth ) * labelText . length ) - 3 ; <nl> - if ( lengthToTrimTo > 0 ) { <nl> - labelText = labelText . substr ( 0 , lengthToTrimTo ) + " . . . " ; <nl> - } <nl> - else { <nl> - labelText = " . . . " ; <nl> - } <nl> - <nl> + const lengthToTrimTo = Math . trunc ( 0 . 75 * labelText . length ) ; <nl> + labelText = labelText . substr ( 0 , lengthToTrimTo ) + " . . . " <nl> select ( node ) <nl> + . attr ( ' textLength ' , maxTextWidth ) <nl> + . attr ( ' lengthAdjust ' , " spacingAndGlyphs " ) <nl> . text ( labelText ) ; <nl> } <nl> } <nl> 
mmm a / src / features / visualization / Visualization . module . css <nl> ppp b / src / features / visualization / Visualization . module . css <nl> - webkit - animation - duration : 2s ; <nl> - webkit - animation - iteration - count : infinite ; <nl> - animation : delta 5s infinite ; <nl> + animation : delta 2s infinite ; <nl> } <nl> @ keyframes delta { <nl> - 0 % { <nl> + 50 % { <nl> - webkit - clip - path : polygon ( 50 % 0 % , 0 % 100 % , 100 % 100 % ) ; <nl> clip - path : polygon ( 50 % 0 % , 0 % 100 % , 100 % 100 % ) ; <nl> } , <nl> - 100 % { <nl> + 0 % , 100 % { <nl> } <nl> } <nl> - webkit - animation - name : plus ; <nl> - webkit - animation - duration : 2s ; <nl> - webkit - animation - iteration - count : infinite ; <nl> - animation : plus 5s infinite ; <nl> + animation : plus 2s infinite ; <nl> } <nl> @ keyframes plus { <nl> - 0 % { <nl> + 50 % { <nl> - webkit - clip - path : polygon ( 0 % 33 % , 33 % 33 % , 33 % 0 % , 66 % 0 % , 66 % 33 % , 100 % 33 % , 100 % 66 % , 66 % 66 % , 66 % 100 % , 33 % 100 % , 33 % 66 % , 0 % 66 % , 0 % 33 % ) ; <nl> clip - path : polygon ( 0 % 33 % , 33 % 33 % , 33 % 0 % , 66 % 0 % , 66 % 33 % , 100 % 33 % , 100 % 66 % , 66 % 66 % , 66 % 100 % , 33 % 100 % , 33 % 66 % , 0 % 66 % , 0 % 33 % ) ; <nl> } , <nl> - 100 % { <nl> + 0 % , 100 % { <nl> } <nl> } <nl> - webkit - animation - name : minus ; <nl> - webkit - animation - duration : 2s ; <nl> - webkit - animation - iteration - count : infinite ; <nl> - animation : minus 5s infinite ; <nl> + animation : minus 2s infinite ; <nl> } <nl> @ keyframes minus { <nl> - 0 % { <nl> + 50 % { <nl> - webkit - clip - path : polygon ( 0 % 33 % , 100 % 33 % , 100 % 66 % , 0 % 66 % ) ; <nl> clip - path : polygon ( 0 % 33 % , 100 % 33 % , 100 % 66 % , 0 % 66 % ) ; <nl> } , <nl> - 100 % { <nl> + 0 % , 100 % { <nl> } <nl> } <nl> 
mmm a / src / App . js <nl> ppp b / src / App . js <nl> processOptions = ( ) = > { <nl> if ( this . state . options . action = = = IMPORT ) <nl> { <nl> + if ( this . state . selectedFile ) { <nl> this . props . uploadDataset ( { <nl> ' owner ' : uuidv4 ( ) , <nl> ' file ' : this . state . selectedFile , <nl> ' includeData ' : this . state . options . data , <nl> ' includeControls ' : this . state . options . controls , <nl> } ) ; <nl> + } <nl> this . setState ( { showOptions : false } ) <nl> } <nl> } <nl> 
mmm a / src / features / visualization / d3 - viz / setup - annotations . js <nl> ppp b / src / features / visualization / d3 - viz / setup - annotations . js <nl> . select ( ` g . $ { className ( " isAdded - fixed " ) } ` ) <nl> const showHide = glyph . classed ( className ( " ringMenuExcluded " ) ) ; <nl> + const childGlyphs = selectAll ( ` g . $ { className ( " isAdded - fixed " ) } ` ) <nl> + . filter ( ( e ) = > { <nl> + const ancestors = e . ancestors ( ) ; <nl> + return ancestors . findIndex ( a = > datumKey ( a ) = = = dk ) ! = = - 1 ; <nl> + } ) ; <nl> + <nl> const added = selectAll ( ` g . $ { className ( " isAdded " ) } ` ) <nl> . filter ( ( e ) = > { <nl> const ancestors = e . ancestors ( ) ; <nl> @ @ - 192 , 6 + 198 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> if ( ! added . empty ( ) ) { <nl> glyph . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> + childGlyphs . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> added . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> } <nl> } <nl> @ @ - 231 , 6 + 238 , 12 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . select ( ` g . $ { className ( " isChanged - fixed " ) } ` ) <nl> const showHide = glyph . classed ( className ( " ringMenuExcluded " ) ) ; <nl> + const childGlyphs = selectAll ( ` g . $ { className ( " isChanged - fixed " ) } ` ) <nl> + . filter ( ( e ) = > { <nl> + const ancestors = e . ancestors ( ) ; <nl> + return ancestors . findIndex ( a = > datumKey ( a ) = = = dk ) ! = = - 1 ; <nl> + } ) ; <nl> + <nl> const changed = selectAll ( ` g . $ { className ( " isChanged " ) } ` ) <nl> . filter ( ( e ) = > { <nl> const ancestors = e . ancestors ( ) ; <nl> @ @ - 239 , 6 + 252 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> if ( ! changed . empty ( ) ) { <nl> glyph . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> + childGlyphs . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> changed . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> } <nl> } <nl> @ @ - 278 , 6 + 292 , 12 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . select ( ` g . $ { className ( " isRemoved - fixed " ) } ` ) <nl> const showHide = glyph . classed ( className ( " ringMenuExcluded " ) ) ; <nl> + const childGlyphs = selectAll ( ` g . $ { className ( " isRemoved - fixed " ) } ` ) <nl> + . filter ( ( e ) = > { <nl> + const ancestors = e . ancestors ( ) ; <nl> + return ancestors . findIndex ( a = > datumKey ( a ) = = = dk ) ! = = - 1 ; <nl> + } ) ; <nl> + <nl> const removed = selectAll ( ` g . $ { className ( " isRemoved " ) } ` ) <nl> . filter ( ( e ) = > { <nl> const ancestors = e . ancestors ( ) ; <nl> @ @ - 286 , 6 + 306 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> if ( ! removed . empty ( ) ) { <nl> glyph . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> + childGlyphs . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> removed . classed ( className ( " ringMenuExcluded " ) , ! showHide ) ; <nl> } <nl> } <nl> 
mmm a / src / features / visualization / Visualization . module . css <nl> ppp b / src / features / visualization / Visualization . module . css <nl> - webkit - animation - iteration - count : infinite ; <nl> animation : delta 2s infinite ; <nl> + animation - delay : 250ms ; <nl> } <nl> @ keyframes delta { <nl> - webkit - animation - duration : 2s ; <nl> - webkit - animation - iteration - count : infinite ; <nl> animation : plus 2s infinite ; <nl> + animation - delay : 250ms ; <nl> } <nl> @ keyframes plus { <nl> - webkit - animation - duration : 2s ; <nl> - webkit - animation - iteration - count : infinite ; <nl> animation : minus 2s infinite ; <nl> + animation - delay : 250ms ; <nl> } <nl> @ keyframes minus { <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " lint " : " eslint - - ext = js - - ext = jsx . " , <nl> " release " : " standard - version " , <nl> - " snyk - protect " : " snyk protect " , <nl> + " snyk - protect " : " snyk protect " <nl> } , <nl> " pre - commit " : { <nl> " run " : [ <nl> 
mmm a / src / features / dataset - controls / DatasetSlider . js <nl> ppp b / src / features / dataset - controls / DatasetSlider . js <nl> if ( start ) { <nl> this . props . setStartUuid ( start . owner ) ; <nl> } <nl> - if ( end & & end ! = = start ) { <nl> + if ( end ) { <nl> this . props . setEndUuid ( end . owner ) ; <nl> } <nl> - if ( end & & end = = = start ) { <nl> - this . props . setEndUuid ( ' UNSET ' ) ; <nl> - } <nl> } <nl> formatTicks = ( t ) = > { <nl> 
mmm a / src / features / visualization / d3 - viz . js <nl> ppp b / src / features / visualization / d3 - viz . js <nl> const svg = transformRoot . append ( " svg " ) <nl> . style ( " overflow " , " visible " ) <nl> . attr ( " class " , " nodeRoot " ) <nl> - . attr ( ' viewBox ' , " 0 0 100 % 100 % " ) ; <nl> const tooltip = root . append ( " div " ) . classed ( " viz - tooltip " , true ) ; <nl> const legend = root . append ( " div " ) . classed ( " viz - legend " , true ) ; <nl> 
mmm a / src / App . js <nl> ppp b / src / App . js <nl> < div className = { style . accordionHeader } onClick = { this . toggleShowComparison } > <nl> Comparison { ! showComparison & & < FontAwesomeIcon icon = { faAngleDoubleDown } / > } { showComparison & & < FontAwesomeIcon onClick = { this . toggleShowComparison } icon = { faAngleDoubleUp } / > } <nl> < / div > <nl> - { hasDataset & & <nl> + { datasetCount > = 2 & & <nl> < div className = { classNames ( { [ style . section ] : true , [ style . hierarchySection ] : true , [ style . hidden ] : ! showComparison } ) } > <nl> < ComparisonSelector startUid = { startUuid } endUid = { endUuid } / > <nl> < / div > <nl> } <nl> - { ! hasDataset & & <nl> + { datasetCount < 2 & & <nl> < div className = { classNames ( { [ style . section ] : true , [ style . dimSection ] : true , [ style . hierarchySection ] : true , [ style . hidden ] : ! showComparison } ) } > <nl> - Please select datasets to continue <nl> + Please select at least 2 datasets to continue <nl> < / div > <nl> } <nl> 
mmm a / src / features / visualization / Visualization . module . css <nl> ppp b / src / features / visualization / Visualization . module . css <nl> } <nl> + : global ( . darkTheme ) . viz : global ( . viz - ring - menu ) { <nl> + fill : white ! important ; <nl> + } <nl> + <nl> + <nl> . viz : global ( circle . viz - bg - circle ) { <nl> stroke : transparent ; <nl> fill : white ! important ; <nl> 
mmm a / src / domain / controls . test . js <nl> ppp b / src / domain / controls . test . js <nl> ' start ' : ' t0 ' , <nl> ' end ' : ' tn ' , <nl> ' showBusy ' : true , <nl> - ' position ' : [ 0 , 0 ] <nl> + ' position ' : [ 0 , 0 ] , <nl> + ' datum ' : null <nl> } <nl> const action = setControls ( controls ) ; <nl> @ @ - 71 , 7 + 72 , 8 @ @ describe ( " Controls reducer " , ( ) = > { <nl> ' start ' : null , <nl> ' end ' : null , <nl> ' showBusy ' : false , <nl> - ' position ' : [ 0 , 0 ] <nl> + ' position ' : [ 0 , 0 ] , <nl> + ' datum ' : null / / <nl> } ) ; <nl> done ( ) ; <nl> 
mmm a / src / features / tooltip / Tooltip . js <nl> ppp b / src / features / tooltip / Tooltip . js <nl> < div style = { style } > <nl> { this . props . data & & ! this . props . data . fieldValue & & <nl> < div > <nl> - < h4 > < b > UID : < / b > { this . props . data . uid } < / h4 > <nl> - < h4 > < b > MAC : < / b > { this . props . data . mac } < / h4 > <nl> - < h4 > < b > rDNS_host : < / b > { this . props . data . rDNS_host } < / h4 > <nl> - < h4 > < b > Subnet : < / b > { this . props . data . subnet } < / h4 > <nl> - < h4 > < b > IP : < / b > { this . props . data . IP } < / h4 > <nl> - < h4 > < b > Record Source : < / b > { this . props . data . record . source } < / h4 > <nl> - < h4 > < b > Record Timestamp : < / b > { this . props . data . record . timestamp } < / h4 > <nl> - < h4 > < b > Role : < / b > { this . props . data . role . role } < / h4 > <nl> - < h4 > < b > rDNS_domain : < / b > { this . props . data . rDNS_domain } < / h4 > <nl> - < h4 > < b > OS : < / b > { this . props . data . os . os } < / h4 > <nl> - < h4 > < b > OS Confidence : < / b > { this . props . data . os . confidence } < / h4 > <nl> - < h4 > < b > Vendor : < / b > { this . props . data . vendor } < / h4 > <nl> + < p > < b > UID : < / b > { this . props . data . uid } < / p > <nl> + < p > < b > MAC : < / b > { this . props . data . mac } < / p > <nl> + < p > < b > rDNS_host : < / b > { this . props . data . rDNS_host } < / p > <nl> + < p > < b > Subnet : < / b > { this . props . data . subnet } < / p > <nl> + < p > < b > IP : < / b > { this . props . data . IP } < / p > <nl> + < p > < b > Record Source : < / b > { this . props . data . record . source } < / p > <nl> + < p > < b > Record Timestamp : < / b > { this . props . data . record . timestamp } < / p > <nl> + < p > < b > Role : < / b > { this . props . data . role . role } < / p > <nl> + < p > < b > rDNS_domain : < / b > { this . props . data . rDNS_domain } < / p > <nl> + < p > < b > OS : < / b > { this . props . data . os . os } < / p > <nl> + < p > < b > OS Confidence : < / b > { this . props . data . os . confidence } < / p > <nl> + < p > < b > Vendor : < / b > { this . props . data . vendor } < / p > <nl> < / div > <nl> } <nl> { this . props . data & & this . props . data . fieldValue & & <nl> 
mmm a / src / features / tooltip / Tooltip . js <nl> ppp b / src / features / tooltip / Tooltip . js <nl> constructor ( props ) { <nl> super ( props ) <nl> this . state = this . initialState ; <nl> + / * this . state = { <nl> + . . . this . state , <nl> + showNote : false <nl> + } * / <nl> } <nl> get initialState ( ) { <nl> @ @ - 23 , 7 + 27 , 6 @ @ class TooltipControls extends React . Component { <nl> width : " 300px " , <nl> position : [ 200 , 200 ] , <nl> currentLabel : " " , <nl> - showNote : false , <nl> note : { <nl> id : ' ' , <nl> note : { <nl> @ @ - 68 , 7 + 71 , 7 @ @ class TooltipControls extends React . Component { <nl> await this . setState ( { note } ) ; <nl> await this . props . addNote ( this . state . note ) ; <nl> - this . resetBuilder ( ) <nl> + / / this . resetBuilder ( ) <nl> } catch ( error ) { <nl> alert ( ' No search key ' ) <nl> } <nl> @ @ - 96 , 9 + 99 , 6 @ @ class TooltipControls extends React . Component { <nl> componentDidUpdate = ( prevProps ) = > { <nl> if ( prevProps . data ! = = this . props . data ) { <nl> - if ( this . props . data . fieldValue ) { <nl> - } <nl> - else { <nl> var note = { . . . this . state . note } <nl> note . id = this . props . data . CRVIZ . _SEARCH_KEY <nl> if ( note . id in this . props . notes ) { <nl> @ @ - 111 , 7 + 111 , 6 @ @ class TooltipControls extends React . Component { <nl> } <nl> } <nl> } <nl> - } <nl> render ( ) { <nl> const style = { <nl> 
mmm a / src / domain / notes . js <nl> ppp b / src / domain / notes . js <nl> byId : [ ] , <nl> byHash : { <nl> } , <nl> - hoverStatus : false <nl> + hoverStatus : false , <nl> + hoveredNoteId : ' ' <nl> } ; <nl> / / ACTIONS <nl> @ @ - 12 , 6 + 13 , 7 @ @ const addNote = createAction ( " ADD_NOTE " ) ; <nl> const setNotes = createAction ( " SET_NOTE " ) ; <nl> const removeNote = createAction ( " REMOVE_NOTE " ) ; <nl> const toggleNotesHover = createAction ( " TOGGLE_NOTES_HOVER " ) ; <nl> + const setNoteHovered = createAction ( " SET_HOVERED_NOTED " ) ; <nl> / / REDUCERS <nl> const reducer = handleActions ( <nl> @ @ - 53 , 6 + 55 , 14 @ @ const reducer = handleActions ( <nl> hoverStatus : hoverStatus , <nl> } <nl> } , <nl> + [ setNoteHovered ] : ( state , { payload } ) = > { <nl> + const hoveredNoteId = payload ; <nl> + / / alert ( ` $ { hoveredNoteId } ` ) ; <nl> + return { <nl> + . . . state , <nl> + hoveredNoteId : hoveredNoteId , <nl> + } <nl> + } , <nl> } , <nl> defaultState <nl> ) ; <nl> @ @ - 61 , 8 + 71 , 9 @ @ const reducer = handleActions ( <nl> const getNotesIndexedByHash = ( state ) = > state . notes . byHash ; <nl> const getAllNotes = ( state ) = > state . notes ; <nl> const getNotesHoverStatus = ( state ) = > state . notes . hoverStatus ; <nl> + const getNoteHoveredId = ( state ) = > state . notes . hoveredNoteId ; <nl> export default reducer ; <nl> - export { addNote , setNotes , removeNote , getNotesIndexedByHash , getAllNotes , toggleNotesHover , getNotesHoverStatus } ; <nl> \ No newline at end of file <nl> + export { addNote , setNotes , removeNote , getNotesIndexedByHash , getAllNotes , toggleNotesHover , getNotesHoverStatus , setNoteHovered , getNoteHoveredId } ; <nl> \ No newline at end of file <nl> 
mmm a / src / features / tooltip / Tooltip . js <nl> ppp b / src / features / tooltip / Tooltip . js <nl> < b > < h1 > < input className = { tooltipStyle . inputStyle } type = " text " value = { this . state . note . note . title } onChange = { this . handleChangeTitle } placeholder = " Title " / > < / h1 > < / b > <nl> < p > < textarea className = { tooltipStyle . inputStyle } type = " text " value = { this . state . note . note . content } onChange = { this . handleChangeContent } placeholder = " Take a note . . . " / > < / p > <nl> < div style = { { textAlign : " center " } } > <nl> - < label className = " button circular " > <nl> - < FontAwesomeIcon style = { { margin : " 2 . 5px " } } icon = { faSave } onClick = { this . saveNote } / > <nl> + < label className = " button circular " onClick = { this . saveNote } > <nl> + < FontAwesomeIcon style = { { margin : " 2 . 5px " } } icon = { faSave } / > <nl> < / label > <nl> - < label className = " button circular " > <nl> - < FontAwesomeIcon style = { { margin : " 2 . 5px " } } icon = { faTrashAlt } onClick = { this . removeNote } / > <nl> + < label className = " button circular " onClick = { this . removeNote } > <nl> + < FontAwesomeIcon style = { { margin : " 2 . 5px " } } icon = { faTrashAlt } / > <nl> < / label > <nl> < / div > <nl> < / div > <nl> 
mmm a / index . js <nl> ppp b / index . js <nl> self . _senderMap . set ( track , submap ) <nl> self . _needsNegotiation ( ) <nl> } else if ( sender . removed ) { <nl> - self . destroy ( makeError ( ' Track has been removed . You should enable / disable tracks that you want to re - add . ' ) , ' ERR_SENDER_REMOVED ' ) <nl> + self . destroy ( makeError ( ' Track has been removed . You should enable / disable tracks that you want to re - add . ' , ' ERR_SENDER_REMOVED ' ) ) <nl> } else { <nl> - self . destroy ( makeError ( ' Track has already been added to that stream . ' ) , ' ERR_SENDER_ALREADY_ADDED ' ) <nl> + self . destroy ( makeError ( ' Track has already been added to that stream . ' , ' ERR_SENDER_ALREADY_ADDED ' ) ) <nl> } <nl> } <nl> @ @ - 315 , 7 + 315 , 7 @ @ Peer . prototype . replaceTrack = function ( oldTrack , newTrack , stream ) { <nl> var submap = self . _senderMap . get ( oldTrack ) <nl> var sender = submap ? submap . get ( stream ) : null <nl> if ( ! sender ) { <nl> - self . destroy ( makeError ( ' Cannot replace track that was never added . ' ) , ' ERR_TRACK_NOT_ADDED ' ) <nl> + self . destroy ( makeError ( ' Cannot replace track that was never added . ' , ' ERR_TRACK_NOT_ADDED ' ) ) <nl> } <nl> if ( newTrack ) self . _senderMap . set ( newTrack , submap ) <nl> 
mmm a / src / components / Badge / badge . test . js <nl> ppp b / src / components / Badge / badge . test . js <nl> - import Badge from ' . / index . vue ' <nl> + import Badge from ' . / ' <nl> + import ThemeProvider from ' . . / ThemeProvider ' <nl> + import theme from ' . . / . . / lib / theme ' <nl> describe ( ' = = = = = Badge Component = = = = = ' , ( ) = > { <nl> - let badge <nl> describe ( ' Instance TEsts ' , ( ) = > { <nl> it ( ' should be a Vue instance ' , ( ) = > { <nl> - badge = shallowMount ( Badge ) <nl> - expect ( badge . isVueInstance ( ) ) . toBeTruthy ( ) <nl> + const wrapper = shallowMount ( ThemeProvider , { <nl> + propsData : { <nl> + theme , <nl> + colorMode : ' light ' <nl> + } , <nl> + slots : { <nl> + default : [ Badge ] <nl> + } <nl> + } ) <nl> + expect ( wrapper . isVueInstance ( ) ) . toBeTruthy ( ) <nl> + expect ( wrapper . find ( Badge ) . vm . $ theme ( ) ) . toBe ( theme ) <nl> + expect ( wrapper . find ( Badge ) . vm . $ colorMode ) . toBe ( ' light ' ) <nl> } ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / kiwi - core / rollup . dev . config . js <nl> ppp b / packages / kiwi - core / rollup . dev . config . js <nl> ] <nl> } <nl> - / / const bannerTxt = ` / * ! Chakra - Vui v $ { pkg . version } | MIT License | github . com / codebender828 / kiwi - ui * / ` <nl> - <nl> const baseFolder = ' . / src / ' <nl> - / / const capitalize = ( s ) = > { <nl> - / / if ( typeof s ! = = ' string ' ) return ' ' <nl> - / / return s . charAt ( 0 ) . toUpperCase ( ) + s . slice ( 1 ) <nl> - / / } <nl> - <nl> const components = fs . readdirSync ( baseFolder ) <nl> . filter ( ( f ) = > fs . statSync ( path . join ( baseFolder , f ) ) . isDirectory ( ) ) <nl> @ @ - 86 , 30 + 79 , 10 @ @ const entries = { <nl> } , { } ) <nl> } <nl> - console . log ( ' entries ' , entries ) <nl> - <nl> / * * <nl> * Configurations <nl> * / <nl> export default ( ) = > { <nl> - / / const mapComponent = ( name ) = > { <nl> - / / return [ { <nl> - / / input : baseFolder + ` $ { name } / index . js ` , <nl> - / / external : externals , <nl> - / / output : { <nl> - / / format : ' umd ' , <nl> - / / name : capitalize ( name ) , <nl> - / / file : ` dist / components / $ { name } / index . js ` , <nl> - / / banner : bannerTxt , <nl> - / / exports : ' named ' , <nl> - / / globals : { <nl> - / / vue : ' Vue ' <nl> - / / } <nl> - / / } , <nl> - / / . . . commons <nl> - / / } ] <nl> - / / } <nl> - <nl> let config = [ { <nl> input : entries , <nl> output : { <nl> @ @ - 118 , 61 + 91 , 6 @ @ export default ( ) = > { <nl> } , <nl> . . . commons <nl> } <nl> - / / { <nl> - / / input : entries , <nl> - / / output : { <nl> - / / dir : ` dist / es / ` , <nl> - / / format : ' es ' <nl> - / / } , <nl> - / / . . . commons <nl> - / / } , <nl> - / / { <nl> - / / input : entries , <nl> - / / output : { <nl> - / / dir : ` dist / cjs / ` , <nl> - / / format : ' cjs ' , <nl> - / / exports : ' named ' <nl> - / / } , <nl> - / / . . . commons <nl> - / / } , <nl> - / / { <nl> - / / input : ' . / src / index . js ' , <nl> - / / output : { <nl> - / / file : ` dist / umd / index . js / ` , <nl> - / / name : capitalize ( ' chakra ' ) , <nl> - / / format : ' umd ' , <nl> - / / exports : ' named ' , <nl> - / / banner : bannerTxt , <nl> - / / globals : { <nl> - / / vue : ' Vue ' <nl> - / / } <nl> - / / } , <nl> - / / . . . commons <nl> - / / } <nl> - / / { <nl> - / / input : ' . / src / index . js ' , <nl> - / / output : { <nl> - / / file : ' dist / chakra - vui . esm . js ' , <nl> - / / name : capitalize ( ' chakra ' ) , <nl> - / / format : ' esm ' , <nl> - / / exports : ' named ' , <nl> - / / banner : bannerTxt <nl> - / / } , <nl> - / / . . . commons <nl> - / / } <nl> - / / Individual components <nl> - / / . . . components . map ( ( f ) = > mapComponent ( f ) ) . reduce ( ( r , a ) = > r . concat ( a ) , [ ] ) <nl> ] <nl> - if ( process . env . MINIFY = = = ' true ' ) { <nl> - config = config . filter ( ( c ) = > ! ! c . output . file ) <nl> - config . forEach ( ( c ) = > { <nl> - c . output . file = c . output . file . replace ( / \ . js / g , ' . min . js ' ) <nl> - c . plugins . push ( terser ( { <nl> - output : { <nl> - comments : ' / ^ ! / ' <nl> - } <nl> - } ) ) <nl> - } ) <nl> - } <nl> return config <nl> } <nl> 
mmm a / packages / kiwi - core / src / Accordion / index . js <nl> ppp b / packages / kiwi - core / src / Accordion / index . js <nl> } <nl> } , <nl> render ( h ) { <nl> - const cloned = cloneVNodes ( this . $ slots . default , h ) <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> + const cloned = cloneVNodes ( children , h ) <nl> const clones = cloned . map ( ( vnode , index ) = > { <nl> const clone = h ( vnode . componentOptions . Ctor , { <nl> . . . vnode . data , <nl> 
mmm a / packages / kiwi - core / src / Popover / index . js <nl> ppp b / packages / kiwi - core / src / Popover / index . js <nl> } , <nl> render ( h ) { <nl> let clone <nl> - const children = this . $ slots . default <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> if ( ! children ) return console . error ( ' [ Chakra - ui ] : Popover Trigger expects at least one child ' ) <nl> if ( children . length & & children . length > 1 ) return console . error ( ' [ Chakra - ui ] : Popover Trigger can only have a single child element ' ) <nl> const cloned = cloneVNode ( children [ 0 ] , h ) <nl> 
mmm a / packages / kiwi - core / src / ButtonGroup / index . js <nl> ppp b / packages / kiwi - core / src / ButtonGroup / index . js <nl> . . . baseProps <nl> } , <nl> render ( h ) { <nl> - const children = this . $ slots . default <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> const count = children . length <nl> const clones = children . map ( ( node , index ) = > { <nl> 
mmm a / packages / kiwi - core / src / Menu / MenuOption . js <nl> ppp b / packages / kiwi - core / src / Menu / MenuOption . js <nl> } <nl> } <nl> - const children = this . $ slots . default <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> const clonedChildNodes = children . map ( vnode = > { <nl> let result <nl> 
mmm a / packages / kiwi - core / src / Stack / index . js <nl> ppp b / packages / kiwi - core / src / Stack / index . js <nl> _direction = ' column ' <nl> } <nl> - const children = this . $ slots . default <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> const stackables = children . map ( ( node , index ) = > { <nl> let isLastChild = children . length = = = index + 1 <nl> let spacingProps = _isInline <nl> 
mmm a / packages / kiwi - core / src / Breadcrumb / index . js <nl> ppp b / packages / kiwi - core / src / Breadcrumb / index . js <nl> } , <nl> setup ( props , context ) { <nl> return ( ) = > { <nl> - const children = context . slots . default ( ) <nl> + const children = context . slots . default ( ) . filter ( e = > e . tag ) <nl> const clones = cloneVNodes ( children , h ) . map ( ( clone ) = > { <nl> if ( clone . componentOptions . tag = = = BreadcrumbLink . name ) { <nl> const { propsData } = clone . componentOptions <nl> @ @ - 142 , 7 + 142 , 7 @ @ const Breadcrumb = { <nl> } , <nl> setup ( props , context ) { <nl> return ( ) = > { <nl> - const children = context . slots . default ( ) <nl> + const children = context . slots . default ( ) . filter ( e = > e . tag ) <nl> const clones = cloneVNodes ( children , h ) <nl> . map ( ( node , index , array ) = > { <nl> const { propsData } = node . componentOptions <nl> 
mmm a / packages / kiwi - core / src / AvatarGroup / index . js <nl> ppp b / packages / kiwi - core / src / AvatarGroup / index . js <nl> } , <nl> render ( h ) { <nl> / / Get the number of slot nodes inside AvatarGroup <nl> - const children = this . $ slots . default <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> const count = children . length <nl> const max = parseInt ( this . max , 10 ) <nl> 
mmm a / packages / kiwi - core / src / InputGroup / index . js <nl> ppp b / packages / kiwi - core / src / InputGroup / index . js <nl> let pl = null <nl> let pr = null <nl> const height = inputSizes [ this . size ] & & inputSizes [ this . size ] [ ' height ' ] <nl> - const children = this . $ slots . default <nl> + const children = this . $ slots . default . filter ( e = > e . tag ) <nl> const clones = children <nl> . map ( ( vnode ) = > { <nl> if ( vnode . tag . includes ( InputLeftElement . name ) ) { <nl> 
mmm a / . eslintrc . js <nl> ppp b / . eslintrc . js <nl> overrides : [ <nl> { <nl> files : [ <nl> - ' * * / __tests__ / * . { j , t } s ? ( x ) ' <nl> + ' * * / __tests__ / * . { j , t } s ? ( x ) ' , <nl> + ' * * / tests / * . { j , t } s ? ( x ) ' <nl> ] , <nl> env : { <nl> jest : true <nl> 
mmm a / stories / 46 - Switch . stories . js <nl> ppp b / stories / 46 - Switch . stories . js <nl> import { storiesOf } from ' @ storybook / vue ' <nl> import { Box , Switch } from ' . . / packages / kiwi - core / src ' <nl> @ @ - 8 , 21 + 9 , 22 @ @ storiesOf ( ' UI | Switch ' , module ) <nl> < Box mb = " 3 " > <nl> < Toggle <nl> size = " sm " <nl> - @ change = " handleChange " <nl> + @ change = " action " <nl> color = " green " <nl> mr = " 3 " <nl> / > <nl> < Toggle <nl> size = " md " <nl> - @ change = " handleChange " <nl> + @ change = " action " <nl> color = " blue " <nl> mr = " 3 " <nl> / > <nl> < Toggle <nl> size = " lg " <nl> - @ change = " handleChange " <nl> + @ change = " action " <nl> color = " cyan " <nl> / > <nl> < / Box > <nl> - ` <nl> + ` , <nl> + methods : { action : action ( ' @ change ( event ) ' ) } <nl> } ) ) <nl> 
mmm a / stories / 10 - Toast . stories . js <nl> ppp b / stories / 10 - Toast . stories . js <nl> import { Button } from ' . . / packages / kiwi - core / src ' <nl> + import { colorModeObserver } from ' . . / packages / kiwi - core / src / utils / color - mode - observer ' <nl> + <nl> + const watch = { <nl> + $ theme : { <nl> + immediate : true , <nl> + handler ( theme ) { <nl> + colorModeObserver . theme = theme ( ) <nl> + } <nl> + } , <nl> + $ icons : { <nl> + immediate : true , <nl> + handler ( icons ) { <nl> + colorModeObserver . icons = icons <nl> + } <nl> + } <nl> + } <nl> storiesOf ( ' UI | Toast ' , module ) <nl> . add ( ' Simple Toast ' , ( ) = > ( { <nl> components : { Button } , <nl> + watch , <nl> inject : [ ' $ theme ' , ' $ icons ' ] , <nl> methods : { <nl> showToast ( ) { <nl> @ @ - 24 , 6 + 41 , 7 @ @ storiesOf ( ' UI | Toast ' , module ) <nl> } ) ) <nl> . add ( ' With status ' , ( ) = > ( { <nl> components : { Button } , <nl> + watch , <nl> inject : [ ' $ theme ' , ' $ icons ' ] , <nl> methods : { <nl> infoToast ( ) { <nl> @ @ - 78 , 6 + 96 , 7 @ @ storiesOf ( ' UI | Toast ' , module ) <nl> } ) ) <nl> . add ( ' With variant ' , ( ) = > ( { <nl> components : { Button } , <nl> + watch , <nl> inject : [ ' $ theme ' , ' $ icons ' ] , <nl> methods : { <nl> successToast ( variant = ' solid ' ) { <nl> 
mmm a / . storybook / config . js <nl> ppp b / . storybook / config . js <nl> function loadStories ( ) { <nl> - const req = require . context ( ' . . / packages / kiwi - core / src ' , true , / \ . stories \ . ( js | mdx ) $ / ) ; <nl> + const req = require . context ( ' . . / packages / chakra - ui - core / src ' , true , / \ . stories \ . ( js | mdx ) $ / ) ; <nl> req . keys ( ) . forEach ( filename = > req ( filename ) ) ; <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / Progress / Progress . stories . js <nl> ppp b / packages / chakra - ui - core / src / Progress / Progress . stories . js <nl> - import { CSSReset , Progress as KProgress , Stack } from ' . . ' <nl> + import { CSSReset , Progress as KProgress , Stack , Box } from ' . . ' <nl> storiesOf ( ' UI | Progress ' , module ) <nl> - . add ( ' Default Progress ' , ( ) = > ( { <nl> - components : { CSSReset , KProgress } , <nl> + . addDecorator ( story = > ( { <nl> + components : { CSSReset , Box , story : story ( ) } , <nl> template : ` <nl> - < div > <nl> - < CSSReset / > <nl> - < KProgress : value = " 80 " / > <nl> - < / div > <nl> - ` <nl> + < Box w = " full " maxWidth = " 400px " mx = " auto " mt = " 8 " p = " 3 " > <nl> + < CSSReset > < / CSSReset > <nl> + < story > < / story > <nl> + < / Box > ` <nl> + } ) ) <nl> + <nl> + . add ( ' Default Progress ' , ( ) = > ( { <nl> + components : { KProgress } , <nl> + template : ` < KProgress : value = " 80 " / > ` <nl> } ) ) <nl> . add ( ' With stripe ' , ( ) = > ( { <nl> - components : { CSSReset , KProgress } , <nl> - template : ` <nl> - < div > <nl> - < CSSReset / > <nl> - < KProgress hasStripe : value = " 64 " / > <nl> - < / div > <nl> - ` <nl> + components : { KProgress } , <nl> + template : ` < KProgress hasStripe : value = " 64 " / > ` <nl> } ) ) <nl> . add ( ' With sizes ' , ( ) = > ( { <nl> - components : { CSSReset , KProgress , Stack } , <nl> + components : { KProgress , Stack } , <nl> template : ` <nl> - < div > <nl> - < CSSReset / > <nl> < Stack : spacing = " 5 " > <nl> < KProgress rounded = " sm " color = " green " size = " sm " / > <nl> < KProgress color = " green " size = " md " / > <nl> < KProgress color = " green " size = " lg " / > <nl> < KProgress color = " green " height = " 32px " / > <nl> - < / Stack > <nl> - < / div > <nl> - ` <nl> + < / Stack > ` <nl> } ) ) <nl> . add ( ' With color ' , ( ) = > ( { <nl> - components : { CSSReset , KProgress } , <nl> - template : ` <nl> - < div > <nl> - < CSSReset / > <nl> - < KProgress color = " pink " hasStripe / > <nl> - < / div > <nl> - ` <nl> + components : { KProgress } , <nl> + template : ` < KProgress color = " pink " hasStripe / > ` <nl> } ) ) <nl> 
mmm a / packages / chakra - ui - core / src / RadioButtonGroup / index . js <nl> ppp b / packages / chakra - ui - core / src / RadioButtonGroup / index . js <nl> import { baseProps } from ' . . / config ' <nl> import { StringNumber , SNA } from ' . . / config / props / props . types ' <nl> - import { isDef , useId , cloneVNodeElement , forwardProps } from ' . . / utils ' <nl> + import { isDef , useId , cloneVNodeElement , forwardProps , cleanChildren } from ' . . / utils ' <nl> const RadioButtonGroup = { <nl> name : ' RadioButtonGroup ' , <nl> @ @ - 43 , 7 + 43 , 7 @ @ const RadioButtonGroup = { <nl> } <nl> } , <nl> mounted ( ) { <nl> - const children = this . $ slots . default <nl> + const children = cleanChildren ( this . $ slots . default ) <nl> this . focusableValues = children . map ( child = > child . componentOptions . propsData . isDisabled = = = true <nl> ? null <nl> : child . componentOptions . propsData . value ) <nl> 
mmm a / packages / chakra - ui - core / src / Radio / index . js <nl> ppp b / packages / chakra - ui - core / src / Radio / index . js <nl> name : this . name , <nl> value : this . value , <nl> ' aria - invalid ' : this . isInvalid , <nl> - defaultChecked : this . defaultIsChecked , <nl> disabled : this . isDisabled , <nl> ' aria - disabled ' : this . isDisabled <nl> } , <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < / template > <nl> < script > <nl> - import { ThemeProvider , CSSReset } from ' @ chakra - ui / core ' <nl> + import { ThemeProvider , CSSReset } from ' @ chakra - ui / vue ' <nl> export default { <nl> name : ' App ' , <nl> @ @ - 130 , 7 + 130 , 7 @ @ If you ' d like to toggle your app between dark and light mode , you can also wrap <nl> < / template > <nl> < script > <nl> - import { ThemeProvider , CSSReset , Button } from ' @ chakra - ui / core ' <nl> + import { ThemeProvider , CSSReset , Button } from ' @ chakra - ui / vue ' <nl> export default { <nl> name : ' App ' , <nl> 
mmm a / packages / chakra - ui - core / src / Modal / index . js <nl> ppp b / packages / chakra - ui - core / src / Modal / index . js <nl> } <nl> } ) <nl> + this . $ watch ( ' isOpen ' , ( ) = > { <nl> + if ( ! this . isOpen ) { <nl> + document . removeEventListener ( ' keydown ' , handler ) <nl> + } <nl> + } ) <nl> + <nl> let undoAriaHidden = null <nl> this . $ watch ( vm = > [ vm . isOpen , vm . useInert ] , ( ) = > { <nl> let mountNode = this . mountNode <nl> 
mmm a / packages / chakra - ui - core / src / Editable / index . js <nl> ppp b / packages / chakra - ui - core / src / Editable / index . js <nl> onKeyDown , <nl> value , <nl> onSubmit , <nl> - onCancel , <nl> submitOnBlur , <nl> placeholder , <nl> isDisabled <nl> @ @ - 274 , 7 + 273 , 7 @ @ const EditableInput = { <nl> } , <nl> nativeOn : { <nl> blur : event = > { <nl> - submitOnBlur ? onSubmit ( ) : onCancel ( ) <nl> + submitOnBlur & & onSubmit ( ) <nl> this . $ emit ( ' blur ' , event ) <nl> } , <nl> change : onChange , <nl> 
mmm a / packages / chakra - ui - core / src / Editable / index . js <nl> ppp b / packages / chakra - ui - core / src / Editable / index . js <nl> submitOnBlur & & onSubmit ( ) <nl> this . $ emit ( ' blur ' , event ) <nl> } , <nl> - change : onChange , <nl> + input : onChange , <nl> keydown : onKeyDown <nl> } , <nl> attrs : { <nl> 
mmm a / packages / chakra - ui - core / src / Editable / index . js <nl> ppp b / packages / chakra - ui - core / src / Editable / index . js <nl> attrs : { <nl> id : editableId , <nl> disabled : isDisabled , <nl> - ' aria - diabled ' : isDisabled , <nl> + ' aria - disabled ' : isDisabled , <nl> value , <nl> placeholder <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / Switch / Switch . js <nl> ppp b / packages / chakra - ui - core / src / Switch / Switch . js <nl> + import styleProps from ' . . / config / props ' <nl> + import { forwardProps } from ' . . / utils ' <nl> + import VisuallyHidden from ' . . / VisuallyHidden ' <nl> + import ControlBox from ' . . / ControlBox ' <nl> + <nl> + const switchSizes = { <nl> + sm : { <nl> + width : ' 1 . 375rem ' , <nl> + height : ' 0 . 75rem ' <nl> + } , <nl> + md : { <nl> + width : ' 1 . 875rem ' , <nl> + height : ' 1rem ' <nl> + } , <nl> + lg : { <nl> + width : ' 2 . 875rem ' , <nl> + height : ' 1 . 5rem ' <nl> + } <nl> + } <nl> + <nl> + const Switch = { <nl> + name : ' CSwitch ' , <nl> + model : { <nl> + prop : ' isChecked ' , <nl> + event : ' change ' <nl> + } , <nl> + inject : [ ' $ colorMode ' ] , <nl> + props : { <nl> + . . . styleProps , <nl> + id : String , <nl> + name : String , <nl> + value : Boolean , <nl> + _ariaLabel : String , <nl> + _ariaLabelledBy : String , <nl> + color : { <nl> + type : String , <nl> + default : ' blue ' <nl> + } , <nl> + defaultIsChecked : Boolean , <nl> + isChecked : Boolean , <nl> + size : { <nl> + type : String , <nl> + default : ' md ' <nl> + } , <nl> + isDisabled : Boolean , <nl> + isInvalid : Boolean <nl> + } , <nl> + computed : { <nl> + colorMode ( ) { <nl> + return this . $ colorMode ( ) <nl> + } , <nl> + _width ( ) { <nl> + return switchSizes [ this . size ] & & switchSizes [ this . size ] [ ' width ' ] <nl> + } , <nl> + _height ( ) { <nl> + return switchSizes [ this . size ] & & switchSizes [ this . size ] [ ' height ' ] <nl> + } , <nl> + styleProps ( ) { <nl> + return { <nl> + rounded : ' full ' , <nl> + justifyContent : ' flex - start ' , <nl> + width : this . _width , <nl> + height : this . _height , <nl> + bg : this . colorMode = = = ' dark ' ? ' whiteAlpha . 400 ' : ' gray . 300 ' , <nl> + boxSizing : ' content - box ' , <nl> + p : ' 2px ' , <nl> + _checked : { <nl> + bg : ` $ { this . color } . 500 ` <nl> + } , <nl> + _child : { <nl> + transform : ` translateX ( 0 ) ` <nl> + } , <nl> + _checkedAndChild : { <nl> + transform : ` translateX ( calc ( $ { this . _width } - $ { this . _height } ) ) ` <nl> + } , <nl> + _focus : { <nl> + boxShadow : ' outline ' <nl> + } , <nl> + _hover : { <nl> + cursor : ' pointer ' <nl> + } , <nl> + _checkedAndHover : { <nl> + cursor : ' pointer ' <nl> + } , <nl> + _disabled : { <nl> + opacity : 0 . 4 , <nl> + cursor : ' not - allowed ' <nl> + } <nl> + } <nl> + } <nl> + } , <nl> + render ( h ) { <nl> + return h ( Box , { <nl> + props : { <nl> + . . . forwardProps ( this . $ props ) , <nl> + as : ' label ' , <nl> + display : ' inline - block ' , <nl> + verticalAlign : ' middle ' <nl> + } <nl> + } , [ <nl> + h ( VisuallyHidden , { <nl> + props : { <nl> + as : ' input ' <nl> + } , <nl> + attrs : { <nl> + type : ' checkbox ' , <nl> + ' aria - label ' : this . _ariaLabel , <nl> + ' aria - labelledby ' : this . _ariaLabelledBy , <nl> + id : this . id , <nl> + name : this . name , <nl> + value : this . value , <nl> + ' aria - invalid ' : this . isInvalid , <nl> + defaultChecked : this . defaultIsChecked , <nl> + checked : this . isChecked , <nl> + disabled : this . isDisabled <nl> + } , <nl> + nativeOn : { <nl> + change : ( e ) = > this . $ emit ( ' change ' , ! this . isChecked , e ) <nl> + } <nl> + } ) , <nl> + h ( ControlBox , { <nl> + props : this . styleProps <nl> + } , [ <nl> + h ( Box , { <nl> + props : { <nl> + bg : ' white ' , <nl> + transition : ' transform 250ms ' , <nl> + rounded : ' full ' , <nl> + h : this . _height , <nl> + w : this . _height <nl> + } <nl> + } ) <nl> + ] ) <nl> + ] ) <nl> + } <nl> + } <nl> + <nl> + export default Switch <nl> 
mmm a / packages / chakra - ui - docs / router . js <nl> ppp b / packages / chakra - ui - docs / router . js <nl> const router = new Router ( { <nl> mode : ' history ' , <nl> + scrollBehavior ( to , from , savedPosition ) { <nl> + return { x : 0 , y : 0 } <nl> + } , <nl> routes <nl> } ) <nl> 
mmm a / packages / chakra - ui - docs / layouts / default . vue <nl> ppp b / packages / chakra - ui - docs / layouts / default . vue <nl> } , <nl> ' table , p ' : { <nl> ' code ' : this . code [ colorMode ] <nl> + } , <nl> + li : { <nl> + code : this . code [ colorMode ] <nl> } <nl> } ) ( this . $ chakra . theme ) ) <nl> } , <nl> 
mmm a / packages / chakra - ui - core / src / CAvatar / CAvatar . js <nl> ppp b / packages / chakra - ui - core / src / CAvatar / CAvatar . js <nl> * <nl> * @ see Docs https : / / vue . chakra - ui . com / avatar <nl> + * @ ally Avatar The CAvatar component by default applies the ` alt ` attribute from the ` src ` prop . It also can be overwritten by passing the ` alt ` attribute <nl> * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CAvatar / CAvatar . js <nl> * / <nl> - <nl> import { baseProps } from ' . . / config / props ' <nl> import { forwardProps , canUseDOM } from ' . . / utils ' <nl> import useAvatarStyles , { avatarSizes } from ' . / utils / avatar . styles ' <nl> @ @ - 238 , 9 + 238 , 9 @ @ const CAvatar = { <nl> h : ' 100 % ' , <nl> rounded : ' full ' , <nl> objectFit : ' cover ' , <nl> - alt : this . name <nl> } , <nl> attrs : { <nl> + alt : this . $ attrs . alt | | this . name , <nl> src : this . src <nl> } <nl> } ) <nl> 
mmm a / packages / chakra - ui - docs / docs / tooltip . mdx <nl> ppp b / packages / chakra - ui - docs / docs / tooltip . mdx <nl> # # Usage <nl> - If the children of ` CTooltip ` is a string , we wrap with in a ` span ` with ` tab - index ` set to 0 , to ensure it meets the accessibility requirements . <nl> + If the child of ` CTooltip ` is a string , we wrap it inside a span and set the ` tab - index ` attribute to ` 0 ` to ensure it meets the accessibility requirements . <nl> < LiveEditor > <nl> { ` <nl> @ @ - 103 , 16 + 103 , 21 @ @ Using the ` placement ` prop you can adjust where your tooltip will be displayed . <nl> | ` label ` | ` string ` | | The label of the tooltip . | <nl> | ` aria - label ` | ` string ` | | An alternate label for screen readers . | <nl> | ` placement ` | ` PopperJS . Placement ` | ` bottom ` | Position the tooltip relative to the trigger element as well as surrounding elements . | <nl> - | ` children ` | ` Vue . VNode ` | | The ` VNode ` to be used as the trigger of the tooltip . | <nl> | ` hasArrow ` | ` boolean ` | | If ` true ` display an arrow tip on the tooltip . | <nl> | ` showDelay ` | ` number ` | | The delay in ` ms ` for the tooltip to show | <nl> | ` hideDelay ` | ` number ` | | The delay in ` ms ` for the tooltip to hide | <nl> | ` closeOnClick ` | ` boolean ` | | If ` true ` hide the tooltip , when the trigger is clicked . | <nl> | ` shouldWrapChildren ` | ` boolean ` | | If ` true ` , the tooltip will wrap the children in a ` span ` with ` tabIndex = 0 ` | <nl> + # # # Slots <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | default | Vue . VNode to be rendered inside tooltip | <nl> + <nl> # # # Events <nl> - | Name | Type | Default | Description | <nl> - | - - - - - - - - | - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> - | ` @ open ` | ` function ` | | Function called when the tooltip shows . | <nl> - | ` @ close ` | ` function ` | | Function called when the tooltip hides . | <nl> + | Name | Payload | Description | <nl> + | - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` @ open ` | - | Function called when the tooltip shows . | <nl> + | ` @ close ` | - | Function called when the tooltip hides . | <nl> 
mmm a / packages / chakra - ui - docs / package . json <nl> ppp b / packages / chakra - ui - docs / package . json <nl> " build " : " nuxt generate " , <nl> " start " : " nuxt start " , <nl> - " docs : build " : " nuxt build " , <nl> + " docs : build " : " nuxt " , <nl> " lint " : " eslint - - ext . js , . vue - - ignore - path . gitignore . " <nl> } , <nl> " lint - staged " : { <nl> " @ chakra - ui / vue " : " ^ 0 . 3 . 10 " , <nl> " @ chakra - ui / theme - vue " : " ^ 0 . 2 . 3 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> - " @ fortawesome / free - solid - svg - icons " : " ^ 5 . 11 . gi2 " , <nl> + " @ fortawesome / free - solid - svg - icons " : " ^ 5 . 11 . 2 " , <nl> " @ mdx - js / vue - loader " : " ^ 1 . 5 . 7 " , <nl> " @ nuxtjs / dotenv " : " ^ 1 . 4 . 0 " , <nl> " @ nuxtjs / emotion " : " ^ 0 . 0 . 1 " , <nl> 
mmm a / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> ppp b / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> border : 0 , <nl> opacity : 0 . 6 , <nl> borderColor : ' inherit ' , <nl> - . . . forwardProps ( this . $ props ) , <nl> + . . . forwardProps ( this . $ props ) <nl> } , <nl> attrs : { <nl> ' aria - orientation ' : this . orientation <nl> 
mmm a / packages / chakra - ui - core / src / CTooltip / CTooltip . js <nl> ppp b / packages / chakra - ui - core / src / CTooltip / CTooltip . js <nl> } , <nl> attrs : { <nl> . . . cloned . data . attrs , <nl> + . . . ( this . isOpen & & { ' aria - describedby ' : this . tooltipId } ) , <nl> ' x - tooltip - anchor ' : ` $ { this . tooltipId } ` <nl> } , <nl> on : cloned . componentOptions . listeners , <nl> 
mmm a / packages / chakra - ui - core / src / CImage / CImage . stories . js <nl> ppp b / packages / chakra - ui - core / src / CImage / CImage . stories . js <nl> / > <nl> ` <nl> } ) ) <nl> + . add ( ' With fallback src ' , ( ) = > ( { <nl> + components : { CImage } , <nl> + template : ` <nl> + < CImage <nl> + src = " gibberish . png " <nl> + fallback - src = " https : / / via . placeholder . com / 150 " <nl> + / > <nl> + ` <nl> + } ) ) <nl> 
mmm a / packages / chakra - ui - docs / docs / stat . mdx <nl> ppp b / packages / chakra - ui - docs / docs / stat . mdx <nl> # # Props <nl> - - StatLabel , StatHelpText , StatNumber composes [ Text ] ( / text ) component <nl> + - StatLabel , StatHelpText , StatNumber composes [ CText ] ( / text ) component <nl> - StatArrow composes [ CIcon ] ( / icon ) component <nl> - Stat , StatGroup composes [ CBox ] ( / box ) component <nl> 
mmm a / packages / chakra - ui - docs / docs / stat . mdx <nl> ppp b / packages / chakra - ui - docs / docs / stat . mdx <nl> # # Props <nl> - - StatLabel , StatHelpText , StatNumber composes [ CText ] ( / text ) component <nl> - - StatArrow composes [ CIcon ] ( / icon ) component <nl> - - Stat , StatGroup composes [ CBox ] ( / box ) component <nl> + - CStatLabel , CStatHelperText , CStatNumber composes [ CText ] ( / text ) component <nl> + - CStatArrow composes [ CIcon ] ( / icon ) component <nl> + - CStat , CStatGroup composes [ CBox ] ( / box ) component <nl> 
mmm a / packages / chakra - ui - docs / docs / switch . mdx <nl> ppp b / packages / chakra - ui - docs / docs / switch . mdx <nl> | ` color ` | ` string ` | | The background color of the switch when checked . | <nl> | ` name ` | ` string ` | | The input name of the switch when used in a form . | <nl> | ` value ` | ` string ` , ` boolean ` | | The value of the switch . | <nl> - | ` children ` | ` React . ReactNode ` | | The children of the switch . | <nl> + | ` children ` | ` Vue . VNode ` | | The children of the switch . | <nl> | ` aria - label ` | ` string ` | | The aria - label of the switch for accessibility . | <nl> | ` aria - labelledby ` | ` string ` | | The aria - labelledby of the switch for accessibility . | <nl> | ` isChecked ` | ` boolean ` | | If ` true ` , set the switch to the checked state . | <nl> 
mmm a / packages / chakra - ui - docs / docs / switch . mdx <nl> ppp b / packages / chakra - ui - docs / docs / switch . mdx <nl> | ` color ` | ` string ` | | The background color of the switch when checked . | <nl> | ` name ` | ` string ` | | The input name of the switch when used in a form . | <nl> | ` value ` | ` string ` , ` boolean ` | | The value of the switch . | <nl> - | ` children ` | ` Vue . VNode ` | | The children of the switch . | <nl> | ` aria - label ` | ` string ` | | The aria - label of the switch for accessibility . | <nl> | ` aria - labelledby ` | ` string ` | | The aria - labelledby of the switch for accessibility . | <nl> | ` isChecked ` | ` boolean ` | | If ` true ` , set the switch to the checked state . | <nl> | ` defaultIsChecked ` | ` boolean ` | | If ` true ` , the checkbox will be initially checked . | <nl> | ` isDisabled ` | ` boolean ` | | If ` true ` , set the disabled to the invalid state . | <nl> | ` isInvalid ` | ` boolean ` | | If ` true ` , set the switch to the invalid state . | <nl> + <nl> + # # Slots <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | default | The children of the ` CSwitch ` component . | <nl> 
mmm a / packages / chakra - ui - docs / docs / text . mdx <nl> ppp b / packages / chakra - ui - docs / docs / text . mdx <nl> Text composes the [ CBox ] ( / box ) component , so you can pass all Box style props . <nl> - # # Slot <nl> - <nl> # # Slots <nl> | Name | Description | <nl> 
mmm a / packages / chakra - ui - docs / docs / tabs . mdx <nl> ppp b / packages / chakra - ui - docs / docs / tabs . mdx <nl> # # Usage <nl> - You can render any element within ` Tabs ` , but ` TabList ` should only have ` Tab ` <nl> - as children , and ` TabPanels ` should have ` TabPanel ` as children . <nl> + You can render any element within ` CTabs ` , but ` CTabList ` should only have ` CTab ` <nl> + as children , and ` CTabPanels ` should have ` CTabPanel ` as children . <nl> - Tabs expects ` TabList ` and ` TabPanels ` as children . The order doesn ' t matter , <nl> + Tabs expects ` CTabList ` and ` CTabPanels ` as children . The order doesn ' t matter , <nl> you can have tabs at the top , at the bottom , or both . <nl> ` ` ` vue live = true <nl> @ @ - 243 , 10 + 243 , 10 @ @ Stretch the tab list to fit the container by passing ` isFitted ` prop . <nl> # # Manually Activated Tabs <nl> - By default , ` Tabs ` are activated automatically . This means when you use the <nl> + By default , ` CTabs ` are activated automatically . This means when you use the <nl> arrow keys to change tabs , the tab is activated and focused . <nl> - > The content of a ` TabPanel ` should ideally be preloaded . However , if switching <nl> + > The content of a ` CTabPanel ` should ideally be preloaded . However , if switching <nl> > to a tab panel causes a network request and possibly a page refresh , there <nl> > might be some notable latency and this might affect the experience for <nl> > keyboard and screen reader users . <nl> @ @ - 311 , 7 + 311 , 6 @ @ Tabs composes ` Box ` so you call pass all ` Box ` related props . <nl> | Name | Type | Default | Description | <nl> | - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> - | ` onChange ` | ` ( index : number ) = > void ` | | The callback to update the active tab index . | <nl> | ` index ` | ` number ` | | The controlled index of the tabs . | <nl> | ` defaultIndex ` | ` number ` | | The index of the initial active tab . | <nl> | ` isManual ` | ` boolean ` | | If ` true ` , keyboard navigation changes focus between tabs but doens ' t activate it . User will have to press ` Enter ` to active it | <nl> @ @ - 321 , 6 + 320 , 12 @ @ Tabs composes ` Box ` so you call pass all ` Box ` related props . <nl> | ` orientation ` | ` horizontal ` , ` vertical ` | ` horizontal ` | The orientation of the tabs | <nl> | ` isFitted ` | ` boolean ` | | If ` true ` , the tabs will stretch to fill the available space | <nl> + # # # Tabs Events <nl> + <nl> + | Name | Description | <nl> + | - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` onChange ` | Emits the @ change event . | <nl> + <nl> # # # Tabs Slot <nl> | Name | Description | <nl> 
mmm a / packages / chakra - ui - docs / docs / tabs . mdx <nl> ppp b / packages / chakra - ui - docs / docs / tabs . mdx <nl> # # # Tabs Events <nl> | Name | Description | <nl> - | - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - | <nl> - | ` onChange ` | Emits the @ change event . | <nl> + | - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | ` @ change ` | Event emitted when the active tab changes . | <nl> # # # Tabs Slot <nl> 
mmm a / packages / chakra - ui - core / src / CPopper / CPopper . js <nl> ppp b / packages / chakra - ui - core / src / CPopper / CPopper . js <nl> . then ( ( ) = > { <nl> if ( this . hasArrow ) { <nl> const arrow = this . reference . querySelector ( [ ' [ data - popper - arrow ] ' ] ) <nl> + if ( arrow ) { <nl> arrow . style . transform + = ' rotate ( 45deg ) ' <nl> } <nl> + } <nl> } ) <nl> } else { <nl> this . popper = createPopper ( this . anchor , this . reference , { <nl> @ @ - 199 , 8 + 201 , 10 @ @ const CPopper = { <nl> . then ( ( ) = > { <nl> if ( this . hasArrow ) { <nl> const arrow = this . reference . querySelector ( [ ' [ data - popper - arrow ] ' ] ) <nl> + if ( arrow ) { <nl> arrow . style . transform + = ' rotate ( 45deg ) ' <nl> } <nl> + } <nl> } ) <nl> } <nl> } , <nl> @ @ - 300 , 14 + 304 , 12 @ @ const CPopperArrow = { <nl> attrs : { <nl> ' x - arrow ' : true , <nl> ' data - popper - arrow ' : true , <nl> - role : ' presentation ' <nl> + role : ' presentation ' , <nl> + ' data - chakra - component ' : ' CPopperArrow ' <nl> } , <nl> props : { <nl> bg : ' inherit ' , <nl> . . . forwardProps ( this . $ props ) <nl> - } , <nl> - on : { <nl> - click : ( e ) = > this . $ emit ( ' cheese ' , e ) <nl> } <nl> } ) <nl> } <nl> 
mmm a / . storybook / components / Canvas . vue <nl> ppp b / . storybook / components / Canvas . vue <nl> CButton , <nl> CBox , <nl> CIconButton , <nl> - CColorModeProvider } from ' . . / . . / packages / chakra - ui - core / dist / esm ' <nl> + CColorModeProvider } from ' . . / . . / packages / chakra - ui - core / src ' <nl> export default { <nl> name : ' Canvas ' , <nl> components : { <nl> 
mmm a / packages / chakra - ui - core / src / CPopover / CPopover . js <nl> ppp b / packages / chakra - ui - core / src / CPopover / CPopover . js <nl> } <nl> } , <nl> props : { <nl> - id : { <nl> - type : String , <nl> - default : ` popover - id - $ { useId ( ) } ` <nl> - } , <nl> + id : String , <nl> defaultIsOpen : Boolean , <nl> isOpen : Boolean , <nl> returnFocusOnClose : { <nl> @ @ - 55 , 7 + 52 , 7 @ @ const CPopover = { <nl> triggerNode : this . triggerNode , <nl> contentNode : this . contentNode , <nl> setTriggerNode : this . setTriggerNode , <nl> - popoverId : this . id , <nl> + popoverId : this . computedId , <nl> trigger : this . trigger , <nl> isHovering : this . isHovering , <nl> handleBlur : this . handleBlur , <nl> @ @ - 83 , 10 + 80 , 13 @ @ const CPopover = { <nl> : this . getNode ( this . initialFocusRef ) <nl> } , <nl> headerId ( ) { <nl> - return ` $ { this . id } - header ` <nl> + return ` $ { this . computedId } - header ` <nl> } , <nl> bodyId ( ) { <nl> - return ` $ { this . id } - body ` <nl> + return ` $ { this . computedId } - body ` <nl> + } , <nl> + computedId ( ) { <nl> + return this . id | | ` popover - id - $ { useId ( ) } ` <nl> } <nl> } , <nl> data ( ) { <nl> 
mmm a / packages / chakra - ui - core / src / CCollapse / CCollapse . stories . js <nl> ppp b / packages / chakra - ui - core / src / CCollapse / CCollapse . stories . js <nl> } <nl> } <nl> } ) ) <nl> - . add ( ' Changing the startingHeigh ' , ( ) = > ( { <nl> + . add ( ' Changing the startingHeight ' , ( ) = > ( { <nl> components : { CButton , CCollapse , CBox } , <nl> template : ` <nl> < div > <nl> 
mmm a / packages / chakra - ui - docs / docs / collapse . mdx <nl> ppp b / packages / chakra - ui - docs / docs / collapse . mdx <nl> | duration | ` number ` | The animation duration as it expands | <nl> | startingHeight | ` number ` | The height you want the content in it ' s collapsed state . Set to ` 0 ` by default | <nl> | endingHeight | ` number ` | The height you want the content in it ' s expanded state . Set to ` auto ` by default | <nl> - | easing | ` string ` | Add easing function for entering and leaving state . Accepts easing props from [ animejs ] ( https : / / animejs . com / documentation / # linearEasing ) Set to ` easeInOutSine ` by default . | <nl> + | easing | ` string ` | Add easing function for entering and leaving state . Accepts easing props from [ animejs ] ( https : / / animejs . com / documentation / # linearEasing ) . Set to ` easeInOutSine ` by default . | <nl> # # Events <nl> 
mmm a / packages / chakra - ui - docs / plugins / analytics . js <nl> ppp b / packages / chakra - ui - docs / plugins / analytics . js <nl> import VueMultianalytics from ' vue - multianalytics / dist / vue - multianalytics ' <nl> + export default ( { env , router } ) = > { <nl> let mixpanelConfig = { <nl> - token : process . env . MIXPANEL_TOKEN <nl> + token : env . MIXPANEL_TOKEN <nl> } <nl> - export default ( { app , router } ) = > { <nl> try { <nl> Vue . use ( VueMultianalytics , { <nl> modules : { <nl> 
mmm a / packages / chakra - ui - docs / components / ColorPalette . js <nl> ppp b / packages / chakra - ui - docs / components / ColorPalette . js <nl> - import { baseProps } from ' @ chakra - ui / vue / dist / cjs / index - 5433bb49 ' <nl> + import { CBox , CFlex , CGrid , boxProps } from ' @ chakra - ui / vue ' <nl> export const ColorPalette = { <nl> props : { <nl> - . . . baseProps , <nl> + . . . boxProps , <nl> color : String , <nl> name : String <nl> } , <nl> 
mmm a / packages / chakra - ui - core / src / CNumberInput / CNumberInput . js <nl> ppp b / packages / chakra - ui - core / src / CNumberInput / CNumberInput . js <nl> default : ' md ' <nl> } , <nl> inputId : { <nl> - type : String , <nl> - default : ` number - input - $ { useId ( ) } ` <nl> + type : String <nl> } <nl> } , <nl> provide ( ) { <nl> 
mmm a / yarn . lock <nl> ppp b / yarn . lock <nl> integrity sha512 - 0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw = = <nl> - " @ chakra - ui / vue @ ^ 0 . 4 . 1 " : <nl> - version " 0 . 4 . 2 " <nl> - resolved " https : / / registry . yarnpkg . com / @ chakra - ui / vue / - / vue - 0 . 4 . 2 . tgz # 5a6dc8ab19cad1b59039632037e6a32360378a71 " <nl> - integrity sha512 - wQ53rlbrG4 + AsyAUFuaboF2R3kHfwHFD9jUqL51UsVkc5cUecweyXvavNF / YRMBkAI1ni6BzPM / 3q / 9LqqHE7w = = <nl> - dependencies : <nl> - " @ popperjs / core " " ^ 2 . 4 . 0 " <nl> - " @ styled - system / css " " ^ 5 . 0 . 23 " <nl> - animejs " ^ 3 . 1 . 0 " <nl> - aria - hidden " ^ 1 . 1 . 1 " <nl> - breadstick " ^ 0 . 2 . 14 " <nl> - color " ^ 3 . 1 . 2 " <nl> - focus - trap " ^ 5 . 1 . 0 " <nl> - focus - trap - vue " ^ 0 . 0 . 4 " <nl> - lodash - es " ^ 4 . 17 . 15 " <nl> - portal - vue " ^ 2 . 1 . 6 " <nl> - styled - system " ^ 5 . 1 . 2 " <nl> - v - scroll - lock " ^ 1 . 1 . 0 " <nl> - <nl> " @ cnakazawa / watch @ ^ 1 . 0 . 3 " : <nl> version " 1 . 0 . 4 " <nl> resolved " https : / / registry . yarnpkg . com / @ cnakazawa / watch / - / watch - 1 . 0 . 4 . tgz # f864ae85004d0fcab6f50be9141c4da368d1656a " <nl> @ @ - 20411 , 11 + 20393 , 6 @ @ vue - meta @ ^ 2 . 3 . 3 : <nl> dependencies : <nl> deepmerge " ^ 4 . 2 . 2 " <nl> - vue - multianalytics @ ^ 1 . 11 . 7 : <nl> - version " 1 . 11 . 7 " <nl> - resolved " https : / / registry . yarnpkg . com / vue - multianalytics / - / vue - multianalytics - 1 . 11 . 7 . tgz # e3d10c6952935610317729990f5f604774c86796 " <nl> - integrity sha512 - VSVFSlCwbDTloodDainKUjKArebgwpPN77I8Bi6FhYq9fvBQYX5Qkur4zuLUbB8M3EkJLjyWTz4jztrarZ6pMQ = = <nl> - <nl> vue - no - ssr @ ^ 1 . 1 . 1 : <nl> version " 1 . 1 . 1 " <nl> resolved " https : / / registry . yarnpkg . com / vue - no - ssr / - / vue - no - ssr - 1 . 1 . 1 . tgz # 875f3be6fb0ae41568a837f3ac1a80eaa137b998 " <nl> 
mmm a / packages / chakra - ui - core / src / CAlertDialog / CAlertDialog . js <nl> ppp b / packages / chakra - ui - core / src / CAlertDialog / CAlertDialog . js <nl> * / <nl> - import baseProps from ' . . / config / props ' <nl> + import { baseProps } from ' . . / config / props ' <nl> import { forwardProps , HTMLElement } from ' . . / utils ' <nl> import { <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build " : " yarn workspace @ chakra - ui / vue build " , <nl> " dev " : " yarn workspace @ chakra - ui / vue dev " , <nl> - " lint " : " vue - cli - service lint " , <nl> + " lint " : " vue - cli - service lint packages / chakra - ui - core " , <nl> " lerna : build " : " lerna run build " , <nl> " test : core " : " jest " , <nl> " test : module " : " yarn workspace @ chakra - ui / nuxt test " , <nl> 
mmm a / packages / chakra - ui - core / src / CButton / tests / CButton . test . js <nl> ppp b / packages / chakra - ui - core / src / CButton / tests / CButton . test . js <nl> expect ( getByText ( ' Button ' ) ) . toHaveAttribute ( ' disabled ' ) <nl> } ) <nl> - it . only ( ' should emit " click " event ' , ( ) = > { <nl> + it ( ' should emit " click " event ' , ( ) = > { <nl> const handleClick = jest . fn ( ) <nl> const { getByTestId } = renderComponent ( { <nl> template : ' < CButton @ click = " handleClick " data - testid = " btn " > < / CButton > ' , <nl> 
mmm a / packages / chakra - ui - docs / pages / select . mdx <nl> ppp b / packages / chakra - ui - docs / pages / select . mdx <nl> < c - select placeholder = " large size " size = " lg " / > <nl> < c - select placeholder = " default size " size = " md " / > <nl> < c - select placeholder = " small size " size = " sm " / > <nl> - < / c - sack > <nl> + < / c - stack > <nl> ` ` ` <nl> # # # Changing the appearance of the Select <nl> 
mmm a / packages / chakra - ui - docs / pages / icon . mdx <nl> ppp b / packages / chakra - ui - docs / pages / icon . mdx <nl> align = " center " <nl> justify = " center " <nl> > <nl> - < CIcon color = " gray . 700 " name = { icon } size = " 1 . 25em " / > <nl> + < CIcon color = " currentColor " name = { icon } size = " 1 . 25em " / > <nl> < CText mt = { 2 } fontSize = " sm " textAlign = " center " > <nl> { icon } <nl> < / CText > <nl> 
mmm a / packages / chakra - ui - core / src / CList / CList . js <nl> ppp b / packages / chakra - ui - core / src / CList / CList . js <nl> import { SNA } from ' . . / config / props / props . types ' <nl> - import CPseudoBox from ' . . / CPseudoBox ' <nl> import CIcon from ' . . / CIcon ' <nl> / * * <nl> @ @ - 23 , 7 + 22 , 7 @ @ import CIcon from ' . . / CIcon ' <nl> * / <nl> const CList = { <nl> name : ' CList ' , <nl> - mixins : [ createStyledAttrsMixin ( ' CList ' ) ] , <nl> + mixins : [ createStyledAttrsMixin ( ' CList ' , true ) ] , <nl> props : { <nl> styleType : { <nl> type : String , <nl> @ @ - 57 , 11 + 56 , 12 @ @ const CList = { <nl> return vnode <nl> } <nl> - return cloneVNodeElement ( vnode , { <nl> - props : { <nl> - spacing : this . spacing <nl> + const clone = cloneVNodeElement ( vnode , { <nl> + attrs : { <nl> + mb : this . spacing <nl> } <nl> } , h ) <nl> + return clone <nl> } ) <nl> return h ( ' ul ' , { <nl> @ @ - 82 , 23 + 82 , 22 @ @ const CList = { <nl> * / <nl> const CListItem = { <nl> name : ' CListItem ' , <nl> - functional : true , <nl> + mixins : [ createStyledAttrsMixin ( ' CListItem ' ) ] , <nl> props : { <nl> spacing : SNA <nl> } , <nl> - render ( h , { props , slots , data , . . . rest } ) { <nl> - return h ( CPseudoBox , { <nl> - . . . rest , <nl> - props : { <nl> - as : ' li ' , <nl> - . . . props <nl> - } , <nl> - attrs : { <nl> - mb : props . spacing , <nl> - . . . data . attrs , <nl> - ' data - chakra - component ' : ' CListItem ' <nl> + computed : { <nl> + componentStyles ( ) { <nl> + return { <nl> + mb : this . spacing <nl> + } <nl> } <nl> - } , slots ( ) . default ) <nl> + } , <nl> + render ( h ) { <nl> + return h ( ' li ' , { <nl> + class : [ this . className ] , <nl> + attrs : this . computedAttrs <nl> + } , this . $ slots . default ) <nl> } <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / utils / playground . stories . js <nl> ppp b / packages / chakra - ui - core / src / utils / playground . stories . js <nl> import { storiesOf } from ' @ storybook / vue ' <nl> import Vue from ' vue ' <nl> - import { MDXCodeBlock } from ' . . / . . / . . / . . / website / components / code - block ' <nl> + import { MDXCodeBlock } from ' . . / . . / . . / . . / website / components / code ' <nl> import * as ChakraComponents from ' . . ' <nl> Object . keys ( ChakraComponents ) . forEach ( ( key ) = > { <nl> 
mmm a / packages / chakra - ui - nuxt / lib / module . js <nl> ppp b / packages / chakra - ui - nuxt / lib / module . js <nl> / / Resolve icons <nl> let packIcons = { } <nl> if ( options . icons & & options . icons . iconPack ) { <nl> - packIcons = parsePackIcons ( options . icons . iconPack , options . icons . iconSet ) <nl> + packIcons = parsePackIcons ( options . icons . iconSet ) <nl> } <nl> / / Transpile lodash - es <nl> 
mmm a / packages / chakra - ui - core / src / CPopper / CPopper . js <nl> ppp b / packages / chakra - ui - core / src / CPopper / CPopper . js <nl> } <nl> } <nl> + / * * <nl> + * Call _ . merge ( ) for each item of ` object ` array with the corresponding <nl> + * item of ` source ` array <nl> + * @ param { * } object The destination Modifiers array . <nl> + * @ param { * } source The source array . <nl> + * @ returns Returns merged ` array ` <nl> + * / <nl> + function mergeModifiers ( object , source ) { <nl> + if ( ! Array . isArray ( object ) ) throw new Error ( ' ` object ` must be an array ' ) <nl> + <nl> + const _source = Array . isArray ( source ) ? source : [ source ] <nl> + <nl> + object . forEach ( ( o ) = > { <nl> + const { name } = o <nl> + const _s = _source . find ( s = > s . name = = = name ) <nl> + if ( _s ) merge ( o , _s ) <nl> + } ) <nl> + <nl> + return object <nl> + } <nl> + <nl> / * * <nl> * CPopper component <nl> * <nl> @ @ - 153 , 7 + 174 , 7 @ @ const CPopper = { <nl> return ref <nl> } , <nl> computedModifiers ( ) { <nl> - return merge ( [ <nl> + return mergeModifiers ( [ <nl> this . usePortal & & { <nl> name : ' preventOverflow ' , <nl> options : { <nl> 
mmm a / packages / chakra - ui - core / src / CBox / CBox . stories . js <nl> ppp b / packages / chakra - ui - core / src / CBox / CBox . stories . js <nl> - import { CBox } from ' . . ' <nl> + import CBox from ' . . / CBox ' <nl> storiesOf ( ' UI | Box ' , module ) <nl> . add ( ' Box ' , ( ) = > ( { <nl> @ @ - 28 , 13 + 28 , 26 @ @ storiesOf ( ' UI | Box ' , module ) <nl> template : ` <nl> < div > <nl> < CBox <nl> + position = " relative " <nl> w = " 300px " <nl> h = " 200px " <nl> + overflow = " hidden " <nl> + rounded = " 20px " <nl> + > <nl> + < CBox <nl> + as = " img " <nl> font - family = " body " <nl> objectFit = " contain " <nl> - bgImg = " url ( https : / / lh3 . googleusercontent . com / proxy / vG0O53R9 - vPA2WpuC5lXWCHIVuIQiQ1R7bpQ1UcDsHnHVlz2BJMeSeJx1I1n4huq_SeB39iegxgQl1zXcnNqpq2IJfCgQwwWXpdRG9pNdA ) " <nl> - > <nl> - < CBox h = " full " bg = " red . 200 " : w = " 1 / 2 " / > <nl> + src = " https : / / images . unsplash . com / photo - 1600002415506 - dd06090d3480 ? ixid = MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8 & ixlib = rb - 1 . 2 . 1 & auto = format & fit = crop & w = 1650 & q = 80 " <nl> + / > <nl> + < CBox px = " 5 " display = " flex " flex - direction = " column " justify - content = " center " py = " 3 " h = " full " pos = " absolute " top = " 0 " left = " 0 " bg = " pink . 200 " w = " 50 % " > <nl> + < CBox as = " h1 " font - size = " xl " font - weight = " bold " > <nl> + Tempations <nl> + < / CBox > <nl> + < CBox as = " p " font - size = " md " > <nl> + Spacial cakes for special moments . <nl> + < / CBox > <nl> + < / CBox > <nl> < / CBox > <nl> < / div > <nl> ` <nl> 
mmm a / packages / chakra - ui - core / src / CButton / utils / button . props . js <nl> ppp b / packages / chakra - ui - core / src / CButton / utils / button . props . js <nl> type : String , <nl> default : ' solid ' , <nl> validator : value = > <nl> - value . match ( / ^ ( solid | outline | ghost | flat | link ) $ / ) <nl> + value . match ( / ^ ( solid | outline | ghost | flat | link | unstyled ) $ / ) <nl> } , <nl> variantColor : { <nl> type : [ String , Array ] , <nl> 
mmm a / packages / chakra - ui - core / src / CMenu / CMenuOption . js <nl> ppp b / packages / chakra - ui - core / src / CMenu / CMenuOption . js <nl> type : [ String , Number ] , <nl> default : null <nl> } , <nl> - defaultValue : [ String , Number ] <nl> + defaultValue : [ String , Number , Array ] <nl> } , <nl> data ( ) { <nl> return { <nl> - innerValue : [ ] <nl> + innerValue : this . defaultValue | | [ ] <nl> } <nl> } , <nl> computed : { <nl> 
mmm a / packages / chakra - ui - theme / src / theme / index . js <nl> ppp b / packages / chakra - ui - theme / src / theme / index . js <nl> const config = { <nl> useSystemColorMode : false , <nl> - initialColorMode : " light " , <nl> - cssVarPrefix : " chakra " , <nl> + initialColorMode : ' light ' , <nl> + cssVarPrefix : ' chakra ' <nl> } <nl> const theme = { <nl> 
mmm a / packages / chakra - ui - core / src / CTextarea / CTextarea . stories . js <nl> ppp b / packages / chakra - ui - core / src / CTextarea / CTextarea . stories . js <nl> import { action } from ' @ storybook / addon - actions ' <nl> import { CBox , CTextarea } from ' . . ' <nl> - storiesOf ( ' UI | Textarea ' , module ) . add ( ' Basic Usage ' , ( ) = > ( { <nl> + storiesOf ( ' UI | Textarea ' , module ) <nl> + . add ( ' Basic Usage ' , ( ) = > ( { <nl> components : { CBox , CTextarea } , <nl> template : ` <nl> < CBox w = " 300px " > <nl> @ @ - 26 , 3 + 27 , 31 @ @ storiesOf ( ' UI | Textarea ' , module ) . add ( ' Basic Usage ' , ( ) = > ( { <nl> action : action ( ) <nl> } <nl> } ) ) <nl> + . add ( ' Basic Usage with Event ' , ( ) = > ( { <nl> + components : { CBox , CTextarea } , <nl> + template : ` <nl> + < CBox w = " 300px " > <nl> + < CTextarea <nl> + v - model = " textareaContent " <nl> + maxWidth = " sm " <nl> + mx = " auto " <nl> + mt = " 2 " <nl> + placeholder = " Here is a sample placeholder " <nl> + size = " md " <nl> + : value = " textareaContent " <nl> + @ change = " handleChange " <nl> + / > <nl> + < / CBox > <nl> + ` , <nl> + data ( ) { <nl> + return { <nl> + textareaContent : ' Jonathan Bakebwa is awesome ' <nl> + } <nl> + } , <nl> + methods : { <nl> + action : action ( ) , <nl> + handleChange ( e ) { <nl> + this . textareaContent = ' You are beautiful : ) ' <nl> + } <nl> + } <nl> + } ) ) <nl> 
mmm a / packages / chakra - ui - core / src / utils / icons . js <nl> ppp b / packages / chakra - ui - core / src / utils / icons . js <nl> + / * * <nl> + * @ description Parse FontAwesome icon path <nl> + * @ param { String | Array } path a single svg path , or array of paths <nl> + * @ returns { String } <nl> + * / <nl> + const parseFontAwesomeIcon = ( path ) = > { <nl> + / / duotone icon <nl> + if ( Array . isArray ( path ) & & path . length = = = 2 ) { <nl> + const paths = path . map ( ( d , idx ) = > <nl> + ` < path d = " $ { d } " fill = " currentColor " class = " $ { idx ? ' fa - primary ' : ' fa - secondary ' } " / > ` <nl> + ) <nl> + <nl> + return ` < defs > < style > . fa - secondary { opacity : . 4 } < / style > < / defs > < g class = " fa - group " > $ { paths . join ( ' ' ) } < / g > ` <nl> + } <nl> + <nl> + return ` < path d = " $ { path } " fill = " currentColor " / > ` <nl> + } <nl> + <nl> / * * <nl> * @ description Custom parse all Icons provided by user <nl> * @ param { Object } iconSet - Registered Icons object <nl> @ @ - 14 , 7 + 32 , 7 @ @ const parseIcons = ( iconSet = { } ) = > { <nl> return { <nl> [ ` $ { iconObject . iconName } ` ] : { <nl> path : iconObject . prefix . startsWith ( ' fa ' ) <nl> - ? ` < path d = " $ { path } " fill = " currentColor " / > ` <nl> + ? parseFontAwesomeIcon ( path ) <nl> : iconObject . prefix . startsWith ( ' fe ' ) <nl> ? content <nl> : svg , <nl> 
mmm a / packages / chakra - ui - core / src / utils / icons . js <nl> ppp b / packages / chakra - ui - core / src / utils / icons . js <nl> / * * <nl> - * @ param { String } pack <nl> - * @ param { Array } icon <nl> + * @ param { String } prefix - prefix for the icon pack <nl> + * @ param { Array } icon - icon definition <nl> * @ returns { { path : string , viewBox : string , attrs : * } } <nl> * / <nl> - const createIcon = ( pack , icon ) = > { <nl> + const createIcon = ( prefix , icon ) = > { <nl> const [ w , h , content , svg , data , , attrs ] = icon <nl> let path <nl> @ @ - 21 , 12 + 21 , 12 @ @ const createIcon = ( pack , icon ) = > { <nl> return ` < g fill = " currentColor " class = " $ { prefix } - group " > $ { paths . join ( ' ' ) } < / g > ` <nl> } <nl> - if ( pack = = = ' fa ' ) { <nl> + if ( prefix . startsWith ( ' fa ' ) ) { <nl> path = Array . isArray ( data ) <nl> - ? createGroupedPath ( data , pack ) <nl> + ? createGroupedPath ( data , prefix . substr ( 0 , 2 ) ) <nl> : createPath ( data ) <nl> } else { <nl> - path = pack . startsWith ( ' fe ' ) ? content : svg <nl> + path = prefix . startsWith ( ' fe ' ) ? content : svg <nl> } <nl> return { <nl> @ @ - 38 , 17 + 38 , 16 @ @ const createIcon = ( pack , icon ) = > { <nl> / * * <nl> * @ description Custom parse all Icons provided by user <nl> - * @ param { String } pack - the name of the icon pack being used ( fe , fa , mdi , etc ) <nl> * @ param { Object } iconSet - Registered Icons object <nl> * @ returns { Object } <nl> * / <nl> - const parseIcons = ( pack , iconSet = { } ) = > { <nl> + const parseIcons = ( iconSet = { } ) = > { <nl> const parseIcon = ( iconObject ) = > { <nl> - const { icon , iconName } = iconObject <nl> + const { icon , prefix , iconName } = iconObject <nl> / / Is library icon <nl> if ( icon ) { <nl> return { <nl> - [ ` $ { iconName } ` ] : createIcon ( pack , icon ) <nl> + [ ` $ { iconName } ` ] : createIcon ( prefix , icon ) <nl> } <nl> } else { <nl> return { } <nl> @ @ - 62 , 13 + 61 , 12 @ @ const parseIcons = ( pack , iconSet = { } ) = > { <nl> / * * <nl> * @ description Parse Icon packs <nl> - * @ param { String } pack - the name of the icon pack being used ( fe , fa , mdi , etc ) <nl> * @ param { Object } iconSet Registered Icon set <nl> * @ returns { Object } Parsed pack icons object <nl> * / <nl> - export const parsePackIcons = ( pack , iconSet ) = > { <nl> + export const parsePackIcons = ( iconSet ) = > { <nl> / / TODO : Add support for other icon libraries <nl> / / - Material Icons : these are string constants , and need lots of work <nl> / / - Tailwind Icons ( Hero icons ) <nl> - return parseIcons ( pack , iconSet ) <nl> + return parseIcons ( iconSet ) <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> ppp b / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> const clone = cloneVNode ( vnode , h ) <nl> return h ( clone . componentOptions . Ctor , { <nl> . . . clone . data , <nl> - . . . ( clone . componentOptions . listeners | | { } ) , <nl> + on : { <nl> + . . . ( clone . componentOptions . listeners | | { } ) <nl> + } , <nl> props : { <nl> . . . ( clone . data . props | | { } ) , <nl> . . . clone . componentOptions . propsData , <nl> 
mmm a / packages / chakra - ui - theme / src / theme / breakpoints . js <nl> ppp b / packages / chakra - ui - theme / src / theme / breakpoints . js <nl> * / <nl> - const _breakpoints = [ ' 30em ' , ' 48em ' , ' 62em ' , ' 80em ' ] <nl> - <nl> - _breakpoints . sm = _breakpoints [ 0 ] <nl> - _breakpoints . md = _breakpoints [ 1 ] <nl> - _breakpoints . lg = _breakpoints [ 2 ] <nl> - _breakpoints . xl = _breakpoints [ 3 ] <nl> + const _breakpoints = { <nl> + sm : ' 30em ' , <nl> + md : ' 48em ' , <nl> + lg : ' 62em ' , <nl> + xl : ' 80em ' , <nl> + ' 2xl ' : ' 96em ' <nl> + } <nl> export const createBreakpoints = ( <nl> config = { } <nl> 
mmm a / . storybook / components / Canvas . vue <nl> ppp b / . storybook / components / Canvas . vue <nl> : color = " colorMode = = = ' light ' ? ' gray . 800 ' : ' gray . 50 ' " <nl> class = " root " <nl> + width = " 100vw " <nl> + height = " 100vh " <nl> + transition = " all 0 . 2s ease - in - out " <nl> > <nl> - < CHeading mb = " 50px " pos = " absolute " top = " 3 " left = " 50 % " transform = " translateX ( - 50 % ) " as = " h4 " > @ chakra - ui / vue < / CHeading > <nl> + < CFlex justify - content = " space - between " padding = " 4 " > <nl> + < CHeading mb = " 50px " as = " h4 " > @ chakra - ui / vue < / CHeading > <nl> < CReset / > <nl> < CButton <nl> as = " a " <nl> target = " _blank " <nl> href = " https : / / github . com / chakra - ui / chakra - ui - vue " <nl> - position = " fixed " <nl> - top = " 3 " <nl> - left = " 3 " <nl> shadow = " sm " <nl> left - icon = " github " <nl> + order = " - 1 " <nl> > <nl> Github <nl> < / CButton > <nl> < CIconButton <nl> - position = " fixed " <nl> - top = " 3 " <nl> - right = " 3 " <nl> - : aria - label = " ` Switch to $ { colorMode = = = ' light ' ? ' dark ' : ' light ' } mode ` " <nl> - variant = " ghost " <nl> + : aria - label = " <nl> + ` Switch to $ { colorMode = = = ' light ' ? ' dark ' : ' light ' } mode ` <nl> + " <nl> + variant = " solid " <nl> : icon = " colorMode = = = ' light ' ? ' sun ' : ' moon ' " <nl> @ click = " toggleColorMode " <nl> > <nl> < / CIconButton > <nl> - < div class = " wrapper " > <nl> + < / CFlex > <nl> + < CFlex <nl> + class = " wrapper " <nl> + flex - direction = " column " <nl> + justify - content = " center " <nl> + align - items = " center " <nl> + > <nl> < slot / > <nl> - < / div > <nl> + < / CFlex > <nl> < / CBox > <nl> < / CColorModeProvider > <nl> < / CThemeProvider > <nl> @ @ - 46 , 8 + 53 , 10 @ @ import { <nl> CReset , <nl> CButton , <nl> CBox , <nl> + CFlex , <nl> CIconButton , <nl> - CColorModeProvider } from ' . . / . . / packages / chakra - ui - core / src ' <nl> + CColorModeProvider <nl> + } from ' . . / . . / packages / chakra - ui - core / src ' <nl> export default { <nl> name : ' Canvas ' , <nl> @ @ - 57 , 32 + 66 , 9 @ @ export default { <nl> CReset , <nl> CButton , <nl> CBox , <nl> + CFlex , <nl> CIconButton , <nl> CColorModeProvider <nl> } <nl> } <nl> < / script > <nl> - <nl> - < style lang = " scss " scoped > <nl> - html , <nl> - body { <nl> - margin : 0 <nl> - } <nl> - . root { <nl> - height : 100vh ; <nl> - width : 100vw ; <nl> - display : flex ; <nl> - flex - direction : column ; <nl> - justify - content : center ; <nl> - align - items : center ; <nl> - transition : all 0 . 2s ease - in - out ; <nl> - . wrapper { <nl> - display : flex ; <nl> - flex - direction : column ; <nl> - justify - content : center ; <nl> - align - items : center ; <nl> - width : 100 % ; <nl> - height : 100 % <nl> - } <nl> - } <nl> - < / style > <nl> \ No newline at end of file <nl> 
mmm a / website / pages / circularprogress . mdx <nl> ppp b / website / pages / circularprogress . mdx <nl> - <nl> - < SEO title = " Circular Progress " description = " Circular Progress is used to indicates the progress for determinate and indeterminate processes . " / > <nl> - <nl> - <nl> + import SEO from ' . . / components / SEO ' <nl> + < SEO <nl> + title = " Circular Progress " <nl> + description = " Circular Progress is used to indicates the progress for determinate and indeterminate processes . " <nl> + / > <nl> # Circular Progress <nl> + <nl> The Circular Progress component is used to indicates the progress for both determinate and indeterminate processes . <nl> - Determinate progress fills the circular track with color , as the indicator <nl> @ @ - 13 , 33 + 14 , 28 @ @ The Circular Progress component is used to indicates the progress for both deter <nl> - Indeterminate progress grows and shrinks the indicator while moving along the <nl> circular track . <nl> - <nl> - See ` CCircularProgress ` ' s < a target = " _blank " href = " https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCircularProgress / accesibility . md " > accessibility report < / a > <nl> - <nl> + See ` CCircularProgress ` ' s < a target = " _blank " href = " https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCircularProgress / accessibility . md " > accessibility report < / a > <nl> < carbon - ad / > <nl> # # Import <nl> ` ` ` js <nl> - import { CCircularProgress , CCircularProgressLabel } from " @ chakra - ui / vue " ; <nl> + import { CCircularProgress , CCircularProgressLabel } from ' @ chakra - ui / vue ' <nl> ` ` ` <nl> - <nl> # # Usage <nl> ` ` ` vue live = true <nl> < c - circular - progress : value = " 80 " / > <nl> ` ` ` <nl> - <nl> # # # Changing the size <nl> You can add ` size ` prop to the progress bar to add a custom size . <nl> ` ` ` vue live = true <nl> - / / Change the size to 120px <nl> - < c - circular - progress : value = " 30 " size = " 120px " / > <nl> + / / Change the size to 120px < c - circular - progress : value = " 30 " size = " 120px " / > <nl> ` ` ` <nl> # # # Changing the thickness <nl> @ @ - 91 , 7 + 87 , 7 @ @ Setting the progress to indeterminate means you ' re not able to determine the <nl> # # Props <nl> | Name | Type | Default | Description | <nl> - | - - - - - - - - - - - - - - - | - - - - - - - - - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | - - - - - - - - - - - - - - - | - - - - - - - - - | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> | size | ` string ` | ` 48px ` | The size of the circular progress in CSS units | <nl> | max | ` number ` | ` 100 ` | Maximum value defining 100 % progress made ( must be higher than ' min ' ) | <nl> | min | ` number ` | ` 0 ` | Minimum value defining ' no progress ' ( must be lower than ' max ' ) | <nl> @ @ - 103 , 6 + 99 , 7 @ @ Setting the progress to indeterminate means you ' re not able to determine the <nl> | color | ` string ` | ` blue ` | The color of the progress indicator . Use a color key in the theme object | <nl> # # Slots <nl> + <nl> | Name | Description | <nl> - | - - - - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> + | - - - - - - - | - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - | <nl> | default | Used for the ` CCircularProgressLabel ` to display the current progress percentage | <nl> 
mmm a / packages / chakra - ui - core / src / CMenu / CMenu . js <nl> ppp b / packages / chakra - ui - core / src / CMenu / CMenu . js <nl> focusAtIndex : this . focusAtIndex , <nl> focusOnLastItem : this . focusOnLastItem , <nl> focusOnFirstItem : this . focusOnFirstItem , <nl> + openMenu : this . openMenu , <nl> closeMenu : this . closeMenu , <nl> autoSelect : this . autoSelect , <nl> closeOnSelect : this . closeOnSelect , <nl> 
mmm a / packages / razzle - dev - utils / webpackHotDevClient . js <nl> ppp b / packages / razzle - dev - utils / webpackHotDevClient . js <nl> var formatWebpackMessages = require ( ' react - dev - utils / formatWebpackMessages ' ) ; <nl> var ErrorOverlay = require ( ' react - error - overlay ' ) ; <nl> + ErrorOverlay . setEditorHandler ( function editorHandler ( errorLocation ) { <nl> + / / Keep this sync with errorOverlayMiddleware . js <nl> + fetch ( <nl> + url . format ( { <nl> + protocol : window . location . protocol , <nl> + hostname : window . location . hostname , <nl> + port : parseInt ( process . env . PORT | | window . location . port , 10 ) + 1 , <nl> + pathname : launchEditorEndpoint , <nl> + search : <nl> + ' ? fileName = ' + <nl> + window . encodeURIComponent ( errorLocation . fileName ) + <nl> + ' & lineNumber = ' + <nl> + window . encodeURIComponent ( errorLocation . lineNumber | | 1 ) + <nl> + ' & colNumber = ' + <nl> + window . encodeURIComponent ( errorLocation . colNumber | | 1 ) , <nl> + } ) , <nl> + { mode : ' no - cors ' } <nl> + ) ; <nl> + } ) ; <nl> + <nl> / / We need to keep track of if there has been a runtime error . <nl> / / Essentially , we cannot guarantee application state was not corrupted by the <nl> / / runtime error . To prevent confusing behavior , we forcibly reload the entire <nl> @ @ - 24 , 12 + 44 , 6 @ @ var ErrorOverlay = require ( ' react - error - overlay ' ) ; <nl> / / See https : / / github . com / facebookincubator / create - react - app / issues / 3096 <nl> var hadRuntimeError = false ; <nl> ErrorOverlay . startReportingRuntimeErrors ( { <nl> - launchEditorEndpoint : url . format ( { <nl> - protocol : window . location . protocol , <nl> - hostname : window . location . hostname , <nl> - port : parseInt ( process . env . PORT | | window . location . port , 10 ) + 1 , <nl> - pathname : launchEditorEndpoint , <nl> - } ) , <nl> onError : function ( ) { <nl> hadRuntimeError = true ; <nl> } , <nl> 
mmm a / packages / razzle / config / createConfig . js <nl> ppp b / packages / razzle / config / createConfig . js <nl> loader : require . resolve ( ' file - loader ' ) , <nl> options : { <nl> name : ' static / media / [ name ] . [ hash : 8 ] . [ ext ] ' , <nl> - emitFile : true , <nl> + emitFile : IS_WEB , <nl> } , <nl> } , <nl> / / " url " loader works like " file " loader except that it embeds assets <nl> @ @ - 162 , 7 + 162 , 7 @ @ module . exports = ( <nl> options : { <nl> limit : 10000 , <nl> name : ' static / media / [ name ] . [ hash : 8 ] . [ ext ] ' , <nl> - emitFile : true , <nl> + emitFile : IS_WEB , <nl> } , <nl> } , <nl> 
mmm a / examples / with - afterjs / src / server . js <nl> ppp b / examples / with - afterjs / src / server . js <nl> } ) ; <nl> res . send ( html ) ; <nl> } catch ( error ) { <nl> - res . json ( error ) ; <nl> + console . error ( error ) ; <nl> + res . json ( { message : error . message , stack : error . stack } ) ; <nl> } <nl> } ) ; <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> - run : <nl> name : Install and bootstrap packages <nl> - command : yarn install - - frozen - lockfile <nl> + command : yarn install - - frozen - lockfile - - ignore - engines <nl> - run : <nl> name : Run tests <nl> 
mmm a / . github / workflows / nodejs . yml <nl> ppp b / . github / workflows / nodejs . yml <nl> run : yarn global add elm <nl> - name : Install and bootstrap packages <nl> - run : yarn install - - frozen - lockfile <nl> + run : yarn install - - frozen - lockfile - - ignore - engines <nl> - name : Run tests <nl> run : yarn e2e - - runInBand - - coverage <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " private " : true , <nl> - " bugs " : " https : / / github . com / jaredpalmer / razzle / issues " , <nl> " homepage " : " https : / / github . com / jaredpalmer / razzle # readme " , <nl> + " repository " : { <nl> + " type " : " git " , <nl> + " url " : " git + https : / / github . com / jaredpalmer / razzle . git " <nl> + } , <nl> + " bugs " : { <nl> + " url " : " https : / / github . com / jaredpalmer / razzle / issues " <nl> + } , <nl> " devDependencies " : { <nl> " eslint " : " ^ 6 . 8 . 0 " , <nl> " husky " : " ^ 4 . 2 . 3 " , <nl> 
mmm a / packages / razzle / README . md <nl> ppp b / packages / razzle / README . md <nl> * ` process . env . NODE_ENV ` : ` ' development ' ` or ` ' production ' ` <nl> * ` process . env . BUILD_TYPE ` : ` ' iso ' ` for isomorphic / universal applications or ` ' spa ' ` for single page applications . The default is ` ' iso ' ` . This is set by CLI arguments . <nl> * ` process . env . BUILD_TARGET ` : either ` ' client ' ` or ` ' server ' ` <nl> - * ` process . env . PUBLIC_PATH ` : Only in used in ` razzle build ` . You can alter the ` webpack . config . output . publicPath ` of the client assets ( bundle , css , and images ) . This is useful if you plan to serve your assets from a CDN . Make sure to _include_ a trailing slash ( e . g . ` PUBLIC_PATH = https : / / cdn . example . com / ` ) . If you are using React and altering the public path , make sure to also [ include the ` crossorigin ` attribute ] ( https : / / reactjs . org / docs / cdn - links . html # why - the - crossorigin - attribute ) on your ` < script > ` tag in ` src / server . js ` . <nl> + * ` process . env . PUBLIC_PATH ` : Only used in ` razzle build ` . You can alter the ` webpack . config . output . publicPath ` of the client assets ( bundle , css , and images ) . This is useful if you plan to serve your assets from a CDN . Make sure to _include_ a trailing slash ( e . g . ` PUBLIC_PATH = https : / / cdn . example . com / ` ) . If you are using React and altering the public path , make sure to also [ include the ` crossorigin ` attribute ] ( https : / / reactjs . org / docs / cdn - links . html # why - the - crossorigin - attribute ) on your ` < script > ` tag in ` src / server . js ` . <nl> * ` process . env . CLIENT_PUBLIC_PATH ` : The ` NODE_ENV = development ` build ' s ` BUILD_TARGET = client ` has a different ` PUBLIC_PATH ` than ` BUILD_TARGET = server ` . Default is ` http : / / $ { process . env . HOST } : $ { process . env . PORT + 1 } / ` <nl> You can create your own custom environment variables that will be inlined during the build . They must start <nl> 
mmm a / packages / razzle - plugin - scss / package . json <nl> ppp b / packages / razzle - plugin - scss / package . json <nl> " dependencies " : { <nl> " autoprefixer " : " ^ 8 . 6 . 2 " , <nl> - " mini - css - extract - plugin " : " ^ 0 . 4 . 0 " , <nl> + " mini - css - extract - plugin " : " ^ 0 . 9 . 0 " , <nl> " node - sass - chokidar " : " ^ 1 . 3 . 0 " , <nl> " postcss - flexbugs - fixes " : " ^ 3 . 3 . 1 " , <nl> " postcss - scss " : " ^ 1 . 0 . 5 " , <nl> 
mmm a / packages / razzle - plugin - scss / tests / index . test . js <nl> ppp b / packages / razzle - plugin - scss / tests / index . test . js <nl> loaderFinder : cssLoaderFinder , <nl> } , <nl> { <nl> - name : ' should not add postcss - loader ' , <nl> + name : ' should add postcss - loader ' , <nl> loaderFinder : postCssLoaderFinder , <nl> - status : ' falsy ' , <nl> } , <nl> { <nl> - name : ' should not add resolve - url - loader ' , <nl> + name : ' should add resolve - url - loader ' , <nl> loaderFinder : resolveUrlLoaderFinder , <nl> - status : ' falsy ' , <nl> } , <nl> { <nl> - name : ' should not add sass - loader ' , <nl> + name : ' should add sass - loader ' , <nl> loaderFinder : sassLoaderFinder , <nl> - status : ' falsy ' , <nl> } , <nl> ] ; <nl> 
mmm a / packages / razzle - plugin - scss / index . js <nl> ppp b / packages / razzle - plugin - scss / index . js <nl> use : isServer <nl> ? [ <nl> { <nl> - loader : require . resolve ( ' css - loader / locals ' ) , <nl> + loader : require . resolve ( ' css - loader ' ) , <nl> options : Object . assign ( { } , options . css [ constantEnv ] , { <nl> + onlyLocals : true , <nl> modules : true , <nl> localIdentName : ' [ name ] __ [ local ] ___ [ hash : base64 : 5 ] ' , <nl> } ) , <nl> 
mmm a / packages / razzle / config / modules . js <nl> ppp b / packages / razzle / config / modules . js <nl> const path = require ( ' path ' ) ; <nl> const paths = require ( ' . / paths ' ) ; <nl> - const logger = require ( ' . . / . . / razzle - dev - utils / logger ' ) ; <nl> + const logger = require ( ' razzle - dev - utils / logger ' ) ; <nl> const resolve = require ( ' resolve ' ) ; <nl> const nodePath = require ( ' . / env ' ) . nodePath ; <nl> 
mmm a / packages / razzle - plugin - typescript / README . md <nl> ppp b / packages / razzle - plugin - typescript / README . md <nl> - <nl> - This is no longer supported , Razzle now has support for typescript ining babel . <nl> - <nl> - Use [ with - typescript example ] ( https : / / github . com / jaredpalmer / razzle / tree / next / examples / with - typescript ) instead . <nl> - <nl> # # razzle - plugin - typescript <nl> This package contains a plugin for using TypeScript with Razzle <nl> + Razzle now has support for typescript using babel . Unless you specifically need this plugin we recommend using the builtin support <nl> + <nl> + Use [ with - typescript example ] ( https : / / github . com / jaredpalmer / razzle / tree / next / examples / with - typescript ) instead . <nl> + <nl> # # Usage in Razzle Projects <nl> ` ` ` <nl> 
mmm a / examples / with - scss - options / razzle . config . js <nl> ppp b / examples / with - scss - options / razzle . config . js <nl> options : { <nl> sass : { <nl> dev : { <nl> - data : ` @ import " $ { path . resolve ( __dirname , ' . / src / prepend . scss ' ) } " ; ` , <nl> + data : ` @ import " $ { path . resolve ( __dirname , ' . / src / prepend . scss ' ) . replace ( / \ \ / g , ' / ' ) } " ; ` , <nl> } , <nl> prod : { <nl> - data : ` @ import " $ { path . resolve ( __dirname , ' . / src / prepend . scss ' ) } " ; ` , <nl> + data : ` @ import " $ { path . resolve ( __dirname , ' . / src / prepend . scss ' ) . replace ( / \ \ / g , ' / ' ) } " ; ` , <nl> } , <nl> } , <nl> } , <nl> 
mmm a / packages / razzle / config / createJestConfig . js <nl> ppp b / packages / razzle / config / createJestConfig . js <nl> return new Promise ( async resolveConfig = > { <nl> / / Use this instead of ` paths . testsSetup ` to avoid putting <nl> / / an absolute filename into configuration after ejecting . <nl> + const setupTestsFile = getSetupTestsFilePath ( paths ) ; <nl> / / TODO : I don ' t know if it ' s safe or not to just use / as path separator <nl> / / in Jest configs . We need help from somebody with Windows to determine this . <nl> 
mmm a / website / . nextra / search . js <nl> ppp b / website / . nextra / search . js <nl> { renderList & & ( <nl> < div className = " search - overlay z - 1 " onClick = { ( ) = > setShow ( false ) } / > <nl> ) } <nl> - < div class = " absolute inset - y - 0 left - 0 pl - 3 flex items - center pointer - events - none " > <nl> + < div className = " absolute inset - y - 0 left - 0 pl - 3 flex items - center pointer - events - none " > <nl> < svg <nl> fill = " none " <nl> strokeLinecap = " round " <nl> strokeLinejoin = " round " <nl> - stroke - width = " 2 " <nl> + strokeWidth = " 2 " <nl> viewBox = " 0 0 24 24 " <nl> stroke = " currentColor " <nl> className = " h - 4 w - 4 text - gray - 400 " <nl> 
mmm a / examples / basic - spa / public / index . html <nl> ppp b / examples / basic - spa / public / index . html <nl> < meta charset = " utf - 8 " / > <nl> + < link rel = " icon " href = " < % = process . env . PUBLIC_PATH % > favicon . ico " / > <nl> < meta name = " viewport " content = " width = device - width , initial - scale = 1 , shrink - to - fit = no " / > <nl> < meta name = " theme - color " content = " # 000000 " / > <nl> < ! - - <nl> - Notice the use of % PUBLIC_URL % in the tags above . <nl> + Notice the use of < % = process . env . PUBLIC_PATH % > in the tags above . <nl> It will be replaced with the URL of the ` public ` folder during the build . <nl> Only files inside the ` public ` folder can be referenced from the HTML . <nl> - Unlike " / favicon . ico " or " favicon . ico " , " % PUBLIC_URL % / favicon . ico " will <nl> + Unlike " / favicon . ico " or " favicon . ico " , " < % = process . env . PUBLIC_PATH % > / favicon . ico " will <nl> work correctly both with client - side routing and a non - root public URL . <nl> Learn how to configure a non - root public URL by running ` npm run build ` . <nl> - - > <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> const postcssLoadConfig = require ( ' postcss - load - config ' ) ; <nl> const logger = require ( ' razzle - dev - utils / logger ' ) ; <nl> const razzlePaths = require ( ' razzle / config / paths ' ) ; <nl> + const getCacheIdentifier = require ( ' react - dev - utils / getCacheIdentifier ' ) ; <nl> const defaultPostCssOptions = { <nl> ident : ' postcss ' , <nl> @ @ - 89 , 6 + 90 , 25 @ @ module . exports = ( <nl> if ( ! hasBabelRc ) { <nl> mainBabelOptions . presets . push ( require . resolve ( ' . . / babel ' ) ) ; <nl> + / / Make sure we have a unique cache identifier , erring on the <nl> + / / side of caution . <nl> + / / We remove this when the user ejects because the default <nl> + / / is sane and uses Babel options . Instead of options , we use <nl> + / / the razzle - dev - utils and babel - preset - razzle versions . <nl> + mainBabelOptions . cacheIdentifier = getCacheIdentifier ( <nl> + ( IS_PROD <nl> + ? ' production ' <nl> + : IS_DEV & & ' development ' ) <nl> + + ' _ ' <nl> + + ( IS_NODE <nl> + ? ' nodebuild ' <nl> + : IS_WEB & & ' webbuild ' ) , <nl> + [ <nl> + ' babel - preset - razzle ' , <nl> + ' react - dev - utils ' , <nl> + ' razzle - dev - utils ' , <nl> + ] <nl> + ) ; <nl> if ( IS_DEV & & IS_WEB & & shouldUseReactRefresh ) { <nl> mainBabelOptions . plugins . push ( require . resolve ( ' react - refresh / babel ' ) ) ; <nl> } <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> / / Check if plugin is a function . <nl> / / If it is , call it on the configs we created . <nl> if ( typeof plugin = = = ' function ' ) { <nl> - config = await Promise . resolve ( <nl> - runPlugin ( <nl> + config = await runPlugin ( <nl> plugin , <nl> config , <nl> { target , dev : IS_DEV } , <nl> webpackObject , <nl> options <nl> - ) <nl> ) ; <nl> } <nl> } <nl> / / Check if razzle . config . js has a modify function . <nl> / / If it does , call it on the configs we created . <nl> if ( modify ) { <nl> - config = await Promise . resolve ( <nl> - modify ( config , { target , dev : IS_DEV } , webpackObject ) <nl> - ) ; <nl> + config = await modify ( config , { target , dev : IS_DEV } , webpackObject ) ; <nl> } <nl> resolve ( config ) ; <nl> 
mmm a / test / tests / razzle - start - spa . test . js <nl> ppp b / test / tests / razzle - start - spa . test . js <nl> } <nl> ) ; <nl> child . stdout . on ( ' data ' , data = > { <nl> - console . log ( data ) ; <nl> if ( data . includes ( ' > SPA Started on port 3000 ' ) ) { <nl> shell . exec ( ' sleep 5 ' ) ; <nl> const devServerOutput = shell . exec ( <nl> @ @ - 43 , 10 + 42 , 6 @ @ describe ( ' razzle start ' , ( ) = > { <nl> kill ( child . pid ) ; <nl> } <nl> } ) ; <nl> - child . stderr . on ( ' data ' , data = > { <nl> - console . log ( data ) ; <nl> - kill ( child . pid ) ; <nl> - } ) ; <nl> } ) ; <nl> return run . then ( ( test ) = > expect ( test ) . toBeTruthy ( ) ) ; <nl> } ) ; <nl> 
mmm a / packages / create - razzle - app / lib / index . js <nl> ppp b / packages / create - razzle - app / lib / index . js <nl> ' https : / / api . github . com / repos / jaredpalmer / razzle / contents / examples ' ; <nl> const branch = ' next - awesome ' ; / / this line auto updates when yarn update - examples is run <nl> - const razzlePkg = ` razzle $ { branch = = ' master ' ? ' ' : ' @ ' + branch } ` ; <nl> + const razzlePkg = ` razzle $ { branch = = ' canary ' ? ' @ ' + branch : ' ' } ` ; <nl> const getOfficialExamples = ( ) = > { <nl> if ( typeof process . env . CI = = = ' undefined ' ) { <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> if ( baseRes ! = = res ) { <nl> return callback ( ) <nl> } <nl> + <nl> + / / This is the @ babel / plugin - transform - runtime " helpers : true " option <nl> + if ( res . match ( / node_modules [ / \ \ ] @ babel [ / \ \ ] runtime [ / \ \ ] / ) ) { <nl> + return callback ( ) <nl> + } <nl> + <nl> / / Anything else that is standard JavaScript within ` node_modules ` <nl> / / can be externalized . <nl> if ( res . match ( / node_modules [ / \ \ ] . * \ . js $ / ) ) { <nl> 
mmm a / packages / razzle / scripts / build . js <nl> ppp b / packages / razzle / scripts / build . js <nl> / / Helper function to copy public directory to build / public <nl> function copyPublicFolder ( ) { <nl> + if ( fs . existsSync ( paths . appPublic ) ) { <nl> fs . copySync ( paths . appPublic , paths . appBuildPublic , { <nl> dereference : true , <nl> filter : file = > file ! = = paths . appHtml , <nl> } ) ; <nl> } <nl> + } <nl> / / Wrap webpackcompile in a try catch . <nl> function compile ( config , cb ) { <nl> 
mmm a / examples / with - vendor - bundle / src / server . js <nl> ppp b / examples / with - vendor - bundle / src / server . js <nl> const assets = require ( process . env . RAZZLE_ASSETS_MANIFEST ) ; <nl> - const scripts = Object . keys ( assets ) . reduce ( ( scripts , key ) = > { <nl> - return ( <nl> - scripts + ` < script src = " $ { assets [ key ] . js } " defer crossorigin > < / script > ` <nl> - ) ; <nl> - } , " " ) ; <nl> + const scripts = Object . keys ( assets ) <nl> + . map ( ( key ) = > { <nl> + const script = assets [ key ] . js ; <nl> + <nl> + if ( typeof script = = = ' undefined ' | | script = = = null ) { <nl> + return null ; <nl> + } <nl> + <nl> + if ( Array . isArray ( script ) ) { <nl> + return script <nl> + . map ( ( item ) = > { <nl> + return ` < script src = " $ { item } " > < / script > ` ; <nl> + } ) <nl> + . join ( ' ' ) ; <nl> + } <nl> + <nl> + return ` < script src = " $ { script } " > < / script > ` ; <nl> + } ) <nl> + . filter ( ( a ) = > typeof a ! = = ' undefined ' | | a ! = = null ) ; <nl> - console . log ( scripts ) ; <nl> const server = express ( ) ; <nl> @ @ - 28 , 7 + 41 , 7 @ @ server <nl> < meta charSet = ' utf - 8 ' / > <nl> < title > Welcome to Razzle < / title > <nl> < meta name = " viewport " content = " width = device - width , initial - scale = 1 " > <nl> - $ { scripts } <nl> + $ { scripts . join ( ' \ n ' ) } <nl> < / head > <nl> < body > <nl> < div id = " root " > $ { markup } < / div > <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> new webpack . optimize . AggressiveMergingPlugin ( ) , <nl> new CopyPlugin ( { <nl> patterns : [ <nl> - { from : ' public / * . * ' , to : paths . appBuild , noErrorOnMissing : true , context : paths . appPath } , <nl> + { <nl> + from : paths . appPublic + ' / * * / * ' , <nl> + to : paths . appBuild , <nl> + context : paths . appPath , <nl> + noErrorOnMissing : true <nl> + } , <nl> ] , <nl> } ) , <nl> ] ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> } ) , <nl> new webpack . HashedModuleIdsPlugin ( ) , <nl> new webpack . optimize . AggressiveMergingPlugin ( ) , <nl> - new CopyPlugin ( { <nl> - patterns : [ <nl> + new CopyPlugin ( [ <nl> { <nl> from : paths . appPublic + ' / * * / * ' , <nl> to : paths . appBuild , <nl> - context : paths . appPath , <nl> - noErrorOnMissing : true <nl> + context : paths . appPath <nl> } , <nl> ] , <nl> - } ) , <nl> + ) , <nl> ] ; <nl> config . optimization = Object . assign ( <nl> 
mmm a / packages / create - razzle - app / lib / index . js <nl> ppp b / packages / create - razzle - app / lib / index . js <nl> const officialExamplesApiUrl = <nl> ` https : / / api . github . com / repos / jaredpalmer / razzle / contents / examples $ { branch = = ' master ' ? ' ' : ' ? ref = ' + branch } ` ; <nl> - const branch = ' next - awesome ' ; / / this line auto updates when yarn update - examples is run <nl> - const razzlePkg = ` razzle $ { branch = = ' canary ' ? ' @ ' + branch : ' ' } ` ; <nl> - <nl> const getOfficialExamples = ( ) = > { <nl> if ( typeof process . env . CI = = = ' undefined ' ) { <nl> return axios <nl> 
mmm a / packages / razzle / package . json <nl> ppp b / packages / razzle / package . json <nl> " version " : " 3 . 3 . 0 - canary . 2 " , <nl> " bin " : { <nl> - " razzle " : " canary " <nl> + " razzle " : " . / bin / razzle . js " <nl> } , <nl> " files " : [ <nl> " babel . js " , <nl> 
mmm a / . github / workflows / nodejs . yml <nl> ppp b / . github / workflows / nodejs . yml <nl> key : $ { { matrix . os } } - $ { { matrix . node - version } } - $ { { hashFiles ( ' * * / yarn . lock ' ) } } <nl> - name : Install and bootstrap packages <nl> - run : yarn install - - frozen - lockfile - - ignore - engines - - network - timeout 30000 <nl> + run : yarn install - - frozen - lockfile - - ignore - engines - - network - timeout 1000000 <nl> - name : Set webpack version output <nl> id : set - webpack <nl> 
mmm a / . github / workflows / nodejs . yml <nl> ppp b / . github / workflows / nodejs . yml <nl> strategy : <nl> matrix : <nl> - node - version : [ 8 . x , 10 . x , 12 . x , 13 . x , 14 . x ] <nl> + node - version : [ 10 . x , 12 . x , 13 . x , 14 . x ] <nl> os : [ ubuntu - latest , windows - latest , macOS - latest ] <nl> name : Test on node $ { { matrix . node - version } } and $ { { matrix . os } } <nl> 
mmm a / packages / razzle - dev - utils / setPorts . js <nl> ppp b / packages / razzle - dev - utils / setPorts . js <nl> / / Checks if PORT and PORT_DEV are available and suggests alternatives if not <nl> - module . exports = async clientOnly = > { <nl> + module . exports = clientOnly = > { <nl> + return new Promise ( async resolve = > { <nl> + <nl> const port = ( process . env . PORT & & parseInt ( process . env . PORT ) ) | | 3000 ; <nl> const portDev = <nl> ( process . env . PORT_DEV & & parseInt ( process . env . PORT_DEV ) ) | | <nl> @ @ - 13 , 4 + 15 , 9 @ @ module . exports = async clientOnly = > { <nl> process . env . PORT = actualPort ; <nl> process . env . PORT_DEV = actualPortDev ; <nl> + <nl> + resolve ( ) ; <nl> + <nl> + } ) <nl> + <nl> } ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> / / Supress errors to console ( we use our own logger ) <nl> ! disableStartServer & & <nl> new StartServerPlugin ( { <nl> + verbose : false , <nl> name : ' server . js ' , <nl> entryName : ' server ' , <nl> nodeArgs , <nl> 
mmm a / test / tests / razzle - start . test . js <nl> ppp b / test / tests / razzle - start . test . js <nl> } ) ; <nl> child . stdout . on ( ' data ' , data = > { <nl> if ( ! silent ) console . log ( data ) ; <nl> - if ( data . includes ( ' Server - side HMR Enabled ! ' ) ) { <nl> + if ( data . includes ( ' Server - side HMR Enabled ! ' ) & & ! outputTest ) { <nl> shell . exec ( ' sleep 5 ' ) ; <nl> const devServerOutput = shell . exec ( <nl> ' curl - sb - o " " localhost : 3001 / static / js / bundle . js ' <nl> @ @ - 61 , 7 + 61 , 7 @ @ describe ( ' razzle start ' , ( ) = > { <nl> } ) ; <nl> child . stdout . on ( ' data ' , data = > { <nl> if ( ! silent ) console . log ( data ) ; <nl> - if ( data . includes ( ' Server - side HMR Enabled ! ' ) ) { <nl> + if ( data . includes ( ' Server - side HMR Enabled ! ' ) & & ! outputTest ) { <nl> shell . exec ( ' sleep 5 ' ) ; <nl> const devServerOutput = shell . exec ( <nl> ' curl - sb - o " " localhost : 3002 / static / js / bundle . js ' <nl> 
mmm a / packages / razzle - dev - utils / makeLoaderFinder . js <nl> ppp b / packages / razzle - dev - utils / makeLoaderFinder . js <nl> / / Checks if there ' s a loader string in rule . loader matching loaderRegex . <nl> const inLoaderString = <nl> - typeof rule . loader = = = ' string ' & & rule . loader . match ( loaderRegex ) ; <nl> + typeof rule . loader = = = ' string ' & & ( rule . loader . match ( loaderRegex ) | | rule . loader = = = loaderName ) ; <nl> / / Checks if there is an object inside rule . use with loader matching loaderRegex , OR <nl> / / Checks another condition , if rule is not an object , but pure string ( ex : " style - loader " , etc ) <nl> @ @ - 15 , 8 + 15 , 8 @ @ const makeLoaderFinder = loaderName = > rule = > { <nl> rule . use . find ( <nl> loader = > <nl> ( typeof loader . loader = = = ' string ' & & <nl> - loader . loader . match ( loaderRegex ) ) | | <nl> - ( typeof loader = = = ' string ' & & loader . match ( loaderRegex ) ) <nl> + ( loader . loader . match ( loaderRegex ) ) | | rule . loader = = = loaderName ) | | <nl> + ( typeof loader = = = ' string ' & & ( loader . match ( loaderRegex ) | | loader = = = loaderName ) ) <nl> ) ; <nl> return inUseArray | | inLoaderString ; <nl> 
mmm a / packages / razzle - dev - utils / package . json <nl> ppp b / packages / razzle - dev - utils / package . json <nl> " @ babel / code - frame " : " ^ 7 . 8 . 3 " , <nl> " chalk " : " 3 . 0 . 0 " , <nl> + " jest - message - util " : " 26 . 3 . 0 " , <nl> " react - dev - utils " : " 10 . 2 . 0 " , <nl> " react - error - overlay " : " ^ 6 . 0 . 7 " , <nl> " resolve " : " 1 . 17 . 0 " , <nl> 
mmm a / packages / razzle / config / createJestConfig . js <nl> ppp b / packages / razzle / config / createJestConfig . js <nl> const chalk = require ( ' chalk ' ) ; <nl> const jest = require ( ' jest ' ) ; <nl> - const jestMajorVersion = parseInt ( jest . default . getVersion ( ) . split ( ' . ' ) [ 0 ] ) ; <nl> / / first search for setupTests . ts file <nl> / / if . ts file not exists then looks for setupTests . js <nl> function getSetupTestsFilePath ( paths ) { <nl> @ @ - 33 , 7 + 32 , 7 @ @ module . exports = ( <nl> / / TODO : I don ' t know if it ' s safe or not to just use / as path separator <nl> / / in Jest configs . We need help from somebody with Windows to determine this . <nl> - const config = Object . assign ( <nl> + const config = <nl> { <nl> collectCoverageFrom : [ ' src / * * / * . { js , jsx , ts , tsx } ' , ' ! src / * * / * . d . ts ' ] , <nl> @ @ - 61 , 15 + 60 , 9 @ @ module . exports = ( <nl> ' ^ react - native $ ' : ' react - native - web ' , <nl> } , <nl> moduleFileExtensions : [ ' js ' , ' jsx ' , ' json ' , ' ts ' , ' tsx ' ] , <nl> - } , <nl> - jestMajorVersion > = 24 <nl> - ? { <nl> - setupFilesAfterEnv : setupTestsFile ? [ setupTestsFile ] : [ ] , <nl> - } <nl> - : { <nl> - setupTestFrameworkScriptFile : setupTestsFile , <nl> + setupFilesAfterEnv : setupTestsFile ? [ setupTestsFile ] : [ ] <nl> } <nl> - ) ; <nl> + <nl> if ( rootDir ) { <nl> config . rootDir = rootDir ; <nl> } <nl> @ @ - 95 , 11 + 88 , 8 @ @ module . exports = ( <nl> ' transformIgnorePatterns ' , <nl> ' reporters ' , <nl> ' watchPlugins ' , <nl> - ] . concat ( <nl> - jestMajorVersion > = 24 <nl> - ? [ ' setupFilesAfterEnv ' ] <nl> - : [ ' setupTestFrameworkScriptFile ' ] <nl> - ) ; <nl> + ' setupFilesAfterEnv ' <nl> + ] ; <nl> if ( overrides ) { <nl> supportedKeys . forEach ( key = > { <nl> if ( overrides . hasOwnProperty ( key ) ) { <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> } ; <nl> / / We need to tell webpack what to bundle into our Node bundle . <nl> - config . externals = ! razzleOptions . serverLess ? [ nodeExternalsFunc ] : [ ] ; <nl> + config . externals = razzleOptions . buildType ! = = ' serverless ' ? [ nodeExternalsFunc ] : [ ] ; <nl> / / Specify webpack Node . js output path and filename <nl> config . output = { <nl> 
mmm a / packages / create - razzle - app / lib / index . js <nl> ppp b / packages / create - razzle - app / lib / index . js <nl> const branch = ' finch ' ; / / this line auto updates when yarn update - examples is run <nl> const razzlePkg = ` razzle $ { branch = = ' master ' ? ' ' : ' @ ' + branch } ` ; <nl> - const razzleDevUtilsPkg = ` razzle $ { branch = = ' master ' ? ' ' : ' @ ' + branch } ` ; <nl> + const razzleDevUtilsPkg = ` razzle - dev - utils $ { branch = = ' master ' ? ' ' : ' @ ' + branch } ` ; <nl> const officialExamplesApiUrl = ` https : / / api . github . com / repos / jaredpalmer / razzle / contents / examples $ { <nl> branch = = ' master ' ? ' ' : ' ? ref = ' + branch <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> isServer : IS_NODE , <nl> cwd : paths . appPath , <nl> cache : true , <nl> - babelPresetPlugins : razzleOptions . babelPresetPlugins | | [ ] , <nl> - hasModern : ! ! razzleOptions . modern , <nl> + babelPresetPlugins : [ ] , <nl> + hasModern : false , <nl> development : IS_DEV , <nl> hasReactRefresh : shouldUseReactRefresh , <nl> } , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> console . log ( ' Using . babelrc defined in your app root ' ) ; <nl> } <nl> - const hasStaticExportJs = fs . existsSync ( paths . appStaticExportJs + ' . js ' ) ; <nl> + const hasStaticExportJs = fs . existsSync ( paths . appStaticExportJs + ' . js ' ) | | <nl> + fs . existsSync ( paths . appStaticExportJs + ' . jsx ' ) | | <nl> + fs . existsSync ( paths . appStaticExportJs + ' . ts ' ) | | <nl> + fs . existsSync ( paths . appStaticExportJs + ' . tsx ' ) ; <nl> const dotenv = getClientEnv ( <nl> target , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> let webpackOptions = { } ; <nl> - const hasStaticExportJs = fs . existsSync ( paths . appStaticExportJs + ' . js ' ) ; <nl> + const hasStaticExportJs = fs . existsSync ( paths . appStaticExportJs + ' . js ' ) | | <nl> + fs . existsSync ( paths . appStaticExportJs + ' . jsx ' ) | | <nl> + fs . existsSync ( paths . appStaticExportJs + ' . ts ' ) | | <nl> + fs . existsSync ( paths . appStaticExportJs + ' . tsx ' ) ; <nl> const dotenv = getClientEnv ( <nl> target , <nl> 
mmm a / packages / razzle / config / createJestConfig . js <nl> ppp b / packages / razzle / config / createJestConfig . js <nl> / / TODO : I don ' t know if it ' s safe or not to just use / as path separator <nl> / / in Jest configs . We need help from somebody with Windows to determine this . <nl> - const config = <nl> + let config = <nl> { <nl> collectCoverageFrom : [ ' src / * * / * . { js , jsx , ts , tsx } ' , ' ! src / * * / * . d . ts ' ] , <nl> 
mmm a / packages / razzle / config / createJestConfig . js <nl> ppp b / packages / razzle / config / createJestConfig . js <nl> / / TODO : I don ' t know if it ' s safe or not to just use / as path separator <nl> / / in Jest configs . We need help from somebody with Windows to determine this . <nl> - const config = Object . assign ( <nl> + let config = Object . assign ( <nl> { <nl> collectCoverageFrom : [ ' src / * * / * . { js , jsx , ts , tsx } ' , ' ! src / * * / * . d . ts ' ] , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> { <nl> test : / \ . ( js | jsx | mjs | ts | tsx ) $ / , <nl> include : [ paths . appSrc ] . concat ( additionalIncludes ) , <nl> + use : [ { <nl> loader : require . resolve ( ' . / babel - loader / razzle - babel - loader ' ) , <nl> options : { <nl> isServer : IS_NODE , <nl> @ @ - 531 , 6 + 532 , 7 @ @ module . exports = ( <nl> development : IS_DEV , <nl> hasReactRefresh : shouldUseReactRefresh , <nl> } , <nl> + } ] <nl> } , <nl> ] <nl> : [ <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> } ) , <nl> webpackMajor = = = 5 ? null : new webpack . HashedModuleIdsPlugin ( ) , <nl> new webpack . optimize . AggressiveMergingPlugin ( ) , <nl> - new CopyPlugin ( [ <nl> + new CopyPlugin ( { <nl> + patterns : [ <nl> { <nl> from : paths . appPublic + ' / * * / * ' , <nl> to : paths . appBuild , <nl> context : paths . appPath , <nl> } , <nl> - ] ) , <nl> + ] <nl> + } ) , <nl> ] . filter ( x = > x ) ; <nl> config . optimization = { <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> new CopyPlugin ( { <nl> patterns : [ <nl> { <nl> - from : paths . appPublic + ' / * * / * ' , <nl> + from : paths . appPublic . replace ( / \ \ / g , ' / ' ) + ' / * * / * ' , <nl> to : paths . appBuild , <nl> context : paths . appPath , <nl> } , <nl> 
mmm a / website / pages / static - export . mdx <nl> ppp b / website / pages / static - export . mdx <nl> behind the scenes razzle calls ` render ` function that exposed from ` static_export ` module and saves ` html ` string that you pass to ` res . json ( ) ` into a html file . for ` req ` object there is only one property that is ` url ` which contains the url that we are going to render and save it ' s result to the html file . <nl> html file destination is relative to the ` req . url ` , for example if the url is ` / product / A ` html is going to get saved at ` / build / product / A / index . html ` . <nl> - you should call ` renderToString ( ) ` ( or what ever your framework gives you to do SSR ) in this function send resonse to ` res . json ( ) ` <nl> + you should call ` renderToString ( ) ` ( or what ever your framework gives you to do SSR ) in this function and then send result to ` res . json ( ) ` <nl> ` ` ` js <nl> export const render = ( req , res ) = > { <nl> @ @ - 64 , 12 + 64 , 12 @ @ export const render = ( req , res ) = > { <nl> } ; <nl> ` ` ` <nl> - ( you can re - export your ssr logic from server . js file and use it ` static_export ` ) <nl> + ( you can re - export your SRR logic from server . js file and use it ` static_export ` ) <nl> # # # # routes ( ) <nl> - you should also export a function called ` routes ` that returns an array of strings or a promise that will resolve array of strings . razzle will take the urls one by one and pass them one by one to ` render ` . <nl> - you should get all paths that your app has from your CMS in this method and return it at the end : <nl> + you should also export a function called ` routes ` that returns an array of strings or a promise that will resolve array of strings . razzle will take the urls and will pass them one by one to ` render ` . <nl> + you should get all paths that your app has from your CMS in this method and then return it : <nl> ` ` ` js <nl> export const routes = async ( ) = > { <nl> @ @ - 81 , 8 + 81 , 8 @ @ export const routes = async ( ) = > { <nl> # # # # page data <nl> - you may also need to save the data that your page uses to rehydrate the app on the client side . <nl> - you can also pass the ` data ` along the ` html ` to ` res . json ( { html , data } ) ` and contents of data object will go inside the ` page - data . json ` file next to the html file . <nl> + you may also need to save the data that your page uses to re - hydrate the app on the client side . <nl> + you can pass the ` data ` along the ` html ` to ` res . json ( { html , data } ) ` and contents of ` data ` object will get saved in the ` page - data . json ` next to the related ` index . html ` file . <nl> ` ` ` js <nl> export const render = async ( req , res ) = > { <nl> @ @ - 98 , 7 + 98 , 7 @ @ export const render = async ( req , res ) = > { <nl> } ; <nl> ` ` ` <nl> - ( you should also change how your app fetches data on client - side , so it reads data from ` page - data . json ` ) <nl> + ( NOTE : you should change how your app fetches data on client - side , to read data from ` page - data . json ` ) <nl> # # TypeScript Support <nl> 
mmm a / packages / razzle / package . json <nl> ppp b / packages / razzle / package . json <nl> " dependencies " : { <nl> " @ babel / core " : " 7 . 11 . 1 " , <nl> - " @ babel / plugin - syntax - bigint " : " 7 . 8 . 3 " , <nl> " @ pmmmwh / react - refresh - webpack - plugin " : " 0 . 3 . 0 " , <nl> " assets - webpack - plugin " : " 3 . 9 . 12 " , <nl> " babel - core " : " ^ 7 . 0 . 0 - bridge . 0 " , <nl> " babel - loader " : " ^ 8 . 0 . 6 " , <nl> " babel - plugin - syntax - jsx " : " 6 . 18 . 0 " , <nl> " babel - plugin - transform - define " : " 2 . 0 . 0 " , <nl> - " babel - preset - razzle " : " canary " , <nl> + " babel - preset - razzle " : " latest " , <nl> " chalk " : " ^ 3 . 0 . 0 " , <nl> " copy - webpack - plugin " : " 5 . 1 . 2 " , <nl> " css - loader " : " 3 . 5 . 3 " , <nl> 
mmm a / examples / basic / src / server . js <nl> ppp b / examples / basic / src / server . js <nl> const assets = require ( process . env . RAZZLE_ASSETS_MANIFEST ) ; <nl> + const cssLinksFromAssets = ( assets , entrypoint ) = > { <nl> + return assets . entrypoints [ entrypoint ] ? assets . entrypoints [ entrypoint ] . css ? <nl> + assets . entrypoints [ entrypoint ] . css . map ( asset = > <nl> + ` < link rel = " stylesheet " href = " $ { asset } " > ` <nl> + ) . join ( ' ' ) : ' ' : ' ' ; <nl> + } ; <nl> + } ; <nl> + const jsScriptTagsFromAssets = ( assets , entrypoint , extra = ' ' ) = > { <nl> + return assets . entrypoints [ entrypoint ] ? assets . entrypoints [ entrypoint ] . js ? <nl> + assets . entrypoints [ entrypoint ] . js . map ( asset = > <nl> + ` < script src = " $ { asset } " $ { extra } > < / script > ` <nl> + ) . join ( ' ' ) : ' ' : ' ' ; <nl> + } ; <nl> + <nl> export const renderApp = ( req , res ) = > { <nl> const markup = renderToString ( < App / > ) ; <nl> @ @ - 17 , 15 + 31 , 11 @ @ export const renderApp = ( req , res ) = > { <nl> < meta charSet = ' utf - 8 ' / > <nl> < title > Welcome to Razzle < / title > <nl> < meta name = " viewport " content = " width = device - width , initial - scale = 1 " > <nl> - $ { <nl> - assets . client . css <nl> - ? ` < link rel = " stylesheet " href = " $ { assets . client . css } " > ` <nl> - : ' ' <nl> - } <nl> + $ { cssLinksFromAssets ( assets , ' client ' ) } <nl> < / head > <nl> < body > <nl> < div id = " root " > $ { markup } < / div > <nl> - < script src = " $ { assets . client . js } " defer crossorigin > < / script > <nl> + $ { jsScriptTagsFromAssets ( assets , ' client ' , ' defer crossorigin ' ) } <nl> < / body > <nl> < / html > ` ; <nl> 
mmm a / packages / razzle / config / env . js <nl> ppp b / packages / razzle / config / env . js <nl> / / variable available to users . <nl> RAZZLE_PUBLIC_DIR : <nl> process . env . NODE_ENV = = = ' production ' <nl> - ? paths . appBuildPublic <nl> + ? path . relative ( paths . appPath , paths . appBuildPublic ) <nl> : paths . appPublic , <nl> / / Whether or not react - refresh is enabled . <nl> / / react - refresh is not 100 % stable at this time , <nl> 
mmm a / packages / razzle / package . json <nl> ppp b / packages / razzle / package . json <nl> " @ babel / core " : " 7 . 11 . 1 " , <nl> " @ pmmmwh / react - refresh - webpack - plugin " : " 0 . 3 . 0 " , <nl> + " razzle - start - server - webpack - plugin " : " 4 . 0 . 0 - canary . 4 " , <nl> " babel - jest " : " 26 . 3 . 0 " , <nl> " babel - loader " : " ^ 8 . 0 . 6 " , <nl> " babel - plugin - syntax - jsx " : " 6 . 18 . 0 " , <nl> " babel - preset - razzle " : " 4 . 0 . 0 - canary . 4 " , <nl> " mini - css - extract - plugin " : " ^ 0 . 9 . 0 " , <nl> " razzle - dev - utils " : " 4 . 0 . 0 - canary . 4 " , <nl> - " razzle - start - server - webpack - plugin " : " 4 . 0 . 0 - canary . 4 " , <nl> " webpack - dev - server " : " ^ 3 . 11 . 0 " <nl> } , <nl> " keywords " : [ <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> / / Supress errors to console ( we use our own logger ) <nl> ! disableStartServer & & <nl> new StartServerPlugin ( { <nl> - verbose : false , <nl> + verbose : razzleOptions . verbose , <nl> name : ' server . js ' , <nl> entryName : ' server ' , <nl> nodeArgs , <nl> 
mmm a / packages / razzle / config / loadPlugins . js <nl> ppp b / packages / razzle / config / loadPlugins . js <nl> return [ plugin , { } ] ; <nl> } <nl> - / / Support for not released plugins <nl> - if ( typeof plugin = = = ' object ' ) { <nl> + / / Support for not released plugins without options <nl> + / / Use plugin . object if you need options <nl> + if ( typeof plugin = = = ' object ' & & ! plugin . name & & ! plugin . object ) { <nl> return [ plugin , { } ] ; <nl> } <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> ] . filter ( x = > x ) , <nl> } ) ; <nl> - webpackOptions . fileLoaderExlude = [ <nl> + webpackOptions . fileLoaderExclude = [ <nl> / \ . html $ / , <nl> / \ . ( js | jsx | mjs ) $ / , <nl> / \ . ( ts | tsx ) $ / , <nl> @ @ - 563 , 7 + 563 , 7 @ @ module . exports = ( <nl> ] <nl> ) . concat ( [ <nl> { <nl> - exclude : webpackOptions . fileLoaderExlude , <nl> + exclude : webpackOptions . fileLoaderExclude , <nl> loader : require . resolve ( ' file - loader ' ) , <nl> options : { <nl> name : ` $ { razzleOptions . mediaPrefix } / [ name ] . [ $ { <nl> 
mmm a / examples / with - typescript / src / index . ts <nl> ppp b / examples / with - typescript / src / index . ts <nl> export default express ( ) <nl> . use ( ( req , res ) = > app . handle ( req , res ) ) <nl> - . listen ( port , ( err : Error ) = > { <nl> - if ( err ) { <nl> - console . error ( err ) ; <nl> - return ; <nl> - } <nl> + . listen ( port , ( ) = > { <nl> console . log ( ` > App started http : / / localhost : $ { port } ` ) <nl> } ) ; <nl> 
mmm a / packages / razzle / config / paths . js <nl> ppp b / packages / razzle / config / paths . js <nl> / / Make sure any symlinks in the project folder are resolved : <nl> / / https : / / github . com / facebookincubator / create - react - app / issues / 637 <nl> - const appDirectory = fs . realpathSync ( process . env . RAZZLE_APP_PATH | | process . cwd ( ) ) ; <nl> + const appDirectory = fs . realpathSync ( path . join ( process . cwd ( ) , process . env . RAZZLE_APP_PATH | | ' ' ) ) ; <nl> const resolveApp = relativePath = > path . resolve ( appDirectory , relativePath ) ; <nl> const envPublicUrl = process . env . PUBLIC_URL ; <nl> 
mmm a / packages / razzle / scripts / start . js <nl> ppp b / packages / razzle / scripts / start . js <nl> / / Delete assets . json to always have a manifest up to date <nl> fs . removeSync ( paths . appAssetsManifest ) ; <nl> - const clientCompiler = compile ( clientConfig ) ; <nl> + const clientCompiler = compile ( clientConfig , verbose ) ; <nl> let serverCompiler ; <nl> let serverConfig ; <nl> @ @ - 79 , 7 + 79 , 7 @ @ function main ( ) { <nl> plugins , <nl> razzleOptions <nl> ) ; <nl> - serverCompiler = compile ( serverConfig ) ; <nl> + serverCompiler = compile ( serverConfig , verbose ) ; <nl> } <nl> const port = razzle . port | | clientConfig . devServer . port ; <nl> @ @ - 143 , 7 + 143 , 7 @ @ function main ( ) { <nl> } <nl> / / Webpack compile in a try - catch <nl> - function compile ( config ) { <nl> + function compile ( config , verbose ) { <nl> let compiler ; <nl> try { <nl> compiler = webpack ( config ) ; <nl> 
mmm a / packages / razzle - plugin - scss / package . json <nl> ppp b / packages / razzle - plugin - scss / package . json <nl> " css - loader " : " 5 . 0 . 0 " , <nl> " deepmerge " : " 4 . 2 . 2 " , <nl> - " node - sass - chokidar " : " 1 . 5 . 0 " , <nl> " postcss - flexbugs - fixes " : " 4 . 2 . 1 " , <nl> " postcss - load - config " : " 3 . 0 . 0 " , <nl> " postcss - loader " : " 4 . 0 . 4 " , <nl> " postcss - scss " : " 3 . 0 . 2 " , <nl> " resolve - url - loader " : " 3 . 1 . 2 " , <nl> + " sass " : " ^ 1 . 29 . 0 " , <nl> " sass - loader " : " 10 . 0 . 3 " <nl> } , <nl> " devDependencies " : { <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> / / Anything else that is standard JavaScript within ` node_modules ` <nl> / / can be externalized . <nl> if ( res . match ( / node_modules [ / \ \ ] . * \ . js $ / ) ) { <nl> - const externalRequest = path . posix . join ( <nl> - paths . appPath , <nl> - path <nl> - . relative ( paths . appPath , res ) <nl> - / / Windows path normalization <nl> - . replace ( / \ \ / g , ' / ' ) <nl> - ) ; <nl> if ( debugNodeExternals ) { <nl> - console . log ( ` Externalizing $ { request } as $ { externalRequest } ` ) ; <nl> + console . log ( ` Externalizing $ { request } ( node_modules ) ` ) ; <nl> } <nl> - return callback ( undefined , ` commonjs $ { externalRequest } ` ) ; <nl> + return callback ( undefined , ` commonjs $ { request } ` ) ; <nl> } <nl> if ( debugNodeExternals ) { <nl> 
mmm a / examples / with - devcert - https / razzle . config . js <nl> ppp b / examples / with - devcert - https / razzle . config . js <nl> module . exports = { <nl> - modifyWebpackConfig ( opts ) { <nl> + modifyWebpackOptions ( opts ) { <nl> const options = opts . webpackOptions ; <nl> - <nl> return new Promise ( async ( resolve ) = > { <nl> const httpsCredentials = await devcert . certificateFor ( ' localhost ' ) ; <nl> + const stringHttpsCredentials = { <nl> + key : httpsCredentials . key . toString ( ) , <nl> + cert : httpsCredentials . cert . toString ( ) <nl> + } ; <nl> if ( opts . env . target = = = ' node ' & & opts . env . dev ) { <nl> - options . definePluginOptions . HTTPS_CREDENTIALS = JSON . stringify ( httpsCredentials ) ; <nl> + options . definePluginOptions . HTTPS_CREDENTIALS = JSON . stringify ( stringHttpsCredentials ) ; <nl> } <nl> if ( opts . env . target = = = ' web ' & & opts . env . dev ) { <nl> options . HTTPS_CREDENTIALS = httpsCredentials ; <nl> 
mmm a / examples / with - devcert - https / README . md <nl> ppp b / examples / with - devcert - https / README . md <nl> Create and start the example : <nl> ` ` ` bash <nl> - npx create - razzle - app @ canary - - example with - promise - config with - promise - config <nl> + npx create - razzle - app @ canary - - example with - devcert - https with - devcert - https <nl> - cd with - promise - config <nl> + cd with - devcert - https <nl> yarn start <nl> ` ` ` <nl> < ! - - END install generated instructions please keep comment here to allow auto update - - > <nl> @ @ - 29 , 18 + 29 , 30 @ @ Node . js - compatible JavaScript . <nl> ' use strict ' ; <nl> module . exports = { <nl> + modifyWebpackOptions ( opts ) { <nl> + const options = opts . webpackOptions ; <nl> + return new Promise ( async ( resolve ) = > { <nl> + const httpsCredentials = await devcert . certificateFor ( ' localhost ' ) ; <nl> + const stringHttpsCredentials = { <nl> + key : httpsCredentials . key . toString ( ) , <nl> + cert : httpsCredentials . cert . toString ( ) <nl> + } ; <nl> + if ( opts . env . target = = = ' node ' & & opts . env . dev ) { <nl> + options . definePluginOptions . HTTPS_CREDENTIALS = JSON . stringify ( stringHttpsCredentials ) ; <nl> + } <nl> + if ( opts . env . target = = = ' web ' & & opts . env . dev ) { <nl> + options . HTTPS_CREDENTIALS = httpsCredentials ; <nl> + } <nl> + resolve ( options ) ; <nl> + } ) ; <nl> + } , <nl> modifyWebpackConfig ( opts ) { <nl> const config = opts . webpackConfig ; <nl> - <nl> - return new Promise ( ( resolve ) = > { <nl> - setTimeout ( ( ) = > { <nl> - / / Change the name of the server output file in production <nl> - if ( opts . env . target = = = ' node ' & & ! opts . env . dev ) { <nl> - config . output . filename = ' custom . js ' ; <nl> + const options = opts . webpackOptions ; <nl> + if ( opts . env . target = = = ' web ' & & opts . env . dev ) { <nl> + config . devServer . https = options . HTTPS_CREDENTIALS ; <nl> } <nl> - resolve ( config ) ; <nl> - } , 10 ) ; <nl> - } ) ; <nl> + return config ; <nl> } , <nl> } ; <nl> 
mmm a / packages / razzle / scripts / start . js <nl> ppp b / packages / razzle / scripts / start . js <nl> / / Otherwise , create a new watcher for our server code . <nl> watching = serverCompiler . watch ( <nl> { <nl> - quiet : true , <nl> + quiet : ! verbose , <nl> stats : ' none ' , <nl> } , <nl> / * eslint - disable no - unused - vars * / <nl> 
mmm a / examples / with - devcert - https / razzle . config . js <nl> ppp b / examples / with - devcert - https / razzle . config . js <nl> module . exports = { <nl> - modifyWebpackOptions ( opts ) { <nl> - const options = opts . webpackOptions ; <nl> + modifyOptions ( opts ) { / / use modifyOptions so certificateFor is called once <nl> + const options = opts . options . razzleOptions ; <nl> return new Promise ( async ( resolve ) = > { <nl> const httpsCredentials = await devcert . certificateFor ( ' localhost ' ) ; <nl> const stringHttpsCredentials = { <nl> key : httpsCredentials . key . toString ( ) , <nl> cert : httpsCredentials . cert . toString ( ) <nl> } ; <nl> - if ( opts . env . target = = = ' node ' & & opts . env . dev ) { <nl> - options . definePluginOptions . HTTPS_CREDENTIALS = JSON . stringify ( stringHttpsCredentials ) ; <nl> - } <nl> - if ( opts . env . target = = = ' web ' & & opts . env . dev ) { <nl> - options . HTTPS_CREDENTIALS = httpsCredentials ; <nl> - } <nl> + options . HTTPS_CREDENTIALS = stringHttpsCredentials ; <nl> resolve ( options ) ; <nl> } ) ; <nl> } , <nl> + modifyWebpackOptions ( opts ) { <nl> + const options = opts . options . razzleOptions ; <nl> + if ( opts . env . target = = = ' node ' & & opts . env . dev ) { <nl> + options . definePluginOptions . HTTPS_CREDENTIALS = JSON . stringify ( options . HTTPS_CREDENTIALS ) ; <nl> + } <nl> + return options ; <nl> + } , <nl> modifyWebpackConfig ( opts ) { <nl> - const config = opts . webpackConfig ; <nl> - const options = opts . webpackOptions ; <nl> + const config = opts . options . webpackConfig ; <nl> + const options = opts . options . razzleOptions ; <nl> if ( opts . env . target = = = ' web ' & & opts . env . dev ) { <nl> config . devServer . https = options . HTTPS_CREDENTIALS ; <nl> } <nl> 
mmm a / packages / razzle / config / loadRazzleConfig . js <nl> ppp b / packages / razzle / config / loadRazzleConfig . js <nl> } <nl> } <nl> + setupEnvironment ( paths ) ; <nl> + <nl> let razzleOptions = merge ( defaultRazzleOptions , razzle . options | | { } ) ; <nl> if ( packageJson . browserslist ) { <nl> @ @ - 91 , 8 + 93 , 6 @ @ module . exports = ( webpackObject , razzleConfig , packageJsonIn ) = > { <nl> } ) ; <nl> } <nl> - setupEnvironment ( paths ) ; <nl> - <nl> resolve ( { <nl> razzle , <nl> razzleOptions , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> disableDotRule : true , <nl> } , <nl> host : dotenv . raw . HOST , <nl> + publicPath : clientPublicPath , <nl> hot : true , <nl> noInfo : true , <nl> overlay : false , <nl> @ @ - 890 , 7 + 891 , 6 @ @ module . exports = ( <nl> if ( IS_DEV ) { <nl> config . devServer . contentBase = paths . appPublic ; <nl> config . devServer . watchContentBase = true ; <nl> - config . devServer . publicPath = ' / ' ; <nl> } <nl> config . plugins = [ <nl> 
mmm a / examples / with - monorepo / package . json <nl> ppp b / examples / with - monorepo / package . json <nl> " license " : " MIT " , <nl> " scripts " : { <nl> - " start - 1 " : " RAZZLE_APP_PATH = basic - 1 razzle start " , <nl> - " build - 1 " : " RAZZLE_APP_PATH = basic - 1 razzle build " , <nl> - " test - 1 " : " RAZZLE_APP_PATH = basic - 1 razzle test - - env = jsdom " , <nl> - " start : prod - 1 " : " RAZZLE_APP_PATH = basic - 1 NODE_ENV = production node basic - 1 / build / server . js " , <nl> - " start - 2 " : " RAZZLE_APP_PATH = basic - 2 razzle start " , <nl> - " build - 2 " : " RAZZLE_APP_PATH = basic - 2 razzle build " , <nl> - " test - 2 " : " RAZZLE_APP_PATH = basic - 2 razzle test - - env = jsdom " , <nl> - " start : prod - 2 " : " RAZZLE_APP_PATH = basic - 2 NODE_ENV = production node basic - 2 / build / server . js " <nl> + " start - 1 " : " cross - env RAZZLE_APP_PATH = basic - 1 razzle start " , <nl> + " build - 1 " : " cross - env RAZZLE_APP_PATH = basic - 1 razzle build " , <nl> + " test - 1 " : " cross - env RAZZLE_APP_PATH = basic - 1 razzle test - - env = jsdom " , <nl> + " start : prod - 1 " : " cross - env RAZZLE_APP_PATH = basic - 1 NODE_ENV = production node basic - 1 / build / server . js " , <nl> + " start - 2 " : " cross - env RAZZLE_APP_PATH = basic - 2 PORT = 3002 razzle start " , <nl> + " build - 2 " : " cross - env RAZZLE_APP_PATH = basic - 2 PORT = 3002 razzle build " , <nl> + " test - 2 " : " cross - env RAZZLE_APP_PATH = basic - 2 PORT = 3002 razzle test - - env = jsdom " , <nl> + " start : prod - 2 " : " cross - env RAZZLE_APP_PATH = basic - 2 PORT = 3002 NODE_ENV = production node basic - 2 / build / server . js " , <nl> + " start " : " concurrently \ " yarn start - 1 \ " \ " yarn start - 2 \ " " , <nl> + " start : prod " : " concurrently \ " yarn start : prod - 1 \ " \ " yarn start : prod - 2 \ " " , <nl> + " build " : " concurrently \ " yarn build - 1 \ " \ " yarn build - 2 \ " " <nl> } , <nl> " workspaces " : [ <nl> " basic - 1 " , <nl> " basic - 2 " <nl> ] , <nl> " devDependencies " : { <nl> + " concurrently " : " ^ 5 . 3 . 0 " , <nl> + " cross - env " : " ^ 7 . 0 . 3 " , <nl> " razzle " : " 4 . 0 . 0 - canary . 8 " , <nl> " razzle - dev - utils " : " 4 . 0 . 0 - canary . 8 " , <nl> " mini - css - extract - plugin " : " ^ 0 . 9 . 0 " , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> } <nl> } <nl> - if ( clientOnly ) { <nl> + webpackOptions . enableHtmlWebpackPlugin = clientOnly ; <nl> + <nl> webpackOptions . htmlWebpackPluginOptions = Object . assign ( <nl> { } , <nl> { <nl> @ @ - 254 , 7 + 255 , 6 @ @ module . exports = ( <nl> } <nl> : { } <nl> ) ; <nl> - } <nl> webpackOptions . browserslist = razzleOptions . browserslist ; <nl> @ @ - 529 , 7 + 529 , 8 @ @ module . exports = ( <nl> importLoaders : 1 , <nl> modules : { <nl> auto : true , <nl> - exportOnlyLocals : true <nl> + exportOnlyLocals : true , <nl> + localIdentName : ' [ name ] __ [ local ] ___ [ hash : base64 : 5 ] ' , <nl> } , <nl> } , <nl> } , <nl> @ @ - 892 , 7 + 893 , 9 @ @ module . exports = ( <nl> config . devServer . contentBase = paths . appPublic ; <nl> config . devServer . watchContentBase = true ; <nl> } <nl> + } <nl> + if ( webpackOptions . enableHtmlWebpackPlugin ) { <nl> config . plugins = [ <nl> . . . config . plugins , <nl> / / Generates an ` index . html ` file with the < script > injected . <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> modules : { <nl> auto : true , <nl> exportOnlyLocals : true , <nl> - localIdentName : ' [ name ] __ [ local ] ___ [ hash : base64 : 5 ] ' , <nl> + localIdentName : ' [ name ] __ [ local ] ___ [ hash : base64 : 5 ] ' <nl> } , <nl> } , <nl> } , <nl> 
mmm a / packages / razzle / config / babel - loader / razzle - babel - loader . js <nl> ppp b / packages / razzle / config / babel - loader / razzle - babel - loader . js <nl> if ( razzleContext . modifyBabelPreset ) { <nl> presetOptions = razzleContext . modifyBabelPreset ( <nl> merge ( razzleContext . configContext , { <nl> - options : { pluginOptions , presetOptions } <nl> + options : { presetOptions } <nl> } ) <nl> ) ; <nl> } <nl> 
mmm a / packages / razzle / config / jest / babelTransform . js <nl> ppp b / packages / razzle / config / jest / babelTransform . js <nl> const hasBabelRc = fs . existsSync ( paths . appBabelRc ) ; <nl> const config = { <nl> - presets : ! hasBabelRc & & [ require . resolve ( ' babel - preset - razzle ' ) ] , <nl> + presets : ! hasBabelRc ? [ require . resolve ( ' babel - preset - razzle ' ) ] : [ ] , <nl> babelrc : ! ! hasBabelRc , <nl> } ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> additionalAliases <nl> ) , <nl> plugins : [ <nl> - / / TODO : Remove when using webpack 5 <nl> - PnpWebpackPlugin , <nl> - ] , <nl> + webpackMajor ! = = 5 & & PnpWebpackPlugin , <nl> + ] . filter ( x = > x ) , <nl> } , <nl> resolveLoader : { <nl> modules : [ paths . appNodeModules , paths . ownNodeModules ] , <nl> plugins : [ <nl> - / / TODO : Remove when using webpack 5 <nl> - PnpWebpackPlugin . moduleLoader ( module ) , <nl> - ] , <nl> + webpackMajor ! = = 5 & & PnpWebpackPlugin . moduleLoader ( module ) , <nl> + ] . filter ( x = > x ) , <nl> } , <nl> module : { <nl> strictExportPresence : true , <nl> @ @ - 587 , 7 + 585 , 7 @ @ module . exports = ( <nl> ? webpackOptions . nodeExternals : [ webpackOptions . nodeExternals ] ; <nl> / / We need to tell webpack what to bundle into our Node bundle . <nl> - config . externals = ( ! IS_SERVERLESS ? [ nodeExternalsFunc ] : [ ] ) . concat ( webpackOptions . nodeExternals ) ; <nl> + config . externals = ( ! IS_SERVERLESS ? [ nodeExternalsFunc ] : [ ] ) . concat ( nodeExternals ) ; <nl> / / Specify webpack Node . js output path and filename <nl> config . output = { <nl> @ @ - 832 , 7 + 830 , 7 @ @ module . exports = ( <nl> ? webpackOptions . clientExternals : [ webpackOptions . clientExternals ] ; <nl> / / We need to tell webpack what to bundle into our client bundle . <nl> - config . externals = webpackOptions . clientExternals ; <nl> + config . externals = clientExternals ; <nl> / / Specify the client output directory and paths . Notice that we have <nl> / / changed the publiPath to just ' / ' from http : / / localhost : 3001 . This is because <nl> 
mmm a / packages / razzle / config / env . js <nl> ppp b / packages / razzle / config / env . js <nl> ) ; <nl> / / Stringify all values so we can feed into Webpack DefinePlugin <nl> const stringified = Object . keys ( raw ) . reduce ( ( env , key ) = > { <nl> - if ( ! is_dev & & ! options . forceRuntimeEnvVars . includes ( key ) ) { <nl> + if ( ! options . forceRuntimeEnvVars . includes ( key ) | | is_dev ) { <nl> env [ ` process . env . $ { key } ` ] = JSON . stringify ( raw [ key ] ) ; <nl> } <nl> return env ; <nl> 
mmm a / packages / razzle / config / loadPlugins . js <nl> ppp b / packages / razzle / config / loadPlugins . js <nl> return [ plugin . object , plugin . options ] ; <nl> } <nl> - const completePluginNames = [ ` razzle - plugin - $ { plugin . name } ` , ` $ { plugin . name } / razzle - plugin ` ] ; <nl> + const completePluginNames = [ <nl> + ` razzle - plugin - $ { plugin . name } ` , <nl> + ` $ { plugin . name } / razzle - plugin ` , <nl> + plugin . name . includes ( ' / ' ) & & plugin . name <nl> + ] . filter ( Boolean ) ; <nl> / / Try to find the plugin in node_modules <nl> let razzlePlugin = null ; <nl> 
mmm a / packages / razzle - start - server - webpack - plugin / dist / StartServerPlugin . js <nl> ppp b / packages / razzle - start - server - webpack - plugin / dist / StartServerPlugin . js <nl> this . _handleChildError = this . _handleChildError . bind ( this ) ; <nl> this . _handleChildExit = this . _handleChildExit . bind ( this ) ; <nl> this . _handleChildMessage = this . _handleChildMessage . bind ( this ) ; <nl> + this . _handleWebpackExit = this . _handleWebpackExit . bind ( this ) ; <nl> this . worker = null ; <nl> if ( this . options . restartable & & ! options . once ) { <nl> @ @ - 141 , 9 + 142 , 14 @ @ class StartServerPlugin { <nl> _handleChildExit ( code , signal ) { <nl> if ( code ) this . _error ( ' script exited with code ' , code ) ; <nl> - if ( signal & & signal ! = = ' SIGTERM ' ) this . _error ( ' script exited after signal ' , signal ) ; <nl> this . worker = null ; <nl> + if ( signal & & signal ! = = ' SIGTERM ' ) { <nl> + this . _error ( ' script exited after signal ' , signal ) ; <nl> + <nl> + return ; <nl> + } <nl> + <nl> if ( ! this . workerLoaded ) { <nl> this . _error ( ' Script did not load , or HMR failed ; not restarting ' ) ; <nl> @ @ - 161 , 6 + 167 , 12 @ @ class StartServerPlugin { <nl> this . _runWorker ( ) ; <nl> } <nl> + _handleWebpackExit ( ) { <nl> + if ( this . worker ) { <nl> + process . kill ( this . worker . pid , ' SIGINT ' ) ; <nl> + } <nl> + } <nl> + <nl> _handleChildError ( err ) { <nl> this . worker = null ; <nl> } <nl> @ @ - 206 , 11 + 218 , 12 @ @ class StartServerPlugin { <nl> } ) <nl> } ) ; <nl> - worker . once ( ' exit ' , this . _handleChildExit ) ; <nl> - worker . once ( ' error ' , this . _handleChildError ) ; <nl> + worker . on ( ' exit ' , this . _handleChildExit ) ; <nl> + worker . on ( ' error ' , this . _handleChildError ) ; <nl> worker . on ( ' message ' , this . _handleChildMessage ) ; <nl> worker . stdout . on ( ' data ' , this . _worker_info ) ; <nl> worker . stderr . on ( ' data ' , this . _worker_error ) ; <nl> + process . on ( ' SIGINT ' , this . _handleWebpackExit ) ; <nl> this . worker = worker ; <nl> if ( callback ) callback ( ) ; <nl> } <nl> 
mmm a / packages / razzle / scripts / start . js <nl> ppp b / packages / razzle / scripts / start . js <nl> logger . error ( err ) ; <nl> } <nl> } ) ; <nl> + <nl> + [ ' SIGINT ' , ' SIGTERM ' ] . forEach ( sig = > { <nl> + process . on ( sig , ( ) = > { <nl> + clientDevServer . close ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> + <nl> resolve ( ) ; <nl> } <nl> ) ; <nl> 
mmm a / packages / razzle - plugin - scss / index . js <nl> ppp b / packages / razzle - plugin - scss / index . js <nl> options : hasPostCssConfig ( ) <nl> ? undefined <nl> : { postcssOptions : Object . assign ( { } , options . postcss [ constantEnv ] , { <nl> - plugins : ( ) = > options . postcss . plugins , <nl> + plugins : options . postcss . plugins , <nl> } ) } , <nl> } ; <nl> 
mmm a / packages / razzle - plugin - less / index . js <nl> ppp b / packages / razzle - plugin - less / index . js <nl> options : hasPostCssConfig ( ) <nl> ? undefined <nl> : { postcssOptions : Object . assign ( { } , options . postcss [ constantEnv ] , { <nl> - plugins : ( ) = > options . postcss . plugins , <nl> + plugins : options . postcss . plugins , <nl> } ) } , <nl> } ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> . map ( file = > ! file . path . includes ( ' / . ' ) & & file . path ) <nl> . filter ( Boolean ) <nl> . reduce ( ( types , file ) = > { <nl> - console . log ( file ) ; <nl> const fileType = file . slice ( file . lastIndexOf ( ' . ' ) + 1 ) ; <nl> types [ fileType ] = types [ fileType ] | | [ ] ; <nl> types [ fileType ] . push ( file ) ; <nl> 
mmm a / packages / create - razzle - app / lib / index . js <nl> ppp b / packages / create - razzle - app / lib / index . js <nl> loadGitHubExample ( { <nl> projectName : projectName , <nl> example : opts . example , <nl> - } ) . then ( installWithMessageFactory ( opts , true ) ) ; <nl> + } ) . then ( installWithMessageFactory ( opts , true ) ) <nl> + . catch ( function ( err ) { <nl> + throw err ; <nl> + } ) ; <nl> } else if ( / ^ git \ + / . test ( opts . example ) ) { <nl> loadGitExample ( { <nl> projectName : projectName , <nl> example : opts . example , <nl> - } ) . then ( installWithMessageFactory ( opts , true ) ) ; <nl> + } ) . then ( installWithMessageFactory ( opts , true ) ) <nl> + . catch ( function ( err ) { <nl> + throw err ; <nl> + } ) ; <nl> } else if ( / ^ file : / . test ( opts . example ) ) { <nl> const examplePath = path . resolve ( <nl> path . join ( process . cwd ( ) , opts . example . slice ( 5 ) ) <nl> @ @ - 69 , 19 + 75 , 28 @ @ module . exports = function createRazzleApp ( opts ) { <nl> templatePath : examplePath , <nl> projectPath : projectPath , <nl> projectName : projectName , <nl> - } ) . then ( installWithMessageFactory ( opts , true ) ) ; <nl> + } ) . then ( installWithMessageFactory ( opts , true ) ) <nl> + . catch ( function ( err ) { <nl> + throw err ; <nl> + } ) ; <nl> } else { <nl> getOfficialExamples ( ) . then ( officialExamples = > { <nl> if ( officialExamples . includes ( opts . example ) ) { <nl> loadExample ( { <nl> projectName : projectName , <nl> example : opts . example , <nl> - } ) . then ( installWithMessageFactory ( opts , true ) ) ; <nl> + } ) . then ( installWithMessageFactory ( opts , true ) ) <nl> + . catch ( function ( err ) { <nl> + throw err ; <nl> + } ) ; <nl> } else { <nl> loadNpmExample ( { <nl> projectName : projectName , <nl> example : opts . example , <nl> - } ) . then ( installWithMessageFactory ( opts , true ) ) ; <nl> + } ) . then ( installWithMessageFactory ( opts , true ) ) <nl> + . catch ( function ( err ) { <nl> + throw err ; <nl> + } ) ; <nl> } <nl> } ) ; <nl> } <nl> 
mmm a / packages / razzle / package . json <nl> ppp b / packages / razzle / package . json <nl> " dependencies " : { <nl> " @ babel / core " : " 7 . 11 . 1 " , <nl> + " @ babel / plugin - transform - modules - commonjs " : " ^ 7 . 12 . 1 " , <nl> " @ pmmmwh / react - refresh - webpack - plugin " : " 0 . 4 . 3 " , <nl> " babel - jest " : " 26 . 3 . 0 " , <nl> " babel - loader " : " ^ 8 . 0 . 6 " , <nl> " terser - webpack - plugin " : " ^ 2 . 3 . 5 " , <nl> " tiny - async - pool " : " ^ 1 . 1 . 0 " , <nl> " url - loader " : " ^ 2 . 3 . 0 " , <nl> + " webpack " : " ^ 5 . 18 . 0 " , <nl> " webpack - manifest - plugin " : " 3 . 0 . 0 - rc . 0 " , <nl> - " webpackbar " : " ^ 4 . 0 . 0 " <nl> + " webpackbar " : " ^ 5 . 0 . 0 - 3 " <nl> } , <nl> " peerDependencies " : { <nl> " babel - preset - razzle " : " 4 . 0 . 0 - canary . 25 " , <nl> " mini - css - extract - plugin " : " ^ 0 . 9 . 0 " , <nl> " razzle - dev - utils " : " 4 . 0 . 0 - canary . 25 " , <nl> + " webpack " : " 4 | | 5 " , <nl> " webpack - dev - server " : " ^ 3 . 11 . 0 " <nl> } , <nl> " keywords " : [ <nl> 
mmm a / packages / razzle / package . json <nl> ppp b / packages / razzle / package . json <nl> " tiny - async - pool " : " ^ 1 . 1 . 0 " , <nl> " url - loader " : " ^ 2 . 3 . 0 " , <nl> - " webpack " : " ^ 5 . 18 . 0 " , <nl> + " webpack " : " 4 | | 5 " , <nl> " webpack - manifest - plugin " : " 3 . 0 . 0 - rc . 0 " , <nl> - " webpackbar " : " ^ 5 . 0 . 0 - 3 " <nl> + " webpackbar " : " 4 | | 5 " <nl> } , <nl> " peerDependencies " : { <nl> " babel - preset - razzle " : " 4 . 0 . 0 - canary . 25 " , <nl> 
mmm a / examples / with - typeorm - graphql / tsconfig . json <nl> ppp b / examples / with - typeorm - graphql / tsconfig . json <nl> " allowSyntheticDefaultImports " : true , <nl> " experimentalDecorators " : true , <nl> - " strict " : true , <nl> + " emitDecoratorMetadata " : true , <nl> + " strict " : false , <nl> " forceConsistentCasingInFileNames " : true , <nl> " module " : " esnext " , <nl> " moduleResolution " : " node " , <nl> " resolveJsonModule " : true , <nl> " isolatedModules " : true , <nl> - " noEmit " : true , <nl> " jsx " : " react " <nl> } , <nl> " include " : [ " src " ] <nl> 
mmm a / examples / with - typeorm - graphql / babel . config . json <nl> ppp b / examples / with - typeorm - graphql / babel . config . json <nl> " decorators " : { " legacy " : true } , <nl> " parameter - decorator " : true , <nl> + " typescript - metadata " : true , <nl> " class - properties " : { " loose " : true } , <nl> } ] <nl> ] <nl> 
mmm a / packages / razzle - start - server - webpack - plugin / dist / StartServerPlugin . js <nl> ppp b / packages / razzle - start - server - webpack - plugin / dist / StartServerPlugin . js <nl> } <nl> apply ( compiler ) { <nl> - const inject = this . opions . inject ; / / webpack v4 + <nl> + const inject = this . options . inject ; / / webpack v4 + <nl> if ( webpackMajorVersion > = 4 ) { <nl> const plugin = { <nl> 
mmm a / packages / razzle / config / babel - loader / razzle - babel - loader . js <nl> ppp b / packages / razzle / config / babel - loader / razzle - babel - loader . js <nl> isServer : opts . isServer , <nl> isModern : opts . isModern , <nl> hasModern : opts . hasModern , <nl> - supportsStaticESM : opts . supportsStaticESM , <nl> development : opts . development , <nl> shouldUseReactRefresh : opts . shouldUseReactRefresh , <nl> } ; <nl> @ @ - 102 , 7 + 101 , 6 @ @ module . exports = babelLoader . custom ( function ( babel ) { <nl> delete loader . distDir ; <nl> delete loader . isModern ; <nl> delete loader . hasModern ; <nl> - delete loader . supportsStaticESM ; <nl> delete loader . development ; <nl> delete loader . shouldUseReactRefresh ; <nl> return { loader , custom } ; <nl> @ @ - 114 , 7 + 112 , 6 @ @ module . exports = babelLoader . custom ( function ( babel ) { <nl> const isServer = customOptions . isServer ; <nl> const isModern = customOptions . isModern ; <nl> const hasModern = customOptions . hasModern ; <nl> - const supportsStaticESM = customOptions . supportsStaticESM ; <nl> const development = customOptions . development ; <nl> const shouldUseReactRefresh = customOptions . shouldUseReactRefresh ; <nl> @ @ - 137 , 7 + 134 , 6 @ @ module . exports = babelLoader . custom ( function ( babel ) { <nl> presetOptions . caller . isServer = isServer ; <nl> presetOptions . caller . isModern = isModern ; <nl> presetOptions . caller . isDev = development ; <nl> - presetOptions . caller . supportsStaticESM = supportsStaticESM ; <nl> const emitWarning = this . emitWarning . bind ( this ) ; <nl> Object . defineProperty ( presetOptions . caller , ' onWarning ' , { <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> let config = { <nl> / / Set webpack mode : <nl> mode : IS_DEV ? ' development ' : ' production ' , <nl> - / / Set webpack context to the current command ' s directory <nl> - context : process . cwd ( ) , <nl> + / / Set webpack context to the current apps directory <nl> + context : paths . appPath , <nl> / / Specify target ( either ' node ' or ' web ' ) <nl> target : target , <nl> / / Controversially , decide on sourcemaps . <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> if ( IS_DEV ) { <nl> const nodeArgs = [ ' - r ' , require . resolve ( ' source - map - support / register ' ) ] ; <nl> + <nl> + / / Passthrough - - inspect and - - inspect - brk flags ( with optional [ host : port ] value ) to node <nl> + if ( process . env . INSPECT_BRK ) { <nl> + nodeArgs . push ( process . env . INSPECT_BRK ) ; <nl> + } else if ( process . env . INSPECT ) { <nl> + nodeArgs . push ( process . env . INSPECT ) ; <nl> + } <nl> + <nl> webpackOptions . startServerOptions = { <nl> verbose : razzleOptions . verbose , <nl> name : ' server . js ' , <nl> @ @ - 650 , 14 + 658 , 6 @ @ module . exports = ( <nl> require . resolve ( ' razzle - dev - utils / prettyNodeErrors ' ) <nl> ) ; <nl> - / / Passthrough - - inspect and - - inspect - brk flags ( with optional [ host : port ] value ) to node <nl> - if ( process . env . INSPECT_BRK ) { <nl> - nodeArgs . push ( process . env . INSPECT_BRK ) ; <nl> - } else if ( process . env . INSPECT ) { <nl> - nodeArgs . push ( process . env . INSPECT ) ; <nl> - } <nl> - <nl> - <nl> config . plugins = [ <nl> . . . config . plugins , <nl> / / Add hot module replacement <nl> 
mmm a / packages / babel - preset - razzle / index . js <nl> ppp b / packages / babel - preset - razzle / index . js <nl> options [ ' preset - react ' ] | | { } <nl> ) , <nl> ] , <nl> - [ <nl> + options [ ' preset - typescript ' ] ! = = false & & [ <nl> require ( ' @ babel / preset - typescript ' ) , <nl> Object . assign ( <nl> { allowNamespaces : true } , <nl> options [ ' preset - typescript ' ] | | { } <nl> ) , <nl> ] , <nl> - ] , <nl> + ] . filter ( Boolean ) , <nl> plugins : [ <nl> ( options [ ' preset - env ' ] | | { } ) . runtime ! = = ' automatic ' & & [ <nl> require ( ' . / babel - plugins / jsx - pragma ' ) , <nl> @ @ - 111 , 12 + 111 , 12 @ @ module . exports = function ( api , options ) { <nl> require ( ' @ babel / plugin - proposal - decorators ' ) , <nl> options [ ' decorators ' ] <nl> ] , <nl> - options [ ' parameter - decorator ' ] & & <nl> - require ( ' babel - plugin - parameter - decorator ' ) , <nl> [ <nl> require ( ' @ babel / plugin - proposal - class - properties ' ) , <nl> options [ ' class - properties ' ] | | { } , <nl> ] , <nl> + options [ ' parameter - decorator ' ] & & <nl> + require ( ' babel - plugin - parameter - decorator ' ) , <nl> [ <nl> require ( ' @ babel / plugin - proposal - object - rest - spread ' ) , <nl> { <nl> 
mmm a / packages / razzle / config / loadPlugins . js <nl> ppp b / packages / razzle / config / loadPlugins . js <nl> break ; <nl> } <nl> } <nl> - <nl> if ( ! razzlePlugin ) { <nl> - throw new Error ( ` Unable to find ' $ { completePluginName [ 0 ] } ' or ' $ { completePluginName [ 1 ] } ' ` ) ; <nl> + const last = completePluginNames . pop ( ) ; <nl> + throw new Error ( ` Unable to find ' $ { completePluginNames . join ( " ' , ' " ) } ' or $ { last } ' ` ) ; <nl> } <nl> return [ razzlePlugin , plugin . options ] ; <nl> 
mmm a / packages / babel - preset - razzle / package . json <nl> ppp b / packages / babel - preset - razzle / package . json <nl> " @ babel / core " : " 7 . 11 . 1 " , <nl> " @ babel / plugin - proposal - class - properties " : " ^ 7 . 8 . 3 " , <nl> - " @ babel / plugin - proposal - decorators " : " ^ 7 . 12 . 12 " , <nl> " @ babel / plugin - proposal - nullish - coalescing - operator " : " 7 . 10 . 4 " , <nl> " @ babel / plugin - proposal - numeric - separator " : " 7 . 10 . 4 " , <nl> " @ babel / plugin - proposal - object - rest - spread " : " ^ 7 . 9 . 5 " , <nl> " @ babel / preset - typescript " : " ^ 7 . 9 . 0 " , <nl> " @ babel / runtime " : " ^ 7 . 9 . 2 " , <nl> " babel - plugin - dynamic - import - node " : " 2 . 3 . 3 " , <nl> - " babel - plugin - parameter - decorator " : " ^ 1 . 0 . 16 " , <nl> " babel - plugin - syntax - jsx " : " ^ 6 . 18 . 0 " , <nl> " babel - plugin - transform - react - remove - prop - types " : " 0 . 4 . 24 " , <nl> " chalk " : " ^ 4 . 1 . 0 " <nl> 
mmm a / packages / babel - preset - razzle / babel - plugins / commonjs . js <nl> ppp b / packages / babel - preset - razzle / babel - plugins / commonjs . js <nl> - module . exports = function ( ) { <nl> + module . exports = function ( api , options , dirname ) { <nl> const commonjs = commonjsPlugin . default ( api , options , dirname ) ; <nl> return { <nl> visitor : { <nl> 
mmm a / packages / razzle / config / loadPlugins . js <nl> ppp b / packages / razzle / config / loadPlugins . js <nl> return [ plugin . object , plugin . options ] ; <nl> } <nl> - const isScopedPlugin = plugin . name . includes ( ' / ' ) ; <nl> + const isScopedPlugin = plugin . name . startsWith ( ' @ ' ) & & plugin . name . includes ( ' / ' ) ; <nl> let scope ; <nl> let scopedPluginName ; <nl> if ( isScopedPlugin ) { <nl> 
mmm a / packages / razzle / scripts / build . js <nl> ppp b / packages / razzle / scripts / build . js <nl> console . log ( ) ; <nl> } , <nl> err = > { <nl> - printErrors ( ' Failed to compile . ' , err , verbose ) ; <nl> + printErrors ( ' Failed to compile . ' , [ err ] , verbose ) ; <nl> process . exit ( 1 ) ; <nl> } <nl> ) ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> minimize : true , <nl> minimizer : [ <nl> new TerserPlugin ( webpackOptions . terserPluginOptions ) , <nl> + new CssMinimizerPlugin ( { <nl> + sourceMap : true , <nl> + minify : async ( data , inputMap ) = > { <nl> + / / eslint - disable - next - line global - require <nl> + const CleanCSS = require ( ' clean - css ' ) ; <nl> + <nl> + const [ [ filename , input ] ] = Object . entries ( data ) ; <nl> + const minifiedCss = await new CleanCSS ( { sourceMap : true } ) . minify ( { <nl> + [ filename ] : { <nl> + styles : input , <nl> + sourceMap : inputMap , <nl> + } , <nl> + } ) ; <nl> + return { <nl> + css : minifiedCss . styles , <nl> + map : minifiedCss . sourceMap . toJSON ( ) , <nl> + warnings : minifiedCss . warnings , <nl> + } ; <nl> + } , <nl> + } ) <nl> ] , <nl> } <nl> } <nl> 
mmm a / packages / razzle - plugin - less / index . js <nl> ppp b / packages / razzle - plugin - less / index . js <nl> / / XXX Source maps are required for the resolve - url - loader to properly <nl> / / function . Disable them in later stages if you do not want source maps . <nl> sourceMap : true , <nl> - sourceMapContents : false , <nl> lessOptions : { <nl> includePaths : [ paths . appNodeModules ] , <nl> } , <nl> 
mmm a / packages / razzle / scripts / build . js <nl> ppp b / packages / razzle / scripts / build . js <nl> const cliArgs = mri ( argv ) ; <nl> const nodeEnv = cliArgs [ ' node - env ' ] | | ' production ' ; <nl> + const mode = cliArgs [ ' - - watch ' ] ? ' watch ' : ' run ' ; <nl> / / Do this as the first thing so that any code reading it knows the right env . <nl> process . env . NODE_ENV = / production | staging $ / . test ( nodeEnv ) ? nodeEnv : ' production ' ; <nl> @ @ - 216 , 9 + 217 , 7 @ @ loadRazzleConfig ( webpack ) . then ( <nl> ) ; <nl> console . log ( ` Compiling server $ { buildName } build . . . \ n ` ) ; <nl> - / / First compile the server . We need it to properly output assets . json ( asset <nl> - / / manifest ) and chunks . json ( chunk manifest ) files with the correct hashes on file names BEFORE we can start <nl> - / / the server compiler . <nl> + <nl> compile ( serverConfig , ( err , serverStats ) = > { <nl> if ( err ) { <nl> return reject ( err ) ; <nl> 
mmm a / packages / razzle - dev - utils / webpackHotDevClient . js <nl> ppp b / packages / razzle - dev - utils / webpackHotDevClient . js <nl> var url = require ( ' url ' ) ; <nl> var createSocketUrl = require ( ' webpack - dev - server / client / utils / createSocketUrl ' ) ; <nl> var launchEditorEndpoint = require ( ' react - dev - utils / launchEditorEndpoint ' ) ; <nl> - var formatWebpackMessages = require ( ' razzle - dev - utils / formatWebpackMessages ' ) ; <nl> + var formatWebpackMessages = require ( ' . / formatWebpackMessages ' ) ; <nl> var ErrorOverlay = require ( ' react - error - overlay ' ) ; <nl> var socketUrl = createSocketUrl ( ) ; <nl> 
mmm a / packages / create - razzle - app / package . json <nl> ppp b / packages / create - razzle - app / package . json <nl> " axios " : " ^ 0 . 19 . 2 " , <nl> " chalk " : " ^ 3 . 0 . 0 " , <nl> - " commander " : " ^ 5 . 0 . 0 " , <nl> - " cross - spawn " : " ^ 7 . 0 . 1 " , <nl> " execa " : " 5 . 0 . 0 " , <nl> " fs - extra " : " 9 . 1 . 0 " , <nl> - " mkdirp - then " : " ^ 1 . 2 . 0 " , <nl> " ms " : " ^ 2 . 1 . 2 " , <nl> - " mz " : " ^ 2 . 7 . 0 " , <nl> " ora " : " ^ 4 . 0 . 3 " , <nl> " pacote " : " ^ 11 . 1 . 8 " , <nl> " promise " : " ^ 8 . 1 . 0 " , <nl> 
mmm a / packages / babel - preset - razzle / package . json <nl> ppp b / packages / babel - preset - razzle / package . json <nl> " @ babel / plugin - syntax - dynamic - import " : " ^ 7 . 8 . 3 " , <nl> " @ babel / plugin - transform - modules - commonjs " : " 7 . 10 . 4 " , <nl> - " @ babel / plugin - transform - react - jsx - source " : " ^ 7 . 9 . 0 " , <nl> " @ babel / plugin - transform - runtime " : " ^ 7 . 9 . 0 " , <nl> " @ babel / preset - env " : " ^ 7 . 9 . 5 " , <nl> " @ babel / preset - react " : " ^ 7 . 9 . 4 " , <nl> " @ babel / preset - typescript " : " ^ 7 . 9 . 0 " , <nl> " @ babel / runtime " : " ^ 7 . 9 . 2 " , <nl> - " babel - plugin - dynamic - import - node " : " 2 . 3 . 3 " , <nl> " babel - plugin - syntax - jsx " : " ^ 6 . 18 . 0 " , <nl> " babel - plugin - transform - react - remove - prop - types " : " 0 . 4 . 24 " , <nl> " chalk " : " ^ 4 . 1 . 0 " <nl> 
mmm a / packages / create - razzle - app / lib / utils / copy - dir . js <nl> ppp b / packages / create - razzle - app / lib / utils / copy - dir . js <nl> return new Promise ( function ( resolve , reject ) { <nl> const stopCopySpinner = output . wait ( ' Copying files ' ) ; <nl> - copy ( templatePath , projectPath ) <nl> + copy ( templatePath , projectPath , { dot : true } ) <nl> . then ( function ( ) { <nl> return fs <nl> . pathExists ( path . resolve ( projectPath , ' . / gitignore ' ) ) <nl> 
mmm a / packages / create - razzle - app / package . json <nl> ppp b / packages / create - razzle - app / package . json <nl> " axios " : " ^ 0 . 19 . 2 " , <nl> " chalk " : " ^ 3 . 0 . 0 " , <nl> - " commander " : " ^ 7 . 1 . 0 " , <nl> + " commander " : " 5 . 0 . 0 " , <nl> " execa " : " 5 . 0 . 0 " , <nl> " fs - extra " : " 9 . 1 . 0 " , <nl> " ms " : " ^ 2 . 1 . 2 " , <nl> 
mmm a / packages / create - razzle - app / lib / utils / install . js <nl> ppp b / packages / create - razzle - app / lib / utils / install . js <nl> const args = [ ' install ' , ' - - save ' , ' - - save - exact ' ] ; <nl> return args . concat ( packages , [ ' - - verbose ' ] ) ; <nl> } else if ( cmd . cmd = = = ' yarn ' ) { <nl> - const args = [ ' add ' ] ; <nl> + const args = [ ' add ' , ' - W ' ] ; <nl> return args . concat ( packages , <nl> parseInt ( cmd . version [ 0 ] ) ! = = 2 ? [ ' - - ignore - engines ' ] : [ ] ) ; <nl> } <nl> 
mmm a / packages / create - razzle - app / lib / index . js <nl> ppp b / packages / create - razzle - app / lib / index . js <nl> return install ( { <nl> npm : opts . npm , <nl> yarn : opts . yarn , <nl> + verbose : opts . verbose , <nl> projectName : projectName , <nl> projectPath : projectPath , <nl> packages : isExample <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> ls ~ / . npmrc > / dev / null 2 > & 1 & & \ <nl> [ [ $ ( git describe - - exact - match 2 > / dev / null | | : ) = ~ - canary ] ] ; \ <nl> then <nl> - yarn run lerna publish from - git - - npm - tag canary - - yes <nl> + yarn run lerna publish from - git - - no - verify - access - - npm - tag canary - - yes <nl> else <nl> echo " Did not publish canary " <nl> fi <nl> @ @ - 42 , 7 + 42 , 7 @ @ jobs : <nl> ls ~ / . npmrc > / dev / null 2 > & 1 & & \ <nl> [ [ ! $ ( git describe - - exact - match 2 > / dev / null | | : ) = ~ - canary ] ] ; \ <nl> then <nl> - yarn run lerna publish from - git - - yes <nl> + yarn run lerna publish from - git - - no - verify - access - - yes <nl> else <nl> echo " Did not publish " <nl> fi <nl> 
mmm a / packages / create - razzle - app / templates / default / package . json <nl> ppp b / packages / create - razzle - app / templates / default / package . json <nl> " babel - preset - razzle " : " 4 . 0 . 1 " , <nl> " razzle - dev - utils " : " 4 . 0 . 1 " , <nl> + " html - webpack - plugin " : " ^ 4 . 5 . 2 " , <nl> " webpack " : " ^ 4 . 44 . 1 " , <nl> " mini - css - extract - plugin " : " ^ 0 . 9 . 0 " , <nl> " webpack - dev - server " : " ^ 3 . 11 . 2 " <nl> 
mmm a / packages / razzle / scripts / start . js <nl> ppp b / packages / razzle / scripts / start . js <nl> const chalk = require ( ' chalk ' ) ; <nl> const terminate = require ( ' terminate ' ) ; <nl> + let verbose = false ; <nl> + <nl> process . once ( ' SIGINT ' , ( ) = > { <nl> + if ( verbose ) { <nl> console . error ( chalk . bgRedBright ( ' SIGINT ' ) , chalk . redBright ( ' exiting . . . ' ) ) ; <nl> + } <nl> terminate ( process . pid , ' SIGINT ' , { timeout : 1000 } , ( ) = > { <nl> + if ( verbose ) { <nl> console . error ( chalk . bgGreen ( ' Goodbye ' ) ) ; <nl> + } <nl> terminate ( process . pid ) ; <nl> } ) ; <nl> } ) ; <nl> @ @ - 37 , 7 + 43 , 7 @ @ function main ( ) { <nl> loadRazzleConfig ( webpack ) <nl> . then ( <nl> async ( { razzle , razzleOptions , webpackObject , plugins , paths } ) = > { <nl> - const verbose = razzleOptions . verbose ; <nl> + verbose = razzleOptions . verbose ; <nl> if ( ! verbose ) { <nl> process . removeAllListeners ( ' warning ' ) ; <nl> } <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> } <nl> if ( razzleOptions . debug . config ) { <nl> console . log ( ` Printing webpack config for $ { target } target ` ) ; <nl> - console . log ( util . inspect ( webpackConfig , { depth : null } ) ) ; <nl> + console . log ( util . inspect ( config , { depth : null } ) ) ; <nl> } <nl> resolve ( config ) ; <nl> } ) ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> webpackOptions . definePluginOptions = dotenv . stringified ; <nl> + webpackOptions . appAssetsManifestPath = paths . appAssetsManifest ; <nl> + <nl> if ( IS_NODE ) { <nl> webpackOptions . jsOutputFilename = ` [ name ] . js ` ; <nl> @ @ - 735 , 7 + 737 , 7 @ @ module . exports = ( <nl> / / Output all files in a manifest file called assets - manifest . json <nl> / / in the build directory . <nl> new ManifestPlugin ( { <nl> - fileName : path . join ( paths . appBuild , ' assets . json ' ) , <nl> + fileName : webpackOptions . appAssetsManifestPath , <nl> writeToFileEmit : true , <nl> generate : ( seed , files ) = > { <nl> const entrypoints = new Set ( ) ; <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> const shouldUseReactRefresh = <nl> IS_WEB & & IS_DEV & & razzleOptions . enableReactRefresh ? true : false ; <nl> - const shouldUseWebpackbar = <nl> - ! razzleOptions . disableWebpackbar | | razzleOptions . disableWebpackbar ! = = target ; <nl> + const shouldDisableWebpackbar = <nl> + razzleOptions . disableWebpackbar = = = true | | razzleOptions . disableWebpackbar = = = target ; <nl> let webpackOptions = { } ; <nl> @ @ - 984 , 7 + 984 , 7 @ @ module . exports = ( <nl> } <nl> } <nl> - if ( IS_DEV & & shouldUseWebpackbar ) { <nl> + if ( IS_DEV & & ! shouldDisableWebpackbar ) { <nl> config . plugins = [ <nl> . . . config . plugins , <nl> new WebpackBar ( { <nl> 
mmm a / packages / razzle / config / env . js <nl> ppp b / packages / razzle / config / env . js <nl> var dotenvFiles = [ <nl> ` $ { paths . dotenv } . $ { NODE_ENV } . local ` , <nl> ` $ { paths . dotenv } . $ { NODE_ENV } ` , <nl> - ` $ { paths . dotenv } . local ` , <nl> + NODE_ENV ! = = ' test ' & & ` $ { paths . dotenv } . local ` , <nl> paths . dotenv , <nl> - ] ; <nl> + ] . filter ( Boolean ) ; <nl> / / Load environment variables from . env * files . Suppress warnings using silent <nl> / / if this file is missing . dotenv will never modify any environment variables <nl> / / that have already been set . Variable expansion is supported in . env files . <nl> 
mmm a / packages / razzle / config / paths . js <nl> ppp b / packages / razzle / config / paths . js <nl> if ( fs . existsSync ( appPackageJson ) ) { <nl> try { <nl> - packageJson = require ( appPackageJson ) <nl> + const packageJson = require ( appPackageJson ) <nl> return packageJson . homepage ; <nl> } catch ( e ) { <nl> clearConsole ( ) ; <nl> 
mmm a / examples / with - loadable - components / package . json <nl> ppp b / examples / with - loadable - components / package . json <nl> " devDependencies " : { <nl> " @ babel / core " : " ^ 7 . 12 . 10 " , <nl> - " @ loadable / babel - plugin " : " ^ 5 . 15 . 0 " , <nl> + " @ loadable / babel - plugin " : " ^ 5 . 13 . 2 " , <nl> " @ loadable / webpack - plugin " : " ^ 5 . 15 . 0 " , <nl> " babel - preset - razzle " : " 4 . 0 . 4 " , <nl> " mini - css - extract - plugin " : " ^ 0 . 9 . 0 " , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> } ) , <nl> ] . filter ( x = > x ) ; <nl> + / / make sure the key exists <nl> + config . optimization = { } ; <nl> + <nl> if ( ! IS_DEV_ENV ) { <nl> config . optimization = { <nl> splitChunks : webpackOptions . splitChunksConfig , <nl> 
mmm a / packages / razzle / config / createConfigAsync . js <nl> ppp b / packages / razzle / config / createConfigAsync . js <nl> server : [ paths . appServerIndexJs ] , <nl> } ; <nl> + / / make sure the key exists <nl> + config . optimization = { } ; <nl> + <nl> if ( IS_PROD ) { <nl> / / Prevent creating multiple chunks for the server <nl> / / in dev mode emitting one huge server file on every save is very slow <nl> 
mmm a / packages / razzle / config / env . js <nl> ppp b / packages / razzle / config / env . js <nl> PORT : process . env . PORT | | options . port | | 3000 , <nl> VERBOSE : ! ! process . env . VERBOSE , <nl> HOST : process . env . HOST | | options . host | | ' localhost ' , <nl> - RAZZLE_ASSETS_MANIFEST : paths . appAssetsManifest , <nl> + RAZZLE_ASSETS_MANIFEST : ! is_dev <nl> + ? path . relative ( paths . appPath , paths . appAssetsManifest ) <nl> + : paths . appAssetsManifest , <nl> BUILD_TARGET : target = = = ' web ' ? ' client ' : ' server ' , <nl> / / only for production builds . Useful if you need to serve from a CDN <nl> PUBLIC_PATH : process . env . PUBLIC_PATH | | ' / ' , <nl> 
mmm a / examples / with - typescript / src / server . tsx <nl> ppp b / examples / with - typescript / src / server . tsx <nl> import React from ' react ' ; <nl> import { renderToString } from ' react - dom / server ' ; <nl> - import { StaticRouter , StaticRouterContext } from ' react - router - dom ' ; <nl> + import { StaticRouterContext } from " react - router " ; <nl> + import { StaticRouter } from ' react - router - dom ' ; <nl> import App from ' . / App ' ; <nl> 
mmm a / packages / razzle - plugin - manifest / index . js <nl> ppp b / packages / razzle - plugin - manifest / index . js <nl> webpackConfig . plugins . push ( <nl> new webpackObject . DefinePlugin ( { <nl> - ' process . env ' : { <nl> - RAZZLE_CHUNKS_MANIFEST : JSON . stringify ( pluginOptions . fileName ) , <nl> - } , <nl> + ' process . env . RAZZLE_CHUNKS_MANIFEST ' : JSON . stringify ( pluginOptions . fileName ) , <nl> } ) <nl> ) ; <nl> 
mmm a / packages / create - razzle - app / lib / index . js <nl> ppp b / packages / create - razzle - app / lib / index . js <nl> projectPath : projectPath , <nl> projectName : projectName , <nl> } ) <nl> - . then ( installWithMessageFactory ( opts ) ) <nl> + . then ( installWithMessageFactory ( opts , true ) ) <nl> . catch ( function ( err ) { <nl> console . error ( ` Failed loading official default example ` ) ; <nl> if ( opts . verbose ) { <nl> 
mmm a / packages / create - razzle - app / templates / default / src / server . js <nl> ppp b / packages / create - razzle - app / templates / default / src / server . js <nl> import React from ' react ' ; <nl> - import { StaticRouter } from ' react - router - dom / server ' ; <nl> + import { StaticRouter } from ' react - router - dom ' ; <nl> import express from ' express ' ; <nl> import { renderToString } from ' react - dom / server ' ; <nl> 
mmm a / packages / create - razzle - app / templates / default / src / App . js <nl> ppp b / packages / create - razzle - app / templates / default / src / App . js <nl> - import { Route , Routes } from ' react - router - dom ' ; <nl> + import { Route , Switch } from ' react - router - dom ' ; <nl> import Home from ' . / Home ' ; <nl> import ' . / App . css ' ; <nl> const App = ( ) = > ( <nl> - < Routes > <nl> + < Switch > <nl> < Route path = " / " element = { < Home / > } / > <nl> - < / Routes > <nl> + < / Switch > <nl> ) ; <nl> export default App ; <nl> 
mmm a / packages / create - razzle - app / templates / default / src / App . js <nl> ppp b / packages / create - razzle - app / templates / default / src / App . js <nl> const App = ( ) = > ( <nl> < Switch > <nl> - < Route path = " / " element = { < Home / > } / > <nl> + < Route exact = { true } path = " / " component = { Home } / > <nl> < / Switch > <nl> ) ; <nl> 
mmm a / examples / basic - serverless / razzle . config . js <nl> ppp b / examples / basic - serverless / razzle . config . js <nl> options : { <nl> buildType : ' iso - serverless ' , <nl> + modifyWebpackConfig ( opts ) { <nl> + const config = opts . webpackConfig ; <nl> + <nl> + if ( opts . env . target = = = ' node ' ) { <nl> + config . plugins . push ( <nl> + new opts . webpackObject . ContextReplacementPlugin ( <nl> + / / we want to replace context <nl> + / express \ / lib / , / / and replace all searches in <nl> + / / express / lib / * <nl> + resolve ( ' node_modules ' ) , / / to look in folder ' node_modules ' <nl> + { / / and return a map <nl> + ' ejs ' : ' ejs ' / / which resolves request for ' ejs ' <nl> + } / / to module ' ejs ' <nl> + ) / / __webpack_require__ ( . . . ) ( mod ) <nl> + / / we set ` mod = ' ejs ' ` <nl> + ) <nl> + } <nl> + <nl> + return config ; <nl> + } , <nl> } <nl> } ; <nl> 
mmm a / examples / with - heroku / package . json <nl> ppp b / examples / with - heroku / package . json <nl> " scripts " : { <nl> " start " : " razzle start " , <nl> - " build " : " razzle build " , <nl> + " build " : " razzle build - - noninteractive " , <nl> " test " : " razzle test - - env = jsdom " , <nl> - " prestart : prod " : " yarn build " , <nl> " start : prod " : " NODE_ENV = production node build / server . js " , <nl> " deploy " : " git push heroku master " <nl> } , <nl> 
mmm a / src / routes / [ slug ] . svelte <nl> ppp b / src / routes / [ slug ] . svelte <nl> < / script > <nl> - < h1 class = " font - medium text - 4xl " > <nl> + < h1 class = " font - medium text - 5xl " > <nl> { metadata . title } <nl> < / h1 > <nl> - < div class = " my - 3 opacity - 75 " > <nl> + < div class = " my - 3 mb - 11 opacity - 75 " > <nl> < p class = " font - semibold text - xs " > Created : { created } < / p > <nl> < p class = " font - semibold text - xs " > Updated : { updated } < / p > <nl> < a <nl> - class = " font - semibold text - xs underline hover : no - underline hover : text - purple - 600 " <nl> + class = " font - semibold text - xs underline hover : no - underline " <nl> href = { ` https : / / github . com / spences10 / cheat - sheets / edit / production / sheets / $ { metadata . slug } . md ` } <nl> > Edit this page on GitHub < / a <nl> > <nl> < / div > <nl> < article class = " mb - 16 prose md : prose - lg lg : prose - xl " > <nl> - < Post / > <nl> + < svelte : component this = { Post } / > <nl> < / article > <nl> 
mmm a / src / lib / og - image - url - build . js <nl> ppp b / src / lib / og - image - url - build . js <nl> const params = Object . entries ( obj ) . map ( <nl> ( [ key , value ] ) = > ` $ { key } = $ { value } ` <nl> ) <nl> - return ' ? ' + params . join ( ' & ' ) <nl> + return ' ? ' + params . join ( ' & amp ; ' ) <nl> } <nl> export const ogImageUrl = ( author , website , title ) = > { <nl> 
mmm a / src / lib / og - image - url - build . js <nl> ppp b / src / lib / og - image - url - build . js <nl> const params = Object . entries ( obj ) . map ( <nl> ( [ key , value ] ) = > ` $ { key } = $ { value } ` <nl> ) <nl> - return ' ? ' + params . join ( ' & amp ; ' ) <nl> + return ' ? ' + params . join ( ' & ' ) <nl> } <nl> export const ogImageUrl = ( author , website , title ) = > { <nl> 
mmm a / sheets / javascript . md <nl> ppp b / sheets / javascript . md <nl> document . getElementsByTagName ( ' html ' ) [ 0 ] . style [ ' font - size ' ] = ' 10px ' <nl> ` ` ` <nl> - # # # Checking for ` window ` <nl> + # # Checking for ` window ` <nl> [ Optional chaining ] ( https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Operators / Optional_chaining ) can not be used on ` window ` . <nl> It will throw an error when used on any undeclared root object , so no escaping the ` typeof window = = ' undefined ' ` check with a clever ` ? . ` . <nl> 
mmm a / typings / index . d . ts <nl> ppp b / typings / index . d . ts <nl> disabled ? : boolean ; <nl> / * * Shorthand for Dimmer . * / <nl> - dimmer : any ; <nl> + dimmer ? : any ; <nl> / * * An image can sit to the left or right of other content . * / <nl> floated ? : SemanticFLOATS ; <nl> 
mmm a / src / modules / Search / Search . js <nl> ppp b / src / modules / Search / Search . js <nl> / * * A search can have its results take up the width of its container . * / <nl> fluid : PropTypes . bool , <nl> + / * * A search input can take up the width of its container . * / <nl> + input : customPropTypes . itemShorthand , <nl> + <nl> size : PropTypes . oneOf ( _meta . props . size ) , <nl> loading : PropTypes . bool , <nl> @ @ - 176 , 6 + 179 , 7 @ @ export default class Search extends Component { <nl> minCharacters : 1 , <nl> noResultsMessage : ' No results found . ' , <nl> showNoResults : true , <nl> + input : ' text ' , <nl> } <nl> static autoControlledProps = [ <nl> @ @ - 508 , 20 + 512 , 20 @ @ export default class Search extends Component { <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> renderSearchInput = ( ) = > { <nl> - const { icon , placeholder } = this . props <nl> + const { icon , placeholder , input } = this . props <nl> const { value } = this . state <nl> return ( <nl> - < Input <nl> - value = { value } <nl> - placeholder = { placeholder } <nl> - onBlur = { this . handleBlur } <nl> - onChange = { this . handleSearchChange } <nl> - onFocus = { this . handleFocus } <nl> - onClick = { this . handleInputClick } <nl> - input = { { className : ' prompt ' , tabIndex : ' 0 ' , autoComplete : ' off ' } } <nl> - icon = { icon } <nl> - / > <nl> + Input . create ( input , { <nl> + value , <nl> + placeholder , <nl> + onBlur : this . handleBlur , <nl> + onChange : this . handleSearchChange , <nl> + onFocus : this . handleFocus , <nl> + onClick : this . handleInputClick , <nl> + input : { className : ' prompt ' , tabIndex : ' 0 ' , autoComplete : ' off ' } , <nl> + icon , <nl> + } ) <nl> ) <nl> } <nl> 
mmm a / src / modules / Modal / index . d . ts <nl> ppp b / src / modules / Modal / index . d . ts <nl> open ? : boolean ; <nl> / * * The node where the modal should mount . . * / <nl> - mountnode ? : any ; <nl> + mountNode ? : any ; <nl> / * * A modal can vary in size * / <nl> size ? : SemanticSIZES ; <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentExample . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentExample . js <nl> import { exampleContext , repoURL } from ' docs / app / utils ' <nl> import { Divider , Grid , Icon , Header , Menu } from ' src ' <nl> import Editor from ' docs / app / Components / Editor / Editor ' <nl> - import babelrc from ' . babelrc ' <nl> const babelConfig = { <nl> - presets : [ . . . babelrc . presets ] , <nl> + presets : [ ' es2015 ' , ' react ' , ' stage - 1 ' ] , <nl> } <nl> const showCodeStyle = { <nl> 
mmm a / src / modules / Dropdown / index . d . ts <nl> ppp b / src / modules / Dropdown / index . d . ts <nl> / * * Shorthand for Icon . * / <nl> icon ? : any ; <nl> + / * * A dropdown can be formatted as a Menu item . * / <nl> + item ? : boolean ; <nl> + <nl> / * * A dropdown can be formatted to appear inline in other content . * / <nl> inline ? : boolean ; <nl> 
mmm a / src / elements / Button / index . d . ts <nl> ppp b / src / elements / Button / index . d . ts <nl> size ? : SemanticSIZES ; <nl> / * * A button can receive focus . * / <nl> - tabIndex : number | string ; <nl> + tabIndex ? : number | string ; <nl> / * * A button can be formatted to toggle on and off . * / <nl> toggle ? : boolean ; <nl> 
mmm a / src / elements / Icon / index . d . ts <nl> ppp b / src / elements / Icon / index . d . ts <nl> } <nl> interface IconComponent extends React . StatelessComponent < IconProps > { <nl> - Content : typeof IconGroup ; <nl> + Group : typeof IconGroup ; <nl> } <nl> export const Icon : IconComponent ; <nl> 
mmm a / docs / app / index . ejs <nl> ppp b / docs / app / index . ejs <nl> dimmer . style . opacity = ' 0 ' <nl> - setTimeout ( ( ) = > { <nl> + setTimeout ( function ( ) { <nl> var dimmer = document . querySelector ( ' # docs - loading - dimmer ' ) <nl> document . body . removeChild ( dimmer ) <nl> 
mmm a / src / collections / Table / index . d . ts <nl> ppp b / src / collections / Table / index . d . ts <nl> export const TableHeader : React . StatelessComponent < TableHeaderProps > ; <nl> interface TableHeaderCellProps extends TableCellProps { <nl> - sorted : ' ascending ' | ' descending ' ; <nl> + sorted ? : ' ascending ' | ' descending ' ; <nl> } <nl> export const TableHeaderCell : React . StatelessComponent < TableHeaderCellProps > ; <nl> 
mmm a / src / elements / Button / index . d . ts <nl> ppp b / src / elements / Button / index . d . ts <nl> / * * Groups can reduce their padding to fit into tighter spaces . * / <nl> compact ? : boolean ; <nl> + / * * Groups can be aligned to the left or right of its container . * / <nl> + floated ? : SemanticFLOATS ; <nl> + <nl> / * * Groups can take the width of their container . * / <nl> fluid ? : boolean ; <nl> 
mmm a / docs / app / Components / Editor / Editor . js <nl> ppp b / docs / app / Components / Editor / Editor . js <nl> / / Component <nl> completions . push ( { caption : name , value : name , meta : ' Component ' } ) <nl> - / / Its props <nl> - _ . each ( component . propTypes , ( val , propName ) = > { <nl> + / / Its props ( propTypes do not exist in prod , use handledProps added by babel ) <nl> + _ . each ( component . handledProps , ( propName ) = > { <nl> / / don ' t add duplicate prop completions <nl> if ( _ . find ( completions , { value : propName } ) ) return <nl> 
mmm a / src / addons / Radio / index . d . ts <nl> ppp b / src / addons / Radio / index . d . ts <nl> + import { CheckboxProps } from ' . . / . . / modules / Checkbox ' ; <nl> - interface RadioProps { <nl> + interface RadioProps extends CheckboxProps { <nl> [ key : string ] : any ; <nl> / * * Format to emphasize the current selection state . * / <nl> 
mmm a / src / modules / Popup / Popup . js <nl> ppp b / src / modules / Popup / Popup . js <nl> trigger : PropTypes . node , <nl> / * * Popup width . * / <nl> - wide : PropTypes . oneOfType ( <nl> + wide : PropTypes . oneOfType ( [ <nl> PropTypes . bool , <nl> PropTypes . oneOf ( [ ' very ' ] ) , <nl> - ) , <nl> + ] ) , <nl> } <nl> static defaultProps = { <nl> 
mmm a / src / views / Card / index . d . ts <nl> ppp b / src / views / Card / index . d . ts <nl> / * * A card can contain an Image component . * / <nl> image ? : any ; <nl> + / * * A card can be formatted to link to other content . * / <nl> + link ? : boolean ; <nl> + <nl> / * * Shorthand for CardMeta . * / <nl> meta ? : any ; <nl> 
mmm a / src / elements / Input / Input . js <nl> ppp b / src / elements / Input / Input . js <nl> ' selected ' , ' defaultValue ' , ' defaultChecked ' , <nl> / / LIMITED HTML PROPS <nl> - ' autoCapitalize ' , ' autoComplete ' , ' autoFocus ' , ' checked ' , ' form ' , ' max ' , ' maxLength ' , ' min ' , <nl> + ' autoCapitalize ' , ' autoComplete ' , ' autoFocus ' , ' checked ' , ' form ' , ' max ' , ' maxLength ' , ' min ' , ' multiple ' , <nl> ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , ' type ' , ' value ' , <nl> / / Heads Up ! <nl> 
mmm a / src / modules / Search / Search . d . ts <nl> ppp b / src / modules / Search / Search . d . ts <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props . <nl> * / <nl> - onBlur : ( event : React . MouseEvent < HTMLElement > , data : SearchProps ) = > void ; <nl> + onBlur ? : ( event : React . MouseEvent < HTMLElement > , data : SearchProps ) = > void ; <nl> / * * <nl> * Called on focus . <nl> @ @ - 88 , 7 + 88 , 7 @ @ interface SearchProps { <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props . <nl> * / <nl> - onFocus : ( event : React . MouseEvent < HTMLElement > , data : SearchProps ) = > void ; <nl> + onFocus ? : ( event : React . MouseEvent < HTMLElement > , data : SearchProps ) = > void ; <nl> / * * <nl> * Called on mousedown . <nl> @ @ - 96 , 7 + 96 , 7 @ @ interface SearchProps { <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props . <nl> * / <nl> - onMouseDown : ( event : React . MouseEvent < HTMLElement > , data : SearchProps ) = > void ; <nl> + onMouseDown ? : ( event : React . MouseEvent < HTMLElement > , data : SearchProps ) = > void ; <nl> / * * <nl> * Called when a result is selected . <nl> @ @ - 104 , 7 + 104 , 7 @ @ interface SearchProps { <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props . <nl> * / <nl> - onResultSelect : ( event : React . MouseEvent < HTMLDivElement > , data : SearchResultProps ) = > void ; <nl> + onResultSelect ? : ( event : React . MouseEvent < HTMLDivElement > , data : SearchResultProps ) = > void ; <nl> / * * <nl> * Called on search input change . <nl> @ @ - 112 , 7 + 112 , 7 @ @ interface SearchProps { <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { string } value - Current value of search input . <nl> * / <nl> - onSearchChange : ( event : React . MouseEvent < HTMLElement > , value : string ) = > void ; <nl> + onSearchChange ? : ( event : React . MouseEvent < HTMLElement > , value : string ) = > void ; <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> / / Style <nl> @ @ - 131 , 7 + 131 , 7 @ @ interface SearchProps { <nl> fluid ? : boolean ; <nl> / * * A search input can take up the width of its container . * / <nl> - input : any ; <nl> + input ? : any ; <nl> / * * A search can show a loading indicator . * / <nl> loading ? : boolean ; <nl> 
mmm a / src / addons / Portal / Portal . js <nl> ppp b / src / addons / Portal / Portal . js <nl> ReactDOM . unstable_renderSubtreeIntoContainer ( <nl> this , <nl> Children . only ( children ) , <nl> - this . rootNode <nl> - ) <nl> - <nl> + this . rootNode , <nl> + ( ) = > { <nl> this . portalNode = this . rootNode . firstElementChild <nl> this . portalNode . addEventListener ( ' mouseleave ' , this . handlePortalMouseLeave ) <nl> this . portalNode . addEventListener ( ' mouseenter ' , this . handlePortalMouseEnter ) <nl> } <nl> + ) <nl> + } <nl> mountPortal = ( ) = > { <nl> if ( ! isBrowser | | this . rootNode ) return <nl> 
mmm a / src / collections / Form / FormField . js <nl> ppp b / src / collections / Form / FormField . js <nl> PropTypes . object , <nl> ] ) , <nl> - / * * A field can show that input is mandatory . Requires a label . * / <nl> - required : customPropTypes . every ( [ <nl> - customPropTypes . demand ( [ ' label ' ] ) , <nl> - PropTypes . bool , <nl> - ] ) , <nl> + / * * A field can show that input is mandatory . * / <nl> + required : PropTypes . bool , <nl> / * * Passed to the control component ( i . e . < input type = ' password ' / > ) * / <nl> type : customPropTypes . every ( [ <nl> 
mmm a / src / modules / Dropdown / Dropdown . d . ts <nl> ppp b / src / modules / Dropdown / Dropdown . d . ts <nl> * @ param { object } defaultLabelProps - The default props for an active item Label . <nl> * @ returns { * } Shorthand for a Label . <nl> * / <nl> - renderLabel ? : ( item : DropdownItemProps , index : number , defaultLabelProps : LabelProps ) = > React . ReactElement < any > ; <nl> + renderLabel ? : ( item : DropdownItemProps , index : number , defaultLabelProps : LabelProps ) = > any ; <nl> / * * A dropdown can have its menu scroll . * / <nl> scrolling ? : boolean ; <nl> @ @ - 225 , 7 + 225 , 7 @ @ export interface DropdownProps { <nl> tabIndex ? : number | string ; <nl> / * * The text displayed in the dropdown , usually for the active item . * / <nl> - text ? : string | React . ReactNode ; <nl> + text ? : string ; <nl> / * * Custom element to trigger the menu to become visible . Takes place of ' text ' . * / <nl> trigger ? : React . ReactNode ; <nl> 
mmm a / docs / app / Examples / collections / Menu / Types / MenuExampleNameProp . js <nl> ppp b / docs / app / Examples / collections / Menu / Types / MenuExampleNameProp . js <nl> < Menu > <nl> < Menu . Item <nl> name = ' editorials ' <nl> - active = { activeItem = = = ' Editorials ' } <nl> + active = { activeItem = = = ' editorials ' } <nl> onClick = { this . handleItemClick } <nl> / > <nl> < Menu . Item <nl> name = ' reviews ' <nl> - active = { activeItem = = = ' Reviews ' } <nl> + active = { activeItem = = = ' reviews ' } <nl> onClick = { this . handleItemClick } <nl> / > <nl> < Menu . Item <nl> 
mmm a / src / lib / AutoControlledComponent . js <nl> ppp b / src / lib / AutoControlledComponent . js <nl> const defaultPropName = getDefaultPropName ( prop ) <nl> const { name } = this . constructor <nl> / / prevent defaultFoo = { } along side foo = { } <nl> - if ( defaultPropName in this . props & & prop in this . props ) { <nl> + if ( ! _ . isUndefined ( this . props [ defaultPropName ] ) & & ! _ . isUndefined ( this . props [ prop ] ) ) { <nl> console . error ( <nl> ` $ { name } prop " $ { prop } " is auto controlled . Specify either $ { defaultPropName } or $ { prop } , but not both . ` <nl> ) <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentExample . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentExample . js <nl> resetJSX = ( ) = > { <nl> const { sourceCode } = this . state <nl> const original = this . getOriginalSourceCode ( ) <nl> - if ( sourceCode ! = = original & & confirm ( ' Loose your changes ? ' ) ) { / / eslint - disable - line no - alert <nl> + if ( sourceCode ! = = original & & confirm ( ' Lose your changes ? ' ) ) { / / eslint - disable - line no - alert <nl> this . setState ( { sourceCode : original } ) <nl> this . renderSourceCode ( ) <nl> } <nl> 
mmm a / docs / app / Examples / collections / Menu / Types / MenuExampleText . js <nl> ppp b / docs / app / Examples / collections / Menu / Types / MenuExampleText . js <nl> < Menu text > <nl> < Menu . Item header > Sort By < / Menu . Item > <nl> < Menu . Item name = ' closest ' active = { activeItem = = = ' closest ' } onClick = { this . handleItemClick } / > <nl> - < Menu . Item name = ' mostComments ' active = { activeItem = = = ' comments ' } onClick = { this . handleItemClick } / > <nl> - < Menu . Item name = ' mostPopular ' active = { activeItem = = = ' popular ' } onClick = { this . handleItemClick } / > <nl> + < Menu . Item name = ' mostComments ' active = { activeItem = = = ' mostComments ' } onClick = { this . handleItemClick } / > <nl> + < Menu . Item name = ' mostPopular ' active = { activeItem = = = ' mostPopular ' } onClick = { this . handleItemClick } / > <nl> < / Menu > <nl> ) <nl> } <nl> 
mmm a / docs / app / utils . js <nl> ppp b / docs / app / utils . js <nl> _ . sortBy ( ' _meta . name ' ) <nl> ) ( semanticUIReact ) <nl> + const mathSign = Math . sign | | function ( x ) { <nl> + x = + x <nl> + if ( x = = = 0 | | isNaN ( x ) ) { <nl> + return x <nl> + } <nl> + return x > 0 ? 1 : - 1 <nl> + } <nl> + <nl> / * * <nl> * Get the Webpack Context for all doc site examples . <nl> * / <nl> @ @ - 27 , 6 + 35 , 7 @ @ export const semanticUICSSRepoURL = ' https : / / github . com / Semantic - Org / Semantic - UI <nl> export const scrollToAnchor = ( ) = > { <nl> const anchor = location . hash & & document . querySelector ( location . hash ) <nl> + const offsetY = window . scrollY | | window . pageYOffset <nl> / / no scroll to target , stop <nl> if ( ! anchor ) return <nl> @ @ - 37 , 9 + 46 , 9 @ @ export const scrollToAnchor = ( ) = > { <nl> if ( elementTop = = = 0 ) return <nl> / / hit max scroll boundaries , stop <nl> - const isScrolledToTop = scrollY = = = 0 <nl> - const isScrolledToBottom = scrollY + document . body . clientHeight = = = document . body . scrollHeight <nl> - const scrollStep = Math . ceil ( ( Math . abs ( elementTop / 8 ) ) ) * Math . sign ( elementTop ) <nl> + const isScrolledToTop = offsetY = = = 0 <nl> + const isScrolledToBottom = offsetY + document . body . clientHeight = = = document . body . scrollHeight <nl> + const scrollStep = Math . ceil ( ( Math . abs ( elementTop / 8 ) ) ) * mathSign ( elementTop ) <nl> if ( isScrolledToBottom & & scrollStep > 0 | | isScrolledToTop & & scrollStep < 0 ) return <nl> 
mmm a / src / modules / Dropdown / Dropdown . js <nl> ppp b / src / modules / Dropdown / Dropdown . js <nl> handleBlur = ( e ) = > { <nl> debug ( ' handleBlur ( ) ' ) <nl> + <nl> + / / Heads up ! Don ' t remove this . <nl> + / / https : / / github . com / Semantic - Org / Semantic - UI - React / issues / 1315 <nl> + const currentTarget = _ . get ( e , ' currentTarget ' ) <nl> + if ( currentTarget & & currentTarget . contains ( document . activeElement ) ) return <nl> + <nl> const { closeOnBlur , multiple , onBlur , selectOnBlur } = this . props <nl> / / do not " blur " when the mouse is down inside of the Dropdown <nl> if ( this . isMouseDown ) return <nl> 
mmm a / src / lib / htmlInputPropsUtils . js <nl> ppp b / src / lib / htmlInputPropsUtils . js <nl> / / LIMITED HTML PROPS <nl> ' autoCapitalize ' , ' autoComplete ' , ' autoCorrect ' , ' autoFocus ' , ' checked ' , ' disabled ' , ' form ' , ' id ' , ' max ' , ' maxLength ' , <nl> - ' min ' , ' multiple ' , ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , ' type ' , ' value ' , <nl> + ' min ' , ' minLength ' , ' multiple ' , ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , ' type ' , ' value ' , <nl> ] <nl> export const htmlInputEvents = [ <nl> 
mmm a / src / modules / Search / Search . js <nl> ppp b / src / modules / Search / Search . js <nl> debug ( ' selectItemOnEnter ( ) ' ) <nl> debug ( keyboardKey . getName ( e ) ) <nl> if ( keyboardKey . getCode ( e ) ! = = keyboardKey . Enter ) return <nl> - e . preventDefault ( ) <nl> const result = this . getSelectedResult ( ) <nl> / / prevent selecting null if there was no selected item value <nl> if ( ! result ) return <nl> + e . preventDefault ( ) <nl> + <nl> / / notify the onResultSelect prop that the user is trying to change value <nl> this . setValue ( result . title ) <nl> this . handleResultSelect ( e , result ) <nl> 
mmm a / src / modules / Accordion / Accordion . d . ts <nl> ppp b / src / modules / Accordion / Accordion . d . ts <nl> fluid ? : boolean ; <nl> / * * Format for dark backgrounds . * / <nl> - inverted ? : string ; <nl> + inverted ? : boolean ; <nl> / * * <nl> * Called when a panel title is clicked . <nl> 
mmm a / src / modules / Dropdown / Dropdown . js <nl> ppp b / src / modules / Dropdown / Dropdown . js <nl> this . sizerRef . style . display = ' inline ' <nl> this . sizerRef . textContent = searchQuery <nl> searchWidth = Math . ceil ( this . sizerRef . getBoundingClientRect ( ) . width ) <nl> - this . sizerRef . style . removeProperty ( ' display ' ) <nl> + this . sizerRef . style . display = ' none ' <nl> } <nl> return ( <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # Credit <nl> - Originally made [ @ TechnologyAdvice ] [ 9 ] by [ @ levithomason ] [ 26 ] . <nl> + Originally made for [ @ TechnologyAdvice ] [ 9 ] by [ @ levithomason ] [ 26 ] . <nl> Big thanks to our [ contributors ] [ 20 ] , especially : <nl> 
mmm a / src / elements / Input / Input . d . ts <nl> ppp b / src / elements / Input / Input . d . ts <nl> value : string ; <nl> } <nl> - declare const Input : React . StatelessComponent < InputProps > ; <nl> + declare const Input : React . ComponentClass < InputProps > ; <nl> export default Input ; <nl> 
mmm a / src / modules / Tab / TabPane . js <nl> ppp b / src / modules / Tab / TabPane . js <nl> as : customPropTypes . as , <nl> / * * Primary content . * / <nl> - children : PropTypes . string , <nl> + children : PropTypes . node , <nl> / * * Additional classes . * / <nl> className : PropTypes . string , <nl> 
mmm a / src / elements / Button / Button . d . ts <nl> ppp b / src / elements / Button / Button . d . ts <nl> active ? : boolean ; <nl> / * * A button can animate to show hidden content . * / <nl> - animated ? : ' fade ' | ' vertical ' ; <nl> + animated ? : boolean | ' fade ' | ' vertical ' ; <nl> / * * A button can be attached to the top or bottom of other content . * / <nl> attached ? : ' left ' | ' right ' | ' top ' | ' bottom ' ; <nl> 
mmm a / src / modules / Progress / Progress . d . ts <nl> ppp b / src / modules / Progress / Progress . d . ts <nl> indicating ? : boolean ; <nl> / * * A progress bar can have its colors inverted . * / <nl> - inverted ? : string ; <nl> + inverted ? : boolean ; <nl> / * * Can be set to either to display progress as percent or ratio . * / <nl> label ? : SemanticShorthandItem < HtmlLabelProps > ; <nl> 
mmm a / src / views / Statistic / Statistic . d . ts <nl> ppp b / src / views / Statistic / Statistic . d . ts <nl> horizontal ? : boolean ; <nl> / * * A statistic can be formatted to fit on a dark background . * / <nl> - inverted ? : string ; <nl> + inverted ? : boolean ; <nl> / * * Label content of the Statistic . * / <nl> label ? : SemanticShorthandContent ; <nl> 
mmm a / src / elements / Step / StepGroup . js <nl> ppp b / src / elements / Step / StepGroup . js <nl> size , <nl> useKeyOnly ( fluid , ' fluid ' ) , <nl> useKeyOnly ( ordered , ' ordered ' ) , <nl> - useKeyOnly ( unstackable , ' unstackable , ' ) , <nl> + useKeyOnly ( unstackable , ' unstackable ' ) , <nl> useKeyOnly ( vertical , ' vertical ' ) , <nl> useValueAndKey ( stackable , ' stackable ' ) , <nl> ' steps ' , <nl> 
mmm a / src / modules / Tab / TabPane . js <nl> ppp b / src / modules / Tab / TabPane . js <nl> } <nl> return ( <nl> - < ElementType { . . . calculatedDefaultProps } { . . . rest } className = { classes } loading = { loading } > <nl> + < ElementType { . . . calculatedDefaultProps } { . . . rest } className = { classes } > <nl> { children } <nl> < / ElementType > <nl> ) <nl> 
mmm a / config . js <nl> ppp b / config . js <nl> compiler_hash_type : __PROD__ ? ' chunkhash ' : ' hash ' , <nl> compiler_fail_on_warning : __TEST__ | | __PROD__ , <nl> compiler_output_path : paths . base ( envConfig . dir_docs_dist ) , <nl> - compiler_public_path : __PROD__ ? ' / / raw . github . com / Semantic - Org / Semantic - UI - React / gh - pages / ' : ' / ' , <nl> + compiler_public_path : ' / ' , <nl> compiler_stats : { <nl> hash : false , / / the hash of the compilation <nl> version : false , / / webpack version info <nl> 
mmm a / src / addons / TextArea / TextArea . d . ts <nl> ppp b / src / addons / TextArea / TextArea . d . ts <nl> value ? : string ; <nl> } <nl> - declare class TextArea extends React . Component < TextArea , { } > { <nl> + declare class TextArea extends React . Component < TextAreaProps , { } > { <nl> focus : ( ) = > void ; <nl> } <nl> 
mmm a / src / elements / Image / Image . js <nl> ppp b / src / elements / Image / Image . js <nl> ] ) , <nl> / * * An image can render wrapped in a ` div . ui . image ` as alternative HTML markup . * / <nl> - wrapped : customPropTypes . every ( [ <nl> - PropTypes . bool , <nl> - / / these props wrap the image in an a tag already <nl> - customPropTypes . disallow ( [ ' href ' ] ) , <nl> - ] ) , <nl> + wrapped : PropTypes . bool , <nl> } <nl> Image . defaultProps = { <nl> 
mmm a / src / modules / Popup / Popup . js <nl> ppp b / src / modules / Popup / Popup . js <nl> handlePortalUnmount = ( e ) = > { <nl> debug ( ' handlePortalUnmount ( ) ' ) <nl> + window . removeEventListener ( ' scroll ' , this . hideOnScroll ) <nl> const { onUnmount } = this . props <nl> if ( onUnmount ) onUnmount ( e , this . props ) <nl> } <nl> 
mmm a / src / behaviors / Visibility / Visibility . js <nl> ppp b / src / behaviors / Visibility / Visibility . js <nl> offset : PropTypes . oneOfType ( [ <nl> PropTypes . number , <nl> PropTypes . string , <nl> - PropTypes . arrayOf ( [ <nl> + PropTypes . arrayOf ( PropTypes . oneOfType ( [ <nl> PropTypes . number , <nl> PropTypes . string , <nl> - ] ) , <nl> + ] ) ) , <nl> ] ) , <nl> / * * When set to false a callback will occur each time an element passes the threshold for a condition . * / <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " prerelease " : " yarn lint & & yarn tsd : lint & & npm test & & cross - env NODE_ENV = production yarn build " , <nl> " postrelease " : " NODE_ENV = production yarn deploy : docs " , <nl> - " release : major " : " yarn prerelease & & ta - script npm / release . sh major " , <nl> - " release : minor " : " yarn prerelease & & ta - script npm / release . sh minor " , <nl> - " release : patch " : " yarn prerelease & & ta - script npm / release . sh patch " , <nl> + " prerelease : major " : " yarn prerelease " , <nl> + " prerelease : minor " : " yarn prerelease " , <nl> + " prerelease : patch " : " yarn prerelease " , <nl> + " release : major " : " ta - script npm / release major " , <nl> + " release : minor " : " ta - script npm / release minor " , <nl> + " release : patch " : " ta - script npm / release patch " , <nl> " prestart " : " yarn satisfied - - - - fix yarn " , <nl> " start " : " yarn docs " , <nl> " satisfied " : " satisfied - - skip - invalid " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build : docs - toc " : " doctoc . / . github / CONTRIBUTING . md - - github - - maxlevel 4 " , <nl> " build : docs - cname " : " echo react . semantic - ui . com > docs / build / CNAME " , <nl> + " build : changelog " : " github_changelog_generator - - max - issues 1000 " , <nl> + " deploy : changelog " : " git add CHANGELOG . md & & git commit - m ' docs ( changelog ) : update changelog [ ci skip ] ' & & git push " , <nl> " predeploy : docs " : " cross - env NODE_ENV = production yarn build : docs & & yarn build : docs - cname " , <nl> " deploy : docs " : " gh - pages - d docs / build - m ' deploy docs [ ci skip ] ' " , <nl> - " postdeploy : docs " : " github_changelog_generator & & gach ' docs ( changelog ) : update changelog [ ci skip ] " , <nl> + " postdeploy : docs " : " yarn build : changelog & & yarn deploy : changelog " , <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> " lint : fix " : " yarn lint - - - - fix " , <nl> " prerelease " : " yarn lint & & yarn tsd : lint & & npm test & & cross - env NODE_ENV = production yarn build " , <nl> 
mmm a / src / modules / Dropdown / Dropdown . js <nl> ppp b / src / modules / Dropdown / Dropdown . js <nl> debug ( ` offset : $ { offset } ` ) <nl> const options = this . getMenuOptions ( ) <nl> - const lastIndex = options . length - 1 <nl> / / Prevent infinite loop <nl> - if ( _ . every ( options , ' disabled ' ) ) return <nl> + / / TODO : remove left part of condition after children API will be removed <nl> + if ( options = = = undefined | | _ . every ( options , ' disabled ' ) ) return <nl> + const lastIndex = options . length - 1 <nl> / / next is after last , wrap to beginning <nl> / / next is before first , wrap to end <nl> let nextIndex = startIndex + offset <nl> 
mmm a / src / modules / Accordion / AccordionAccordion . d . ts <nl> ppp b / src / modules / Accordion / AccordionAccordion . d . ts <nl> title : SemanticShorthandItem < AccordionTitleProps > ; <nl> } <nl> - declare const AccordionAccordion : AccordionAccordionProps ; <nl> + declare const AccordionAccordion : React . ComponentClass < AccordionAccordionProps > ; <nl> export default AccordionAccordion ; <nl> 
mmm a / src / addons / Responsive / Responsive . js <nl> ppp b / src / addons / Responsive / Responsive . js <nl> eventStack , <nl> getElementType , <nl> getUnhandledProps , <nl> + isBrowser , <nl> META , <nl> } from ' . . / . . / lib ' <nl> @ @ - 55 , 7 + 56 , 8 @ @ export default class Responsive extends Component { <nl> constructor ( . . . args ) { <nl> super ( . . . args ) <nl> - this . state = { width : window . innerWidth } <nl> + <nl> + this . state = { width : isBrowser ? window . innerWidth : 0 } <nl> } <nl> componentDidMount ( ) { <nl> 
mmm a / src / addons / TextArea / TextArea . js <nl> ppp b / src / addons / TextArea / TextArea . js <nl> / / Measure the scrollHeight and update the height to match . <nl> this . ref . style . height = ' auto ' <nl> + this . ref . style . overflowY = ' hidden ' <nl> this . ref . style . height = ` $ { Math . max ( parseFloat ( minHeight ) , Math . ceil ( this . ref . scrollHeight + borderHeight ) ) } px ` <nl> + this . ref . style . overflowY = ' ' <nl> } <nl> render ( ) { <nl> 
mmm a / src / modules / Modal / Modal . js <nl> ppp b / src / modules / Modal / Modal . js <nl> handleClose = ( e ) = > { <nl> debug ( ' close ( ) ' ) <nl> - const { onClose } = this . props <nl> - if ( onClose ) onClose ( e , this . props ) <nl> - <nl> - this . trySetState ( { open : false } , { scrolling : false } ) <nl> + _ . invoke ( this . props , ' onClose ' , e , this . props ) <nl> + this . trySetState ( { open : false } ) <nl> } <nl> handleIconOverrides = predefinedProps = > ( { <nl> @ @ - 191 , 19 + 189 , 17 @ @ class Modal extends Component { <nl> handleOpen = ( e ) = > { <nl> debug ( ' open ( ) ' ) <nl> - const { onOpen } = this . props <nl> - if ( onOpen ) onOpen ( e , this . props ) <nl> - <nl> + _ . invoke ( this . props , ' onOpen ' , e , this . props ) <nl> this . trySetState ( { open : true } ) <nl> } <nl> handlePortalMount = ( e ) = > { <nl> debug ( ' handlePortalMount ( ) ' ) <nl> + this . setState ( { scrolling : false } ) <nl> this . setPositionAndClassNames ( ) <nl> - const { onMount } = this . props <nl> - if ( onMount ) onMount ( e , this . props ) <nl> + _ . invoke ( this . props , ' onMount ' , e , this . props ) <nl> } <nl> handlePortalUnmount = ( e ) = > { <nl> @ @ - 221 , 9 + 217 , 7 @ @ class Modal extends Component { <nl> mountNode . classList . remove ( ' scrolling ' ) <nl> cancelAnimationFrame ( this . animationRequestId ) <nl> - <nl> - const { onUnmount } = this . props <nl> - if ( onUnmount ) onUnmount ( e , this . props ) <nl> + _ . invoke ( this . props , ' onUnmount ' , e , this . props ) <nl> } <nl> handleRef = c = > ( this . ref = c ) <nl> 
mmm a / docs / app / index . ejs <nl> ppp b / docs / app / index . ejs <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / js - beautify / < % = htmlWebpackPlugin . options . versions . jsBeautify % > / beautify - html . min . js " > < / script > <nl> < ! - - Use unminified React when not in production so we get errors and warnings - - > <nl> - < script src = " / / cdnjs . cloudflare . com / ajax / libs / prop - types / < % = htmlWebpackPlugin . options . versions . propTypes % > / prop - types < % = __PROD__ ? ' min ' : ' ' % > . js " > < / script > <nl> + < script src = " / / cdnjs . cloudflare . com / ajax / libs / prop - types / < % = htmlWebpackPlugin . options . versions . propTypes % > / prop - types < % = __PROD__ ? ' . min ' : ' ' % > . js " > < / script > <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / react / < % = htmlWebpackPlugin . options . versions . react % > / umd / react < % = __PROD__ ? ' . production . min ' : ' . development ' % > . js " > < / script > <nl> < script src = " https : / / cdnjs . cloudflare . com / ajax / libs / react - dom / < % = htmlWebpackPlugin . options . versions . reactDOM % > / umd / react - dom < % = __PROD__ ? ' . production . min ' : ' . development ' % > . js " > < / script > <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / react - dom / < % = htmlWebpackPlugin . options . versions . reactDOM % > / umd / react - dom - server . browser < % = __PROD__ ? ' . production . min ' : ' . development ' % > . js " > < / script > <nl> 
mmm a / src / addons / Portal / Portal . js <nl> ppp b / src / addons / Portal / Portal . js <nl> if ( ! this . state . open ) return <nl> debug ( ' renderPortal ( ) ' ) <nl> - const { children , className } = this . props <nl> + const { children , className , eventPool } = this . props <nl> this . mountPortal ( ) <nl> @ @ - 354 , 8 + 354 , 8 @ @ class Portal extends Component { <nl> / / when re - rendering , first remove listeners before re - adding them to the new node <nl> if ( this . portalNode ) { <nl> - eventStack . unsub ( ' mouseleave ' , this . handlePortalMouseLeave , { target : this . portalNode } ) <nl> - eventStack . unsub ( ' mouseenter ' , this . handlePortalMouseEnter , { target : this . portalNode } ) <nl> + eventStack . unsub ( ' mouseleave ' , this . handlePortalMouseLeave , { pool : eventPool , target : this . portalNode } ) <nl> + eventStack . unsub ( ' mouseenter ' , this . handlePortalMouseEnter , { pool : eventPool , target : this . portalNode } ) <nl> } <nl> ReactDOM . unstable_renderSubtreeIntoContainer ( <nl> @ @ - 365 , 8 + 365 , 8 @ @ class Portal extends Component { <nl> ( ) = > { <nl> this . portalNode = this . rootNode . firstElementChild <nl> - eventStack . sub ( ' mouseleave ' , this . handlePortalMouseLeave , { target : this . portalNode } ) <nl> - eventStack . sub ( ' mouseenter ' , this . handlePortalMouseEnter , { target : this . portalNode } ) <nl> + eventStack . sub ( ' mouseleave ' , this . handlePortalMouseLeave , { pool : eventPool , target : this . portalNode } ) <nl> + eventStack . sub ( ' mouseenter ' , this . handlePortalMouseEnter , { pool : eventPool , target : this . portalNode } ) <nl> } , <nl> ) <nl> } <nl> @ @ - 390 , 8 + 390 , 8 @ @ class Portal extends Component { <nl> mountNode . appendChild ( this . rootNode ) <nl> } <nl> - eventStack . sub ( ' click ' , this . handleDocumentClick , eventPool ) <nl> - eventStack . sub ( ' keydown ' , this . handleEscape , eventPool ) <nl> + eventStack . sub ( ' click ' , this . handleDocumentClick , { pool : eventPool } ) <nl> + eventStack . sub ( ' keydown ' , this . handleEscape , { pool : eventPool } ) <nl> _ . invoke ( this . props , ' onMount ' , null , this . props ) <nl> } <nl> @ @ - 404 , 14 + 404 , 14 @ @ class Portal extends Component { <nl> ReactDOM . unmountComponentAtNode ( this . rootNode ) <nl> this . rootNode . parentNode . removeChild ( this . rootNode ) <nl> - eventStack . unsub ( ' mouseleave ' , this . handlePortalMouseLeave , { target : this . portalNode } ) <nl> - eventStack . unsub ( ' mouseenter ' , this . handlePortalMouseEnter , { target : this . portalNode } ) <nl> + eventStack . unsub ( ' mouseleave ' , this . handlePortalMouseLeave , { pool : eventPool , target : this . portalNode } ) <nl> + eventStack . unsub ( ' mouseenter ' , this . handlePortalMouseEnter , { pool : eventPool , target : this . portalNode } ) <nl> this . rootNode = null <nl> this . portalNode = null <nl> - eventStack . unsub ( ' click ' , this . handleDocumentClick , eventPool ) <nl> - eventStack . unsub ( ' keydown ' , this . handleEscape , eventPool ) <nl> + eventStack . unsub ( ' click ' , this . handleDocumentClick , { pool : eventPool } ) <nl> + eventStack . unsub ( ' keydown ' , this . handleEscape , { pool : eventPool } ) <nl> _ . invoke ( this . props , ' onUnmount ' , null , this . props ) <nl> } <nl> 
mmm a / src / addons / Responsive / Responsive . js <nl> ppp b / src / addons / Responsive / Responsive . js <nl> componentDidMount ( ) { <nl> const { fireOnMount } = this . props <nl> + this . mounted = true <nl> + <nl> eventStack . sub ( ' resize ' , this . handleResize , { target : ' window ' } ) <nl> if ( fireOnMount ) this . handleUpdate ( ) <nl> } <nl> componentWillUnmount ( ) { <nl> + this . mounted = false <nl> eventStack . unsub ( ' resize ' , this . handleResize , { target : ' window ' } ) <nl> } <nl> @ @ - 92 , 6 + 95 , 8 @ @ export default class Responsive extends Component { <nl> return _ . isNil ( minWidth ) ? true : width > = minWidth <nl> } <nl> + setSafeState = ( . . . args ) = > this . mounted & & this . setState ( . . . args ) <nl> + <nl> isVisible = ( ) = > this . fitsMinWidth ( ) & & this . fitsMaxWidth ( ) <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> @ @ - 109 , 7 + 114 , 7 @ @ export default class Responsive extends Component { <nl> this . ticking = false <nl> const width = window . innerWidth <nl> - this . setState ( { width } ) <nl> + this . setSafeState ( { width } ) <nl> _ . invoke ( this . props , ' onUpdate ' , e , { . . . this . props , width } ) <nl> } <nl> 
mmm a / src / modules / Accordion / AccordionTitle . js <nl> ppp b / src / modules / Accordion / AccordionTitle . js <nl> content : customPropTypes . contentShorthand , <nl> / * * AccordionTitle index inside Accordion . * / <nl> - index : PropTypes . number , <nl> + index : PropTypes . oneOfType ( [ <nl> + PropTypes . string , <nl> + PropTypes . number , <nl> + ] ) , <nl> / * * <nl> * Called on click . <nl> 
mmm a / src / modules / Accordion / AccordionAccordion . d . ts <nl> ppp b / src / modules / Accordion / AccordionAccordion . d . ts <nl> * Called when a panel title is clicked . <nl> * <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> - * @ param { number } index - The index of the clicked panel . <nl> + * @ param { AccordionTitleProps } data - All item props . <nl> * / <nl> - onTitleClick ? : ( event : React . MouseEvent < HTMLDivElement > , index : number | number [ ] ) = > void ; <nl> + onTitleClick ? : ( event : React . MouseEvent < HTMLDivElement > , data : AccordionTitleProps ) = > void ; <nl> / * * Shorthand array of props for Accordion . * / <nl> panels ? : SemanticShorthandCollection < AccordionPanelProps > ; <nl> 
mmm a / docs / app / Components / ComponentDoc / ComponentProps / ComponentPropsComponents . js <nl> ppp b / docs / app / Components / ComponentDoc / ComponentProps / ComponentPropsComponents . js <nl> import ComponentPropsComponent from ' . / ComponentPropsComponent ' <nl> const ComponentPropsComponents = ( { activeName , components , onItemClick , parent } ) = > { <nl> - if ( components . length = = = 1 ) return <nl> + if ( components . length = = = 1 ) return null <nl> return ( <nl> < Menu color = ' green ' compact size = ' small ' secondary > <nl> 
mmm a / src / addons / Responsive / Responsive . d . ts <nl> ppp b / src / addons / Responsive / Responsive . d . ts <nl> } <nl> export interface ResponsiveOnUpdateData extends ResponsiveProps { <nl> - width : string ; <nl> + width : number ; <nl> } <nl> export interface ResponsiveWidthShorthand { <nl> - minWidth : number ; <nl> - maxWidth ? : number ; <nl> + minWidth ? : number | string ; <nl> + maxWidth ? : number | string ; <nl> } <nl> declare class Responsive extends React . Component < ResponsiveProps , { } > { <nl> 
mmm a / docs / app / Layouts / HomepageLayout . js <nl> ppp b / docs / app / Layouts / HomepageLayout . js <nl> class MobileContainer extends Component { <nl> state = { } <nl> + handlePusherClick = ( ) = > { <nl> + const { sidebarOpened } = this . state <nl> + <nl> + if ( sidebarOpened ) this . setState ( { sidebarOpened : false } ) <nl> + } <nl> + <nl> handleToggle = ( ) = > this . setState ( { sidebarOpened : ! this . state . sidebarOpened } ) <nl> render ( ) { <nl> @ @ - 122 , 10 + 128 , 10 @ @ class MobileContainer extends Component { <nl> < Menu . Item as = ' a ' > Company < / Menu . Item > <nl> < Menu . Item as = ' a ' > Careers < / Menu . Item > <nl> < Menu . Item as = ' a ' > Log in < / Menu . Item > <nl> - < Menu . Item as = ' a ' primary > Sign Up < / Menu . Item > <nl> + < Menu . Item as = ' a ' > Sign Up < / Menu . Item > <nl> < / Sidebar > <nl> - < Sidebar . Pusher dimmed = { sidebarOpened } onClick = { this . handleToggle } style = { { minHeight : ' 100vh ' } } > <nl> + < Sidebar . Pusher dimmed = { sidebarOpened } onClick = { this . handlePusherClick } style = { { minHeight : ' 100vh ' } } > <nl> < Segment inverted textAlign = ' center ' style = { { minHeight : 350 , padding : ' 1em 0em ' } } vertical > <nl> < Container > <nl> < Menu inverted pointing secondary size = ' large ' > <nl> 
mmm a / src / lib / htmlPropsUtils . js <nl> ppp b / src / lib / htmlPropsUtils . js <nl> ' selected ' , ' defaultValue ' , ' defaultChecked ' , <nl> / / LIMITED HTML PROPS <nl> - ' autoCapitalize ' , ' autoComplete ' , ' autoCorrect ' , ' autoFocus ' , ' checked ' , ' disabled ' , ' form ' , ' id ' , ' list ' , ' max ' , <nl> - ' maxLength ' , ' min ' , ' minLength ' , ' multiple ' , ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , <nl> + ' accept ' , ' autoCapitalize ' , ' autoComplete ' , ' autoCorrect ' , ' autoFocus ' , ' checked ' , ' disabled ' , ' form ' , ' id ' , ' list ' , <nl> + ' max ' , ' maxLength ' , ' min ' , ' minLength ' , ' multiple ' , ' name ' , ' pattern ' , ' placeholder ' , ' readOnly ' , ' required ' , ' step ' , <nl> ' type ' , ' value ' , <nl> ] <nl> 
mmm a / src / lib / factories . js <nl> ppp b / src / lib / factories . js <nl> * / <nl> export function createShorthand ( Component , mapValueToProps , val , options = { } ) { <nl> if ( typeof Component ! = = ' function ' & & typeof Component ! = = ' string ' ) { <nl> - throw new Error ( ' createShorthandFactory ( ) Component must be a string or function . ' ) <nl> + throw new Error ( ' createShorthand ( ) Component must be a string or function . ' ) <nl> } <nl> / / short circuit noop values <nl> if ( _ . isNil ( val ) | | _ . isBoolean ( val ) ) return null <nl> 
mmm a / src / modules / Modal / Modal . js <nl> ppp b / src / modules / Modal / Modal . js <nl> setDimmerNodeStyle = ( ) = > { <nl> debug ( ' setDimmerNodeStyle ( ) ' ) <nl> + const { current } = this . dimmerRef <nl> - if ( this . dimmerRef . current & & this . dimmerRef . current . style ) { <nl> - this . dimmerRef . current . style . setProperty ( ' display ' , ' flex ' , ' important ' ) <nl> + if ( current & & current . style & & current . style . display ! = = ' flex ' ) { <nl> + current . style . setProperty ( ' display ' , ' flex ' , ' important ' ) <nl> } <nl> } <nl> 
mmm a / src / lib / isISO31661Alpha3 . js <nl> ppp b / src / lib / isISO31661Alpha3 . js <nl> - import includes from ' . / util / includes ' ; <nl> / / from https : / / en . wikipedia . org / wiki / ISO_3166 - 1_alpha - 3 <nl> - const validISO31661Alpha3CountriesCodes = [ <nl> + const validISO31661Alpha3CountriesCodes = new Set ( [ <nl> ' AFG ' , ' ALA ' , ' ALB ' , ' DZA ' , ' ASM ' , ' AND ' , ' AGO ' , ' AIA ' , ' ATA ' , ' ATG ' , ' ARG ' , ' ARM ' , ' ABW ' , ' AUS ' , ' AUT ' , ' AZE ' , <nl> ' BHS ' , ' BHR ' , ' BGD ' , ' BRB ' , ' BLR ' , ' BEL ' , ' BLZ ' , ' BEN ' , ' BMU ' , ' BTN ' , ' BOL ' , ' BES ' , ' BIH ' , ' BWA ' , ' BVT ' , ' BRA ' , <nl> ' IOT ' , ' BRN ' , ' BGR ' , ' BFA ' , ' BDI ' , ' KHM ' , ' CMR ' , ' CAN ' , ' CPV ' , ' CYM ' , ' CAF ' , ' TCD ' , ' CHL ' , ' CHN ' , ' CXR ' , ' CCK ' , <nl> @ @ - 19 , 9 + 18 , 9 @ @ const validISO31661Alpha3CountriesCodes = [ <nl> ' ESP ' , ' LKA ' , ' SDN ' , ' SUR ' , ' SJM ' , ' SWZ ' , ' SWE ' , ' CHE ' , ' SYR ' , ' TWN ' , ' TJK ' , ' TZA ' , ' THA ' , ' TLS ' , ' TGO ' , ' TKL ' , <nl> ' TON ' , ' TTO ' , ' TUN ' , ' TUR ' , ' TKM ' , ' TCA ' , ' TUV ' , ' UGA ' , ' UKR ' , ' ARE ' , ' GBR ' , ' USA ' , ' UMI ' , ' URY ' , ' UZB ' , ' VUT ' , <nl> ' VEN ' , ' VNM ' , ' VGB ' , ' VIR ' , ' WLF ' , ' ESH ' , ' YEM ' , ' ZMB ' , ' ZWE ' , <nl> - ] ; <nl> + ] ) ; <nl> export default function isISO31661Alpha3 ( str ) { <nl> assertString ( str ) ; <nl> - return includes ( validISO31661Alpha3CountriesCodes , str . toUpperCase ( ) ) ; <nl> + return validISO31661Alpha3CountriesCodes . has ( str . toUpperCase ( ) ) ; <nl> } <nl> 
mmm a / packages / veui - loader / src / index . js <nl> ppp b / packages / veui - loader / src / index . js <nl> return path . extname ( file ) . replace ( / \ . / g , ' ' ) . toLowerCase ( ) <nl> } <nl> - const RE_SCRIPT = / < script ( ? : \ s [ ^ > ] * ) ? > / i <nl> + const RE_SCRIPT = / < script ( ? : \ s [ ^ < > ] * ) ? > / i <nl> / * * <nl> * Patch file content according to a given type . <nl> 
mmm a / src / NativeScript / Metadata / Metadata . mm <nl> ppp b / src / NativeScript / Metadata / Metadata . mm <nl> UInt8 majorVersion = ( UInt8 ) [ versionTokens [ 0 ] intValue ] ; <nl> UInt8 minorVersion = ( UInt8 ) [ versionTokens [ 1 ] intValue ] ; <nl> - return encodeVersion ( majorVersion , minorVersion ) ; <nl> + return iosVersion = encodeVersion ( majorVersion , minorVersion ) ; <nl> } <nl> std : : unordered_map < std : : string , MembersCollection > getMetasByJSNames ( MembersCollection members ) { <nl> std : : unordered_map < std : : string , MembersCollection > result ; <nl> 
mmm a / src / websocket - plus . js <nl> ppp b / src / websocket - plus . js <nl> ) ; <nl> } <nl> super ( ) ; <nl> - if ( typeof getUrls ! = = ' function ' ) { <nl> - this . _getUrls = ( ) = > Promise . resolve ( getUrls ) ; <nl> - } else { <nl> - this . _getUrls = getUrls ; <nl> - } <nl> - this . _protocol = protocol ; <nl> this . init ( ) ; <nl> - this . _createWs ( this . _getUrls , this . _protocol ) <nl> + this . _protocol = protocol ; <nl> + Promise . resolve ( typeof getUrls = = = ' function ' ? getUrls ( ) : getUrls ) <nl> + . then ( ensureArray ) <nl> + . then ( urls = > { <nl> + this . _urls = urls ; <nl> + return this . _open ( ) ; <nl> + } ) <nl> . then ( ( ) = > { <nl> this . __postponeTimeoutTimer = this . _postponeTimeoutTimer . bind ( this ) ; <nl> if ( global . addEventListener ) { <nl> @ @ - 62 , 14 + 62 , 19 @ @ class WebSocketPlus extends EventEmitter { <nl> . catch ( this . throw . bind ( this ) ) ; <nl> } <nl> - _createWs ( getUrls , protocol ) { <nl> - return getUrls ( ) . then ( urls = > <nl> - tryAll ( <nl> - ensureArray ( urls ) . map ( url = > ( resolve , reject ) = > { <nl> + _open ( ) { <nl> + return this . _createWs ( this . _urls , this . _protocol ) . then ( ws = > { <nl> + const [ first , . . . reset ] = this . _urls ; <nl> + this . _urls = [ . . . reset , first ] ; <nl> + return ws ; <nl> + } ) ; <nl> + } <nl> + <nl> + _createWs ( urls , protocol ) { <nl> + return tryAll ( <nl> + urls . map ( url = > ( resolve , reject ) = > { <nl> debug ( ` connect [ $ { url } ] $ { protocol } ` ) ; <nl> - const ws = protocol <nl> - ? new WebSocket ( url , protocol ) <nl> - : new WebSocket ( url ) ; <nl> + const ws = protocol ? new WebSocket ( url , protocol ) : new WebSocket ( url ) ; <nl> ws . binaryType = this . binaryType | | ' arraybuffer ' ; <nl> ws . onopen = ( ) = > resolve ( ws ) ; <nl> ws . onclose = error = > { <nl> @ @ - 86 , 8 + 91 , 7 @ @ class WebSocketPlus extends EventEmitter { <nl> this . _ws . onclose = this . _handleClose . bind ( this ) ; <nl> this . _ws . onmessage = this . _handleMessage . bind ( this ) ; <nl> return ws ; <nl> - } ) <nl> - ) ; <nl> + } ) ; <nl> } <nl> _destroyWs ( ) { <nl> const ws = this . _ws ; <nl> @ @ - 141 , 7 + 145 , 7 @ @ class WebSocketPlus extends EventEmitter { <nl> } <nl> onretry ( event , from , to , attempt = 0 ) { <nl> this . emit ( RETRY , attempt ) ; <nl> - this . _createWs ( this . _getUrls , this . _protocol ) . then ( <nl> + this . _open ( ) . then ( <nl> ( ) = > ( this . can ( ' reconnect ' ) ? this . reconnect ( ) : this . _destroyWs ( ) ) , <nl> ( ) = > this . can ( ' fail ' ) & & this . fail ( attempt + 1 ) <nl> ) ; <nl> 
mmm a / packages / web / src / ui / views / viewer . js <nl> ppp b / packages / web / src / ui / views / viewer . js <nl> if ( ! render ) { <nl> const options = setup ( el ) <nl> + if ( options . error ) return html ` < b style = " color : red ; background : white ; position : fixed ; z - index : 10 ; top : 50 % " > $ { options . error } < / b > ` <nl> viewerOptions = options . viewerOptions <nl> camera = options . camera <nl> render = prepareRender ( viewerOptions ) <nl> @ @ - 191 , 13 + 192 , 32 @ @ const viewer = ( state , i18n ) = > { <nl> return el <nl> } <nl> + const createContext = ( canvas , contextAttributes ) = > { <nl> + const get = ( type ) = > { <nl> + try { <nl> + return { gl : canvas . getContext ( type , contextAttributes ) , type } <nl> + } catch ( e ) { <nl> + return null <nl> + } <nl> + } <nl> + return ( <nl> + get ( ' webgl2 ' ) | | <nl> + get ( ' webgl ' ) | | <nl> + get ( ' experimental - webgl ' ) | | <nl> + get ( ' webgl - experimental ' ) <nl> + ) <nl> + } <nl> + <nl> const setup = ( element ) = > { <nl> / / prepare the camera <nl> + let error <nl> const camera = Object . assign ( { } , perspectiveCamera . defaults ) <nl> camera . position = [ 150 , - 180 , 233 ] <nl> + const { gl , type } = createContext ( element ) <nl> + <nl> const viewerOptions = { <nl> - glOptions : { canvas : element } , <nl> + glOptions : { gl } , <nl> camera , <nl> drawCommands : { <nl> / / draw commands bootstrap themselves the first time they are run <nl> @ @ - 209 , 7 + 229 , 14 @ @ const setup = ( element ) = > { <nl> / / data <nl> entities : [ ] <nl> } <nl> - return { viewerOptions , camera } <nl> + if ( type = = = ' webgl ' ) { <nl> + if ( ! gl . getExtension ( ' OES_element_index_uint ' ) ) { <nl> + error = ' Your browser uses an old version of WebGL without OES_element_index_uint . Please upgrade your browser to use this application ' <nl> + } <nl> + <nl> + viewerOptions . glOptions . optionalExtensions = [ ' oes_element_index_uint ' ] <nl> + } <nl> + return { viewerOptions , camera , error } <nl> } <nl> const resize = ( viewerElement ) = > { <nl> 
mmm a / packages / modeling / src / measurements / measureBoundingBox . js <nl> ppp b / packages / modeling / src / measurements / measureBoundingBox . js <nl> vec2 . min ( minpoint , minpoint , point ) <nl> vec2 . max ( maxpoint , maxpoint , point ) <nl> } ) <nl> - <nl> boundingBox = [ [ minpoint [ 0 ] , minpoint [ 1 ] , 0 ] , [ maxpoint [ 0 ] , maxpoint [ 1 ] , 0 ] ] <nl> - cache . set ( points , boundingBox ) <nl> + cache . set ( points , boundingBox ) <nl> return boundingBox <nl> } <nl> @ @ - 55 , 7 + 54 , 6 @ @ const measureBoundingBoxOfPath2 = ( geometry ) = > { <nl> } <nl> cache . set ( geometry , boundingBox ) <nl> - <nl> return boundingBox <nl> } <nl> @ @ - 65 , 6 + 63 , 7 @ @ const measureBoundingBoxOfPath2 = ( geometry ) = > { <nl> * / <nl> const measureBoundingBoxOfGeom2Points = ( { points , sides } ) = > { <nl> const cacheKey = points | | sides <nl> + <nl> let boundingBox = cache . get ( cacheKey ) <nl> if ( boundingBox ) return boundingBox <nl> @ @ - 96 , 11 + 95 , 9 @ @ const measureBoundingBoxOfGeom2Points = ( { points , sides } ) = > { <nl> vec2 . max ( maxpoint , maxpoint , side [ 0 ] ) <nl> } ) <nl> } <nl> - <nl> boundingBox = [ [ minpoint [ 0 ] , minpoint [ 1 ] , 0 ] , [ maxpoint [ 0 ] , maxpoint [ 1 ] , 0 ] ] <nl> cache . set ( cacheKey , boundingBox ) <nl> - <nl> return boundingBox <nl> } <nl> @ @ - 121 , 7 + 118 , 6 @ @ const measureBoundingBoxOfGeom2 = ( geometry ) = > { <nl> } <nl> cache . set ( geometry , boundingBox ) <nl> - <nl> return boundingBox <nl> } <nl> @ @ - 150 , 7 + 146 , 6 @ @ const measureBoundingBoxOfGeom3Polygons = ( polygons ) = > { <nl> boundingBox = [ [ minpoint [ 0 ] , minpoint [ 1 ] , minpoint [ 2 ] ] , [ maxpoint [ 0 ] , maxpoint [ 1 ] , maxpoint [ 2 ] ] ] <nl> cache . set ( polygons , boundingBox ) <nl> - <nl> return boundingBox <nl> } <nl> @ @ - 171 , 13 + 166 , 13 @ @ const measureBoundingBoxOfGeom3 = ( geometry ) = > { <nl> } <nl> cache . set ( geometry , boundingBox ) <nl> - <nl> return boundingBox <nl> } <nl> - / * swap values if specific axis value in the second vector has lower value than the axis value in first vector * / <nl> + / * <nl> + * swap values if specific axis value in the second vector has lower value than the axis value in first vector <nl> + * / <nl> const fixBound = ( i , v1 , v2 ) = > { <nl> - / / this function will likely be inlined by the JS optimization compiler <nl> if ( v1 [ i ] > v2 [ i ] ) { <nl> const tmp = v1 [ i ] <nl> v1 [ i ] = v2 [ i ] <nl> @ @ - 185 , 18 + 180 , 21 @ @ const fixBound = ( i , v1 , v2 ) = > { <nl> } <nl> } <nl> + / * <nl> + * Transform the given bounding box <nl> + * / <nl> const transformBoundingBox = ( boundingBox , transforms ) = > { <nl> - if ( transforms & & ! mat4 . isIdentity ( transforms ) ) { <nl> - const out = [ vec3 . transform ( vec3 . create ( ) , boundingBox [ 0 ] , transforms ) , vec3 . transform ( vec3 . create ( ) , boundingBox [ 1 ] , transforms ) ] <nl> + if ( ! mat4 . isIdentity ( transforms ) ) { <nl> + vec3 . transform ( boundingBox [ 0 ] , boundingBox [ 0 ] , transforms ) , <nl> + vec3 . transform ( boundingBox [ 1 ] , boundingBox [ 1 ] , transforms ) <nl> / / we now have a new 2 vectors : [ v1 , v2 ] = > [ [ x1 , y1 , z1 ] , [ x2 , y2 , z2 ] ] <nl> / / transform can move bounding box corner in such way that it is no longer true that <nl> / / - v1 = [ min ( x1 , x2 ) , min ( y1 , y2 ) , min ( z1 , z2 ) ] <nl> / / - v2 = [ max ( x1 , x2 ) , max ( y1 , y2 ) , max ( z1 , z2 ) ] <nl> - fixBound ( 0 , . . . out ) / / swap x , if higher value is in first vector <nl> - fixBound ( 1 , . . . out ) / / swap y , if higher value is in first vector <nl> - fixBound ( 2 , . . . out ) / / swap z , if higher value is in first vector <nl> - return out <nl> + fixBound ( 0 , . . . boundingBox ) / / swap x , if higher value is in first vector <nl> + fixBound ( 1 , . . . boundingBox ) / / swap y , if higher value is in first vector <nl> + fixBound ( 2 , . . . boundingBox ) / / swap z , if higher value is in first vector <nl> } <nl> return boundingBox <nl> } <nl> @ @ - 223 , 15 + 221 , 4 @ @ const measureBoundingBox = ( . . . geometries ) = > { <nl> return results . length = = = 1 ? results [ 0 ] : results <nl> } <nl> - / * * <nl> - * Shortcut for geometries that are complex but have a fast way to calculate bounding box . <nl> - * Ellipsoid , or cylinder can provide boundingBox that pre - calculated based on parameters without traversing points . <nl> - * <nl> - * Another option is to calculate boundingBox durint toPoints ( so the boundingBox could be calculated during transform ) <nl> - * <nl> - * NOTE : It seems that measureBoundingBox is used all over the place , and it would be wise to allow <nl> - * shortcuts for calculating it , as default implementation goes through all points in geometry which is bound to be slow . <nl> - * / <nl> - measureBoundingBox . setCache = ( geometry , boundingBox ) = > cache . set ( geometry , boundingBox ) <nl> - <nl> module . exports = measureBoundingBox <nl> 
mmm a / packages / modeling / src / geometries / geom2 / toOutlines . js <nl> ppp b / packages / modeling / src / geometries / geom2 / toOutlines . js <nl> * This allows the edges to be traversed in order . <nl> * / <nl> const toEdges = ( sides ) = > { <nl> - const uniquevertices = [ ] <nl> + const vertices = { } <nl> const getUniqueVertex = ( vertex ) = > { <nl> - const i = uniquevertices . findIndex ( ( v ) = > vec2 . equals ( v , vertex ) ) <nl> - if ( i < 0 ) { <nl> - uniquevertices . push ( vertex ) <nl> - return vertex <nl> + const key = vertex . toString ( ) <nl> + if ( ! vertices [ key ] ) { <nl> + vertices [ key ] = vertex <nl> } <nl> - return uniquevertices [ i ] <nl> + return vertices [ key ] <nl> } <nl> - const edges = [ ] <nl> - sides . forEach ( ( side ) = > { <nl> - edges . push ( [ getUniqueVertex ( side [ 0 ] ) , getUniqueVertex ( side [ 1 ] ) ] ) <nl> - } ) <nl> - return edges <nl> + return sides . map ( ( side ) = > side . map ( getUniqueVertex ) ) <nl> } <nl> / * * <nl> 
mmm a / packages / web / src / sideEffects / worker / index . js <nl> ppp b / packages / web / src / sideEffects / worker / index . js <nl> const makeWorkerEffect = ( workerPath ) = > { <nl> const workerEventsCb = callBackToStream ( ) <nl> - let _worker = WebWorkify ( workerPath ) <nl> + let _worker = WebWorkify ( workerPath , { } ) <nl> _worker . onerror = ( error ) = > workerEventsCb . callback ( { error } ) <nl> _worker . onmessage = ( message ) = > workerEventsCb . callback ( message ) <nl> const workerSink = ( outToWorker $ ) = > { <nl> / / cancel whatever is going on in the worker by terminating it <nl> outToWorker $ . filter ( ( { cmd } ) = > cmd = = = ' cancel ' ) <nl> - . forEach ( ( _ ) = > _worker . terminate ( ) ) <nl> - <nl> - / / send other messages to the worker <nl> - outToWorker $ <nl> - . filter ( ( { cmd } ) = > cmd ! = = ' cancel ' ) <nl> . forEach ( ( task ) = > { <nl> - / / FIXME : sub optimal ! worker recreation is SLOW and should not be systematic <nl> _worker . terminate ( ) <nl> _worker = WebWorkify ( workerPath ) <nl> _worker . onerror = ( error ) = > workerEventsCb . callback ( { error } ) <nl> _worker . onmessage = ( message ) = > workerEventsCb . callback ( message ) <nl> - / / do the task <nl> + } ) <nl> + <nl> + / / send other messages to the worker <nl> + outToWorker $ <nl> + . filter ( ( { cmd } ) = > cmd ! = = ' cancel ' ) <nl> + . forEach ( ( task ) = > { <nl> _worker . postMessage ( task ) <nl> } ) <nl> } <nl> 
mmm a / src / views / PlexLibrary . vue <nl> ppp b / src / views / PlexLibrary . vue <nl> v - if = " ! stopNewContent " <nl> - justify = " center " <nl> - align = " start " <nl> - > <nl> - < v - col <nl> v - intersect = " onIntersect " <nl> - cols = " 12 " <nl> - style = " position : relative ; " <nl> - > <nl> - < v - progress - circular <nl> - style = " left : 50 % ; top : 50 % ; " <nl> - : size = " 60 " <nl> - indeterminate <nl> - class = " amber - - text " <nl> / > <nl> - < / v - col > <nl> - < / v - row > <nl> < / v - container > <nl> < / template > <nl> 
mmm a / src / runtime / node / base64url . ts <nl> ppp b / src / runtime / node / base64url . ts <nl> - export const encode = ( input : Uint8Array | string ) = > <nl> - Buffer . from ( input ) . toString ( ' base64 ' ) . replace ( / = / g , ' ' ) . replace ( / \ + / g , ' - ' ) . replace ( / \ / / g , ' _ ' ) <nl> + let encodeImpl : ( input : Uint8Array | string ) = > string <nl> - export const decode = ( input : Uint8Array | string ) = > { <nl> + function normalize ( input : string | Uint8Array ) { <nl> let encoded = input <nl> if ( encoded instanceof Uint8Array ) { <nl> encoded = decoder . decode ( encoded ) <nl> } <nl> - return new Uint8Array ( Buffer . from ( encoded , ' base64 ' ) ) <nl> + return encoded <nl> } <nl> + <nl> + if ( Buffer . isEncoding ( ' base64url ' ) ) { <nl> + encodeImpl = ( input ) = > Buffer . from ( input ) . toString ( < BufferEncoding > ' base64url ' ) <nl> + } else { <nl> + encodeImpl = ( input ) = > <nl> + Buffer . from ( input ) . toString ( ' base64 ' ) . replace ( / = / g , ' ' ) . replace ( / \ + / g , ' - ' ) . replace ( / \ / / g , ' _ ' ) <nl> + } <nl> + <nl> + export const encode = encodeImpl <nl> + export const decode = ( input : Uint8Array | string ) = > Buffer . from ( normalize ( input ) , ' base64 ' ) <nl> 
mmm a / addon / model . js <nl> ppp b / addon / model . js <nl> this . _topModel = this . _topModel | | this ; <nl> this . _parentModel = this . _parentModel | | null ; <nl> - this . _errors = DS . Errors . create ( ) ; <nl> + this . _errors = null ; <nl> this . _init = true ; <nl> if ( ! CUSTOM_MODEL_CLASS ) { <nl> this . _internalModel = properties . _internalModel ; <nl> @ @ - 487 , 16 + 487 , 16 @ @ export default class MegamorphicModel extends EmberObject { <nl> _removeError ( key ) { <nl> / / Remove errors for the property <nl> - this . _errors . remove ( key ) ; <nl> + this . errors . remove ( key ) ; <nl> if ( CUSTOM_MODEL_CLASS ) { <nl> - if ( get ( this . _errors , ' length ' ) = = = 0 ) { <nl> + if ( get ( this . errors , ' length ' ) = = = 0 ) { <nl> this . _clearInvalidRequestErrors ( ) ; <nl> } <nl> } else { <nl> if ( <nl> this . _internalModel . currentState & & <nl> ! this . _internalModel . currentState . isValid & & <nl> - get ( this . _errors , ' length ' ) = = = 0 <nl> + get ( this . errors , ' length ' ) = = = 0 <nl> ) { <nl> this . _updateCurrentState ( updatedUncommitted ) ; <nl> } <nl> @ @ - 514 , 6 + 514 , 9 @ @ export default class MegamorphicModel extends EmberObject { <nl> / / Errors hash that will get update , <nl> / / upon validation errors <nl> get errors ( ) { <nl> + if ( this . _errors = = = null ) { <nl> + this . _errors = DS . Errors . create ( ) ; <nl> + } <nl> return this . _errors ; <nl> } <nl> } <nl> 
mmm a / packages / uploader / index . less <nl> ppp b / packages / uploader / index . less <nl> position : absolute ; <nl> - top : - 8px ; <nl> - right : - 8px ; <nl> + top : 0 ; <nl> + right : 0 ; <nl> + z - index : 1 ; <nl> + display : flex ; <nl> + padding : 10px ; <nl> + border - radius : 50 % ; <nl> + transform : translate ( 50 % , - 50 % ) ; <nl> + <nl> + & __icon { <nl> color : @ uploader - delete - color ; <nl> font - size : @ uploader - delete - icon - size ; <nl> background - color : @ uploader - delete - background - color ; <nl> - border - radius : 100 % ; <nl> + border - radius : 50 % ; <nl> + } <nl> } <nl> } <nl> 
mmm a / packages / uploader / index . less <nl> ppp b / packages / uploader / index . less <nl> & - delete { <nl> + position : absolute ; <nl> + top : 0 ; <nl> + right : 0 ; <nl> + width : @ uploader - delete - icon - size ; <nl> + height : @ uploader - delete - icon - size ; <nl> + padding : 0 0 @ padding - xs @ padding - xs ; <nl> + <nl> + & : : after { <nl> position : absolute ; <nl> top : 0 ; <nl> right : 0 ; <nl> width : @ uploader - delete - icon - size ; <nl> height : @ uploader - delete - icon - size ; <nl> background - color : @ uploader - delete - background - color ; <nl> - border - radius : 0 0 0 12px ; <nl> + border - radius : 0 0 0 @ uploader - delete - icon - size - 2px ; <nl> + content : ' ' ; <nl> + } <nl> & - icon { <nl> position : absolute ; <nl> top : - 2px ; <nl> right : - 2px ; <nl> - color : # fff ; <nl> + z - index : 1 ; <nl> color : @ uploader - delete - color ; <nl> font - size : 16px ; <nl> transform : scale ( 0 . 5 ) ; <nl> 
mmm a / packages / sticky / index . ts <nl> ppp b / packages / sticky / index . ts <nl> return prev ; <nl> } , { } ) ; <nl> + if ( Object . keys ( diff ) . length > 0 ) { <nl> this . setData ( diff ) ; <nl> + } <nl> this . $ emit ( ' scroll ' , { <nl> scrollTop : this . scrollTop , <nl> 
mmm a / packages / swipe - cell / index . ts <nl> ppp b / packages / swipe - cell / index . ts <nl> } <nl> this . dragging = true ; <nl> - ARRAY . filter ( ( item ) = > item ! = = this ) . forEach ( ( item ) = > item . close ( ) ) ; <nl> + <nl> + ARRAY . filter ( <nl> + ( item ) = > item ! = = this & & item . offset ! = = 0 <nl> + ) . forEach ( ( item ) = > item . close ( ) ) ; <nl> + <nl> this . setData ( { catchMove : true } ) ; <nl> this . swipeMove ( this . startOffset + this . deltaX ) ; <nl> } , <nl> 
mmm a / packages / picker / toolbar . wxml <nl> ppp b / packages / picker / toolbar . wxml <nl> - < view <nl> - wx : if = " { { showToolbar } } " <nl> - class = " van - picker__toolbar toolbar - class " <nl> - > <nl> + < view wx : if = " { { showToolbar } } " class = " van - picker__toolbar toolbar - class " > <nl> < view <nl> class = " van - picker__cancel " <nl> hover - class = " van - picker__cancel - - hover " <nl> { { confirmButtonText } } <nl> < / view > <nl> < / view > <nl> - < / template > <nl> 
mmm a / app / components / search - input / dropdown . js <nl> ppp b / app / components / search - input / dropdown . js <nl> classNames : [ ' ds - dropdown - menu ' , ' ds - with - 1 ' ] , <nl> attributeBindings : [ ' role ' ] , <nl> - <nl> / / Massage data to make it easier for displaying on the template <nl> / / Returned object : <nl> / * * <nl> 
mmm a / lib / config / exec . js <nl> ppp b / lib / config / exec . js <nl> } <nl> var options = utils . clone ( nodemonOptions | | { } ) ; <nl> + var script ; <nl> / / if there ' s no script passed , try to get it from the first argument <nl> if ( ! options . script & & ( options . args | | [ ] ) . length ) { <nl> - const script = expandScript ( options . args [ 0 ] , <nl> + script = expandScript ( options . args [ 0 ] , <nl> options . ext & & ( ' . ' + ( options . ext | | ' js ' ) . split ( ' , ' ) [ 0 ] ) ) ; <nl> / / if the script was found , shift it off our args <nl> @ @ - 108 , 7 + 109 , 7 @ @ function exec ( nodemonOptions , execMap ) { <nl> } <nl> / / var options = utils . clone ( nodemonOptions | | { } ) ; <nl> - var script = path . basename ( options . script | | ' ' ) ; <nl> + script = path . basename ( options . script | | ' ' ) ; <nl> var scriptExt = path . extname ( script ) . slice ( 1 ) ; <nl> 
mmm a / bin / postinstall . js <nl> ppp b / bin / postinstall . js <nl> return ; <nl> } <nl> + const message = ' \ u001b [ 32mLove nodemon ? You can now support the project via the open collective : \ u001b [ 22m \ u001b [ 39m \ n > \ u001b [ 96m \ u001b [ 1mhttps : / / opencollective . com / nodemon / donate \ u001b [ 0m \ n ' ; <nl> + <nl> try { <nl> const Configstore = require ( ' configstore ' ) ; <nl> const pkg = require ( __dirname + ' / . . / package . json ' ) ; <nl> @ @ - 18 , 11 + 20 , 11 @ @ function main ( ) { <nl> const last = conf . get ( ' lastCheck ' ) ; <nl> if ( ! last | | now - week > last ) { <nl> - console . log ( ' \ u001b [ 32mLove nodemon ? You can now support the project via the open collective : \ u001b [ 22m \ u001b [ 39m \ n > \ u001b [ 96m \ u001b [ 1mhttps : / / opencollective . com / nodemon / donate \ u001b [ 0m \ n ' ) ; <nl> + console . log ( message ) ; <nl> conf . set ( ' lastCheck ' , now ) ; <nl> } <nl> } catch ( e ) { <nl> - console . log ( ' \ u001b [ 32mLove nodemon ? You can now support the project via the open collective : \ u001b [ 22m \ u001b [ 39m \ n > \ u001b [ 96m \ u001b [ 1mhttps : / / opencollective . com / nodemon / donate \ u001b [ 0m \ n ' ) ; <nl> + console . log ( message ) ; <nl> } <nl> } <nl> 
mmm a / src / build . js <nl> ppp b / src / build . js <nl> export default async function build ( options = { } ) { <nl> options . out = options . out | | ' dist ' ; <nl> - await premove ( options . out , { cwd : options . cwd } ) ; <nl> - <nl> / / @ todo remove this hack once registry . js is instantiable <nl> setCwd ( options . cwd ) ; <nl> options = await normalizeOptions ( options , ' build ' ) ; <nl> + await premove ( options . out ) ; <nl> + <nl> const bundleOutput = await bundleProd ( options ) ; <nl> const stats = bundleStats ( bundleOutput ) ; <nl> 
mmm a / packages / create - wmr / tpl / package . json <nl> ppp b / packages / create - wmr / tpl / package . json <nl> } , <nl> " dependencies " : { <nl> - " preact " : " ^ 10 . 5 . 12 " , <nl> - " preact - iso " : " ^ 0 . 2 . 0 " <nl> + " preact " : " latest " , <nl> + " preact - iso " : " latest " <nl> } , <nl> " devDependencies " : { <nl> - " wmr " : " ^ 1 . 0 . 0 " <nl> + " wmr " : " latest " <nl> } <nl> } <nl> 
mmm a / packages / wmr / src / build . js <nl> ppp b / packages / wmr / src / build . js <nl> options = await normalizeOptions ( options , ' build ' ) ; <nl> - await fs . rmdir ( options . out , { recursive : true } ) ; <nl> + / / Clears out the output folder without deleting it - - useful <nl> + / / when mounted with Docker and the like <nl> + ( await fs . readdir ( options . out ) ) . forEach ( async item = > { <nl> + item = path . join ( options . out , item ) ; <nl> + if ( ( await fs . stat ( item ) ) . isFile ( ) ) await fs . unlink ( item ) ; <nl> + else await fs . rmdir ( item , { recursive : true } ) ; <nl> + } ) ; <nl> const bundleOutput = await bundleProd ( options ) ; <nl> 
mmm a / packages / wmr / src / lib / prerender . js <nl> ppp b / packages / wmr / src / lib / prerender . js <nl> / / Grab the generated HTML file , which we ' ll use as a template : <nl> const tpl = await fs . readFile ( path . resolve ( cwd , out , ' index . html ' ) , ' utf - 8 ' ) ; <nl> - / / The first script in the file that is not external is assumed to have a <nl> + / / The last script in the file that is not external is assumed to have a <nl> / / ` prerender ` export <nl> let script ; <nl> const SCRIPT_TAG = / < script ( ? : \ s [ ^ > ] * ? ) ? \ s + src = ( [ ' " ] ? ) ( [ ^ > ] * ? ) \ 1 ( ? : \ s [ ^ > ] * ? ) ? > / g ; <nl> let match ; <nl> - while ( ( match = SCRIPT_TAG . exec ( tpl ) ) & & ! script ) { <nl> + while ( ( match = SCRIPT_TAG . exec ( tpl ) ) ) { <nl> / / Ignore external urls <nl> if ( ! match | | / ^ ( ? : https ? | file | data ) / . test ( match [ 2 ] ) ) continue ; <nl> @ @ - 103 , 7 + 103 , 7 @ @ async function workerCode ( { cwd , out , publicPath , customRoutes } ) { <nl> / / const App = m . default | | m [ Object . keys ( m ) [ 0 ] ] ; <nl> if ( typeof doPrerender ! = = ' function ' ) { <nl> - throw Error ( ` No prerender ( ) function was exported by the first < script src = " . . . " > in your index . html . ` ) ; <nl> + throw Error ( ` No prerender ( ) function was exported by the last non - external < script src = " . . . " > in your index . html . ` ) ; <nl> } <nl> / * * <nl> 
mmm a / src / domain / controls . test . js <nl> ppp b / src / domain / controls . test . js <nl> const action = setHierarchyConfig ( hierarchyConfig ) ; <nl> const result = reducer ( { } , action ) ; <nl> - expect ( selectControls ( result ) ) . to . deep . equal ( { <nl> - hierarchyConfig : hierarchyConfig , <nl> - shouldShowNodes : true , <nl> - darkTheme : false , <nl> - colorBy : null , <nl> - ' start ' : null , <nl> - ' end ' : null , <nl> - ' showBusy ' : false , <nl> - ' position ' : [ 0 , 0 ] , <nl> - ' datum ' : null / / <nl> - } ) ; <nl> + expect ( selectControls ( result ) . hierarchyConfig ) . to . deep . equal ( hierarchyConfig ) ; <nl> done ( ) ; <nl> } ) ; <nl> 
mmm a / src / features / visualization / d3 - viz / setup - tooltip . js <nl> ppp b / src / features / visualization / d3 - viz / setup - tooltip . js <nl> - * REFACTOR <nl> - * Effectively remove this Tooltip <nl> - * <nl> - * / <nl> - / / import { map , join , path } from " ramda " ; <nl> - / / import { select } from " d3 - selection " ; <nl> - <nl> - <nl> const setupTooltip = ( { nodeRoot , tooltip , fields } ) = > { <nl> tooltip <nl> . style ( " display " , " block " ) <nl> @ @ - 14 , 62 + 5 , 11 @ @ const setupTooltip = ( { nodeRoot , tooltip , fields } ) = > { <nl> . style ( " transform " , null ) <nl> . style ( " top " , " 0px " ) <nl> . style ( " left " , " 0px " ) ; <nl> - <nl> - / / const boundingRect = tooltip . node ( ) . getBoundingClientRect ( ) ; <nl> - <nl> - / / const offsetLeft = - boundingRect . left + 5 ; <nl> - / / const offsetTop = - boundingRect . top + 5 ; <nl> - <nl> / / Measurements need to be taken before hiding the tooltip , otherwise they are <nl> / / not accurate . <nl> tooltip . style ( " display " , " none " ) <nl> - <nl> - / * nodeRoot . on ( " mousemove " , ( ) = > { <nl> - const event = d3Event ; <nl> - showTooltip ( event , fields , offsetTop , offsetLeft , tooltip ) ; <nl> - } ) ; * / <nl> - <nl> } ; <nl> - / * <nl> - const showTooltip = ( event , fields , offsetTop , offsetLeft , tooltip ) = > { <nl> - const target = select ( event . target ) ; <nl> - const datum = target . datum ( ) ; <nl> - const text = content ( datum , fields ) ; <nl> - let transformX = event . x + offsetLeft + 1 <nl> - let transformY = event . y + offsetTop + 1 <nl> - if ( text ) { <nl> - tooltip . node ( ) . innerHTML = text ; <nl> - tooltip <nl> - . style ( " display " , " block " ) <nl> - . style ( " transform " , ` translate3d ( $ { transformX } px , $ { transformY } px , 0 ) ` ) <nl> - / / console . log ( transformX , transformY ) <nl> - } else { <nl> - tooltip . style ( " display " , " none " ) ; <nl> - } <nl> - <nl> - <nl> - } ; <nl> - <nl> - const content = ( datum , fields ) = > { <nl> - if ( datum . depth > 0 & & datum . height > 0 ) { <nl> - let cont = ` $ { datum . data . fieldValue } ( $ { datum . value } ) ` ; <nl> - if ( datum . data . CRVIZ . _searchResultCount > 0 ) { <nl> - cont + = ` < br / > < span > $ { datum . data . CRVIZ . _searchResultCount } search results < / span > ` <nl> - } <nl> - return cont ; <nl> - } else if ( datum . height = = = 0 ) { <nl> - const pairs = map ( <nl> - ( field ) = > [ ` < strong > $ { field . displayName } < / strong > ` , path ( field . path , datum . data ) ] , <nl> - fields <nl> - ) ; <nl> - <nl> - return map ( join ( " : " ) , pairs ) . join ( " < br / > " ) ; <nl> - } else { <nl> - return null ; <nl> - } <nl> - } ; <nl> - * / <nl> export default setupTooltip ; <nl> 
mmm a / src / features / visualization / d3 - viz . js <nl> ppp b / src / features / visualization / d3 - viz . js <nl> nodeRoot . on ( " click . select " , ( ) = > { <nl> const datum = select ( d3Event . target ) . datum ( ) ; <nl> - if ( datum . data ! = = undefined ) { props . sendData ( datum . data ) } / / Used to send data back to parent component Visualizations . js <nl> + if ( datum . data ! = = undefined ) { <nl> + / / Used to send data back to parent component Visualizations . js <nl> + props . sendData ( datum . data ) ; <nl> + } ; <nl> let zoomToNode = datum ; <nl> if ( datum . height = = = 0 & & datum . parent ) { <nl> zoomToNode = datum . parent ; <nl> @ @ - 290 , 4 + 293 , 4 @ @ const findAncestor = ( node , hierarchy ) = > { <nl> return res ; <nl> } ; <nl> - export default d3Viz <nl> + export default d3Viz ; <nl> 
mmm a / src / features / tooltip / Tooltip . js <nl> ppp b / src / features / tooltip / Tooltip . js <nl> - import { addNote , removeNote , getNotesIndexedByHash } from ' domain / notes ' ; <nl> + <nl> / / Styling <nl> import { FontAwesomeIcon } from ' @ fortawesome / react - fontawesome ' ; <nl> @ @ - 10 , 6 + 10 , 7 @ @ import tooltipStyle from ' . / Tooltip . module . css ' ; <nl> / / / Redux <nl> import { connect } from " react - redux " ; <nl> import { getPosition , getSelectedDatum } from ' domain / controls ' ; <nl> + import { addNote , removeNote , getNotesIndexedByHash } from ' domain / notes ' ; <nl> class TooltipControls extends React . Component { <nl> constructor ( props ) { <nl> @ @ - 191 , 7 + 192 , 7 @ @ class TooltipControls extends React . Component { <nl> } <nl> { ! this . props . data . fieldValue & & <nl> < p className = { appStyle . accordionHeader } onClick = { this . toggleShowNote } > <nl> - Notes { ! showNote & & < FontAwesomeIcon icon = { faAngleDoubleDown } / > } { showNote & & < FontAwesomeIcon onClick = { this . toggleShowNote } icon = { faAngleDoubleUp } / > } <nl> + Note { ! showNote & & < FontAwesomeIcon icon = { faAngleDoubleDown } / > } { showNote & & < FontAwesomeIcon onClick = { this . toggleShowNote } icon = { faAngleDoubleUp } / > } <nl> < / p > <nl> } <nl> 
mmm a / src / components / Badge / badge . test . js <nl> ppp b / src / components / Badge / badge . test . js <nl> import Badge from ' . / ' <nl> - import ThemeProvider from ' . . / ThemeProvider ' <nl> import theme from ' . . / . . / lib / theme ' <nl> describe ( ' = = = = = Badge Component = = = = = ' , ( ) = > { <nl> describe ( ' Instance TEsts ' , ( ) = > { <nl> it ( ' should be a Vue instance ' , ( ) = > { <nl> - const wrapper = shallowMount ( ThemeProvider , { <nl> - propsData : { <nl> - theme , <nl> - colorMode : ' light ' <nl> - } , <nl> - slots : { <nl> - default : [ Badge ] <nl> + const badge = shallowMount ( Badge , { <nl> + provide ( ) { <nl> + return { <nl> + $ theme : ( ) = > theme , <nl> + $ colorMode : ' light ' <nl> + } <nl> } <nl> } ) <nl> - expect ( wrapper . isVueInstance ( ) ) . toBeTruthy ( ) <nl> - expect ( wrapper . find ( Badge ) . vm . $ theme ( ) ) . toBe ( theme ) <nl> - expect ( wrapper . find ( Badge ) . vm . $ colorMode ) . toBe ( ' light ' ) <nl> + expect ( badge . isVueInstance ( ) ) . toBeTruthy ( ) <nl> + expect ( badge . vm . $ theme ( ) ) . toBe ( theme ) <nl> + expect ( badge . vm . $ colorMode ) . toBe ( ' light ' ) <nl> } ) <nl> } ) <nl> } ) <nl> 
mmm a / src / App . vue <nl> ppp b / src / App . vue <nl> - < Box w = " 300px " > <nl> - < Button @ click = " isOpen = true " > Open Modal < / Button > <nl> - < Modal : isOpen = " isOpen " > <nl> - < ModalContent > <nl> - < ModalHeader > <nl> - < h3 > Modal Header < / h3 > <nl> - < / ModalHeader > <nl> - < ModalBody > <nl> - < Lorem add = " 2s " / > <nl> - < / ModalBody > <nl> - < ModalFooter > <nl> - < Button mr = " 3 " > Cancel < / Button > <nl> - < Button id = " delete " variantColor = " red " > Delete Account < / Button > <nl> - < / ModalFooter > <nl> - < ModalCloseButton @ click = " isOpen = false " / > <nl> - < / ModalContent > <nl> - < ModalOverlay / > <nl> - < / Modal > <nl> + < Box > <nl> + < AlertDialog <nl> + : is - open = " isOpen " <nl> + : least - destructive - ref = " $ refs . cancelRef " <nl> + : on - close = " close " <nl> + > <nl> + < AlertDialogOverlay / > <nl> + < AlertDialogContent > <nl> + < AlertDialogHeader font - size = " lg " font - weight = " bold " > <nl> + Delete Customer <nl> + < / AlertDialogHeader > <nl> + <nl> + < AlertDialogBody > <nl> + Are you sure ? You can ' t undo this action afterwards . <nl> + < / AlertDialogBody > <nl> + <nl> + < AlertDialogFooter > <nl> + < Button ref = " cancelRef " @ click = " close " > <nl> + Cancel <nl> + < / Button > <nl> + < Button variantColor = " red " @ click = " close " ml = " 3 " > <nl> + Delete <nl> + < / Button > <nl> + < / AlertDialogFooter > <nl> + < / AlertDialogContent > <nl> + < / AlertDialog > <nl> + < Button variant - color = " red " @ click = " open " > <nl> + Delete Customer <nl> + < / Button > <nl> < / Box > <nl> < / template > <nl> import { <nl> Box , <nl> Button , <nl> - Modal , <nl> - ModalOverlay , <nl> - ModalContent , <nl> - ModalHeader , <nl> - ModalFooter , <nl> - ModalBody , <nl> - ModalCloseButton } from ' . . / packages / kiwi - core / dist / esm ' <nl> - import Lorem from ' vue - lorem - ipsum ' <nl> + AlertDialog , <nl> + AlertDialogContent , <nl> + AlertDialogBody , <nl> + AlertDialogFooter , <nl> + AlertDialogOverlay , <nl> + AlertDialogHeader } from ' . . / packages / kiwi - core / dist / esm ' <nl> export default { <nl> name : ' App ' , <nl> @ @ - 39 , 14 + 48 , 12 @ @ export default { <nl> components : { <nl> Box , <nl> Button , <nl> - Modal , <nl> - ModalOverlay , <nl> - ModalContent , <nl> - ModalHeader , <nl> - ModalFooter , <nl> - ModalBody , <nl> - ModalCloseButton , <nl> - Lorem <nl> + AlertDialog , <nl> + AlertDialogContent , <nl> + AlertDialogBody , <nl> + AlertDialogFooter , <nl> + AlertDialogOverlay , <nl> + AlertDialogHeader <nl> } , <nl> data ( ) { <nl> return { <nl> @ @ - 67 , 6 + 74 , 12 @ @ export default { <nl> handleChange : ( value ) = > console . log ( value ) , <nl> focusRadioGroup ( ) { <nl> this . $ refs . rg . focus ( ) <nl> + } , <nl> + open ( ) { <nl> + this . isOpen = true <nl> + } , <nl> + close ( ) { <nl> + this . isOpen = false <nl> } <nl> } <nl> } <nl> 
mmm a / packages / kiwi - core / src / Tooltip / index . js <nl> ppp b / packages / kiwi - core / src / Tooltip / index . js <nl> import VisuallyHidden from ' . . / VisuallyHidden ' <nl> import { Popper , PopperArrow } from ' . . / Popper ' <nl> - import { cloneVNode , useId , forwardProps , wrapEvent , canUseDOM } from ' . . / utils ' <nl> + import { cloneVNode , useId , forwardProps , wrapEvent } from ' . . / utils ' <nl> import { baseProps } from ' . . / config / props ' <nl> import Box from ' . . / Box ' <nl> @ @ - 91 , 6 + 91 , 7 @ @ const Tooltip = { <nl> / / Attached immediately . <nl> this . $ nextTick ( ( ) = > { <nl> this . noop + + <nl> + this . tooltipAnchor = document . querySelector ( ` [ x - tooltip - anchor = $ { this . tooltipId } ] ` ) <nl> } ) <nl> } , <nl> render ( h ) { <nl> @ @ - 164 , 12 + 165 , 6 @ @ const Tooltip = { <nl> } <nl> } <nl> - / / If current environment is server - side we return the clone child <nl> - if ( ! canUseDOM ) { <nl> - return clone <nl> - } <nl> - <nl> - this . tooltipAnchor = document . querySelector ( ` [ x - tooltip - anchor = $ { this . tooltipId } ] ` ) <nl> return h ( Fragment , [ <nl> clone , <nl> h ( Popper , { <nl> 
mmm a / packages / chakra - ui - core / src / CButton / CButton . js <nl> ppp b / packages / chakra - ui - core / src / CButton / CButton . js <nl> * / <nl> const CButton = { <nl> name : ' CButton ' , <nl> - inheritAttrs : false , <nl> inject : [ ' $ chakraTheme ' , ' $ chakraColorMode ' ] , <nl> props : buttonProps , <nl> computed : { <nl> 
mmm a / packages / chakra - ui - core / src / CProgress / CProgress . js <nl> ppp b / packages / chakra - ui - core / src / CProgress / CProgress . js <nl> import CBox from ' . . / CBox ' <nl> - import { generateStripe , valueToPercent , forwardProps } from ' . . / utils ' <nl> - import { baseProps } from ' . . / config / props ' <nl> + import { generateStripe , valueToPercent , createStyledAttrsMixin } from ' . . / utils ' <nl> const stripe = keyframes ( { <nl> from : { backgroundPosition : ' 1rem 0 ' } , <nl> @ @ - 39 , 18 + 38 , 20 @ @ const progressbarSizes = { <nl> * / <nl> const CProgressLabel = { <nl> name : ' CProgressLabel ' , <nl> - props : baseProps , <nl> - render ( h ) { <nl> + functional : true , <nl> + render ( h , { data , slots , . . . rest } ) { <nl> return h ( CBox , { <nl> + . . . rest , <nl> props : { <nl> - textAlign : ' center ' , <nl> - width : ' 100 % ' , <nl> - . . . forwardProps ( this . $ props ) <nl> + as : data . attrs . as <nl> } , <nl> attrs : { <nl> + textAlign : ' center ' , <nl> + width : ' 100 % ' , <nl> + . . . data . attrs , <nl> ' data - chakra - component ' : ' CProgressLabel ' <nl> } <nl> - } , this . $ slots . default ) <nl> + } , slots ( ) . default ) <nl> } <nl> } <nl> @ @ - 64 , 23 + 65 , 22 @ @ const CProgressLabel = { <nl> * / <nl> const CProgressTrack = { <nl> name : ' CProgressTrack ' , <nl> + functional : true , <nl> props : { <nl> - . . . baseProps , <nl> size : [ String , Number , Array ] <nl> } , <nl> - render ( h ) { <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> return h ( CBox , { <nl> - props : { <nl> + . . . rest , <nl> + attrs : { <nl> pos : ' relative ' , <nl> - height : progressbarSizes [ this . size | | ' md ' ] , <nl> + height : progressbarSizes [ props . size | | ' md ' ] , <nl> overflow : ' hidden ' , <nl> w : ' 100 % ' , <nl> - . . . forwardProps ( this . $ props ) <nl> - } , <nl> - attrs : { <nl> + . . . data . attrs , <nl> ' data - chakra - component ' : ' CProgressTrack ' <nl> } <nl> - } , this . $ slots . default ) <nl> + } , slots ( ) . default ) <nl> } <nl> } <nl> @ @ - 93 , 9 + 93 , 8 @ @ const CProgressTrack = { <nl> * @ see Docs https : / / vue . chakra - ui . com / progress <nl> * / <nl> const CProgressIndicator = { <nl> - name : ' CProgressIndicator ' , <nl> + mixins : [ createStyledAttrsMixin ( ' CProgressIndicator ' ) ] , <nl> props : { <nl> - . . . baseProps , <nl> isIndeterminate : Boolean , <nl> min : Number , <nl> max : Number , <nl> @ @ - 104 , 23 + 103 , 27 @ @ const CProgressIndicator = { <nl> computed : { <nl> percent ( ) { <nl> return valueToPercent ( this . value , this . min , this . max ) <nl> - } <nl> } , <nl> - render ( h ) { <nl> - return h ( CBox , { <nl> - props : { <nl> + componentStyles ( ) { <nl> + return { <nl> height : ' 100 % ' , <nl> transition : ' all 0 . 3s ' , <nl> - width : ` $ { this . percent } % ` , <nl> - . . . forwardProps ( this . $ props ) <nl> + width : ` $ { this . percent } % ` <nl> + } <nl> + } <nl> } , <nl> + render ( h ) { <nl> + return h ( this . as | | ' div ' , { <nl> + class : [ this . className ] , <nl> attrs : { <nl> + . . . this . computedAttrs , <nl> ' aria - valuemax ' : this . max , <nl> ' aria - valuemin ' : this . min , <nl> ' aria - valuenow ' : this . isIndeterminate ? null : this . value , <nl> role : ' progressbar ' , <nl> ' data - chakra - component ' : ' CProgressIndicator ' <nl> - } <nl> + } , <nl> + on : this . computedListeners <nl> } , this . $ slots . default ) <nl> } <nl> } <nl> @ @ - 135 , 9 + 138 , 9 @ @ const CProgressIndicator = { <nl> * / <nl> const CProgress = { <nl> name : ' CProgress ' , <nl> + inheritAttrs : false , <nl> inject : [ ' $ chakraColorMode ' ] , <nl> props : { <nl> - . . . baseProps , <nl> color : { <nl> type : String , <nl> default : ' blue ' <nl> @ @ - 201 , 13 + 204 , 13 @ @ const CProgress = { <nl> return h ( CProgressTrack , { <nl> props : { <nl> - size : this . size , <nl> - bg : trackColor [ this . colorMode ] , <nl> - borderRadius : _borderRadius , <nl> - . . . forwardProps ( this . $ props ) <nl> + size : this . size <nl> } , <nl> attrs : { <nl> - ' data - chakra - component ' : ' CProgress ' <nl> + bg : trackColor [ this . colorMode ] , <nl> + borderRadius : _borderRadius , <nl> + ' data - chakra - component ' : ' CProgress ' , <nl> + . . . this . $ attrs <nl> } <nl> } , [ <nl> h ( CProgressIndicator , { <nl> @ @ - 218 , 7 + 221 , 9 @ @ const CProgress = { <nl> props : { <nl> min : this . min , <nl> max : this . max , <nl> - value : this . value , <nl> + value : this . value <nl> + } , <nl> + attrs : { <nl> bg : indicatorColor [ this . colorMode ] , <nl> borderRadius : this . __borderRadius , <nl> . . . this . isIndeterminate & & { <nl> 
mmm a / packages / chakra - ui - core / src / CStat / CStat . js <nl> ppp b / packages / chakra - ui - core / src / CStat / CStat . js <nl> * / <nl> const CStat = { <nl> name : ' CStat ' , <nl> - extends : CBox , <nl> - render ( h ) { <nl> - const children = cleanChildren ( this . $ slots . default ) <nl> + functional : true , <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> + const children = cleanChildren ( slots ( ) . default ) <nl> return h ( CBox , { <nl> - props : { <nl> + . . . rest , <nl> + props : { as : props . as } , <nl> + attrs : { <nl> flex : 1 , <nl> pr : 4 , <nl> position : ' relative ' , <nl> - . . . forwardProps ( this . $ props ) <nl> - } , <nl> - attrs : { <nl> + . . . ( data . attrs | | { } ) , <nl> ' data - chakra - component ' : ' CStat ' <nl> } <nl> } , children ) <nl> @ @ - 65 , 17 + 65 , 20 @ @ const CStat = { <nl> * / <nl> const CStatGroup = { <nl> name : ' CStatGroup ' , <nl> - extends : CFlex , <nl> - render ( h ) { <nl> - const children = cleanChildren ( this . $ slots . default ) <nl> + functional : true , <nl> + props : CFlex . props , <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> + const children = cleanChildren ( slots ( ) . default ) <nl> return h ( CFlex , { <nl> + . . . rest , <nl> props : { <nl> flexWrap : ' wrap ' , <nl> justifyContent : ' space - around ' , <nl> alignItems : ' flex - start ' , <nl> - . . . forwardProps ( this . $ props ) <nl> + . . . forwardProps ( props ) <nl> } , <nl> attrs : { <nl> + . . . ( data . attrs | | { } ) , <nl> ' data - chakra - component ' : ' CStatGroup ' <nl> } <nl> } , children ) <nl> @ @ - 92 , 23 + 95 , 27 @ @ const CStatGroup = { <nl> * / <nl> const CStatArrow = { <nl> name : ' CStatArrow ' , <nl> - extends : CIcon , <nl> + functional : true , <nl> props : { <nl> + . . . CIcon . props , <nl> type : { <nl> type : String , <nl> default : ' increase ' <nl> } <nl> } , <nl> - render ( h ) { <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> return h ( CIcon , { <nl> + . . . rest , <nl> props : { <nl> - mr : 1 , <nl> size : ' 14px ' , <nl> - verticalAlign : ' middle ' , <nl> - . . . arrowOptions [ this . type ] , <nl> - . . . forwardProps ( this . $ props ) <nl> + . . . arrowOptions [ props . type ] , <nl> + . . . forwardProps ( props ) <nl> } , <nl> attrs : { <nl> + mr : 1 , <nl> + verticalAlign : ' middle ' , <nl> + . . . ( data . attrs | | { } ) , <nl> + color : arrowOptions [ props . type ] . color , <nl> ' data - chakra - component ' : ' CStatArrow ' <nl> } <nl> } ) <nl> @ @ - 125 , 19 + 132 , 20 @ @ const CStatArrow = { <nl> * / <nl> const CStatNumber = { <nl> name : ' CStatNumber ' , <nl> - extends : CText , <nl> - render ( h ) { <nl> + functional : true , <nl> + props : CText . props , <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> return h ( CText , { <nl> - props : { <nl> + . . . rest , <nl> + props : forwardProps ( props ) , <nl> + attrs : { <nl> fontSize : ' 2xl ' , <nl> verticalAlign : ' baseline ' , <nl> fontWeight : ' semibold ' , <nl> - . . . forwardProps ( this . $ props ) <nl> - } , <nl> - attrs : { <nl> + . . . ( data . attrs | | { } ) , <nl> ' data - chakra - component ' : ' CStatNumber ' <nl> } <nl> - } , this . $ slots . default ) <nl> + } , slots ( ) . default ) <nl> } <nl> } <nl> @ @ - 151 , 16 + 159 , 20 @ @ const CStatNumber = { <nl> * / <nl> const CStatHelperText = { <nl> name : ' CStatHelperText ' , <nl> - extends : CText , <nl> - render ( h ) { <nl> + functional : true , <nl> + props : CText . props , <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> return h ( CText , { <nl> - props : { <nl> + . . . rest , <nl> + props : forwardProps ( props ) , <nl> + attrs : { <nl> fontSize : ' sm ' , <nl> opacity : 0 . 8 , <nl> mb : 2 , <nl> - . . . forwardProps ( this . $ props ) <nl> + . . . ( data . attrs | | { } ) , <nl> + ' data - chakra - component ' : ' CStatHelperText ' <nl> } <nl> - } , this . $ slots . default ) <nl> + } , slots ( ) . default ) <nl> } <nl> } <nl> @ @ - 174 , 18 + 186 , 19 @ @ const CStatHelperText = { <nl> * / <nl> const CStatLabel = { <nl> name : ' CStatLabel ' , <nl> - extends : CText , <nl> - render ( h ) { <nl> + functional : true , <nl> + props : CText . props , <nl> + render ( h , { props , slots , data , . . . rest } ) { <nl> return h ( CText , { <nl> - props : { <nl> + . . . rest , <nl> + props : forwardProps ( props ) , <nl> + attrs : { <nl> fontWeight : ' medium ' , <nl> fontSize : ' sm ' , <nl> - . . . forwardProps ( this . $ props ) <nl> - } , <nl> - attrs : { <nl> + . . . ( data . attrs | | { } ) , <nl> ' data - chakra - component ' : ' CStatLabel ' <nl> } <nl> - } , this . $ slots . default ) <nl> + } , slots ( ) . default ) <nl> } <nl> } <nl> 
mmm a / website / pages / contributors . vue <nl> ppp b / website / pages / contributors . vue <nl> - < c - image : src = " require ( ' @ / assets / logo / chakra - ui - vue - blue @ 2x . png ' ) " / > <nl> - <nl> < c - box > <nl> < c - box v - for = " ( person , _i ) in contributors " : key = " _i " bb = " 1px solid " border - color = " gray . 200 " p = " 3 " > <nl> < c - text font - weight = " bold " mt = " 3 " font - size = " 1 . 3rem " > <nl> 
mmm a / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> ppp b / packages / chakra - ui - core / src / CInputGroup / CInputGroup . js <nl> const clone = cloneVNode ( vnode , h ) <nl> return h ( clone . componentOptions . Ctor , { <nl> . . . clone . data , <nl> - on : { <nl> - . . . ( clone . componentOptions . listeners | | { } ) <nl> - } , <nl> + on : ( clone . componentOptions . listeners | | { } ) , <nl> props : { <nl> . . . ( clone . data . props | | { } ) , <nl> . . . clone . componentOptions . propsData , <nl> 
mmm a / src / lib / author . svelte <nl> ppp b / src / lib / author . svelte <nl> + import { onMount } from ' svelte ' <nl> + <nl> export let author <nl> + const getUserDetails = async ( ) = > { <nl> + const res = await fetch ( ` / $ { author } . json ` ) <nl> + return await res . json ( ) <nl> + } <nl> + let data = { } <nl> + onMount ( async ( ) = > { <nl> + data = await getUserDetails ( ) <nl> + } ) <nl> < / script > <nl> - < small > { author } < / small > <nl> + < p class = " text - sm " > Contribution by : < / p > <nl> + < article <nl> + class = " not - prose border border - primary shadow - lg p - 4 rounded - 2xl " <nl> + > <nl> + < div class = " flex space - x - 5 justify - evenly " > <nl> + < a href = { data . html_url } target = " _blank " rel = " noopener " > <nl> + < img <nl> + class = " w - 20 h - 20 p - 0 m - 0 rounded - full " <nl> + src = { data . avatar_url } <nl> + alt = { data . name } <nl> + / > <nl> + < / a > <nl> + < a href = { data . html_url } target = " _blank " rel = " noopener " > <nl> + < div class = " text - sm " > <nl> + < p class = " text - lg font - bold tracking - widest " > { data . name } < / p > <nl> + < p > { data . bio } < / p > <nl> + < / div > <nl> + < / a > <nl> + < / div > <nl> + < / article > <nl> 
mmm a / svelte . config . js <nl> ppp b / svelte . config . js <nl> import { mdsvex } from ' mdsvex ' <nl> + import path from ' path ' <nl> import preprocess from ' svelte - preprocess ' <nl> import mdsvexConfig from ' . / mdsvex . config . js ' <nl> @ @ - 17 , 6 + 18 , 11 @ @ const config = { <nl> allow : [ ' . . ' ] , <nl> } , <nl> } , <nl> + resolve : { <nl> + alias : { <nl> + ' $ lib ' : path . resolve ( ' . / src / lib ' ) , <nl> + } , <nl> + } , <nl> } , <nl> } , <nl> 
mmm a / sheets / javascript . md <nl> ppp b / sheets / javascript . md <nl> slug : javascript <nl> - - - <nl> + < script > <nl> + import Author from ' $ lib / author . svelte ' <nl> + < / script > <nl> + <nl> # # Document Design Mode <nl> Edit a web page , set the design mode to on . <nl> @ @ - 475 , 20 + 479 , 22 @ @ error when used on any undeclared root object , so no escaping the <nl> # # Unique Array of Values with Set and Spread Operator [ ES6 ] <nl> + < Author author = " anniebombanie " / > <nl> + <nl> Thanks to [ Annie Liew ] for this one . <nl> - In ES6 , Set objects are collections of values . <nl> - Set uses strict equality ( ` = = = ` ) to check values & each value may only occur once . <nl> - We use the spread operator to convert the Set object into an array . <nl> + In ES6 , Set objects are collections of values . Set uses strict <nl> + equality ( ` = = = ` ) to check values & each value may only occur once . We <nl> + use the spread operator to convert the Set object into an array . <nl> ` ` ` js <nl> - const numArr = [ 1 , 1 , 1 , 2 , 3 ] ; <nl> + const numArr = [ 1 , 1 , 1 , 2 , 3 ] <nl> / / ( 5 ) [ 1 , 1 , 1 , 2 , 3 ] <nl> - const uniqueNumSet = new Set ( numArr ) ; <nl> + const uniqueNumSet = new Set ( numArr ) <nl> / / Set ( 3 ) { 1 , 2 , 3 } <nl> - const uniqueNumArr = [ . . . new Set ( numArr ) ] ; <nl> + const uniqueNumArr = [ . . . new Set ( numArr ) ] <nl> / / ( 3 ) [ 1 , 2 , 3 ] <nl> ` ` ` <nl> @ @ - 496 , 17 + 502 , 24 @ @ If you prefer something a bit more explicit , you can do this instead : <nl> ` const uniqueNumArr = Array . from ( uniqueNumSet ) ` <nl> # # Convert an array of objects into a single object <nl> - If you have an array of objects , you can convert that list of objects into a single object by using [ ` Object . assign ( ) ` ] [ Object . assign ] and [ spread syntax ] [ spread syntax ] . The ` Object . assign ( ) ` method copies all enumerable own properties from one or more source objects to a target object and it returns the modified target object . We use spread syntax ` . . . ` on the array ` items ` so that each object in the array can be " expanded " in places where key - value pairs exists . <nl> + <nl> + If you have an array of objects , you can convert that list of objects <nl> + into a single object by using [ ` Object . assign ( ) ` ] [ object . assign ] and <nl> + [ spread syntax ] [ spread syntax ] . The ` Object . assign ( ) ` method copies <nl> + all enumerable own properties from one or more source objects to a <nl> + target object and it returns the modified target object . We use spread <nl> + syntax ` . . . ` on the array ` items ` so that each object in the array can <nl> + be " expanded " in places where key - value pairs exists . <nl> ` ` ` js <nl> const items = [ <nl> { address : ' 123 ABC street ' } , <nl> { isLeased : false } , <nl> - { hasPool : true } <nl> + { hasPool : true } , <nl> ] <nl> - const obj = Object . assign ( { } , . . . items ) ; <nl> - console . log ( obj ) ; <nl> + const obj = Object . assign ( { } , . . . items ) <nl> + console . log ( obj ) <nl> / / { " address " : " 123 ABC street " , " isLeased " : false , " hasPool " : true } <nl> ` ` ` <nl> @ @ - 515 , 6 + 528 , 8 @ @ console . log ( obj ) ; <nl> [ nicky meuleman ] : https : / / twitter . com / NMeuleman <nl> [ optional chaining ] : <nl> https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Operators / Optional_chaining <nl> - [ Object . assign ] : https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Global_Objects / Object / assign <nl> - [ spread syntax ] : https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Operators / Spread_syntax <nl> + [ object . assign ] : <nl> + https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Global_Objects / Object / assign <nl> + [ spread syntax ] : <nl> + https : / / developer . mozilla . org / en - US / docs / Web / JavaScript / Reference / Operators / Spread_syntax <nl> [ annie liew ] : https : / / twitter . com / anniebombanie_ <nl> 
mmm a / src / lib / author . svelte <nl> ppp b / src / lib / author . svelte <nl> < div class = " text - sm " > <nl> < p class = " text - lg font - bold tracking - widest " > { data . name } < / p > <nl> - < p > { data . bio } < / p > <nl> + < p > { data . bio | | ` ` } < / p > <nl> < / div > <nl> < / a > <nl> < / div > <nl> 
mmm a / src / routes / [ slug ] . svelte <nl> ppp b / src / routes / [ slug ] . svelte <nl> < script > <nl> - import { Head } from ' svead ' <nl> - import { description , website } from ' $ lib / info ' <nl> + import { page } from ' $ app / stores ' <nl> import { ogImageUrl } from ' $ lib / og - image - url - build ' <nl> import TableOfContents from ' $ lib / table - of - contents . svelte ' <nl> import { format } from ' date - fns ' <nl> + import { Head } from ' svead ' <nl> import { onMount } from ' svelte ' <nl> export let Post , metadata <nl> } <nl> } ) <nl> } ) <nl> + let url = $ page . url . toString ( ) <nl> < / script > <nl> < Head <nl> ' cheatsheets . xyz ' , <nl> metadata . title <nl> ) } <nl> - url = { ` $ { website } / $ { metadata . slug } ` } <nl> + { url } <nl> / > <nl> { # await getHeadings ( ) } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " predeploy : docs " : " cross - env NODE_ENV = production yarn build : docs & & yarn build : docs - cname " , <nl> " deploy : docs " : " gh - pages - d docs / build - m ' deploy docs [ ci skip ] ' " , <nl> + " postdeploy : docs " : " github_changelog_generator & & gach ' docs ( changelog ) : update changelog [ ci skip ] " , <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> " lint : fix " : " yarn lint - - - - fix " , <nl> " prerelease " : " yarn lint & & yarn tsd : lint & & npm test & & cross - env NODE_ENV = production yarn build " , <nl> - " postrelease " : " NODE_ENV = production yarn deploy : docs " , <nl> - " prerelease : major " : " yarn prerelease " , <nl> - " prerelease : minor " : " yarn prerelease " , <nl> - " prerelease : patch " : " yarn prerelease " , <nl> - " release : major " : " ta - script npm / release major " , <nl> - " release : minor " : " ta - script npm / release minor " , <nl> - " release : patch " : " ta - script npm / release patch " , <nl> + " postrelease " : " yarn deploy : docs " , <nl> + " release : major " : " yarn prerelease & & ta - script npm / release major & & yarn postrelease " , <nl> + " release : minor " : " yarn prerelease & & ta - script npm / release minor & & yarn postrelease " , <nl> + " release : patch " : " yarn prerelease & & ta - script npm / release patch & & yarn postrelease " , <nl> " prestart " : " yarn satisfied - - - - fix yarn " , <nl> " start " : " yarn docs " , <nl> " satisfied " : " satisfied - - skip - invalid " , <nl> 
mmm a / frontend / leaderboard / src / Types . re <nl> ppp b / frontend / leaderboard / src / Types . re <nl> each UserCommand and InternalCommand to it ' s associated block . <nl> * / <nl> let parseBlocks = blocks = > { <nl> - let blocks = <nl> Belt . Map . Int . ( <nl> blocks <nl> | > Array . fold_left ( <nl> @ @ - 234 , 8 + 233 , 6 @ @ module Block = { <nl> ) <nl> | > valuesToArray <nl> ) ; <nl> - <nl> - blocks ; <nl> } ; <nl> } ; <nl> 
mmm a / frontend / leaderboard / src / Types . re <nl> ppp b / frontend / leaderboard / src / Types . re <nl> . . . block . blockchainState , <nl> coinbaseReceiver , <nl> } ; <nl> - let updatedBlock = { . . . block , blockchainState : updatedBlockchainState } ; <nl> - updatedBlock ; <nl> + { . . . block , blockchainState : updatedBlockchainState } ; <nl> | None = > block <nl> } ; <nl> } ; <nl> 
mmm a / src / system / interpreter . js <nl> ppp b / src / system / interpreter . js <nl> / / s : stack pointer ( = index of stack top + 1 ) <nl> shift_args : function ( n , m , s ) { <nl> for ( var i = n - 1 ; i > = - 1 ; i - - ) { <nl> - this . index_set ( s , i + m + 1 , this . index ( s , i ) ) ; <nl> + this . index_set ( s , i + m + 1 , this . index ( s , i + 1 ) ) ; <nl> } <nl> return s - m - 1 ; <nl> } , <nl> index : function ( s , i ) { <nl> - return this . stack [ s - i - 2 ] ; <nl> + return this . stack [ ( s - 1 ) - i ] ; <nl> } , <nl> / / private <nl> @ @ - 124 , 7 + 124 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> var v = [ ] ; / / ( make - vector n + 1 + 1 ) <nl> v [ 0 ] = body ; <nl> for ( var i = 0 ; i < n ; i + + ) <nl> - v [ i + 1 ] = this . index ( s , i - 1 ) ; <nl> + v [ i + 1 ] = this . index ( s , i ) ; <nl> v [ n + 1 ] = dotpos ; <nl> if ( dotpos = = - 1 ) <nl> @ @ - 174 , 7 + 174 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> return a ; <nl> case " refer - local " : <nl> var n = x [ 1 ] , x = x [ 2 ] ; <nl> - a = this . index ( f , n ) ; <nl> + a = this . index ( f , n + 1 ) ; <nl> this . last_refer = " ( anon ) " ; <nl> break ; <nl> case " refer - free " : <nl> @ @ - 211 , 7 + 211 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> break ; <nl> case " box " : <nl> var n = x [ 1 ] , x = x [ 2 ] ; <nl> - this . index_set ( s , n , [ this . index ( s , n ) ] ) ; / / boxing <nl> + this . index_set ( s , n , [ this . index ( s , n + 1 ) ] ) ; / / boxing <nl> break ; <nl> case " test " : <nl> var thenc = x [ 1 ] , elsec = x [ 2 ] ; <nl> @ @ - 228 , 7 + 228 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> break ; <nl> case " assign - local " : <nl> var n = x [ 1 ] , x = x [ 2 ] ; <nl> - var box = this . index ( f , n ) ; <nl> + var box = this . index ( f , n + 1 ) ; <nl> box [ 0 ] = a ; <nl> a = BiwaScheme . undef ; <nl> break ; <nl> @ @ - 260 , 7 + 260 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> var n = x [ 1 ] , x = x [ 2 ] ; <nl> / / the number of arguments in the last call <nl> - var n_args = this . index ( s , n ) ; <nl> + var n_args = this . index ( s , n + 1 ) ; <nl> s = this . shift_args ( n , n_args , s ) ; <nl> break ; <nl> @ @ - 283 , 7 + 283 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> / / the number of arguments in the last call is <nl> / / pushed to the stack . <nl> - var n_args = this . index ( s , - 1 ) ; <nl> + var n_args = this . index ( s , 0 ) ; <nl> if ( BiwaScheme . isClosure ( func ) ) { <nl> a = func ; <nl> x = func [ 0 ] ; <nl> @ @ - 297 , 7 + 297 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> / / = > Process the & rest args : packing the rest args into a list . <nl> var ls = BiwaScheme . nil ; <nl> for ( var i = n_args ; - - i > = dotpos ; ) { <nl> - ls = new BiwaScheme . Pair ( this . index ( s , i ) , ls ) ; <nl> + ls = new BiwaScheme . Pair ( this . index ( s , i + 1 ) , ls ) ; <nl> } <nl> if ( dotpos > = n_args ) { <nl> / / No rest argument is passed to this closure . <nl> @ @ - 306 , 11 + 306 , 11 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> / / = > We extend the stack to put the empty list . <nl> for ( var i = - 1 ; i < n_args ; i + + ) { <nl> - this . index_set ( s , i - 1 , this . index ( s , i ) ) ; <nl> + this . index_set ( s , i - 1 , this . index ( s , i + 1 ) ) ; <nl> } <nl> s + + ; <nl> / / = > Update the number of arguments <nl> - this . index_set ( s , - 1 , this . index ( s , - 1 ) + 1 ) ; <nl> + this . index_set ( s , - 1 , this . index ( s , 0 ) + 1 ) ; <nl> } <nl> this . index_set ( s , dotpos , ls ) ; <nl> } <nl> @ @ - 331 , 7 + 331 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> / / load arguments from stack <nl> var args = [ ] ; <nl> for ( var i = 0 ; i < n_args ; i + + ) <nl> - args . push ( this . index ( s , i ) ) ; <nl> + args . push ( this . index ( s , i + 1 ) ) ; <nl> / / invoke the function <nl> var result = func ( args , this ) ; <nl> @ @ - 389 , 11 + 389 , 11 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> break ; <nl> case " return " : <nl> / / Pop stack frame <nl> - var n = this . index ( s , - 1 ) ; <nl> + var n = this . index ( s , 0 ) ; <nl> var ss = s - n ; <nl> - x = this . index ( ss , 0 ) , <nl> - f = this . index ( ss , 1 ) , <nl> - c = this . index ( ss , 2 ) , <nl> + x = this . index ( ss , 1 ) , <nl> + f = this . index ( ss , 2 ) , <nl> + c = this . index ( ss , 3 ) , <nl> s = ss - 3 - 1 ; <nl> / / Pop stack trace ( > 1 times if tail calls are done ) <nl> 
mmm a / src / system / interpreter . js <nl> ppp b / src / system / interpreter . js <nl> / / m : number of items to shift <nl> / / s : stack pointer ( = index of stack top + 1 ) <nl> shift_args : function ( n , m , s ) { <nl> - for ( var i = n - 1 ; i > = - 1 ; i - - ) { <nl> - this . index_set ( s , i + m + 1 , this . index ( s , i + 1 ) ) ; <nl> + for ( var i = n ; i > = 0 ; i - - ) { <nl> + this . index_set ( s , i + m + 1 , this . index ( s , i ) ) ; <nl> } <nl> return s - m - 1 ; <nl> } , <nl> @ @ - 115 , 7 + 115 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> / / private <nl> index_set : function ( s , i , v ) { <nl> - this . stack [ s - i - 2 ] = v ; <nl> + this . stack [ ( s - 1 ) - i ] = v ; <nl> } , <nl> / / private <nl> @ @ - 211 , 7 + 211 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> break ; <nl> case " box " : <nl> var n = x [ 1 ] , x = x [ 2 ] ; <nl> - this . index_set ( s , n , [ this . index ( s , n + 1 ) ] ) ; / / boxing <nl> + this . index_set ( s , n + 1 , [ this . index ( s , n + 1 ) ] ) ; / / boxing <nl> break ; <nl> case " test " : <nl> var thenc = x [ 1 ] , elsec = x [ 2 ] ; <nl> @ @ - 305 , 14 + 305 , 14 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> / / In such case this VM prepares an empty list as the rest argument . <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> / / = > We extend the stack to put the empty list . <nl> - for ( var i = - 1 ; i < n_args ; i + + ) { <nl> - this . index_set ( s , i - 1 , this . index ( s , i + 1 ) ) ; <nl> + for ( var i = 0 ; i < n_args + 1 ; i + + ) { <nl> + this . index_set ( s , i - 1 , this . index ( s , i ) ) ; <nl> } <nl> s + + ; <nl> / / = > Update the number of arguments <nl> - this . index_set ( s , - 1 , this . index ( s , 0 ) + 1 ) ; <nl> + this . index_set ( s , 0 , this . index ( s , 0 ) + 1 ) ; <nl> } <nl> - this . index_set ( s , dotpos , ls ) ; <nl> + this . index_set ( s , dotpos + 1 , ls ) ; <nl> } <nl> else { <nl> / / the dot is not found <nl> 
mmm a / src / system / interpreter . js <nl> ppp b / src / system / interpreter . js <nl> / / s : depth of stack to save <nl> / / n : number of args ( for outer lambda ) to remove ( = 0 unless tail position ) <nl> / / ret : closure array <nl> - continuation : function ( s , n ) { <nl> + capture_continuation : function ( s , n ) { <nl> / / note : implementation of this function for final version doesn ' t exist in 3imp . pdf . . <nl> var ss = this . push ( n , s ) ; <nl> return this . closure ( [ " refer - local " , 0 , <nl> @ @ - 240 , 7 + 240 , 7 @ @ BiwaScheme . Interpreter = BiwaScheme . Class . create ( { <nl> break ; <nl> case " conti " : <nl> var n = x [ 1 ] , x = x [ 2 ] ; <nl> - a = this . continuation ( s , n ) ; <nl> + a = this . capture_continuation ( s , n ) ; <nl> break ; <nl> case " nuate " : <nl> var stack = x [ 1 ] , x = x [ 2 ] ; <nl> 
mmm a / src / system / compiler . js <nl> ppp b / src / system / compiler . js <nl> case BiwaScheme . Sym ( " call / cc " ) : <nl> var x = x . second ( ) ; <nl> + var arity_of_arg = 1 ; / / Always 1 . ( lambda ( cc ) . . . ) <nl> var c = [ " conti " , <nl> ( this . is_tail ( next ) ? ( e [ 0 ] . size ( ) + 1 ) : 0 ) , / / number of args for outer lambda <nl> [ " argument " , <nl> - [ " constant " , 1 , <nl> + [ " constant " , arity_of_arg , <nl> [ " argument " , <nl> this . compile ( x , e , s , f , <nl> - ( this . is_tail ( next ) ? [ " shift " , 1 , [ " tco_hinted_apply " ] ] <nl> + ( this . is_tail ( next ) ? [ " shift " , arity_of_arg , [ " tco_hinted_apply " ] ] <nl> : [ " apply " ] ) ) ] ] ] ] ; <nl> - / / note : proc for call / cc takes 1 argument ( = [ " apply " , 1 ] ) <nl> / / Do not push stack frame when call / cc is in a tail context <nl> return this . is_tail ( next ) ? c : [ " frame " , c , next ] ; <nl> 
mmm a / src / system / compiler . js <nl> ppp b / src / system / compiler . js <nl> var arity_of_arg = 1 ; / / Always 1 . ( lambda ( cc ) . . . ) <nl> var c = [ " conti " , <nl> ( this . is_tail ( next ) ? ( e [ 0 ] . size ( ) + 1 ) : 0 ) , / / number of args for outer lambda <nl> - [ " argument " , <nl> + [ " argument " , / / Push the continuaion closure onto the stack <nl> [ " constant " , arity_of_arg , <nl> [ " argument " , <nl> this . compile ( x , e , s , f , <nl> 
mmm a / src / system / _writer . js <nl> ppp b / src / system / _writer . js <nl> / / write <nl> / / <nl> + const truncate = function ( str , length ) { <nl> + const truncateStr = ' . . . ' ; <nl> + return str . length > length ? str . slice ( 0 , length ) + truncateStr : str ; <nl> + } ; <nl> + <nl> const to_write = function ( obj ) { <nl> if ( obj = = = undefined ) <nl> return " undefined " ; <nl> @ @ - 20 , 7 + 25 , 7 @ @ const to_write = function ( obj ) { <nl> return " null " ; <nl> else if ( _ . isFunction ( obj ) ) <nl> return " # < Function " + ( obj . fname ? obj . fname : <nl> - obj . toSource ? _ . str . truncate ( obj . toSource ( ) , 40 ) : <nl> + obj . toSource ? truncate ( obj . toSource ( ) , 40 ) : <nl> " " ) + " > " ; <nl> else if ( _ . isString ( obj ) ) <nl> return ' " ' + <nl> 
mmm a / src / platforms / browser / release_initializer . js <nl> ppp b / src / platforms / browser / release_initializer . js <nl> + <nl> / / <nl> / / release_initializer . js - read user ' s program and eval it ( if it exists ) <nl> / / <nl> + <nl> const execute_user_program = function ( ) { <nl> - var dumper = null ; <nl> - if ( $ ( " # biwascheme - debugger " ) [ 0 ] ) { <nl> - dumper = new BiwaScheme . Dumper ( $ ( " # biwascheme - debugger " ) [ 0 ] ) ; <nl> + const dumper = null ; <nl> + const debug_area = document . querySelector ( " # biwascheme - debugger " ) ; <nl> + if ( debug_area ) { <nl> + dumper = new Dumper ( debug_area ) ; <nl> } <nl> / / Error handler ( show message to console div ) <nl> - var onError = function ( e , state ) { <nl> + const onError = function ( e , state ) { <nl> BiwaScheme . Port . current_error . put_string ( e . message + " \ n " ) ; <nl> if ( dumper ) { <nl> dumper . dump ( state ) ; <nl> @ @ - 20 , 8 + 24 , 8 @ @ const execute_user_program = function ( ) { <nl> } <nl> } ; <nl> - var run = function ( script ) { <nl> - var intp = new BiwaScheme . Interpreter ( onError ) ; <nl> + const run = function ( script ) { <nl> + const intp = new BiwaScheme . Interpreter ( onError ) ; <nl> try { <nl> intp . evaluate ( script , function ( ) { } ) ; <nl> } <nl> @ @ - 31 , 15 + 35 , 21 @ @ const execute_user_program = function ( ) { <nl> } ; <nl> / / Start user ' s program ( old style ) <nl> - var script = $ ( " script [ src $ = ' biwascheme . js ' ] " ) . html ( ) | | <nl> - $ ( " script [ src $ = ' biwascheme - min . js ' ] " ) . html ( ) ; <nl> - if ( script ) run ( script ) ; <nl> + let script = " " ; <nl> + for ( const s of document . querySelectorAll ( " script [ src $ = ' biwascheme . js ' ] " ) ) { <nl> + script + = s . innerHTML ; <nl> + } <nl> + for ( const s of document . querySelectorAll ( " script [ src $ = ' biwascheme - min . js ' ] " ) ) { <nl> + script + = s . innerHTML ; <nl> + } <nl> + <nl> + if ( script . length > 0 ) run ( script ) ; <nl> / / Start user ' s program ( new style ) <nl> - $ ( function ( ) { <nl> - $ ( " script [ type = ' text / biwascheme ' ] " ) . each ( function ( ) { <nl> - run ( $ ( this ) . html ( ) ) ; <nl> - } ) ; <nl> + window . addEventListener ( ' DOMContentLoaded ' , function ( ) { <nl> + for ( const s of document . querySelectorAll ( " script [ type = ' text / biwascheme ' ] " ) ) { <nl> + run ( s . innerHTML ) ; <nl> + } <nl> } ) ; <nl> } ; <nl> 
mmm a / src / platforms / browser / default_ports . js <nl> ppp b / src / platforms / browser / default_ports . js <nl> const current_input = new Port . CustomInput ( <nl> function ( callback ) { <nl> - var form = $ ( " < form / > " ) ; <nl> - form . html ( " < input id = ' webscheme - read - line ' type = ' text ' > < input type = ' submit ' value = ' ok ' > " ) ; <nl> - $ ( " # bs - console " ) . append ( form ) ; <nl> - form . submit ( function ( ) { <nl> - var input = $ ( " # webscheme - read - line " ) . val ( ) ; <nl> + const out = document . querySelector ( " # bs - console " ) ; <nl> + const form = document . createElement ( " form " ) ; <nl> + form . innerHTML = " < input id = ' webscheme - read - line ' type = ' text ' > < input type = ' submit ' value = ' ok ' > " ; <nl> + out . appendChild ( form ) ; <nl> + form . addEventListener ( " submit " , function ( ) { <nl> + const input = document . querySelector ( " # webscheme - read - line " ) . value ; <nl> form . remove ( ) ; <nl> callback ( input ) ; <nl> return false ; <nl> @ @ - 17 , 15 + 18 , 13 @ @ const current_input = new Port . CustomInput ( <nl> const current_output = new Port . CustomOutput ( <nl> function ( str ) { <nl> - var console ; <nl> - var text ; <nl> - console = $ ( " # bs - console " ) ; <nl> - if ( console [ 0 ] ) { <nl> - text = _ . escape ( str ) ; <nl> - var span = $ ( " < span > " ) ; <nl> - span . html ( text . replace ( / \ n / g , " < br > " ) . replace ( / / g , " & nbsp ; " ) ) ; <nl> - console . append ( span ) ; <nl> - } <nl> + const out = document . querySelector ( " # bs - console " ) ; <nl> + if ( ! out ) return ; <nl> + const span = document . createElement ( " span " ) ; <nl> + span . innerHTML = _ . escape ( str ) <nl> + . replace ( / \ n / g , " < br > " ) <nl> + . replace ( / / g , " & nbsp ; " ) ; <nl> + out . appendChild ( span ) ; <nl> } <nl> ) ; <nl> 
mmm a / src / system / expander / core . js <nl> ppp b / src / system / expander / core . js <nl> import { Sym } from " . . / symbol . js " <nl> import { isIdentifier , unwrapSyntax } from " . / syntactic_closure . js " <nl> - const expandLambda = async ( [ form , xp ] ) = > { <nl> - const err = new BiwaError ( " malformed lambda " , form ) ; <nl> - const l = form . to_array ( ) ; <nl> - if ( l . length < 3 ) throw err ; <nl> - const formals = form . cadr ( err ) ; <nl> - if ( ! isPair ( formals ) ) throw err ; <nl> - const body = form . cddr ( err ) ; <nl> - <nl> - const newEnv = env . extend ( formal - list ) ; <nl> + / / ` begin ` <nl> + const expandBegin = async ( [ form , xp ] ) = > { <nl> + const body = await form . cdr . mapAsync ( item = > xp . expand ( item ) ) ; <nl> + return Cons ( Sym ( " begin " ) , body ) ; <nl> + } ; <nl> - / / TODO <nl> + / / ` call / cc ` <nl> + const expandCallCc = async ( [ form , xp ] ) = > { <nl> + const l = form . to_array ( ) ; <nl> + switch ( l . length ) { <nl> + case 2 : <nl> + return List ( Sym ( " call / cc " ) , await xp . expand ( l [ 1 ] ) ) ; <nl> + default : <nl> + throw new BiwaError ( " malformed call / cc " , form ) ; <nl> + } <nl> + } ; <nl> - return Cons ( Sym ( " lambda " ) , <nl> - Cons ( newFormals , newBody ) ) ; <nl> + / / ` define ` <nl> + / / Destructively modifies ` env ` <nl> + const expandDefine = async ( [ form , xp , env ] ) = > { <nl> + const l = form . to_array ( ) ; <nl> + switch ( l . length ) { <nl> + case 3 : <nl> + const [ _ , formal , expr ] = l ; <nl> + if ( ! isIdentifier ( formal ) ) { <nl> + throw new BiwaError ( " malformed define " , form ) ; <nl> + } <nl> + env . extend ( formal ) ; <nl> + const id = await xp . expand ( formal ) ; <nl> + const body = env . isToplevel ( ) ? ( await xp . expand ( expr ) ) <nl> + : expr ; / / Expand later on <nl> + return List ( Sym ( " define " ) , id , body ) ; <nl> + default : <nl> + throw new BiwaError ( " malformed define " , form ) ; <nl> + } <nl> } ; <nl> + / / ` if ` <nl> const expandIf = async ( [ form , xp ] ) = > { <nl> const l = form . to_array ( ) ; <nl> switch ( l . length ) { <nl> @ @ - 33 , 6 + 55 , 24 @ @ const expandIf = async ( [ form , xp ] ) = > { <nl> } <nl> } ; <nl> + / / ` lambda ` <nl> + const expandLambda = async ( [ form , xp ] ) = > { <nl> + const err = new BiwaError ( " malformed lambda " , form ) ; <nl> + const l = form . to_array ( ) ; <nl> + if ( l . length < 3 ) throw err ; <nl> + const formals = form . cadr ( err ) ; <nl> + if ( ! isPair ( formals ) ) throw err ; <nl> + const body = form . cddr ( err ) ; <nl> + <nl> + const newEnv = env . extend ( formal - list ) ; <nl> + <nl> + / / TODO <nl> + <nl> + return Cons ( Sym ( " lambda " ) , <nl> + Cons ( newFormals , newBody ) ) ; <nl> + } ; <nl> + <nl> + / / ` quote ` <nl> const expandQuote = async ( [ form , xp ] ) = > { <nl> const l = form . to_array ( ) ; <nl> switch ( l . length ) { <nl> @ @ - 43 , 6 + 83 , 7 @ @ const expandQuote = async ( [ form , xp ] ) = > { <nl> } <nl> } ; <nl> + / / ` set ! ` <nl> const expandSet = async ( [ form , xp ] ) = > { <nl> const l = form . to_array ( ) ; <nl> switch ( l . length ) { <nl> @ @ - 53 , 40 + 94 , 6 @ @ const expandSet = async ( [ form , xp ] ) = > { <nl> } <nl> } ; <nl> - const expandCallCc = async ( [ form , xp ] ) = > { <nl> - const l = form . to_array ( ) ; <nl> - switch ( l . length ) { <nl> - case 2 : <nl> - return List ( Sym ( " call / cc " ) , await xp . expand ( l [ 1 ] ) ) ; <nl> - default : <nl> - throw new BiwaError ( " malformed call / cc " , form ) ; <nl> - } <nl> - } ; <nl> - <nl> - const expandBegin = async ( [ form , xp ] ) = > { <nl> - const body = await form . cdr . mapAsync ( item = > xp . expand ( item ) ) ; <nl> - return Cons ( Sym ( " begin " ) , body ) ; <nl> - } ; <nl> - <nl> - / / Destructively modifies ` env ` <nl> - const expandDefine = async ( [ form , xp , env ] ) = > { <nl> - const l = form . to_array ( ) ; <nl> - switch ( l . length ) { <nl> - case 3 : <nl> - const [ _ , formal , expr ] = l ; <nl> - if ( ! isIdentifier ( formal ) ) { <nl> - throw new BiwaError ( " malformed define " , form ) ; <nl> - } <nl> - env . extend ( formal ) ; <nl> - const id = await xp . expand ( formal ) ; <nl> - const body = env . isToplevel ( ) ? ( await xp . expand ( expr ) ) <nl> - : expr ; / / Expand later on <nl> - return List ( Sym ( " define " ) , id , body ) ; <nl> - default : <nl> - throw new BiwaError ( " malformed define " , form ) ; <nl> - } <nl> - } ; <nl> - <nl> / / TODO <nl> / / const expandDefineRecordType <nl> / / const expandParameterize <nl> @ @ - 101 , 12 + 108 , 12 @ @ const expandDefine = async ( [ form , xp , env ] ) = > { <nl> / / Install core expanders into ` lib ` <nl> const installCore = ( lib ) = > { <nl> - lib . exportMacro ( Sym ( " lambda " ) , expandLambda ) ; <nl> + lib . exportMacro ( Sym ( " begin " ) , expandBegin ) ; <nl> + lib . exportMacro ( Sym ( " call / cc " ) , expandCallCc ) ; <nl> + lib . exportMacro ( Sym ( " define " ) , expandDefine ) ; <nl> lib . exportMacro ( Sym ( " if " ) , expandIf ) ; <nl> + lib . exportMacro ( Sym ( " lambda " ) , expandLambda ) ; <nl> lib . exportMacro ( Sym ( " quote " ) , expandQuote ) ; <nl> lib . exportMacro ( Sym ( " set ! " ) , expandSet ) ; <nl> - lib . exportMacro ( Sym ( " call / cc " ) , expandCallCc ) ; <nl> - lib . exportMacro ( Sym ( " begin " ) , expandBegin ) ; <nl> - lib . exportMacro ( Sym ( " define " ) , expandDefine ) ; <nl> } ; <nl> export { installCore } ; <nl> 
mmm a / packages / create - react - app / createReactApp . js <nl> ppp b / packages / create - react - app / createReactApp . js <nl> ) <nl> . then ( ( { isOnline , packageInfo , templateInfo } ) = > { <nl> let packageVersion = semver . coerce ( packageInfo . version ) ; <nl> + <nl> + / / This environment variable can be removed post - release . <nl> const templatesVersionMinimum = process . env . CRA_INTERNAL_TEST <nl> ? ' 3 . 2 . 0 ' <nl> : ' 3 . 3 . 0 ' ; <nl> @ @ - 454 , 7 + 456 , 7 @ @ function run ( <nl> / / Only support templates when used alongside new react - scripts versions . <nl> const supportsTemplates = semver . gte ( <nl> - semver . coerce ( packageVersion ) , <nl> + packageVersion , <nl> templatesVersionMinimum <nl> ) ; <nl> if ( supportsTemplates ) { <nl> 
mmm a / components / ProgressIndicator / ProgressIndicator . js <nl> ppp b / components / ProgressIndicator / ProgressIndicator . js <nl> { currentStep } / { totalSteps } Complete <nl> < / label > <nl> < progress id = " steps - indicator " max = { totalSteps } value = { currentStep } > <nl> - { ' ' } <nl> - { percentageCompleted } % { ' ' } <nl> + { percentageCompleted } % <nl> < / progress > <nl> < / div > <nl> ) ; <nl> 
mmm a / packages / engine - processor / lib / processor . js <nl> ppp b / packages / engine - processor / lib / processor . js <nl> async function getFiles ( { name , fix , rawSource , processorRunners } ) { <nl> const fileList = [ ] ; <nl> - const allPlaces = [ ] ; <nl> + const processedPlaces = [ ] ; <nl> let isProcessed = false ; <nl> let processedSource = ' ' ; <nl> - let processedPlaces = [ ] ; <nl> let merge = null ; <nl> for ( const currentRunner of processorRunners ) { <nl> + let places = [ ] ; <nl> + <nl> const { <nl> isMatch , <nl> branch = stubSplit , <nl> @ @ - 127 , 16 + 128 , 16 @ @ async function getFiles ( { name , fix , rawSource , processorRunners } ) { <nl> isProcessed = true ; <nl> if ( lint ) <nl> - [ processedSource , processedPlaces ] = await lint ( rawSource , { fix } ) ; <nl> + [ processedSource , places ] = await lint ( rawSource , { fix } ) ; <nl> else if ( fix ) <nl> processedSource = await fixFind ( rawSource ) ; <nl> else <nl> - processedPlaces = await find ( rawSource ) ; <nl> + places = await find ( rawSource ) ; <nl> if ( ! processedSource ) <nl> processedSource = rawSource ; <nl> - allPlaces . push ( . . . processedPlaces ) ; <nl> + processedPlaces . push ( . . . places ) ; <nl> const files = await branch ( processedSource ) ; <nl> @ @ - 147 , 7 + 148 , 7 @ @ async function getFiles ( { name , fix , rawSource , processorRunners } ) { <nl> merge , <nl> isProcessed , <nl> processedSource , <nl> - processedPlaces : allPlaces , <nl> + processedPlaces , <nl> fileList , <nl> } ; <nl> } <nl> 
mmm a / packages / alpinejs / src / lifecycle . js <nl> ppp b / packages / alpinejs / src / lifecycle . js <nl> import { deferHandlingDirectives , directives } from " . / directives " <nl> import { dispatch } from ' . / utils / dispatch ' <nl> - import { nextTick } from " . / nextTick " <nl> import { walk } from " . / utils / walk " <nl> import { warn } from ' . / utils / warn ' <nl> 
mmm a / src / Carousel . js <nl> ppp b / src / Carousel . js <nl> this . hoverStart = this . hoverStart . bind ( this ) ; <nl> this . hoverEnd = this . hoverEnd . bind ( this ) ; <nl> this . state = { <nl> + activeIndex : this . props . activeIndex , <nl> direction : ' right ' , <nl> indicatorClicked : false , <nl> } ; <nl> @ @ - 31 , 19 + 32 , 35 @ @ class Carousel extends React . Component { <nl> document . addEventListener ( ' keyup ' , this . handleKeyPress ) ; <nl> } <nl> - UNSAFE_componentWillReceiveProps ( nextProps ) { <nl> - this . setInterval ( nextProps ) ; <nl> + static getDerivedStateFromProps ( nextProps , prevState ) { <nl> + let newState = null ; <nl> + let { activeIndex , direction , indicatorClicked } = prevState ; <nl> + <nl> + if ( nextProps . activeIndex ! = = activeIndex ) { <nl> / / Calculate the direction to turn <nl> - if ( this . props . activeIndex + 1 = = = nextProps . activeIndex ) { <nl> - this . setState ( { direction : ' right ' } ) ; <nl> - } else if ( this . props . activeIndex - 1 = = = nextProps . activeIndex ) { <nl> - this . setState ( { direction : ' left ' } ) ; <nl> - } else if ( this . props . activeIndex > nextProps . activeIndex ) { <nl> - this . setState ( { direction : this . state . indicatorClicked ? ' left ' : ' right ' } ) ; <nl> - } else if ( this . props . activeIndex ! = = nextProps . activeIndex ) { <nl> - this . setState ( { direction : this . state . indicatorClicked ? ' right ' : ' left ' } ) ; <nl> + if ( nextProps . activeIndex = = = activeIndex + 1 ) { <nl> + direction = ' right ' ; <nl> + } else if ( nextProps . activeIndex = = = activeIndex - 1 ) { <nl> + direction = ' left ' ; <nl> + } else if ( nextProps . activeIndex < activeIndex ) { <nl> + direction = indicatorClicked ? ' left ' : ' right ' ; <nl> + } else if ( nextProps . activeIndex ! = = activeIndex ) { <nl> + direction = indicatorClicked ? ' right ' : ' left ' ; <nl> + } <nl> + <nl> + newState = { <nl> + activeIndex : nextProps . activeIndex , <nl> + direction , <nl> + indicatorClicked : false , <nl> + } <nl> } <nl> - this . setState ( { indicatorClicked : false } ) ; <nl> + <nl> + return newState ; <nl> + } <nl> + <nl> + componentDidUpdate ( prevProps , prevState ) { <nl> + if ( prevState . activeIndex = = = this . state . activeIndex ) return ; <nl> + this . setInterval ( this . props ) ; <nl> } <nl> componentWillUnmount ( ) { <nl> @ @ - 98 , 7 + 115 , 7 @ @ class Carousel extends React . Component { <nl> return ( <nl> < div className = { className } > <nl> { carouselItems . map ( ( item , index ) = > { <nl> - const isIn = ( index = = = this . props . activeIndex ) ; <nl> + const isIn = ( index = = = this . state . activeIndex ) ; <nl> return React . cloneElement ( item , { <nl> in : isIn , <nl> slide : slide , <nl> 
mmm a / index . js <nl> ppp b / index . js <nl> } <nl> / / Check if needed config is correctly set <nl> - if ( <nl> - ! options . config [ currentEnv ] | | <nl> - ! options . config [ currentEnv ] . apiKey | | <nl> - ! options . config [ currentEnv ] . authDomain | | <nl> - ! options . config [ currentEnv ] . databaseURL | | <nl> - ! options . config [ currentEnv ] . projectId | | <nl> - ! options . config [ currentEnv ] . storageBucket | | <nl> - ! options . config [ currentEnv ] . messagingSenderId <nl> - ) { <nl> + const configKeys = Object . keys ( options . config [ currentEnv ] | | false ) <nl> + <nl> + const requiredKeys = [ ' apiKey ' , ' authDomain ' , ' databaseURL ' , ' projectId ' , ' storageBucket ' , ' messagingSenderId ' ] <nl> + <nl> + if ( requiredKeys . some ( k = > ! configKeys . includes ( k ) ) ) { <nl> / / TODO : Replace with @ nuxtjs / plugin - utils error <nl> console . error ( <nl> ' \ x1b [ 31m ' , <nl> 
mmm a / lib / helpers / createServerMiddleware . js <nl> ppp b / lib / helpers / createServerMiddleware . js <nl> - import logger from ' . . / logger ' <nl> + const admin = require ( ' firebase - admin ' ) <nl> + const logger = require ( ' . . / logger ' ) <nl> - export default function createServerMiddleware ( options ) { <nl> + module . exports = function ( options ) { <nl> return async ( req , res , next ) = > { <nl> if ( ! req . headers . authorization ) { return next ( ) } <nl> 
mmm a / lib / plugins / main . js <nl> ppp b / lib / plugins / main . js <nl> < % for ( service of serverServices ) { % > <nl> < % const serviceName = serviceNames [ service ] % > <nl> - let < % = serviceName % > Ready = false <nl> fire . < % = serviceName % > = null <nl> fire . < % = serviceName % > Ready = async ( ) = > { <nl> - if ( ! < % = serviceName % > Ready ) { <nl> + if ( ! fire . < % = serviceName % > ) { <nl> await fire . appReady ( ) <nl> fire . < % = serviceName % > = await < % = ` $ { service } Service ( session , firebase ) ` % > <nl> - < % = serviceName % > Ready = true <nl> } <nl> return fire . < % = serviceName % > <nl> @ @ - 72 , 13 + 70 , 11 @ @ export default async ( ctx , inject ) = > { <nl> if ( process . client ) { <nl> < % for ( service of clientServices ) { % > <nl> < % const serviceName = serviceNames [ service ] % > <nl> - let < % = serviceName % > Ready = false <nl> fire . < % = serviceName % > = null <nl> fire . < % = serviceName % > Ready = async ( ) = > { <nl> - if ( ! < % = serviceName % > Ready ) { <nl> + if ( ! fire . < % = serviceName % > ) { <nl> await fire . appReady ( ) <nl> fire . < % = serviceName % > = await < % = ` $ { service } Service ( session , firebase ) ` % > <nl> - < % = serviceName % > Ready = true <nl> } <nl> return fire . < % = serviceName % > <nl> 
mmm a / types / index . d . ts <nl> ppp b / types / index . d . ts <nl> import { NuxtConfiguration } from ' @ nuxt / vue - app ' <nl> import { ServiceAccount } from ' firebase - admin ' <nl> - import firebase from ' firebase ' <nl> + import firebase from ' firebase / compat ' <nl> import { auth } from ' firebase - admin ' <nl> / * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * <nl> 
mmm a / packages / vega - scenegraph / src / util / text . js <nl> ppp b / packages / vega - scenegraph / src / util / text . js <nl> / / perform our own font baseline calculation <nl> / / why ? not all browsers support SVG 1 . 1 ' alignment - baseline ' : ( <nl> var baseline = item . baseline , <nl> - h = fontSize ( item ) , <nl> - lh = lineHeight ( item ) ; <nl> + h = fontSize ( item ) ; <nl> return Math . round ( <nl> - baseline = = = ' line - top ' ? 0 . 79 . h + ( lh - h ) / 2 . 0 : <nl> + baseline = = = ' line - top ' ? 0 . 79 . h + ( lineHeight ( item ) - h ) / 2 . 0 : <nl> baseline = = = ' top ' ? 0 . 79 * h : <nl> baseline = = = ' middle ' ? 0 . 30 * h : <nl> baseline = = = ' bottom ' ? - 0 . 21 * h : <nl> - baseline = = = ' line - bottom ' ? - 0 . 21 * h - ( lh - h ) / 2 . 0 : 0 <nl> + baseline = = = ' line - bottom ' ? - 0 . 21 * h - ( lineHeight ( item ) - h ) / 2 . 0 : 0 <nl> ) ; <nl> } <nl> 
mmm a / packages / vega - parser / src / config . js <nl> ppp b / packages / vega - parser / src / config . js <nl> + / * * <nl> + * Standard configuration defaults for Vega specification parsing . <nl> + * Users can provide their own ( sub - ) set of these default values <nl> + * by passing in a config object to the top - level parse method . <nl> + * / <nl> + export default function ( ) { <nl> + const defaultFont = ' sans - serif ' , <nl> defaultSymbolSize = 30 , <nl> defaultStrokeWidth = 2 , <nl> defaultColor = ' # 4c78a8 ' , <nl> @ @ - 6 , 12 + 12 , 6 @ @ var defaultFont = ' sans - serif ' , <nl> gray = ' # 888 ' , <nl> lightGray = ' # ddd ' ; <nl> - / * * <nl> - * Standard configuration defaults for Vega specification parsing . <nl> - * Users can provide their own ( sub - ) set of these default values <nl> - * by passing in a config object to the top - level parse method . <nl> - * / <nl> - export default function ( ) { <nl> return { <nl> / / default visualization description <nl> description : ' Vega visualization ' , <nl> 
mmm a / packages / vega - force / src / Force . js <nl> ppp b / packages / vega - force / src / Force . js <nl> forceManyBody , forceSimulation , forceX , forceY <nl> } from ' d3 - force ' ; <nl> - var ForceMap = { <nl> + const ForceMap = { <nl> center : forceCenter , <nl> collide : forceCollide , <nl> nbody : forceManyBody , <nl> @ @ - 17 , 7 + 17 , 7 @ @ var ForceMap = { <nl> y : forceY <nl> } ; <nl> - var Forces = ' forces ' , <nl> + const Forces = ' forces ' , <nl> ForceParams = [ <nl> ' alpha ' , ' alphaMin ' , ' alphaTarget ' , <nl> ' velocityDecay ' , ' forces ' <nl> @ @ - 104 , 9 + 104 , 8 @ @ Force . Definition = { <nl> ] <nl> } ; <nl> - var prototype = inherits ( Force , Transform ) ; <nl> - <nl> - prototype . transform = function ( _ , pulse ) { <nl> + inherits ( Force , Transform , { <nl> + transform ( _ , pulse ) { <nl> var sim = this . value , <nl> change = pulse . changed ( pulse . ADD_REM ) , <nl> params = _ . modified ( ForceParams ) , <nl> @ @ - 147 , 13 + 146 , 13 @ @ prototype . transform = function ( _ , pulse ) { <nl> } <nl> return this . finish ( _ , pulse ) ; <nl> - } ; <nl> + } , <nl> - prototype . finish = function ( _ , pulse ) { <nl> - var dataflow = pulse . dataflow ; <nl> + finish ( _ , pulse ) { <nl> + const dataflow = pulse . dataflow ; <nl> / / inspect dependencies , touch link source data <nl> - for ( var args = this . _argops , j = 0 , m = args . length , arg ; j < m ; + + j ) { <nl> + for ( let args = this . _argops , j = 0 , m = args . length , arg ; j < m ; + + j ) { <nl> arg = args [ j ] ; <nl> if ( arg . name ! = = Forces | | arg . op . _argval . force ! = = ' link ' ) { <nl> continue ; <nl> @ @ - 168 , 31 + 167 , 24 @ @ prototype . finish = function ( _ , pulse ) { <nl> / / reflow all nodes <nl> return pulse . reflow ( _ . modified ( ) ) . modifies ( ForceOutput ) ; <nl> - } ; <nl> + } <nl> + } ) ; <nl> function rerun ( df , op ) { <nl> - return function ( ) { df . touch ( op ) . run ( ) ; } ; <nl> + return ( ) = > df . touch ( op ) . run ( ) ; <nl> } <nl> function simulation ( nodes , _ ) { <nl> - var sim = forceSimulation ( nodes ) , <nl> - stopped = false , <nl> + const sim = forceSimulation ( nodes ) , <nl> stop = sim . stop , <nl> restart = sim . restart ; <nl> + let stopped = false ; <nl> - sim . stopped = function ( ) { <nl> - return stopped ; <nl> - } ; <nl> - sim . restart = function ( ) { <nl> - stopped = false ; <nl> - return restart ( ) ; <nl> - } ; <nl> - sim . stop = function ( ) { <nl> - stopped = true ; <nl> - return stop ( ) ; <nl> - } ; <nl> + sim . stopped = ( ) = > stopped ; <nl> + sim . restart = ( ) = > ( stopped = false , restart ( ) ) ; <nl> + sim . stop = ( ) = > ( stopped = true , stop ( ) ) ; <nl> - return setup ( sim , _ , true ) . on ( ' end ' , function ( ) { stopped = true ; } ) ; <nl> + return setup ( sim , _ , true ) . on ( ' end ' , ( ) = > stopped = true ) ; <nl> } <nl> function setup ( sim , _ , init , pulse ) { <nl> @ @ - 244 , 5 + 236 , 5 @ @ function getForce ( _ ) { <nl> } <nl> function setForceParam ( f , v , _ ) { <nl> - f ( isFunction ( v ) ? function ( d ) { return v ( d , _ ) ; } : v ) ; <nl> + f ( isFunction ( v ) ? d = > v ( d , _ ) : v ) ; <nl> } <nl> 
mmm a / packages / vega - label / src / Label . js <nl> ppp b / packages / vega - label / src / Label . js <nl> ] <nl> } ; <nl> - const prototype = inherits ( Label , Transform ) ; <nl> - <nl> - prototype . transform = function ( _ , pulse ) { <nl> + inherits ( Label , Transform , { <nl> + transform ( _ , pulse ) { <nl> function modp ( param ) { <nl> const p = _ [ param ] ; <nl> return isFunction ( p ) & & pulse . modified ( p . fields ) ; <nl> @ @ - 109 , 4 + 108 , 5 @ @ prototype . transform = function ( _ , pulse ) { <nl> } ) ; <nl> return pulse . reflow ( mod ) . modifies ( as ) ; <nl> - } ; <nl> + } <nl> + } ) ; <nl> 
mmm a / packages / vega - voronoi / src / Voronoi . js <nl> ppp b / packages / vega - voronoi / src / Voronoi . js <nl> ] <nl> } ; <nl> - const prototype = inherits ( Voronoi , Transform ) ; <nl> - <nl> const defaultExtent = [ - 1e5 , - 1e5 , 1e5 , 1e5 ] ; <nl> - prototype . transform = function ( _ , pulse ) { <nl> + inherits ( Voronoi , Transform , { <nl> + transform ( _ , pulse ) { <nl> const as = _ . as | | ' path ' , <nl> data = pulse . source ; <nl> @ @ - 46 , 7 + 45 , 8 @ @ prototype . transform = function ( _ , pulse ) { <nl> } <nl> return pulse . reflow ( _ . modified ( ) ) . modifies ( as ) ; <nl> - } ; <nl> + } <nl> + } ) ; <nl> / / suppress duplicated end point vertices <nl> function toPathString ( p ) { <nl> 
mmm a / packages / vega - wordcloud / src / Wordcloud . js <nl> ppp b / packages / vega - wordcloud / src / Wordcloud . js <nl> ] <nl> } ; <nl> - var prototype = inherits ( Wordcloud , Transform ) ; <nl> - <nl> - prototype . transform = function ( _ , pulse ) { <nl> + inherits ( Wordcloud , Transform , { <nl> + transform ( _ , pulse ) { <nl> if ( _ . size & & ! ( _ . size [ 0 ] & & _ . size [ 1 ] ) ) { <nl> error ( ' Wordcloud size dimensions must be non - zero . ' ) ; <nl> } <nl> @ @ - 42 , 13 + 41 , 14 @ @ prototype . transform = function ( _ , pulse ) { <nl> return isFunction ( p ) & & pulse . modified ( p . fields ) ; <nl> } <nl> - var mod = _ . modified ( ) ; <nl> + const mod = _ . modified ( ) ; <nl> if ( ! ( mod | | pulse . changed ( pulse . ADD_REM ) | | Params . some ( modp ) ) ) return ; <nl> - var data = pulse . materialize ( pulse . SOURCE ) . source , <nl> + const data = pulse . materialize ( pulse . SOURCE ) . source , <nl> layout = this . value , <nl> - as = _ . as | | Output , <nl> - fontSize = _ . fontSize | | 14 , <nl> + as = _ . as | | Output ; <nl> + <nl> + let fontSize = _ . fontSize | | 14 , <nl> range ; <nl> isFunction ( fontSize ) <nl> @ @ - 57 , 21 + 57 , 21 @ @ prototype . transform = function ( _ , pulse ) { <nl> / / create font size scaling function as needed <nl> if ( range ) { <nl> - var fsize = fontSize , <nl> + const fsize = fontSize , <nl> sizeScale = scale ( ' sqrt ' ) ( ) <nl> . domain ( extent ( data , fsize ) ) <nl> . range ( range ) ; <nl> - fontSize = function ( x ) { return sizeScale ( fsize ( x ) ) ; } ; <nl> + fontSize = x = > sizeScale ( fsize ( x ) ) ; <nl> } <nl> - data . forEach ( function ( t ) { <nl> + data . forEach ( t = > { <nl> t [ as [ 0 ] ] = NaN ; <nl> t [ as [ 1 ] ] = NaN ; <nl> t [ as [ 3 ] ] = 0 ; <nl> } ) ; <nl> / / configure layout <nl> - var words = layout <nl> + const words = layout <nl> . words ( data ) <nl> . text ( _ . text ) <nl> . size ( _ . size | | [ 500 , 500 ] ) <nl> @ @ - 85 , 14 + 85 , 12 @ @ prototype . transform = function ( _ , pulse ) { <nl> . random ( random ) <nl> . layout ( ) ; <nl> - var size = layout . size ( ) , <nl> + const size = layout . size ( ) , <nl> dx = size [ 0 ] > > 1 , <nl> dy = size [ 1 ] > > 1 , <nl> - i = 0 , <nl> - n = words . length , <nl> - w , t ; <nl> + n = words . length ; <nl> - for ( ; i < n ; + + i ) { <nl> + for ( let i = 0 , w , t ; i < n ; + + i ) { <nl> w = words [ i ] ; <nl> t = w . datum ; <nl> t [ as [ 0 ] ] = w . x + dx ; <nl> @ @ - 105 , 4 + 103 , 5 @ @ prototype . transform = function ( _ , pulse ) { <nl> } <nl> return pulse . reflow ( mod ) . modifies ( as ) ; <nl> - } ; <nl> + } <nl> + } ) ; <nl> \ No newline at end of file <nl> 
mmm a / packages / vega - time / src / util . js <nl> ppp b / packages / vega - time / src / util . js <nl> export function localDate ( y , m , d , H , M , S , L ) { <nl> if ( 0 < = y & & y < 100 ) { <nl> - var date = new Date ( - 1 , m , d , H , M , S , L ) ; <nl> + const date = new Date ( - 1 , m , d , H , M , S , L ) ; <nl> date . setFullYear ( y ) ; <nl> return date ; <nl> } <nl> @ @ - 64 , 7 + 64 , 7 @ @ export function utcFirst ( y ) { <nl> export function utcDate ( y , m , d , H , M , S , L ) { <nl> if ( 0 < = y & & y < 100 ) { <nl> - var date = new Date ( Date . UTC ( - 1 , m , d , H , M , S , L ) ) ; <nl> + const date = new Date ( Date . UTC ( - 1 , m , d , H , M , S , L ) ) ; <nl> date . setUTCFullYear ( d . y ) ; <nl> return date ; <nl> } <nl> 
mmm a / packages / vega - projection / src / projections . js <nl> ppp b / packages / vega - projection / src / projections . js <nl> geoMollweide <nl> } from ' d3 - geo - projection ' ; <nl> - var defaultPath = geoPath ( ) ; <nl> + const defaultPath = geoPath ( ) ; <nl> - export var projectionProperties = [ <nl> + export const projectionProperties = [ <nl> / / standard properties in d3 - geo <nl> ' clipAngle ' , <nl> ' clipExtent ' , <nl> @ @ - 54 , 14 + 54 , 14 @ @ export var projectionProperties = [ <nl> * / <nl> function create ( type , constructor ) { <nl> return function projection ( ) { <nl> - var p = constructor ( ) ; <nl> + const p = constructor ( ) ; <nl> p . type = type ; <nl> p . path = geoPath ( ) . projection ( p ) ; <nl> p . copy = p . copy | | function ( ) { <nl> - var c = projection ( ) ; <nl> + const c = projection ( ) ; <nl> projectionProperties . forEach ( function ( prop ) { <nl> if ( p [ prop ] ) c [ prop ] ( p [ prop ] ( ) ) ; <nl> } ) ; <nl> @ @ - 90 , 7 + 90 , 7 @ @ export function getProjectionPath ( proj ) { <nl> return ( proj & & proj . path ) | | defaultPath ; <nl> } <nl> - var projections = { <nl> + const projections = { <nl> / / base d3 - geo projection types <nl> albers : geoAlbers , <nl> albersusa : geoAlbersUsa , <nl> @ @ - 111 , 6 + 111 , 6 @ @ var projections = { <nl> transversemercator : geoTransverseMercator <nl> } ; <nl> - for ( var key in projections ) { <nl> + for ( const key in projections ) { <nl> projection ( key , projections [ key ] ) ; <nl> } <nl> 
mmm a / packages / vega - format / src / number . js <nl> ppp b / packages / vega - format / src / number . js <nl> function trimZeroes ( numberFormat , decimalChar ) { <nl> return x = > { <nl> - var str = numberFormat ( x ) , <nl> + let str = numberFormat ( x ) , <nl> dec = str . indexOf ( decimalChar ) , <nl> idx , end ; <nl> @ @ - 27 , 7 + 27 , 7 @ @ function trimZeroes ( numberFormat , decimalChar ) { <nl> } <nl> function rightmostDigit ( str , dec ) { <nl> - var i = str . lastIndexOf ( ' e ' ) , c ; <nl> + let i = str . lastIndexOf ( ' e ' ) , c ; <nl> if ( i > 0 ) return i ; <nl> for ( i = str . length ; - - i > dec ; ) { <nl> c = str . charCodeAt ( i ) ; <nl> @ @ - 43 , 7 + 43 , 7 @ @ function numberLocale ( locale ) { <nl> format , <nl> formatPrefix , <nl> formatFloat ( spec ) { <nl> - var s = formatSpecifier ( spec | | ' , ' ) ; <nl> + const s = formatSpecifier ( spec | | ' , ' ) ; <nl> if ( s . precision = = null ) { <nl> s . precision = 12 ; <nl> switch ( s . type ) { <nl> 
mmm a / packages / vega - event - selector / src / event - selector . js <nl> ppp b / packages / vega - event - selector / src / event - selector . js <nl> return parseMerge ( selector . trim ( ) ) . map ( parseSelector ) ; <nl> } <nl> - var VIEW = ' view ' , <nl> + let VIEW = ' view ' , <nl> LBRACK = ' [ ' , <nl> RBRACK = ' ] ' , <nl> LBRACE = ' { ' , <nl> @ @ - 41 , 7 + 41 , 7 @ @ function isMarkType ( type ) { <nl> } <nl> function find ( s , i , endChar , pushChar , popChar ) { <nl> - var count = 0 , <nl> + let count = 0 , <nl> n = s . length , <nl> c ; <nl> for ( ; i < n ; + + i ) { <nl> @ @ - 54 , 7 + 54 , 7 @ @ function find ( s , i , endChar , pushChar , popChar ) { <nl> } <nl> function parseMerge ( s ) { <nl> - var output = [ ] , <nl> + let output = [ ] , <nl> start = 0 , <nl> n = s . length , <nl> i = 0 ; <nl> @ @ - 78 , 7 + 78 , 7 @ @ function parseSelector ( s ) { <nl> } <nl> function parseBetween ( s ) { <nl> - var n = s . length , <nl> + let n = s . length , <nl> i = 1 , <nl> b , stream ; <nl> @ @ - 113 , 7 + 113 , 7 @ @ function parseBetween ( s ) { <nl> } <nl> function parseStream ( s ) { <nl> - var stream = { source : DEFAULT_SOURCE } , <nl> + let stream = { source : DEFAULT_SOURCE } , <nl> source = [ ] , <nl> throttle = [ 0 , 0 ] , <nl> markname = 0 , <nl> @ @ - 198 , 10 + 198 , 10 @ @ function parseStream ( s ) { <nl> } <nl> function parseThrottle ( s ) { <nl> - var a = s . split ( COMMA ) ; <nl> + const a = s . split ( COMMA ) ; <nl> if ( ! s . length | | a . length > 2 ) throw s ; <nl> return a . map ( function ( _ ) { <nl> - var x = + _ ; <nl> + const x = + _ ; <nl> if ( x ! = = x ) throw s ; <nl> return x ; <nl> } ) ; <nl> 
mmm a / packages / vega - scenegraph / src / util / equal . js <nl> ppp b / packages / vega - scenegraph / src / util / equal . js <nl> : ( a instanceof Date & & b instanceof Date ) ? + a = = = + b <nl> : ( isNumber ( a ) & & isNumber ( b ) ) ? Math . abs ( a - b ) < = TOLERANCE <nl> : ( ! a | | ! b | | ! isObject ( a ) & & ! isObject ( b ) ) ? a = = b <nl> - : ( a = = null | | b = = null ) ? false <nl> : objectEqual ( a , b ) ; <nl> } <nl> 
mmm a / packages / vega - loader / src / loader . js <nl> ppp b / packages / vega - loader / src / loader . js <nl> / / if relative url ( no protocol / host ) , prepend baseURL <nl> if ( ( base = options . baseURL ) & & ! hasProtocol ) { <nl> / / Ensure that there is a slash between the baseURL ( e . g . hostname ) and url <nl> - if ( ! uri . startsWith ( ' / ' ) & & base [ base . length - 1 ] ! = = ' / ' ) { <nl> + if ( ! uri . startsWith ( ' / ' ) & & ! base . endsWith ( ' / ' ) ) { <nl> uri = ' / ' + uri ; <nl> } <nl> uri = base + uri ; <nl> 
mmm a / packages / rnv - engine - rn - windows / renative . engine . json <nl> ppp b / packages / rnv - engine - rn - windows / renative . engine . json <nl> } , <nl> " react - native - windows " : " source : rnv " , <nl> - " @ react - native - community / cli " : { <nl> - " version " : " 5 . 0 . 1 " <nl> - } , <nl> " @ react - native - windows / cli " : " source : rnv " <nl> } , <nl> " platforms " : { <nl> 
mmm a / components / SimilarityGraph / index . js <nl> ppp b / components / SimilarityGraph / index . js <nl> import cola from ' webcola ' ; <nl> export default class SimilarityGraph extends VisComponent { <nl> - constructor ( el , { data , threshold = 0 , linkDistance = 100 , nodeRadius = 10 } ) { <nl> + constructor ( el , { data , threshold = 0 , linkDistance = 100 , size = 10 } ) { <nl> super ( el ) ; <nl> this . data = data ; <nl> @ @ - 24 , 8 + 24 , 8 @ @ export default class SimilarityGraph extends VisComponent { <nl> const nodes = this . nodes = this . data . map ( d = > ( { <nl> id : d . id , <nl> color : d . color , <nl> - width : 2 * nodeRadius , <nl> - height : 2 * nodeRadius <nl> + width : 2 * size , <nl> + height : 2 * size <nl> } ) ) ; <nl> / / Construct an index map into the nodes list . <nl> @ @ - 67 , 7 + 67 , 7 @ @ export default class SimilarityGraph extends VisComponent { <nl> this . nodeSelection . enter ( ) <nl> . append ( ' circle ' ) <nl> . classed ( ' node ' , true ) <nl> - . attr ( ' r ' , nodeRadius ) <nl> + . attr ( ' r ' , size ) <nl> . style ( ' stroke ' , ' black ' ) <nl> . style ( ' fill ' , d = > colormap ( d . color ) ) <nl> . style ( ' cursor ' , ' crosshair ' ) <nl> 
mmm a / components / SimilarityGraph / index . js <nl> ppp b / components / SimilarityGraph / index . js <nl> { <nl> name : ' size ' , <nl> type : ' number ' , <nl> - domain : { <nl> - mode : ' value ' <nl> - } <nl> + format : ' number ' <nl> + default : 10 <nl> + } , <nl> + { <nl> + name : ' threshold ' , <nl> + type : ' number ' , <nl> + format : ' number ' , <nl> + default : 0 <nl> } <nl> ] ; <nl> } <nl> 
mmm a / components / SimilarityGraph / index . js <nl> ppp b / components / SimilarityGraph / index . js <nl> super ( el ) ; <nl> this . data = data ; <nl> + / / Empty the top - level div . <nl> + d3 . select ( this . el ) <nl> + . selectAll ( ' * ' ) . remove ( ) ; <nl> + <nl> / / Construct an SVG element inside the top - level div . <nl> this . svg = document . createElementNS ( ' http : / / www . w3 . org / 2000 / svg ' , ' svg ' ) ; <nl> this . svg . setAttribute ( ' width ' , width ) ; <nl> 
mmm a / components / SimilarityGraph / index . js <nl> ppp b / components / SimilarityGraph / index . js <nl> / / Get the width and height of the SVG element . This is necessary here in <nl> / / case non - pixel measures like ' 100 % ' were passed to the component . <nl> - const bbox = this . svg . getBBox ( ) ; <nl> + const bbox = this . svg . getBoundingClientRect ( ) ; <nl> const w = bbox . width ; <nl> const h = bbox . height ; <nl> 
mmm a / components / SimilarityGraph / index . js <nl> ppp b / components / SimilarityGraph / index . js <nl> - import d3 from ' d3 ' ; <nl> + import * as d3 from ' d3 ' ; <nl> import cola from ' webcola ' ; <nl> export default class SimilarityGraph extends VisComponent { <nl> @ @ - 36 , 7 + 36 , 8 @ @ export default class SimilarityGraph extends VisComponent { <nl> const h = bbox . height ; <nl> / / Initialize the cola object . <nl> - this . cola = cola . d3adaptor ( ) <nl> + console . log ( d3 ) ; <nl> + this . cola = cola . d3adaptor ( d3 ) <nl> . linkDistance ( linkDistance ) <nl> . size ( [ w , h ] ) ; <nl> @ @ - 73 , 11 + 74 , 12 @ @ export default class SimilarityGraph extends VisComponent { <nl> . selectAll ( ' line . link ' ) <nl> . data ( this . links ) ; <nl> - this . linkSelection . enter ( ) <nl> + this . linkSelection = this . linkSelection . enter ( ) <nl> . append ( ' line ' ) <nl> . classed ( ' link ' , true ) <nl> . attr ( ' stroke - width ' , 1 ) <nl> - . attr ( ' stroke ' , ' gray ' ) ; <nl> + . attr ( ' stroke ' , ' gray ' ) <nl> + . merge ( this . linkSelection ) ; <nl> / / Create a D3 selection for the nodes , and initialize it with some circle <nl> / / elements . <nl> @ @ - 85 , 14 + 87 , 15 @ @ export default class SimilarityGraph extends VisComponent { <nl> . selectAll ( ' circle . node ' ) <nl> . data ( this . nodes ) ; <nl> - this . nodeSelection . enter ( ) <nl> + this . nodeSelection = this . nodeSelection . enter ( ) <nl> . append ( ' circle ' ) <nl> . classed ( ' node ' , true ) <nl> . attr ( ' r ' , d = > d . size ) <nl> . style ( ' stroke ' , ' black ' ) <nl> . style ( ' fill ' , d = > d . color ) <nl> . style ( ' cursor ' , ' crosshair ' ) <nl> - . call ( this . cola . drag ) ; <nl> + . call ( this . cola . drag ) <nl> + . merge ( this . nodeSelection ) ; <nl> / / Create a D3 selection for node labels . <nl> this . labelSelection = d3 . select ( this . svg ) <nl> @ @ - 100 , 7 + 103 , 7 @ @ export default class SimilarityGraph extends VisComponent { <nl> . data ( this . nodes ) ; <nl> const that = this ; <nl> - this . labelSelection . enter ( ) <nl> + this . labelSelection = this . labelSelection . enter ( ) <nl> . append ( ' text ' ) <nl> . classed ( ' label ' , true ) <nl> . text ( d = > d . id ) <nl> @ @ - 109 , 7 + 112 , 8 @ @ export default class SimilarityGraph extends VisComponent { <nl> that . nodes [ i ] . height + = bbox . height ; <nl> } ) <nl> . style ( ' cursor ' , ' crosshair ' ) <nl> - . call ( this . cola . drag ) ; <nl> + . call ( this . cola . drag ) <nl> + . merge ( this . labelSelection ) ; <nl> this . cola . on ( ' tick ' , ( . . . args ) = > { <nl> this . nodeSelection <nl> 
mmm a / util / vega / index . js <nl> ppp b / util / vega / index . js <nl> + import { select } from ' d3 - selection ' ; <nl> import vg from ' vega ' ; <nl> import { isArray , isString , read } from ' datalib ' ; <nl> import axisTemplate from ' . / axis . json ' ; <nl> @ @ - 386 , 7 + 386 , 7 @ @ let merge = function ( defaults , options ) { <nl> let parseChart = function ( spec , element , options ) { <nl> / / Use element size to set size , unless size explicitly specified or <nl> / / element size is zero . <nl> - let el = d3 . select ( element ) [ 0 ] [ 0 ] ; <nl> + let el = select ( element ) . node ( ) ; <nl> let sizeOptions = { } ; <nl> const size = getElementSize ( el ) ; <nl> 
mmm a / components / TreeHeatmap / index . js <nl> ppp b / components / TreeHeatmap / index . js <nl> - import d3 from ' d3 ' ; <nl> + import * as d3 from ' d3 ' ; <nl> import { getElementSize } from ' . . / . . / util ' ; <nl> export default class TreeHeatmap extends VisComponent { <nl> @ @ - 258 , 8 + 258 , 8 @ @ export default class TreeHeatmap extends VisComponent { <nl> let distance = d = > d . distance ; <nl> - let xScale = d3 . scale . linear ( ) . domain ( [ 0 , content [ 0 ] . length ] ) . range ( [ xStart , xStart + colSize ] ) ; <nl> - let yScale = d3 . scale . linear ( ) . domain ( [ 0 , content . length ] ) . range ( [ yStart , yStart + rowSize ] ) ; <nl> + let xScale = d3 . scaleLinear ( ) . domain ( [ 0 , content [ 0 ] . length ] ) . range ( [ xStart , xStart + colSize ] ) ; <nl> + let yScale = d3 . scaleLinear ( ) . domain ( [ 0 , content . length ] ) . range ( [ yStart , yStart + rowSize ] ) ; <nl> let tree = function ( orientation , links , leaves , x , y , width , height , duration ) { <nl> let numLeaves = leaves . length ; <nl> @ @ - 292 , 8 + 292 , 8 @ @ export default class TreeHeatmap extends VisComponent { <nl> } <nl> } <nl> let distanceExtent = [ 0 , distance ( finalCluster ) ] ; <nl> - let distanceScale = d3 . scale . linear ( ) . domain ( distanceExtent ) . range ( [ y + height , y ] ) ; <nl> - let treeScale = d3 . scale . linear ( ) . domain ( [ 0 , numLeaves ] ) . range ( [ x , x + width ] ) ; <nl> + let distanceScale = d3 . scaleLinear ( ) . domain ( distanceExtent ) . range ( [ y + height , y ] ) ; <nl> + let treeScale = d3 . scaleLinear ( ) . domain ( [ 0 , numLeaves ] ) . range ( [ x , x + width ] ) ; <nl> let axis1 = ' y ' ; <nl> let axis2 = ' x ' ; <nl> if ( orientation = = = ' vertical ' ) { <nl> @ @ - 321 , 7 + 321 , 7 @ @ export default class TreeHeatmap extends VisComponent { <nl> let reverseLinks = links . slice ( ) . reverse ( ) ; <nl> - let line = d3 . svg . line ( ) ; <nl> + let line = d3 . line ( ) ; <nl> if ( orientation = = = ' horizontal ' ) { <nl> line . x ( d = > d [ 1 ] ) . y ( d = > d [ 0 ] ) ; <nl> } <nl> @ @ - 414 , 19 + 414 , 19 @ @ export default class TreeHeatmap extends VisComponent { <nl> let colColor = [ ] ; <nl> for ( let col = 0 ; col < content [ 0 ] . length ; col + = 1 ) { <nl> - colColor [ columns [ col ] . offset ] = d3 . scale . linear ( ) . domain ( d3 . extent ( content , d = > d [ col ] ) ) . range ( [ ' white ' , ' steelblue ' ] ) ; <nl> + colColor [ columns [ col ] . offset ] = d3 . scaleLinear ( ) . domain ( d3 . extent ( content , d = > d [ col ] ) ) . range ( [ ' white ' , ' steelblue ' ] ) ; <nl> } <nl> let rowColor = [ ] ; <nl> for ( let row = 0 ; row < content . length ; row + = 1 ) { <nl> - rowColor [ rows [ row ] . offset ] = d3 . scale . linear ( ) . domain ( d3 . extent ( content [ row ] ) ) . range ( [ ' white ' , ' steelblue ' ] ) ; <nl> + rowColor [ rows [ row ] . offset ] = d3 . scaleLinear ( ) . domain ( d3 . extent ( content [ row ] ) ) . range ( [ ' white ' , ' steelblue ' ] ) ; <nl> } <nl> let globalMin = d3 . min ( content , d = > d3 . min ( d ) ) ; <nl> let globalMax = d3 . max ( content , d = > d3 . max ( d ) ) ; <nl> - let globalColor = d3 . scale . linear ( ) . domain ( [ globalMin , globalMax ] ) . range ( [ ' white ' , ' steelblue ' ] ) ; <nl> + let globalColor = d3 . scaleLinear ( ) . domain ( [ globalMin , globalMax ] ) . range ( [ ' white ' , ' steelblue ' ] ) ; <nl> - let corrColor = d3 . scale . linear ( ) . domain ( [ - 1 , 0 , 1 ] ) . range ( [ ' red ' , ' white ' , ' green ' ] ) ; <nl> + let corrColor = d3 . scaleLinear ( ) . domain ( [ - 1 , 0 , 1 ] ) . range ( [ ' red ' , ' white ' , ' green ' ] ) ; <nl> let color = d = > globalColor ( d . value ) ; <nl> if ( this . scale = = = ' row ' ) { <nl> 
mmm a / app / examples / tree - heatmap / index . js <nl> ppp b / app / examples / tree - heatmap / index . js <nl> import TreeHeatmap from ' . . / . . / . . / components / TreeHeatmap ' ; <nl> window . onload = ( ) = > { <nl> - showComponent ( TreeHeatmap , ' div ' , { <nl> - data : heatmap <nl> + showComponent ( TreeHeatmap , { <nl> + data : heatmap , <nl> + scale : ' column ' <nl> } ) ; <nl> } ; <nl> 
mmm a / components / SentenTree / index . js <nl> ppp b / components / SentenTree / index . js <nl> SentenTreeVis } from ' sententree / dist / SentenTree ' ; <nl> export default class SentenTree extends VisComponent { <nl> + static get options ( ) { <nl> + return [ <nl> + { <nl> + name : ' data ' , <nl> + description : ' The data table . ' , <nl> + type : ' table ' , <nl> + format : ' objectlist ' <nl> + } , <nl> + { <nl> + name : ' id ' , <nl> + description : ' The field containing the identifier of each row . ' , <nl> + type : ' string ' , <nl> + domain : { <nl> + mode : ' field ' , <nl> + from : ' data ' , <nl> + fieldTypes : [ ' string ' , ' integer ' , ' number ' ] <nl> + } <nl> + } , <nl> + { <nl> + name : ' text ' , <nl> + description : ' The field containing the text sample . ' , <nl> + domain : { <nl> + mode : ' field ' , <nl> + from : ' data ' , <nl> + fieldTypes : [ ' string ' ] <nl> + } <nl> + } , <nl> + { <nl> + name : ' count ' , <nl> + description : ' The field containing the count for each text sample . ' , <nl> + type : ' string ' , <nl> + domain : { <nl> + mode : ' field ' , <nl> + from : ' data ' , <nl> + fieldTypes : [ ' integer ' ] <nl> + } <nl> + } <nl> + ] ; <nl> + } <nl> + <nl> constructor ( el , { data , graphs = 3 } ) { <nl> super ( el ) ; <nl> 
mmm a / components / SentenTree / index . js <nl> ppp b / components / SentenTree / index . js <nl> + <nl> import VisComponent from ' . . / . . / VisComponent ' ; <nl> import { SentenTreeBuilder , <nl> SentenTreeVis } from ' sententree / dist / SentenTree ' ; <nl> @ @ - 53 , 6 + 55 , 11 @ @ export default class SentenTree extends VisComponent { <nl> constructor ( el , { data , id = null , text = ' text ' , count = ' count ' , graphs = 3 } ) { <nl> super ( el ) ; <nl> + / / Empty element . <nl> + select ( el ) <nl> + . selectAll ( ' * ' ) <nl> + . remove ( ) ; <nl> + <nl> / / Transform input data into correct form . <nl> this . data = data . map ( ( d , i ) = > ( { <nl> id : id ? d [ id ] : i , <nl> 
mmm a / components / SentenTree / index . js <nl> ppp b / components / SentenTree / index . js <nl> { <nl> name : ' text ' , <nl> description : ' The field containing the text sample . ' , <nl> + type : ' string ' , <nl> domain : { <nl> mode : ' field ' , <nl> from : ' data ' , <nl> 
mmm a / components / TreeHeatmap / index . js <nl> ppp b / components / TreeHeatmap / index . js <nl> let rows = [ ] ; <nl> let reachedMetadata = false ; <nl> this . data . forEach ( row = > { <nl> - let id = String ( row [ idColumn ] ) ; <nl> + let id = ' ' + row [ idColumn ] ; <nl> if ( id = = = ' _child1 ' ) { <nl> reachedMetadata = true ; <nl> } <nl> @ @ - 159 , 7 + 159 , 7 @ @ export default class TreeHeatmap extends VisComponent { <nl> let originalDataRows = { } ; <nl> reachedMetadata = false ; <nl> this . data . forEach ( row = > { <nl> - let id = String ( row [ idColumn ] ) ; <nl> + let id = ' ' + row [ idColumn ] ; <nl> if ( id = = = ' _child1 ' ) { <nl> reachedMetadata = true ; <nl> } <nl> @ @ - 170 , 14 + 170 , 14 @ @ export default class TreeHeatmap extends VisComponent { <nl> originalDataRows [ id ] = row ; <nl> return ; <nl> } <nl> - content . push ( columns . map ( col = > Number ( row [ col . name ] ) ) ) ; <nl> - if ( clusterRows & & Number ( row . _cluster ) > = 0 ) { <nl> + content . push ( columns . map ( col = > + row [ col . name ] ) ) ; <nl> + if ( clusterRows & & + row . _cluster > = 0 ) { <nl> rowLinks . push ( { <nl> - cluster : Number ( row . _cluster ) , <nl> - child1 : Number ( row . _child1 ) , <nl> - child2 : Number ( row . _child2 ) , <nl> - distance : Number ( row . _distance ) , <nl> - size : Number ( row . _size ) <nl> + cluster : + row . _cluster , <nl> + child1 : + row . _child1 , <nl> + child2 : + row . _child2 , <nl> + distance : + row . _distance , <nl> + size : + row . _size <nl> } ) ; <nl> } <nl> } ) ; <nl> @ @ - 185 , 13 + 185 , 13 @ @ export default class TreeHeatmap extends VisComponent { <nl> let colLinks = [ ] ; <nl> if ( clusterColumns ) { <nl> columns . forEach ( col = > { <nl> - if ( metadataRows . _cluster & & Number ( metadataRows . _cluster [ col . name ] ) > = 0 ) { <nl> + if ( metadataRows . _cluster & & + metadataRows . _cluster [ col . name ] > = 0 ) { <nl> colLinks . push ( { <nl> - cluster : Number ( metadataRows . _cluster [ col . name ] ) , <nl> - child1 : Number ( metadataRows . _child1 [ col . name ] ) , <nl> - child2 : Number ( metadataRows . _child2 [ col . name ] ) , <nl> - distance : Number ( metadataRows . _distance [ col . name ] ) , <nl> - size : Number ( metadataRows . _size [ col . name ] ) <nl> + cluster : + metadataRows . _cluster [ col . name ] , <nl> + child1 : + metadataRows . _child1 [ col . name ] , <nl> + child2 : + metadataRows . _child2 [ col . name ] , <nl> + distance : + metadataRows . _distance [ col . name ] , <nl> + size : + metadataRows . _size [ col . name ] <nl> } ) ; <nl> } <nl> } ) ; <nl> 
mmm a / components / index . js <nl> ppp b / components / index . js <nl> - import BoxPlot from ' . / BoxPlot ' ; <nl> - import BulletChart from ' . / BulletChart ' ; <nl> - import GanttChart from ' . / GanttChart ' ; <nl> - import Geo from ' . / Geo ' ; <nl> - import GeoDots from ' . / GeoDots ' ; <nl> - import Glo from ' . / Glo ' ; <nl> - import Heatmap from ' . / Heatmap ' ; <nl> - import Histogram from ' . / Histogram ' ; <nl> - import LineChart from ' . / LineChart ' ; <nl> - import LineUp from ' . / LineUp ' ; <nl> - import OnSet from ' . / OnSet ' ; <nl> - import ScatterPlot from ' . / ScatterPlot ' ; <nl> - import ScatterPlotMatrix from ' . / ScatterPlotMatrix ' ; <nl> - import SentenTree from ' . / SentenTree ' ; <nl> - import SimilarityGraph from ' . / SimilarityGraph ' ; <nl> - import SurvivalPlot from ' . / SurvivalPlot ' ; <nl> - import TrackerDash from ' . / TrackerDash ' ; <nl> - import TreeHeatmap from ' . / TreeHeatmap ' ; <nl> - import UpSet from ' . / UpSet ' ; <nl> - <nl> - export default { <nl> - BarChart , <nl> - BoxPlot , <nl> - BulletChart , <nl> - GanttChart , <nl> - Geo , <nl> - GeoDots , <nl> - Glo , <nl> - Heatmap , <nl> - Histogram , <nl> - LineChart , <nl> - LineUp , <nl> - OnSet , <nl> - ScatterPlot , <nl> - ScatterPlotMatrix , <nl> - SentenTree , <nl> - SimilarityGraph , <nl> - SurvivalPlot , <nl> - TrackerDash , <nl> - TreeHeatmap , <nl> - UpSet <nl> - } ; <nl> + export default { } ; <nl> 
mmm a / examples / webpack . config . js <nl> ppp b / examples / webpack . config . js <nl> module . exports = candelaLoaders ( { <nl> entry : entry , <nl> output : { <nl> - path : ' build ' , <nl> + path : ' . . / build / examples ' , <nl> filename : ' [ name ] / index . js ' <nl> } , <nl> plugins : htmlPlugins . concat ( [ <nl> 
mmm a / packages / vega / src / component / BoxPlot / index . js <nl> ppp b / packages / vega / src / component / BoxPlot / index . js <nl> } , <nl> width : this . getWidth ( 200 ) , <nl> height : this . getHeight ( 200 ) , <nl> - mark : ' box - plot ' <nl> - } ; <nl> - <nl> - spec . encoding . y = { <nl> + mark : ' box - plot ' , <nl> + encoding : { <nl> + y : { <nl> field : ' __value ' , <nl> type : ' quantitative ' , <nl> axis : { title : ' ' } <nl> - } ; <nl> - <nl> - spec . encoding . column = { <nl> + } , <nl> + column : { <nl> field : ' __field ' , <nl> type : ' nominal ' , <nl> header : { title : ' ' } <nl> - } ; <nl> - <nl> - spec . encoding . x = { <nl> + } , <nl> + x : { <nl> field : this . options . x | | ' ' , <nl> type : this . options . xType | | ' nominal ' <nl> - } ; <nl> - <nl> - spec . encoding . color = { <nl> + } , <nl> + color : { <nl> field : this . options . color | | ' ' , <nl> type : this . options . colorType | | ' nominal ' <nl> + } <nl> + } <nl> } ; <nl> return spec ; <nl> 
mmm a / src / lib / webpack - config . js <nl> ppp b / src / lib / webpack - config . js <nl> import CopyWebpackPlugin from ' copy - webpack - plugin ' ; <nl> import ReplacePlugin from ' replace - bundle - webpack - plugin ' ; <nl> import SWPrecacheWebpackPlugin from ' sw - precache - webpack - plugin ' ; <nl> - import createBabelConfig from ' . / babel - config ' ; <nl> import prerender from ' . / prerender ' ; <nl> import PushManifestPlugin from ' . / push - manifest ' ; <nl> 
mmm a / src / lib / run - webpack . js <nl> ppp b / src / lib / run - webpack . js <nl> if ( first ) { <nl> first = false ; <nl> let devServer = config . devServer ; <nl> - let serverAddr = ` $ { devServer . https = = = true ? ' https ' : ' http ' } : / / $ { process . env . HOST | | devServer . host | | ' localhost ' } : $ { process . env . PORT | | devServer . port | | 8080 } ` ; <nl> + let serverAddr = ` $ { devServer . https ? ' https ' : ' http ' } : / / $ { process . env . HOST | | devServer . host | | ' localhost ' } : $ { process . env . PORT | | devServer . port | | 8080 } ` ; <nl> process . stdout . write ( ` \ u001b [ 32m > Development server started at $ { serverAddr } \ u001b [ 39m \ n ` ) ; <nl> } <nl> if ( onprogress ) onprogress ( stats ) ; <nl> 
mmm a / src / commands / create . js <nl> ppp b / src / commands / create . js <nl> await fs . writeFile ( path . resolve ( target , ' package . json ' ) , JSON . stringify ( pkg , null , 2 ) ) ; <nl> + if ( argv . install ) { <nl> spinner . text = ' Installing dev dependencies ' ; <nl> - if ( argv . install ) { <nl> await npm ( target , [ <nl> ' install ' , ' - - save - dev ' , <nl> ' preact - cli ' , <nl> @ @ - 146 , 9 + 146 , 9 @ @ export default asyncCommand ( { <nl> ' preact - compat ' , <nl> ' preact - router ' <nl> ] ) ; <nl> - } <nl> spinner . succeed ( ' Done ! \ n ' ) ; <nl> + } <nl> return ` <nl> To get started , cd into the new directory : <nl> 
mmm a / src / lib / webpack / proxy - loader . js <nl> ppp b / src / lib / webpack / proxy - loader . js <nl> function proxyLader ( source , map ) { <nl> var options = utils . getOptions ( this ) ; <nl> - / / First loader run store passed options & remove proxy - loader specific <nl> + / / First run proxy - loader run <nl> if ( ! this . query . __proxy_loader__ ) { <nl> + / / Store passed options for future calls to proxy - loader with same loaderContext ( this ) <nl> + / / e . g . calls via ' this . addDependency ' from actual loader <nl> this . query . __proxy_loader__ = { loader : options . loader , cwd : options . cwd } ; <nl> - / / remove proxy - loader options and make this . query act as requested loader query <nl> - swapOptions ( this , options ) ; <nl> + / / Remove proxy - loader options and make this . query act as requested loader query <nl> + swapOptions ( this , options . options ) ; <nl> } <nl> - / / Save it for future calls that use this loader ( via this . addDependency ) <nl> var proxyOptions = this . query . __proxy_loader__ ; <nl> var loader ; <nl> @ @ - 21 , 22 + 22 , 24 @ @ function proxyLader ( source , map ) { <nl> loader = require ( proxyOptions . loader ) ; <nl> } <nl> - / / run loader <nl> - return loader . bind ( this ) ( source , map ) ; <nl> + / / Run actual loader <nl> + return loader . call ( this , source , map ) ; <nl> } <nl> function swapOptions ( loaderContext , newOptions ) { <nl> var copy = { } ; <nl> var key = ' ' ; <nl> - for ( key in loaderContext . options ) { <nl> + for ( key in newOptions ) { <nl> copy [ key ] = newOptions [ key ] ; <nl> } <nl> + / / Delete all existing loader options <nl> delete loaderContext . query . options ; <nl> delete loaderContext . query . loader ; <nl> delete loaderContext . query . cwd ; <nl> + / / Add new options <nl> for ( key in copy ) { <nl> loaderContext . query [ key ] = copy [ key ] ; <nl> } <nl> 
mmm a / packages / cli / src / lib / webpack / render - html - plugin . js <nl> ppp b / packages / cli / src / lib / webpack / render - html - plugin . js <nl> const os = require ( ' os ' ) ; <nl> - const { existsSync , readFileSync , writeFileSync , mkdirSync } = require ( ' fs ' ) ; <nl> + const { existsSync , mkdtempSync , readFileSync , writeFileSync } = require ( ' fs ' ) ; <nl> const HtmlWebpackExcludeAssetsPlugin = require ( ' html - webpack - exclude - assets - plugin ' ) ; <nl> const HtmlWebpackPlugin = require ( ' html - webpack - plugin ' ) ; <nl> const prerender = require ( ' . / prerender ' ) ; <nl> @ @ - 45 , 13 + 45 , 7 @ @ module . exports = async function ( config ) { <nl> / / Unfortunately html - webpack - plugin expects a true file , <nl> / / so we ' ll create a temporary one . <nl> - const tmpDir = join ( <nl> - os . tmpdir ( ) , <nl> - ` preact - cli - $ { Math . floor ( Math . random ( ) * 100000 ) } ` <nl> - ) ; <nl> - if ( ! existsSync ( tmpDir ) ) { <nl> - mkdirSync ( tmpDir ) ; <nl> - } <nl> + const tmpDir = mkdtempSync ( join ( os . tmpdir ( ) , ' preact - cli - ' ) ) ; <nl> template = resolve ( tmpDir , ' template . tmp . ejs ' ) ; <nl> writeFileSync ( template , content ) ; <nl> } <nl> 
mmm a / src / lib / util / assertString . js <nl> ppp b / src / lib / util / assertString . js <nl> - const isString = ( typeof input = = = ' string ' | | input instanceof String ) ; <nl> + const isString = typeof input = = = ' string ' | | input instanceof String ; <nl> if ( ! isString ) { <nl> - let invalidType ; <nl> - if ( input = = = null ) { <nl> - invalidType = ' null ' ; <nl> - } else { <nl> - invalidType = typeof input ; <nl> - if ( invalidType = = = ' object ' & & input . constructor & & input . constructor . hasOwnProperty ( ' name ' ) ) { <nl> - invalidType = input . constructor . name ; <nl> - } else { <nl> - invalidType = ` a $ { invalidType } ` ; <nl> - } <nl> - } <nl> - throw new TypeError ( ` Expected string but received $ { invalidType } . ` ) ; <nl> + let invalidType = typeof input ; <nl> + if ( input = = = null ) invalidType = ' null ' ; <nl> + else if ( invalidType = = = ' object ' ) invalidType = input . constructor . name ; <nl> + <nl> + throw new TypeError ( ` Expected a string but received a $ { invalidType } ` ) ; <nl> } <nl> } <nl> 
mmm a / src / lib / isIP . js <nl> ppp b / src / lib / isIP . js <nl> return isIP ( str , 4 ) | | isIP ( str , 6 ) ; <nl> } <nl> if ( version = = = ' 4 ' ) { <nl> - if ( ! IPv4AddressRegExp . test ( str ) ) { <nl> - return false ; <nl> - } <nl> - const parts = str . split ( ' . ' ) . sort ( ( a , b ) = > a - b ) ; <nl> - return parts [ 3 ] < = 255 ; <nl> + return IPv4AddressRegExp . test ( str ) ; <nl> } <nl> if ( version = = = ' 6 ' ) { <nl> - return ! ! IPv6AddressRegExp . test ( str ) ; <nl> + return IPv6AddressRegExp . test ( str ) ; <nl> } <nl> return false ; <nl> } <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> const path = require ( ' path ' ) <nl> + const rootPath = path . join ( __dirname , ' . . / ' ) / / = " / " <nl> + const distPath = path . join ( rootPath , ' . / dist ' ) / / = " / dist " <nl> + const srcPath = path . join ( rootPath , ' . / src ' ) / / = " / src " <nl> + const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> module . exports = { <nl> port : process . env . PORT | | 3000 , <nl> title : ' React - Semantic . UI - Starter ' , <nl> publicPath : ' / ' , <nl> - srcPath : path . join ( __dirname , ' . . / src ' ) , <nl> - srcCommonPath : path . join ( __dirname , ' . . / src / common ' ) , <nl> - distPath : path . join ( __dirname , ' . . / dist ' ) , <nl> - / / your app ' s manifest . json <nl> + / / It ' s better to define pathes in one file <nl> + / / and then use everywhere across app <nl> + srcPath , <nl> + srcCommonPath , <nl> + distPath , <nl> + rootPath , <nl> + / / base places where server and client both search for modules <nl> + modules : [ ] , <nl> + / / aliases that both server and client use <nl> + alias : { <nl> + actions : ` $ { srcCommonPath } / actions / ` , <nl> + api : ` $ { srcCommonPath } / api / ` , <nl> + components : ` $ { srcCommonPath } / components / ` , <nl> + containers : ` $ { srcCommonPath } / containers / ` , <nl> + reducers : ` $ { srcCommonPath } / reducers / ` , <nl> + routing : ` $ { srcCommonPath } / routing / ` , <nl> + styles : ` $ { srcCommonPath } / styles / ` , <nl> + static : ` $ { rootPath } / static ` , <nl> + images : ` $ { rootPath } / static / images ` <nl> + } , <nl> + / / text for WebpackBannerPlugin , <nl> + / / this plugin just adds text banner to the beginning of your file <nl> + banner : ' MIT License . Copyright ( c ) 2017 Vladimir Metnew All Rights Reserved . Repo : https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> + / / your manifest . json <nl> manifest : { <nl> name : ' React - Semantic . UI - Starter ' , <nl> short_name : ' RSUIS ' , <nl> description : ' https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> icons : [ <nl> { <nl> - " src " : " icons / android - chrome - 36x36 . png " , <nl> - " sizes " : " 36x36 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 36x36 . png ' , <nl> + sizes : ' 36x36 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 48x48 . png " , <nl> - " sizes " : " 48x48 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 48x48 . png ' , <nl> + sizes : ' 48x48 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 72x72 . png " , <nl> - " sizes " : " 72x72 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 72x72 . png ' , <nl> + sizes : ' 72x72 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 96x96 . png " , <nl> - " sizes " : " 96x96 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 96x96 . png ' , <nl> + sizes : ' 96x96 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 144x144 . png " , <nl> - " sizes " : " 144x144 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 144x144 . png ' , <nl> + sizes : ' 144x144 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 192x192 . png " , <nl> - " sizes " : " 192x192 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 192x192 . png ' , <nl> + sizes : ' 192x192 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 256x256 . png " , <nl> - " sizes " : " 256x256 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 256x256 . png ' , <nl> + sizes : ' 256x256 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 384x384 . png " , <nl> - " sizes " : " 384x384 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 384x384 . png ' , <nl> + sizes : ' 384x384 ' , <nl> + type : ' image / png ' <nl> } , <nl> { <nl> - " src " : " icons / android - chrome - 512x512 . png " , <nl> - " sizes " : " 512x512 " , <nl> - " type " : " image / png " <nl> + src : ' icons / android - chrome - 512x512 . png ' , <nl> + sizes : ' 512x512 ' , <nl> + type : ' image / png ' <nl> } <nl> ] , <nl> start_url : ' . ' , <nl> 
mmm a / webpack_config / server . js <nl> ppp b / webpack_config / server . js <nl> const express = require ( ' express ' ) <nl> const httpProxy = require ( ' http - proxy ' ) <nl> const webpack = require ( ' webpack ' ) <nl> - const webpackConfig = require ( ' . / webpack . dev ' ) <nl> + const webpackConfig = require ( ' . / client / webpack . dev ' ) <nl> const config = require ( ' . / config ' ) <nl> const LogPlugin = require ( ' . / log - plugin ' ) <nl> const open = require ( ' open ' ) <nl> - const app = express ( ) <nl> const apiProxy = httpProxy . createProxyServer ( ) <nl> - <nl> - const port = config . port <nl> + const app = express ( ) <nl> + const { port } = config <nl> webpackConfig . entry . client = [ <nl> ' react - hot - loader / patch ' , <nl> ' webpack - hot - middleware / client ? reload = true ' , <nl> @ @ - 31 , 6 + 30 , 7 @ @ try { <nl> const devMiddleWare = require ( ' webpack - dev - middleware ' ) ( compiler , { <nl> publicPath : webpackConfig . output . publicPath , <nl> + / / @ Metnew : personally I prefer ` quite : " true " ` <nl> quiet : false , <nl> hot : true , <nl> inline : true , <nl> @ @ - 60 , 9 + 60 , 13 @ @ app . get ( ' * ' , ( req , res ) = > { <nl> } ) <nl> } ) <nl> - / / Proxy api requests <nl> + / / Proxy api requests to BASE_API <nl> app . use ( process . env . BASE_API , function ( req , res ) { <nl> - req . url = req . baseUrl <nl> + / * * <nl> + * / / req . baseUrl - The URL path on which a router instance was mounted . <nl> + * { @ link https : / / expressjs . com / ru / 4x / api . html # req . baseUrl } <nl> + * / <nl> + req . url = req . baseUrl + req . url <nl> apiProxy . web ( req , res , { <nl> target : { <nl> port : 4000 , <nl> 
mmm a / src / server / ssr / index . js <nl> ppp b / src / server / ssr / index . js <nl> import fs from ' fs ' <nl> + import chalk from ' chalk ' <nl> / / React - related stuff <nl> import React from ' react ' <nl> import { render } from ' rapscallion ' <nl> - import Helmet from ' react - helmet ' <nl> - import { StaticRouter } from ' react - router ' <nl> + / / import Helmet from ' react - helmet ' <nl> import { ServerStyleSheet , StyleSheetManager } from ' styled - components ' <nl> / / Application <nl> - / / Do you remember that we use webpack aliases provided by cool babel plugin ? <nl> - / / ( take a look at . babelrc ) <nl> import { configureStore , configureRootComponent } from ' common / index ' <nl> - / / <nl> - const language = process . env . APP_LANGUAGE | | ' en ' <nl> - const distPath = ` . . / . . / . . / dist / $ { language } ` <nl> - / / read index . html and assign a variable <nl> - const indexPath = path . join ( __dirname , ` $ { distPath } / index . html ` ) <nl> - const indexHTMLFileContent = ( function ( ) { <nl> + / / read index . html and assign to a variable <nl> + const indexPath = path . join ( ` $ { process . env . DIST_PATH } / index . html ` ) <nl> + const htmlFile = ( function ( ) { <nl> try { <nl> return fs . readFileSync ( indexPath , ' utf8 ' ) <nl> } catch ( e ) { <nl> - throw new Error ( ` Are you sure you have already built app ? $ { e } ` ) <nl> + console . error ( chalk . bgRed ( ` Are you sure you have already built app ? $ { e } ` ) ) <nl> + console . log ( chalk . bgCyan ( ' Application is working without SSR ' ) ) <nl> + return false <nl> } <nl> } ) ( ) <nl> - <nl> export default function ( req , res ) { <nl> + if ( ! htmlFile ) { <nl> + / / NOTE : @ Metnew ( 29 . 07 . 2017 ) : Here must be a requirement of ejs / jade template <nl> + / / app probably needs in template engine ! <nl> + const warning = ` <nl> + < h1 > Do you remember that you don ' t have SSR ? < / h1 > <nl> + < h2 > Why it happens ? < / h2 > <nl> + < h3 > Probably , because of : < / h3 > <nl> + < h4 > <nl> + < ul > <nl> + < li > No " index . html " in the dist folder . e . g . : You don ' t have already built app . < / li > <nl> + < li > Path to dist folder with client app is invalid , check process . env . DIST_PATH in " webpack_config / server / webpack . base . " < / li > <nl> + < pre > process . env . path = = = $ { process . env . DIST_PATH } < / pre > <nl> + < pre > URL : $ { req . url } < / pre > <nl> + < / ul > <nl> + < / h4 > <nl> + ` <nl> + return res . send ( warning ) <nl> + } <nl> / / Auth - related stuff <nl> / / NOTE : check ` server / express / index . js ` for more info <nl> const { user } = req <nl> const { isLoggedIn , token } = user <nl> - const initialState = isLoggedIn <nl> - ? { me : { auth : { isLoggedIn , token } } } <nl> - : { } <nl> + const initialState = isLoggedIn ? { me : { auth : { isLoggedIn , token } } } : { } <nl> / / <nl> const sheet = new ServerStyleSheet ( ) <nl> + const location = req . url <nl> const context = { } <nl> const store = configureStore ( initialState ) <nl> - const RootComponent = configureRootComponent ( store ) <nl> + const RootComponent = configureRootComponent ( { <nl> + store , <nl> + SSR : { location , context } <nl> + } ) <nl> const App = ( <nl> < StyleSheetManager sheet = { sheet . instance } > <nl> - < StaticRouter url = { req . url } context = { context } > <nl> { RootComponent } <nl> - < / StaticRouter > <nl> < / StyleSheetManager > <nl> ) <nl> / / <nl> @ @ - 54 , 7 + 68 , 7 @ @ export default function ( req , res ) { <nl> function renderFullPage ( { html , css , preloadedState } ) { <nl> / / console . log ( indexHTMLFileContent ) <nl> - const indexHTMLFileContentWithRedux = indexHTMLFileContent . replace ( <nl> + const htmlWithRedux = htmlFile . replace ( <nl> ' < div id = " app " > < / div > ' , <nl> ` < div id = " app " > $ { html } < / div > < script > <nl> window . __PRELOADED_STATE__ = $ { JSON . stringify ( preloadedState ) . replace ( <nl> @ @ - 63 , 9 + 77 , 9 @ @ function renderFullPage ( { html , css , preloadedState } ) { <nl> ) } <nl> < / script > < span style = " display : none ; " > Server - side rendering ! < / span > ` <nl> ) <nl> - const indexHTMLFileContentWithStylesAndRedux = indexHTMLFileContentWithRedux . replace ( <nl> + const styledHtmlWithRedux = htmlWithRedux . replace ( <nl> ' < meta name = " ssr - styles " / > ' , <nl> css <nl> ) <nl> - return indexHTMLFileContentWithStylesAndRedux <nl> + return styledHtmlWithRedux <nl> } <nl> 
mmm a / src / server / express / index . js <nl> ppp b / src / server / express / index . js <nl> import express from ' express ' <nl> - import expressHelmet from ' helmet ' <nl> + import helmet from ' helmet ' <nl> import compression from ' compression ' <nl> - import path from ' path ' <nl> - import fs from ' fs ' <nl> import cookieParser from ' cookie - parser ' <nl> import morgan from ' morgan ' <nl> + import jwt from ' jsonwebtoken ' <nl> + import chalk from ' chalk ' <nl> / / Application - related stuff <nl> - / / Do you remember that we use webpack aliases provided by cool babel plugin in . babelrc <nl> import { JWT_TOKEN } from ' common / api ' <nl> - / / <nl> - const language = process . env . APP_LANGUAGE | | ' en ' <nl> - const distPath = ` . . / . . / . . / dist / $ { language } ` <nl> + <nl> const app = express ( ) <nl> / / add express stuff <nl> + app . use ( helmet ( ) ) <nl> app . use ( compression ( ) ) <nl> app . use ( morgan ( ' dev ' ) ) <nl> app . use ( cookieParser ( ) ) <nl> app . use ( <nl> - express . static ( path . join ( __dirname , distPath ) , { <nl> + express . static ( process . env . DIST_PATH , { <nl> / / don ' t use index . html inside / dist dir <nl> index : false <nl> } ) <nl> ) <nl> app . disable ( ' x - powered - by ' ) <nl> - app . use ( expressHelmet ( ) ) <nl> / / Auth - related middleware , check that user is logged in and token is valid <nl> app . use ( ( req , res , next ) = > { <nl> - / / Of course , you can make auth with jwt or cookies or session only <nl> - / / It ' s a starter project and I implemented a hardcoded solution <nl> + req . user = { } <nl> const token = req . cookies [ JWT_TOKEN ] <nl> - const isLoggedIn = token = = = ' nothing ' <nl> - console . log ( ` USER IS LOGGED IN : $ { isLoggedIn ? ' YES ' : ' NO ' } ` ) <nl> + if ( ! token ) { <nl> + return next ( ) <nl> + } <nl> + <nl> + jwt . verify ( token , process . env . JWT_SECRET , ( err , decoded ) = > { <nl> + if ( err ) { <nl> + console . log ( chalk . red ( ' CANT DECODE JWT TOKEN ! ' , err ) ) <nl> + } else { <nl> req . user = { <nl> + . . . decoded , <nl> token , <nl> - isLoggedIn <nl> + isLoggedIn : true <nl> } <nl> + } <nl> + console . log ( <nl> + chalk . blue ( ` USER IS LOGGED IN : $ { req . user . isLoggedIn ? ' YES ' : ' NO ' } ` ) <nl> + ) <nl> next ( ) <nl> } ) <nl> + } ) <nl> export default app <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> icon : ' newspaper ' , <nl> name : ' Dashboard ' , <nl> exact : true , <nl> + / / lazy : true , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> component : Dashboard <nl> @ @ - 91 , 7 + 92 , 7 @ @ export const Routing = authCheck = > { <nl> function getHistory ( ) { <nl> const basename = ' ' <nl> - if ( process . env . IS_SSR ) { <nl> + if ( process . env . BROWSER ! = = true ) { <nl> return createMemoryHistory ( ) <nl> } <nl> return createBrowserHistory ( { basename } ) <nl> 
mmm a / src / common / components / views / Sidebar / index . jsx <nl> ppp b / src / common / components / views / Sidebar / index . jsx <nl> const routes = routing . map ( ( route , i ) = > { <nl> const { external , path , icon , name , strict , exact } = route <nl> - let propsMenuItem = { <nl> + / / props that are applicable for both " plain link , i . e . < a > " and " RR Link " <nl> + const basicProps = { <nl> as : external ? ' a ' : NavLink , <nl> link : true , <nl> [ external ? ' href ' : ' to ' ] : path <nl> } <nl> - if ( ! external ) { <nl> - propsMenuItem = { <nl> - . . . propsMenuItem , <nl> + / / is it ' s RR Link , then it has more props <nl> + const externalProps = external <nl> + ? { } <nl> + : { <nl> strict , <nl> exact , <nl> activeClassName : ' active ' <nl> } <nl> + <nl> + / / summarize <nl> + const propsMenuItem = { <nl> + . . . externalProps , <nl> + . . . basicProps <nl> } <nl> return ( <nl> 
mmm a / src / common / components / views / Root / index . jsx <nl> ppp b / src / common / components / views / Root / index . jsx <nl> import PropTypes from ' prop - types ' <nl> import { Provider } from ' react - redux ' <nl> - import { ConnectedRouter as Router } from ' react - router - redux ' <nl> import { APPLICATION_INIT } from ' actions ' <nl> import { ThemeProvider } from ' styled - components ' <nl> import theme from ' styles / theme ' <nl> + const Router = process . env . BROWSER = = = true <nl> + ? require ( ' react - router - redux ' ) . ConnectedRouter <nl> + : require ( ' react - router ' ) . StaticRouter <nl> + <nl> export default class Root extends Component { <nl> static propTypes = { <nl> store : PropTypes . object , <nl> + SSR : PropTypes . object , <nl> history : PropTypes . object , <nl> routes : PropTypes . func <nl> } <nl> + static defaultProps = { <nl> + SSR : { } <nl> + } <nl> + <nl> componentWillMount ( ) { <nl> const { store } = this . props <nl> store . dispatch ( { type : APPLICATION_INIT } ) <nl> @ @ - 37 , 11 + 45 , 14 @ @ export default class Root extends Component { <nl> } <nl> render ( ) { <nl> - const { store , history , routes } = this . props <nl> + const { SSR , store , history , routes } = this . props <nl> + const routerProps = process . env . BROWSER = = = true <nl> + ? { history } <nl> + : { location : SSR . location , context : SSR . context } <nl> / / key = { Math . random ( ) } = hack for HMR from https : / / github . com / webpack / webpack - dev - server / issues / 395 <nl> return ( <nl> < Provider store = { store } key = { Math . random ( ) } > <nl> - < Router history = { history } key = { Math . random ( ) } > <nl> + < Router { . . . routerProps } key = { Math . random ( ) } > <nl> < ThemeProvider theme = { theme } > <nl> { routes ( : : this . authCheck ) } <nl> < / ThemeProvider > <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> const distPath = path . join ( rootPath , ' . / dist ' ) / / = " / dist " <nl> const srcPath = path . join ( rootPath , ' . / src ' ) / / = " / src " <nl> const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> - <nl> + const i18n = require ( ' . . / i18n ' ) <nl> module . exports = { <nl> port : process . env . PORT | | 3000 , <nl> title : ' React - Semantic . UI - Starter ' , <nl> publicPath : ' / ' , <nl> + i18n , <nl> / / It ' s better to define pathes in one file <nl> / / and then use everywhere across app <nl> srcPath , <nl> 
mmm a / src / common / components / views / Root / index . jsx <nl> ppp b / src / common / components / views / Root / index . jsx <nl> import { APPLICATION_INIT } from ' actions ' <nl> import { ThemeProvider } from ' styled - components ' <nl> import theme from ' styles / theme ' <nl> + import App from ' containers / App ' <nl> + import RoutingWrapper from ' components / addons / RoutingWrapper ' <nl> const Router = process . env . BROWSER = = = true <nl> ? require ( ' react - router - redux ' ) . ConnectedRouter <nl> @ @ - 14 , 7 + 16 , 7 @ @ export default class Root extends Component { <nl> store : PropTypes . object , <nl> SSR : PropTypes . object , <nl> history : PropTypes . object , <nl> - routes : PropTypes . func <nl> + routes : PropTypes . array <nl> } <nl> static defaultProps = { <nl> @ @ - 54 , 7 + 56 , 9 @ @ export default class Root extends Component { <nl> < Provider store = { store } key = { Math . random ( ) } > <nl> < Router { . . . routerProps } key = { Math . random ( ) } > <nl> < ThemeProvider theme = { theme } > <nl> - { routes ( : : this . authCheck ) } <nl> + < App > <nl> + < RoutingWrapper routes = { routes } authCheck = { : : this . authCheck } / > <nl> + < / App > <nl> < / ThemeProvider > <nl> < / Router > <nl> < / Provider > <nl> 
mmm a / src / common / index . jsx <nl> ppp b / src / common / index . jsx <nl> / / Application <nl> import rootReducer from ' reducers ' <nl> import { Root } from ' components ' <nl> - import { Routing , history } from ' routing ' <nl> + import { routes , history } from ' routing ' <nl> / * * <nl> * Configure application store with middlewares . <nl> @ @ - 33 , 7 + 33 , 7 @ @ export const configureRootComponent = ( { store , SSR } ) = > { <nl> / / stupid eslint thinks that if function returns JSX , than it ' s a component <nl> / / " Eslint , I don ' t want a component , I want a function ! " <nl> const propsRoot = { <nl> - routes : Routing , <nl> + routes , <nl> history , <nl> store , <nl> SSR <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> - import { Route , Redirect , Switch } from ' react - router - dom ' <nl> - import { App , Users , Dashboard , Login } from ' containers ' <nl> - import { RouteAuth } from ' components ' <nl> + import { Route } from ' react - router - dom ' <nl> + import { Users , Dashboard , Login } from ' containers ' <nl> + import { RouteAuth } from ' components / addons ' <nl> import { createBrowserHistory , createMemoryHistory } from ' history ' <nl> export const history = getHistory ( ) <nl> @ @ - 13 , 13 + 12 , 12 @ @ const loadLazyComponent = url = > { <nl> } <nl> } <nl> - export const appRouting = [ <nl> + export const routes = [ <nl> { <nl> path : ' / ' , <nl> + exact : true , <nl> icon : ' newspaper ' , <nl> name : ' Dashboard ' , <nl> - exact : true , <nl> - / / lazy : true , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> component : Dashboard <nl> @ @ - 53 , 43 + 51 , 10 @ @ export const appRouting = [ <nl> exact : true , <nl> strict : true , <nl> tag : RouteAuth , <nl> - component : loadLazyComponent ( ' UsersItem ' ) <nl> + component : loadLazyComponent ( ' UserItem ' ) <nl> } <nl> ] <nl> - / * * <nl> - * Returns application routing with protected by AuthCheck func routes <nl> - * @ param { Function } authCheck checks is user logged in <nl> - * / <nl> - export const Routing = authCheck = > { <nl> - / / remove components that aren ' t application routes , ( e . g . github link in sidebar ) <nl> - const routes = appRouting . filter ( <nl> - a = > a . tag | | a . component | | a . lazy | | ! a . external <nl> - ) <nl> - / / render components that are inside Switch ( main view ) <nl> - const routesRendered = routes . map ( ( a , i ) = > { <nl> - / / get tag for Route . <nl> - / / is it " RouteAuth " ` protected route ` or " Route " ? <nl> - const Tag = a . tag <nl> - const { path , exact , strict , component , lazy } = a <nl> - / / can visitor access this route ? <nl> - const canAccess = authCheck <nl> - / / select only props that we need <nl> - const b = { path , exact , strict , component , canAccess , lazy } <nl> - <nl> - return < Tag key = { i } { . . . b } / > <nl> - } ) <nl> - <nl> - return ( <nl> - < App > <nl> - < Switch > <nl> - { routesRendered } <nl> - < Redirect to = " / " / > <nl> - < / Switch > <nl> - < / App > <nl> - ) <nl> - } <nl> - <nl> function getHistory ( ) { <nl> const basename = ' ' <nl> if ( process . env . BROWSER ! = = true ) { <nl> 
mmm a / src / common / containers / App / index . jsx <nl> ppp b / src / common / containers / App / index . jsx <nl> import { Header , Sidebar , Footer } from ' components ' <nl> import { CLOSE_SIDEBAR , OPEN_SIDEBAR , WINDOW_RESIZE } from ' actions / layout ' <nl> import { LOGOUT_AUTH } from ' actions / auth ' <nl> - import { appRouting } from ' routing ' <nl> + import { routes } from ' routing ' <nl> import { <nl> PageLayout , <nl> MainLayout , <nl> @ @ - 117 , 7 + 117 , 7 @ @ class App extends Component { <nl> * @ return { Array } array of routes that will be rendered in sidebar menu <nl> * / <nl> getSidebarRouting ( ) { <nl> - const sidebarRouting = appRouting . filter ( a = > a . sidebarVisible ) . map ( a = > { <nl> + const sidebarRouting = routes . filter ( a = > a . sidebarVisible ) . map ( a = > { <nl> const { path , name , icon , external , strict , exact } = a <nl> const b = { path , name , icon , external , strict , exact } <nl> return b <nl> @ @ - 131 , 7 + 131 , 7 @ @ class App extends Component { <nl> * @ return { String } page title <nl> * / <nl> getPageTitle ( pathname ) { <nl> - const matchedRoutes = appRouting . filter ( a = > matchPath ( pathname , a ) ) <nl> + const matchedRoutes = routes . filter ( a = > matchPath ( pathname , a ) ) <nl> const currentRoute = matchedRoutes [ 0 ] | | { } <nl> const title = currentRoute . name | | ' 404 ' <nl> return title <nl> 
mmm a / webpack_config / client / webpack . prod . babel . js <nl> ppp b / webpack_config / client / webpack . prod . babel . js <nl> } <nl> } ) , <nl> / / <nl> - / / <nl> - / / <nl> / / create manifest . json <nl> new ManifestPlugin ( { fileName : ' manifest . json ' , cache : config . manifest } ) , <nl> / / generate < link rel = " preload " > tags for async chunks <nl> @ @ - 184 , 19 + 182 , 8 @ @ base . plugins . push ( <nl> filename : path . resolve ( base . output . path , ' index . html ' ) , <nl> chunksSortMode : ' dependency ' <nl> } ) , <nl> - / / ServiceWorkers <nl> new OfflinePlugin ( { <nl> - responseStrategy : ' network - first ' , <nl> - safeToUseOptionalCaches : false , <nl> - caches : { <nl> - main : [ ' vendor . * . css ' , ' vendor . * . js ' ] <nl> - } , <nl> - / / excludes : [ ' . htaccess ' ] , <nl> - AppCache : false , <nl> - ServiceWorker : { <nl> - navigateFallbackURL : ' / ? offline = true ' , <nl> - events : true <nl> - } <nl> + AppCache : false <nl> } ) <nl> ) <nl> 
mmm a / webpack_config / server / webpack . prod . babel . js <nl> ppp b / webpack_config / server / webpack . prod . babel . js <nl> compress : { <nl> warnings : false , <nl> / / This option removes console log in production <nl> - drop_console : true <nl> + / / drop_console : true <nl> } , <nl> output : { <nl> comments : false <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> const { <nl> BASE_API , <nl> SENTRY_DSN , <nl> - SENTRY_PUBLIC_DSN , <nl> NODE_ENV , <nl> DIST_PATH , <nl> APP_LANGUAGE , <nl> @ @ - 27 , 7 + 26 , 6 @ @ const definePluginArgs = { <nl> ' process . env . APP_LANGUAGE ' : JSON . stringify ( language ) , <nl> ' process . env . NODE_ENV ' : JSON . stringify ( NODE_ENV | | ' development ' ) , <nl> ' process . env . BASE_API ' : JSON . stringify ( BASE_API | | ' / api / v1 ' ) , <nl> - ' process . env . SENTRY_PUBLIC_DSN ' : JSON . stringify ( SENTRY_PUBLIC_DSN ) , <nl> ' process . env . SENTRY_DSN ' : JSON . stringify ( SENTRY_DSN ) , <nl> ' process . env . DIST_PATH ' : JSON . stringify ( <nl> DIST_PATH | | path . join ( config . distPath , ' . / client ' , language ) <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> * / <nl> - const path = require ( ' path ' ) <nl> + import path from ' path ' <nl> + import i18n from ' . . / i18n ' <nl> + import manifest from ' . / assets / manifest ' <nl> + <nl> + function ternary ( a , b ) { <nl> + return a ? a : b <nl> + } <nl> + <nl> + / / Vars for both server and frontend <nl> + const BASE_API = ternary ( process . env . BASE_API , ' / api / v1 ' ) <nl> + const APP_LANGUAGE = ternary ( process . env . APP_LANGUAGE , ' en ' ) <nl> + const NODE_ENV = ternary ( process . env . NODE_ENV , ' development ' ) <nl> + <nl> + / / Vars for frontend only <nl> + const SENTRY_DSN_PUBLIC = ternary ( process . env . SENTRY_DSN_PUBLIC ) <nl> + const GA_ID = ternary ( process . env . GA_ID ) <nl> + <nl> + / / Paths <nl> const rootPath = path . join ( __dirname , ' . . / ' ) / / = " / " <nl> const distPath = path . join ( rootPath , ' . / dist ' ) / / = " / dist " <nl> const srcPath = path . join ( rootPath , ' . / src ' ) / / = " / src " <nl> const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> - const i18n = require ( ' . . / i18n ' ) <nl> - module . exports = { <nl> - port : process . env . PORT | | 3000 , <nl> + <nl> + / / Vars for server only <nl> + const DIST_PATH = ternary ( process . env . DIST_PATH , path . join ( distPath , ' . / client ' , APP_LANGUAGE ) ) <nl> + const JWT_SECRET = ternary ( process . env . JWT_SECRET , ' secret ' ) <nl> + const SENTRY_DSN = ternary ( process . env . SENTRY_DSN ) <nl> + const PORT = ternary ( process . env . PORT , 4000 ) <nl> + <nl> + <nl> + export default { <nl> title : ' React - Semantic . UI - Starter ' , <nl> publicPath : ' / ' , <nl> + / / i18n object <nl> i18n , <nl> + / / Env vars <nl> + BASE_API , <nl> + APP_LANGUAGE , <nl> + NODE_ENV , <nl> + SENTRY_DSN_PUBLIC , <nl> + GA_ID , <nl> + DIST_PATH , <nl> + JWT_SECRET , <nl> + SENTRY_DSN , <nl> + PORT , <nl> / / It ' s better to define pathes in one file <nl> / / and then use everywhere across app <nl> srcPath , <nl> srcCommonPath , <nl> distPath , <nl> rootPath , <nl> - / / base places where server and client both search for modules <nl> - modules : [ ] , <nl> - / / aliases that both server and client use <nl> - alias : { <nl> - actions : ` $ { srcCommonPath } / actions / ` , <nl> - api : ` $ { srcCommonPath } / api / ` , <nl> - components : ` $ { srcCommonPath } / components / ` , <nl> - containers : ` $ { srcCommonPath } / containers / ` , <nl> - reducers : ` $ { srcCommonPath } / reducers / ` , <nl> - routing : ` $ { srcCommonPath } / routing / ` , <nl> - styles : ` $ { srcCommonPath } / styles / ` , <nl> - static : ` $ { rootPath } / static ` , <nl> - images : ` $ { rootPath } / static / images ` <nl> - } , <nl> - / / text for WebpackBannerPlugin , <nl> - / / this plugin just adds text banner to the beginning of your file <nl> + / / text for WebpackBannerPlugin <nl> banner : <nl> ' MIT License . Copyright ( c ) 2017 Vladimir Metnew All Rights Reserved . Repo : https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> / / your manifest . json <nl> - manifest : { <nl> - name : ' React - Semantic . UI - Starter ' , <nl> - short_name : ' RSUIS ' , <nl> - description : ' https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> - icons : [ <nl> - { <nl> - src : ' favicons / android - chrome - 36x36 . png ' , <nl> - sizes : ' 36x36 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 48x48 . png ' , <nl> - sizes : ' 48x48 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 72x72 . png ' , <nl> - sizes : ' 72x72 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 96x96 . png ' , <nl> - sizes : ' 96x96 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 144x144 . png ' , <nl> - sizes : ' 144x144 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 192x192 . png ' , <nl> - sizes : ' 192x192 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 256x256 . png ' , <nl> - sizes : ' 256x256 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 384x384 . png ' , <nl> - sizes : ' 384x384 ' , <nl> - type : ' image / png ' <nl> - } , <nl> - { <nl> - src : ' favicons / android - chrome - 512x512 . png ' , <nl> - sizes : ' 512x512 ' , <nl> - type : ' image / png ' <nl> - } <nl> - ] , <nl> - start_url : ' . ' , <nl> - display : ' standalone ' , <nl> - background_color : ' # f7f7f7 ' , <nl> - theme_color : ' # 009688 ' <nl> - } <nl> + manifest <nl> } <nl> 
mmm a / src / common / routing / index . jsx <nl> ppp b / src / common / routing / index . jsx <nl> import { Users , Dashboard , Login } from ' containers ' <nl> - import { RouteAuth } from ' components / addons ' <nl> + import RouteAuth from ' components / addons / RouteAuth ' <nl> import { createBrowserHistory , createMemoryHistory } from ' history ' <nl> export const history = getHistory ( ) <nl> 
mmm a / src / common / api / utils / xhr_wrapper . js <nl> ppp b / src / common / api / utils / xhr_wrapper . js <nl> - / / feel free to replace with your code <nl> + / / Feel free to replace with your code <nl> / / ( get , post are used in ApiServices ) <nl> - import { getLocalToken , resetLocalToken } from ' api ' <nl> + import { getLocalToken , resetLocalToken } from ' api / LocalStorageCookiesSvc ' <nl> - export default function requestWrapper ( method ) { <nl> + function requestWrapper ( method ) { <nl> return async function ( url , data = null , params = { } ) { <nl> if ( method = = = ' GET ' ) { <nl> - / / Is it a GET ? <nl> + / / It ' s a GET response <nl> / / GET doesn ' t have data <nl> params = data <nl> data = null <nl> @ @ - 27 , 12 + 27 , 16 @ @ export default function requestWrapper ( method ) { <nl> } <nl> / / Check that req url is relative and request was sent to our domain <nl> - if ( url . match ( / ^ https ? : \ / \ / / gi ) > - 1 ) { <nl> + if ( ! / ( http | https ) : \ / \ / / . test ( url ) ) { <nl> + console . log ( ` Request $ { url } was sent to our domain ` ) <nl> const token = getLocalToken ( ) <nl> if ( token ) { <nl> defaults . headers . Authorization = ` JWT $ { token } ` <nl> } <nl> url = process . env . BASE_API + url <nl> + } else { <nl> + console . log ( ` Request $ { url } was sent to external domain ` ) <nl> + / / Request was set to an external domain <nl> } <nl> if ( data ) { <nl> 
mmm a / src / common / reducers / layout / index . js <nl> ppp b / src / common / reducers / layout / index . js <nl> return { isMobileSM , isMobileXS , isMobile } <nl> } <nl> switch ( action . type ) { <nl> - / / FIXME : remove this duplication <nl> - case APPLICATION_INIT : { <nl> - const { isMobile , isMobileSM , isMobileXS } = computeMobileStatuses ( ) <nl> - return { <nl> - . . . state , <nl> - isMobile , <nl> - isMobileSM , <nl> - isMobileXS <nl> - } <nl> - } <nl> + case APPLICATION_INIT : <nl> case UI_WINDOW_RESIZE : { <nl> const { isMobile , isMobileSM , isMobileXS } = computeMobileStatuses ( ) <nl> return { <nl> @ @ - 46 , 17 + 37 , 12 @ @ export function layout ( state = initialState , action ) { <nl> . . . state , <nl> sidebarOpened : true <nl> } <nl> + case LOCATION_CHANGE : <nl> case UI_CLOSE_SIDEBAR : <nl> return { <nl> . . . state , <nl> sidebarOpened : false <nl> } <nl> - case LOCATION_CHANGE : { <nl> - return { <nl> - . . . state , <nl> - sidebarOpened : false <nl> - } <nl> - } <nl> default : <nl> return state <nl> } <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> import webpack from ' webpack ' <nl> import config from ' . . / config ' <nl> import isomorphicWebpackConfig from ' . . / webpack . isomorphic ' <nl> - import child_process from ' child_process ' <nl> + import childProcess from ' child_process ' <nl> import _ from ' lodash ' <nl> + / / import AutoDllPlugin from ' autodll - webpack - plugin ' <nl> import I18nPlugin from ' i18n - webpack - plugin ' <nl> - const exec = child_process . execSync <nl> + const exec = childProcess . execSync <nl> const { <nl> SENTRY_DSN , <nl> DIST_PATH , <nl> @ @ - 39 , 11 + 40 , 13 @ @ fs <nl> } ) <nl> const baseWebpackConfig = { <nl> - entry : [ path . join ( config . srcPath , ' . / server / index ' ) ] , <nl> + name : ' server ' , <nl> + entry : path . join ( config . srcPath , ' . / server ' ) , <nl> target : ' node ' , <nl> output : { <nl> path : path . join ( config . distPath , ' . / server ' , APP_LANGUAGE ) , <nl> - filename : ' index . js ' <nl> + filename : ' server . js ' , <nl> + libraryTarget : ' commonjs2 ' <nl> } , <nl> externals : nodeModules , <nl> performance : { <nl> @ @ - 92 , 6 + 95 , 24 @ @ const baseWebpackConfig = { <nl> ' node - noop ' <nl> ) , <nl> new webpack . DefinePlugin ( definePluginArgs ) <nl> + new AutoDllPlugin ( { <nl> + / / debug : true , <nl> + / / context : config . rootPath , <nl> + / / filename : ' server . js ' , <nl> + / / entry : { <nl> + / / vendor : config . vendor . concat ( [ <nl> + / / ' express ' , <nl> + / / ' helmet ' , <nl> + / / ' cookie - parser ' , <nl> + / / ' body - parser ' , <nl> + / / ' jsonwebtoken ' , <nl> + / / ' morgan ' , <nl> + / / ' compression ' , <nl> + / / ' chalk ' <nl> + / / ] ) , <nl> + / / polyfills : config . polyfills <nl> + / / } <nl> + / / } ) <nl> ] ) , <nl> node : { <nl> __dirname : true , <nl> 
mmm a / jest_config / jest . config . json <nl> ppp b / jest_config / jest . config . json <nl> " setupFiles " : [ " < rootDir > / jest_config / setupJest . js " ] , <nl> " automock " : false , <nl> - " moduleNameMapper " : { <nl> - " ^ actions $ " : " < rootDir > / src / common / actions " , <nl> - " ^ actions / auth $ " : " < rootDir > / src / common / actions / auth " , <nl> - " ^ actions / common $ " : " < rootDir > / src / common / actions / common " , <nl> - " ^ actions / layout $ " : " < rootDir > / src / common / actions / layout " , <nl> - " ^ actions / posts $ " : " < rootDir > / src / common / actions / posts " , <nl> - " ^ actions / users $ " : " < rootDir > / src / common / actions / users " , <nl> - <nl> - " ^ api " : " < rootDir > / src / common / api " , <nl> - <nl> - " ^ reducers $ " : " < rootDir > / src / common / reducers " , <nl> - " ^ reducers / auth $ " : " < rootDir > / src / common / reducers / auth " , <nl> - " ^ reducers / layout $ " : " < rootDir > / src / common / reducers / layout " , <nl> - " ^ reducers / posts $ " : " < rootDir > / src / common / reducers / posts " , <nl> - " ^ reducers / users $ " : " < rootDir > / src / common / reducers / users " , <nl> - <nl> - " ^ routing $ " : " < rootDir > / src / common / routing " , <nl> - " ^ components $ " : " < rootDir > / src / common / components " , <nl> - " ^ containers $ " : " < rootDir > / src / common / containers " <nl> - } <nl> + " moduleNameMapper " : { } <nl> } <nl> 
mmm a / src / common / api / utils / xhr_wrapper . js <nl> ppp b / src / common / api / utils / xhr_wrapper . js <nl> defaults . body = data <nl> } <nl> - const paramsObj = { . . . defaults , headers : { . . . params , . . . defaults . headers } } <nl> + const paramsObj = Object . assign ( { } , defaults , { headers : params } ) <nl> return fetch ( url , paramsObj ) <nl> . then ( checkStatus ) <nl> . then ( parseJSON ) <nl> . catch ( err = > { <nl> console . error ( err ) <nl> + return err <nl> } ) <nl> } <nl> } <nl> 
mmm a / src / server / middlewares / index . js <nl> ppp b / src / server / middlewares / index . js <nl> import path from ' path ' <nl> import authMiddleware from ' . / auth ' <nl> - export default function initGlobalMiddlewares ( ) { <nl> + export default function initGlobalMiddlewares ( app ) { <nl> const { DIST_PATH } = process . env <nl> / / Add express stuff <nl> - this . use ( helmet ( ) ) <nl> - this . use ( compression ( ) ) <nl> - this . use ( morgan ( ' dev ' ) ) <nl> - this . use ( cookieParser ( ) ) <nl> - this . use ( <nl> + app . use ( helmet ( ) ) <nl> + app . use ( compression ( ) ) <nl> + app . use ( morgan ( ' dev ' ) ) <nl> + app . use ( cookieParser ( ) ) <nl> + app . use ( <nl> express . static ( DIST_PATH , { <nl> / / Don ' t use index . html inside / dist dir <nl> index : false <nl> } ) <nl> ) <nl> - this . use ( bodyParser . json ( ) ) <nl> - this . use ( authMiddleware ) <nl> + app . use ( bodyParser . json ( ) ) <nl> + app . use ( authMiddleware ) <nl> } <nl> 
mmm a / src / common / containers / Login / index . jsx <nl> ppp b / src / common / containers / Login / index . jsx <nl> import type { GlobalState } from ' reducers ' <nl> type Props = { <nl> - login : ( ) = > void , <nl> + login : ( data : Object ) = > void , <nl> errors : Object <nl> } <nl> - class Login extends Component { <nl> - props : Props <nl> - render ( ) { <nl> - const { login , errors } = this . props <nl> - const props = { login , errors } <nl> - return < LoginComponent { . . . props } / > <nl> - } <nl> + const Login = ( { login , errors } : Props ) = > { <nl> + return < LoginComponent login = { login } errors = { errors } / > <nl> } <nl> function mapStateToProps ( state : GlobalState ) { <nl> 
mmm a / src / common / containers / Users / components / index . jsx <nl> ppp b / src / common / containers / Users / components / index . jsx <nl> - import React , { PureComponent } from ' react ' <nl> + import React , { Component } from ' react ' <nl> import PropTypes from ' prop - types ' <nl> import { Item , Grid } from ' semantic - ui - react ' <nl> import _ from ' lodash ' <nl> @ @ - 12 , 19 + 12 , 9 @ @ type Props = { <nl> isUsersLoaded : boolean , <nl> usersCount : number <nl> } <nl> - <nl> - class UsersComponent extends PureComponent { <nl> - props : Props <nl> - <nl> - / / ShouldComponentUpdate ( nextProps ) { <nl> - / / const { users } = this . props <nl> - / / const nextUsers = nextProps . users <nl> - / / return ! _ . isEqual ( users , nextUsers ) <nl> - / / } <nl> - <nl> - render ( ) { <nl> + / / < FormattedMessage <nl> + const UsersComponent = ( { users , isUsersLoaded , usersCount } : Props ) = > { <nl> / / IsUsersLoading <nl> - const { users , isUsersLoaded , usersCount } = this . props <nl> const noUsers = isUsersLoaded & & usersCount = = = 0 <nl> return ( <nl> @ @ - 41 , 6 + 31 , 5 @ @ class UsersComponent extends PureComponent { <nl> < / Grid > <nl> ) <nl> } <nl> - } <nl> export default UsersComponent <nl> 
mmm a / src / common / reducers / layout / index . js <nl> ppp b / src / common / reducers / layout / index . js <nl> } <nl> switch ( action . type ) { <nl> case APPLICATION_INIT : <nl> - case UI_WINDOW_RESIZE : { <nl> - const { innerWidth } = action . payload <nl> - const { isMobile , isMobileSM , isMobileXS } = computeMobileStatuses ( <nl> - innerWidth <nl> - ) <nl> + case UI_WINDOW_RESIZE : <nl> return { <nl> . . . state , <nl> - isMobile , <nl> - isMobileSM , <nl> - isMobileXS <nl> - } <nl> + . . . computeMobileStatuses ( action . payload . innerWidth ) <nl> } <nl> case UI_OPEN_SIDEBAR : <nl> return { <nl> 
mmm a / src / common / components / addons / LazyLoad / index . jsx <nl> ppp b / src / common / components / addons / LazyLoad / index . jsx <nl> componentToRender : null <nl> } <nl> - async componentWillMount ( ) { <nl> - const { component } = this . props <nl> - const componentToRender = await component ( ) <nl> + async load ( ) { <nl> + const componentToRender = await this . props . component ( ) <nl> this . setState ( { <nl> componentLoaded : true , <nl> componentToRender : componentToRender . default <nl> } ) <nl> } <nl> + componentWillMount ( ) { <nl> + this . load ( ) <nl> + } <nl> + <nl> render ( ) { <nl> const { componentLoaded } = this . state <nl> @ @ - 41 , 6 + 44 , 8 @ @ class LazyLoad extends Component { <nl> : ' NO ' } ` <nl> ) <nl> + / / console . log ( this . state . componentToRender ) <nl> + <nl> if ( componentLoaded ) { <nl> const props = _ . omit ( this . props , [ ' component ' ] ) <nl> const LoadedComponent = this . state . componentToRender <nl> 
mmm a / src / cli . js <nl> ppp b / src / cli . js <nl> } ) ; <nl> } <nl> - if ( args . nosave ) { <nl> - args . save = false ; <nl> - } else { <nl> - args . save = true ; <nl> - } <nl> - <nl> - if ( args . noprod ) { <nl> - args . production = false ; <nl> - } else { <nl> - args . production = true ; <nl> - } <nl> + args . save = ! args . nosave ; <nl> + args . production = ! args . noprod ; <nl> - if ( args . save = = = undefined ) { <nl> - / / User explicitly did not pass in save <nl> - args . save = conf . get ( ' autosave ' ) ; <nl> - } <nl> if ( args . searchpath = = = undefined ) { <nl> / / User explicitly did not pass in searchpath <nl> args . searchpath = conf . get ( ' searchpath ' ) ; <nl> } <nl> - if ( args . production = = = undefined ) { <nl> - / / User explicitly did not pass in noprod <nl> - args . production = conf . get ( ' production ' ) ; <nl> - } <nl> - <nl> if ( args [ ' save - exact ' ] = = = undefined ) { <nl> / / User explicitly did not pass in save - exact <nl> args [ ' save - exact ' ] = conf . get ( ' save - exact ' ) ; <nl> 
mmm a / src / cli . js <nl> ppp b / src / cli . js <nl> ) ; <nl> } <nl> - / / Resolve tilda <nl> - / / TODO : move to create and use sindresorhus / untildify <nl> - if ( customWww . substr ( 0 , 1 ) = = = ' ~ ' ) { customWww = path . join ( process . env . HOME , customWww . substr ( 1 ) ) ; } <nl> - <nl> / / Template config <nl> cfg . lib = { } ; <nl> cfg . lib . www = { <nl> 
mmm a / examples / pages / template / index . tpl <nl> ppp b / examples / pages / template / index . tpl <nl> < div > <nl> < p > Sponsored by Tipe . io < / p > <nl> - < p > Next Generation Headless CMS < / p > <nl> + < p > Next Generation API - first CMS < / p > <nl> < / div > <nl> < / a > <nl> < div class = " cards " > <nl> 
mmm a / packages / link / src / main . vue <nl> ppp b / packages / link / src / main . vue <nl> @ click = " handleClick " <nl> > <nl> - <nl> < i : class = " icon " v - if = " icon " > < / i > <nl> < span v - if = " $ slots . default " class = " el - link - - inner " > <nl> < slot > < / slot > <nl> < / span > <nl> - < template v - if = " $ slots . icon " > < slot v - if = " $ slots . icon " name = " icon " > < / slot > < / template > <nl> + < slot v - if = " $ slots . icon " name = " icon " > < / slot > <nl> < / a > <nl> < / template > <nl> < script > <nl> - <nl> export default { <nl> - name : ' ElLink ' , <nl> + name : " ElLink " , <nl> props : { <nl> type : { <nl> type : String , <nl> - default : ' default ' <nl> + default : " default " , <nl> } , <nl> underline : { <nl> type : Boolean , <nl> - default : true <nl> + default : true , <nl> } , <nl> disabled : Boolean , <nl> href : String , <nl> - icon : String <nl> + icon : String , <nl> } , <nl> - methods : { <nl> - handleClick ( event ) { <nl> - if ( ! this . disabled ) { <nl> - if ( ! this . href ) { <nl> - this . $ emit ( ' click ' , event ) ; <nl> - } <nl> - } <nl> - } <nl> - } <nl> + setup ( props , { emit } ) { <nl> + const handleClick = ( evt ) = > { <nl> + if ( props . disabled ) return ; <nl> + if ( props . href ) return ; <nl> + <nl> + emit ( " click " , evt ) ; <nl> + } ; <nl> + <nl> + return { <nl> + handleClick , <nl> + } ; <nl> + } , <nl> } ; <nl> < / script > <nl> 
mmm a / packages / alert / src / main . vue <nl> ppp b / packages / alert / src / main . vue <nl> title , <nl> description , <nl> - type , <nl> - closable , <nl> - closeText , <nl> - showIcon , <nl> - center , <nl> - effect <nl> + type <nl> } = toRefs ( props ) <nl> const visible = ref ( true ) <nl> title , <nl> description , <nl> type , <nl> - closable , <nl> - closeText , <nl> - showIcon , <nl> - center , <nl> - effect , <nl> visible , <nl> typeClass , <nl> iconClass , <nl> 
mmm a / packages / tag / src / tag . vue <nl> ppp b / packages / tag / src / tag . vue <nl> < script > <nl> + import { h , computed , getCurrentInstance , Transition } from " vue " ; <nl> export default { <nl> - name : ' ElTag ' , <nl> + name : " ElTag " , <nl> props : { <nl> text : String , <nl> closable : Boolean , <nl> size : String , <nl> effect : { <nl> type : String , <nl> - default : ' light ' , <nl> + default : " light " , <nl> validator ( val ) { <nl> - return [ ' dark ' , ' light ' , ' plain ' ] . indexOf ( val ) ! = = - 1 ; <nl> - } <nl> - } <nl> - } , <nl> - methods : { <nl> - handleClose ( event ) { <nl> - event . stopPropagation ( ) ; <nl> - this . $ emit ( ' close ' , event ) ; <nl> + return [ " dark " , " light " , " plain " ] . indexOf ( val ) ! = = - 1 ; <nl> } , <nl> - handleClick ( event ) { <nl> - this . $ emit ( ' click ' , event ) ; <nl> - } <nl> } , <nl> - computed : { <nl> - tagSize ( ) { <nl> - return this . size | | ( this . $ ELEMENT | | { } ) . size ; <nl> - } <nl> } , <nl> - render ( h ) { <nl> - const { type , tagSize , hit , effect } = this ; <nl> + setup ( props , { emit , slots } ) { <nl> + const { <nl> + type , <nl> + hit , <nl> + effect , <nl> + color , <nl> + closable , <nl> + disableTransitions , <nl> + size , <nl> + } = props ; <nl> + <nl> + const tagSize = computed ( ( ) = > { <nl> + return size | | ( getCurrentInstance ( ) . proxy . $ ELEMENT | | { } ) . size ; <nl> + } ) ; <nl> + const handleClose = ( event ) = > { <nl> + event . stopPropagation ( ) ; <nl> + emit ( " close " , event ) ; <nl> + } ; <nl> + const handleClick = ( event ) = > { <nl> + emit ( " click " , event ) ; <nl> + } ; <nl> + <nl> const classes = [ <nl> - ' el - tag ' , <nl> - type ? ` el - tag - - $ { type } ` : ' ' , <nl> - tagSize ? ` el - tag - - $ { tagSize } ` : ' ' , <nl> - effect ? ` el - tag - - $ { effect } ` : ' ' , <nl> - hit & & ' is - hit ' <nl> + " el - tag " , <nl> + type ? ` el - tag - - $ { type } ` : " " , <nl> + tagSize . value ? ` el - tag - - $ { tagSize . value } ` : " " , <nl> + effect ? ` el - tag - - $ { effect } ` : " " , <nl> + hit & & " is - hit " , <nl> ] ; <nl> const tagEl = ( <nl> < span <nl> class = { classes } <nl> - style = { { backgroundColor : this . color } } <nl> - on - click = { this . handleClick } > <nl> - { this . $ slots . default } <nl> - { <nl> - this . closable & & < i class = " el - tag__close el - icon - close " on - click = { this . handleClose } > < / i > <nl> - } <nl> + style = { { backgroundColor : color } } <nl> + on - click = { handleClick } <nl> + > <nl> + { slots . default & & slots . default ( ) } <nl> + { closable & & ( <nl> + < i class = " el - tag__close el - icon - close " on - click = { handleClose } > < / i > <nl> + ) } <nl> < / span > <nl> ) ; <nl> - <nl> - return this . disableTransitions ? tagEl : < transition name = " el - zoom - in - center " > { tagEl } < / transition > ; <nl> - } <nl> + return ( ) = > <nl> + disableTransitions ? ( <nl> + tagEl <nl> + ) : ( <nl> + < Transition name = " el - zoom - in - center " > { tagEl } < / Transition > <nl> + ) ; <nl> + } , <nl> } ; <nl> < / script > <nl> 
mmm a / packages / input / src / use . js <nl> ppp b / packages / input / src / use . js <nl> + import { computed , getCurrentInstance , inject , ref , unref , nextTick , watch } from ' vue ' <nl> import merge from ' element - ui / src / utils / merge ' <nl> import { isKorean } from ' element - ui / src / utils / shared ' <nl> @ @ - 21 , 7 + 21 , 7 @ @ export const useValidate = ( ) = > { <nl> return { validateState , validateIcon } <nl> } <nl> - export const useTextarea = ( autosize , type , resize , textareaCalcStyle ) = > { <nl> + export const useTextarea = ( { autosize , type , resize , modelValue , validateEvent } , textareaCalcStyle , instance ) = > { <nl> const textarea = ref ( null ) <nl> const textareaStyle = computed ( ( ) = > { <nl> @ @ - 46 , 10 + 46 , 21 @ @ export const useTextarea = ( autosize , type , resize , textareaCalcStyle ) = > { <nl> maxRows <nl> ) <nl> } <nl> + <nl> + watch ( <nl> + ( ) = > modelValue , <nl> + ( val ) = > { <nl> + nextTick ( resizeTextarea ) <nl> + if ( unref ( validateEvent ) ) { <nl> + instance . proxy . dispatch ( ' ElFormItem ' , ' el . form . change ' , [ val ] ) <nl> + } <nl> + } <nl> + ) <nl> + <nl> return { textarea , textareaStyle , resizeTextarea } <nl> } <nl> - export const useInput = ( size , type , disabled , modelValue , readonly , clearable , showPassword , showWordLimit , { hovering , focused } , textarea , attrs ) = > { <nl> + export const useInput = ( { size , type , disabled , modelValue , suffixIcon , readonly , clearable , showPassword , showWordLimit } , { hovering , focused } , textarea , attrs , validateState , needStatusIcon , slots ) = > { <nl> const input = ref ( null ) <nl> const elFormItem = inject ( ' elFormItem ' , { } ) <nl> @ @ - 108 , 7 + 119 , 6 @ @ export const useInput = ( size , type , disabled , modelValue , readonly , clearable , <nl> unref ( nativeInputValue ) & & <nl> ( unref ( focused ) | | unref ( hovering ) ) <nl> ) <nl> - <nl> } ) <nl> const showPwdVisible = computed ( ( ) = > { <nl> return ( <nl> @ @ - 118 , 6 + 128 , 16 @ @ export const useInput = ( size , type , disabled , modelValue , readonly , clearable , <nl> ( ! ! unref ( nativeInputValue ) | | unref ( focused ) ) <nl> ) <nl> } ) <nl> + const getSuffixVisible = ( ) = > { <nl> + return ( <nl> + slots . suffix | | <nl> + unref ( suffixIcon ) | | <nl> + unref ( showClear ) | | <nl> + unref ( showPassword ) | | <nl> + unref ( isWordLimitVisible ) | | <nl> + ( unref ( validateState ) & & unref ( needStatusIcon ) ) <nl> + ) <nl> + } <nl> return { <nl> input : input | | textarea , <nl> @ @ - 129 , 11 + 149 , 12 @ @ export const useInput = ( size , type , disabled , modelValue , readonly , clearable , <nl> upperLimit , <nl> textLength , <nl> showClear , <nl> - showPwdVisible <nl> + showPwdVisible , <nl> + getSuffixVisible <nl> } <nl> } <nl> - export const useInteractive = ( instance , input , nativeInputValue , modelValue , { focused , isComposing , passwordVisible } , validateEvent , emit , slots ) = > { <nl> + export const useInteractive = ( instance , input , { type , modelValue , validateEvent } , { focused , isComposing , passwordVisible } , nativeInputValue , emit , slots ) = > { <nl> const focus = ( ) = > { <nl> unref ( input ) . focus ( ) <nl> @ @ - 250 , 6 + 271 , 13 @ @ export const useInteractive = ( instance , input , nativeInputValue , modelValue , { <nl> calcIconOffset ( ' suffix ' ) <nl> } <nl> + watch ( <nl> + ( ) = > nativeInputValue , <nl> + ( ) = > { <nl> + setNativeInputValue ( ) <nl> + } <nl> + ) <nl> + <nl> return { <nl> focus , <nl> blur , <nl> 
mmm a / packages / carousel / index . js <nl> ppp b / packages / carousel / index . js <nl> + import ElCarousel from ' . / src / main ' <nl> / * istanbul ignore next * / <nl> - Carousel . install = function ( app ) { <nl> - app . component ( Carousel . name , Carousel ) <nl> + ElCarousel . install = function ( app ) { <nl> + app . component ( ElCarousel . name , ElCarousel ) <nl> } <nl> - export default Carousel <nl> + export default ElCarousel <nl> 
mmm a / packages / backtop / src / main . vue <nl> ppp b / packages / backtop / src / main . vue <nl> < script > <nl> + import { ref , toRefs , computed , onMounted , onUnmounted } from ' vue ' ; <nl> import throttle from ' throttle - debounce / throttle ' ; <nl> const cubic = value = > Math . pow ( value , 3 ) ; <nl> @ @ - 31 , 7 + 32 , 10 @ @ export default { <nl> type : Number , <nl> default : 200 <nl> } , <nl> - target : [ String ] , <nl> + target : { <nl> + type : String , <nl> + default : null <nl> + } , <nl> right : { <nl> type : Number , <nl> default : 40 <nl> @ @ - 42 , 69 + 46 , 77 @ @ export default { <nl> } <nl> } , <nl> - data ( ) { <nl> - return { <nl> - el : null , <nl> - container : null , <nl> - visible : false <nl> - } ; <nl> - } , <nl> + setup ( props , { emit } ) { <nl> + const el = ref ( null ) ; <nl> + const container = ref ( null ) ; <nl> + const visible = ref ( null ) ; <nl> + let throttledScrollHandler ; <nl> - computed : { <nl> - styleBottom ( ) { <nl> - return ` $ { this . bottom } px ` ; <nl> - } , <nl> - styleRight ( ) { <nl> - return ` $ { this . right } px ` ; <nl> - } <nl> - } , <nl> + const { <nl> + visibilityHeight , <nl> + target , <nl> + right , <nl> + bottom <nl> + } = toRefs ( props ) ; <nl> - mounted ( ) { <nl> - this . init ( ) ; <nl> - this . throttledScrollHandler = throttle ( 300 , this . onScroll ) ; <nl> - this . container . addEventListener ( ' scroll ' , this . throttledScrollHandler ) ; <nl> - } , <nl> + const styleBottom = computed ( ( ) = > ` $ { bottom . value } px ` ) ; <nl> + const styleRight = computed ( ( ) = > ` $ { right . value } px ` ) ; <nl> - methods : { <nl> - init ( ) { <nl> - this . container = document ; <nl> - this . el = document . documentElement ; <nl> - if ( this . target ) { <nl> - this . el = document . querySelector ( this . target ) ; <nl> - if ( ! this . el ) { <nl> - throw new Error ( ` target is not existed : $ { this . target } ` ) ; <nl> + const init = ( ) = > { <nl> + container . value = document ; <nl> + el . value = document . documentElement ; <nl> + if ( target . value ) { <nl> + el . value = document . querySelector ( target . value ) ; <nl> + if ( ! el . value ) { <nl> + throw new Error ( ` target is not existed : $ { target . value } ` ) ; <nl> } <nl> - this . container = this . el ; <nl> + container . value = el . value ; <nl> } <nl> - } , <nl> - onScroll ( ) { <nl> - const scrollTop = this . el . scrollTop ; <nl> - this . visible = scrollTop > = this . visibilityHeight ; <nl> - } , <nl> - handleClick ( e ) { <nl> - this . scrollToTop ( ) ; <nl> - this . $ emit ( ' click ' , e ) ; <nl> - } , <nl> - scrollToTop ( ) { <nl> - const el = this . el ; <nl> + } <nl> + <nl> + const onScroll = ( ) = > { <nl> + const scrollTop = el . value . scrollTop ; <nl> + visible . value = scrollTop > = visibilityHeight . value ; <nl> + } <nl> + <nl> + const handleClick = ( e ) = > { <nl> + scrollToTop ( ) ; <nl> + emit ( ' click ' , e ) ; <nl> + } <nl> + <nl> + const scrollToTop = ( ) = > { <nl> + const element = el . value ; <nl> const beginTime = Date . now ( ) ; <nl> - const beginValue = el . scrollTop ; <nl> + const beginValue = element . scrollTop ; <nl> const rAF = window . requestAnimationFrame | | ( func = > setTimeout ( func , 16 ) ) ; <nl> const frameFunc = ( ) = > { <nl> const progress = ( Date . now ( ) - beginTime ) / 500 ; <nl> if ( progress < 1 ) { <nl> - el . scrollTop = beginValue * ( 1 - easeInOutCubic ( progress ) ) ; <nl> + element . scrollTop = beginValue * ( 1 - easeInOutCubic ( progress ) ) ; <nl> rAF ( frameFunc ) ; <nl> } else { <nl> - el . scrollTop = 0 ; <nl> + element . scrollTop = 0 ; <nl> + } <nl> } <nl> - } ; <nl> rAF ( frameFunc ) ; <nl> } <nl> - } , <nl> - beforeDestroy ( ) { <nl> - this . container . removeEventListener ( ' scroll ' , this . throttledScrollHandler ) ; <nl> + onMounted ( ( ) = > { <nl> + init ( ) ; <nl> + throttledScrollHandler = throttle ( 300 , onScroll ) ; <nl> + container . value . addEventListener ( ' scroll ' , throttledScrollHandler ) ; <nl> + } ) ; <nl> + <nl> + onUnmounted ( ( ) = > { <nl> + container . value . removeEventListener ( ' scroll ' , throttledScrollHandler ) ; <nl> + } ) ; <nl> + <nl> + return { <nl> + visible , <nl> + styleBottom , <nl> + styleRight , <nl> + handleClick <nl> } <nl> + } , <nl> } ; <nl> < / script > <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> const children = componentInstance . subTree . children <nl> if ( children ) { <nl> children . forEach ( ( vnode ) = > { <nl> - if ( vnode . component . type . name = = = componentName ) { <nl> - vnode . component . emit ( eventName , . . . params ) <nl> + const childComponent = vnode . component <nl> + if ( childComponent . type . name = = = componentName ) { <nl> + childComponent . emit ( eventName , . . . params ) <nl> } else { <nl> - broadcast ( vnode . component ) <nl> + broadcast ( childComponent ) <nl> } <nl> } ) <nl> } <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> + import { capitalize } from ' element - ui / src / utils / util ' <nl> + const EVENT_NAME_KEY = Symbol ( ' ELEMENT_EVENTS ' ) <nl> export function useEmitter ( ) { <nl> return { <nl> dispatch : dispatch ( ) , <nl> broadcast : broadcast ( ) , <nl> - on : on ( ) <nl> + on : on ( ) , <nl> + off : off ( ) <nl> } <nl> } <nl> @ @ - 12 , 12 + 15 , 17 @ @ function on ( ) { <nl> const instance = getCurrentInstance ( ) <nl> return ( originalEventName , callback ) = > { <nl> - const eventName = ' on ' + originalEventName . charAt ( 0 ) . toUpperCase ( ) + originalEventName . slice ( 1 ) <nl> + const eventName = ' on ' + capitalize ( originalEventName ) <nl> if ( ! instance . vnode . props ) { <nl> instance . vnode . props = { } <nl> } <nl> + if ( ! instance . vnode . props [ EVENT_NAME_KEY ] ) { <nl> + instance . vnode . props [ EVENT_NAME_KEY ] = new Set ( ) <nl> + } <nl> + instance . vnode . props [ EVENT_NAME_KEY ] . add ( eventName ) <nl> + <nl> if ( ! instance . vnode . props [ eventName ] ) { <nl> instance . vnode . props [ eventName ] = ( . . . params ) = > { <nl> const callbacks = instance . vnode . props [ eventName ] [ ' __events ' ] <nl> @ @ - 33 , 6 + 41 , 41 @ @ function on ( ) { <nl> } <nl> } <nl> + function off ( ) { <nl> + const instance = getCurrentInstance ( ) <nl> + <nl> + return ( originalEventName , callback ) = > { <nl> + const eventNameList = instance . vnode . props & & instance . vnode . props [ EVENT_NAME_KEY ] <nl> + if ( ! eventNameList | | ! eventNameList . size ) { <nl> + return <nl> + } <nl> + <nl> + if ( ! originalEventName ) { <nl> + eventNameList . forEach ( eventName = > { <nl> + delete instance . vnode . props [ eventName ] <nl> + } ) <nl> + eventNameList . clear ( ) <nl> + return <nl> + } <nl> + <nl> + const eventName = ' on ' + capitalize ( originalEventName ) <nl> + <nl> + if ( ! callback ) { <nl> + delete instance . vnode . props [ eventName ] <nl> + eventNameList . delete ( eventName ) <nl> + return <nl> + } <nl> + <nl> + const handlers = instance . vnode . props [ eventName ] & & instance . vnode . props [ eventName ] [ ' __events ' ] <nl> + if ( handlers & & handlers . length ) { <nl> + const index = handlers . indexOf ( callback ) <nl> + if ( index > - 1 ) { <nl> + handlers . splice ( index , 1 ) <nl> + } <nl> + } <nl> + } <nl> + } <nl> + <nl> function dispatch ( ) { <nl> const instance = getCurrentInstance ( ) <nl> 
mmm a / packages / radio / __tests__ / radio . spec . js <nl> ppp b / packages / radio / __tests__ / radio . spec . js <nl> expect ( radio . value ) . toEqual ( 3 ) <nl> await wrapper . findComponent ( Radio ) . trigger ( ' keydown ' , { keyCode : 37 } ) <nl> expect ( radio . value ) . toEqual ( 3 ) <nl> - } ) ; <nl> + } ) <nl> } ) <nl> } ) <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> children . forEach ( ( vnode ) = > { <nl> const childComponent = vnode . component <nl> - if ( childComponent & & childComponent . type & & childComponent . type . name = = = componentName ) { <nl> + if ( childComponent ? . type ? . name = = = componentName ) { <nl> childComponent . emit ( eventName , . . . params ) <nl> } else { <nl> _broadcast ( childComponent ) <nl> 
mmm a / test / unit / tests / use / component . test . js <nl> ppp b / test / unit / tests / use / component . test . js <nl> it ( ' should get component instance ' , ( ) = > { <nl> const $ cf = jest . fn ( ) <nl> const Comp = { <nl> + template : ' < div > foo < / div > ' , <nl> setup ( ) { <nl> return { <nl> $ cf <nl> @ @ - 13 , 9 + 14 , 10 @ @ describe ( ' component ' , ( ) = > { <nl> } <nl> const instance = createComponent ( Comp ) <nl> - instance . $ cf ( ) <nl> + instance . ctx . $ cf ( ) <nl> expect ( $ cf ) . toBeCalled ( ) <nl> + expect ( instance . ctx . $ el . innerHTML ) . toBe ( ' foo ' ) <nl> } ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / header / Header . vue <nl> ppp b / packages / header / Header . vue <nl> < script > <nl> + import { toRefs } from ' vue ' <nl> + <nl> export default { <nl> name : ' ElHeader ' , <nl> - componentName : ' ElHeader ' , <nl> - <nl> props : { <nl> height : { <nl> type : String , <nl> default : ' 60px ' <nl> } <nl> + } , <nl> + <nl> + setup ( props ) { <nl> + const { height } = toRefs ( props ) <nl> + <nl> + return { height } <nl> } <nl> } <nl> < / script > <nl> 
mmm a / packages / popconfirm / __tests__ / Popconfirm . spec . js <nl> ppp b / packages / popconfirm / __tests__ / Popconfirm . spec . js <nl> } ) <nl> it ( ' Events : confirm event ' , async ( ) = > { <nl> - const wrapper = mount ( Popconfirm , { <nl> - slots : { <nl> - reference : <nl> - ' < el - button class = " reference - slot " > reference slot < / el - button > ' <nl> - } <nl> - } ) <nl> - await wrapper . find ( ' . reference - slot ' ) . trigger ( ' click ' ) <nl> + const wrapper = mount ( Popconfirm ) <nl> const confirmBtn = wrapper . find ( ' . el - popconfirm__action > button : last - child ' ) <nl> await confirmBtn . trigger ( ' click ' ) <nl> expect ( wrapper . emitted ( ' onConfirm ' ) ) . toBeTruthy ( ) <nl> } ) <nl> it ( ' Events : cancel event ' , async ( ) = > { <nl> - const wrapper = mount ( Popconfirm , { <nl> - slots : { <nl> - reference : <nl> - ' < el - button class = " reference - slot " > reference slot < / el - button > ' <nl> - } <nl> - } ) <nl> - await wrapper . find ( ' . reference - slot ' ) . trigger ( ' click ' ) <nl> + const wrapper = mount ( Popconfirm ) <nl> const cancelBtn = wrapper . find ( ' . el - popconfirm__action > button : first - child ' ) <nl> await cancelBtn . trigger ( ' click ' ) <nl> expect ( wrapper . emitted ( ' onCancel ' ) ) . toBeTruthy ( ) <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> - import { capitalize } from ' element - ui / src / utils / util ' <nl> - const EVENT_NAME_KEY = Symbol ( ' ELEMENT_EVENTS ' ) <nl> + import mitt from ' mitt ' <nl> - export function useEmitter ( instance = getCurrentInstance ( ) ) { <nl> - return { <nl> - dispatch : dispatch ( instance ) , <nl> - broadcast : broadcast ( instance ) , <nl> - on : on ( instance ) , <nl> - once : once ( instance ) , <nl> - off : off ( instance ) <nl> - } <nl> - } <nl> - <nl> - function on ( instance ) { <nl> - return ( originalEventName , callback ) = > { <nl> - const eventName = ' on ' + capitalize ( originalEventName ) <nl> + const emitter = mitt ( ) <nl> - if ( ! instance . vnode . props ) { <nl> - instance . vnode . props = { } <nl> - } <nl> - <nl> - if ( ! instance . vnode . props [ EVENT_NAME_KEY ] ) { <nl> - instance . vnode . props [ EVENT_NAME_KEY ] = new Set ( ) <nl> - } <nl> - instance . vnode . props [ EVENT_NAME_KEY ] . add ( eventName ) <nl> + export function useEmitter ( ) { <nl> + const currentComponentInstance = getCurrentInstance ( ) <nl> - if ( ! instance . vnode . props [ eventName ] ) { <nl> - instance . vnode . props [ eventName ] = ( . . . params ) = > { <nl> - const callbacks = instance . vnode . props [ eventName ] . __events <nl> - if ( callbacks ) { <nl> - callbacks . forEach ( ( cf ) = > { <nl> - cf ( . . . params ) <nl> - } ) <nl> - } <nl> - } <nl> - instance . vnode . props [ eventName ] . __events = [ ] <nl> - } <nl> - instance . vnode . props [ eventName ] . __events . push ( callback ) <nl> + function on ( type , handler ) { <nl> + const handleWrapper = ( e ) = > { <nl> + const { value , type , emitComponentInstance } = e <nl> + if ( type = = = ' broadcast ' ) { <nl> + if ( isChildComponent ( currentComponentInstance , emitComponentInstance ) ) { <nl> + handler & & handler ( value ) <nl> } <nl> + } else if ( type = = = ' dispatch ' ) { <nl> + if ( isChildComponent ( emitComponentInstance , currentComponentInstance ) ) { <nl> + handler & & handler ( value ) <nl> } <nl> - function once ( instance ) { <nl> - const $ off = off ( instance ) <nl> - const $ on = on ( instance ) <nl> - return ( originalEventName , handle ) = > { <nl> - const _on = ( . . . params ) = > { <nl> - $ off ( originalEventName , _on ) <nl> - handle ( . . . params ) <nl> - } <nl> - $ on ( originalEventName , _on ) <nl> + } else { <nl> + handler & & handler ( value ) <nl> } <nl> } <nl> - function off ( instance ) { <nl> - return ( originalEventName , callback ) = > { <nl> - const eventNameList = <nl> - instance . vnode . props & & instance . vnode . props [ EVENT_NAME_KEY ] <nl> - if ( ! eventNameList | | ! eventNameList . size ) { <nl> - return <nl> + / / Save the real handler because the need to call off <nl> + handler . wrapper = handleWrapper <nl> + emitter . on ( type , handleWrapper ) <nl> } <nl> - if ( ! originalEventName ) { <nl> - eventNameList . forEach ( ( eventName ) = > { <nl> - delete instance . vnode . props [ eventName ] <nl> + function broadcast ( type , evt ) { <nl> + emitter . emit ( type , { <nl> + type : ' broadcast ' , <nl> + emitComponentInstance : currentComponentInstance , <nl> + value : evt <nl> } ) <nl> - eventNameList . clear ( ) <nl> - return <nl> } <nl> - const eventName = ' on ' + capitalize ( originalEventName ) <nl> - <nl> - if ( ! callback ) { <nl> - delete instance . vnode . props [ eventName ] <nl> - eventNameList . delete ( eventName ) <nl> - return <nl> + function dispatch ( type , evt ) { <nl> + emitter . emit ( type , { <nl> + type : ' dispatch ' , <nl> + emitComponentInstance : currentComponentInstance , <nl> + value : evt <nl> + } ) <nl> } <nl> - const handlers = <nl> - instance . vnode . props [ eventName ] & & <nl> - instance . vnode . props [ eventName ] . __events <nl> - if ( handlers & & handlers . length ) { <nl> - const index = handlers . indexOf ( callback ) <nl> - if ( index > - 1 ) { <nl> - handlers . splice ( index , 1 ) <nl> - } <nl> - } <nl> - } <nl> + function off ( type , handler ) { <nl> + emitter . off ( type , handler . wrapper ) <nl> } <nl> - function dispatch ( instance ) { <nl> - return ( componentName , eventName , . . . params ) = > { <nl> - let parent = instance . parent <nl> - while ( parent & & parent . type . name ! = = componentName ) { <nl> - parent = parent . parent <nl> + function emit ( type , evt ) { <nl> + emitter . emit ( type , { <nl> + value : evt <nl> + } ) <nl> } <nl> - if ( parent ) { <nl> - parent . emit ( eventName , . . . params ) <nl> - } <nl> + return { <nl> + on , <nl> + broadcast , <nl> + dispatch , <nl> + off , <nl> + emit <nl> } <nl> } <nl> - function broadcast ( instance ) { <nl> - return ( componentName , eventName , . . . params ) = > { <nl> - const _broadcast = ( componentInstance ) = > { <nl> - if ( ! componentInstance ) return <nl> + / * * <nl> + * check componentChild is componentParent child components <nl> + * @ param { * } componentChild <nl> + * @ param { * } componentParent <nl> + * / <nl> + function isChildComponent ( componentChild , componentParent ) { <nl> + const parentUId = componentParent . uid <nl> - const children = componentInstance . subTree . children <nl> - if ( children ) { <nl> - children . forEach ( ( vnode ) = > { <nl> - const childComponent = vnode . component <nl> - <nl> - if ( childComponent ? . type ? . name = = = componentName ) { <nl> - childComponent . emit ( eventName , . . . params ) <nl> - } else { <nl> - _broadcast ( childComponent ) <nl> - } <nl> - } ) <nl> - } <nl> + while ( componentChild & & componentChild ? . parent ? . uid ! = = parentUId ) { <nl> + componentChild = componentChild . parent <nl> } <nl> - _broadcast ( instance ) <nl> - } <nl> + return Boolean ( componentChild ) <nl> } <nl> 
mmm a / src / use / emitter . js <nl> ppp b / src / use / emitter . js <nl> import mitt from ' mitt ' <nl> + const DISPATCH = ' dispatch ' <nl> + const BROADCAST = ' broadcast ' <nl> + <nl> + const wrapper = Symbol ( ' wrapper ' ) <nl> + <nl> const emitter = mitt ( ) <nl> export function useEmitter ( ) { <nl> @ @ - 9 , 11 + 14 , 11 @ @ export function useEmitter ( ) { <nl> function on ( type , handler ) { <nl> const handleWrapper = ( e ) = > { <nl> const { value , type , emitComponentInstance } = e <nl> - if ( type = = = ' broadcast ' ) { <nl> + if ( type = = = BROADCAST ) { <nl> if ( isChildComponent ( currentComponentInstance , emitComponentInstance ) ) { <nl> handler & & handler ( value ) <nl> } <nl> - } else if ( type = = = ' dispatch ' ) { <nl> + } else if ( type = = = DISPATCH ) { <nl> if ( isChildComponent ( emitComponentInstance , currentComponentInstance ) ) { <nl> handler & & handler ( value ) <nl> } <nl> @ @ - 23 , 13 + 28 , 13 @ @ export function useEmitter ( ) { <nl> } <nl> / / Save the real handler because the need to call off <nl> - handler . wrapper = handleWrapper <nl> + handler [ wrapper ] = handleWrapper <nl> emitter . on ( type , handleWrapper ) <nl> } <nl> function broadcast ( type , evt ) { <nl> emitter . emit ( type , { <nl> - type : ' broadcast ' , <nl> + type : BROADCAST , <nl> emitComponentInstance : currentComponentInstance , <nl> value : evt <nl> } ) <nl> @ @ - 37 , 14 + 42 , 14 @ @ export function useEmitter ( ) { <nl> function dispatch ( type , evt ) { <nl> emitter . emit ( type , { <nl> - type : ' dispatch ' , <nl> + type : DISPATCH , <nl> emitComponentInstance : currentComponentInstance , <nl> value : evt <nl> } ) <nl> } <nl> function off ( type , handler ) { <nl> - emitter . off ( type , handler . wrapper ) <nl> + emitter . off ( type , handler [ wrapper ] ) <nl> } <nl> function emit ( type , evt ) { <nl> 
mmm a / packages / collapse / src / collapse - item . vue <nl> ppp b / packages / collapse / src / collapse - item . vue <nl> < / template > <nl> < script > <nl> + import { computed , getCurrentInstance , inject , reactive , toRefs } from ' vue ' <nl> import ElCollapseTransition from ' element - ui / src / transitions / collapse - transition ' <nl> - import Emitter from ' element - ui / src / mixins / emitter ' <nl> import { generateId } from ' element - ui / src / utils / util ' <nl> + import { useEmitter } from ' element - ui / src / use / emitter ' <nl> + <nl> export default { <nl> name : ' ElCollapseItem ' , <nl> componentName : ' ElCollapseItem ' , <nl> - mixins : [ Emitter ] , <nl> - <nl> components : { ElCollapseTransition } , <nl> - data ( ) { <nl> - return { <nl> - contentWrapStyle : { <nl> - height : ' auto ' , <nl> - display : ' block ' <nl> - } , <nl> - contentHeight : 0 , <nl> - focusing : false , <nl> - isClick : false , <nl> - id : generateId ( ) <nl> - } <nl> - } , <nl> - <nl> - inject : [ ' collapse ' ] , <nl> - <nl> props : { <nl> title : String , <nl> name : { <nl> type : [ String , Number ] , <nl> default ( ) { <nl> - return this . _uid <nl> + return ' ' <nl> } <nl> } , <nl> disabled : Boolean <nl> } , <nl> - computed : { <nl> - isActive ( ) { <nl> - return this . collapse . activeNames . indexOf ( this . name ) > - 1 <nl> - } <nl> + setup ( props ) { <nl> + const state = reactive ( { <nl> + contentWrapStyle : { <nl> + height : ' auto ' , <nl> + display : ' block ' <nl> } , <nl> + contentHeight : 0 , <nl> + focusing : false , <nl> + isClick : false , <nl> + id : generateId ( ) <nl> + } ) <nl> + <nl> + const instance = getCurrentInstance ( ) <nl> + const collapse = inject ( ' collapse ' ) <nl> + <nl> + const { dispatch } = useEmitter ( ) <nl> + const isActive = computed ( ( ) = > { <nl> + const name = props . name | | props . name = = = 0 ? props . name : instance . uid <nl> + return collapse . ctx . activeNames . indexOf ( name ) > - 1 <nl> + } ) <nl> - methods : { <nl> - handleFocus ( ) { <nl> + function handleFocus ( ) { <nl> setTimeout ( ( ) = > { <nl> - if ( ! this . isClick ) { <nl> - this . focusing = true <nl> + if ( ! state . isClick ) { <nl> + state . focusing = true <nl> } else { <nl> - this . isClick = false <nl> + state . isClick = false <nl> } <nl> } , 50 ) <nl> - } , <nl> - handleHeaderClick ( ) { <nl> - if ( this . disabled ) return <nl> - this . dispatch ( ' item - click ' , this ) <nl> - this . focusing = false <nl> - this . isClick = true <nl> - } , <nl> - handleEnterClick ( ) { <nl> - this . dispatch ( ' item - click ' , this ) <nl> + } <nl> + <nl> + function handleHeaderClick ( ) { <nl> + if ( props . disabled ) return <nl> + const name = props . name | | props . name = = = 0 ? props . name : instance . uid <nl> + dispatch ( ' item - click ' , { name } ) <nl> + state . focusing = false <nl> + state . isClick = true <nl> + } <nl> + <nl> + function handleEnterClick ( ) { <nl> + const name = props . name | | props . name = = = 0 ? props . name : instance . uid <nl> + dispatch ( ' item - click ' , { name } ) <nl> + } <nl> + return { <nl> + . . . toRefs ( state ) , <nl> + isActive , <nl> + handleFocus , <nl> + handleHeaderClick , <nl> + handleEnterClick <nl> } <nl> } <nl> } <nl> 
mmm a / packages / menu / Menu . vue <nl> ppp b / packages / menu / Menu . vue <nl> import { computed , getCurrentInstance , onMounted , provide , ref , toRefs , watch , h , Transition } from ' vue ' ; <nl> import { useEmitter } from ' element - ui / src / use / emitter ' ; <nl> import { useItems } from " . / src / menu - use " ; <nl> - import { Submenu } from ' . . / . . / types ' ; <nl> export default { <nl> name : ' ElMenu ' , <nl> componentName : ' ElMenu ' , <nl> 
mmm a / packages / pagination / index . js <nl> ppp b / packages / pagination / index . js <nl> + import ElPagination from ' . / Pagination ' <nl> / * istanbul ignore next * / <nl> - Pagination . install = function ( app ) { <nl> - app . component ( Pagination . name , Pagination ) <nl> + ElPagination . install = function ( app ) { <nl> + app . component ( ElPagination . name , ElPagination ) <nl> } <nl> - export default Pagination <nl> + export default ElPagination <nl> 
mmm a / packages / avatar / index . js <nl> ppp b / packages / avatar / index . js <nl> + import ElAvatar from ' . / Avatar . vue ' <nl> / * istanbul ignore next * / <nl> - Avatar . install = function ( app ) { <nl> - app . component ( Avatar . name , Avatar ) <nl> + ElAvatar . install = function ( app ) { <nl> + app . component ( ElAvatar . name , ElAvatar ) <nl> } <nl> - export default Avatar <nl> + export default ElAvatar <nl> 
mmm a / packages / badge / index . js <nl> ppp b / packages / badge / index . js <nl> + import ElBadge from ' . / Badge . vue ' <nl> / * istanbul ignore next * / <nl> - Badge . install = function ( app ) { <nl> - app . component ( Badge . name , Badge ) <nl> + ElBadge . install = function ( app ) { <nl> + app . component ( ElBadge . name , ElBadge ) <nl> } <nl> - export default Badge <nl> + export default ElBadge <nl> 
mmm a / packages / tab - pane / index . js <nl> ppp b / packages / tab - pane / index . js <nl> + import ElTabPane from ' . / TabPane ' <nl> / * istanbul ignore next * / <nl> - TabPane . install = function ( app ) { <nl> - app . component ( TabPane . name , TabPane ) <nl> + ElTabPane . install = function ( app ) { <nl> + app . component ( ElTabPane . name , ElTabPane ) <nl> } <nl> - export default TabPane <nl> + export default ElTabPane <nl> 
mmm a / packages / dialog / Dialog . vue <nl> ppp b / packages / dialog / Dialog . vue <nl> < script > <nl> - import { popupProps , usePopup } from ' element - ui / src / use / popup ' <nl> - import { useEmitter } from ' element - ui / src / use / emitter ' <nl> + import { popupProps , usePopup } from ' . . / . . / src / use / popup ' <nl> + import { useEmitter } from ' . . / . . / src / use / emitter ' <nl> import { <nl> toRefs , <nl> ref , <nl> 
mmm a / packages / tooltip / index . js <nl> ppp b / packages / tooltip / index . js <nl> + import ElTooltip from ' . / Tooltip ' <nl> / * istanbul ignore next * / <nl> - Tooltip . install = function ( app ) { <nl> - app . component ( Tooltip . name , Tooltip ) <nl> + ElTooltip . install = function ( app ) { <nl> + app . component ( ElTooltip . name , ElTooltip ) <nl> } <nl> - export default Tooltip <nl> + export default ElTooltip <nl> 
mmm a / packages / card / index . js <nl> ppp b / packages / card / index . js <nl> + import ElCard from ' . / Card ' <nl> / * istanbul ignore next * / <nl> - Card . install = function ( app ) { <nl> - app . component ( Card . name , Card ) <nl> + ElCard . install = function ( app ) { <nl> + app . component ( ElCard . name , ElCard ) <nl> } <nl> - export default Card <nl> + export default ElCard <nl> 
mmm a / packages / carousel / Carousel . vue <nl> ppp b / packages / carousel / Carousel . vue <nl> onUnmounted <nl> } from ' vue ' <nl> import { throttle } from ' throttle - debounce ' <nl> - import { useResizeEvent } from ' element - ui / src / utils / resize - event ' <nl> + import { useResizeEvent } from ' . . / . . / src / utils / resize - event ' <nl> export default { <nl> name : ' ElCarousel ' , <nl> 
mmm a / packages / cascader / Cascader . vue <nl> ppp b / packages / cascader / Cascader . vue <nl> import { <nl> addResizeListener , <nl> removeResizeListener <nl> - } from ' element - ui / src / utils / resize - event ' <nl> + } from ' . . / . . / src / utils / resize - event ' <nl> import { debounce } from ' throttle - debounce ' <nl> const { keys : KeyCode } = AriaUtils <nl> 
mmm a / packages / infinite - scroll / src / main . js <nl> ppp b / packages / infinite - scroll / src / main . js <nl> - import { <nl> - isHtmlElement , <nl> - isFunction , <nl> - isDefined <nl> - } from ' element - ui / src / utils / types ' <nl> - import { getScrollContainer } from ' element - ui / src / utils / dom ' <nl> + import { isHtmlElement , isFunction , isDefined } from ' . . / . . / . . / src / utils / types ' <nl> + import { getScrollContainer } from ' . . / . . / . . / src / utils / dom ' <nl> const getStyleComputedProperty = ( element , property ) = > { <nl> if ( element = = = window ) { <nl> 
mmm a / src / utils / date - util . js <nl> ppp b / src / utils / date - util . js <nl> - import { t } from ' element - ui / src / locale ' <nl> + import fecha from ' . . / . . / src / utils / date ' <nl> + import { t } from ' . . / . . / src / locale ' <nl> const weeks = [ ' sun ' , ' mon ' , ' tue ' , ' wed ' , ' thu ' , ' fri ' , ' sat ' ] <nl> const months = [ <nl> 
mmm a / examples / docs / zh - CN / upload . md <nl> ppp b / examples / docs / zh - CN / upload . md <nl> ` ` ` html <nl> < el - upload <nl> - action = " # " <nl> + action = " https : / / jsonplaceholder . typicode . com / posts / " <nl> list - type = " picture - card " <nl> + ref = " uploadRef " <nl> : auto - upload = " false " > <nl> - < template v - slot : default > <nl> + < template # default > <nl> < i class = " el - icon - plus " > < / i > <nl> < / template > <nl> - < template v - slot : file = " { file } " > <nl> - < img <nl> - class = " el - upload - list__item - thumbnail " <nl> - : src = " file . url " alt = " " <nl> - > <nl> + < template # file = " { file } " > <nl> + < img class = " el - upload - list__item - thumbnail " : src = " file . url " alt = " " > <nl> < span class = " el - upload - list__item - actions " > <nl> - < span <nl> - class = " el - upload - list__item - preview " <nl> - @ click = " handlePictureCardPreview ( file ) " <nl> - > <nl> + < span class = " el - upload - list__item - preview " @ click = " handlePictureCardPreview ( file ) " > <nl> < i class = " el - icon - zoom - in " > < / i > <nl> < / span > <nl> - < span <nl> - v - if = " ! disabled " <nl> - class = " el - upload - list__item - delete " <nl> - @ click = " handleDownload ( file ) " <nl> - > <nl> + < span class = " el - upload - list__item - delete " @ click = " handleDownload ( file ) " > <nl> < i class = " el - icon - download " > < / i > <nl> < / span > <nl> - < span <nl> - v - if = " ! disabled " <nl> - class = " el - upload - list__item - delete " <nl> - @ click = " handleRemove ( file ) " <nl> - > <nl> + < span class = " el - upload - list__item - delete " @ click = " handleRemove ( file ) " > <nl> < i class = " el - icon - delete " > < / i > <nl> < / span > <nl> < / span > <nl> - <nl> < / template > <nl> < / el - upload > <nl> - < el - dialog : visible . sync = " dialogVisible " > <nl> - < img width = " 100 % " : src = " dialogImageUrl " alt = " " > <nl> + < el - dialog : visible . sync = " dialogVisible " v - model : visible = " dialogVisible " > <nl> + < img width = " 100 % " : src = " dialogImageUrl " style = " width : 100 % " > <nl> < / el - dialog > <nl> < script > <nl> - import { ref , getCurrentInstance } from ' vue ' ; <nl> + import { ref , unref } from ' vue ' <nl> + <nl> export default { <nl> setup ( ) { <nl> - const dialogImageUrl = ref ( ' ' ) ; <nl> - const dialogVisible = ref ( false ) ; <nl> - const disables = ref ( false ) ; <nl> + const dialogImageUrl = ref ( ' ' ) <nl> + const dialogVisible = ref ( false ) <nl> + const uploadRef = ref ( null ) <nl> - const self = getCurrentInstance ( ) . ctx ; <nl> const handleRemove = ( file ) = > { <nl> - console . log ( file ) ; <nl> + console . log ( ' remove ' ) <nl> + uploadRef . value . handleRemove ( file ) <nl> } <nl> + <nl> const handlePictureCardPreview = ( file ) = > { <nl> - self . dialogImageUrl = file . url ; <nl> - self . dialogVisible = true ; <nl> + dialogImageUrl . value = unref ( file ) . url <nl> + dialogVisible . value = true <nl> } <nl> + <nl> const handleDownload = ( file ) = > { <nl> - console . log ( file ) ; <nl> + console . log ( ' DownLoad ' ) <nl> } <nl> return { <nl> dialogImageUrl , <nl> dialogVisible , <nl> - disables , <nl> + uploadRef , <nl> handleRemove , <nl> handlePictureCardPreview , <nl> handleDownload <nl> 
mmm a / packages / button / Button . vue <nl> ppp b / packages / button / Button . vue <nl> < script > <nl> - import { toRefs , inject , computed , getCurrentInstance } from ' vue ' <nl> + import { useGlobalOptions } from ' . . / . . / src / use / globalConfig ' <nl> + import { toRefs , inject , computed } from ' vue ' <nl> export default { <nl> name : ' ElButton ' , <nl> props : { <nl> @ @ - 89 , 13 + 90 , 10 @ @ const useButtonDisabled = ( disabled ) = > { <nl> } <nl> const useButtonSize = ( size ) = > { <nl> + const globalConfig = useGlobalOptions ( ) <nl> return computed ( ( ) = > { <nl> const elFormItem = inject ( ' elFormItem ' , { } ) <nl> - return ( <nl> - size ? . value | | <nl> - elFormItem . elFormItemSize | | <nl> - getCurrentInstance ( ) . ctx . $ ELEMENT ? . size <nl> - ) <nl> + return size ? . value | | elFormItem . elFormItemSize | | globalConfig . size <nl> } ) <nl> } <nl> < / script > <nl> 
mmm a / packages / message / __tests__ / Message . spec . js <nl> ppp b / packages / message / __tests__ / Message . spec . js <nl> import { nextTick } from ' vue ' <nl> import Utils from ' main / utils / aria - utils ' <nl> - import Message from ' . . / index . js ' <nl> + import MessageInfo from ' . . / index . js ' <nl> + const Message = MessageInfo . service <nl> jest . useFakeTimers ( ) <nl> 
mmm a / packages / divider / Divider . vue <nl> ppp b / packages / divider / Divider . vue <nl> type : String , <nl> default : ' horizontal ' , <nl> validator ( val ) { <nl> - return [ ' horizontal ' , ' vertical ' ] . indexOf ( val ) ! = = - 1 <nl> + return [ ' horizontal ' , ' vertical ' ] . includes ( val ) <nl> } <nl> } , <nl> contentPosition : { <nl> type : String , <nl> default : ' center ' , <nl> validator ( val ) { <nl> - return [ ' left ' , ' center ' , ' right ' ] . indexOf ( val ) ! = = - 1 <nl> + return [ ' left ' , ' center ' , ' right ' ] . includes ( val ) <nl> } <nl> } <nl> } <nl> 
mmm a / packages / button / Button . vue <nl> ppp b / packages / button / Button . vue <nl> size : { <nl> type : String , <nl> validator ( val ) { <nl> - if ( val = = = ' ' ) return true <nl> - return [ ' medium ' , ' small ' , ' mini ' ] . indexOf ( val ) ! = = - 1 <nl> + return [ ' medium ' , ' small ' , ' mini ' , ' ' ] . includes ( val ) <nl> } <nl> } , <nl> type : { <nl> type : String , <nl> validator ( val ) { <nl> - return ( <nl> - [ ' primary ' , ' success ' , ' warning ' , ' danger ' , ' info ' , ' text ' ] . indexOf ( <nl> - val <nl> - ) ! = = - 1 <nl> - ) <nl> + return [ <nl> + ' primary ' , <nl> + ' success ' , <nl> + ' warning ' , <nl> + ' danger ' , <nl> + ' info ' , <nl> + ' text ' <nl> + ] . includes ( val ) <nl> } <nl> } , <nl> nativeType : { <nl> 
mmm a / packages / tag / Tag . vue <nl> ppp b / packages / tag / Tag . vue <nl> emits : [ ' close ' , ' click ' ] , <nl> setup ( props , { emit } ) { <nl> const $ ELEMENT = useGlobalOptions ( ) <nl> + <nl> const { type , hit , size , effect } = toRefs ( props ) <nl> + <nl> const tagSize = computed ( ( ) = > { <nl> return size ? . value | | $ ELEMENT . size <nl> } ) <nl> @ @ - 58 , 13 + 60 , 12 @ @ export default { <nl> ` el - tag - - $ { effect . value } ` , <nl> hit . value & & ' is - hit ' <nl> ] ) <nl> + <nl> const { show , handleClose } = useShow ( emit ) <nl> + <nl> return { <nl> - / / data <nl> show , <nl> - / / computed <nl> classes , <nl> - / / methods <nl> handleClose <nl> } <nl> } , <nl> 
mmm a / packages / avatar / Avatar . vue <nl> ppp b / packages / avatar / Avatar . vue <nl> setup ( props ) { <nl> const { size , shape , icon , error } = toRefs ( props ) <nl> - const style = useStyle ( props ) <nl> + const style = useStyle ( size ) <nl> const isShow = ref ( true ) <nl> 
mmm a / packages / element3 / packages / button / Button . vue <nl> ppp b / packages / element3 / packages / button / Button . vue <nl> import { useGlobalOptions } from ' . . / . . / src / use / globalConfig ' <nl> - import { toRefs , inject , computed } from ' vue ' <nl> - export default { <nl> + import { toRefs , inject , computed , defineComponent } from ' vue ' <nl> + export default defineComponent ( { <nl> name : ' ElButton ' , <nl> props : { <nl> size : { <nl> @ @ - 65 , 7 + 65 , 7 @ @ export default { <nl> classes <nl> } <nl> } <nl> - } <nl> + } ) <nl> const useClasses = ( { props , size , disabled } ) = > { <nl> return computed ( ( ) = > { <nl> 
mmm a / packages / element3 / packages / radio - button / RadioButton . vue <nl> ppp b / packages / element3 / packages / radio - button / RadioButton . vue <nl> < span <nl> class = " el - radio - button__inner " <nl> - : style = " style " <nl> + : style = " isChecked ? style : null " <nl> @ keydown . stop <nl> > <nl> < slot > { { label } } < / slot > <nl> @ @ - 75 , 7 + 75 , 7 @ @ export default { <nl> tabIndex , <nl> classes , <nl> isChecked , <nl> - style : isChecked ? style : null <nl> + style <nl> } <nl> } <nl> } <nl> 
mmm a / packages / element3 / scripts / generateCssFile . js <nl> ppp b / packages / element3 / scripts / generateCssFile . js <nl> const path = require ( ' path ' ) <nl> const blacklist = [ ' icon ' , ' option ' , ' option - group ' , ' theme - chalk ' ] <nl> - const componentPath = path . resolve ( __dirname , ' . . / packages ' ) <nl> - const themePath = path . resolve ( componentPath , ' theme - chalk / src ' ) <nl> + const componentPaths = [ <nl> + path . resolve ( __dirname , ' . . / packages ' ) , <nl> + path . resolve ( __dirname , ' . . / src / components ' ) <nl> + ] <nl> + const themePath = path . resolve ( __dirname , ' . . / packages ' , ' theme - chalk / src ' ) <nl> const fileSuffix = ' . scss ' <nl> const indexFileName = ' index ' + fileSuffix <nl> const outputIndexFilePath = path . resolve ( themePath , indexFileName ) <nl> ; ( function main ( ) { <nl> - save ( genCssCode ( ) ) <nl> + save ( genCssCode ( getAllComponentName ( ) ) ) <nl> } ) ( ) <nl> - function genCssCode ( ) { <nl> - var indexContent = ' @ import " . / base . scss " ; \ n ' <nl> - return getComponentNameList ( ) . reduce ( ( context , filePath ) = > { <nl> - return ( context + = ' @ import " . / ' + filePath + ' " ; \ n ' ) <nl> - } , indexContent ) <nl> + function getAllComponentName ( ) { <nl> + return componentPaths <nl> + . map ( ( componentPath ) = > { <nl> + return getComponentNameList ( componentPath ) <nl> + } ) <nl> + . reduce ( ( total , components ) = > { <nl> + return [ . . . total , . . . components ] <nl> + } ) <nl> } <nl> - function getComponentNameList ( ) { <nl> + function getComponentNameList ( componentPath ) { <nl> return fs <nl> . readdirSync ( componentPath ) <nl> . filter ( ( name ) = > { <nl> @ @ - 29 , 6 + 35 , 14 @ @ function getComponentNameList ( ) { <nl> } ) <nl> } <nl> + function genCssCode ( componentNameList ) { <nl> + var indexContent = ' @ import " . / base . scss " ; \ n ' <nl> + <nl> + return componentNameList . reduce ( ( context , filePath ) = > { <nl> + return ( context + = ' @ import " . / ' + filePath + ' " ; \ n ' ) <nl> + } , indexContent ) <nl> + } <nl> + <nl> function save ( cssCode ) { <nl> fs . writeFileSync ( outputIndexFilePath , cssCode ) <nl> } <nl> 
mmm a / packages / element3 / src / components / Input / src / use . js <nl> ppp b / packages / element3 / src / components / Input / src / use . js <nl> classes . push ( ' is - disabled ' ) <nl> } <nl> - if ( inputExceed ) { <nl> + if ( inputExceed . value ) { <nl> classes . push ( ' is - exceed ' ) <nl> } <nl> 
mmm a / packages / element3 / src / components / Input / src / use . js <nl> ppp b / packages / element3 / src / components / Input / src / use . js <nl> export const useClass = ( inputSize , inputExceed , props , attrs , slots ) = > { <nl> return computed ( ( ) = > { <nl> const classes = [ <nl> - inputSize . value ? ' el - input - - ' + inputSize . value : ' el - input ' , <nl> + inputSize . value ? ' el - input - - ' + inputSize . value : ' ' , <nl> props . type = = = ' textarea ' ? ' el - textarea ' : ' el - input ' <nl> ] <nl> 
mmm a / packages / element3 / packages / upload / src / upload - list . vue <nl> ppp b / packages / element3 / packages / upload / src / upload - list . vue <nl> < script > <nl> import Locale from ' . . / . . / . . / src / mixins / locale ' <nl> - import ElProgress from ' . . / . . / progress ' <nl> + import { ElProgress } from ' . / components / Progress ' <nl> import { ref } from ' vue ' <nl> export default { <nl> 
mmm a / packages / element3 / packages / upload / src / upload - list . vue <nl> ppp b / packages / element3 / packages / upload / src / upload - list . vue <nl> < script > <nl> import Locale from ' . . / . . / . . / src / mixins / locale ' <nl> - import { ElProgress } from ' . / components / Progress ' <nl> + import { ElProgress } from ' . . / . . / . . / src / components / Progress ' <nl> import { ref } from ' vue ' <nl> export default { <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> defineJQueryPlugin , <nl> emulateTransitionEnd , <nl> - getElementFromSelector , <nl> - getTransitionDurationFromElement <nl> + getTransitionDurationFromElement , <nl> + reflow , <nl> + typeCheckConfig <nl> } from ' . / util / index ' <nl> import Data from ' . / dom / data ' <nl> import EventHandler from ' . / dom / event - handler ' <nl> + import Manipulator from ' . / dom / manipulator ' <nl> import BaseComponent from ' . / base - component ' <nl> / * * <nl> @ @ - 76 , 7 + 78 , 7 @ @ const SELECTOR_SIDEBAR = ' . c - sidebar ' <nl> * / <nl> class Sidebar extends BaseComponent { <nl> constructor ( element , config ) { <nl> - this . _element = element <nl> + super ( element ) <nl> this . _config = this . _getConfig ( config ) <nl> this . _open = this . _isVisible ( ) <nl> this . _mobile = this . _isMobile ( ) <nl> @ @ - 92 , 10 + 94 , 6 @ @ class Sidebar extends BaseComponent { <nl> / / Getters <nl> - static get VERSION ( ) { <nl> - return VERSION <nl> - } <nl> - <nl> static get Default ( ) { <nl> return Default <nl> } <nl> @ @ - 112 , 14 + 110 , 14 @ @ class Sidebar extends BaseComponent { <nl> if ( this . _isMobile ( ) ) { <nl> this . _addClassName ( this . _firstBreakpointClassName ( ) ) <nl> this . _showBackdrop ( ) <nl> - EventHandler . one ( this . _element , TRANSITION_END , ( ) = > { <nl> + EventHandler . one ( this . _element , ' transitionend ' , ( ) = > { <nl> this . _addClickOutListener ( ) <nl> } ) <nl> } else if ( breakpoint ) { <nl> this . _addClassName ( this . _getBreakpointClassName ( breakpoint ) ) <nl> if ( this . _isOverlaid ( ) ) { <nl> - EventHandler . one ( this . _element , TRANSITION_END , ( ) = > { <nl> + EventHandler . one ( this . _element , ' transitionend ' , ( ) = > { <nl> this . _addClickOutListener ( ) <nl> } ) <nl> } <nl> @ @ - 127 , 7 + 125 , 7 @ @ class Sidebar extends BaseComponent { <nl> this . _addClassName ( this . _firstBreakpointClassName ( ) ) <nl> if ( this . _isOverlaid ( ) ) { <nl> - EventHandler . one ( this . _element , TRANSITION_END , ( ) = > { <nl> + EventHandler . one ( this . _element , ' transitionend ' , ( ) = > { <nl> this . _addClickOutListener ( ) <nl> } ) <nl> } <nl> @ @ - 142 , 7 + 140 , 7 @ @ class Sidebar extends BaseComponent { <nl> const transitionDuration = getTransitionDurationFromElement ( this . _element ) <nl> - EventHandler . one ( this . _element , TRANSITION_END , complete ) <nl> + EventHandler . one ( this . _element , ' transitionend ' , complete ) <nl> emulateTransitionEnd ( this . _element , transitionDuration ) <nl> } <nl> @ @ - 174 , 7 + 172 , 7 @ @ class Sidebar extends BaseComponent { <nl> const transitionDuration = getTransitionDurationFromElement ( this . _element ) <nl> - EventHandler . one ( this . _element , TRANSITION_END , complete ) <nl> + EventHandler . one ( this . _element , ' transitionend ' , complete ) <nl> emulateTransitionEnd ( this . _element , transitionDuration ) <nl> } <nl> @ @ - 352 , 7 + 350 , 7 @ @ class Sidebar extends BaseComponent { <nl> return siblings <nl> } <nl> - _toggleDropdown ( event , sidebar ) { <nl> + _toggleDropdown ( event ) { <nl> let toggler = event . target <nl> if ( ! toggler . classList . contains ( CLASS_NAME_NAV_DROPDOWN_TOGGLE ) ) { <nl> toggler = toggler . closest ( SELECTOR_NAV_DROPDOWN_TOGGLE ) <nl> 
mmm a / scss / _avatar . scss <nl> ppp b / scss / _avatar . scss <nl> align - items : center ; <nl> justify - content : center ; <nl> - border - radius : 50em ; <nl> + vertical - align : middle ; <nl> + @ include border - radius ( 50em ) ; <nl> @ include avatar ( $ avatar - width , $ avatar - status - width ) ; <nl> } <nl> . avatar - img { <nl> width : 100 % ; <nl> height : auto ; <nl> - border - radius : 50em ; <nl> + @ include border - radius ( 50em ) ; <nl> } <nl> . avatar - status { <nl> bottom : 0 ; <nl> display : block ; <nl> border : 1px solid $ white ; <nl> - border - radius : 50em ; <nl> + @ include border - radius ( 50em ) ; <nl> / / @ include ltr { <nl> / / right : 0 ; <nl> margin - right : - ( $ avatar - xl - width / 2 ) ; <nl> } <nl> } <nl> - <nl> - . avatar - rounded { <nl> - border - radius : $ border - radius ; <nl> - } <nl> - <nl> - . avatar - square { <nl> - border - radius : 0 ; <nl> - } <nl> 
mmm a / scss / _header . scss <nl> ppp b / scss / _header . scss <nl> . header - divider { <nl> - / / stylelint - disable - next - line function - disallowed - list <nl> - flex - basis : calc ( 100 % + # { 2 * $ header - padding - x } ) ; <nl> + flex - basis : calc ( 100 % + # { 2 * $ header - padding - x } ) ; / / stylelint - disable - line function - disallowed - list <nl> height : 0 ; <nl> margin : $ header - padding - y ( - $ header - padding - x ) ; <nl> border - top : var ( - - # { $ variable - prefix } header - divider - border - width , $ header - divider - border - width ) solid var ( - - # { $ variable - prefix } header - divider - border - color , $ header - divider - border - color ) ; <nl> } <nl> / / Opinionated : add " hand " cursor to non - disabled . navbar - toggler elements <nl> - & : not ( : disabled ) : not ( . c - disabled ) { <nl> + & : not ( : disabled ) { <nl> cursor : pointer ; <nl> } <nl> } <nl> 
mmm a / scss / _icon . scss <nl> ppp b / scss / _icon . scss <nl> + . icon { <nl> display : inline - block ; <nl> color : inherit ; <nl> text - align : center ; <nl> + vertical - align : - . 125rem ; / / Fix the position of icon <nl> fill : currentColor ; <nl> - & : not ( . c - icon - c - s ) : not ( . c - icon - custom - size ) { <nl> + & : not ( . icon - c - s ) : not ( . icon - custom - size ) { <nl> @ include icon - size ( $ icon - size - base ) ; <nl> / / TODO : create variable with a range <nl> @ for $ i from 2 through 9 { <nl> - & . c - icon - # { $ i } xl { <nl> + & . icon - # { $ i } xl { <nl> @ include icon - size ( $ i * ( $ icon - size - xl / 1 . 5 ) ) ; <nl> } <nl> } <nl> - & . c - icon - xl { <nl> + & . icon - xl { <nl> @ include icon - size ( $ icon - size - xl ) ; <nl> } <nl> - & . c - icon - lg { <nl> + & . icon - lg { <nl> @ include icon - size ( $ icon - size - lg ) ; <nl> } <nl> - & . c - icon - sm { <nl> + & . icon - sm { <nl> @ include icon - size ( $ icon - size - sm ) ; <nl> } <nl> } <nl> 
mmm a / scss / _tables . scss <nl> ppp b / scss / _tables . scss <nl> > : not ( : last - child ) > : last - child > * { <nl> - border - bottom - color : $ table - group - separator - color ; <nl> + / / border - bottom - color : $ table - group - separator - color ; <nl> } <nl> } <nl> 
mmm a / site / layouts / shortcodes / css - vars - docs . html <nl> ppp b / site / layouts / shortcodes / css - vars - docs . html <nl> - Usage : ` scss - docs name = " name " file = " file / _location . scss " ` <nl> + Usage : ` css - vars - docs file = " file / _location . scss " ` <nl> - Prints everything between ` / / scss - docs - start " name " ` and ` / / scss - docs - end " name " ` <nl> - comments in the docs . <nl> - <nl> - Optional parameters : <nl> - strip - default : Remove the ` ! default ` flag from variable assignments - default : ` true ` <nl> + Find all CSS Variables and print them in the docs . <nl> * / - } } <nl> - { { - $ name : = . Get " name " - } } <nl> { { - $ file : = . Get " file " - } } <nl> { { - $ strip_default : = . Get " strip - default " | default " true " - } } <nl> - { { - $ start : = printf " / / scss - docs - start % s \ n " $ name - } } <nl> - { { - $ end : = printf " \ n / / scss - docs - end % s " $ name - } } <nl> - { { - $ regex : = printf " % s ( . | \ n ) * % s " $ start $ end - } } <nl> - <nl> - { { - $ regex2 : = printf " ( - - # { \ \ $ variable - prefix } [ ^ , ] * ) " - } } <nl> + { { - $ regex : = printf " ( - - # { \ \ $ variable - prefix } [ ^ , | ) | : ] * ) " - } } <nl> { { - $ css : = readFile $ file - } } <nl> - { { - $ match : = ( findRE $ regex2 $ css ) | uniq | sort - } } <nl> + { { - $ match : = ( findRE $ regex $ css ) | uniq | sort - } } <nl> { { - if ( eq ( len $ match ) 0 ) - } } <nl> - { { - errorf " Got no matches for % q in % q ! ( called in % q ) " $ name $ file $ . Page . Path - } } <nl> + { { - errorf " Got no matches for % q in % q ! ( called in % q ) " $ file $ . Page . Path - } } <nl> { { - end - } } <nl> - { { - $ remove_start : = replace ( index $ match 0 ) $ start " " - } } <nl> { { - $ result : = delimit $ match " \ n " - } } <nl> { { - if ( ne $ strip_default " false " ) - } } <nl> 
mmm a / scss / _buttons . scss <nl> ppp b / scss / _buttons . scss <nl> @ each $ state , $ map in $ button - variants { <nl> - $ background : var ( - - # { $ variable - prefix } btn - # { $ state } - background , map - get ( $ map , " background " ) ) ; <nl> - $ border : var ( - - # { $ variable - prefix } btn - # { $ state } - border - color , map - get ( $ map , " border " ) ) ; <nl> - $ color : var ( - - # { $ variable - prefix } btn - # { $ state } - color , map - get ( $ map , " color " ) ) ; <nl> - $ hover - background : var ( - - # { $ variable - prefix } btn - # { $ state } - hover - background , map - get ( $ map , " hover - background " ) ) ; <nl> - $ hover - border : var ( - - # { $ variable - prefix } btn - # { $ state } - hover - border , map - get ( $ map , " hover - border " ) ) ; <nl> - $ hover - color : var ( - - # { $ variable - prefix } btn - # { $ state } - hover - color , map - get ( $ map , " hover - color " ) ) ; <nl> - $ active - background : var ( - - # { $ variable - prefix } btn - # { $ state } - active - background , map - get ( $ map , " active - background " ) ) ; <nl> - $ active - border : var ( - - # { $ variable - prefix } btn - # { $ state } - active - border , map - get ( $ map , " active - border " ) ) ; <nl> - $ active - color : var ( - - # { $ variable - prefix } btn - # { $ state } - active - color , map - get ( $ map , " active - color " ) ) ; <nl> - $ disabled - background : var ( - - # { $ variable - prefix } btn - # { $ state } - disabled - background , map - get ( $ map , " disabled - background " ) ) ; <nl> - $ disabled - border : var ( - - # { $ variable - prefix } btn - # { $ state } - disabled - border , map - get ( $ map , " disabled - border " ) ) ; <nl> - $ disabled - color : var ( - - # { $ variable - prefix } btn - # { $ state } - disabled - color , map - get ( $ map , " disabled - color " ) ) ; <nl> - $ shadow : var ( - - # { $ variable - prefix } btn - # { $ state } - shadow , map - get ( $ map , " shadow " ) ) ; <nl> - <nl> . btn - # { $ state } { <nl> @ include button - variant ( <nl> - $ background , <nl> - $ border , <nl> - $ color , <nl> - $ hover - background , <nl> - $ hover - border , <nl> - $ hover - color , <nl> - $ active - background , <nl> - $ active - border , <nl> - $ active - color , <nl> - $ disabled - background , <nl> - $ disabled - border , <nl> - $ disabled - color , <nl> - $ shadow <nl> + $ background : var ( - - # { $ variable - prefix } btn - # { $ state } - background , map - get ( $ map , " background " ) ) , <nl> + $ border : var ( - - # { $ variable - prefix } btn - # { $ state } - border - color , map - get ( $ map , " border " ) ) , <nl> + $ color : var ( - - # { $ variable - prefix } btn - # { $ state } - color , map - get ( $ map , " color " ) ) , <nl> + $ hover - background : var ( - - # { $ variable - prefix } btn - # { $ state } - hover - background , map - get ( $ map , " hover - background " ) ) , <nl> + $ hover - border : var ( - - # { $ variable - prefix } btn - # { $ state } - hover - border , map - get ( $ map , " hover - border " ) ) , <nl> + $ hover - color : var ( - - # { $ variable - prefix } btn - # { $ state } - hover - color , map - get ( $ map , " hover - color " ) ) , <nl> + $ active - background : var ( - - # { $ variable - prefix } btn - # { $ state } - active - background , map - get ( $ map , " active - background " ) ) , <nl> + $ active - border : var ( - - # { $ variable - prefix } btn - # { $ state } - active - border , map - get ( $ map , " active - border " ) ) , <nl> + $ active - color : var ( - - # { $ variable - prefix } btn - # { $ state } - active - color , map - get ( $ map , " active - color " ) ) , <nl> + $ disabled - background : var ( - - # { $ variable - prefix } btn - # { $ state } - disabled - background , map - get ( $ map , " disabled - background " ) ) , <nl> + $ disabled - border : var ( - - # { $ variable - prefix } btn - # { $ state } - disabled - border , map - get ( $ map , " disabled - border " ) ) , <nl> + $ disabled - color : var ( - - # { $ variable - prefix } btn - # { $ state } - disabled - color , map - get ( $ map , " disabled - color " ) ) , <nl> + $ shadow : var ( - - # { $ variable - prefix } btn - # { $ state } - shadow , map - get ( $ map , " shadow " ) ) <nl> ) ; <nl> } <nl> } <nl> / / scss - docs - start button - outline - modifiers <nl> @ each $ state , $ map in $ button - variants { <nl> - $ color : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - color , map - get ( $ map , " background " ) ) ; <nl> - $ color - hover : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - hover - color , map - get ( $ map , " color " ) ) ; <nl> - $ active - background : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - active - background , map - get ( $ map , " background " ) ) ; <nl> - $ active - border : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - active - border , map - get ( $ map , " background " ) ) ; <nl> - $ active - color : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - active - color , map - get ( $ map , " active - color " ) ) ; <nl> - $ shadow : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - shadow , map - get ( $ map , " shadow " ) ) ; <nl> - <nl> . btn - outline - # { $ state } { <nl> @ include button - outline - variant ( <nl> - $ color , <nl> - $ color - hover , <nl> - $ active - background , <nl> - $ active - border , <nl> - $ active - color , <nl> - $ shadow <nl> + $ color : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - color , map - get ( $ map , " background " ) ) , <nl> + $ color - hover : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - hover - color , map - get ( $ map , " color " ) ) , <nl> + $ active - background : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - active - background , map - get ( $ map , " background " ) ) , <nl> + $ active - border : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - active - border , map - get ( $ map , " background " ) ) , <nl> + $ active - color : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - active - color , map - get ( $ map , " active - color " ) ) , <nl> + $ shadow : var ( - - # { $ variable - prefix } btn - outline - # { $ state } - shadow , map - get ( $ map , " shadow " ) ) <nl> ) ; <nl> } <nl> } <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> / / Header <nl> / / scss - docs - start header - variables <nl> - $ header - min - height : 56px ! default ; <nl> + $ header - min - height : 4rem ! default ; <nl> $ header - padding - y : $ spacer / 2 ! default ; <nl> $ header - padding - x : $ spacer / 2 ! default ; <nl> $ header - brand - font - size : $ font - size - lg ! default ; <nl> @ @ - 1405 , 7 + 1405 , 7 @ @ $ header - divider - border - color : $ header - border - color ! default ; <nl> / / Subheader <nl> / / scss - docs - start subheader - variables <nl> - $ subheader - min - height : 48px ! default ; <nl> + $ subheader - min - height : 3rem ! default ; <nl> $ subheader - padding - y : $ spacer / 2 ! default ; <nl> $ subheader - padding - x : $ spacer ! default ; <nl> $ subheader - border - color : $ border - color ! default ; <nl> @ @ - 1491 , 11 + 1491 , 11 @ @ $ carousel - dark - control - icon - filter : invert ( 1 ) grayscale ( 100 ) ! default ; <nl> / / scss - docs - end carousel - variables <nl> / / scss - docs - start sidebar - variables <nl> - $ sidebar - width : 256px ! default ; <nl> + $ sidebar - width : 16rem ! default ; <nl> $ sidebar - widths : ( <nl> - sm : 192px , <nl> - lg : 320px , <nl> - xl : 384px <nl> + sm : 12rem , <nl> + lg : 20rem , <nl> + xl : 24rem <nl> ) ! default ; <nl> $ sidebar - padding - y : 0 ! default ; <nl> $ sidebar - padding - x : 0 ! default ; <nl> @ @ - 1503 , 7 + 1503 , 7 @ @ $ sidebar - color : $ high - emphasis - light ! default ; <nl> $ sidebar - bg : $ gray - base ! default ; <nl> $ sidebar - border - width : 0 ! default ; <nl> $ sidebar - border - color : transparent ! default ; <nl> - $ sidebar - transition : box - shadow . 075s , transform . 15s , margin - left . 15s , margin - right . 15s , width . 15s , z - index 0s ease . 15s ! default ; <nl> + $ sidebar - transition : margin - left . 15s , margin - right . 15s , box - shadow . 075s , transform . 15s , width . 15s , z - index 0s ease . 15s ! default ; <nl> $ sidebar - reliant - transition : margin . 15s ! default ; <nl> $ sidebar - brand - height : 56px ! default ; <nl> @ @ - 1550 , 6 + 1550 , 7 @ @ $ sidebar - nav - icon - font - size : $ sidebar - nav - icon - height ! default ; <nl> $ sidebar - nav - group - bg : rgba ( 0 , 0 , 0 , . 2 ) ! default ; <nl> $ sidebar - nav - group - transition : background . 15s ease - in - out ! default ; <nl> $ sidebar - nav - group - items - transition : height . 15s ease ! default ; <nl> + $ sidebar - nav - group - toggle - show - color : $ sidebar - nav - link - color ! default ; <nl> $ sidebar - nav - group - indicator - color : $ medium - emphasis - light ! default ; <nl> $ sidebar - nav - group - indicator : str - replace ( url ( " data : image / svg + xml ; charset = utf8 , % 3Csvg xmlns = ' http : / / www . w3 . org / 2000 / svg ' viewBox = ' 0 0 11 14 ' % 3E % 3Cpath fill = ' # { $ sidebar - nav - group - indicator - color } ' d = ' M9 . 148 2 . 352l - 4 . 148 4 . 148 4 . 148 4 . 148q0 . 148 0 . 148 0 . 148 0 . 352t - 0 . 148 0 . 352l - 1 . 297 1 . 297q - 0 . 148 0 . 148 - 0 . 352 0 . 148t - 0 . 352 - 0 . 148l - 5 . 797 - 5 . 797q - 0 . 148 - 0 . 148 - 0 . 148 - 0 . 352t0 . 148 - 0 . 352l5 . 797 - 5 . 797q0 . 148 - 0 . 148 0 . 352 - 0 . 148t0 . 352 0 . 148l1 . 297 1 . 297q0 . 148 0 . 148 0 . 148 0 . 352t - 0 . 148 0 . 352z ' / % 3E % 3C / svg % 3E " ) , " # " , " % 23 " ) ! default ; <nl> @ @ - 1575 , 7 + 1576 , 7 @ @ $ sidebar - toggler - hover - indicator : str - replace ( url ( " data : image / svg + xml ; c <nl> / / Footer <nl> / / scss - docs - start footer - variables <nl> - $ footer - min - height : 50px ! default ; <nl> + $ footer - min - height : 3rem ! default ; <nl> $ footer - padding - y : $ spacer / 2 ! default ; <nl> $ footer - padding - x : $ spacer ! default ; <nl> $ footer - bg : $ gray - 100 ! default ; <nl> 
mmm a / scss / _avatar . scss <nl> ppp b / scss / _avatar . scss <nl> . avatar { <nl> - margin - right : - ( $ avatar - width / 2 ) ; <nl> + margin - right : - ( $ avatar - width / 2 . 5 ) ; <nl> & : hover { <nl> margin - right : 0 ; <nl> @ each $ width , $ value in $ avatar - widths { <nl> . avatar - # { $ width } { <nl> - margin - right : - ( $ value / 2 ) ; <nl> + margin - right : - ( $ value / 2 . 5 ) ; <nl> } <nl> } <nl> } <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> const EVENT_CLICK_DATA_API = ` click $ { EVENT_KEY } $ { DATA_API_KEY } ` <nl> const EVENT_LOAD_DATA_API = ` load $ { EVENT_KEY } $ { DATA_API_KEY } ` <nl> + const SELECTOR_DATA_CLOSE = ' [ data - coreui - close = " sidebar " ] ' <nl> const SELECTOR_SIDEBAR = ' . sidebar ' <nl> const SELECTOR_SIDEBAR_TOGGLER = ' . sidebar - toggler ' <nl> @ @ - 342 , 6 + 343 , 11 @ @ class Sidebar extends BaseComponent { <nl> this . toggleUnfoldable ( ) <nl> } <nl> } ) <nl> + <nl> + EventHandler . on ( this . _element , EVENT_CLICK_DATA_API , SELECTOR_DATA_CLOSE , event = > { <nl> + event . preventDefault ( ) <nl> + this . hide ( ) <nl> + } ) <nl> } <nl> / / Static <nl> 
mmm a / scss / _header . scss <nl> ppp b / scss / _header . scss <nl> } <nl> + . container : nth - child ( 1n + 2 ) , <nl> + . container - fluid : nth - child ( 1n + 2 ) { <nl> + min - height : $ subheader - min - height - ( 2 * $ header - padding - y ) ; <nl> + } <nl> + <nl> & . header - sticky { <nl> position : sticky ; <nl> top : 0 ; <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> / / Static <nl> - static _sidebarInterface ( element , config ) { <nl> + static sidebarInterface ( element , config ) { <nl> let data = Data . getData ( element , DATA_KEY ) <nl> const _config = typeof config = = = ' object ' & & config <nl> @ @ - 371 , 7 + 371 , 7 @ @ class Sidebar extends BaseComponent { <nl> static jQueryInterface ( config ) { <nl> return this . each ( function ( ) { <nl> - Sidebar . _sidebarInterface ( this , config ) <nl> + Sidebar . sidebarInterface ( this , config ) <nl> } ) <nl> } <nl> } <nl> @ @ - 385 , 7 + 385 , 7 @ @ class Sidebar extends BaseComponent { <nl> EventHandler . on ( window , EVENT_LOAD_DATA_API , ( ) = > { <nl> / / eslint - disable - next - line unicorn / prefer - spread <nl> Array . from ( document . querySelectorAll ( SELECTOR_SIDEBAR ) ) . forEach ( element = > { <nl> - Sidebar . _sidebarInterface ( element ) <nl> + Sidebar . sidebarInterface ( element ) <nl> } ) <nl> } ) <nl> 
mmm a / scss / _tables . scss <nl> ppp b / scss / _tables . scss <nl> . table { <nl> + - - # { $ variable - prefix } table - color : # { $ table - color } ; <nl> - - # { $ variable - prefix } table - bg : # { $ table - bg } ; <nl> + - - # { $ variable - prefix } table - border - color : # { $ table - border - color } ; <nl> - - # { $ variable - prefix } table - striped - color : # { $ table - striped - color } ; <nl> - - # { $ variable - prefix } table - striped - bg : # { $ table - striped - bg } ; <nl> - - # { $ variable - prefix } table - active - color : # { $ table - active - color } ; <nl> width : 100 % ; <nl> margin - bottom : $ spacer ; <nl> - color : $ table - color ; <nl> + color : var ( - - # { $ variable - prefix } table - color ) ; <nl> vertical - align : $ table - cell - vertical - align ; <nl> - border - color : $ table - border - color ; <nl> + border - color : var ( - - # { $ variable - prefix } table - border - color ) ; <nl> / / Target th & td <nl> / / We need the child combinator to prevent styles leaking to nested tables which doesn ' t have a ` . table ` class . <nl> 
mmm a / scss / _alert . scss <nl> ppp b / scss / _alert . scss <nl> @ each $ state , $ map in $ alert - variants { <nl> - $ background : var ( - - # { $ variable - prefix } alert - bg , map - get ( $ map , " background " ) ) ; <nl> + $ background : var ( - - # { $ variable - prefix } alert - background , map - get ( $ map , " background " ) ) ; <nl> $ border : var ( - - # { $ variable - prefix } alert - border - color , map - get ( $ map , " border " ) ) ; <nl> $ color : var ( - - # { $ variable - prefix } alert - color , contrast - ratio - correction ( map - get ( $ map , " color " ) , map - get ( $ map , " background " ) , abs ( $ alert - color - scale ) , $ state ) ) ; <nl> $ link - color : var ( - - # { $ variable - prefix } alert - link - color , map - get ( $ map , " link - color " ) ) ; <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> ) ! default ; <nl> / / scss - docs - end colors - map <nl> + / / fusv - disable <nl> $ primary - dark : # 1f1498 ! default ; <nl> $ primary : # 321fdb ! default ; <nl> $ primary - 50 : # 988fed ! default ; <nl> @ @ - 114 , 6 + 115 , 7 @ @ $ dark - dark : $ gray - 900 ! default ; <nl> $ dark : $ gray - 900 ! default ; <nl> $ dark - 50 : shift - color ( $ dark , - 70 ) ! default ; <nl> $ dark - 25 : shift - color ( $ dark , - 80 ) ! default ; <nl> + / / fusv - enable <nl> / / scss - docs - start theme - color - variables <nl> $ primary : $ blue ! default ; <nl> @ @ - 279 , 7 + 281 , 7 @ @ $ enable - important - utilities : true ! default ; <nl> $ enable - contrast - ratio - correction : true ! default ; <nl> $ enable - contrast - ratio - warnings : true ! default ; <nl> $ enable - ltr : true ! default ; <nl> - $ enable - rtl : true ! default ; <nl> + $ enable - rtl : false ! default ; <nl> / / Set mobile breakpoint <nl> 
mmm a / scss / _progress . scss <nl> ppp b / scss / _progress . scss <nl> . progress - group - icon { <nl> - margin : 0 $ spacer 0 ( $ spacer * . 25 ) ; <nl> font - size : $ font - size - lg ; <nl> - <nl> - / / @ include ltr { <nl> - / / margin : 0 $ spacer 0 ( $ spacer * . 25 ) ; <nl> - / / } <nl> - / / @ include rtl { <nl> - / / margin : 0 ( $ spacer * . 25 ) 0 $ spacer ; <nl> - / / } <nl> - } <nl> - <nl> - . progress - group - text { <nl> - font - size : $ font - size - sm ; <nl> - color : $ gray - 700 ; <nl> } <nl> . progress - group - header { <nl> 
mmm a / scss / mixins / _utilities . scss <nl> ppp b / scss / mixins / _utilities . scss <nl> } <nl> - / / Use class prefix if present <nl> - $ property - class - prefix : if ( map - has - key ( $ utility , prefix ) , map - get ( $ utility , prefix ) , null ) ; <nl> - $ property - class - prefix : if ( $ property - class - prefix = = null , " " , $ property - class - prefix ) ; <nl> - <nl> / / Use custom class if present <nl> $ property - class : if ( map - has - key ( $ utility , class ) , map - get ( $ utility , class ) , nth ( $ properties , 1 ) ) ; <nl> $ property - class : if ( $ property - class = = null , " " , $ property - class ) ; <nl> / / Don ' t prefix if value key is null ( eg . with shadow class ) <nl> $ property - class - modifier : if ( $ key , if ( $ property - class = = " " and $ infix = = " " , " " , " - " ) + $ key , " " ) ; <nl> - / / Generate also CSS Variable <nl> + / / Generate CSS Variable <nl> $ generate - vars : if ( map - has - key ( $ utility , vars ) , map - get ( $ utility , vars ) , false ) ; <nl> $ generate - only - vars : if ( map - has - key ( $ utility , only - vars ) , map - get ( $ utility , only - vars ) , false ) ; <nl> / / Generate RTL version <nl> $ generate - rtl : if ( map - has - key ( $ utility , rtl ) , map - get ( $ utility , rtl ) , false ) ; <nl> + / / / / Add theme prefix <nl> + / / $ theme - prefix : if ( map - has - key ( $ utility , theme - prefix ) , map - get ( $ utility , theme - prefix ) , false ) ; <nl> + <nl> @ if map - get ( $ utility , rfs ) { <nl> / / Inside the media query <nl> @ if $ is - rfs - media - query { <nl> @ if $ is - rtl = = false { <nl> / * rtl : begin : remove * / <nl> } <nl> - . # { $ property - class - prefix + $ property - class + $ infix + $ property - class - modifier } { <nl> + <nl> + . # { $ property - class + $ infix + $ property - class - modifier } { <nl> @ each $ property in $ properties { <nl> @ if $ generate - vars = = true or $ generate - only - vars = = true { <nl> @ if $ generate - only - vars { <nl> 
mmm a / js / src / dropdown . js <nl> ppp b / js / src / dropdown . js <nl> } <nl> } <nl> + _selectMenuItem ( event ) { <nl> + const items = SelectorEngine . find ( SELECTOR_VISIBLE_ITEMS , this . _menu ) . filter ( isVisible ) <nl> + <nl> + if ( ! items . length ) { <nl> + return <nl> + } <nl> + <nl> + let index = items . indexOf ( event . target ) <nl> + <nl> + / / Up <nl> + if ( event . key = = = ARROW_UP_KEY & & index > 0 ) { <nl> + index - - <nl> + } <nl> + <nl> + / / Down <nl> + if ( event . key = = = ARROW_DOWN_KEY & & index < items . length - 1 ) { <nl> + index + + <nl> + } <nl> + <nl> + / / index is - 1 if the first keydown is an ArrowUp <nl> + index = index = = = - 1 ? 0 : index <nl> + <nl> + items [ index ] . focus ( ) <nl> + } <nl> + <nl> / / Static <nl> static dropdownInterface ( element , config ) { <nl> @ @ - 449 , 31 + 474 , 6 @ @ class Dropdown extends BaseComponent { <nl> } <nl> } <nl> - static selectMenuItem ( parent , event ) { <nl> - const items = SelectorEngine . find ( SELECTOR_VISIBLE_ITEMS , parent ) . filter ( isVisible ) <nl> - <nl> - if ( ! items . length ) { <nl> - return <nl> - } <nl> - <nl> - let index = items . indexOf ( event . target ) <nl> - <nl> - / / Up <nl> - if ( event . key = = = ARROW_UP_KEY & & index > 0 ) { <nl> - index - - <nl> - } <nl> - <nl> - / / Down <nl> - if ( event . key = = = ARROW_DOWN_KEY & & index < items . length - 1 ) { <nl> - index + + <nl> - } <nl> - <nl> - / / index is - 1 if the first keydown is an ArrowUp <nl> - index = index = = = - 1 ? 0 : index <nl> - <nl> - items [ index ] . focus ( ) <nl> - } <nl> - <nl> static getParentFromElement ( element ) { <nl> return getElementFromSelector ( element ) | | element . parentNode <nl> } <nl> @ @ - 525 , 7 + 525 , 7 @ @ class Dropdown extends BaseComponent { <nl> return <nl> } <nl> - Dropdown . selectMenuItem ( Dropdown . getParentFromElement ( this ) , event ) <nl> + Dropdown . getInstance ( getToggleButton ( ) ) . _selectMenuItem ( event ) <nl> } <nl> } <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> const CLASS_NAME_BACKDROP = ' sidebar - backdrop ' <nl> const CLASS_NAME_FADE = ' fade ' <nl> - const CLASS_NAME_HIDE = ' hide ' <nl> + / / const CLASS_NAME_HIDE = ' hide ' <nl> const CLASS_NAME_SHOW = ' show ' <nl> const CLASS_NAME_SIDEBAR = ' sidebar ' <nl> const CLASS_NAME_SIDEBAR_NARROW = ' sidebar - narrow ' <nl> @ @ - 96 , 9 + 96 , 9 @ @ class Sidebar extends BaseComponent { <nl> show ( ) { <nl> EventHandler . trigger ( this . _element , EVENT_SHOW ) <nl> - if ( this . _element . classList . contains ( CLASS_NAME_HIDE ) ) { <nl> - this . _element . classList . remove ( CLASS_NAME_HIDE ) <nl> - } <nl> + / / if ( this . _element . classList . contains ( CLASS_NAME_HIDE ) ) { <nl> + / / this . _element . classList . remove ( CLASS_NAME_HIDE ) <nl> + / / } <nl> if ( REGEXP_SIDEBAR_SELF_HIDING . test ( this . _element . className ) ) { <nl> this . _element . classList . add ( CLASS_NAME_SHOW ) <nl> @ @ - 132 , 7 + 132 , 7 @ @ class Sidebar extends BaseComponent { <nl> this . _element . classList . remove ( CLASS_NAME_SHOW ) <nl> } <nl> - this . _element . classList . add ( CLASS_NAME_HIDE ) <nl> + / / this . _element . classList . add ( CLASS_NAME_HIDE ) <nl> if ( this . _isMobile ( ) ) { <nl> this . _removeBackdrop ( ) <nl> 
mmm a / scss / mixins / _color - scheme . scss <nl> ppp b / scss / mixins / _color - scheme . scss <nl> @ mixin color - scheme ( $ name ) { <nl> - @ if $ name = = dark { <nl> - @ media ( prefers - color - scheme : dark ) { <nl> - @ content ; <nl> - } <nl> - } @ else if $ name = = light { <nl> - @ media ( prefers - color - scheme : light ) { <nl> - @ content ; <nl> - } <nl> - } @ else { <nl> @ media ( prefers - color - scheme : # { $ name } ) { <nl> @ content ; <nl> } <nl> } <nl> - } <nl> / / scss - docs - end mixin - color - scheme <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> const CLASS_NAME_BACKDROP = ' sidebar - backdrop ' <nl> const CLASS_NAME_FADE = ' fade ' <nl> - / / const CLASS_NAME_HIDE = ' hide ' <nl> const CLASS_NAME_SHOW = ' show ' <nl> const CLASS_NAME_SIDEBAR = ' sidebar ' <nl> const CLASS_NAME_SIDEBAR_NARROW = ' sidebar - narrow ' <nl> @ @ - 69 , 7 + 68 , 6 @ @ class Sidebar extends BaseComponent { <nl> constructor ( element , config ) { <nl> super ( element ) <nl> this . _config = this . _getConfig ( config ) <nl> - / / this . _breakpoint = this . _getBreakpoint ( ) <nl> this . _show = this . _isVisible ( ) <nl> this . _mobile = this . _isMobile ( ) <nl> this . _overlaid = this . _isOverlaid ( ) <nl> @ @ - 96 , 10 + 94 , 6 @ @ class Sidebar extends BaseComponent { <nl> show ( ) { <nl> EventHandler . trigger ( this . _element , EVENT_SHOW ) <nl> - / / if ( this . _element . classList . contains ( CLASS_NAME_HIDE ) ) { <nl> - / / this . _element . classList . remove ( CLASS_NAME_HIDE ) <nl> - / / } <nl> - <nl> if ( REGEXP_SIDEBAR_SELF_HIDING . test ( this . _element . className ) ) { <nl> this . _element . classList . add ( CLASS_NAME_SHOW ) <nl> } <nl> @ @ - 132 , 8 + 126 , 6 @ @ class Sidebar extends BaseComponent { <nl> this . _element . classList . remove ( CLASS_NAME_SHOW ) <nl> } <nl> - / / this . _element . classList . add ( CLASS_NAME_HIDE ) <nl> - <nl> if ( this . _isMobile ( ) ) { <nl> this . _removeBackdrop ( ) <nl> } <nl> @ @ - 156 , 7 + 148 , 7 @ @ class Sidebar extends BaseComponent { <nl> } <nl> toggle ( ) { <nl> - if ( this . _show ) { <nl> + if ( this . _isVisible ( ) ) { <nl> this . hide ( ) <nl> return <nl> } <nl> @ @ - 240 , 29 + 232 , 6 @ @ class Sidebar extends BaseComponent { <nl> return Boolean ( window . getComputedStyle ( this . _element , null ) . getPropertyValue ( ' - - cui - is - mobile ' ) ) <nl> } <nl> - _isIOS ( ) { <nl> - const iOSDevices = [ <nl> - ' iPad Simulator ' , <nl> - ' iPhone Simulator ' , <nl> - ' iPod Simulator ' , <nl> - ' iPad ' , <nl> - ' iPhone ' , <nl> - ' iPod ' <nl> - ] <nl> - <nl> - const platform = Boolean ( navigator . platform ) <nl> - <nl> - if ( platform ) { <nl> - while ( iOSDevices . length ) { <nl> - if ( navigator . platform = = = iOSDevices . pop ( ) ) { <nl> - return true <nl> - } <nl> - } <nl> - } <nl> - <nl> - return false <nl> - } <nl> - <nl> _isNarrow ( ) { <nl> return this . _element . classList . contains ( CLASS_NAME_SIDEBAR_NARROW ) <nl> } <nl> 
mmm a / scss / _variables . scss <nl> ppp b / scss / _variables . scss <nl> / / fusv - disable <nl> $ primary - dark : # 1f1498 ! default ; <nl> - $ primary : # 321fdb ! default ; <nl> + $ primary - base : # 321fdb ! default ; <nl> $ primary - 50 : # 988fed ! default ; <nl> $ primary - 25 : # ccc7f6 ! default ; <nl> $ secondary - dark : # 212233 ! default ; <nl> - $ secondary : # 9da5b1 ! default ; <nl> + $ secondary - base : # 9da5b1 ! default ; <nl> $ secondary - 50 : # 9da5b1 ! default ; <nl> $ secondary - 25 : # ced2d8 ! default ; <nl> $ success - dark : # 1b9e3e ! default ; <nl> - $ success : # 2eb85c ! default ; <nl> + $ success - base : # 2eb85c ! default ; <nl> $ success - 50 : # 96dbad ! default ; <nl> $ success - 25 : # cbedd6 ! default ; <nl> $ info - dark : # 2982cc ! default ; <nl> - $ info : # 39f ! default ; <nl> + $ info - base : # 39f ! default ; <nl> $ info - 50 : # 80c6ff ! default ; <nl> $ info - 25 : # c0e6ff ! default ; <nl> $ warning - dark : # f6960b ! default ; <nl> - $ warning : # f9b115 ! default ; <nl> + $ warning - base : # f9b115 ! default ; <nl> $ warning - 50 : # fcd88a ! default ; <nl> $ warning - 25 : # feecc5 ! default ; <nl> $ danger - dark : # d93737 ! default ; <nl> - $ danger : # e55353 ! default ; <nl> + $ danger - base : # e55353 ! default ; <nl> $ danger - 50 : # f2a9a9 ! default ; <nl> $ danger - 25 : # f9d4d4 ! default ; <nl> $ light - dark : $ gray - 100 ! default ; <nl> - $ light : $ gray - 100 ! default ; <nl> - $ light - 50 : shift - color ( $ light , - 70 ) ! default ; <nl> - $ light - 25 : shift - color ( $ light , - 80 ) ! default ; <nl> + $ light - base : $ gray - 100 ! default ; <nl> + $ light - 50 : shift - color ( $ light - base , - 70 ) ! default ; <nl> + $ light - 25 : shift - color ( $ light - base , - 80 ) ! default ; <nl> $ dark - dark : $ gray - 900 ! default ; <nl> - $ dark : $ gray - 900 ! default ; <nl> - $ dark - 50 : shift - color ( $ dark , - 70 ) ! default ; <nl> - $ dark - 25 : shift - color ( $ dark , - 80 ) ! default ; <nl> + $ dark - base : $ gray - 900 ! default ; <nl> + $ dark - 50 : shift - color ( $ dark - base , - 70 ) ! default ; <nl> + $ dark - 25 : shift - color ( $ dark - base , - 80 ) ! default ; <nl> / / fusv - enable <nl> / / scss - docs - start theme - color - variables <nl> - $ primary : $ blue ! default ; <nl> - $ secondary : $ gray - 600 ! default ; <nl> - $ success : $ green ! default ; <nl> - $ info : $ cyan ! default ; <nl> - $ warning : $ yellow ! default ; <nl> - $ danger : $ red ! default ; <nl> - $ light : $ gray - 100 ! default ; <nl> - $ dark : $ gray - 900 ! default ; <nl> + $ primary : $ primary - base ! default ; <nl> + $ secondary : $ secondary - base ! default ; <nl> + $ success : $ success - base ! default ; <nl> + $ info : $ info - base ! default ; <nl> + $ warning : $ warning - base ! default ; <nl> + $ danger : $ danger - base ! default ; <nl> + $ light : $ light - base ! default ; <nl> + $ dark : $ dark - base ! default ; <nl> / / scss - docs - end theme - color - variables <nl> / / scss - docs - start theme - colors - map <nl> @ @ - 279 , 7 + 279 , 7 @ @ $ enable - negative - margins : false ! default ; <nl> $ enable - deprecation - messages : true ! default ; <nl> $ enable - important - utilities : true ! default ; <nl> $ enable - contrast - ratio - correction : true ! default ; <nl> - $ enable - contrast - ratio - warnings : true ! default ; <nl> + $ enable - contrast - ratio - warnings : false ! default ; <nl> $ enable - ltr : true ! default ; <nl> $ enable - rtl : false ! default ; <nl> 
mmm a / site / content / docs / 5 . 0 / forms / form - control . md <nl> ppp b / site / content / docs / 5 . 0 / forms / form - control . md <nl> { { < scss - docs name = " form - label - variables " file = " scss / _variables . scss " > } } <nl> { { < scss - docs name = " form - text - variables " file = " scss / _variables . scss " > } } <nl> + <nl> + ` $ form - file - * ` are for file input . <nl> + <nl> + { { < scss - docs name = " form - file - variables " file = " scss / _variables . scss " > } } <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> const EVENT_KEY = ` . $ { DATA_KEY } ` <nl> const DATA_API_KEY = ' . data - api ' <nl> - const Default = { <nl> - / / <nl> - } <nl> + const Default = { } <nl> - const DefaultType = { <nl> - / / <nl> - } <nl> + const DefaultType = { } <nl> const CLASS_NAME_BACKDROP = ' sidebar - backdrop ' <nl> const CLASS_NAME_FADE = ' fade ' <nl> @ @ - 206 , 17 + 202 , 11 @ @ class Sidebar extends BaseComponent { <nl> _getConfig ( config ) { <nl> config = { <nl> - . . . this . constructor . Default , <nl> + . . . Default , <nl> . . . Manipulator . getDataAttributes ( this . _element ) , <nl> - . . . config <nl> + . . . ( typeof config = = = ' object ' ? config : { } ) <nl> } <nl> - <nl> - typeCheckConfig ( <nl> - NAME , <nl> - config , <nl> - this . constructor . DefaultType <nl> - ) <nl> - <nl> + typeCheckConfig ( NAME , config , DefaultType ) <nl> return config <nl> } <nl> 
mmm a / scss / sidebar / _sidebar - nav . scss <nl> ppp b / scss / sidebar / _sidebar - nav . scss <nl> list - style : none ; <nl> + / / Firefox scrollbars <nl> + @ - moz - document url - prefix ( ) { <nl> + scrollbar - width : thin ; <nl> + } <nl> + <nl> + / / Chrome , Edge scrollbars <nl> + <nl> + / * total width * / <nl> + & : : - webkit - scrollbar { <nl> + width : 8px ; <nl> + background - color : transparent ; <nl> + } <nl> + <nl> + / * background of the scrollbar except button or resizer * / <nl> + & : : - webkit - scrollbar - track { <nl> + background - color : transparent ; <nl> + } <nl> + <nl> + / * scrollbar itself * / <nl> + & : : - webkit - scrollbar - thumb { <nl> + background - color : rgba ( 0 , 0 , 0 , . 375 ) ; <nl> + @ include border - radius ( 8px ) ; <nl> + } <nl> + <nl> + / * set button ( top and bottom of the scrollbar ) * / <nl> + & : : - webkit - scrollbar - button { <nl> + display : none ; <nl> + } <nl> + <nl> . nav - title { <nl> padding : $ sidebar - nav - title - padding - y $ sidebar - nav - title - padding - x ; <nl> margin - top : $ sidebar - nav - title - margin - top ; <nl> 
mmm a / scss / _reboot . scss <nl> ppp b / scss / _reboot . scss <nl> / / 1 . A few input types should stay LTR <nl> / / See https : / / rtlstyling . com / posts / rtl - styling # form - inputs <nl> - / / 2 . RTL only output <nl> - / / See https : / / rtlcss . com / learn / usage - guide / control - directives / # raw <nl> - / * rtl : raw : <nl> + * [ dir = " rtl " ] { <nl> [ type = " tel " ] , <nl> [ type = " url " ] , <nl> [ type = " email " ] , <nl> [ type = " number " ] { <nl> direction : ltr ; <nl> } <nl> - * / <nl> + } <nl> + <nl> / / Remove the inner padding in Chrome and Safari on macOS . <nl> 
mmm a / js / src / sidebar . js <nl> ppp b / js / src / sidebar . js <nl> defineJQueryPlugin , <nl> - emulateTransitionEnd , <nl> - getTransitionDurationFromElement , <nl> reflow , <nl> typeCheckConfig <nl> } from ' . / util / index ' <nl> - import Data from ' . / dom / data ' <nl> import EventHandler from ' . / dom / event - handler ' <nl> import Manipulator from ' . / dom / manipulator ' <nl> import BaseComponent from ' . / base - component ' <nl> @ @ - 108 , 17 + 105 , 6 @ @ class Sidebar extends BaseComponent { <nl> this . _showBackdrop ( ) <nl> } <nl> - this . _queueCallback ( ( ) = > { <nl> - if ( this . _isVisible ( ) = = = true ) { <nl> - this . _show = true <nl> - if ( this . _isMobile ( ) | | this . _isOverlaid ( ) ) { <nl> - this . _addClickOutListener ( ) <nl> - } <nl> - <nl> - EventHandler . trigger ( this . _element , EVENT_SHOWN ) <nl> - } <nl> - } ) <nl> - <nl> const complete = ( ) = > { <nl> if ( this . _isVisible ( ) = = = true ) { <nl> this . _show = true <nl> 
mmm a / scss / sidebar / _sidebar . scss <nl> ppp b / scss / sidebar / _sidebar . scss <nl> } <nl> - @ include media - breakpoint - up ( $ mobile - breakpoint ) { <nl> - & . hide { <nl> - & : not ( . sidebar - end ) { <nl> - @ include ltr - rtl ( " margin - left " , calc ( - 1 * var ( - - # { $ variable - prefix } sidebar - width ) ) ) ; <nl> - ~ * { <nl> - - - # { $ variable - prefix } sidebar - occupy - start : 0 ; <nl> - } <nl> - } <nl> - & . sidebar - end { <nl> - @ include ltr - rtl ( " margin - right " , calc ( - 1 * var ( - - # { $ variable - prefix } sidebar - width ) ) ) ; <nl> - ~ * { <nl> - - - # { $ variable - prefix } sidebar - occupy - end : 0 ; <nl> - } <nl> - } <nl> - } <nl> - } <nl> - <nl> & [ class * = " bg - " ] { <nl> border - color : rgba ( $ black , . 1 ) ; <nl> } <nl> } <nl> } <nl> + @ include media - breakpoint - up ( $ mobile - breakpoint ) { <nl> + & . hide { <nl> + & : not ( . sidebar - end ) { <nl> + @ include ltr - rtl ( " margin - left " , calc ( - 1 * var ( - - # { $ variable - prefix } sidebar - width ) ) ) ; <nl> + ~ * { <nl> + - - # { $ variable - prefix } sidebar - occupy - start : 0 ; <nl> + } <nl> + } <nl> + & . sidebar - end { <nl> + @ include ltr - rtl ( " margin - right " , calc ( - 1 * var ( - - # { $ variable - prefix } sidebar - width ) ) ) ; <nl> + ~ * { <nl> + - - # { $ variable - prefix } sidebar - occupy - end : 0 ; <nl> + } <nl> + } <nl> + } <nl> + } <nl> + <nl> & . sidebar - fixed { <nl> @ include media - breakpoint - up ( $ mobile - breakpoint ) { <nl> position : fixed ; <nl> 
mmm a / scss / _tables . scss <nl> ppp b / scss / _tables . scss <nl> / / Highlight border color between thead , tbody and tfoot . <nl> - > : not ( : first - child ) { <nl> - border - top : ( 2 * $ table - border - width ) solid $ table - group - separator - color ; <nl> - } <nl> + / / > : not ( : first - child ) { <nl> + / / border - top : ( 2 * $ table - border - width ) solid $ table - group - separator - color ; <nl> + / / } <nl> } <nl> 
mmm a / js / src / util / focustrap . js <nl> ppp b / js / src / util / focustrap . js <nl> } <nl> const NAME = ' focustrap ' <nl> - const DATA_KEY = ' bs . focustrap ' <nl> + const DATA_KEY = ' coreui . focustrap ' <nl> const EVENT_KEY = ` . $ { DATA_KEY } ` <nl> const EVENT_FOCUSIN = ` focusin $ { EVENT_KEY } ` <nl> const EVENT_KEYDOWN_TAB = ` keydown . tab $ { EVENT_KEY } ` <nl> 
mmm a / js / src / util / component - functions . js <nl> ppp b / js / src / util / component - functions . js <nl> const clickEvent = ` click . dismiss $ { component . EVENT_KEY } ` <nl> const name = component . NAME <nl> - EventHandler . on ( document , clickEvent , ` [ data - bs - dismiss = " $ { name } " ] ` , function ( event ) { <nl> + EventHandler . on ( document , clickEvent , ` [ data - coreui - dismiss = " $ { name } " ] ` , function ( event ) { <nl> if ( [ ' A ' , ' AREA ' ] . includes ( this . tagName ) ) { <nl> event . preventDefault ( ) <nl> } <nl> 
mmm a / js / src / util / index . js <nl> ppp b / js / src / util / index . js <nl> return false <nl> } <nl> - return getComputedStyle ( element ) . getPropertyValue ( ' visibility ' ) = = = ' visible ' <nl> + const elementIsVisible = getComputedStyle ( element ) . getPropertyValue ( ' visibility ' ) = = = ' visible ' <nl> + / / Handle ` details ` element as its content may falsie appear visible when it is closed <nl> + const closedDetails = element . closest ( ' details : not ( [ open ] ) ' ) <nl> + <nl> + if ( ! closedDetails ) { <nl> + return elementIsVisible <nl> + } <nl> + <nl> + if ( closedDetails ! = = element ) { <nl> + const summary = element . closest ( ' summary ' ) <nl> + if ( summary & & summary . parentNode ! = = closedDetails ) { <nl> + return false <nl> + } <nl> + <nl> + if ( summary = = = null ) { <nl> + return false <nl> + } <nl> + } <nl> + <nl> + return elementIsVisible <nl> } <nl> const isDisabled = element = > { <nl> 
mmm a / scss / mixins / _ltr - rtl . scss <nl> ppp b / scss / mixins / _ltr - rtl . scss <nl> @ function reflect ( $ element ) { <nl> - @ if type - of ( $ element ) = = string { <nl> - @ if str - index ( $ element , " left " ) { <nl> - @ return str - replace ( $ element , " left " , " right " ) ; <nl> - } <nl> - @ if str - index ( $ element , " right " ) { <nl> - @ return str - replace ( $ element , " right " , " left " ) ; <nl> + $ string : # { $ element } ; <nl> + @ if str - index ( $ string , " left " ) { <nl> + @ return str - replace ( $ string , " left " , " right " ) ; <nl> } <nl> + @ if str - index ( $ string , " right " ) { <nl> + @ return str - replace ( $ string , " right " , " left " ) ; <nl> } <nl> - @ return $ element ; <nl> + @ return unquote ( $ string ) ; <nl> } <nl> @ mixin ltr - rtl ( $ property , $ value , $ property - rtl : null , $ value - rtl : null , $ important : null ) { <nl> } <nl> } <nl> - @ mixin ltr - rtl - value - only ( $ property , $ value , $ value - rtl , $ important : null ) { <nl> + @ mixin ltr - rtl - value - only ( $ property , $ value , $ value - rtl : null , $ important : null ) { <nl> $ value - reflected : reflect ( $ value ) ; <nl> @ if $ enable - ltr and $ enable - rtl { <nl> # { $ property } : $ value $ important ; <nl> } <nl> @ include rtl ( ) { <nl> + @ if $ value - rtl { <nl> # { $ property } : $ value - rtl $ important ; <nl> + } @ else { <nl> + # { $ property } : $ value - reflected $ important ; <nl> + } <nl> } <nl> } <nl> @ else { <nl> @ if $ enable - rtl { <nl> + @ if $ value - rtl { <nl> # { $ property } : $ value - rtl $ important ; <nl> + } @ else { <nl> + # { $ property } : $ value - reflected $ important ; <nl> } <nl> - @ else { <nl> + } @ else { <nl> # { $ property } : $ value $ important ; <nl> } <nl> } <nl> 
mmm a / scss / _offcanvas . scss <nl> ppp b / scss / _offcanvas . scss <nl> flex - direction : column ; <nl> max - width : 100 % ; <nl> - color : $ offcanvas - color ; <nl> + color : var ( - - # { $ variable - prefix } offcanvas - color , $ offcanvas - color ) ; <nl> visibility : hidden ; <nl> - background - color : $ offcanvas - bg - color ; <nl> + background - color : var ( - - # { $ variable - prefix } offcanvas - bg - color , $ offcanvas - bg - color ) ; <nl> background - clip : padding - box ; <nl> outline : 0 ; <nl> @ include box - shadow ( $ offcanvas - box - shadow ) ; <nl> } <nl> . offcanvas - backdrop { <nl> - @ include overlay - backdrop ( $ zindex - offcanvas - backdrop , $ offcanvas - backdrop - bg , $ offcanvas - backdrop - opacity ) ; <nl> + @ include overlay - backdrop ( $ zindex - offcanvas - backdrop , var ( - - # { $ variable - prefix } offcanvas - backdrop - bg , $ offcanvas - backdrop - bg ) , $ offcanvas - backdrop - opacity ) ; <nl> } <nl> . offcanvas - header { <nl> top : 0 ; <nl> @ include ltr - rtl ( " left " , 0 ) ; <nl> width : $ offcanvas - horizontal - width ; <nl> - @ include ltr - rtl ( " border - right " , $ offcanvas - border - width solid $ offcanvas - border - color ) ; <nl> + @ include ltr - rtl ( " border - right " , $ offcanvas - border - width solid var ( - - # { $ variable - prefix } offcanvas - border - color , $ offcanvas - border - color ) ) ; <nl> @ include ltr - rtl - value - only ( " transform " , translateX ( - 100 % ) , translateX ( 100 % ) ) ; <nl> } <nl> top : 0 ; <nl> @ include ltr - rtl ( " right " , 0 ) ; <nl> width : $ offcanvas - horizontal - width ; <nl> - @ include ltr - rtl ( " border - left " , $ offcanvas - border - width solid $ offcanvas - border - color ) ; <nl> + @ include ltr - rtl ( " border - left " , $ offcanvas - border - width solid var ( - - # { $ variable - prefix } offcanvas - border - color , $ offcanvas - border - color ) ) ; <nl> @ include ltr - rtl - value - only ( " transform " , translateX ( 100 % ) , translateX ( - 100 % ) ) ; <nl> } <nl> left : 0 ; <nl> height : $ offcanvas - vertical - height ; <nl> max - height : 100 % ; <nl> - border - bottom : $ offcanvas - border - width solid $ offcanvas - border - color ; <nl> + border - bottom : $ offcanvas - border - width solid var ( - - # { $ variable - prefix } offcanvas - border - color , $ offcanvas - border - color ) ; <nl> transform : translateY ( - 100 % ) ; <nl> } <nl> left : 0 ; <nl> height : $ offcanvas - vertical - height ; <nl> max - height : 100 % ; <nl> - border - top : $ offcanvas - border - width solid $ offcanvas - border - color ; <nl> + border - top : $ offcanvas - border - width solid var ( - - # { $ variable - prefix } offcanvas - border - color , $ offcanvas - border - color ) ; <nl> transform : translateY ( 100 % ) ; <nl> } <nl> 
mmm a / packages / veui - theme - one / components / AlertBox . js <nl> ppp b / packages / veui - theme - one / components / AlertBox . js <nl> success : ' check - circle - o - large ' , <nl> info : ' info - circle - o - large ' , <nl> error : ' cross - circle - o - large ' <nl> - } , <nl> - ui : { <nl> - type : { <nl> - values : [ ' success ' , ' error ' , ' info ' ] <nl> - } <nl> } <nl> } , ' alertbox ' ) <nl> 
mmm a / packages / veui - theme - one / components / progress . less <nl> ppp b / packages / veui - theme - one / components / progress . less <nl> } <nl> - & - state { <nl> + & - status { <nl> & - complete { <nl> color : @ veui - text - color - normal ; <nl> } <nl> 
mmm a / packages / veui / src / components / Pagination . vue <nl> ppp b / packages / veui / src / components / Pagination . vue <nl> methods : { <nl> handleRedirect ( page , event ) { <nl> if ( page ! = = this . page ) { <nl> - this . $ emit ( ' redirect ' , { page , event } ) <nl> + this . $ emit ( ' redirect ' , page , event ) <nl> } <nl> } , <nl> 
mmm a / packages / veui - theme - one / components / uploader . less <nl> ppp b / packages / veui - theme - one / components / uploader . less <nl> float : right ; <nl> + margin - right : 4px ; <nl> color : @ veui - gray - color - 2 ; <nl> opacity : 0 ; <nl> . centered - line ( 20px ) ; <nl> } <nl> } <nl> - & - list - transition - enter , <nl> - & - list - transition - leave - to { <nl> + & - list - enter , <nl> + & - list - leave - to { <nl> opacity : 0 ; <nl> } <nl> - . veui - uploader - list - transition - leave - active { <nl> + <nl> + & & - list - leave - active { <nl> position : absolute ; <nl> } <nl> 
mmm a / packages / veui / src / directives / outside . js <nl> ppp b / packages / veui / src / directives / outside . js <nl> return elements <nl> } <nl> - function parseParams ( el , arg , modifiers , value , context ) { <nl> + function parseParams ( el , arg , modifiers , value ) { <nl> let refs = arg ? arg . split ( ' , ' ) : [ ] <nl> let handler <nl> let trigger = find ( TRIGGER_TYPES , triggerType = > triggerType in modifiers ) | | ' click ' <nl> @ @ - 192 , 7 + 192 , 7 @ @ function clear ( el ) { <nl> } ) <nl> } <nl> - function refresh ( el , { value , arg , modifiers , oldValue } , vnode ) { <nl> + function refresh ( el , { value , arg , modifiers } , vnode ) { <nl> const params = parseParams ( el , arg , modifiers , value , vnode . context ) <nl> let { trigger , refs , excludeSelf , delay } = params <nl> let key = getBindingKey ( trigger ) <nl> 
mmm a / packages / veui / src / managers / rule . js <nl> ppp b / packages / veui / src / managers / rule . js <nl> } <nl> } <nl> - validate ( val , rules ) { <nl> + validate ( val , rules , formData ) { <nl> if ( ! rules | | ! rules . length ) { <nl> return true <nl> } <nl> @ @ - 39 , 7 + 39 , 7 @ @ export class Rule { <nl> rules = Array . isArray ( rules ) ? rules : [ rules ] <nl> let results = rules . map ( rule = > { <nl> let validator = this . ruleValidators [ rule . name ] <nl> - if ( ! validator . validate ( val , rule . value ) ) { <nl> + if ( ! validator . validate ( val , rule . value , formData ) ) { <nl> let realMessage = rule . message | | validator . message <nl> return { <nl> name : rule . name , <nl> 
mmm a / packages / veui / src / managers / rule . js <nl> ppp b / packages / veui / src / managers / rule . js <nl> import min from ' . / rules / min ' <nl> import numeric from ' . / rules / numeric ' <nl> import pattern from ' . / rules / pattern ' <nl> + import type from ' . / type ' <nl> import { isObject , isFunction } from ' lodash ' <nl> / * * <nl> @ @ - 31 , 15 + 32 , 16 @ @ export class Rule { <nl> } <nl> } <nl> - validate ( val , rules , formData ) { <nl> + validate ( val , rules , context ) { <nl> if ( ! rules | | ! rules . length ) { <nl> return true <nl> } <nl> rules = Array . isArray ( rules ) ? rules : [ rules ] <nl> + let contextData = type . clone ( context ) <nl> let results = rules . map ( rule = > { <nl> let validator = this . ruleValidators [ rule . name ] <nl> - if ( ! validator . validate ( val , rule . value , formData ) ) { <nl> + if ( ! validator . validate ( val , rule . value , contextData ) ) { <nl> let realMessage = rule . message | | validator . message <nl> return { <nl> name : rule . name , <nl> 
mmm a / packages / veui / src / mixins / ui . js <nl> ppp b / packages / veui / src / mixins / ui . js <nl> import config from ' . . / managers / config ' <nl> import { compact , uniq , find , includes , get , merge , keys , pickBy } from ' lodash ' <nl> + const UNKNOWN_KEY = ' $ unknown ' <nl> + <nl> export default { <nl> props : { <nl> ui : String <nl> @ @ - 41 , 7 + 43 , 7 @ @ export default { <nl> result [ name ] = token <nl> } <nl> } else { <nl> - result . $ unknown . push ( token ) <nl> + result [ UNKNOWN_KEY ] . push ( token ) <nl> } <nl> return result <nl> } , <nl> @ @ - 54 , 7 + 56 , 7 @ @ export default { <nl> } <nl> return result <nl> } , { <nl> - $ unknown : [ ] <nl> + [ UNKNOWN_KEY ] : [ ] <nl> } ) <nl> ) <nl> } , <nl> @ @ - 63 , 7 + 65 , 7 @ @ export default { <nl> } , <nl> uiData ( ) { <nl> let { uiConfig = { } , uiProps } = this <nl> - return keys ( uiProps ) . filter ( name = > name ! = = ' $ unknown ' ) . reduce ( ( result , name ) = > { <nl> + return keys ( uiProps ) . filter ( name = > name ! = = UNKNOWN_KEY ) . reduce ( ( result , name ) = > { <nl> let data = get ( uiConfig [ name ] , [ ' data ' , uiProps [ name ] ] , { } ) <nl> merge ( result , data ) <nl> return result <nl> @ @ - 92 , 7 + 94 , 7 @ @ export default { <nl> / / merge ui & $ parent ' s inheritedUi <nl> let { uiProps = { } } = this <nl> let overrides = pickBy ( uiProps , ( val , key ) = > { <nl> - return key ! = = ' $ unknown ' & & ( val ! = = ' default ' | | val = = = true ) <nl> + return key ! = = UNKNOWN_KEY & & ( val ! = = ' default ' | | val = = = true ) <nl> } ) <nl> let { inheritedUiProps = { } } = this . $ parent | | { } <nl> let props = { . . . inheritedUiProps , . . . overrides } <nl> @ @ - 104 , 7 + 106 , 7 @ @ export default { <nl> return props [ key ] <nl> } ) <nl> . filter ( val = > val ! = = ' default ' & & val ! = = false ) <nl> - . concat ( uiProps . $ unknown ) <nl> + . concat ( uiProps [ UNKNOWN_KEY ] ) <nl> . join ( ' ' ) | | null <nl> } <nl> } , <nl> 
mmm a / packages / veui / src / components / Uploader . vue <nl> ppp b / packages / veui / src / components / Uploader . vue <nl> import i18n from ' . . / mixins / i18n ' <nl> import config from ' . . / managers / config ' <nl> import { stringifyQuery } from ' . . / utils / helper ' <nl> - import bytes from ' bytes ' <nl> + import { parse , format } from ' bytes ' <nl> import warn from ' . . / utils / warn ' <nl> config . defaults ( { <nl> @ @ - 821 , 7 + 821 , 7 @ @ export default { <nl> } ) <nl> } , <nl> validateFileSize ( fileSize ) { <nl> - return ! this . maxSize | | ! fileSize | | fileSize < = bytes . parse ( this . maxSize ) <nl> + return ! this . maxSize | | ! fileSize | | fileSize < = parse ( this . maxSize ) <nl> } , <nl> uploadFiles ( ) { <nl> this . fileList . forEach ( file = > { <nl> @ @ - 1008 , 7 + 1008 , 7 @ @ export default { <nl> this . $ refs . label . appendChild ( this . $ refs . input ) <nl> } , <nl> convertSizeUnit ( size ) { <nl> - return bytes ( size , { decimalPlaces : 1 } ) <nl> + return format ( size , { decimalPlaces : 1 } ) <nl> } , <nl> parseData ( data ) { <nl> if ( typeof data = = = ' object ' ) { <nl> 
mmm a / packages / veui / src / components / FilterPanel . vue <nl> ppp b / packages / veui / src / components / FilterPanel . vue <nl> } <nl> } , <nl> created ( ) { <nl> - let me = this <nl> - this . debounceSearch = debounce ( ( ) = > me . search ( ) , 200 ) <nl> + this . debounceSearch = debounce ( ( ) = > this . search ( ) , 200 ) <nl> } , <nl> beforeDestroy ( ) { <nl> this . debounceSearch . cancel ( ) <nl> 
mmm a / packages / veui / src / components / Link . vue <nl> ppp b / packages / veui / src / components / Link . vue <nl> < / component > <nl> < router - link <nl> - v - else - if = " $ router & & ! native " <nl> + v - else - if = " useRouter " <nl> : class = " klass " <nl> : to = " to " <nl> : rel = " realRel " <nl> @ @ - 73 , 6 + 73 , 9 @ @ export default { <nl> ) . join ( ' ' ) <nl> } <nl> return this . rel <nl> + } , <nl> + useRouter ( ) { <nl> + return this . $ router & & ! this . native <nl> } <nl> } , <nl> methods : { <nl> 
mmm a / packages / veui / src / components / Autocomplete / Autocomplete . vue <nl> ppp b / packages / veui / src / components / Autocomplete / Autocomplete . vue <nl> mixins : [ ui , input , overlay ] , <nl> props : { <nl> . . . AutocompleteBase . props , <nl> - focusClass : { <nl> - type : String , <nl> - default : ' veui - autocomplete - focus ' <nl> - } , <nl> suggestTrigger : { <nl> type : [ String , Array ] , <nl> default : ' input ' <nl> 
mmm a / packages / veui - theme - dls / components / NumberInput . js <nl> ppp b / packages / veui - theme - dls / components / NumberInput . js <nl> spinner : ' ' <nl> } , <nl> icons : { <nl> - increase ( { style } ) { <nl> - return ICON_MAP [ style ] . increase <nl> - } , <nl> - decrease ( { style } ) { <nl> - return ICON_MAP [ style ] . decrease <nl> - } <nl> + increase : ( { style } ) = > ICON_MAP [ style ] . increase , <nl> + decrease : ( { style } ) = > ICON_MAP [ style ] . decrease <nl> } <nl> } , <nl> ' numberinput ' <nl> 
mmm a / packages / veui / src / components / Form / Fieldset . vue <nl> ppp b / packages / veui / src / components / Form / Fieldset . vue <nl> role = " group " <nl> v - bind = " attrs " <nl> - > <nl> - < template <nl> - v - if = " $ slots . label " <nl> - slot = " label " <nl> > <nl> < slot name = " label " / > <nl> - < / template > <nl> < slot / > <nl> - < template <nl> - v - if = " $ slots . tip " <nl> - slot = " tip " <nl> - > <nl> < slot name = " tip " / > <nl> - < / template > <nl> < / veui - field > <nl> < / template > <nl> 
mmm a / packages / veui / src / components / Uploader . vue <nl> ppp b / packages / veui / src / components / Uploader . vue <nl> < / span > <nl> < span : class = " $ c ( ' uploader - error ' ) " > <nl> - < template v - if = " error . typeInvalid " > <nl> - < slot name = " type - invalid " > <nl> - < veui - icon : name = " icons . alert " / > { { t ( ' fileTypeInvalid ' ) } } <nl> - < / slot > <nl> - < / template > <nl> - < template v - if = " error . sizeInvalid " > <nl> - < slot name = " size - invalid " > <nl> - < veui - icon : name = " icons . alert " / > { { t ( ' fileSizeInvalid ' ) } } <nl> - < / slot > <nl> - < / template > <nl> - < template v - if = " error . countOverflow " > <nl> - < slot name = " count - overflow " > <nl> - < veui - icon : name = " icons . alert " / > { { t ( ' tooManyFiles ' ) } } <nl> - < / slot > <nl> - < / template > <nl> - < template v - if = " error . customValidationInvalid " > <nl> - < slot name = " custom - validation - invalid " > <nl> - < veui - icon : name = " icons . alert " / > { { customValidationMessage } } <nl> + < slot <nl> + name = " invalid " <nl> + : error = " error " <nl> + > <nl> + < veui - icon <nl> + v - if = " validationMessage " <nl> + : name = " icons . alert " <nl> + / > { { <nl> + validationMessage <nl> + } } <nl> < / slot > <nl> - < / template > <nl> < / span > <nl> < / div > <nl> < transition - group <nl> v - if = " type = = = ' image ' " <nl> : class = " $ c ( ' uploader - error ' ) " <nl> > <nl> - < template v - if = " error . typeInvalid " > <nl> - < slot name = " type - invalid " > <nl> - < veui - icon : name = " icons . alert " / > { { t ( ' fileTypeInvalid ' ) } } <nl> - < / slot > <nl> - < / template > <nl> - < template v - if = " error . sizeInvalid " > <nl> - < slot name = " size - invalid " > <nl> - < veui - icon : name = " icons . alert " / > { { t ( ' fileSizeInvalid ' ) } } <nl> - < / slot > <nl> - < / template > <nl> - < template v - if = " error . countOverflow " > <nl> - < slot name = " count - overflow " > <nl> - < veui - icon : name = " icons . alert " / > { { t ( ' tooManyFiles ' ) } } <nl> - < / slot > <nl> - < / template > <nl> - < template v - if = " error . customValidationInvalid " > <nl> - < slot name = " custom - validation - invalid " > <nl> - < veui - icon : name = " icons . alert " / > { { customValidationMessage } } <nl> + < slot <nl> + name = " invalid " <nl> + : error = " error " <nl> + > <nl> + < veui - icon <nl> + v - if = " validationMessage " <nl> + : name = " icons . alert " <nl> + / > { { <nl> + validationMessage <nl> + } } <nl> < / slot > <nl> - < / template > <nl> < / span > <nl> < iframe <nl> v - if = " requestMode = = = ' iframe ' & & submitting " <nl> @ @ - 642 , 6 + 624 , 18 @ @ export default { <nl> ( file . status = = = ' success ' | | ! file . status ) & & ! file . toBeUploaded <nl> ) <nl> . map ( file = > omit ( file , [ ' status ' , ' toBeUploaded ' ] ) ) <nl> + } , <nl> + validationMessage ( ) { <nl> + let messageMap = { <nl> + typeInvalid : this . t ( ' fileTypeInvalid ' ) , <nl> + sizeInvalid : this . t ( ' fileSizeInvalid ' ) , <nl> + countOverflow : this . t ( ' tooManyFiles ' ) , <nl> + customValidationInvalid : this . customValidationMessage <nl> + } <nl> + return Object . keys ( this . error ) <nl> + . map ( key = > ( this . error [ key ] ? messageMap [ key ] : ' ' ) ) <nl> + . filter ( i = > ! ! i ) <nl> + . join ( ' , ' ) <nl> } <nl> } , <nl> watch : { <nl> 
mmm a / packages / veui / src / components / Span . vue <nl> ppp b / packages / veui / src / components / Span . vue <nl> - < span <nl> - : class = " $ c ( ' span ' ) " <nl> - : ui = " realUi " <nl> - > <nl> - < slot / > <nl> - < / span > <nl> - < / template > <nl> - <nl> < script > <nl> - import prefix from ' . . / mixins / prefix ' <nl> - import ui from ' . . / mixins / ui ' <nl> + import { prefixify } from ' . . / mixins / prefix ' <nl> export default { <nl> name : ' veui - span ' , <nl> - mixins : [ prefix , ui ] <nl> + uiTypes : [ ' transparent ' ] , <nl> + functional : true , <nl> + render ( h , { data , children } ) { <nl> + return h ( <nl> + ' span ' , <nl> + { <nl> + . . . data , <nl> + class : { <nl> + [ prefixify ( ' span ' ) ] : true <nl> + } <nl> + } , <nl> + children <nl> + ) <nl> + } <nl> } <nl> < / script > <nl> 
mmm a / packages / veui / test / unit / specs / components / Anchor . spec . js <nl> ppp b / packages / veui / test / unit / specs / components / Anchor . spec . js <nl> wrapper . destroy ( ) <nl> } ) <nl> - it ( ' should handle scroll correctly when container is window ' , async ( ) = > { <nl> + it ( ' should handle scroll correctly when container is window ( or falsy ) ' , async ( ) = > { <nl> let wrapper = mount ( <nl> { <nl> . . . componentOptions , <nl> template : ` < div style = " padding - top : 50px ; " > <nl> - < veui - anchor : items = " coffees " container = " @ window " / > <nl> + < veui - anchor : items = " coffees " / > <nl> < veui - anchor class = " anchor - two " : items = " coffees " : sticky = " false " / > <nl> < div style = " height : 200vh ; " / > <nl> < / div > ` <nl> 
mmm a / packages / veui / src / components / Table / _TableBody . js <nl> ppp b / packages / veui / src / components / Table / _TableBody . js <nl> let key = table . keyField <nl> ? item [ table . keyField ] <nl> : table . realKeys [ index ] <nl> - let expanded = table . localExpanded . indexOf ( key ) ! = = - 1 <nl> + let expanded = table . realExpanded . indexOf ( key ) ! = = - 1 <nl> let rows = [ < Row index = { index } expanded = { expanded } / > ] <nl> if ( table . expandable & & expanded ) { <nl> 
mmm a / packages / veui / test / unit / specs / components / NumberInput . spec . js <nl> ppp b / packages / veui / test / unit / specs / components / NumberInput . spec . js <nl> expect ( input . element . value ) . to . equal ( ' 3 ' ) <nl> } ) <nl> - it ( ' should handle decimalPlace prop correctly ' , async ( ) = > { <nl> + it ( ' should handle ` decimalPlace ` prop correctly ' , async ( ) = > { <nl> let wrapper = mount ( NumberInput , { <nl> propsData : { <nl> decimalPlace : 2 <nl> @ @ - 148 , 17 + 148 , 19 @ @ describe ( ' components / NumberInput ' , ( ) = > { <nl> } ) <nl> let input = wrapper . find ( ' input . veui - input - input ' ) <nl> - input . setValue ( 2 . 333 ) <nl> - wrapper . find ( ' input ' ) . trigger ( ' blur ' ) <nl> + input . setValue ( ' 2 ' ) <nl> + wrapper . find ( ' input ' ) . trigger ( ' change ' ) <nl> + await wrapper . vm . $ nextTick ( ) <nl> + expect ( input . element . value ) . to . equal ( ' 2 . 00 ' ) <nl> + <nl> + input . setValue ( ' 2 . 333 ' ) <nl> + wrapper . find ( ' input ' ) . trigger ( ' change ' ) <nl> await wrapper . vm . $ nextTick ( ) <nl> expect ( input . element . value ) . to . equal ( ' 2 . 33 ' ) <nl> } ) <nl> it ( ' should handle change event ' , done = > { <nl> let wrapper = mount ( NumberInput , { <nl> - propsData : { <nl> - value : null <nl> - } , <nl> sync : false <nl> } ) <nl> @ @ - 170 , 4 + 172 , 22 @ @ describe ( ' components / NumberInput ' , ( ) = > { <nl> wrapper . find ( ' button . veui - number - input - step - up ' ) . trigger ( ' click ' ) <nl> } ) <nl> + <nl> + it ( ' should make prop ` value ` fully controlled and violate ` decimalPlace ` for respecting prop ` value ` ' , async ( ) = > { <nl> + let wrapper = mount ( NumberInput , { <nl> + propsData : { <nl> + value : 2 . 123 , <nl> + decimalPlace : 2 <nl> + } , <nl> + sync : false <nl> + } ) <nl> + <nl> + let input = wrapper . find ( ' input . veui - input - input ' ) <nl> + expect ( input . element . value ) . to . equal ( ' 2 . 123 ' ) <nl> + <nl> + input . setValue ( ' 2 ' ) <nl> + wrapper . find ( ' input ' ) . trigger ( ' change ' ) <nl> + await wrapper . vm . $ nextTick ( ) <nl> + expect ( input . element . value ) . to . equal ( ' 2 . 123 ' ) <nl> + } ) <nl> } ) <nl> 
mmm a / packages / veui / src / mixins / key - select . js <nl> ppp b / packages / veui / src / mixins / key - select . js <nl> case ' Escape ' : <nl> case ' Left ' : <nl> case ' ArrowLeft ' : <nl> - if ( typeof this . close = = = ' function ' ) { <nl> - this . close ( ) <nl> - } <nl> + this [ expandedKey ] = false <nl> break <nl> case ' Up ' : <nl> case ' ArrowUp ' : <nl> 
mmm a / packages / veui - theme - dls / components / uploader . less <nl> ppp b / packages / veui - theme - dls / components / uploader . less <nl> } <nl> } <nl> - & - preview - dialog { <nl> - & - media { <nl> - min - width : @ dls - uploader - media - preview - min - width ; <nl> - max - width : @ dls - uploader - media - preview - max - width ; <nl> - } <nl> - } <nl> & - desc { <nl> color : @ dls - uploader - helper - text - font - color ; <nl> 
mmm a / packages / veui / src / components / Table / Table . vue <nl> ppp b / packages / veui / src / components / Table / Table . vue <nl> } <nl> const DEFAULT_FIXED_COL_WIDTH = 120 <nl> + const SHADOW_WIDTH = 20 <nl> export default { <nl> name : ' veui - table ' , <nl> @ @ - 175 , 7 + 176 , 12 @ @ export default { <nl> directives : { <nl> resize <nl> } , <nl> - mixins : [ prefix , ui , i18n , colgroup , useControllable ( [ <nl> + mixins : [ <nl> + prefix , <nl> + ui , <nl> + i18n , <nl> + colgroup , <nl> + useControllable ( [ <nl> { <nl> prop : ' expanded ' , <nl> get ( val ) { <nl> @ @ - 194 , 10 + 200 , 7 @ @ export default { <nl> prop : ' selected ' , <nl> get ( val ) { <nl> let ctl = this . isControlled ( ' selected ' ) <nl> - if ( <nl> - ( ctl & & this . validateSelected ( this . selected ) ) | | <nl> - ! ctl <nl> - ) { <nl> + if ( ( ctl & & this . validateSelected ( this . selected ) ) | | ! ctl ) { <nl> val = normalizeArray ( val ) <nl> return intersection ( val , this . realKeys ) <nl> } <nl> @ @ - 216 , 7 + 219 , 8 @ @ export default { <nl> } <nl> } <nl> } <nl> - ] ) ] , <nl> + ] ) <nl> + ] , <nl> props : { <nl> data : { <nl> type : Array , <nl> @ @ - 404 , 8 + 408 , 8 @ @ export default { <nl> shadowOffset ( ) { <nl> if ( ! this . supportSticky ) { <nl> return { <nl> - left : 20 , <nl> - right : 20 <nl> + left : SHADOW_WIDTH , <nl> + right : SHADOW_WIDTH <nl> } <nl> } <nl> let row = this . headerGrid [ this . headerGrid . length - 1 ] <nl> @ @ - 421 , 13 + 425 , 13 @ @ export default { <nl> row <nl> . slice ( 0 , leftEnd + 1 ) <nl> . map ( ( { width } ) = > width ) <nl> - . concat ( this . offsetLeft , 20 ) <nl> + . concat ( this . offsetLeft , SHADOW_WIDTH ) <nl> ) , <nl> right : sumWidths ( <nl> row <nl> . slice ( rightStart ) <nl> . map ( ( { width } ) = > width ) <nl> - . concat ( this . hasFixedRight ? this . gutterWidth : [ ] , 20 ) <nl> + . concat ( this . hasFixedRight ? this . gutterWidth : [ ] , SHADOW_WIDTH ) <nl> ) <nl> } <nl> } , <nl> @ @ - 578 , 8 + 582 , 11 @ @ export default { <nl> value . splice ( value . indexOf ( key ) , 1 ) <nl> } <nl> } else { <nl> - if ( ! selected & & <nl> - intersection ( this . realSelected , this . disabledSelectedKeys ) . length = = = this . realSelected . length ) { <nl> + if ( <nl> + ! selected & & <nl> + intersection ( this . realSelected , this . disabledSelectedKeys ) . length = = = <nl> + this . realSelected . length <nl> + ) { <nl> selected = true <nl> } <nl> value = selected <nl> 
mmm a / packages / veui / src / components / Uploader . vue <nl> ppp b / packages / veui / src / components / Uploader . vue <nl> @ click = " handleMediaAction ( file , index , $ event ) " <nl> > <nl> - < template v - slot : trigger = " { props , handlers } " > <nl> + < template <nl> + slot = " trigger " <nl> + slot - scope = " { props , handlers } " <nl> + > <nl> < label <nl> v - if = " control . name = = = ' replace ' " <nl> : key = " control . name " <nl> trigger = " hover " <nl> @ click = " handleMediaAction ( file , index , $ event ) " <nl> > <nl> - < template v - slot : trigger = " { props , handlers } " > <nl> + < template <nl> + slot = " trigger " <nl> + slot - scope = " { props , handlers } " <nl> + > <nl> < label <nl> v - if = " control . name = = = ' replace ' " <nl> : key = " control . name " <nl> @ click = " handleMediaEntry " <nl> > <nl> < template <nl> - v - slot : trigger = " { <nl> + slot = " trigger " <nl> + slot - scope = " { <nl> props : triggerProps , <nl> handlers : triggerHandlers <nl> } " <nl> @ @ - 830 , 12 + 837 , 14 @ @ export default { <nl> } , <nl> realAccept ( ) { <nl> if ( this . extensions ) { <nl> - return this . extensions . map ( extension = > { <nl> + return this . extensions <nl> + . map ( extension = > { <nl> if ( extension . indexOf ( ' . ' ) ! = = 0 ) { <nl> return ` . $ { extension } ` <nl> } <nl> return extension <nl> - } ) . join ( ' , ' ) <nl> + } ) <nl> + . join ( ' , ' ) <nl> } <nl> if ( this . accept ) { <nl> return this . accept <nl> @ @ - 991 , 7 + 1000 , 11 @ @ export default { <nl> let newFiles = [ . . . files ] <nl> let countFiles = this . fileList . length + newFiles . length <nl> - if ( ! this . isReplacing & & this . maxCount ! = = 1 & & countFiles > this . maxCount ) { <nl> + if ( <nl> + ! this . isReplacing & & <nl> + this . maxCount ! = = 1 & & <nl> + countFiles > this . maxCount <nl> + ) { <nl> toast . error ( this . t ( ' tooManyFiles ' ) ) <nl> this . $ emit ( ' invalid ' , { <nl> errors : [ <nl> @ @ - 1145 , 9 + 1158 , 11 @ @ export default { <nl> extensions = [ ] <nl> } <nl> - return acceptExtention = = = ' * ' & & <nl> + return ( <nl> + acceptExtention = = = ' * ' & & <nl> item . indexOf ( ' / ' ) > - 1 & & <nl> ( extensions . indexOf ( extension ) > - 1 | | ! extensions . length ) <nl> + ) <nl> } ) <nl> } , <nl> validateSize ( fileSize ) { <nl> @ @ - 1401 , 7 + 1416 , 10 @ @ export default { <nl> defaultControls = [ <nl> { <nl> name : ' preview ' , <nl> - icon : file . type = = = ' image ' ? this . icons . previewImage : this . icons . previewVideo , <nl> + icon : <nl> + file . type = = = ' image ' <nl> + ? this . icons . previewImage <nl> + : this . icons . previewVideo , <nl> disabled : false , <nl> label : this . t ( ' preview ' ) <nl> } <nl> 
mmm a / packages / veui / src / components / Uploader . vue <nl> ppp b / packages / veui / src / components / Uploader . vue <nl> return <nl> } <nl> - if ( this . requestMode = = = ' iframe ' & & this . autoupload ) { <nl> + if ( this . autoupload ) { <nl> + if ( this . requestMode = = = ' iframe ' ) { <nl> this . submit ( newFile ) <nl> - } <nl> - if ( this . requestMode ! = = ' iframe ' & & this . autoupload ) { <nl> + } else { <nl> this . uploadFile ( newFile ) <nl> } <nl> + } <nl> } else { <nl> this . fileList = <nl> this . realOrder = = = ' desc ' <nl> @ @ - 1067 , 14 + 1068 , 17 @ @ export default { <nl> this . fileList = this . fileList . slice ( - 1 ) <nl> } <nl> - if ( this . requestMode = = = ' iframe ' & & this . autoupload ) { <nl> - newFiles [ 0 ] . toBeUploaded & & this . submit ( newFiles [ 0 ] ) <nl> + if ( this . autoupload ) { <nl> + if ( this . requestMode = = = ' iframe ' ) { <nl> + if ( newFiles [ 0 ] . toBeUploaded ) { <nl> + this . submit ( newFiles [ 0 ] ) <nl> } <nl> - if ( this . requestMode ! = = ' iframe ' & & this . autoupload ) { <nl> + } else { <nl> this . uploadFiles ( ) <nl> } <nl> } <nl> } <nl> + } <nl> ) <nl> } , <nl> validateFile ( file ) { <nl> 
mmm a / packages / veui / src / mixins / upload . js <nl> ppp b / packages / veui / src / mixins / upload . js <nl> ' requestMode ' <nl> ] <nl> - const computed = sharedProps . reduce ( function ( ret , key ) { <nl> + const computed = sharedProps . reduce ( ( ret , key ) = > { <nl> ret [ key ] = function ( ) { <nl> return this . options [ key ] <nl> } <nl> 
mmm a / packages / veui / src / components / Dialog . vue <nl> ppp b / packages / veui / src / components / Dialog . vue <nl> > <nl> < div <nl> - ref = " content " <nl> + v - drag . translate = " { <nl> + disabled : ! draggable , <nl> + containment : ' @ window ' , <nl> + handle : ' head ' , <nl> + ready : dragReady <nl> + } " <nl> v - outside = " outside " <nl> : class = " $ c ( ' dialog - content ' ) " <nl> tabindex = " - 1 " <nl> @ keydown . esc = " handleEscape " <nl> > <nl> < div <nl> - v - drag : content . translate = " { <nl> - draggable , <nl> - containment : ' @ window ' , <nl> - ready : dragReady <nl> - } " <nl> + ref = " head " <nl> : class = " { <nl> [ $ c ( ' dialog - content - head ' ) ] : true , <nl> [ $ c ( ' dialog - draggable ' ) ] : draggable <nl> 
mmm a / packages / veui / src / components / Textarea . vue <nl> ppp b / packages / veui / src / components / Textarea . vue <nl> } <nl> } , <nl> updateMeasurer ( ) { <nl> - if ( this . $ refs . input ) { <nl> - this . measurerContentWidth = this . $ refs . input . clientWidth <nl> + let { input } = this . $ refs <nl> + if ( ! input ) { <nl> + return <nl> } <nl> + this . measurerContentWidth = input . clientWidth <nl> this . $ nextTick ( ( ) = > { <nl> if ( this . realMaxlength ! = = null ) { <nl> 
mmm a / packages / veui / demo / cases / CheckButtonGroup . vue <nl> ppp b / packages / veui / demo / cases / CheckButtonGroup . vue <nl> : items = " dataWithExclusive " <nl> : disabled = " disabled " <nl> - ui = " simple s " <nl> - : style = " { <nl> - ' - - dls - checkbox - button - stable ' : ' initial ' <nl> - } " <nl> + ui = " simple s stable " <nl> / > <nl> < / p > <nl> < p > value : { { pickedWithSimple } } < / p > <nl> 
mmm a / packages / veui / src / components / Pagination . vue <nl> ppp b / packages / veui / src / components / Pagination . vue <nl> config . defaults ( <nl> { <nl> - pageSize : 30 , <nl> - pageSizes : [ 30 , 50 , 100 ] <nl> + pageSize : 20 , <nl> + pageSizes : [ 20 , 50 , 100 ] <nl> } , <nl> ' pagination ' <nl> ) <nl> 
mmm a / packages / veui / src / utils / dom . js <nl> ppp b / packages / veui / src / utils / dom . js <nl> ) <nl> } <nl> - function getScrollportOffset ( elem ) { <nl> + function getScrollContainerOffset ( elem ) { <nl> let container = getScrollParent ( elem ) <nl> if ( ! container ) { <nl> @ @ - 213 , 7 + 213 , 7 @ @ export function scrollIntoView ( elem , forceToTop ) { <nl> return <nl> } <nl> - let { top } = getScrollportOffset ( elem ) <nl> + let { top } = getScrollContainerOffset ( elem ) <nl> if ( forceToTop ) { <nl> container . scrollTop = top <nl> 
mmm a / packages / veui - loader / src / index . js <nl> ppp b / packages / veui - loader / src / index . js <nl> new MagicString ( content ) , <nl> component , <nl> loaderOptions , <nl> - path = > { <nl> - return new Promise ( resolve = > { <nl> + ( path ) = > { <nl> + return new Promise ( ( resolve ) = > { <nl> try { <nl> this . resolve ( <nl> this . rootContext | | this . options . context , <nl> path , <nl> - err = > { <nl> + ( err ) = > { <nl> if ( err ) { <nl> resolve ( false ) <nl> return <nl> @ @ - 100 , 7 + 100 , 7 @ @ async function patchComponent ( content , component , options , resolve ) { <nl> let parts = getParts ( component , options ) <nl> await Promise . all ( <nl> - [ . . . parts . script , . . . parts . style ] . map ( async module = > { <nl> + [ . . . parts . script , . . . parts . style ] . map ( async ( module ) = > { <nl> module . valid = await assurePath ( module . path , resolve ) <nl> } ) <nl> ) <nl> @ @ - 120 , 7 + 120 , 7 @ @ function patchComponentSync ( content , component , options , resolveSync ) { <nl> let parts = getParts ( component , options ) <nl> let modules = [ . . . parts . script , . . . parts . style ] <nl> - modules . forEach ( module = > { <nl> + modules . forEach ( ( module ) = > { <nl> module . valid = assurePathSync ( module . path , resolveSync ) <nl> } ) <nl> @ @ - 158 , 9 + 158 , 9 @ @ function getParts ( component , options ) { <nl> if ( ! Array . isArray ( locale ) ) { <nl> locale = [ locale ] <nl> } <nl> - locale = locale . filter ( l = > typeof l = = = ' string ' ) <nl> + locale = locale . filter ( ( l ) = > typeof l = = = ' string ' ) <nl> modules = locale <nl> - . map ( l = > { <nl> + . map ( ( l ) = > { <nl> return { <nl> package : alias , <nl> path : ` locale / $ { l } ` , <nl> @ @ - 171 , 10 + 171 , 10 @ @ function getParts ( component , options ) { <nl> . concat ( modules ) <nl> global = locale <nl> - . map ( l = > { <nl> + . map ( ( l ) = > { <nl> return { path : ` $ { alias } / locale / $ { l } / common . js ` } <nl> } ) <nl> - . concat ( global . map ( path = > ( { path } ) ) ) <nl> + . concat ( global . map ( ( path ) = > ( { path } ) ) ) <nl> } <nl> return modules . reduce ( <nl> @ @ - 210 , 7 + 210 , 7 @ @ function getParts ( component , options ) { <nl> * @ returns { MagicString } Patched content <nl> * / <nl> function patchContent ( content , parts ) { <nl> - Object . keys ( parts ) . forEach ( type = > { <nl> + Object . keys ( parts ) . forEach ( ( type ) = > { <nl> let paths = parts [ type ] . filter ( ( { valid } ) = > valid ) . map ( ( { path } ) = > path ) <nl> return patchType ( content , type , paths ) <nl> } ) <nl> @ @ - 225 , 7 + 225 , 7 @ @ function patchContent ( content , parts ) { <nl> * / <nl> function pushPart ( parts , file ) { <nl> let ext = getExtname ( file . path ) <nl> - let type = Object . keys ( EXT_TYPES ) . find ( key = > { <nl> + let type = Object . keys ( EXT_TYPES ) . find ( ( key ) = > { <nl> return EXT_TYPES [ key ] . includes ( ext ) <nl> } ) <nl> parts [ type . toLowerCase ( ) ] . push ( file ) <nl> @ @ - 237 , 10 + 237 , 7 @ @ function pushPart ( parts , file ) { <nl> * @ returns { string } File extension <nl> * / <nl> function getExtname ( file ) { <nl> - return path <nl> - . extname ( file ) <nl> - . replace ( / \ . / g , ' ' ) <nl> - . toLowerCase ( ) <nl> + return path . extname ( file ) . replace ( / \ . / g , ' ' ) . toLowerCase ( ) <nl> } <nl> const RE_SCRIPT = / < script ( ? : \ s + [ ^ > ] * ) ? > / i <nl> @ @ - 254 , 10 + 251 , 10 @ @ const RE_SCRIPT = / < script ( ? : \ s + [ ^ > ] * ) ? > / i <nl> * / <nl> function patchType ( content , type , peerPaths ) { <nl> const code = content . toString ( ) <nl> - let normalizedPaths = peerPaths . map ( path = > slash ( normalize ( path ) ) ) <nl> + let normalizedPaths = peerPaths . map ( ( path ) = > slash ( normalize ( path ) ) ) <nl> switch ( type ) { <nl> case ' script ' : <nl> - let scriptImports = normalizedPaths . map ( path = > ` import ' $ { path } ' \ n ` ) <nl> + let scriptImports = normalizedPaths . map ( ( path ) = > ` import ' $ { path } ' \ n ` ) <nl> code . replace ( RE_SCRIPT , ( match , offset ) = > { <nl> const replacement = ` $ { match } \ n $ { scriptImports . join ( ' ' ) } ` <nl> content . overwrite ( offset , offset + match . length , replacement ) <nl> @ @ - 265 , 7 + 262 , 7 @ @ function patchType ( content , type , peerPaths ) { <nl> } ) <nl> break <nl> case ' style ' : <nl> - let styleImports = normalizedPaths . map ( path = > { <nl> + let styleImports = normalizedPaths . map ( ( path ) = > { <nl> let langStr = ' ' <nl> let ext = getExtname ( path ) <nl> if ( ext ! = = ' css ' ) { <nl> @ @ - 380 , 8 + 377 , 7 @ @ function resolveComponent ( file , options ) { <nl> / / not VEUI package <nl> ! isVEUI | | <nl> / / is dep but dep name isn ' t correct <nl> - ( isVEUI & & <nl> - path . basename ( path . dirname ( pkg ) ) = = = ' node_modules ' & & <nl> + ( path . basename ( path . dirname ( pkg ) ) = = = ' node_modules ' & & <nl> path . basename ( pkg ) ! = = alias ) <nl> ) { <nl> return null <nl> 
mmm a / packages / veui / test / unit / specs / components / Drawer . spec . js <nl> ppp b / packages / veui / test / unit / specs / components / Drawer . spec . js <nl> . find ( ' . veui - dialog - content - foot . veui - button : first - child ' ) <nl> . trigger ( ' click ' ) <nl> - await wait ( 400 ) <nl> + await wait ( 200 ) <nl> expect ( vm . open ) . to . equal ( true ) <nl> - await wait ( 500 ) <nl> + await wait ( 200 ) <nl> expect ( vm . open ) . to . equal ( false ) <nl> wrapper . destroy ( ) <nl> 
mmm a / packages / veui / src / components / Cascader / Cascader . vue <nl> ppp b / packages / veui / src / components / Cascader / Cascader . vue <nl> : column - width = " keyword ? null : columnWidth " <nl> : expanded = " realExpanded " <nl> - : load - data = " loadData & & ! keyword ? loadAndSaveData : null " <nl> + : load = " load & & ! keyword ? loadAndSaveData : null " <nl> @ update : expanded = " handlePaneUpdateExpanded " <nl> @ select = " handlePaneSelect " <nl> @ keydown . native = " ! searchable & & handleCascaderKeydown ( $ event ) " <nl> @ @ - 240 , 7 + 240 , 7 @ @ export default { <nl> return [ ' complete ' , ' simple ' ] . indexOf ( val ) > = 0 <nl> } <nl> } , <nl> - loadData : Function , <nl> + load : Function , <nl> inline : Boolean , <nl> max : Number <nl> } , <nl> @ @ - 405 , 9 + 405 , 12 @ @ export default { <nl> } <nl> } , <nl> methods : { <nl> - loadAndSaveData ( option , trigger ) { <nl> - return Promise . resolve ( this . loadData ( option , trigger ) ) . then ( ( loaded ) = > { <nl> - this . $ set ( this . loadedData , getKey ( option ) , loaded ) <nl> + loadAndSaveData ( context ) { <nl> + return Promise . resolve ( this . load ( context ) ) . then ( ( loaded ) = > { <nl> + if ( loaded ) { <nl> + this . $ set ( this . loadedData , getKey ( context . parent ) , loaded ) <nl> + } <nl> + return loaded <nl> } ) <nl> } , <nl> handleCascaderKeydown ( e ) { <nl> 
mmm a / packages / generator - nitro / generators / app / index . js <nl> ppp b / packages / generator - nitro / generators / app / index . js <nl> ] ) . then ( ( answers ) = > { <nl> this . _update = answers . update ; <nl> this . options . skipInstall = true ; <nl> - this . options . exampleCode = false ; <nl> if ( ! this . _update ) { <nl> return ; <nl> @ @ - 111 , 6 + 110 , 7 @ @ module . exports = class extends Generator { <nl> this . options . viewExt = config . viewExtension | | config . templateEngine ? config . templateEngine : this . options . viewExt ; <nl> this . options . templateEngine = config . templateEngine | | this . options . templateEngine ; <nl> this . options . clientTpl = typeof config . clientTemplates = = = ' boolean ' ? config . clientTemplates : this . options . clientTpl ; <nl> + this . options . exampleCode = typeof config . exampleCode = = = ' boolean ' ? config . exampleCode : this . options . exampleCode ; <nl> this . options . exporter = typeof config . exporter = = = ' boolean ' ? config . exporter : this . options . exporter ; <nl> this . options . name = _ . kebabCase ( this . options . name ) ; <nl> @ @ - 215 , 8 + 215 , 16 @ @ module . exports = class extends Generator { <nl> ' . npmignore ' , <nl> ] ; <nl> const ignoresOnUpdate = [ <nl> - / / files to ignore on updating projects <nl> + / / files and directories to ignore on updating projects <nl> ' config / local . js ' , <nl> + ' project / blueprints / ' , <nl> + ' project / routes / ' , <nl> + ' public / ' , <nl> + ' src / patterns / ' , <nl> + ' src / proto / css / ' , <nl> + ' src / proto / js / ' , <nl> + ' src / shared / ' , <nl> + ' src / views / ' , <nl> ] ; <nl> const clientTplFiles = [ <nl> / / files only for this . options . clientTpl = = = true <nl> @ @ - 291 , 7 + 299 , 7 @ @ module . exports = class extends Generator { <nl> / / exclude update ignores <nl> if ( this . _update ) { <nl> - if ( _ . indexOf ( ignoresOnUpdate , file ) ! = = - 1 ) { <nl> + if ( ignoresOnUpdate . some ( ( v ) = > file . indexOf ( v ) > = 0 ) ) { <nl> return ; <nl> } <nl> } <nl> 
mmm a / src / index . js <nl> ppp b / src / index . js <nl> } <nl> mainWindow = new BrowserWindow ( generateBrowserConfig ( ) ) ; <nl> - let newUserAgent = ' Mozilla / 5 . 0 ( Windows NT 10 . 0 ; Win64 ; x64 ; rv : 73 . 0 ) Gecko / 20100101 Firefox / 73 . 0 ' ; <nl> + const signInUserAgent = Settings . get ( ' overrideSignInUserAgent ' , ' Mozilla / 5 . 0 ( Windows NT 10 . 0 ; Win64 ; x64 ; rv : 73 . 0 ) Gecko / 20100101 Firefox / 73 . 0 ' ) ; <nl> - / / Spoof the user agent to bypass the sign in issue ( # 3545 ) <nl> + / / Spoof the user agent , this allows for future work arounds <nl> if ( Settings . get ( ' overrideUserAgent ' ) ) { <nl> - newUserAgent = Settings . get ( ' overrideUserAgent ' ) ; <nl> + mainWindow . webContents . session . setUserAgent ( ' overrideUserAgent ' ) ; <nl> } <nl> - const originalUserAgent = mainWindow . webContents . session . getUserAgent ( ) ; <nl> - mainWindow . webContents . session . setUserAgent ( newUserAgent ) ; <nl> - <nl> + / / Intercept all requests to accounts . google . com and hijack the UA <nl> mainWindow . webContents . session . webRequest . onBeforeSendHeaders ( { <nl> - urls : [ ' https : / / play . google . com / music / * ' ] , <nl> + urls : [ ' https : / / accounts . google . com / * ' ] , <nl> } , ( details , callback ) = > { <nl> const newRequestHeaders = Object . assign ( { } , ( details . requestHeaders | | { } ) , { <nl> - ' User - Agent ' : originalUserAgent , <nl> + ' User - Agent ' : signInUserAgent , <nl> } ) ; <nl> callback ( { requestHeaders : newRequestHeaders } ) ; <nl> } ) ; <nl> 
mmm a / src / NativeScript / Marshalling / Reference / ExtVectorTypeInstance . cpp <nl> ppp b / src / NativeScript / Marshalling / Reference / ExtVectorTypeInstance . cpp <nl> size_t arraySize = this - > _size ; <nl> # if defined ( __x86_64__ ) <nl> - if ( this - > _size % 2 & & isStructMember ) { <nl> - arraySize = this - > _size + 1 ; <nl> - } <nl> + / / We need isStructMember because double3 vectors are handled <nl> + / / differently in x86_64 . When a vector is a struct field <nl> + / / it is passed in memory but when not - the ST0 register is <nl> + / / used for the third element . In armv8 double3 vector will always <nl> + / / be passed in memory ( as it ' s size > 16 ) . <nl> + if ( this - > _size = = 3 & & isStructMember ) { <nl> # else <nl> - if ( this - > _size % 2 ) { <nl> - arraySize = this - > _size + 1 ; <nl> - } <nl> + / / For armv8 we always need to pass the array size <nl> + / / as the vector would fill a whole register in order <nl> + / / to calculate the proper flags value . <nl> + if ( this - > _size = = 3 ) { <nl> # endif <nl> + arraySize = 4 ; <nl> + } <nl> ffi_type * type = new ffi_type ( { . size = arraySize * innerFFIType - > size , . alignment = innerFFIType - > alignment , . type = FFI_TYPE_EXT_VECTOR } ) ; <nl> - type - > elements = new ffi_type * [ arraySize + 1 ] ; <nl> + type - > elements = new ffi_type * [ this - > _size + 1 ] ; <nl> - for ( size_t i = 0 ; i < arraySize ; i + + ) { <nl> + for ( size_t i = 0 ; i < this - > _size ; i + + ) { <nl> type - > elements [ i ] = innerFFIType ; <nl> } <nl> - type - > elements [ arraySize ] = nullptr ; <nl> + type - > elements [ this - > _size ] = nullptr ; <nl> this - > _extVectorType = type ; <nl> this - > _ffiTypeMethodTable . ffiType = type ; <nl> this - > _ffiTypeMethodTable . read = & read ; <nl> 
mmm a / src / NativeScript / JSErrors . mm <nl> ppp b / src / NativeScript / JSErrors . mm <nl> std : : string nativeStackTrace = getNativeStackTrace ( execState , exception ) ; <nl> - return setStackTraceProperty ( execState , exception , " JS : " + jsStackTrace + " \ nNative : " + nativeStackTrace ) ; <nl> + return setStackTraceProperty ( execState , exception , " JS : \ n " + jsStackTrace + " \ nNative : \ n " + nativeStackTrace ) ; <nl> } <nl> void reportErrorIfAny ( JSC : : ExecState * execState , JSC : : CatchScope & scope ) { <nl> 
mmm a / src / debugging / TNSDebugging . h <nl> ppp b / src / debugging / TNSDebugging . h <nl> # include < sys / types . h > <nl> - / / { N } CLI is relying on this message in order to receive the inspector port number . Please do not change it ! <nl> - / / Parsing regex is ' NativeScript debugger has opened inspector socket on port ( \ d + ) for ( . * ) \ . ' <nl> - / / It ' s defined in ' ios - log - parser - service . ts ' <nl> + / / { N } CLI is relying on these messages . Please do not change them ! <nl> # define LOG_DEBUGGER_PORT NSLog ( @ " NativeScript debugger has opened inspector socket on port % d for % @ . " , currentInspectorPort , [ [ NSBundle mainBundle ] bundleIdentifier ] ) <nl> - # define LOG_SUCCESSFULL_REFRESH NSLog ( @ " Successfully refreshed the application with RefreshRequest . " ) <nl> - # define LOG_FAILED_REFRESH NSLog ( @ " Failed to refresh the application with RefreshRequest . " ) <nl> + # define LOG_SUCCESSFULL_REFRESH NSLog ( @ " Successfully refreshed the application with RefreshRequest . " ) ; notify_post ( NOTIFICATION ( " AppRefreshSucceeded " ) ) <nl> + # define LOG_FAILED_REFRESH ( reason ) NSLog ( @ " Failed to refresh the application with RefreshRequest . Reason : % @ " , reason ) ; notify_post ( NOTIFICATION ( " AppRefreshFailed " ) ) <nl> / / Synchronization object for serializing access to inspector variable and data socket <nl> @ @ - 435 , 8 + 433 , 6 @ @ static void TNSEnableRemoteInspector ( int argc , char * * argv , <nl> notify_register_dispatch ( <nl> NOTIFICATION ( " RefreshRequest " ) , & refreshRequestSubscription , <nl> dispatch_get_main_queue ( ) , ^ ( int token ) { <nl> - @ try <nl> - { <nl> JSGlobalContextRef context = runtime . globalContext ; <nl> JSObjectRef globalObject = JSContextGetGlobalObject ( context ) ; <nl> JSStringRef liveSyncMethodName = JSStringCreateWithUTF8CString ( " __onLiveSync " ) ; <nl> @ @ - 444 , 21 + 440 , 26 @ @ static void TNSEnableRemoteInspector ( int argc , char * * argv , <nl> JSStringRelease ( liveSyncMethodName ) ; <nl> if ( JSValueIsUndefined ( context , liveSyncMethod ) ) <nl> { <nl> - LOG_FAILED_REFRESH ; <nl> + LOG_FAILED_REFRESH ( @ " __onLiveSync method not found . " ) ; <nl> + return ; <nl> } <nl> - JSValueRef result = JSObjectCallAsFunction ( context , ( JSObjectRef ) liveSyncMethod , NULL , 0 , NULL , NULL ) ; <nl> - if ( JSValueIsNull ( context , result ) ) <nl> + JSValueRef exception = NULL ; <nl> + JSObjectCallAsFunction ( context , ( JSObjectRef ) liveSyncMethod , NULL , 0 , NULL , & exception ) ; <nl> + if ( ! JSValueIsNull ( context , exception ) ) <nl> { <nl> - LOG_FAILED_REFRESH ; <nl> + JSStringRef exMessage = JSValueToStringCopy ( context , exception , NULL ) ; <nl> + long messageLength = JSStringGetLength ( exMessage ) + 1 ; <nl> + char * buffer = ( char * ) calloc ( messageLength , sizeof ( char ) ) ; <nl> + JSStringGetUTF8CString ( exMessage , buffer , messageLength ) ; <nl> + <nl> + NSString * reason = [ NSString stringWithFormat : @ " __onLiveSync failed with : % s " , buffer ] ; <nl> + LOG_FAILED_REFRESH ( reason ) ; <nl> + free ( buffer ) ; <nl> + return ; <nl> } <nl> LOG_SUCCESSFULL_REFRESH ; <nl> - } <nl> - @ catch ( NSException * exception ) <nl> - { <nl> - LOG_FAILED_REFRESH ; <nl> - } <nl> } ) ; <nl> int attachRequestSubscription ; <nl> 
mmm a / test / conversation . js <nl> ppp b / test / conversation . js <nl> CLIENT_ID , <nl> } from ' . / configs ' ; <nl> - import { hold , listen , sinon } from ' . / test - utils ' ; <nl> + import { listen , sinon } from ' . / test - utils ' ; <nl> describe ( ' Conversation ' , ( ) = > { <nl> let realtime ; <nl> @ @ - 414 , 17 + 414 , 6 @ @ describe ( ' Conversation ' , ( ) = > { <nl> } ) , <nl> ] ) ; <nl> } ) <nl> - . then ( ( ) = > { <nl> - bwangRealtime . pause ( ) ; <nl> - bwangRealtime . resume ( ) ; <nl> - const updateEventCallback = sinon . spy ( ) ; <nl> - bwang0 . on ( ' unreadmessagescountupdate ' , updateEventCallback ) ; <nl> - return listen ( bwang0 , ' reconnect ' ) <nl> - . then ( hold ( 1000 ) ) <nl> - . then ( ( ) = > { <nl> - updateEventCallback . should . not . be . called ( ) ; <nl> - } ) ; <nl> - } ) <nl> . then ( ( ) = > realtime . createIMClient ( bwangId ) ) <nl> . then ( bwang1 = > listen ( bwang1 , ' unreadmessagescountupdate ' ) <nl> . then ( ( [ [ conv ] ] ) = > { <nl> 
mmm a / src / connection . js <nl> ppp b / src / connection . js <nl> + import values from ' lodash / values ' ; <nl> import WebSocketPlus , { <nl> OPEN , <nl> DISCONNECT , <nl> @ @ - 59 , 7 + 60 , 7 @ @ export default class Connection extends WebSocketPlus { <nl> if ( waitingForRespond ) { <nl> if ( isIdempotentCommand ( command ) ) { <nl> buffer = command . toArrayBuffer ( ) ; <nl> - const duplicatedCommand = Object . values ( this . _commands ) . find ( <nl> + const duplicatedCommand = values ( this . _commands ) . find ( <nl> ( { buffer : targetBuffer , command : targetCommand } ) = > <nl> targetCommand . cmd = = = command . cmd & & <nl> targetCommand . op = = = command . op & & <nl> 
mmm a / lib / filters . js <nl> ppp b / lib / filters . js <nl> return Object . keys ( map ) . map ( key = > ( { x : key , y : map [ key ] , w : links [ key ] } ) ) ; <nl> } ; <nl> - export const browserFilter = data = > <nl> - data . map ( ( { x , y } ) = > ( { x : BROWSERS [ x ] | | x , y } ) ) . filter ( ( { x } ) = > x ) ; <nl> - <nl> - export const osFilter = data = > data . filter ( ( { x } ) = > x ) ; <nl> - <nl> - export const deviceFilter = data = > data . filter ( ( { x } ) = > x ) ; <nl> + export const browserFilter = data = > data . map ( ( { x , y } ) = > ( { x : BROWSERS [ x ] ? ? x , y } ) ) ; <nl> export const percentFilter = data = > { <nl> const total = data . reduce ( ( n , { y } ) = > n + y , 0 ) ; <nl> 
mmm a / src / modeling / primitives2d . js <nl> ppp b / src / modeling / primitives2d . js <nl> / / - - 2D primitives ( OpenSCAD like notion ) <nl> export function square ( ) { <nl> - var v = [ 1 , 1 ] , off ; var a = arguments , p = a [ 0 ] ; <nl> - if ( p & & ! p . size ) v = [ p , p ] ; <nl> - if ( p & & p . length ) v = a [ 0 ] , p = a [ 1 ] ; <nl> - if ( p & & p . size & & p . size . length ) v = p . size ; <nl> + let v = [ 1 , 1 ] <nl> + let off <nl> + let a = arguments <nl> + let p = a [ 0 ] <nl> - off = [ v [ 0 ] / 2 , v [ 1 ] / 2 ] ; <nl> - if ( p & & p . center = = true ) off = [ 0 , 0 ] ; <nl> + if ( p & & ! p . size ) v = [ p , p ] <nl> + if ( p & & p . length ) v = a [ 0 ] , p = a [ 1 ] <nl> + if ( p & & p . size & & p . size . length ) v = p . size <nl> - var o = CAG . rectangle ( { center : off , radius : [ v [ 0 ] / 2 , v [ 1 ] / 2 ] } ) ; <nl> + off = [ v [ 0 ] / 2 , v [ 1 ] / 2 ] <nl> + if ( p & & p . center = = = true ) off = [ 0 , 0 ] <nl> - return o ; <nl> + var o = CAG . rectangle ( { center : off , radius : [ v [ 0 ] / 2 , v [ 1 ] / 2 ] } ) <nl> + <nl> + return o <nl> } <nl> export function circle ( ) { <nl> - var r = 1 , off , fn = 32 ; var a = arguments , p = a [ 0 ] ; <nl> - if ( p & & p . r ) r = p . r ; <nl> - if ( p & & p . fn ) fn = p . fn ; <nl> - if ( p & & ! p . r & & ! p . fn & & ! p . center ) r = p ; <nl> - off = [ r , r ] ; <nl> - if ( p & & p . center = = true ) { off = [ 0 , 0 ] ; } <nl> - var o = CAG . circle ( { center : off , radius : r , resolution : fn } ) ; <nl> - return o ; <nl> + let r = 1 <nl> + let off <nl> + let fn = 32 <nl> + let a = arguments <nl> + let p = a [ 0 ] <nl> + if ( p & & p . r ) r = p . r <nl> + if ( p & & p . fn ) fn = p . fn <nl> + if ( p & & ! p . r & & ! p . fn & & ! p . center ) r = p <nl> + off = [ r , r ] <nl> + if ( p & & p . center = = = true ) { off = [ 0 , 0 ] } <nl> + var o = CAG . circle ( { center : off , radius : r , resolution : fn } ) <nl> + return o <nl> } <nl> export function polygon ( p ) { / / array of po ( ints ) and pa ( ths ) <nl> - var points = new Array ( ) ; <nl> + var points = [ ] <nl> if ( p . paths & & p . paths . length & & p . paths [ 0 ] . length ) { / / pa ( th ) : [ [ 0 , 1 , 2 ] , [ 2 , 3 , 1 ] ] ( two paths ) <nl> for ( var j = 0 ; j < p . paths . length ; j + + ) { <nl> for ( var i = 0 ; i < p . paths [ j ] . length ; i + + ) { <nl> - points [ i ] = p . points [ p . paths [ j ] [ i ] ] ; <nl> + points [ i ] = p . points [ p . paths [ j ] [ i ] ] <nl> } <nl> } <nl> } else if ( p . paths & & p . paths . length ) { / / pa ( th ) : [ 0 , 1 , 2 , 3 , 4 ] ( single path ) <nl> for ( var i = 0 ; i < p . paths . length ; i + + ) { <nl> - points [ i ] = p . points [ p . paths [ i ] ] ; <nl> + points [ i ] = p . points [ p . paths [ i ] ] <nl> } <nl> } else { / / pa ( th ) = po ( ints ) <nl> if ( p . length ) { <nl> - points = p ; <nl> + points = p <nl> } else { <nl> - points = p . points ; <nl> + points = p . points <nl> } <nl> } <nl> - return CAG . fromPoints ( points ) ; <nl> + return CAG . fromPoints ( points ) <nl> } <nl> export function triangle ( ) { / / - - new addition <nl> - var a = arguments ; <nl> - if ( a [ 0 ] & & a [ 0 ] . length ) a = a [ 0 ] ; <nl> - var o = CAG . fromPoints ( a ) ; <nl> - return o ; <nl> + var a = arguments <nl> + if ( a [ 0 ] & & a [ 0 ] . length ) a = a [ 0 ] <nl> + var o = CAG . fromPoints ( a ) <nl> + return o <nl> } <nl> 
mmm a / src / modeling / color . js <nl> ppp b / src / modeling / color . js <nl> return o . setColor ( c ) <nl> } <nl> - <nl> / / from http : / / axonflux . com / handy - rgb - to - hsl - and - rgb - to - hsv - color - model - c <nl> / * * <nl> * Converts an RGB color value to HSL . Conversion formula <nl> @ @ - 193 , 25 + 192 , 31 @ @ export function color ( ) { <nl> * @ param Number b The blue color value <nl> * @ return Array The HSL representation <nl> * / <nl> - function rgb2hsl ( r , g , b ) { <nl> + export function rgb2hsl ( r , g , b ) { <nl> if ( r . length ) { b = r [ 2 ] , g = r [ 1 ] , r = r [ 0 ] ; } <nl> - var max = Math . max ( r , g , b ) , min = Math . min ( r , g , b ) ; <nl> - var h , s , l = ( max + min ) / 2 ; <nl> + var max = Math . max ( r , g , b ) , min = Math . min ( r , g , b ) <nl> + var h , s , l = ( max + min ) / 2 <nl> if ( max = = min ) { <nl> - h = s = 0 ; / / achromatic <nl> + h = s = 0 / / achromatic <nl> } else { <nl> - var d = max - min ; <nl> - s = l > 0 . 5 ? d / ( 2 - max - min ) : d / ( max + min ) ; <nl> + var d = max - min <nl> + s = l > 0 . 5 ? d / ( 2 - max - min ) : d / ( max + min ) <nl> switch ( max ) { <nl> - case r : h = ( g - b ) / d + ( g < b ? 6 : 0 ) ; break ; <nl> - case g : h = ( b - r ) / d + 2 ; break ; <nl> - case b : h = ( r - g ) / d + 4 ; break ; <nl> + case r : <nl> + h = ( g - b ) / d + ( g < b ? 6 : 0 ) <nl> + break <nl> + case g : <nl> + h = ( b - r ) / d + 2 <nl> + break <nl> + case b : <nl> + h = ( r - g ) / d + 4 <nl> + break <nl> } <nl> - h / = 6 ; <nl> + h / = 6 <nl> } <nl> - return [ h , s , l ] ; <nl> + return [ h , s , l ] <nl> } <nl> / * * <nl> @ @ - 227 , 28 + 232 , 28 @ @ function rgb2hsl ( r , g , b ) { <nl> * / <nl> export function hsl2rgb ( h , s , l ) { <nl> if ( h . length ) { l = h [ 2 ] , s = h [ 1 ] , h = h [ 0 ] ; } <nl> - var r , g , b ; <nl> + var r , g , b <nl> if ( s = = 0 ) { <nl> - r = g = b = l ; / / achromatic <nl> + r = g = b = l / / achromatic <nl> } else { <nl> function hue2rgb ( p , q , t ) { <nl> - if ( t < 0 ) t + = 1 ; <nl> - if ( t > 1 ) t - = 1 ; <nl> - if ( t < 1 / 6 ) return p + ( q - p ) * 6 * t ; <nl> - if ( t < 1 / 2 ) return q ; <nl> - if ( t < 2 / 3 ) return p + ( q - p ) * ( 2 / 3 - t ) * 6 ; <nl> - return p ; <nl> + if ( t < 0 ) t + = 1 <nl> + if ( t > 1 ) t - = 1 <nl> + if ( t < 1 / 6 ) return p + ( q - p ) * 6 * t <nl> + if ( t < 1 / 2 ) return q <nl> + if ( t < 2 / 3 ) return p + ( q - p ) * ( 2 / 3 - t ) * 6 <nl> + return p <nl> } <nl> - var q = l < 0 . 5 ? l * ( 1 + s ) : l + s - l * s ; <nl> - var p = 2 * l - q ; <nl> - r = hue2rgb ( p , q , h + 1 / 3 ) ; <nl> - g = hue2rgb ( p , q , h ) ; <nl> - b = hue2rgb ( p , q , h - 1 / 3 ) ; <nl> + var q = l < 0 . 5 ? l * ( 1 + s ) : l + s - l * s <nl> + var p = 2 * l - q <nl> + r = hue2rgb ( p , q , h + 1 / 3 ) <nl> + g = hue2rgb ( p , q , h ) <nl> + b = hue2rgb ( p , q , h - 1 / 3 ) <nl> } <nl> - return [ r , g , b ] ; <nl> + return [ r , g , b ] <nl> } <nl> / * * <nl> @ @ - 265 , 24 + 270 , 30 @ @ export function hsl2rgb ( h , s , l ) { <nl> export function rgb2hsv ( r , g , b ) { <nl> if ( r . length ) { b = r [ 2 ] , g = r [ 1 ] , r = r [ 0 ] ; } <nl> - var max = Math . max ( r , g , b ) , min = Math . min ( r , g , b ) ; <nl> - var h , s , v = max ; <nl> + var max = Math . max ( r , g , b ) , min = Math . min ( r , g , b ) <nl> + var h , s , v = max <nl> - var d = max - min ; <nl> - s = max = = 0 ? 0 : d / max ; <nl> + var d = max - min <nl> + s = max = = 0 ? 0 : d / max <nl> if ( max = = min ) { <nl> - h = 0 ; / / achromatic <nl> + h = 0 / / achromatic <nl> } else { <nl> switch ( max ) { <nl> - case r : h = ( g - b ) / d + ( g < b ? 6 : 0 ) ; break ; <nl> - case g : h = ( b - r ) / d + 2 ; break ; <nl> - case b : h = ( r - g ) / d + 4 ; break ; <nl> + case r : <nl> + h = ( g - b ) / d + ( g < b ? 6 : 0 ) <nl> + break <nl> + case g : <nl> + h = ( b - r ) / d + 2 <nl> + break <nl> + case b : <nl> + h = ( r - g ) / d + 4 <nl> + break <nl> } <nl> - h / = 6 ; <nl> + h / = 6 <nl> } <nl> - return [ h , s , v ] ; <nl> + return [ h , s , v ] <nl> } <nl> / * * <nl> @ @ - 298 , 24 + 309 , 36 @ @ export function rgb2hsv ( r , g , b ) { <nl> * / <nl> export function hsv2rgb ( h , s , v ) { <nl> if ( h . length ) { v = h [ 2 ] , s = h [ 1 ] , h = h [ 0 ] ; } <nl> - var r , g , b ; <nl> + var r , g , b <nl> - var i = Math . floor ( h * 6 ) ; <nl> - var f = h * 6 - i ; <nl> - var p = v * ( 1 - s ) ; <nl> - var q = v * ( 1 - f * s ) ; <nl> - var t = v * ( 1 - ( 1 - f ) * s ) ; <nl> + var i = Math . floor ( h * 6 ) <nl> + var f = h * 6 - i <nl> + var p = v * ( 1 - s ) <nl> + var q = v * ( 1 - f * s ) <nl> + var t = v * ( 1 - ( 1 - f ) * s ) <nl> switch ( i % 6 ) { <nl> - case 0 : r = v , g = t , b = p ; break ; <nl> - case 1 : r = q , g = v , b = p ; break ; <nl> - case 2 : r = p , g = v , b = t ; break ; <nl> - case 3 : r = p , g = q , b = v ; break ; <nl> - case 4 : r = t , g = p , b = v ; break ; <nl> - case 5 : r = v , g = p , b = q ; break ; <nl> + case 0 : <nl> + r = v , g = t , b = p <nl> + break <nl> + case 1 : <nl> + r = q , g = v , b = p <nl> + break <nl> + case 2 : <nl> + r = p , g = v , b = t <nl> + break <nl> + case 3 : <nl> + r = p , g = q , b = v <nl> + break <nl> + case 4 : <nl> + r = t , g = p , b = v <nl> + break <nl> + case 5 : <nl> + r = v , g = p , b = q <nl> + break <nl> } <nl> - return [ r , g , b ] ; <nl> + return [ r , g , b ] <nl> } <nl> / * * <nl> @ @ - 326 , 15 + 349 , 15 @ @ export function hsv2rgb ( h , s , v ) { <nl> * - convert the HEX value into RGB values <nl> * / <nl> export function html2rgb ( s ) { <nl> - var r = 0 ; <nl> - var g = 0 ; <nl> - var b = 0 ; <nl> + var r = 0 <nl> + var g = 0 <nl> + var b = 0 <nl> if ( s . length = = 7 ) { <nl> - r = parseInt ( ' 0x ' + s . slice ( 1 , 3 ) ) / 255 ; <nl> - g = parseInt ( ' 0x ' + s . slice ( 3 , 5 ) ) / 255 ; <nl> - b = parseInt ( ' 0x ' + s . slice ( 5 , 7 ) ) / 255 ; <nl> + r = parseInt ( ' 0x ' + s . slice ( 1 , 3 ) ) / 255 <nl> + g = parseInt ( ' 0x ' + s . slice ( 3 , 5 ) ) / 255 <nl> + b = parseInt ( ' 0x ' + s . slice ( 5 , 7 ) ) / 255 <nl> } <nl> - return [ r , g , b ] ; <nl> + return [ r , g , b ] <nl> } <nl> / * * <nl> @ @ - 346 , 6 + 369 , 6 @ @ export function html2rgb ( s ) { <nl> export function rgb2html ( r , g , b ) { <nl> if ( r . length ) { b = r [ 2 ] , g = r [ 1 ] , r = r [ 0 ] ; } <nl> var s = ' # ' + <nl> - Number ( 0x1000000 + r * 255 * 0x10000 + g * 255 * 0x100 + b * 255 ) . toString ( 16 ) . substring ( 1 ) ; <nl> - return s ; <nl> + Number ( 0x1000000 + r * 255 * 0x10000 + g * 255 * 0x100 + b * 255 ) . toString ( 16 ) . substring ( 1 ) <nl> + return s <nl> } <nl> 
mmm a / src / modeling / meta . js <nl> ppp b / src / modeling / meta . js <nl> function version ( ) { <nl> - return [ 0 , 5 , 2 ] ; <nl> + return [ 0 , 5 , 2 ] <nl> } <nl> function JStoMeta ( src ) { <nl> - var l = src . split ( / \ n / ) ; <nl> - var n = 0 ; <nl> - var m = [ ] ; <nl> + var l = src . split ( / \ n / ) <nl> + var n = 0 <nl> + var m = [ ] <nl> for ( var i = 0 ; ; i + + ) { <nl> if ( l [ i ] . match ( / ^ \ / \ / \ s * ( \ S [ ^ : ] + ) : \ s * ( \ S . * ) / ) ) { <nl> - var k = RegExp . $ 1 ; <nl> - var v = RegExp . $ 2 ; <nl> - m [ k ] = v ; <nl> - n + + ; <nl> + var k = RegExp . $ 1 <nl> + var v = RegExp . $ 2 <nl> + m [ k ] = v <nl> + n + + <nl> } else { <nl> - if ( i > 5 & & n = = 0 ) <nl> - break ; <nl> + if ( i > 5 & & n = = = 0 ) <nl> + break <nl> else if ( n > 0 ) <nl> - break ; <nl> + break <nl> } <nl> } <nl> - return m ; <nl> + return m <nl> } <nl> function MetaToJS ( m ) { <nl> - var s = " " ; <nl> + var s = ' ' <nl> for ( var k in m ) { <nl> - s + = " / / " + k + " : " + m [ k ] + " \ n " ; <nl> + s + = ' / / ' + k + ' : ' + m [ k ] + ' \ n ' <nl> } <nl> - return s ; <nl> + return s <nl> } <nl> 
mmm a / src / modeling / clone . js <nl> ppp b / src / modeling / clone . js <nl> - if ( null = = obj | | ' object ' ! = typeof obj ) return obj <nl> + if ( obj = = = null | | typeof obj ! = = ' object ' ) return obj <nl> var copy = obj . constructor ( ) <nl> for ( var attr in obj ) { <nl> if ( obj . hasOwnProperty ( attr ) ) copy [ attr ] = obj [ attr ] <nl> 
mmm a / src / modeling / group . js <nl> ppp b / src / modeling / group . js <nl> - <nl> + / / FIXME : is this used anywhere ? <nl> export default function group ( ) { / / experimental <nl> var o <nl> var i = 0 <nl> var a = arguments <nl> if ( a [ 0 ] . length ) a = a [ 0 ] <nl> - if ( ( typeof ( a [ i ] ) = = ' object ' ) & & ( a [ i ] instanceof CAG ) ) { <nl> + if ( ( typeof ( a [ i ] ) = = = ' object ' ) & & ( a [ i ] instanceof CAG ) ) { <nl> o = a [ i ] . extrude ( { offset : [ 0 , 0 , 0 . 1 ] } ) / / - - convert a 2D shape to a thin solid , note : do not a [ i ] = a [ i ] . extrude ( ) <nl> } else { <nl> o = a [ i + + ] <nl> } <nl> for ( ; i < a . length ; i + + ) { <nl> var obj = a [ i ] <nl> - if ( ( typeof ( a [ i ] ) = = ' object ' ) & & ( a [ i ] instanceof CAG ) ) { <nl> + if ( ( typeof ( a [ i ] ) = = = ' object ' ) & & ( a [ i ] instanceof CAG ) ) { <nl> obj = a [ i ] . extrude ( { offset : [ 0 , 0 , 0 . 1 ] } ) / / - - convert a 2D shape to a thin solid : <nl> } <nl> o = o . unionForNonIntersecting ( obj ) <nl> 
mmm a / src / jscad / includeJscadSync . js <nl> ppp b / src / jscad / includeJscadSync . js <nl> xhr . open ( ' GET ' , url , false ) <nl> xhr . onload = function ( ) { <nl> var src = this . responseText <nl> - / / console . log ( ' src ' , src ) <nl> - / / eval ( src ) / / UGH ? ? ? <nl> resolve ( src ) <nl> } <nl> xhr . onerror = ( err ) = > reject ( err ) <nl> 
mmm a / src / jscad / replaceIncludes . js <nl> ppp b / src / jscad / replaceIncludes . js <nl> const withoutIncludes = replaceIncludesInAst ( moduleAst ) <nl> const modulePromises = foundIncludes . map ( function ( uri , index ) { <nl> - const promise = includeJscadSync ( relpath , uri , memFs ) <nl> - return promise . then ( function ( includedScript ) { <nl> - return replaceIncludes ( includedScript , relpath , memFs ) <nl> - } ) <nl> + return includeJscadSync ( relpath , uri , memFs ) <nl> + . then ( <nl> + includedScript = > replaceIncludes ( includedScript , relpath , memFs ) , <nl> + err = > console . error ( ' fail ' , err ) ) <nl> } ) <nl> Promise . all ( modulePromises ) . then ( function ( resolvedModules ) { <nl> const resolvedScript = resolvedModules . concat ( withoutIncludes ) . join ( ' \ n ' ) <nl> 
mmm a / src / jscad / replaceIncludes . js <nl> ppp b / src / jscad / replaceIncludes . js <nl> * inlined includes <nl> * this is more reliable than async xhr + eval ( ) <nl> * but is still just a temporary solution until using actual modules & loaders ( commonjs , es6 etc ) <nl> - * @ param { String } text the original script ( with include statements ) <nl> + * @ param { String } source the original script ( with include statements ) <nl> * @ param { String } relpath relative path , for xhr resolution <nl> * @ param { String } memFs memFs cache object <nl> * @ returns { String } the full script , with inlined <nl> * / <nl> - export function replaceIncludes ( text , relpath , memFs , includeResolver ) { <nl> + export function replaceIncludes ( source , relpath , memFs , includeResolver ) { <nl> return new Promise ( function ( resolve , reject ) { <nl> - const moduleAst = astFromSource ( text ) <nl> + const moduleAst = astFromSource ( source ) <nl> const foundIncludes = findIncludes ( moduleAst ) . map ( x = > x . value ) <nl> const withoutIncludes = replaceIncludesInAst ( moduleAst ) <nl> 
mmm a / src / io / convertToBlob . js <nl> ppp b / src / io / convertToBlob . js <nl> amf : ( object ) = > CSGToAMF ( object , meta ) , / / CSG to AMF <nl> stl : ( object ) = > CSGToStla ( object , { version } ) , / / CSG to STL ASCII <nl> stla : ( object ) = > CSGToStla ( object , { version } ) , / / CSG to STL ASCII <nl> - stlb : ( object ) = > CSGToStlb ( object , { webBlob : true , version } ) , / / CSG to STL BINARY <nl> + stlb : ( object ) = > CSGToStlb ( object , { version } ) , / / CSG to STL BINARY <nl> dxf : ( object ) = > CAGToDxf ( object , { version } ) , / / CAG to DXF <nl> svg : ( object ) = > CAGToSvg ( object , { version } ) , / / CAG to SVG <nl> - x3d : ( object ) = > CSGToX3D ( object . fixTJunctions ( ) , { version } ) , <nl> + x3d : ( object ) = > CSGToX3D ( object , { version } ) , / / . fixTJunctions ( ) <nl> json : ( object ) = > CAGToJson ( object , { version } ) , / / CSG or CAG to JSON <nl> js : ( object ) = > object , / / js , pass through <nl> jscad : ( object ) = > object , / / jscad , pass through <nl> 
mmm a / src / io / prepareOutput . js <nl> ppp b / src / io / prepareOutput . js <nl> import CAGToSvg from ' @ jscad / io / writers / CAGToSvg ' <nl> import CAGToJson from ' @ jscad / io / writers / CAGToJson ' <nl> import CAGToDxf from ' @ jscad / io / writers / CAGToDxf ' * / <nl> - import { CSGToStla } from ' @ jscad / io ' <nl> - import { CSGToStlb } from ' @ jscad / io ' <nl> - import { CSGToAMF } from ' @ jscad / io ' <nl> - import { CSGToX3D } from ' @ jscad / io ' <nl> - import { CAGToSvg } from ' @ jscad / io ' <nl> - import { CAGToJson } from ' @ jscad / io ' <nl> - import { CAGToDxf } from ' @ jscad / io ' <nl> + import { stlSerializer } from ' @ jscad / io ' <nl> + import { amfSerializer } from ' @ jscad / io ' <nl> + import { x3dSerializer } from ' @ jscad / io ' <nl> + import { svgSerializer } from ' @ jscad / io ' <nl> + import { jsonSerializer } from ' @ jscad / io ' <nl> + import { dxfSerializer } from ' @ jscad / io ' <nl> export function prepareOutput ( objects , params ) { <nl> const { format , version = ' 0 . 0 . 0 ' } = params <nl> @ @ - 34 , 33 + 33 , 33 @ @ export function prepareOutput ( objects , params ) { <nl> version <nl> } <nl> - / / helpers for jscad & js formats to align them with the other writers <nl> - const CSGToJscad = { <nl> - mimeType : formats [ ' jscad ' ] . mimetype , <nl> - write : object = > [ object ] / / js , pass through <nl> - } <nl> - const CSGToJs = { <nl> - mimeType : formats [ ' js ' ] . mimetype , <nl> - write : object = > [ object ] / / jscad , pass through <nl> - } <nl> const outputFormatHandlers = { <nl> - amf : CSGToAMF , / / CSG to AMF <nl> - stl : CSGToStla , / / CSG to STL ASCII <nl> - stla : CSGToStla , / / CSG to STL ASCII <nl> - stlb : CSGToStlb , / / CSG to STL BINARY <nl> - dxf : CAGToDxf , / / CAG to DXF <nl> - svg : CAGToSvg , / / CAG to SVG <nl> - x3d : CSGToX3D , / / CSG to X3D <nl> - json : CAGToJson , / / CSG or CAG to JSON <nl> - js : CSGToJs , / / js , pass through <nl> - jscad : CSGToJscad , / / jscad , pass through <nl> + amf : amfSerializer , / / CSG to AMF <nl> + stl : stlSerializer , / / CSG to STL ASCII / / NOTE : now using binary output by default ! ! <nl> + stla : { <nl> + mimeType : stlSerializer . mimeType , <nl> + serialize : data = > stlSerializer . serialize ( data , { binary : false } ) <nl> + } , / / CSG to STL ASCII <nl> + stlb : stlSerializer , / / CSG to STL BINARY <nl> + dxf : dxfSerializer , / / CAG to DXF <nl> + svg : svgSerializer , / / CAG to SVG <nl> + x3d : x3dSerializer , / / CSG to X3D <nl> + json : jsonSerializer , / / CSG or CAG to JSON <nl> + js : { <nl> + mimeType : formats [ ' js ' ] . mimetype , <nl> + serialize : object = > [ object ] / / jscad , pass through <nl> + } , <nl> + jscad : { <nl> + mimeType : formats [ ' jscad ' ] . mimetype , <nl> + serialize : object = > [ object ] / / js , pass through <nl> + } , <nl> undefined : ( ) = > { <nl> throw new Error ( ' Not supported : only jscad , stl , amf , dxf , svg or json as output format ' ) <nl> } <nl> } <nl> - const data = outputFormatHandlers [ format ] . write ( object , metaData ) <nl> + const data = outputFormatHandlers [ format ] . serialize ( object , metaData ) <nl> const mimeType = outputFormatHandlers [ format ] . mimeType <nl> return { data , mimeType } <nl> } <nl> 
mmm a / src / io / conversionWorker . js <nl> ppp b / src / io / conversionWorker . js <nl> const options = { version : data . version } <nl> switch ( e ) { <nl> case ' amf ' : <nl> - const parseAMF = require ( ' @ jscad / io ' ) . parseAMF <nl> - r . source = r . converted = parseAMF ( data . source , data . filename , options ) <nl> + const deserializeAmf = require ( ' @ jscad / io ' ) . amfDeSerializer <nl> + r . source = r . converted = deserializeAmf ( data . source , data . filename , options ) <nl> break <nl> case ' gcode ' : <nl> - const parseGCode = require ( ' @ jscad / io ' ) . parseGCode <nl> - r . source = r . converted = parseGCode ( data . source , data . filename , options ) <nl> + const deserializeGcode = require ( ' @ jscad / io ' ) . gcodeDeSerializer <nl> + r . source = r . converted = deserializeGcode ( data . source , data . filename , options ) <nl> break <nl> case ' obj ' : <nl> - const parseOBJ = require ( ' @ jscad / io ' ) . parseOBJ <nl> - r . source = r . converted = parseOBJ ( data . source , data . filename , options ) <nl> + const deserializeObj = require ( ' @ jscad / io ' ) . objDeSerializer <nl> + r . source = r . converted = deserializeObj ( data . source , data . filename , options ) <nl> break <nl> case ' scad ' : <nl> / / importScripts ( r . baseurl + ' js / lib / csg . js ' , r . baseurl + ' js / openjscad . js ' , r . baseurl + ' js / openscad . js ' , r . baseurl + ' js / lib / underscore . js ' , r . baseurl + ' js / lib / openscad - openjscad - translator . js ' ) <nl> @ @ - 65 , 8 + 65 , 8 @ @ module . exports = function ( self ) { <nl> r . converted = openscadOpenJscadParser . parse ( r . source ) <nl> break <nl> case ' stl ' : <nl> - const parseSTL = require ( ' @ jscad / io ' ) . parseSTL <nl> - r . source = r . converted = parseSTL ( data . source , data . filename , options ) <nl> + const deserializeStl = require ( ' @ jscad / io ' ) . stlDeSerializer <nl> + r . source = r . converted = deserializeStl ( data . source , data . filename , options ) <nl> break <nl> case ' js ' : <nl> r . source = r . converted = data . source <nl> @ @ - 75 , 12 + 75 , 12 @ @ module . exports = function ( self ) { <nl> r . source = r . converted = data . source <nl> break <nl> case ' svg ' : <nl> - const parseSVG = require ( ' @ jscad / io ' ) . parseSVG <nl> - r . source = r . converted = parseSVG ( data . source , data . filename , options ) <nl> + const deserializeSvg = require ( ' @ jscad / io ' ) . svgDeSerializer <nl> + r . source = r . converted = deserializeSvg ( data . source , data . filename , options ) <nl> break <nl> case ' json ' : <nl> - const parseJSON = require ( ' @ jscad / io ' ) . parseJSON <nl> - r . source = r . converted = parseJSON ( data . source , data . filename , options ) <nl> + const deserializeJson = require ( ' @ jscad / io ' ) . jsonDeSerializer <nl> + r . source = r . converted = deserializeJson ( data . source , data . filename , options ) <nl> break <nl> default : <nl> r . source = r . converted = ' / / Invalid file type in conversion ( ' + e + ' ) ' <nl> 
mmm a / src / ui / dragDrop / walkFileTree . js <nl> ppp b / src / ui / dragDrop / walkFileTree . js <nl> const reader = new FileReader ( ) <nl> return new Promise ( function ( resolve , reject ) { <nl> - isBinaryFile ? reader . readAsBinaryString ( file , ' UTF - 8 ' ) : reader . readAsText ( file , ' UTF - 8 ' ) <nl> - <nl> + reader . readAsArrayBuffer ( file ) <nl> / / remove rootfolder since all files are within it <nl> const fullpath = fileMeta & & fileMeta . fullPath ? fileMeta . fullPath . split ( ' / ' ) . slice ( 2 ) . join ( ' / ' ) : ' ' <nl> + / / convert binary to text <nl> + function convert ( buffer ) { <nl> + let binary = ' ' <nl> + const bytes = new Uint8Array ( buffer ) <nl> + let length = bytes . byteLength <nl> + for ( let i = 0 ; i < length ; i + + ) { <nl> + binary + = String . fromCharCode ( bytes [ i ] ) <nl> + } <nl> + return binary <nl> + } <nl> + <nl> reader . onloadend = event = > { <nl> event . target . readyState = = = FileReader . DONE <nl> - ? resolve ( { name : file . name , fullpath : fullpath , source : event . target . result } ) <nl> - : reject ( ' Failed to load file ' ) <nl> + ? resolve ( { name : file . name , fullpath : fullpath , source : convert ( event . target . result ) } ) <nl> + : reject ( new Error ( ' Failed to load file ' ) ) <nl> } <nl> } ) <nl> } <nl> @ @ - 86 , 17 + 96 , 3 @ @ function processDirectory ( directory ) { <nl> export function walkFileTree ( items ) { <nl> return processItems ( items ) <nl> } <nl> - <nl> - export function afterFilesRead ( { memFs , memFsCount , memFsTotal , memFsChanged } , files ) { <nl> - memFsCount = files . length <nl> - memFsTotal = files . length <nl> - <nl> - / / FIXME : THIRD time the SAME data is cached <nl> - / / saveScript ( memFs , file . name , file . source ) <nl> - const mainFile = findMainFile ( { memFs , memFsTotal } , files ) <nl> - <nl> - if ( changedFiles ( memFs , files ) . length > 0 ) { <nl> - if ( ! mainFile ) throw new Error ( ' No main . jscad found ' ) <nl> - setCurrentFile ( mainFile ) / / ARGH , cannot do this here <nl> - } <nl> - } <nl> 
mmm a / packages / io / stl - serializer / CSGToStlb . js <nl> ppp b / packages / io / stl - serializer / CSGToStlb . js <nl> let triangleUint16array = new Uint16Array ( triangleBuffer , 48 , 1 ) <nl> let byteoffset = 0 <nl> - let p = 0 <nl> + <nl> objects . forEach ( ( object ) = > { <nl> let polygons = geometry . geom3 . toPolygons ( object ) <nl> - polygons . forEach ( ( polygon ) = > { <nl> + polygons . forEach ( ( polygon , index ) = > { <nl> let vertices = polygon . vertices <nl> let numvertices = vertices . length <nl> let plane = polygon . plane <nl> @ @ - 75 , 8 + 75 , 8 @ @ const serializeBinary = ( objects , options ) = > { <nl> allTrianglesBufferAsInt8 . set ( triangleBufferAsInt8 , byteoffset ) <nl> byteoffset + = 50 <nl> } <nl> - p + = 1 <nl> - options . statusCallback & & options . statusCallback ( { progress : 100 * p / numpolygons } ) <nl> + <nl> + options . statusCallback & & options . statusCallback ( { progress : 100 * index / numpolygons } ) <nl> } ) <nl> } ) <nl> options . statusCallback & & options . statusCallback ( { progress : 100 } ) <nl> 
mmm a / packages / cli / src / generateOutputData . js <nl> ppp b / packages / cli / src / generateOutputData . js <nl> / / convert any inputs <nl> const prevsource = source <nl> const deserializerOptions = Object . assign ( { } , params , options ) <nl> - source = conversionTable [ inputFormat ] ( { source , params , options : deserializerOptions } ) <nl> + source = conversionTable [ inputFormat ] ( { source , options : deserializerOptions } ) <nl> const useFakeFs = ( source ! = = prevsource ) / / conversion , so use a fake file system when rebuilding <nl> if ( outputFormat = = = ' jscad ' | | outputFormat = = = ' js ' ) { <nl> 
mmm a / consumables / scss / components / fab / fab . scss <nl> ppp b / consumables / scss / components / fab / fab . scss <nl> @ import ' . . / . . / global / helpers ' ; <nl> @ import ' . . / . . / global / layout / grid ' ; <nl> - @ import ' vars ' ; <nl> @ import ' . . / . . / import - once ' ; <nl> @ include exports ( ' fab ' ) { <nl> . bx - - fab__hexagon { <nl> transition : fill $ transition - - base ; <nl> - fill : $ color__fab - hexagon ; <nl> + fill : $ color__blue - 40 ; <nl> } <nl> . bx - - fab__plus - icon { <nl> @ include rotate ( 0 , $ transition - - base ) ; <nl> - fill : $ color__fab - plus - icon ; <nl> + fill : $ color__white ; <nl> } <nl> } <nl> . bx - - fab__hexagon { <nl> transition : fill $ transition - - base ; <nl> - fill : $ color__fab - hexagon - - is - closed ; <nl> + fill : $ color__navy - gray - 5 ; <nl> } <nl> . bx - - fab__plus - icon { <nl> 
mmm a / consumables / scss / components / tooltips / tooltips . scss <nl> ppp b / consumables / scss / components / tooltips / tooltips . scss <nl> @ import ' . . / . . / global / typography / typography ' ; <nl> @ import ' . . / . . / global / layout / grid ' ; <nl> - @ import ' vars ' ; <nl> @ import ' . . / . . / import - once ' ; <nl> @ include exports ( ' tooltips ' ) { <nl> 
mmm a / consumables / scss / components / inline - left - nav / inline - left - nav . scss <nl> ppp b / consumables / scss / components / inline - left - nav / inline - left - nav . scss <nl> @ include font - size ( ' 14 ' ) ; <nl> @ include light - ui { <nl> - color : $ color__navy - gray - 3 ; <nl> + color : $ color__blue - 90 ; <nl> } <nl> box - sizing : border - box ; <nl> & - link { <nl> @ include font - size ( ' 14 ' ) ; <nl> @ include light - ui { <nl> - color : $ color__navy - gray - 3 ; <nl> + color : $ color__blue - 90 ; <nl> } <nl> color : $ color__white ; <nl> padding : . 75rem 1 . 35rem . 75rem 4 . 5rem ; <nl> @ include light - ui { <nl> color : $ color__blue - 40 ; <nl> } <nl> - color : $ color__blue - 20 ; <nl> + color : $ color__blue - 30 ; <nl> & > . bx - - inline - left - nav__icon { <nl> @ include light - ui { <nl> fill : $ color__blue - 40 ; <nl> } <nl> - fill : $ color__blue - 20 ; <nl> + fill : $ color__blue - 30 ; <nl> } <nl> } <nl> 
mmm a / src / features / visualization / Visualization . module . css <nl> ppp b / src / features / visualization / Visualization . module . css <nl> } <nl> - : global ( . darkTheme ) . viz - change - icon - container { <nl> - color : white ; <nl> - fill : white ; <nl> + : global ( . darkTheme ) . viz : global ( . viz - change - icon - container ) { <nl> + color : white ! important ; <nl> + fill : white ! important ; <nl> } <nl> \ No newline at end of file <nl> 
mmm a / src / features / visualization / d3 - viz / setup - annotations . js <nl> ppp b / src / features / visualization / d3 - viz / setup - annotations . js <nl> . classed ( ' svg - icon ' , true ) <nl> . classed ( ' nag ' , true ) <nl> . style ( ' font - size ' , ( d ) = > ( 3 * d . height * fontScale ) + " % " ) <nl> - . text ( ' \ uf06a ' ) ; <nl> + . text ( ' \ uf06a ' ) ; / / font - awesome <nl> annotations <nl> . select ( ` g . $ { className ( " change - icon - container " ) } ` ) <nl> @ @ - 49 , 6 + 49 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) ) <nl> . attr ( ' y ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) ) <nl> . on ( " click " , ( d ) = > { <nl> + / / Brings up Ring - menu on click <nl> const annotation = selectAll ( ` g . $ { className ( " annotation " ) } [ data - key = " $ { datumKey ( d ) } " ] ` ) ; <nl> annotation <nl> @ @ - 119 , 7 + 120 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . classed ( className ( " node " ) , true ) <nl> . append ( ' circle ' ) <nl> . attr ( ' r ' , ( d ) = > 2 * d . height * leafRadius ) <nl> - . attr ( ' cx ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) - 3 . 5 * d . height * leafRadius ) <nl> + . attr ( ' cx ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) - 0 * d . height * leafRadius ) <nl> . attr ( ' cy ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) - 10 * d . height * leafRadius ) ; <nl> annotations <nl> @ @ - 155 , 7 + 156 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . append ( " text " ) <nl> . classed ( className ( " annotation - text " ) , true ) <nl> . style ( ' font - size ' , ( d ) = > ( 2 * d . height * fontScale ) + " % " ) <nl> - . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 3 . 5 * d . height * leafRadius ) <nl> + . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 7 * d . height * leafRadius ) <nl> . attr ( ' y ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) - 10 * d . height * leafRadius ) ; <nl> annotations <nl> @ @ - 235 , 7 + 236 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . classed ( className ( " isChanged - fixed " ) , true ) <nl> . append ( ' circle ' ) <nl> . attr ( ' r ' , ( d ) = > 2 * d . height * leafRadius ) <nl> - . attr ( ' cx ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) - 3 . 5 * d . height * leafRadius ) <nl> + . attr ( ' cx ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) - 0 * d . height * leafRadius ) <nl> . attr ( ' cy ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) + 10 * d . height * leafRadius ) ; <nl> annotations <nl> @ @ - 279 , 7 + 280 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . append ( " text " ) <nl> . classed ( className ( " annotation - text " ) , true ) <nl> . style ( ' font - size ' , ( d ) = > ( 2 * d . height * fontScale ) + " % " ) <nl> - . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + d . height * leafRadius ) <nl> + . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 7 * d . height * leafRadius ) <nl> . attr ( ' y ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) + 10 * d . height * leafRadius ) ; <nl> annotations <nl> @ @ - 297 , 7 + 298 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . classed ( className ( " isRemoved - fixed " ) , true ) <nl> . append ( ' circle ' ) <nl> . attr ( ' r ' , ( d ) = > 2 * d . height * leafRadius ) <nl> - . attr ( ' cx ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 6 . 5 * d . height * leafRadius ) <nl> + . attr ( ' cx ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 7 . 5 * d . height * leafRadius ) <nl> . attr ( ' cy ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) ) ; <nl> annotations <nl> @ @ - 341 , 7 + 342 , 7 @ @ const setupAnnotations = ( { packedData , annotationRoot } ) = > { <nl> . append ( " text " ) <nl> . classed ( className ( " annotation - text " ) , true ) <nl> . style ( ' font - size ' , ( d ) = > ( 2 * d . height * fontScale ) + " % " ) <nl> - . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 13 * d . height * leafRadius ) <nl> + . attr ( ' x ' , ( d ) = > ( getEdgePositionX ( d . r , baseAngle ( d ) ) ) + 14 * d . height * leafRadius ) <nl> . attr ( ' y ' , ( d ) = > ( getEdgePositionY ( d . r , baseAngle ( d ) ) ) ) ; <nl> annotations <nl> 
mmm a / src / features / visualization / Visualization . module . css <nl> ppp b / src / features / visualization / Visualization . module . css <nl> } <nl> + : global ( . darkTheme ) . viz : global ( . viz - label ) { <nl> + fill : rgba ( 255 , 255 , 255 , 0 . 836 ) ; / * darken white to reduce contrasting * / <nl> + text - anchor : middle ; <nl> + dominant - baseline : alphabetical ; <nl> + } <nl> + <nl> . viz : global ( . viz - labelShape ) { <nl> fill : black ; <nl> opacity : 0 . 25 ; <nl> fill : black ; <nl> } <nl> + <nl> : global ( . darkTheme ) . viz : global ( . viz - change - icon - container ) { <nl> color : white ! important ; <nl> fill : white ! important ; <nl> 
mmm a / src / features / visualization / Visualization . module . css <nl> ppp b / src / features / visualization / Visualization . module . css <nl> } * / <nl> + @ keyframes fadein { <nl> + from { opacity : 0 ; } <nl> + to { opacity : 1 ; } <nl> + } <nl> + <nl> + / * Firefox < 16 * / <nl> + @ - moz - keyframes fadein { <nl> + from { opacity : 0 ; } <nl> + to { opacity : 1 ; } <nl> + } <nl> + <nl> + / * Safari , Chrome and Opera > 12 . 1 * / <nl> + @ - webkit - keyframes fadein { <nl> + from { opacity : 0 ; } <nl> + to { opacity : 1 ; } <nl> + } <nl> + <nl> + / * Internet Explorer * / <nl> + @ - ms - keyframes fadein { <nl> + from { opacity : 0 ; } <nl> + to { opacity : 1 ; } <nl> + } <nl> + <nl> / * Ring Menu * / <nl> . viz : global ( . viz - ring - menu ) { <nl> - visibility : visible ; <nl> - opacity : 1 ; <nl> - transition : opacity 5s ease - in - out ; <nl> - - webkit - transition : opacity 5s ease - in - out ; <nl> - - moz - transition : opacity 5s ease - in - out ; <nl> + - webkit - animation : fadein 1s ; / * Safari , Chrome and Opera > 12 . 1 * / <nl> + - moz - animation : fadein 1s ; / * Firefox < 16 * / <nl> + - ms - animation : fadein 1s ; / * Internet Explorer * / <nl> + - o - animation : fadein 1s ; / * Opera < 12 . 1 * / <nl> + animation : fadein 1s ; <nl> } <nl> . viz : global ( circle . viz - bg - circle ) { <nl> 
mmm a / index . js <nl> ppp b / index . js <nl> } <nl> Peer . prototype . _onInterval = function ( ) { <nl> - if ( ! this . _cb | | ! this . _channel | | this . _channel . bufferedAmount > MAX_BUFFERED_AMOUNT ) { <nl> + var self = this <nl> + if ( ! self . _cb | | ! self . _channel | | self . _channel . bufferedAmount > MAX_BUFFERED_AMOUNT ) { <nl> return <nl> } <nl> - this . _onChannelBufferedAmountLow ( ) <nl> + self . _onChannelBufferedAmountLow ( ) <nl> } <nl> Peer . prototype . _onSignalingStateChange = function ( ) { <nl> 
mmm a / src / routes / index . svelte <nl> ppp b / src / routes / index . svelte <nl> export async function load ( ) { <nl> const posts = import . meta . globEager ( ' . . / sheets / * . md ' ) <nl> + <nl> + / / for ( const path in posts ) { <nl> + / / console . log ( path ) <nl> + / / } <nl> + <nl> const postsList = Object . values ( posts ) <nl> const postsMeta = postsList . map ( post = > { <nl> return post . metadata <nl> < ul > <nl> { # each posts as post } <nl> { # if post . published } <nl> - < li > <nl> + < li <nl> + class = " text - 4xl font - medium my - 5 hover : underline hover : text - purple - 600 " <nl> + > <nl> < a sveltekit : prefetch href = { ` / $ { post . slug } ` } > { post . title } < / a > <nl> < / li > <nl> { / if } <nl> 
mmm a / src / lib / table - of - contents . svelte <nl> ppp b / src / lib / table - of - contents . svelte <nl> Table of Contents <nl> < / h3 > <nl> - < ul class = " h - 72 overflow - auto " > <nl> + < ul class = " max - h - 72 overflow - auto " > <nl> { # each headings as heading } <nl> < li class = " mb - 2 " key = { ` heading - $ { heading . href } ` } > <nl> < a href = { heading . href } > { heading . label } < / a > <nl> 
mmm a / src / routes / index . svelte <nl> ppp b / src / routes / index . svelte <nl> bind : value = { query } <nl> placeholder = " Search " <nl> - class = " input input - primary input - bordered text - xl " <nl> + class = " input input - primary input - bordered text - xl mb - 10 " <nl> / > <nl> < / div > <nl> + < ul <nl> + class = " mb - 10 grid gap - 5 grid - cols - 1 xs : grid - cols - 2 md : grid - cols - 3 " <nl> + > <nl> { # if results . length = = = 0 } <nl> - < ul > <nl> { # each sheets as sheet } <nl> { # if sheet . published } <nl> - < li class = " font - medium my - 5 text - 4xl " > <nl> + < li <nl> + class = " font - medium text - 3xl border border - primary rounded - 2xl p - 5 " <nl> + > <nl> < a class = " link " sveltekit : prefetch href = { ` / $ { sheet . slug } ` } <nl> > { sheet . title } < / a <nl> > <nl> < / li > <nl> { / if } <nl> { / each } <nl> - < / ul > <nl> { : else } <nl> { # each results as result } <nl> - < ul > <nl> < li class = " font - medium my - 5 text - 4xl " > <nl> < a class = " link " sveltekit : prefetch href = { result . item . slug } > <nl> { result . item . title } <nl> < / a > <nl> < / li > <nl> - < / ul > <nl> { / each } <nl> { / if } <nl> + < / ul > <nl> 
mmm a / src / lib / author . svelte <nl> ppp b / src / lib / author . svelte <nl> > <nl> < div class = " flex space - x - 5 justify - evenly " > <nl> - < a href = { data . html_url } target = " _blank " rel = " noopener " > <nl> + < a <nl> + class = " w - 1 / 4 " <nl> + href = { data . html_url } <nl> + target = " _blank " <nl> + rel = " noopener " <nl> + > <nl> < img <nl> - class = " w - 20 h - 20 p - 0 m - 0 rounded - full " <nl> + class = " w - 20 h - 20 p - 0 m - 0 rounded - full object - cover " <nl> src = { data . avatar_url } <nl> alt = { data . name } <nl> / > <nl> < / a > <nl> - < a href = { data . html_url } target = " _blank " rel = " noopener " > <nl> + < a <nl> + class = " w - 3 / 4 " <nl> + href = { data . html_url } <nl> + target = " _blank " <nl> + rel = " noopener " <nl> + > <nl> < div class = " text - sm " > <nl> < p class = " text - lg font - bold tracking - widest " > { data . name } < / p > <nl> < p > { data . bio | | ` ` } < / p > <nl> 
mmm a / src / modules / Embed / index . d . ts <nl> ppp b / src / modules / Embed / index . d . ts <nl> interface EmbedProps { <nl> - / * * An embed can be active . * / <nl> - active ? : boolean ; <nl> + [ key : string ] : any ; <nl> / * * An element type to render as ( string or function ) . * / <nl> as ? : any ; <nl> + / * * An embed can be active . * / <nl> + active ? : boolean ; <nl> + <nl> / * * An embed can specify an alternative aspect ratio . * / <nl> aspectRatio ? : ' 4 : 3 ' | ' 16 : 9 ' | ' 21 : 9 ' ; <nl> @ @ - 16 , 6 + 18 , 9 @ @ interface EmbedProps { <nl> / * * Whether to show networks branded UI like title cards , or after video calls to action . * / <nl> brandedUI ? : boolean ; <nl> + / * * Primary content . * / <nl> + children ? : React . ReactNode ; <nl> + <nl> / * * Additional classes . * / <nl> className ? : string ; <nl> @ @ - 40 , 7 + 45 , 7 @ @ interface EmbedProps { <nl> * @ param { SyntheticEvent } event - React ' s original SyntheticEvent . <nl> * @ param { object } data - All props and proposed value . <nl> * / <nl> - onClick ? : ( e : React . FormEvent < HTMLVideoElement > , data : this ) = > void ; <nl> + onClick ? : ( event : React . MouseEvent < HTMLDivElement > , data : EmbedProps ) = > void ; <nl> / * * A placeholder image for embed . * / <nl> placeholder ? : string ; <nl> 
mmm a / docs / app / Examples / collections / Form / Shorthand / index . js <nl> ppp b / docs / app / Examples / collections / Form / Shorthand / index . js <nl> title = ' Field with Custom Control ' <nl> description = { [ <nl> ' Render a field containing a label and custom form control . ' , <nl> - ' Use any component form any library , or your own . ' , <nl> + ' Use any component from any library , or your own . ' , <nl> ] . join ( ' ' ) } <nl> examplePath = ' collections / Form / Shorthand / FormExampleFieldControl ' <nl> > <nl> 
mmm a / static . webpack . js <nl> ppp b / static . webpack . js <nl> test : / \ . js $ / , <nl> include : [ <nl> / / Heads up ! <nl> - / / There modules should be manually transipiled because they are not compatible with IE11 <nl> + / / There modules should be manually transpiled because they are not compatible with IE11 <nl> path . resolve ( __dirname , ' node_modules / ansi - styles ' ) , <nl> path . resolve ( __dirname , ' node_modules / debug ' ) , <nl> 
mmm a / src / components / layout / addons / AddonsLayout . js <nl> ppp b / src / components / layout / addons / AddonsLayout . js <nl> border - radius : 100 % ; <nl> overflow : hidden ; <nl> outline : none ; <nl> - <nl> + cursor : pointer ; <nl> font - size : 10px ; <nl> line - height : 1 ; <nl> position : absolute ; <nl> @ @ - 123 , 6 + 123 , 7 @ @ const SearchInput = styled ( Input ) ` <nl> padding - left : 36px ; <nl> padding - top : 10px ; <nl> padding - bottom : 10px ; <nl> + padding - right : 30px ; <nl> & : : - webkit - search - cancel - button , <nl> & : : - webkit - search - decoration { <nl> 
mmm a / src / library / r6rs_lib . js <nl> ppp b / src / library / r6rs_lib . js <nl> import { BiwaSymbol , Sym , gensym } from " . . / system / symbol . js " <nl> import Values from " . . / system / values . js " <nl> - / / <nl> - / / R6RS Base library <nl> - / / <nl> - <nl> / / / <nl> / / / R6RS Base library <nl> / / / <nl> 
mmm a / src / Badge . js <nl> ppp b / src / Badge . js <nl> cssModule , <nl> color , <nl> pill , <nl> - tag : Component , <nl> + tag : Tag , <nl> . . . attributes <nl> } = props ; <nl> @ @ - 35 , 7 + 35 , 7 @ @ const Badge = ( props ) = > { <nl> ) , cssModule ) ; <nl> return ( <nl> - < Component { . . . attributes } className = { classes } / > <nl> + < Tag { . . . attributes } className = { classes } / > <nl> ) ; <nl> } ; <nl> 
mmm a / lib / module . js <nl> ppp b / lib / module . js <nl> const { resolve } = require ( ' path ' ) <nl> + const firebase = require ( ' firebase ' ) <nl> const logger = require ( ' . / logger ' ) <nl> const createServerMiddleware = require ( ' . / helpers / createServerMiddleware ' ) <nl> 
mmm a / lib / plugins / main . js <nl> ppp b / lib / plugins / main . js <nl> < % if ( options . services . performance ) { % > <nl> / * * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * * / <nl> - / * * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - FIREBASE REALTIME DB - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * * / <nl> + / * * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - FIREBASE PERFORMANCE - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * * / <nl> / * * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * * / <nl> / / Firebase Performance can only be initiated on client side <nl> 
mmm a / lib / templates / firebase - auth - sw . js <nl> ppp b / lib / templates / firebase - auth - sw . js <nl> const getIdToken = ( ) = > { <nl> return new Promise ( ( resolve ) = > { <nl> const unsubscribe = firebase . auth ( ) . onAuthStateChanged ( ( user ) = > { <nl> - unsubscribe ( ) ; <nl> + unsubscribe ( ) <nl> if ( user ) { <nl> / / force token refresh as it might be used to sign in server side <nl> user . getIdToken ( true ) . then ( ( idToken ) = > { <nl> - resolve ( idToken ) ; <nl> + resolve ( idToken ) <nl> } , ( ) = > { <nl> - resolve ( null ) ; <nl> - } ) ; <nl> + resolve ( null ) <nl> + } ) <nl> } else { <nl> - resolve ( null ) ; <nl> + resolve ( null ) <nl> + } <nl> + } ) <nl> + } ) <nl> } <nl> - } ) ; <nl> - } ) ; <nl> - } ; <nl> const fetchWithAuthorization = async ( original , idToken ) = > { <nl> / / Clone headers as request headers are immutable . <nl> - const headers = new Headers ( ) ; <nl> + const headers = new Headers ( ) <nl> for ( let entry of original . headers . entries ( ) ) { <nl> - headers . append ( entry [ 0 ] , entry [ 1 ] ) ; <nl> + headers . append ( entry [ 0 ] , entry [ 1 ] ) <nl> } <nl> / / Add ID token to header . <nl> - headers . append ( ' Authorization ' , ' Bearer ' + idToken ) ; <nl> + headers . append ( ' Authorization ' , ' Bearer ' + idToken ) <nl> / / Create authorized request <nl> - const { url , . . . props } = original . clone ( ) ; <nl> + const { url , . . . props } = original . clone ( ) <nl> const authorized = new Request ( url , { <nl> . . . props , <nl> mode : ' same - origin ' , <nl> redirect : ' manual ' , <nl> headers <nl> - } ) ; <nl> + } ) <nl> return fetch ( authorized ) <nl> - } ; <nl> + } <nl> self . addEventListener ( ' fetch ' , ( event ) = > { <nl> - const url = new URL ( event . request . url ) ; <nl> + const url = new URL ( event . request . url ) <nl> const expectsHTML = event . request . headers . get ( ' accept ' ) . includes ( ' text / html ' ) <nl> - const isSameOrigin = self . location . origin = = = url . origin ; <nl> - const isHttps = ( self . location . protocol = = = ' https : ' | | self . location . hostname = = = ' localhost ' ) ; <nl> + const isSameOrigin = self . location . origin = = = url . origin <nl> + const isHttps = ( self . location . protocol = = = ' https : ' | | self . location . hostname = = = ' localhost ' ) <nl> const isIgnored = ignorePaths . some ( path = > { <nl> if ( typeof path = = = ' string ' ) { <nl> return url . pathname . startsWith ( path ) <nl> } <nl> return path . test ( url . pathname . slice ( 1 ) ) <nl> - } ) ; <nl> + } ) <nl> if ( ! expectsHTML | | ! isSameOrigin | | ! isHttps | | isIgnored ) { <nl> - event . respondWith ( fetch ( event . request ) ) ; <nl> + event . respondWith ( fetch ( event . request ) ) <nl> - return ; <nl> + return <nl> } <nl> / / Fetch the resource after checking for the ID token . <nl> @ @ - 93 , 9 + 93 , 9 @ @ self . addEventListener ( ' fetch ' , ( event ) = > { <nl> : fetch ( event . request ) <nl> ) <nl> ) <nl> - } ) ; <nl> + } ) <nl> / / In service worker script . <nl> self . addEventListener ( ' activate ' , event = > { <nl> - event . waitUntil ( clients . claim ( ) ) ; <nl> - } ) ; <nl> + event . waitUntil ( clients . claim ( ) ) <nl> + } ) <nl> 
mmm a / components / SimilarityGraph / index . js <nl> ppp b / components / SimilarityGraph / index . js <nl> . attr ( ' x1 ' , d = > d . source . x ) <nl> . attr ( ' y1 ' , d = > d . source . y ) <nl> . attr ( ' x2 ' , d = > d . target . x ) <nl> - . attr ( ' y2 ' , d = > d . target . y ) <nl> + . attr ( ' y2 ' , d = > d . target . y ) ; <nl> } ) ; <nl> this . cola . avoidOverlaps ( true ) <nl> 
mmm a / components / TreeHeatmap / index . js <nl> ppp b / components / TreeHeatmap / index . js <nl> child1 : + row . _child1 , <nl> child2 : + row . _child2 , <nl> distance : + row . _distance , <nl> - size : + row . _size , <nl> + size : + row . _size <nl> } ) ; <nl> } <nl> } ) ; <nl> @ @ - 192 , 11 + 192 , 9 @ @ export default class TreeHeatmap extends VisComponent { <nl> let opacity = ( ) = > 1 ; <nl> if ( this . thresholdMode = = = ' less than ' ) { <nl> opacity = d = > d . value < this . threshold ? 1 : 0 ; <nl> - } <nl> - else if ( this . thresholdMode = = = ' greater than ' ) { <nl> + } else if ( this . thresholdMode = = = ' greater than ' ) { <nl> opacity = d = > d . value > this . threshold ? 1 : 0 ; <nl> - } <nl> - else if ( this . thresholdMode = = = ' absolute value greater than ' ) { <nl> + } else if ( this . thresholdMode = = = ' absolute value greater than ' ) { <nl> opacity = d = > Math . abs ( d . value ) > this . threshold ? 1 : 0 ; <nl> } <nl> @ @ - 312 , 7 + 310 , 7 @ @ export default class TreeHeatmap extends VisComponent { <nl> let group = vis . append ( ' g ' ) <nl> . attr ( ' class ' , orientation ) <nl> - . attr ( ' clip - path ' , ' url ( # clip - ' + orientation + ' ) ' ) <nl> + . attr ( ' clip - path ' , ' url ( # clip - ' + orientation + ' ) ' ) ; <nl> group . selectAll ( ' . tree - links ' ) . data ( links ) <nl> . enter ( ) <nl> @ @ - 347 , 8 + 345 , 8 @ @ export default class TreeHeatmap extends VisComponent { <nl> . data ( reverseLinks ) . transition ( ) . duration ( duration ) <nl> . attr ( axis1 , d = > distanceScale ( distance ( d ) ) ) <nl> . attr ( axis2 , d = > treeScale ( d . offset ) ) <nl> - . attr ( axis1 = = ' x ' ? ' width ' : ' height ' , d = > distanceScale ( 0 ) - distanceScale ( distance ( d ) ) ) <nl> - . attr ( axis2 = = ' x ' ? ' width ' : ' height ' , d = > treeScale ( d . offset + d . size ) - treeScale ( d . offset ) ) ; <nl> + . attr ( axis1 = = = ' x ' ? ' width ' : ' height ' , d = > distanceScale ( 0 ) - distanceScale ( distance ( d ) ) ) <nl> + . attr ( axis2 = = = ' x ' ? ' width ' : ' height ' , d = > treeScale ( d . offset + d . size ) - treeScale ( d . offset ) ) ; <nl> vis . selectAll ( ' . datum ' ) <nl> . data ( rectData ) . transition ( ) . duration ( duration ) <nl> @ @ - 364 , 7 + 362 , 6 @ @ export default class TreeHeatmap extends VisComponent { <nl> colLabelGroup . selectAll ( ' . col - label ' ) <nl> . data ( columns ) . transition ( ) . duration ( duration ) <nl> . attr ( ' transform ' , d = > ' translate ( ' + xScale ( d . pos ) + ' , ' + ( yStart + rowSize ) + ' ) ' ) ; <nl> - <nl> } <nl> group . selectAll ( ' . tree - select ' ) . data ( reverseLinks ) . enter ( ) <nl> 
mmm a / components / TreeHeatmap / test / treeheatmap . js <nl> ppp b / components / TreeHeatmap / test / treeheatmap . js <nl> import TreeHeatmap from ' . . ' ; <nl> - <nl> test ( ' TreeHeatmap component ' , t = > { <nl> let el = document . createElement ( ' div ' ) ; <nl> let vis = new TreeHeatmap ( el ) ; <nl> 
mmm a / components / TreeHeatmap / test / treeheatmap . js <nl> ppp b / components / TreeHeatmap / test / treeheatmap . js <nl> < g clip - path = " url ( # clip - row - labels ) " > < text class = " row - label " color = " black " font - size = " 10px " alignment - baseline = " middle " x = " 300 " y = " 200 " > 0 < / text > < / g > <nl> < clipPath id = " clip - col - labels " > < rect x = " 100 " y = " 300 " width = " 200 " height = " 100 " > < / rect > < / clipPath > <nl> < g clip - path = " url ( # clip - col - labels ) " > < g transform = " translate ( 200 , 300 ) " class = " col - label " > < text color = " black " font - size = " 10px " transform = " rotate ( - 90 ) " text - anchor = " end " alignment - baseline = " middle " > a < / text > < / g > < / g > <nl> - < / svg > ` . replace ( / \ n / g , ' ' ) . replace ( / / g , ' ' ) ; <nl> + < / svg > ` . replace ( / \ n / g , ' ' ) . replace ( / { 2 } / g , ' ' ) ; <nl> t . ok ( el . isEqualNode ( single ) , ' single row and column produce the right graphics ' ) ; <nl> @ @ - 78 , 7 + 78 , 7 @ @ test ( ' TreeHeatmap component ' , t = > { <nl> < path class = " tree - links " d = " M150 , 100L150 , 0L250 , 0L250 , 100 " style = " fill - opacity : 0 ; stroke : # 000000 ; " > < / path > <nl> < rect class = " tree - select " y = " 0 " x = " 100 " height = " 100 " width = " 200 " style = " fill : # 4682b4 ; fill - opacity : 0 ; " > < / rect > <nl> < / g > <nl> - < / svg > ` . replace ( / \ n / g , ' ' ) . replace ( / / g , ' ' ) ; <nl> + < / svg > ` . replace ( / \ n / g , ' ' ) . replace ( / { 2 } / g , ' ' ) ; <nl> t . ok ( el . isEqualNode ( two ) , ' two rows and columns produce the right graphics ' ) ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " license " : " Apache - 2 . 0 " , <nl> " devDependencies " : { <nl> + " UpSet " : " git + https : / / github . com / jeffbaumes / upset # no - global - vars " , <nl> " babel - cli " : " ^ 6 . 7 . 5 " , <nl> " babel - core " : " ^ 6 . 24 . 1 " , <nl> " babel - istanbul - loader " : " ^ 0 . 1 . 0 " , <nl> " style - loader " : " ^ 0 . 18 . 1 " , <nl> " stylus " : " ^ 0 . 54 . 5 " , <nl> " stylus - loader " : " ^ 3 . 0 . 1 " , <nl> + " tap - spec " : " ^ 4 . 1 . 1 " , <nl> " tape " : " ^ 4 . 6 . 3 " , <nl> " tape - catch " : " ^ 1 . 0 . 6 " , <nl> - " tap - spec " : " ^ 4 . 1 . 1 " , <nl> " telegraph - events " : " ^ 1 . 0 . 3 " , <nl> " underscore " : " ^ 1 . 8 . 3 " , <nl> - " UpSet " : " git + https : / / github . com / jeffbaumes / upset # no - global - vars " , <nl> " url - loader " : " ^ 0 . 5 . 8 " , <nl> " validate - commit - msg " : " ^ 2 . 8 . 2 " , <nl> " vega " : " ^ 2 . 4 . 2 " , <nl> 
mmm a / packages / examples / treeheatmap / index . js <nl> ppp b / packages / examples / treeheatmap / index . js <nl> import showComponent from ' . . / util / showComponent ' ; <nl> window . onload = ( ) = > { <nl> - showComponent ( TreeHeatmap , { <nl> + const vis = showComponent ( TreeHeatmap , { <nl> data : heatmap , <nl> scale : ' column ' <nl> } ) ; <nl> 
mmm a / packages / all / src / index . js <nl> ppp b / packages / all / src / index . js <nl> } <nl> for ( let component in vega ) { <nl> if ( vega [ component ] ! = = vega . VegaView ) { <nl> - components [ component ] = vega [ component ] <nl> + components [ component ] = vega [ component ] ; <nl> } <nl> } <nl> 
mmm a / python / pycandela / pycandela / __init__ . py <nl> ppp b / python / pycandela / pycandela / __init__ . py <nl> def display ( self ) : <nl> display ( self ) <nl> + <nl> def load ( filename ) : <nl> with open ( filename ) as f : <nl> c = json . load ( f ) <nl> return Component ( c [ ' name ' ] , * * c [ ' options ' ] ) <nl> + <nl> class ComponentAccessor ( object ) : <nl> def __dir__ ( self ) : <nl> return _component_list <nl> 
mmm a / packages / vega / src / component / BoxPlot / index . js <nl> ppp b / packages / vega / src / component / BoxPlot / index . js <nl> } , <nl> width : this . getWidth ( 200 ) , <nl> height : this . getHeight ( 200 ) , <nl> - mark : ' box - plot ' , <nl> + mark : ' box - plot ' <nl> } ; <nl> spec . encoding . y = { <nl> 
mmm a / . esdoc . json <nl> ppp b / . esdoc . json <nl> " source " : " . / src " , <nl> " destination " : " . / esdoc " , <nl> - " excludes " : [ " dist " , " db " , " node_modules " , " esdoc " , " coverage " , " jest_config " ] , <nl> + " excludes " : [ <nl> + " dist " , <nl> + " db " , <nl> + " node_modules " , <nl> + " esdoc " , <nl> + " coverage " , <nl> + " jest_config " <nl> + ] , <nl> " experimentalProposal " : { <nl> " classProperties " : true , <nl> " objectRestSpread " : true , <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> + / * * <nl> + * @ file for config stuff that ' s used for webpack configuration , but isn ' t passed to webpack compiler <nl> + * / <nl> + <nl> const path = require ( ' path ' ) <nl> const rootPath = path . join ( __dirname , ' . . / ' ) / / = " / " <nl> const distPath = path . join ( rootPath , ' . / dist ' ) / / = " / dist " <nl> @ @ - 32 , 7 + 35 , 8 @ @ module . exports = { <nl> } , <nl> / / text for WebpackBannerPlugin , <nl> / / this plugin just adds text banner to the beginning of your file <nl> - banner : ' MIT License . Copyright ( c ) 2017 Vladimir Metnew All Rights Reserved . Repo : https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> + banner : <nl> + ' MIT License . Copyright ( c ) 2017 Vladimir Metnew All Rights Reserved . Repo : https : / / github . com / Metnew / react - semantic . ui - starter ' , <nl> / / your manifest . json <nl> manifest : { <nl> name : ' React - Semantic . UI - Starter ' , <nl> 
mmm a / webpack_config / server / webpack . base . js <nl> ppp b / webpack_config / server / webpack . base . js <nl> new webpack . BannerPlugin ( { <nl> banner : config . banner <nl> } ) , <nl> - / / NOTE : Server can ' t process your styles / images / fonts on server - side rendering <nl> + / / Server can ' t process require of your styles / images / fonts <nl> new webpack . NormalModuleReplacementPlugin ( <nl> / \ . ( css | sass | less | jpg | png | gif | scss ) $ / , <nl> ' node - noop ' <nl> ) <nl> - / / NOTE : @ Metnew : If I remember correctly this plugin works similarly to NormalModuleReplacementPlugin <nl> / / new webpack . IgnorePlugin ( / \ . ( css | sass | less | jpg | png | gif | scss ) $ / ) <nl> ] , <nl> node : { <nl> 
mmm a / webpack_config / server / webpack . prod . babel . js <nl> ppp b / webpack_config / server / webpack . prod . babel . js <nl> sourceMap : true , <nl> compress : { <nl> warnings : false <nl> - / / This option removes console log in production <nl> + / / This option removes console . log in production <nl> / / drop_console : true <nl> } , <nl> output : { <nl> 
mmm a / src / common / actions / auth / index . js <nl> ppp b / src / common / actions / auth / index . js <nl> - loginAPI , <nl> - setLocalToken , <nl> - resetLocalToken , <nl> - resultOK <nl> - } from ' api ' <nl> + import { loginAPI , setLocalToken , resetLocalToken , resultOK } from ' api ' <nl> export const LOGIN_AUTH_PENDING = ' LOGIN_AUTH_PENDING ' <nl> export const LOGIN_AUTH_SUCCESS = ' LOGIN_AUTH_SUCCESS ' <nl> @ @ - 14 , 7 + 9 , 7 @ @ export const LOGOUT_AUTH_SUCCESS = ' LOGOUT_AUTH_SUCCESS ' <nl> export const LOGIN_AUTH = async data = > { <nl> const result = await loginAPI ( data ) <nl> if ( ! resultOK ( result ) ) { <nl> - return { type : LOGIN_AUTH_FAIL , errors : result . data } <nl> + return { type : LOGIN_AUTH_FAIL , errors : result & & result . data } <nl> } <nl> setLocalToken ( result . data . token ) <nl> return { type : LOGIN_AUTH_SUCCESS , result : result . data } <nl> 
mmm a / test / ReentrancyGuard . test . js <nl> ppp b / test / ReentrancyGuard . test . js <nl> - const ReentrancyMock = artifacts . require ( ' . / helper / ReentrancyMock . sol ' ) ; <nl> - const ReentrancyAttack = artifacts . require ( ' . / helper / ReentrancyAttack . sol ' ) ; <nl> + const ReentrancyMock = artifacts . require ( ' . / mocks / ReentrancyMock . sol ' ) ; <nl> + const ReentrancyAttack = artifacts . require ( ' . / mocks / ReentrancyAttack . sol ' ) ; <nl> contract ( ' ReentrancyGuard ' , function ( accounts ) { <nl> let reentrancyMock ; <nl> 
mmm a / testem . js <nl> ppp b / testem . js <nl> var allBrowsers = [ <nl> ' Chrome ' , ' Firefox ' , ' BS_Safari_Current ' , ' BS_Safari_Last ' , ' BS_MS_Edge ' , ' BS_IE_11 ' <nl> ] ; <nl> - var localBrowsers = [ ' Chrome ' , ' Firefox ' ] ; <nl> + var localBrowsers = [ ' Chrome ' ] ; <nl> var ciBrowsers = isMasterBuild ? allBrowsers : localBrowsers ; <nl> module . exports = { <nl> 
mmm a / test / events / complete . test . js <nl> ppp b / test / events / complete . test . js <nl> } ) ; <nl> } ) ; <nl> - it ( ' quit ' , function ( done ) { <nl> - var cmd = asCLI ( ' env . js ' ) ; <nl> - cmd . exec = path . join ( ' . . ' , ' . . ' , ' . . ' , cmd . exec ) ; <nl> - var p = fork ( cmd . exec , cmd . args , { <nl> - cwd : dir , <nl> - silent : true , <nl> - detached : true , <nl> - } ) ; <nl> - p . stdout . on ( ' data ' , function ( m ) { <nl> - m = m . toString ( ) . trim ( ) ; <nl> - if ( m = = = ' STOPPED ' ) { <nl> - p . kill ( ' SIGINT ' ) ; <nl> - } <nl> - if ( m = = = ' QUIT ' ) { <nl> - assert ( true , ' " quit " event ' ) ; <nl> - done ( ) ; <nl> - } <nl> - } ) ; <nl> - } ) ; <nl> + / / it ( ' quit ' , function ( done ) { <nl> + / / var cmd = asCLI ( ' env . js ' ) ; <nl> + / / cmd . exec = path . join ( ' . . ' , ' . . ' , ' . . ' , cmd . exec ) ; <nl> + / / var p = fork ( cmd . exec , cmd . args , { <nl> + / / cwd : dir , <nl> + / / silent : true , <nl> + / / detached : true , <nl> + / / } ) ; <nl> + / / p . stdout . on ( ' data ' , function ( m ) { <nl> + / / m = m . toString ( ) . trim ( ) ; <nl> + / / if ( m = = = ' STOPPED ' ) { <nl> + / / p . kill ( ' SIGINT ' ) ; <nl> + / / } <nl> + / / if ( m = = = ' QUIT ' ) { <nl> + / / assert ( true , ' " quit " event ' ) ; <nl> + / / done ( ) ; <nl> + / / } <nl> + / / } ) ; <nl> + / / } ) ; <nl> it ( ' stdout ' , function ( done ) { <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - ' 8 ' <nl> - ' 6 ' <nl> before_install : <nl> - - echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc <nl> + - if [ " $ TRAVIS_BRANCH " = " master " ] ; then <nl> + echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> after_success : <nl> - npm run semantic - release <nl> branches : <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - ' 8 ' <nl> - ' 6 ' <nl> before_install : <nl> - - if [ " $ TRAVIS_BRANCH " = " master " ] ; then <nl> - echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> + - if [ " $ TRAVIS_BRANCH " = = " master " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> after_success : <nl> - npm run semantic - release <nl> branches : <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - ' 8 ' <nl> - ' 6 ' <nl> before_install : <nl> - - if [ " $ TRAVIS_BRANCH " = = " master " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> + - if [ " $ TRAVIS_PULL_REQUEST_BRANCH " = = " " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> after_success : <nl> - npm run semantic - release <nl> branches : <nl> 
mmm a / test / monitor / match . test . js <nl> ppp b / test / monitor / match . test . js <nl> describe ( ' watcher ' , function ( ) { <nl> - afterEach ( function ( ) { <nl> + afterEach ( function ( done ) { <nl> config . reset ( ) ; <nl> + setTimeout ( ( ) = > { <nl> watch . resetWatchers ( ) ; <nl> + done ( ) ; <nl> + } , 0 ) <nl> } ) ; <nl> it ( ' should not crash if ignoreRoot is an empty array ' , function ( done ) { <nl> @ @ - 389 , 17 + 392 , 16 @ @ describe ( ' watcher ' , function ( ) { <nl> } ) <nl> } ) ; <nl> - / * fuck you , randomly , for no good goddamn reason , hanging test * / <nl> - / / it ( ' should match a dotfolder if explicitly asked to ' , function ( done ) { <nl> - / / config . load ( { <nl> - / / watch : [ ' test / fixtures / . dotfolder ' ] <nl> - / / } , function ( config ) { <nl> - / / return watch . watch ( ) <nl> - / / . then ( function ( files ) { <nl> - / / assert . deepEqual ( files . length , 3 , ' file lists should contain . dotfolder files ' ) ; <nl> - / / done ( ) ; <nl> - / / } ) <nl> - / / . catch ( done ) ; <nl> - / / } ) <nl> - / / } ) ; <nl> + it ( ' should match a dotfolder if explicitly asked to ' , function ( done ) { <nl> + config . load ( { <nl> + watch : [ ' test / fixtures / . dotfolder ' ] <nl> + } , function ( config ) { <nl> + return watch . watch ( ) <nl> + . then ( function ( files ) { <nl> + assert . deepEqual ( files . length , 3 , ' file lists should contain . dotfolder files ' ) ; <nl> + done ( ) ; <nl> + } ) <nl> + . catch ( done ) ; <nl> + } ) <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / cli / parse . test . js <nl> ppp b / test / cli / parse . test . js <nl> } ) ; <nl> } ) ; <nl> - describe . only ( ' nodemon should slurp properly ' , ( ) = > { <nl> + describe ( ' nodemon should slurp properly ' , ( ) = > { <nl> it ( ' should read quotes as a single entity ' , ( ) = > { <nl> const settings = parse ( asCLI ( ' notindex . js - - - b " hello - world " ' ) ) ; <nl> assert ( settings . execOptions . exec = = = ' node ' , ' node is exec ' ) ; <nl> 
mmm a / test / fork / run - mac - only . test . js <nl> ppp b / test / fork / run - mac - only . test . js <nl> [ __dirname + ' some \ \ \ file ' , ' # ! / bin / sh \ necho " OK " ' ] , <nl> ] ; <nl> - if ( ! process . env . TRAVIS & & process . platform ! = = ' win32 ' ) { <nl> + if ( ! process . env . TRAVIS & & process . platform = = = ' darwin ' ) { <nl> describe ( ' nodemon fork ( mac only ) ' , ( ) = > { <nl> before ( ( ) = > { <nl> filenames . map ( file = > fs . writeFileSync ( file [ 0 ] , file [ 1 ] , ' utf8 ' ) ) ; <nl> 
mmm a / packages / wmr / test / fixtures / prerender - data / index . js <nl> ppp b / packages / wmr / test / fixtures / prerender - data / index . js <nl> - return { html : ' < h1 > it works < / h1 > ' , links : [ ' / ' ] , data : { hello : ' world ' } } ; <nl> + return { html : ' < h1 > it works < / h1 > < script type = " isodata " > < / script > ' , links : [ ' / ' ] , data : { hello : ' world ' } } ; <nl> } <nl> 
mmm a / src / domain / controls . test . js <nl> ppp b / src / domain / controls . test . js <nl> ' start ' : ' t0 ' , <nl> ' end ' : ' tn ' , <nl> ' showBusy ' : true , <nl> + ' position ' : [ 0 , 0 ] <nl> } <nl> const action = setControls ( controls ) ; <nl> @ @ - 70 , 6 + 71 , 7 @ @ describe ( " Controls reducer " , ( ) = > { <nl> ' start ' : null , <nl> ' end ' : null , <nl> ' showBusy ' : false , <nl> + ' position ' : [ 0 , 0 ] <nl> } ) ; <nl> done ( ) ; <nl> 
mmm a / test / common . js <nl> ppp b / test / common . js <nl> exports . getConfig = thunky ( function ( cb ) { <nl> / / Includes TURN - - needed for tests to pass on Sauce Labs <nl> / / https : / / github . com / feross / simple - peer / issues / 41 <nl> - get . concat ( ' https : / / instant . io / rtcConfig ' , function ( err , res , data ) { <nl> + get . concat ( ' https : / / instant . io / _rtcConfig ' , function ( err , res , data ) { <nl> if ( err ) return cb ( err ) <nl> data = data . toString ( ) <nl> try { <nl> 
mmm a / test / trickle . js <nl> ppp b / test / trickle . js <nl> test ( ' disable trickle ' , function ( t ) { <nl> if ( bowser . safari | | bowser . ios ) { <nl> - t . pass ( ' Skip on Safari and iOS which do not support this reliably , it seems ' ) <nl> + / / Note : Webkit bug filed here : https : / / bugs . webkit . org / show_bug . cgi ? id = 182906 <nl> + t . pass ( ' Skip on Safari and iOS which do not support this reliably ' ) <nl> t . end ( ) <nl> return <nl> } <nl> @ @ - 64 , 7 + 65 , 8 @ @ test ( ' disable trickle ' , function ( t ) { <nl> test ( ' disable trickle ( only initiator ) ' , function ( t ) { <nl> if ( bowser . safari | | bowser . ios ) { <nl> - t . pass ( ' Skip on Safari and iOS which do not support this reliably , it seems ' ) <nl> + / / Note : Webkit bug filed here : https : / / bugs . webkit . org / show_bug . cgi ? id = 182906 <nl> + t . pass ( ' Skip on Safari and iOS which do not support this reliably ' ) <nl> t . end ( ) <nl> return <nl> } <nl> @ @ - 114 , 7 + 116 , 8 @ @ test ( ' disable trickle ( only initiator ) ' , function ( t ) { <nl> test ( ' disable trickle ( only receiver ) ' , function ( t ) { <nl> if ( bowser . safari | | bowser . ios ) { <nl> - t . pass ( ' Skip on Safari and iOS which do not support this reliably , it seems ' ) <nl> + / / Note : Webkit bug filed here : https : / / bugs . webkit . org / show_bug . cgi ? id = 182906 <nl> + t . pass ( ' Skip on Safari and iOS which do not support this reliably ' ) <nl> t . end ( ) <nl> return <nl> } <nl> 
mmm a / test / common . js <nl> ppp b / test / common . js <nl> exports . getConfig = thunky ( function ( cb ) { <nl> / / Includes TURN - - needed for tests to pass on Sauce Labs <nl> / / https : / / github . com / feross / simple - peer / issues / 41 <nl> + / / WARNING : This is * NOT * a public endpoint . Do not depend on it in your app . <nl> get . concat ( ' https : / / instant . io / __rtcConfig__ ' , function ( err , res , data ) { <nl> if ( err ) return cb ( err ) <nl> data = data . toString ( ) <nl> 
mmm a / test / basic . js <nl> ppp b / test / basic . js <nl> } <nl> } ) <nl> + test ( ' can detect error when RTCPeerConstructor throws ' , function ( t ) { <nl> + t . plan ( 1 ) <nl> + <nl> + var peer = new Peer ( { wrtc : { RTCPeerConnection : null } } ) <nl> + peer . once ( ' error ' , function ( ) { <nl> + t . pass ( ' got error event ' ) <nl> + peer . destroy ( ) <nl> + } ) <nl> + } ) <nl> + <nl> test ( ' signal event gets emitted ' , function ( t ) { <nl> t . plan ( 2 ) <nl> 
mmm a / test / basic . js <nl> ppp b / test / basic . js <nl> t . end ( ) <nl> return <nl> } <nl> - if ( common . isBrowser ( ' chrome ' ) ) { <nl> - t . pass ( ' Skip on Chrome which hides local IPs with mDNS ' ) <nl> + if ( common . isBrowser ( ' chrome ' ) | | common . isBrowser ( ' edge ' ) ) { <nl> + t . pass ( ' Skip on Chrome and Edge which hide local IPs with mDNS ' ) <nl> t . end ( ) <nl> return <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " size " : " npm run build & & cat simplepeer . min . js | gzip | wc - c " , <nl> " / / test " : " standard & & npm run test - node & & npm run test - browser " , <nl> - " test " : " standard & & npm run test - node " , <nl> + " test " : " standard & & npm run test - browser " , <nl> " test - browser " : " airtap - - coverage - - test / * . js " , <nl> " test - browser - local " : " airtap - - coverage - - local - - test / * . js " , <nl> " test - node " : " WRTC = wrtc tape test / * . js " , <nl> 
mmm a / packages / kiwi - core / src / Breadcrumb / tests / Breadcrumb . test . js <nl> ppp b / packages / kiwi - core / src / Breadcrumb / tests / Breadcrumb . test . js <nl> import { render } from ' @ / tests / test - utils ' <nl> - import CompositionApi from ' @ vue / composition - api ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 23 , 9 + 22 , 7 @ @ const renderComponent = ( props ) = > { <nl> ` , <nl> . . . props <nl> } <nl> - return render ( base , { } , vue = > { <nl> - vue . use ( CompositionApi ) <nl> - } ) <nl> + return render ( base ) <nl> } <nl> it ( ' should render correctly ' , ( ) = > { <nl> 
mmm a / packages / chakra - ui - core / src / Alert / tests / Alert . test . js <nl> ppp b / packages / chakra - ui - core / src / Alert / tests / Alert . test . js <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> + <nl> + it ( ' should have role = alert ' , ( ) = > { <nl> + const { getByRole } = renderComponent ( { <nl> + template : ` <nl> + < Alert status = " error " > <nl> + < AlertIcon name = " add " / > <nl> + < / Alert > ` <nl> + } ) <nl> + <nl> + getByRole ( ' alert ' ) <nl> + } ) <nl> 
mmm a / packages / chakra - ui - core / src / AvatarGroup / tests / AvatarGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / AvatarGroup / tests / AvatarGroup . test . js <nl> const { asFragment } = renderComponent ( ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> + <nl> + test ( ' renders a number avatar showing count of truncated avatars ' , ( ) = > { <nl> + const { getByText } = renderComponent ( ) <nl> + <nl> + getByText ( ' + 1 ' ) <nl> + } ) <nl> 
mmm a / packages / chakra - ui - core / src / Breadcrumb / tests / Breadcrumb . test . js <nl> ppp b / packages / chakra - ui - core / src / Breadcrumb / tests / Breadcrumb . test . js <nl> } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> + <nl> + it ( ' should have the proper aria - attributes ' , ( ) = > { <nl> + const { getByText , getAllByRole , getByLabelText } = renderComponent ( { <nl> + template : ` <nl> + < Breadcrumb > <nl> + < BreadcrumbItem > <nl> + < BreadcrumbLink href = " / " > Home < / BreadcrumbLink > <nl> + < / BreadcrumbItem > <nl> + < BreadcrumbItem > <nl> + < BreadcrumbLink href = " / about " > About < / BreadcrumbLink > <nl> + < / BreadcrumbItem > <nl> + < BreadcrumbItem isCurrentPage > <nl> + < BreadcrumbLink href = " / contact " > Contact < / BreadcrumbLink > <nl> + < / BreadcrumbItem > <nl> + < / Breadcrumb > ` <nl> + } ) <nl> + <nl> + / / surrounding ` nav ` has aria - label = " breadcrumb " <nl> + getByLabelText ( ' breadcrumb ' , { selector : ' nav ' } ) <nl> + <nl> + / / ` isCurrentPage ` link has aria - current = " page " <nl> + const currentPageLink = getByText ( ' Contact ' ) <nl> + expect ( currentPageLink ) . toHaveAttribute ( ' aria - current ' , ' page ' ) <nl> + <nl> + / / separator receives presentation = " role " <nl> + expect ( getAllByRole ( ' presentation ' ) ) . toHaveLength ( 2 ) <nl> + } ) <nl> 
mmm a / packages / chakra - ui - core / src / AlertDialog / tests / __snapshots__ / AlertDialog . test . js . snap <nl> ppp b / packages / chakra - ui - core / src / AlertDialog / tests / __snapshots__ / AlertDialog . test . js . snap <nl> > <nl> < div <nl> class = " css - l5w8ps " <nl> - data - testid = " overlay " <nl> / > <nl> < div <nl> class = " css - aibg9d " <nl> - data - testid = " content " <nl> + data - testid = " overlay " <nl> role = " alertdialog " <nl> > <nl> < section <nl> @ @ - 100 , 7 + 99 , 13 @ @ exports [ ` should render correctly 1 ` ] = ` <nl> class = " css - 5m10fw " <nl> id = " alert - dialog - 1 - desc " <nl> > <nl> + <nl> Are you sure ? <nl> + <nl> + < input <nl> + data - testid = " inputInsideDrawer " <nl> + placeholder = " Type here . . . " <nl> + / > <nl> < / div > <nl> < footer <nl> 
mmm a / packages / chakra - ui - core / src / AlertDialog / tests / __snapshots__ / AlertDialog . test . js . snap <nl> ppp b / packages / chakra - ui - core / src / AlertDialog / tests / __snapshots__ / AlertDialog . test . js . snap <nl> < div <nl> class = " css - aibg9d " <nl> data - testid = " overlay " <nl> - role = " alertdialog " <nl> > <nl> < section <nl> aria - describedby = " alert - dialog - 1 - desc " <nl> @ @ - 30 , 7 + 29 , 7 @ @ exports [ ` should render correctly 1 ` ] = ` <nl> aria - modal = " true " <nl> class = " css - i76yoi " <nl> id = " alert - dialog - 1 " <nl> - role = " dialog " <nl> + role = " alertdialog " <nl> tabindex = " - 1 " <nl> > <nl> < header <nl> 
mmm a / packages / chakra - ui - core / src / ThemeProvider / tests / ThemeProvider . test . js <nl> ppp b / packages / chakra - ui - core / src / ThemeProvider / tests / ThemeProvider . test . js <nl> describe ( ' = = = = = ThemeProvider Component = = = = = ' , ( ) = > { <nl> let themeProvider <nl> const ChildComponent = { <nl> - inject : [ ' $ theme ' ] , <nl> + inject : [ ' $ theme ' , ' $ colorMode ' ] , <nl> render : h = > h ( ' div ' , { } ) <nl> } <nl> @ @ - 38 , 5 + 38 , 6 @ @ describe ( ' = = = = = ThemeProvider Component = = = = = ' , ( ) = > { <nl> } <nl> } ) <nl> expect ( themeProvider . find ( ChildComponent ) . vm . $ theme ( ) ) . toBe ( theme ) <nl> + expect ( themeProvider . find ( ChildComponent ) . vm . $ colorMode ( ) ) . toBe ( ' light ' ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CAlert / tests / CAlert . test . js <nl> ppp b / packages / chakra - ui - core / src / CAlert / tests / CAlert . test . js <nl> import { render , defaultProviders } from ' @ / tests / test - utils ' <nl> import icons from ' . . / . . / lib / internal - icons ' <nl> - / / mocks <nl> - jest . mock ( ' breadstick / dist / components / Alert / styles . css ' , ( ) = > ( { } ) ) / / jest tries to import styles and fails . . . <nl> - <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { CAlert , CAlertTitle , CAlertDescription , CAlertIcon , CStack } , <nl> 
mmm a / packages / chakra - ui - core / src / CAvatarGroup / tests / CAvatarGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / CAvatarGroup / tests / CAvatarGroup . test . js <nl> import { render } from ' @ / tests / test - utils ' <nl> - / / mocks <nl> - jest . mock ( ' breadstick / dist / components / Alert / styles . css ' , ( ) = > ( { } ) ) / / jest tries to import styles and fails . . . <nl> - <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { <nl> 
mmm a / packages / chakra - ui - core / src / CBadge / tests / CBadge . test . js <nl> ppp b / packages / chakra - ui - core / src / CBadge / tests / CBadge . test . js <nl> import { render } from ' @ / tests / test - utils ' <nl> - / / mocks <nl> - jest . mock ( ' breadstick / dist / components / Alert / styles . css ' , ( ) = > ( { } ) ) / / jest tries to import styles and fails . . . <nl> - <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { CBadge , CStack } , <nl> 
mmm a / packages / chakra - ui - core / src / CButton / tests / CButton . test . js <nl> ppp b / packages / chakra - ui - core / src / CButton / tests / CButton . test . js <nl> import { render , defaultProviders } from ' @ / tests / test - utils ' <nl> - / / mocks <nl> - jest . mock ( ' breadstick / dist / components / Alert / styles . css ' , ( ) = > ( { } ) ) / / jest tries to import styles and fails . . . <nl> - <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { <nl> 
mmm a / packages / chakra - ui - core / src / CFormControl / tests / CFormControl . test . js <nl> ppp b / packages / chakra - ui - core / src / CFormControl / tests / CFormControl . test . js <nl> import { render } from ' @ / tests / test - utils ' <nl> - / / mocks <nl> - jest . mock ( ' breadstick / dist / components / Alert / styles . css ' , ( ) = > ( { } ) ) / / jest tries to import styles and fails . . . <nl> - <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> const base = { <nl> 
mmm a / packages / chakra - ui - core / src / CAlertDialog / tests / CAlertDialog . test . js <nl> ppp b / packages / chakra - ui - core / src / CAlertDialog / tests / CAlertDialog . test . js <nl> import { render , defaultProviders , userEvent , fireEvent , waitMs } from ' @ / tests / test - utils ' <nl> import Vue from ' vue ' <nl> - import { useId , wrapEvent } from ' @ / packages / chakra - ui - core / src / utils ' <nl> + import { useId } from ' @ / packages / chakra - ui - core / src / utils ' <nl> / / mocks <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / utils / dom . js ' ) <nl> jest . mock ( ' @ / packages / chakra - ui - core / src / utils / generators . js ' ) <nl> - jest . mock ( ' v - scroll - lock ' , ( ) = > ( { } ) ) <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / CToast / index . js ' , ( ) = > { } ) <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 50 , 7 + 47 , 6 @ @ const renderComponent = ( props ) = > { <nl> it ( ' should render correctly ' , async ( ) = > { <nl> useId . mockReturnValueOnce ( ' 1 ' ) <nl> - wrapEvent . mockImplementation ( ( ) = > jest . fn ( ) ) <nl> const inlineAttrs = ' isOpen ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> 
mmm a / packages / chakra - ui - core / src / CDrawer / tests / CDrawer . test . js <nl> ppp b / packages / chakra - ui - core / src / CDrawer / tests / CDrawer . test . js <nl> import { render , defaultProviders , userEvent , fireEvent , waitMs } from ' @ / tests / test - utils ' <nl> import Vue from ' vue ' <nl> - import { useId , wrapEvent } from ' @ / packages / chakra - ui - core / src / utils ' <nl> + import { useId } from ' @ / packages / chakra - ui - core / src / utils ' <nl> / / mocks <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / utils / dom . js ' ) <nl> jest . mock ( ' @ / packages / chakra - ui - core / src / utils / generators . js ' ) <nl> - jest . mock ( ' v - scroll - lock ' , ( ) = > ( { } ) ) <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / CToast / index . js ' , ( ) = > { } ) <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 50 , 7 + 47 , 6 @ @ const renderComponent = ( props ) = > { <nl> it ( ' should render correctly ' , async ( ) = > { <nl> useId . mockReturnValueOnce ( ' 1 ' ) <nl> - wrapEvent . mockImplementation ( ( ) = > jest . fn ( ) ) <nl> const inlineAttrs = ' isOpen ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> 
mmm a / packages / chakra - ui - core / src / CEditable / tests / CEditable . test . js <nl> ppp b / packages / chakra - ui - core / src / CEditable / tests / CEditable . test . js <nl> import { useId } from ' . . / . . / utils ' <nl> / / mocks <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / CToast / index . js ' , ( ) = > { } ) <nl> jest . mock ( ' @ / packages / chakra - ui - core / src / utils / generators . js ' ) <nl> const renderComponent = ( props ) = > { <nl> 
mmm a / packages / chakra - ui - core / src / CModal / tests / CModal . test . js <nl> ppp b / packages / chakra - ui - core / src / CModal / tests / CModal . test . js <nl> import { useId , wrapEvent } from ' @ / packages / chakra - ui - core / src / utils ' <nl> / / mocks <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / utils / dom . js ' ) <nl> + jest . mock ( ' @ / packages / chakra - ui - core / src / utils / dom . js ' ) / / click <nl> jest . mock ( ' @ / packages / chakra - ui - core / src / utils / generators . js ' ) <nl> - jest . mock ( ' v - scroll - lock ' , ( ) = > ( { } ) ) <nl> - jest . mock ( ' @ / packages / chakra - ui - core / src / CToast / index . js ' , ( ) = > { } ) <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> 
mmm a / packages / chakra - ui - core / src / CStat / tests / CStat . test . js <nl> ppp b / packages / chakra - ui - core / src / CStat / tests / CStat . test . js <nl> import { render , defaultProviders } from ' @ / tests / test - utils ' <nl> - import internalIcons from ' . . / . . / lib / internal - icons . js ' <nl> - <nl> - const { ' triangle - up ' : increase , ' triangle - down ' : decrease } = internalIcons <nl> + import icons from ' . . / . . / lib / internal - icons . js ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { CStat , CStatLabel , CStatNumber , CStatHelperText , CStatArrow } , <nl> - provide : ( ) = > ( { <nl> - . . . defaultProviders ( ) , <nl> - $ chakraIcons : { <nl> - ' triangle - up ' : increase , <nl> - ' triangle - down ' : decrease <nl> - } <nl> - } ) , <nl> + provide : ( ) = > defaultProviders ( { $ chakraIcons : { ' triangle - up ' : icons [ ' triangle - up ' ] , ' triangle - down ' : icons [ ' triangle - down ' ] } } ) , <nl> template : ` <nl> < CStat > <nl> < CStatLabel > Collected Fees < / CStatLabel > <nl> 
mmm a / packages / chakra - ui - core / src / CTag / tests / CTag . test . js <nl> ppp b / packages / chakra - ui - core / src / CTag / tests / CTag . test . js <nl> - import { render , defaultProviders } from ' @ / tests / test - utils ' <nl> + import { render } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { CBox , CTag , CTagLabel , CTagIcon , CTagCloseButton , CAvatar } , <nl> - provide : ( ) = > ( { <nl> - . . . defaultProviders ( ) , <nl> - $ chakraIcons : { <nl> - ' email ' : { <nl> - path : ` <nl> - < path <nl> - fill = " currentColor " <nl> - d = " M12 2C6 . 48 2 2 6 . 48 2 12s4 . 48 10 10 10 10 - 4 . 48 10 - 10S17 . 52 2 12 2zm0 18c - 4 . 42 0 - 8 - 3 . 58 - 8 - 8 0 - 1 . 85 . 63 - 3 . 55 1 . 69 - 4 . 9L16 . 9 18 . 31C15 . 55 19 . 37 13 . 85 20 12 20zm6 . 31 - 3 . 1L7 . 1 5 . 69C8 . 45 4 . 63 10 . 15 4 12 4c4 . 42 0 8 3 . 58 8 8 0 1 . 85 - . 63 3 . 55 - 1 . 69 4 . 9z " <nl> - / > <nl> - ` <nl> - } <nl> - } <nl> - } ) , <nl> template : ` <nl> < CBox mb = " 3 " > <nl> < CTag size = " sm " variantColor = " green " > <nl> 
mmm a / packages / chakra - ui - core / src / CIcon / tests / CIcon . test . js <nl> ppp b / packages / chakra - ui - core / src / CIcon / tests / CIcon . test . js <nl> - import { render , defaultProviders } from ' @ / tests / test - utils ' <nl> - import icons from ' @ / packages / chakra - ui - core / src / lib / internal - icons ' <nl> + import { render } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { CIcon } , <nl> - provide : ( ) = > defaultProviders ( { $ chakraIcons : { add : icons . add } } ) , <nl> template : ` < CIcon name = " add " > < / CIcon > ` , <nl> . . . props <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CStat / tests / CStat . test . js <nl> ppp b / packages / chakra - ui - core / src / CStat / tests / CStat . test . js <nl> - import { render , defaultProviders } from ' @ / tests / test - utils ' <nl> - import icons from ' . . / . . / lib / internal - icons . js ' <nl> + import { render } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> components : { CStat , CStatLabel , CStatNumber , CStatHelperText , CStatArrow } , <nl> - provide : ( ) = > defaultProviders ( { $ chakraIcons : { ' triangle - up ' : icons [ ' triangle - up ' ] , ' triangle - down ' : icons [ ' triangle - down ' ] } } ) , <nl> template : ` <nl> < CStat > <nl> < CStatLabel > Collected Fees < / CStatLabel > <nl> 
mmm a / packages / nuxt - chakra / example / nuxt . config . js <nl> ppp b / packages / nuxt - chakra / example / nuxt . config . js <nl> buildDir : resolve ( __dirname , ' . nuxt ' ) , <nl> srcDir : __dirname , <nl> modules : [ <nl> - { handler : require ( ' . . / ' ) } , <nl> - ' @ nuxtjs / emotion ' <nl> + { handler : require ( ' . . / ' ) } <nl> ] , <nl> build : { <nl> transpile : [ <nl> 
mmm a / packages / chakra - ui - core / src / CAspectRatioBox / tests / CAspectRatioBox . test . js <nl> ppp b / packages / chakra - ui - core / src / CAspectRatioBox / tests / CAspectRatioBox . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> - <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> const base = { <nl> @ @ - 15 , 17 + 14 , 53 @ @ const renderComponent = ( props ) = > { <nl> return render ( base ) <nl> } <nl> + / * * <nl> + * Not sure if we need jest - emotion <nl> + * <nl> + * Get styles from document . styleSheets <nl> + * @ param { String } selector <nl> + * / <nl> + function getElementStyles ( selector ) { <nl> + selector = new RegExp ( selector ) <nl> + let styles = [ ] <nl> + let i ; let j ; let sel = selector <nl> + for ( i = 0 ; i < document . styleSheets . length ; + + i ) { <nl> + for ( j = 0 ; j < document . styleSheets [ i ] . cssRules . length ; + + j ) { <nl> + if ( sel . test ( document . styleSheets [ i ] . cssRules [ j ] . selectorText ) ) { <nl> + / / let selectorText = document . styleSheets [ i ] . cssRules [ j ] . selectorText <nl> + let cssText = document . styleSheets [ i ] . cssRules [ j ] . style . cssText <nl> + styles + = cssText <nl> + } <nl> + } <nl> + } <nl> + return styles <nl> + } <nl> + <nl> it ( ' should render correctly ' , ( ) = > { <nl> const inlineAttrs = ' : ratio = " 1 " ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> + <nl> + const [ , emotionClassName ] = [ . . . screen . getByTestId ( ' aspectRatioBox ' ) . classList ] <nl> + const pseudoStyles = getElementStyles ( ` . $ { emotionClassName } : before ` ) <nl> + <nl> + expect ( pseudoStyles ) . toContain ( ` <nl> + padding - bottom : 100 % <nl> + ` . trim ( ) ) <nl> } ) <nl> - it ( ' should have correct styles ' , ( ) = > { <nl> - const inlineAttrs = ' : ratio = " 2 " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> - const image = getByTestId ( ' image ' ) <nl> - const aspectRatioBox = getByTestId ( ' aspectRatioBox ' ) <nl> + it ( ' should have correct styles ' , async ( ) = > { <nl> + const inlineAttrs = ` : ratio = " 2 " ` <nl> + renderComponent ( { inlineAttrs } ) <nl> + const image = screen . getByTestId ( ' image ' ) <nl> + const aspectRatioBox = screen . getByTestId ( ' aspectRatioBox ' ) <nl> + <nl> + const [ , emotionClassName ] = [ . . . aspectRatioBox . classList ] <nl> + const pseudoStyles = getElementStyles ( ` . $ { emotionClassName } : before ` ) <nl> + <nl> + expect ( pseudoStyles ) . toContain ( ` <nl> + padding - bottom : 50 % <nl> + ` . trim ( ) ) <nl> expect ( aspectRatioBox ) . toHaveStyle ( ` <nl> max - width : 400px ; <nl> @ @ - 40 , 7 + 75 , 4 @ @ it ( ' should have correct styles ' , ( ) = > { <nl> top : 0px ; <nl> left : 0px ; <nl> ` ) <nl> - <nl> - / / TODO : we can ' t test pseudo elements . . so better test styles ? <nl> - / / aspectRatioBox padding - bottom <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CAlertDialog / tests / CAlertDialog . test . js <nl> ppp b / packages / chakra - ui - core / src / CAlertDialog / tests / CAlertDialog . test . js <nl> import { CButton , CAlertDialog , CAlertDialogContent , CAlertDialogBody , CAlertDialogFooter , CAlertDialogOverlay , CAlertDialogHeader } from ' . . / . . ' <nl> - import { render , userEvent , fireEvent , waitMs } from ' @ / tests / test - utils ' <nl> + import { render , userEvent , fireEvent , wait , screen } from ' @ / tests / test - utils ' <nl> import { useId } from ' @ / packages / chakra - ui - core / src / utils ' <nl> / / mocks <nl> @ @ - 49 , 18 + 48 , 19 @ @ it ( ' should render correctly ' , async ( ) = > { <nl> const inlineAttrs = ' isOpen ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> - <nl> + await wait ( ( ) = > { <nl> expect ( asFragment ( document . body . innerHTML ) ) . toMatchSnapshot ( ) <nl> } ) <nl> + } ) <nl> test ( ' clicking the close button calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' isOpen : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , methods : { close : onClose } } ) <nl> + renderComponent ( { inlineAttrs , methods : { close : onClose } } ) <nl> - await Vue . nextTick ( ) <nl> - userEvent . click ( getByTestId ( ' close - btn ' ) ) <nl> + await wait ( async ( ) = > { <nl> + await userEvent . click ( screen . getByTestId ( ' close - btn ' ) ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 68 , 12 + 68 , 12 @ @ test ( ' clicking the close button calls the onClose callback ' , async ( ) = > { <nl> test ( ' pressing " esc " calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - <nl> - await Vue . nextTick ( ) <nl> - const inputInside = getByTestId ( ' inputInsideDrawer ' ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - fireEvent . keyDown ( inputInside , { key : ' Escape ' } ) <nl> + await wait ( async ( ) = > { <nl> + const inputInside = screen . getByTestId ( ' inputInsideDrawer ' ) <nl> + await fireEvent . keyDown ( inputInside , { key : ' Escape ' } ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 81 , 12 + 81 , 12 @ @ test ( ' pressing " esc " calls the onClose callback ' , async ( ) = > { <nl> test ( ' clicking overlay calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - <nl> - await Vue . nextTick ( ) <nl> - const overlay = getByTestId ( ' overlay ' ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - userEvent . click ( overlay ) <nl> + await wait ( async ( ) = > { <nl> + const overlay = screen . getByTestId ( ' overlay ' ) <nl> + await userEvent . click ( overlay ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 96 , 11 + 96 , 11 @ @ it ( ' should have proper aria ' , async ( ) = > { <nl> const inlineAttrs = ' isOpen ' <nl> renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> - const dialog = document . querySelector ( ' section ' ) <nl> - await waitMs ( ) <nl> + let dialog <nl> + await wait ( ( ) = > { <nl> + dialog = screen . getByRole ( ' alertdialog ' ) <nl> + } ) <nl> - expect ( dialog ) . toHaveAttribute ( ' role ' , ' alertdialog ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - modal ' , ' true ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - labelledby ' , ' alert - dialog - 1 - label ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - describedby ' , ' alert - dialog - 1 - desc ' ) <nl> 
mmm a / packages / chakra - ui - core / src / CBreadcrumb / tests / CBreadcrumb . test . js <nl> ppp b / packages / chakra - ui - core / src / CBreadcrumb / tests / CBreadcrumb . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 49 , 7 + 49 , 7 @ @ it ( ' should display custom seperator ' , ( ) = > { <nl> } ) <nl> it ( ' should have the proper aria - attributes ' , ( ) = > { <nl> - const { getByText , getAllByRole , getByLabelText } = renderComponent ( { <nl> + renderComponent ( { <nl> template : ` <nl> < CBreadcrumb > <nl> < CBreadcrumbItem > <nl> @ @ - 65 , 12 + 65 , 12 @ @ it ( ' should have the proper aria - attributes ' , ( ) = > { <nl> } ) <nl> / / surrounding ` nav ` has aria - label = " breadcrumb " <nl> - getByLabelText ( ' breadcrumb ' , { selector : ' nav ' } ) <nl> + screen . getByLabelText ( ' breadcrumb ' , { selector : ' nav ' } ) <nl> / / ` isCurrentPage ` link has aria - current = " page " <nl> - const currentPageLink = getByText ( ' Contact ' ) <nl> + const currentPageLink = screen . getByText ( ' Contact ' ) <nl> expect ( currentPageLink ) . toHaveAttribute ( ' aria - current ' , ' page ' ) <nl> / / separator receives presentation = " role " <nl> - expect ( getAllByRole ( ' presentation ' ) ) . toHaveLength ( 2 ) <nl> + expect ( screen . getAllByRole ( ' presentation ' ) ) . toHaveLength ( 2 ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CButton / tests / CButton . test . js <nl> ppp b / packages / chakra - ui - core / src / CButton / tests / CButton . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 17 , 26 + 17 , 19 @ @ it ( ' should render correctly ' , ( ) = > { <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> - it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( { template : ' < CButton > < span > Works < / span > < / CButton > ' } ) <nl> - expect ( getByText ( ' Works ' ) ) . toBeInTheDocument ( ) <nl> - } ) <nl> - <nl> it ( ' should display button with left icon ' , ( ) = > { <nl> - const { container , asFragment } = renderComponent ( { template : ' < CButton leftIcon = " email " > Email < / CButton > ' } ) <nl> - expect ( container . querySelector ( ' button > svg ' ) ) . toBeInTheDocument ( ) <nl> + const { asFragment } = renderComponent ( { template : ' < CButton leftIcon = " email " > Email < / CButton > ' } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> it ( ' should display button with right icon ' , ( ) = > { <nl> - const { container , asFragment } = renderComponent ( { template : ' < CButton rightIcon = " email " > Email < / CButton > ' } ) <nl> - expect ( container . querySelector ( ' button > svg ' ) ) . toBeInTheDocument ( ) <nl> + const { asFragment } = renderComponent ( { template : ' < CButton rightIcon = " email " > Email < / CButton > ' } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> it ( ' should display spinner and hide text ' , ( ) = > { <nl> - const { getByTestId , container } = renderComponent ( { template : ' < CButton isLoading data - testid = " btn " > CButton < / CButton > ' } ) <nl> - const button = getByTestId ( ' btn ' ) <nl> + const { container } = renderComponent ( { template : ' < CButton isLoading data - testid = " btn " > CButton < / CButton > ' } ) <nl> + const button = screen . getByTestId ( ' btn ' ) <nl> expect ( button ) . toHaveAttribute ( ' disabled ' ) <nl> expect ( button ) . toHaveAttribute ( ' aria - disabled ' , ' true ' ) <nl> @ @ - 47 , 15 + 40 , 15 @ @ it ( ' should display spinner and hide text ' , ( ) = > { <nl> } ) <nl> it ( ' should display spinner with text ' , ( ) = > { <nl> - const { getByText , container } = renderComponent ( { template : ' < CButton isLoading loadingText = " Submitting " data - testid = " Spinner " > Button < / CButton > ' } ) <nl> + const { container } = renderComponent ( { template : ' < CButton isLoading loadingText = " Submitting " data - testid = " Spinner " > Button < / CButton > ' } ) <nl> - expect ( getByText ( ' Submitting ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' Submitting ' ) ) . toBeInTheDocument ( ) <nl> const spinner = container . querySelector ( ' [ data - chakra - component = CSpinner ] ' ) <nl> expect ( spinner ) . toBeInTheDocument ( ) <nl> } ) <nl> it ( ' should display a disabled button ' , ( ) = > { <nl> - const { getByText } = renderComponent ( { template : ' < CButton isDisabled > Button < / CButton > ' } ) <nl> + renderComponent ( { template : ' < CButton isDisabled > Button < / CButton > ' } ) <nl> - expect ( getByText ( ' Button ' ) ) . toHaveAttribute ( ' disabled ' ) <nl> + expect ( screen . getByText ( ' Button ' ) ) . toHaveAttribute ( ' disabled ' ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CButtonGroup / tests / CButtonGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / CButtonGroup / tests / CButtonGroup . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 21 , 9 + 21 , 3 @ @ it ( ' should render correctly ' , ( ) = > { <nl> const { asFragment } = renderComponent ( ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> - <nl> - it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> - expect ( getByText ( ' Button1 ' ) ) . toBeInTheDocument ( ) <nl> - expect ( getByText ( ' Button2 ' ) ) . toBeInTheDocument ( ) <nl> - } ) <nl> 
mmm a / packages / chakra - ui - core / src / CAvatar / tests / CAvatar . test . js <nl> ppp b / packages / chakra - ui - core / src / CAvatar / tests / CAvatar . test . js <nl> } ) <nl> it ( ' renders a name avatar if no src ' , async ( ) = > { <nl> - renderComponent ( { template : ' < CAvatar data - testid = " avatar " name = " Mesut Koca " / > ' } ) <nl> + renderComponent ( { template : ' < CAvatar name = " Mesut Koca " / > ' } ) <nl> await wait ( ( ) = > { <nl> expect ( screen . getByLabelText ( / Mesut Koca / i ) ) . toBeInTheDocument ( ) <nl> @ @ - 73 , 7 + 73 , 7 @ @ it ( ' renders a name avatar if no src ' , async ( ) = > { <nl> } ) <nl> it ( ' renders a name avatar if src fails ' , async ( ) = > { <nl> - renderComponent ( { template : ' < CAvatar data - testid = " avatar " name = " Mesut Koca " src = " LOAD_FAILURE_SRC " / > ' } ) <nl> + renderComponent ( { template : ' < CAvatar name = " Mesut Koca " src = " LOAD_FAILURE_SRC " / > ' } ) <nl> await wait ( ( ) = > { <nl> expect ( screen . queryByAltText ( / Mesut Koca / i ) ) . not . toBeInTheDocument ( ) <nl> 
mmm a / packages / chakra - ui - core / src / CBadge / tests / __snapshots__ / CBadge . test . js . snap <nl> ppp b / packages / chakra - ui - core / src / CBadge / tests / __snapshots__ / CBadge . test . js . snap <nl> < DocumentFragment > <nl> + . emotion - 3 { <nl> + display : - webkit - box ; <nl> + display : - webkit - flex ; <nl> + display : - ms - flexbox ; <nl> + display : flex ; <nl> + - webkit - flex - direction : row ; <nl> + - ms - flex - direction : row ; <nl> + flex - direction : row ; <nl> + } <nl> + <nl> + . emotion - 0 { <nl> + display : inline - block ; <nl> + text - transform : uppercase ; <nl> + font - size : 0 . 75rem ; <nl> + font - family : - apple - system , BlinkMacSystemFont , " Segoe UI " , Helvetica , Arial , sans - serif , " Apple Color Emoji " , " Segoe UI Emoji " , " Segoe UI Symbol " ; <nl> + padding - left : 0 . 25rem ; <nl> + padding - right : 0 . 25rem ; <nl> + border - radius : 0 . 125rem ; <nl> + font - weight : 700 ; <nl> + white - space : nowrap ; <nl> + vertical - align : middle ; <nl> + background - color : # c2ebd4 ; <nl> + color : # 0f3921 ; <nl> + margin - left : 0 . 5rem ; <nl> + margin - right : 0 . 5rem ; <nl> + } <nl> + <nl> + . emotion - 1 { <nl> + display : inline - block ; <nl> + text - transform : uppercase ; <nl> + font - size : 0 . 75rem ; <nl> + font - family : - apple - system , BlinkMacSystemFont , " Segoe UI " , Helvetica , Arial , sans - serif , " Apple Color Emoji " , " Segoe UI Emoji " , " Segoe UI Symbol " ; <nl> + padding - left : 0 . 25rem ; <nl> + padding - right : 0 . 25rem ; <nl> + border - radius : 0 . 125rem ; <nl> + font - weight : 700 ; <nl> + white - space : nowrap ; <nl> + vertical - align : middle ; <nl> + background - color : # 3ea76a ; <nl> + color : # fff ; <nl> + margin - left : 0 . 5rem ; <nl> + margin - right : 0 . 5rem ; <nl> + } <nl> + <nl> + . emotion - 2 { <nl> + display : inline - block ; <nl> + text - transform : uppercase ; <nl> + font - size : 0 . 75rem ; <nl> + font - family : - apple - system , BlinkMacSystemFont , " Segoe UI " , Helvetica , Arial , sans - serif , " Apple Color Emoji " , " Segoe UI Emoji " , " Segoe UI Symbol " ; <nl> + padding - left : 0 . 25rem ; <nl> + padding - right : 0 . 25rem ; <nl> + border - radius : 0 . 125rem ; <nl> + font - weight : 700 ; <nl> + white - space : nowrap ; <nl> + vertical - align : middle ; <nl> + box - shadow : inset 0 0 0px 1px # 3ea76a ; <nl> + color : # 3ea76a ; <nl> + margin - left : 0 . 5rem ; <nl> + margin - right : 0 . 5rem ; <nl> + } <nl> + <nl> < div <nl> - class = " css - jlqe4x " <nl> - data - chakra - component = " CStack " <nl> + class = " emotion - 3 " <nl> + data - chakra - component = " CFlex " <nl> > <nl> < div <nl> - class = " css - 288q6q " <nl> + class = " emotion - 0 " <nl> data - chakra - component = " CBadge " <nl> > <nl> Subtle <nl> < / div > <nl> < div <nl> - class = " css - 4lwleq " <nl> + class = " emotion - 1 " <nl> data - chakra - component = " CBadge " <nl> > <nl> Solid <nl> < / div > <nl> < div <nl> - class = " css - n4e54f " <nl> + class = " emotion - 2 " <nl> data - chakra - component = " CBadge " <nl> > <nl> Outline <nl> @ @ - 30 , 8 + 91 , 23 @ @ exports [ ` should apply variant styles corectly 1 ` ] = ` <nl> exports [ ` should render correctly 1 ` ] = ` <nl> < DocumentFragment > <nl> + . emotion - 0 { <nl> + display : inline - block ; <nl> + text - transform : uppercase ; <nl> + font - size : 0 . 75rem ; <nl> + font - family : - apple - system , BlinkMacSystemFont , " Segoe UI " , Helvetica , Arial , sans - serif , " Apple Color Emoji " , " Segoe UI Emoji " , " Segoe UI Symbol " ; <nl> + padding - left : 0 . 25rem ; <nl> + padding - right : 0 . 25rem ; <nl> + border - radius : 0 . 125rem ; <nl> + font - weight : 700 ; <nl> + white - space : nowrap ; <nl> + vertical - align : middle ; <nl> + background - color : # EDF2F7 ; <nl> + color : # 1A202C ; <nl> + } <nl> + <nl> < div <nl> - class = " css - 96ute0 " <nl> + class = " emotion - 0 " <nl> data - chakra - component = " CBadge " <nl> > <nl> 500 <nl> 
mmm a / packages / chakra - ui - core / src / CAccordion / tests / CAccordion . test . js <nl> ppp b / packages / chakra - ui - core / src / CAccordion / tests / CAccordion . test . js <nl> expect ( panel ) . toHaveAttribute ( ' aria - labelledby ' ) <nl> } ) <nl> - / / test that tab moves focus to the next focusable element <nl> it ( ' tab moves focus to the next focusable element ' , async ( ) = > { <nl> renderComponent ( { <nl> template : ` <nl> @ @ - 178 , 7 + 177 , 43 @ @ it ( ' tab moves focus to the next focusable element ' , async ( ) = > { <nl> expect ( last ) . toHaveFocus ( ) <nl> } ) <nl> - / / test that aria - contols for button is same as id for panel <nl> + <nl> + it ( ' shift + tab moves focus to the previous focusable element ' , async ( ) = > { <nl> + renderComponent ( { <nl> + template : ` <nl> + < CAccordion > <nl> + < CAccordionItem > <nl> + < CAccordionHeader > First section < / CAccordionHeader > <nl> + < CAccordionPanel > Panel 1 < / CAccordionPanel > <nl> + < / CAccordionItem > <nl> + < CAccordionItem > <nl> + < CAccordionHeader > Second section < / CAccordionHeader > <nl> + < CAccordionPanel > Panel 2 < / CAccordionPanel > <nl> + < / CAccordionItem > <nl> + < CAccordionItem > <nl> + < CAccordionHeader > Last section < / CAccordionHeader > <nl> + < CAccordionPanel > Panel 3 < / CAccordionPanel > <nl> + < / CAccordionItem > <nl> + < / CAccordion > ` <nl> + } ) <nl> + <nl> + const first = screen . getByText ( ' First section ' ) <nl> + const second = screen . getByText ( ' Second section ' ) <nl> + const last = screen . getByText ( ' Last section ' ) <nl> + <nl> + await userEvent . tab ( ) <nl> + expect ( first ) . toHaveFocus ( ) <nl> + <nl> + await userEvent . tab ( ) <nl> + expect ( second ) . toHaveFocus ( ) <nl> + <nl> + await userEvent . tab ( ) <nl> + expect ( last ) . toHaveFocus ( ) <nl> + <nl> + await userEvent . tab ( { shift : true } ) / / shift + tab <nl> + expect ( second ) . toHaveFocus ( ) <nl> + } ) <nl> + <nl> it ( ' aria - contols for button is same as id for panel ' , ( ) = > { <nl> renderComponent ( { <nl> template : ` <nl> @ @ - 195 , 7 + 230 , 6 @ @ it ( ' aria - contols for button is same as id for panel ' , ( ) = > { <nl> expect ( button . getAttribute ( ' aria - controls ' ) ) . toEqual ( panel . getAttribute ( ' id ' ) ) <nl> } ) <nl> - / / test that aria - expanded is true / false when accordion is open / closed <nl> it ( ' aria - expanded is true / false when accordion is open / closed ' , ( ) = > { <nl> renderComponent ( { <nl> template : ` <nl> @ @ - 215 , 7 + 249 , 6 @ @ it ( ' aria - expanded is true / false when accordion is open / closed ' , ( ) = > { <nl> expect ( button ) . toHaveAttribute ( ' aria - expanded ' , ' true ' ) <nl> } ) <nl> - / / test that panel has role = region and aria - labelledby <nl> it ( ' panel has role = region and aria - labelledby ' , ( ) = > { <nl> renderComponent ( { <nl> template : ` <nl> @ @ - 231 , 29 + 264 , 3 @ @ it ( ' panel has role = region and aria - labelledby ' , ( ) = > { <nl> expect ( panel ) . toHaveAttribute ( ' aria - labelledby ' ) <nl> expect ( panel ) . toHaveAttribute ( ' role ' , ' region ' ) <nl> } ) <nl> \ No newline at end of file <nl> - <nl> - / / eslint - disable - next - line no - undef <nl> - xit ( ' arrow up & down moves focus to next / previous accordion ' , async ( ) = > { <nl> - renderComponent ( { <nl> - template : ` <nl> - < CAccordion > <nl> - < CAccordionItem > <nl> - < CAccordionHeader > Section 1 title < / CAccordionHeader > <nl> - < CAccordionPanel > Panel 1 < / CAccordionPanel > <nl> - < / CAccordionItem > <nl> - < CAccordionItem > <nl> - < CAccordionHeader > Section 2 title < / CAccordionHeader > <nl> - < CAccordionPanel > Panel 2 < / CAccordionPanel > <nl> - < / CAccordionItem > <nl> - < / CAccordion > ` <nl> - } ) <nl> - <nl> - const first = screen . getByText ( ' Section 1 title ' ) <nl> - const second = screen . getByText ( ' Section 2 title ' ) <nl> - <nl> - await fireEvent . keyDown ( first , { key : ' ArrowDown ' , keyCode : 40 } ) <nl> - expect ( second ) . toHaveFocus ( ) <nl> - <nl> - await fireEvent . keyDown ( second , { key : ' ArrowUp ' , keyCode : 38 } ) <nl> - expect ( first ) . toHaveFocus ( ) <nl> - } ) <nl> 
mmm a / packages / chakra - ui - core / src / CBadge / tests / CBadge . test . js <nl> ppp b / packages / chakra - ui - core / src / CBadge / tests / CBadge . test . js <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> - it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> - <nl> - expect ( getByText ( ' 500 ' ) ) . toBeInTheDocument ( ) <nl> - } ) <nl> - <nl> it ( ' should apply variant styles corectly ' , ( ) = > { <nl> const { asFragment } = renderComponent ( { <nl> template : ` <nl> 
mmm a / packages / chakra - ui - core / src / CBox / tests / CBox . test . js <nl> ppp b / packages / chakra - ui - core / src / CBox / tests / CBox . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 22 , 9 + 22 , 9 @ @ it ( ' should change the style ' , ( ) = > { <nl> d = " flex " : w = " [ ' auto ' ] " px = " 5 " py = " 5 " shadow = " lg " <nl> my = " 5 " mb = " 5 " rounded = " sm " font - family = " body " <nl> background - color = " blue . 200 " color = " blue . 700 " ` <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - const box = getByTestId ( ' box ' ) <nl> + const box = screen . getByTestId ( ' box ' ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> expect ( box ) . toHaveStyle ( ' display : flex ' ) <nl> 
mmm a / packages / chakra - ui - core / src / CCheckboxGroup / tests / CCheckboxGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / CCheckboxGroup / tests / CCheckboxGroup . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen , wait } from ' @ / tests / test - utils ' <nl> / / mocks <nl> import { useId } from ' @ / packages / chakra - ui - core / src / utils ' <nl> @ @ - 33 , 20 + 33 , 18 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> - expect ( getByText ( ' One ' ) ) . toBeInTheDocument ( ) <nl> - expect ( getByText ( ' Two ' ) ) . toBeInTheDocument ( ) <nl> - expect ( getByText ( ' Three ' ) ) . toBeInTheDocument ( ) <nl> + renderComponent ( ) <nl> + expect ( screen . getByText ( ' One ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' Two ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' Three ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' selectedValues prop works ' , ( ) = > { <nl> - const { getByTestId } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - const one = getByTestId ( ' one ' ) . querySelector ( ' input ' ) <nl> - const two = getByTestId ( ' two ' ) . querySelector ( ' input ' ) <nl> - const three = getByTestId ( ' three ' ) . querySelector ( ' input ' ) <nl> - <nl> - expect ( one ) . not . toBeChecked ( ) <nl> - expect ( two ) . toBeChecked ( ) <nl> - expect ( three ) . not . toBeChecked ( ) <nl> + wait ( ( ) = > { <nl> + expect ( screen . getByLabelText ( ' One ' ) ) . not . toBeChecked ( ) <nl> + expect ( screen . getByLabelText ( ' Two ' ) ) . toBeChecked ( ) <nl> + expect ( screen . getByLabelText ( ' Three ' ) ) . not . toBeChecked ( ) <nl> + } ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CCircularProgress / tests / CCircularProgress . test . js <nl> ppp b / packages / chakra - ui - core / src / CCircularProgress / tests / CCircularProgress . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 20 , 26 + 20 , 26 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should display a label ' , ( ) = > { <nl> - const { queryByText } = renderComponent ( { <nl> + renderComponent ( { <nl> template : ` <nl> < CCircularProgress : value = " 40 " > <nl> < CCircularProgressLabel > 40 % < / CCircularProgressLabel > <nl> < / CCircularProgress > ` <nl> } ) <nl> - expect ( queryByText ( ' 40 % ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' 40 % ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' a11y - progress has a " role " set to " progressbar " ' , ( ) = > { <nl> - const { queryByRole } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( queryByRole ( ' progressbar ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . queryByRole ( ' progressbar ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' a11y - progress has a " aria - valuenow " set to the percentage completion value ' , ( ) = > { <nl> - const { queryByTestId } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( queryByTestId ( ' CircularProgress ' ) ) . toHaveAttribute ( <nl> + expect ( screen . queryByTestId ( ' CircularProgress ' ) ) . toHaveAttribute ( <nl> ' aria - valuenow ' , <nl> ' 40 ' <nl> ) <nl> 
mmm a / packages / chakra - ui - core / src / CCloseButton / tests / CloseButton . test . js <nl> ppp b / packages / chakra - ui - core / src / CCloseButton / tests / CloseButton . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 14 , 18 + 14 , 18 @ @ it ( ' should render correctly ' , ( ) = > { <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> it ( ' should allow setting a custom aria - label for the button ' , ( ) = > { <nl> - const { container } = renderComponent ( { template : ' < CloseButton aria - label = " my aria label " / > ' } ) <nl> + renderComponent ( { template : ' < CloseButton aria - label = " my aria label " / > ' } ) <nl> - expect ( container . querySelector ( ' button ' ) ) . toHaveAttribute ( <nl> + expect ( screen . getByLabelText ( ' my aria label ' ) ) . toHaveAttribute ( <nl> ' aria - label ' , <nl> ' my aria label ' <nl> ) <nl> } ) <nl> test ( ' a11y - should have aria - label set to " Close " ' , ( ) = > { <nl> - const { container } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( container . querySelector ( ' button ' ) ) . toHaveAttribute ( <nl> + expect ( screen . getByLabelText ( ' Close ' ) ) . toHaveAttribute ( <nl> ' aria - label ' , <nl> ' Close ' <nl> ) <nl> 
mmm a / packages / chakra - ui - core / src / CCode / tests / CCode . test . js <nl> ppp b / packages / chakra - ui - core / src / CCode / tests / CCode . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 16 , 7 + 16 , 7 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( getByText ( ' content ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' content ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CControlBox / tests / CControlBox . test . js <nl> ppp b / packages / chakra - ui - core / src / CControlBox / tests / CControlBox . test . js <nl> - import { render , userEvent } from ' @ / tests / test - utils ' <nl> + import { render , userEvent , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 43 , 9 + 43 , 9 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> test ( ' Uncontrolled radio - should be checked always ' , async ( ) = > { <nl> - const { getByTestId } = renderComponent ( { type : ' radio ' } ) <nl> - const control = getByTestId ( ' control ' ) <nl> - const hiddenControl = getByTestId ( ' hiddenControl ' ) <nl> + renderComponent ( { type : ' radio ' } ) <nl> + const control = screen . getByTestId ( ' control ' ) <nl> + const hiddenControl = screen . getByTestId ( ' hiddenControl ' ) <nl> / / click the first time , it ' s checked <nl> await userEvent . click ( control ) <nl> @ @ - 57 , 9 + 57 , 9 @ @ test ( ' Uncontrolled radio - should be checked always ' , async ( ) = > { <nl> } ) <nl> test ( ' Uncontrolled checkbox - should toggle ' , async ( ) = > { <nl> - const { getByTestId } = renderComponent ( { type : ' checkbox ' } ) <nl> - const control = getByTestId ( ' control ' ) <nl> - const hiddenControl = getByTestId ( ' hiddenControl ' ) <nl> + renderComponent ( { type : ' checkbox ' } ) <nl> + const control = screen . getByTestId ( ' control ' ) <nl> + const hiddenControl = screen . getByTestId ( ' hiddenControl ' ) <nl> / / click the first time , it ' s checked <nl> await userEvent . click ( control ) <nl> @ @ - 72 , 9 + 72 , 9 @ @ test ( ' Uncontrolled checkbox - should toggle ' , async ( ) = > { <nl> test ( ' controlled checkbox - v - model works ' , async ( ) = > { <nl> const inlineAttrs = ' : checked = " checked " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , type : ' checkbox ' , data : ( ) = > ( { checked : true } ) } ) <nl> - const control = getByTestId ( ' control ' ) <nl> - const hiddenControl = getByTestId ( ' hiddenControl ' ) <nl> + renderComponent ( { inlineAttrs , type : ' checkbox ' , data : ( ) = > ( { checked : true } ) } ) <nl> + const control = screen . getByTestId ( ' control ' ) <nl> + const hiddenControl = screen . getByTestId ( ' hiddenControl ' ) <nl> / / click the first time , it ' s checked <nl> expect ( hiddenControl ) . toBeChecked ( ) <nl> @ @ - 86 , 9 + 86 , 9 @ @ test ( ' controlled checkbox - v - model works ' , async ( ) = > { <nl> test ( ' controlled radio - v - model works ' , async ( ) = > { <nl> const inlineAttrs = ' : checked = " checked " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , type : ' radio ' , data : ( ) = > ( { checked : true } ) } ) <nl> - const control = getByTestId ( ' control ' ) <nl> - const hiddenControl = getByTestId ( ' hiddenControl ' ) <nl> + renderComponent ( { inlineAttrs , type : ' radio ' , data : ( ) = > ( { checked : true } ) } ) <nl> + const control = screen . getByTestId ( ' control ' ) <nl> + const hiddenControl = screen . getByTestId ( ' hiddenControl ' ) <nl> / / click the first time , it ' s checked <nl> expect ( hiddenControl ) . toBeChecked ( ) <nl> 
mmm a / packages / chakra - ui - core / src / CDrawer / tests / CDrawer . test . js <nl> ppp b / packages / chakra - ui - core / src / CDrawer / tests / CDrawer . test . js <nl> import { CInput , CButton , CDrawer , CDrawerBody , CDrawerFooter , CDrawerHeader , CDrawerOverlay , CDrawerContent , CDrawerCloseButton } from ' . . / . . / ' <nl> - import { render , userEvent , fireEvent , waitMs } from ' @ / tests / test - utils ' <nl> + import { render , userEvent , fireEvent , waitMs , wait , screen } from ' @ / tests / test - utils ' <nl> import { useId } from ' @ / packages / chakra - ui - core / src / utils ' <nl> / / mocks <nl> @ @ - 49 , 7 + 48 , 7 @ @ it ( ' should render correctly ' , async ( ) = > { <nl> const inlineAttrs = ' isOpen ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> + await waitMs ( ) / / render <nl> expect ( asFragment ( document . body . innerHTML ) ) . toMatchSnapshot ( ) <nl> } ) <nl> @ @ - 57 , 10 + 56 , 11 @ @ it ( ' should render correctly ' , async ( ) = > { <nl> test ( ' clicking the close button calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' isOpen : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , methods : { close : onClose } } ) <nl> + renderComponent ( { inlineAttrs , methods : { close : onClose } } ) <nl> - await Vue . nextTick ( ) <nl> - userEvent . click ( getByTestId ( ' close - btn ' ) ) <nl> + await wait ( ( ) = > { <nl> + userEvent . click ( screen . getByTestId ( ' close - btn ' ) ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 68 , 12 + 68 , 12 @ @ test ( ' clicking the close button calls the onClose callback ' , async ( ) = > { <nl> test ( ' pressing " esc " calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - <nl> - await Vue . nextTick ( ) <nl> - const inputInside = getByTestId ( ' inputInsideDrawer ' ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - fireEvent . keyDown ( inputInside , { key : ' Escape ' } ) <nl> + await wait ( async ( ) = > { <nl> + const inputInside = screen . getByTestId ( ' inputInsideDrawer ' ) <nl> + await fireEvent . keyDown ( inputInside , { key : ' Escape ' } ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 81 , 52 + 81 , 54 @ @ test ( ' pressing " esc " calls the onClose callback ' , async ( ) = > { <nl> test ( ' clicking overlay calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - await Vue . nextTick ( ) <nl> - const overlay = getByTestId ( ' overlay ' ) <nl> - <nl> - userEvent . click ( overlay ) <nl> + await wait ( async ( ) = > { <nl> + const overlay = screen . getByTestId ( ' overlay ' ) <nl> + await fireEvent . click ( overlay ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> test ( ' focuses the initial focus ref when opened - initialFocusRef ' , async ( ) = > { <nl> const inlineAttrs = ' isOpen : on - close = " close " : initialFocusRef = " ( ) = > $ refs . inputInsideDrawer " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> - const inputInside = getByTestId ( ' inputInsideDrawer ' ) <nl> + await waitMs ( ) / / render <nl> - await waitMs ( ) <nl> - expect ( inputInside ) . toHaveFocus ( ) <nl> + await wait ( ( ) = > { <nl> + expect ( screen . getByTestId ( ' inputInsideDrawer ' ) ) . toHaveFocus ( ) <nl> + } ) <nl> } ) <nl> test ( ' returns focus when closed - finalFocusRef ' , async ( ) = > { <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " : finalFocusRef = " $ refs . inputOutsideDrawer " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) } ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) } ) <nl> + <nl> + await waitMs ( ) / / render <nl> - await Vue . nextTick ( ) <nl> - const inputOutside = getByTestId ( ' inputOutsideDrawer ' ) <nl> - const closeButton = getByTestId ( ' close - btn ' ) <nl> + const inputOutside = screen . getByTestId ( ' inputOutsideDrawer ' ) <nl> + const closeButton = screen . getByTestId ( ' close - btn ' ) <nl> - await userEvent . click ( closeButton ) <nl> - await waitMs ( ) <nl> + await fireEvent . click ( closeButton ) <nl> + await wait ( ( ) = > { <nl> expect ( inputOutside ) . toHaveFocus ( ) <nl> } ) <nl> + } ) <nl> it ( ' should have proper aria ' , async ( ) = > { <nl> useId . mockReturnValueOnce ( ' 1 ' ) <nl> const inlineAttrs = ' isOpen ' <nl> renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> - const dialog = document . querySelector ( ' section ' ) <nl> - await waitMs ( ) <nl> + await wait ( ( ) = > { <nl> + const dialog = screen . getByRole ( ' dialog ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' role ' , ' dialog ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - modal ' , ' true ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - labelledby ' , ' drawer - 1 - header ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - describedby ' , ' drawer - 1 - body ' ) <nl> } ) <nl> + } ) <nl> 
mmm a / packages / chakra - ui - core / src / CFlex / tests / CFlex . test . js <nl> ppp b / packages / chakra - ui - core / src / CFlex / tests / CFlex . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 19 , 11 + 19 , 11 @ @ it ( ' should render correctly ' , ( ) = > { <nl> it ( ' should change styles ' , ( ) = > { <nl> const inlineAttrs = ' align = " center " justify = " center " direction = " column " ' <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> - const flex = getByTestId ( ' flex ' ) <nl> + const flex = screen . getByTestId ( ' flex ' ) <nl> expect ( flex ) . toHaveStyle ( ' display : flex ' ) <nl> expect ( flex ) . toHaveStyle ( ' align - items : center ' ) <nl> expect ( flex ) . toHaveStyle ( ' justify - content : center ' ) <nl> 
mmm a / packages / chakra - ui - core / src / CIconButton / tests / CIconButton . test . js <nl> ppp b / packages / chakra - ui - core / src / CIconButton / tests / CIconButton . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 19 , 15 + 19 , 15 @ @ it ( ' should render correctly ' , ( ) = > { <nl> it ( ' should display spinner and hide the icon ' , ( ) = > { <nl> const inlineAttrs = ' isLoading ' <nl> - const { container , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + const { container } = renderComponent ( { inlineAttrs } ) <nl> - const button = getByTestId ( ' btn ' ) <nl> + const button = screen . getByTestId ( ' btn ' ) <nl> expect ( button ) . toHaveAttribute ( ' disabled ' ) <nl> expect ( button ) . toHaveAttribute ( ' aria - disabled ' , ' true ' ) <nl> / / TODO : find a way to easily grab the spinner element <nl> - / / Maybe ? expect ( getByTestId ( ' Spinner ' ) ) . toBeInTheDocument ( ) <nl> + / / Maybe ? expect ( screen . getByTestId ( ' Spinner ' ) ) . toBeInTheDocument ( ) <nl> expect ( button ) . toHaveStyle ( ' opacity : 0 . 4 ' ) <nl> expect ( container . querySelector ( ' button > div ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CButtonGroup / tests / CButtonGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / CButtonGroup / tests / CButtonGroup . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 23 , 7 + 23 , 7 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should attach buttons when ` is - attached ` is passed ' , ( ) = > { <nl> - const { asFragment , getByText } = renderComponent ( { <nl> + const { asFragment } = renderComponent ( { <nl> template : ` <nl> < CButtonGroup isAttached > <nl> < CButton > Button1 < / CButton > <nl> @ @ - 31 , 13 + 31 , 13 @ @ it ( ' should attach buttons when ` is - attached ` is passed ' , ( ) = > { <nl> < / CButtonGroup > ` <nl> } ) <nl> - const button = getByText ( ' Button1 ' ) <nl> + const button = screen . getByText ( ' Button1 ' ) <nl> expect ( button ) . toHaveStyle ( ' border - top - right - radius : 0 ; border - bottom - right - radius : 0 ; ' ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> - expect ( getByText ( ' Button1 ' ) ) . toBeInTheDocument ( ) <nl> - expect ( getByText ( ' Button2 ' ) ) . toBeInTheDocument ( ) <nl> + renderComponent ( ) <nl> + expect ( screen . getByText ( ' Button1 ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' Button2 ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CDivider / tests / CDivider . test . js <nl> ppp b / packages / chakra - ui - core / src / CDivider / tests / CDivider . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 26 , 9 + 26 , 9 @ @ it ( ' should change orientation ' , ( ) = > { <nl> it ( ' should have corresponding aria - orientation attribute ' , ( ) = > { <nl> const inlineAttrs = ' orientation = " horizontal " ' <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - const divider = getByTestId ( ' divider ' ) <nl> + const divider = screen . getByTestId ( ' divider ' ) <nl> expect ( divider ) . toHaveAttribute ( ' aria - orientation ' , ' horizontal ' ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CFormControl / tests / CFormControl . test . js <nl> ppp b / packages / chakra - ui - core / src / CFormControl / tests / CFormControl . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 22 , 7 + 22 , 7 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should provide formcontrol state via scoped slot ' , ( ) = > { <nl> - const { getByTestId } = renderComponent ( { <nl> + renderComponent ( { <nl> template : ` <nl> < CFormControl isRequired isReadOnly # default = " props " > <nl> < pre data - testid = " pre " > <nl> @ @ - 31 , 7 + 31 , 7 @ @ it ( ' should provide formcontrol state via scoped slot ' , ( ) = > { <nl> < / CFormControl > ` <nl> } ) <nl> - const pre = getByTestId ( ' pre ' ) <nl> + const pre = screen . getByTestId ( ' pre ' ) <nl> expect ( JSON . parse ( pre . textContent , null , 2 ) ) . toEqual ( { <nl> isInvalid : false , <nl> isRequired : true , <nl> 
mmm a / packages / chakra - ui - core / src / CModal / tests / CModal . test . js <nl> ppp b / packages / chakra - ui - core / src / CModal / tests / CModal . test . js <nl> import { CInput , CButton , CModal , CModalOverlay , CModalContent , CModalHeader , CModalFooter , CModalBody , CModalCloseButton } from ' . . / . . ' <nl> - import { render , userEvent , fireEvent , waitMs } from ' @ / tests / test - utils ' <nl> + import { render , userEvent , fireEvent , waitMs , screen , wait } from ' @ / tests / test - utils ' <nl> import { useId , wrapEvent } from ' @ / packages / chakra - ui - core / src / utils ' <nl> / / mocks <nl> @ @ - 53 , 7 + 52 , 7 @ @ it ( ' should render correctly ' , async ( ) = > { <nl> const inlineAttrs = ' isOpen ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> + await waitMs ( ) / / render <nl> expect ( asFragment ( document . body . innerHTML ) ) . toMatchSnapshot ( ) <nl> } ) <nl> @ @ - 61 , 10 + 60 , 11 @ @ it ( ' should render correctly ' , async ( ) = > { <nl> test ( ' clicking the close button calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' isOpen : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , methods : { close : onClose } } ) <nl> + renderComponent ( { inlineAttrs , methods : { close : onClose } } ) <nl> - await Vue . nextTick ( ) <nl> - userEvent . click ( getByTestId ( ' close - btn ' ) ) <nl> + await wait ( ( ) = > { <nl> + userEvent . click ( screen . getByTestId ( ' close - btn ' ) ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 72 , 12 + 72 , 12 @ @ test ( ' clicking the close button calls the onClose callback ' , async ( ) = > { <nl> test ( ' pressing " esc " calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - <nl> - await Vue . nextTick ( ) <nl> - const inputInside = getByTestId ( ' inputInsideModal ' ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - fireEvent . keyDown ( inputInside , { key : ' Escape ' } ) <nl> + await wait ( async ( ) = > { <nl> + const inputInside = screen . getByTestId ( ' inputInsideModal ' ) <nl> + await fireEvent . keyDown ( inputInside , { key : ' Escape ' } ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> @ @ - 85 , 52 + 85 , 54 @ @ test ( ' pressing " esc " calls the onClose callback ' , async ( ) = > { <nl> test ( ' clicking overlay calls the onClose callback ' , async ( ) = > { <nl> const onClose = jest . fn ( ) <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) , methods : { close : onClose } } ) <nl> - await Vue . nextTick ( ) <nl> - const overlay = getByTestId ( ' overlay ' ) <nl> - <nl> - userEvent . click ( overlay ) <nl> + await wait ( async ( ) = > { <nl> + const overlay = screen . getByTestId ( ' overlay ' ) <nl> + await fireEvent . click ( overlay . parentElement ) <nl> + } ) <nl> expect ( onClose ) . toHaveBeenCalled ( ) <nl> } ) <nl> test ( ' focuses the initial focus ref when opened - initialFocusRef ' , async ( ) = > { <nl> const inlineAttrs = ' isOpen : on - close = " close " : initialFocusRef = " ( ) = > $ refs . inputInsideModal " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> - const inputInside = getByTestId ( ' inputInsideModal ' ) <nl> + await waitMs ( ) / / render <nl> - await waitMs ( ) <nl> - expect ( inputInside ) . toHaveFocus ( ) <nl> + await wait ( ( ) = > { <nl> + expect ( screen . getByTestId ( ' inputInsideModal ' ) ) . toHaveFocus ( ) <nl> + } ) <nl> } ) <nl> test ( ' returns focus when closed - finalFocusRef ' , async ( ) = > { <nl> const inlineAttrs = ' : isOpen = " isOpen " : on - close = " close " : finalFocusRef = " $ refs . inputOutsideModal " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) } ) <nl> + renderComponent ( { inlineAttrs , data : ( ) = > ( { isOpen : true } ) } ) <nl> + <nl> + await waitMs ( ) / / render <nl> - await Vue . nextTick ( ) <nl> - const inputOutside = getByTestId ( ' inputOutsideModal ' ) <nl> - const closeButton = getByTestId ( ' close - btn ' ) <nl> + const inputOutside = screen . getByTestId ( ' inputOutsideModal ' ) <nl> + const closeButton = screen . getByTestId ( ' close - btn ' ) <nl> - await userEvent . click ( closeButton ) <nl> - await waitMs ( ) <nl> + await fireEvent . click ( closeButton ) <nl> + await wait ( ( ) = > { <nl> expect ( inputOutside ) . toHaveFocus ( ) <nl> } ) <nl> + } ) <nl> it ( ' should have proper aria ' , async ( ) = > { <nl> useId . mockReturnValueOnce ( ' 1 ' ) <nl> const inlineAttrs = ' isOpen ' <nl> renderComponent ( { inlineAttrs } ) <nl> - await Vue . nextTick ( ) <nl> - const dialog = document . querySelector ( ' section ' ) <nl> - await waitMs ( ) <nl> + await wait ( ( ) = > { <nl> + const dialog = screen . getByRole ( ' dialog ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' role ' , ' dialog ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - modal ' , ' true ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - labelledby ' , ' modal - 1 - header ' ) <nl> expect ( dialog ) . toHaveAttribute ( ' aria - describedby ' , ' modal - 1 - body ' ) <nl> } ) <nl> + } ) <nl> 
mmm a / packages / chakra - ui - core / src / CProgress / tests / CProgress . test . js <nl> ppp b / packages / chakra - ui - core / src / CProgress / tests / CProgress . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 19 , 31 + 19 , 31 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should have the correct width ' , ( ) = > { <nl> - const { queryByRole } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( queryByRole ( ' progressbar ' ) ) . toHaveStyle ( ' width : 40 % ' ) <nl> + expect ( screen . queryByRole ( ' progressbar ' ) ) . toHaveStyle ( ' width : 40 % ' ) <nl> } ) <nl> it ( ' should display a label ' , ( ) = > { <nl> - const { queryByText } = renderComponent ( { <nl> + renderComponent ( { <nl> template : ` <nl> < CProgress : value = " 40 " > <nl> < CProgressLabel > Label < / CProgressLabel > <nl> < / CProgress > ` <nl> } ) <nl> - expect ( queryByText ( ' Label ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . queryByText ( ' Label ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' a11y - progress has a " role " set to " progressbar " ' , ( ) = > { <nl> - const { queryByRole } = renderComponent ( ) <nl> - expect ( queryByRole ( ' progressbar ' ) ) . toBeInTheDocument ( ) <nl> + renderComponent ( ) <nl> + expect ( screen . queryByRole ( ' progressbar ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' a11y - progress has a " aria - valuenow " set to the percentage completion value ' , ( ) = > { <nl> - const { queryByRole } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( queryByRole ( ' progressbar ' ) ) . toHaveAttribute ( <nl> + expect ( screen . queryByRole ( ' progressbar ' ) ) . toHaveAttribute ( <nl> ' aria - valuenow ' , <nl> ' 40 ' <nl> ) <nl> 
mmm a / packages / chakra - ui - core / src / CPseudoBox / tests / CPseudoBox . test . js <nl> ppp b / packages / chakra - ui - core / src / CPseudoBox / tests / CPseudoBox . test . js <nl> - import { render , getTagName } from ' @ / tests / test - utils ' <nl> + import { render , getTagName , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 21 , 9 + 21 , 9 @ @ it ( ' should change the style ' , ( ) = > { <nl> d = " flex " : w = " [ ' auto ' ] " px = " 5 " py = " 5 " shadow = " lg " <nl> my = " 5 " mb = " 5 " rounded = " sm " font - family = " body " <nl> background - color = " blue . 200 " color = " blue . 700 " ` <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - const pseudobox = getByTestId ( ' pseudobox ' ) <nl> + const pseudobox = screen . getByTestId ( ' pseudobox ' ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> expect ( pseudobox ) . toHaveStyle ( ' display : flex ' ) <nl> @ @ - 46 , 8 + 46 , 8 @ @ it . each ` <nl> ' should display Box with type as $ as ' , <nl> ( { as } ) = > { <nl> const inlineAttrs = ` as = $ { as } ` <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> - expect ( getTagName ( getByTestId ( ' pseudobox ' ) ) ) . toEqual ( as ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> + expect ( getTagName ( screen . getByTestId ( ' pseudobox ' ) ) ) . toEqual ( as ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } <nl> ) <nl> 
mmm a / packages / chakra - ui - core / src / CRadio / tests / CRadio . test . js <nl> ppp b / packages / chakra - ui - core / src / CRadio / tests / CRadio . test . js <nl> - import { render , userEvent } from ' @ / tests / test - utils ' <nl> + import { render , userEvent , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 18 , 52 + 18 , 50 @ @ it ( ' should render correctly ' , ( ) = > { <nl> it ( ' should display a disabled radio ' , ( ) = > { <nl> const inlineAttrs = ' isDisabled ' <nl> - const { getByText , container } = renderComponent ( { inlineAttrs } ) <nl> - const input = container . querySelector ( ' input ' ) <nl> + renderComponent ( { inlineAttrs } ) <nl> + const input = screen . getByLabelText ( ' radio ' ) <nl> expect ( input ) . toHaveAttribute ( ' disabled ' ) <nl> - expect ( getByText ( ' radio ' ) . parentNode ) . toHaveStyle ( ' cursor : not - allowed ; ' ) <nl> + expect ( input . parentNode ) . toHaveStyle ( ' cursor : not - allowed ; ' ) <nl> } ) <nl> it ( ' should display a radio with a checked state ' , ( ) = > { <nl> const inlineAttrs = ' isChecked ' <nl> - const { container } = renderComponent ( { inlineAttrs } ) <nl> - const input = container . querySelector ( ' input ' ) <nl> + renderComponent ( { inlineAttrs } ) <nl> + const input = screen . getByLabelText ( ' radio ' ) <nl> expect ( input ) . toBeChecked ( ) <nl> } ) <nl> it ( ' should display a radio with an unchecked state ' , ( ) = > { <nl> const inlineAttrs = ' : isChecked = " false " ' <nl> - const { container } = renderComponent ( { inlineAttrs } ) <nl> - const input = container . querySelector ( ' input ' ) <nl> + renderComponent ( { inlineAttrs } ) <nl> + const input = screen . getByLabelText ( ' radio ' ) <nl> expect ( input ) . not . toBeChecked ( ) <nl> } ) <nl> test ( ' Uncontrolled - should not check if disabled ' , async ( ) = > { <nl> const inlineAttrs = ' isDisabled ' <nl> - const { container , getByText } = renderComponent ( { inlineAttrs } ) <nl> - const input = container . querySelector ( ' input ' ) <nl> - const radio = getByText ( ' radio ' ) <nl> + renderComponent ( { inlineAttrs } ) <nl> + const input = screen . getByLabelText ( ' radio ' ) <nl> expect ( input ) . toBeDisabled ( ) <nl> - await userEvent . click ( radio ) <nl> + await userEvent . click ( input ) <nl> expect ( input ) . not . toBeChecked ( ) <nl> } ) <nl> test ( ' Uncontrolled - should be checked always ' , async ( ) = > { <nl> - const { container , getByText } = renderComponent ( ) <nl> - const input = container . querySelector ( ' input ' ) <nl> - const radio = getByText ( ' radio ' ) <nl> + renderComponent ( ) <nl> + const input = screen . getByLabelText ( ' radio ' ) <nl> / / click the first time , it ' s checked <nl> - await userEvent . click ( radio ) <nl> + await userEvent . click ( input ) <nl> expect ( input ) . toBeChecked ( ) <nl> / / click the second time , it should be still checked <nl> - await userEvent . click ( radio ) <nl> + await userEvent . click ( input ) <nl> expect ( input ) . toBeChecked ( ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CRadioButtonGroup / tests / CRadioButtonGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / CRadioButtonGroup / tests / CRadioButtonGroup . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const CustomRadio = { <nl> name : ' CustomRadio ' , <nl> @ @ - 55 , 29 + 55 , 29 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> - expect ( getByText ( ' Custom Radio 1 ' ) ) . toBeInTheDocument ( ) <nl> - expect ( getByText ( ' Custom Radio 2 ' ) ) . toBeInTheDocument ( ) <nl> + renderComponent ( ) <nl> + expect ( screen . getByText ( ' Custom Radio 1 ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' Custom Radio 2 ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' v - model works ' , ( ) = > { <nl> - const { getByTestId } = renderComponent ( { <nl> + renderComponent ( { <nl> data ( ) { <nl> return { <nl> selected : ' item - 2 ' <nl> } <nl> } <nl> } ) <nl> - const one = getByTestId ( ' item - 1 ' ) <nl> - const two = getByTestId ( ' item - 2 ' ) <nl> + const one = screen . getByTestId ( ' item - 1 ' ) <nl> + const two = screen . getByTestId ( ' item - 2 ' ) <nl> expect ( one ) . not . toHaveAttribute ( ' aria - checked ' ) <nl> expect ( two ) . toHaveAttribute ( ' aria - checked ' , ' true ' ) <nl> } ) <nl> test ( ' CustomRadio isDisabled works ' , ( ) = > { <nl> - const { getByTestId } = renderComponent ( ) <nl> - const last = getByTestId ( ' item - 4 ' ) <nl> + renderComponent ( ) <nl> + const last = screen . getByTestId ( ' item - 4 ' ) <nl> expect ( last ) . toHaveAttribute ( ' disabled ' ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CStack / tests / CStack . test . js <nl> ppp b / packages / chakra - ui - core / src / CStack / tests / CStack . test . js <nl> - import { render , getTagName } from ' @ / tests / test - utils ' <nl> + import { render , getTagName , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 27 , 22 + 27 , 22 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should default to vertical stack ' , ( ) = > { <nl> - const { getByTestId } = renderComponent ( ) <nl> - const stack = getByTestId ( ' stack ' ) <nl> + renderComponent ( ) <nl> + const stack = screen . getByTestId ( ' stack ' ) <nl> expect ( stack ) . toHaveStyle ( ' display : flex ' ) <nl> expect ( stack ) . toHaveStyle ( ' flex - direction : column ' ) <nl> } ) <nl> it ( ' should not space last child ' , ( ) = > { <nl> - const { getByTestId } = renderComponent ( ) <nl> - const stack = getByTestId ( ' stack ' ) <nl> + renderComponent ( ) <nl> + const stack = screen . getByTestId ( ' stack ' ) <nl> expect ( stack ) . not . toHaveStyle ( ' margin - bottom : 0 . 5rem ' ) <nl> } ) <nl> it ( ' should should stack horizontally if isInline ' , ( ) = > { <nl> const inlineAttrs = ' is - inline ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> - const stack = getByTestId ( ' stack ' ) <nl> + renderComponent ( { inlineAttrs } ) <nl> + const stack = screen . getByTestId ( ' stack ' ) <nl> expect ( stack ) . toHaveStyle ( ' display : flex ' ) <nl> expect ( stack ) . toHaveStyle ( ' flex - direction : row ' ) <nl> } ) <nl> @ @ - 58 , 8 + 58 , 8 @ @ it . each ` <nl> ' should render CStack with element as $ as ' , <nl> ( { as } ) = > { <nl> const inlineAttrs = ` as = " $ { as } " ` <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> - const stack = getByTestId ( ' stack ' ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> + const stack = screen . getByTestId ( ' stack ' ) <nl> expect ( getTagName ( stack ) ) . toEqual ( as ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CStat / tests / CStat . test . js <nl> ppp b / packages / chakra - ui - core / src / CStat / tests / CStat . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 22 , 8 + 22 , 8 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should render children in DOM ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> - expect ( getByText ( ' Collected Fees ' ) ) . toBeInTheDocument ( ) <nl> + renderComponent ( ) <nl> + expect ( screen . getByText ( ' Collected Fees ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> test ( ' " CStatArrow " should display corresponding icon for " type " prop ' , ( ) = > { <nl> 
mmm a / packages / chakra - ui - core / src / CTag / tests / CTag . test . js <nl> ppp b / packages / chakra - ui - core / src / CTag / tests / CTag . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 22 , 9 + 22 , 9 @ @ it ( ' should render correctly ' , ( ) = > { <nl> } ) <nl> it ( ' should display children ' , ( ) = > { <nl> - const { getByText } = renderComponent ( ) <nl> + renderComponent ( ) <nl> - expect ( getByText ( ' Green ' ) ) . toBeInTheDocument ( ) <nl> + expect ( screen . getByText ( ' Green ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> it ( ' should display tag with right icon ' , ( ) = > { <nl> @ @ - 35 , 8 + 35 , 7 @ @ it ( ' should display tag with right icon ' , ( ) = > { <nl> < CTagLabel > Green < / CTagLabel > <nl> < CTagIcon icon = " add " size = " 12px " / > <nl> < / CTag > <nl> - < / CBox > <nl> - ` <nl> + < / CBox > ` <nl> } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> @ @ - 52 , 8 + 51 , 7 @ @ it ( ' should display tag with custom element ' , ( ) = > { <nl> / > <nl> < CTagLabel > Mesut < / CTagLabel > <nl> < / CTag > <nl> - < / CBox > <nl> - ` <nl> + < / CBox > ` <nl> } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CText / tests / CText . test . js <nl> ppp b / packages / chakra - ui - core / src / CText / tests / CText . test . js <nl> - import { render } from ' @ / tests / test - utils ' <nl> + import { render , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const inlineAttrs = ( props & & props . inlineAttrs ) | | ' ' <nl> @ @ - 19 , 9 + 19 , 9 @ @ it ( ' should render correctly ' , ( ) = > { <nl> it ( ' should change the style ' , ( ) = > { <nl> const inlineAttrs = ' d = " flex " ' <nl> - const { asFragment , getByTestId } = renderComponent ( { inlineAttrs } ) <nl> + const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> - const text = getByTestId ( ' text ' ) <nl> + const text = screen . getByTestId ( ' text ' ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> expect ( text ) . toHaveStyle ( ' display : flex ' ) <nl> @ @ - 44 , 8 + 44 , 8 @ @ it . each ` <nl> ' should display text type as $ as ' , <nl> ( { as } ) = > { <nl> const inlineAttrs = ` as = $ { as } ` <nl> - const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> - const text = getByTestId ( ' text ' ) <nl> + renderComponent ( { inlineAttrs } ) <nl> + const text = screen . getByTestId ( ' text ' ) <nl> expect ( text . tagName . toLowerCase ( ) ) . toEqual ( as ) <nl> } <nl> ) <nl> 
mmm a / packages / chakra - ui - core / src / CAvatar / tests / CAvatar . test . js <nl> ppp b / packages / chakra - ui - core / src / CAvatar / tests / CAvatar . test . js <nl> } ) <nl> } ) <nl> - it ( ' renders a name avatar if src fails ' , async ( ) = > { <nl> + it ( ' renders Default Avatar if src fails ' , async ( ) = > { <nl> renderComponent ( { template : ' < CAvatar name = " Mesut Koca " src = " LOAD_FAILURE_SRC " / > ' } ) <nl> await wait ( ( ) = > { <nl> - expect ( screen . queryByAltText ( / Mesut Koca / i ) ) . not . toBeInTheDocument ( ) <nl> + expect ( screen . queryByAltText ( / Mesut Koca / i ) ) . not . toBeInTheDocument ( ) / / img <nl> + expect ( screen . getByLabelText ( / Mesut Koca / i ) ) . toBeInTheDocument ( ) / / DefaultAvatar <nl> expect ( screen . getByText ( ' MK ' ) ) . toBeInTheDocument ( ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / chakra - ui - core / src / CStack / tests / __snapshots__ / CStack . test . js . snap <nl> ppp b / packages / chakra - ui - core / src / CStack / tests / __snapshots__ / CStack . test . js . snap <nl> < DocumentFragment > <nl> < nav <nl> - class = " css - j7qwjs css - k008qs css - 1lp2as9 " <nl> + class = " css - j7qwjs css - 0 " <nl> data - chakra - component = " CStack " <nl> data - testid = " stack " <nl> > <nl> < div <nl> - class = " css - 1ipbp6k " <nl> + class = " css - dtyjrz " <nl> data - chakra - component = " CBox " <nl> data - testid = " stack - child - 1 " <nl> > <nl> @ @ - 26 , 7 + 26 , 6 @ @ exports [ ` should render CStack with element as nav 1 ` ] = ` <nl> The future can be even brighter but a goal without a plan is just a wish <nl> < / p > <nl> < / div > <nl> - <nl> < div <nl> class = " css - 1ipbp6k " <nl> data - chakra - component = " CBox " <nl> @ @ - 53 , 12 + 52 , 12 @ @ exports [ ` should render CStack with element as nav 1 ` ] = ` <nl> exports [ ` should render CStack with element as section 1 ` ] = ` <nl> < DocumentFragment > <nl> < section <nl> - class = " css - j7qwjs css - k008qs css - 1lp2as9 " <nl> + class = " css - j7qwjs css - 0 " <nl> data - chakra - component = " CStack " <nl> data - testid = " stack " <nl> > <nl> < div <nl> - class = " css - 1ipbp6k " <nl> + class = " css - dtyjrz " <nl> data - chakra - component = " CBox " <nl> data - testid = " stack - child - 1 " <nl> > <nl> @ @ - 76 , 7 + 75 , 6 @ @ exports [ ` should render CStack with element as section 1 ` ] = ` <nl> The future can be even brighter but a goal without a plan is just a wish <nl> < / p > <nl> < / div > <nl> - <nl> < div <nl> class = " css - 1ipbp6k " <nl> data - chakra - component = " CBox " <nl> @ @ - 103 , 12 + 101 , 12 @ @ exports [ ` should render CStack with element as section 1 ` ] = ` <nl> exports [ ` should render correctly 1 ` ] = ` <nl> < DocumentFragment > <nl> < div <nl> - class = " css - j7qwjs css - k008qs css - 1lp2as9 " <nl> + class = " css - j7qwjs css - 0 " <nl> data - chakra - component = " CStack " <nl> data - testid = " stack " <nl> > <nl> < div <nl> - class = " css - 1ipbp6k " <nl> + class = " css - dtyjrz " <nl> data - chakra - component = " CBox " <nl> data - testid = " stack - child - 1 " <nl> > <nl> @ @ - 126 , 7 + 124 , 6 @ @ exports [ ` should render correctly 1 ` ] = ` <nl> The future can be even brighter but a goal without a plan is just a wish <nl> < / p > <nl> < / div > <nl> - <nl> < div <nl> class = " css - 1ipbp6k " <nl> data - chakra - component = " CBox " <nl> @ @ - 153 , 29 + 150 , 36 @ @ exports [ ` should render correctly 1 ` ] = ` <nl> exports [ ` should should stack native html elements 1 ` ] = ` <nl> < DocumentFragment > <nl> < div <nl> - class = " css - j7qwjs css - k008qs css - 1lp2as9 " <nl> + class = " css - j7qwjs css - 0 " <nl> data - chakra - component = " CStack " <nl> data - testid = " stack " <nl> > <nl> < p <nl> - class = " css - 18iq2bq " <nl> + class = " css - 16ec2e8 " <nl> data - chakra - component = " CText " <nl> > <nl> The future can be even brighter but a goal without a plan is just a wish <nl> < / p > <nl> - <nl> + < div <nl> + class = " css - cet0rr " <nl> + data - chakra - component = " CBox " <nl> + > <nl> < p <nl> data - testid = " stacked - p " <nl> > <nl> I am a happy paragraph element <nl> < / p > <nl> - <nl> + < / div > <nl> + < div <nl> + class = " css - cet0rr " <nl> + data - chakra - component = " CBox " <nl> + > <nl> < h3 <nl> data - testid = " stacked - h3 " <nl> > <nl> I am a jolly heading element <nl> < / h3 > <nl> - <nl> + < / div > <nl> < p <nl> class = " css - 18iq2bq " <nl> data - chakra - component = " CText " <nl> 
mmm a / test / e2e / razzle - build . test . js <nl> ppp b / test / e2e / razzle - build . test . js <nl> expect ( output . code ) . toBe ( 1 ) ; <nl> } ) ; <nl> + <nl> + it ( ' should compile with development build ' , ( ) = > { <nl> + const stagePath = util . setupStageWithExample ( stageName , ' with - development - build ' ) ; <nl> + const output = shell . exec ( ' yarn build - - noninteractive ' ) ; <nl> + / / Create asset manifest <nl> + expect ( fileExists ( ' build / assets . json ' ) ) . toBeTruthy ( ) ; <nl> + <nl> + const assets = JSON . parse ( fs . readFileSync ( path . join ( stagePath , ' build / assets . json ' ) ) ) ; <nl> + const js = fs . readFileSync ( path . join ( stagePath , ' build ' , ' public ' , assets . client . js [ 0 ] ) ) ; <nl> + <nl> + expect ( output . code ) . toBe ( 0 ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should exit with an error code when the custom config is invalid ' , ( ) = > { <nl> + util . setupStageWithFixture ( stageName , ' build - with - custom - config - invalid ' ) ; <nl> + const output = shell . exec ( ' yarn build ' , { <nl> + silent : true , <nl> + } ) ; <nl> + <nl> + expect ( output . code ) . toBe ( 1 ) ; <nl> + } ) ; <nl> + <nl> afterEach ( ( ) = > { <nl> util . teardownStage ( stageName ) ; <nl> } ) ; <nl> 
mmm a / test / specs / lib / AutoControlledComponent - test . js <nl> ppp b / test / specs / lib / AutoControlledComponent - test . js <nl> const toDefaultName = ( prop ) = > ` default $ { prop . slice ( 0 , 1 ) . toUpperCase ( ) + prop . slice ( 1 ) } ` <nl> - const makeProps = ( ) = > _ . transform ( _ . times ( _ . random ( 3 , 10 ) ) , ( res ) = > { <nl> - res [ _ . camelCase ( faker . hacker . noun ( ) ) ] = faker . hacker . verb ( ) <nl> - } , { } ) <nl> + const makeProps = ( ) = > ( { <nl> + computer : ' hardware ' , <nl> + flux : ' capacitor ' , <nl> + ion : ' belt ' , <nl> + } ) <nl> const makeDefaultProps = ( props ) = > _ . transform ( props , ( res , val , key ) = > { <nl> res [ toDefaultName ( key ) ] = val <nl> 
mmm a / test / specs / commonTests / hasValidTypings . js <nl> ppp b / test / specs / commonTests / hasValidTypings . js <nl> const componentProps = _ . keys ( componentPropTypes ) <nl> const interfaceProps = _ . without ( _ . map ( props , ' name ' ) , . . . ignoredTypingsProps ) <nl> - componentProps . forEach ( ( propName ) = > { <nl> + componentProps . forEach ( ( propName , index ) = > { <nl> interfaceProps . should . include ( <nl> propName , <nl> ` propTypes define " $ { propName } " but it is missing in typings ` , <nl> ) <nl> + interfaceProps [ index ] . should . equal ( <nl> + propName , <nl> + ` propTypes define " $ { propName } " but its order doesn ' t match typings ` , <nl> + ) <nl> } ) <nl> interfaceProps . forEach ( ( propName ) = > { <nl> 
mmm a / test / specs / modules / Dropdown / Dropdown - test . js <nl> ppp b / test / specs / modules / Dropdown / Dropdown - test . js <nl> { value : 0 , text : ' foo ' } , <nl> { value : 1 , text : ' foe ' } , <nl> ] <nl> - wrapperMount ( < Dropdown options = { searchOptions } selection / > ) <nl> + wrapperMount ( < Dropdown options = { searchOptions } search selection / > ) <nl> / / open and simulate search <nl> wrapper <nl> @ @ - 984 , 13 + 984 , 10 @ @ describe ( ' Dropdown ' , ( ) = > { <nl> domEvent . keyDown ( document , { key : ' ArrowDown ' } ) <nl> domEvent . keyDown ( document , { key : ' Enter ' } ) <nl> - const item = wrapper <nl> - . find ( ' . selected ' ) <nl> - <nl> / / text updated <nl> wrapper <nl> . find ( ' div . text ' ) <nl> - . should . contain . text ( item . text ( ) ) <nl> + . should . contain . text ( ' foe ' ) <nl> } ) <nl> it ( ' displays if value is 0 ' , ( ) = > { <nl> const text = faker . hacker . noun ( ) <nl> 
mmm a / test / specs / modules / Checkbox / Checkbox - test . js <nl> ppp b / test / specs / modules / Checkbox / Checkbox - test . js <nl> } ) <nl> describe ( ' aria ' , ( ) = > { <nl> - [ ' aria - label ' , ' role ' ] . forEach ( ( propName ) = > { <nl> + ; [ ' aria - label ' , ' role ' ] . forEach ( ( propName ) = > { <nl> it ( ` passes " $ { propName } " to the < input > ` , ( ) = > { <nl> shallow ( < Checkbox { . . . { [ propName ] : ' foo ' } } / > ) <nl> . find ( ' input ' ) <nl> @ @ - 377 , 36 + 377 , 30 @ @ describe ( ' Checkbox ' , ( ) = > { <nl> description : ' click on label : fires on mouse click ' , <nl> events : { <nl> label : [ ' mouseup ' , ' click ' ] , <nl> - input : [ ' click ' ] , <nl> } , <nl> } , <nl> { <nl> description : ' click on input : fires on mouse click ' , <nl> events : { <nl> - label : [ ' mouseup ' , ' click ' ] , <nl> input : [ ' click ' ] , <nl> } , <nl> } , <nl> { <nl> description : ' key on input : fires on space key ' , <nl> events : { <nl> - label : [ ' mouseup ' , ' click ' ] , <nl> input : [ ' click ' ] , <nl> } , <nl> } , <nl> - <nl> { <nl> description : ' click on label with " id " : fires on mouse click ' , <nl> events : { <nl> label : [ ' mouseup ' , ' click ' ] , <nl> - input : [ ' click ' ] , <nl> } , <nl> id : ' foo ' , <nl> } , <nl> { <nl> description : ' click on input with " id " : fires on mouse click ' , <nl> events : { <nl> - label : [ ' mouseup ' , ' click ' ] , <nl> input : [ ' click ' ] , <nl> } , <nl> id : ' foo ' , <nl> @ @ - 435 , 8 + 429 , 10 @ @ describe ( ' Checkbox ' , ( ) = > { <nl> { attachTo } , <nl> ) <nl> - _ . forEach ( events , ( event , target ) = > { <nl> - domEvent . fire ( ` [ data - id = $ { dataId } ] $ { target } ` , event ) <nl> + _ . forEach ( events , ( targetEvents , target ) = > { <nl> + _ . forEach ( targetEvents , ( targetEvent ) = > { <nl> + domEvent . fire ( ` [ data - id = $ { dataId } ] $ { target } ` , targetEvent ) <nl> + } ) <nl> } ) <nl> onClick . should . have . been . calledOnce ( ) <nl> @ @ - 449 , 10 + 445 , 10 @ @ describe ( ' Checkbox ' , ( ) = > { <nl> } ) <nl> describe ( ' Controlled component ' , ( ) = > { <nl> - const getControlledCheckbox = isOnClick = > <nl> + const getControlledCheckbox = ( isOnClick ) = > <nl> class ControlledCheckbox extends React . Component { <nl> state = { checked : false } <nl> - toggle = ( ) = > this . setState ( prevState = > ( { checked : ! prevState . checked } ) ) <nl> + toggle = ( ) = > this . setState ( ( prevState ) = > ( { checked : ! prevState . checked } ) ) <nl> render ( ) { <nl> const handler = isOnClick ? { onClick : this . toggle } : { onChange : this . toggle } <nl> 
mmm a / test / library / run - options . test . js <nl> ppp b / test / library / run - options . test . js <nl> done ( ) ; <nl> } ) ; <nl> } ) ; <nl> + <nl> + it ( ' should correctly handle a multitude of responses ' , function ( done ) { <nl> + newman . run ( { <nl> + collection : ' test / fixtures / run / response - bodies . json ' <nl> + } , function ( err , summary ) { <nl> + expect ( err ) . to . not . be . ok ( ) ; <nl> + expect ( summary . run . failures ) . to . be . empty ( ) ; <nl> + <nl> + var executions = summary . run . executions ; <nl> + <nl> + expect ( executions ) . to . have . length ( 3 ) ; <nl> + expect ( executions [ 0 ] . response . json ( ) ) . to . not . be . empty ( ) ; <nl> + expect ( executions [ 1 ] . response . text ( ) ) . to . not . be . empty ( ) ; <nl> + expect ( executions [ 2 ] . response . text ( ) ) . to . not . be . empty ( ) ; <nl> + <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / cli / run - options . test . js <nl> ppp b / test / cli / run - options . test . js <nl> done ( ) ; <nl> } ) ; <nl> } ) ; <nl> + <nl> + it ( ' should handle invalid collection URLs correctly ' , function ( done ) { <nl> + / / eslint - disable - next - line max - len <nl> + exec ( ' node . / bin / newman . js run https : / / api . getpostman . com / collections / my - collection - uuid ? apikey = my - secret - api - key ' , function ( code ) { <nl> + expect ( code ) . be ( 1 ) ; <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / library / run - options . test . js <nl> ppp b / test / library / run - options . test . js <nl> done ( ) ; <nl> } ) ; <nl> } ) ; <nl> + <nl> + it ( ' should correctly handle invalid collection URLs ' , function ( done ) { <nl> + newman . run ( { <nl> + collection : ' https : / / api . getpostman . com / collections / my - collection - uuid ? apikey = my - secret - api - key ' <nl> + } , function ( err , summary ) { <nl> + expect ( err ) . to . be . ok ( ) ; <nl> + expect ( err . message ) . to . be ( ' Invalid API Key . Every request requires a valid API Key to be sent . ' ) ; <nl> + <nl> + / / eslint - disable - next - line max - len <nl> + expect ( err . help ) . to . be ( ' Error fetching the collection from the Postman Pro API . Ensure that the url is valid . ' ) ; <nl> + expect ( summary ) . to . not . be . ok ( ) ; <nl> + <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / unit / cli . test . js <nl> ppp b / test / unit / cli . test . js <nl> } ) ; <nl> } ) ; <nl> + describe ( ' - - global - var ' , function ( ) { <nl> + it ( ' should throw an error for missing - - global - var values ' , function ( done ) { <nl> + cli . rawOptions ( ' run myCollection . json - - global - var ' . split ( ' ' ) , ' newmantests ' , function ( err ) { <nl> + expect ( err . code ) . to . equal ( ' ARGError ' ) ; <nl> + <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should throw an error for - - global - var values without an ` = ` ' , function ( done ) { <nl> + cli . rawOptions ( ' run myCollection . json - - global - var foo ' . split ( ' ' ) , ' newmantests ' , function ( err ) { <nl> + expect ( err . code ) . to . equal ( ' ARGError ' ) ; <nl> + <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> + } ) ; <nl> + <nl> it ( ' should load all arguments ( except reporters ) ' , function ( done ) { <nl> cli . rawOptions ( ( ' run ' + <nl> ' myCollection . json ' + <nl> @ @ - 154 , 6 + 172 , 7 @ @ describe ( ' cli parser ' , function ( ) { <nl> ' - - reporter - cli - no - summary ' + <nl> ' - - iteration - count 23 ' + <nl> ' - - reporters json , html ' + <nl> + ' - - global - var foo = bar - - global - var alpha = = beta = ' + <nl> ' - - no - color ' + <nl> ' - - delay - request 12000 ' + <nl> ' - - timeout - request 5000 ' + <nl> @ @ - 183 , 6 + 202 , 11 @ @ describe ( ' cli parser ' , function ( ) { <nl> expect ( opts . reporters ) . to . contain ( ' html ' ) ; <nl> expect ( opts . reporters ) . to . not . contain ( ' junit ' ) ; <nl> + expect ( opts . globalVar ) . to . eql ( [ <nl> + { key : ' foo ' , value : ' bar ' } , <nl> + { key : ' alpha ' , value : ' = beta = ' } <nl> + ] ) ; <nl> + <nl> expect ( opts . bail ) . to . be ( true ) ; <nl> expect ( opts . suppressExitCode ) . to . be ( true ) ; <nl> @ @ - 208 , 6 + 232 , 7 @ @ describe ( ' cli parser ' , function ( ) { <nl> ' - - timeout - request 5000 ' + <nl> ' - - ignore - redirects ' + <nl> ' - k ' + <nl> + ' - - global - var foo = bar - - global - var alpha = = beta = ' + <nl> ' - - reporter - json - output . / omg . txt ' + <nl> ' - - reporter - html - output report . html ' + <nl> ' - - reporter - html - template . / mytemplate . html ' + <nl> @ @ - 231 , 6 + 256 , 11 @ @ describe ( ' cli parser ' , function ( ) { <nl> expect ( opts . ignoreRedirects ) . to . be ( true ) ; <nl> expect ( opts . insecure ) . to . be ( true ) ; <nl> + expect ( opts . globalVar ) . to . eql ( [ <nl> + { key : ' foo ' , value : ' bar ' } , <nl> + { key : ' alpha ' , value : ' = beta = ' } <nl> + ] ) ; <nl> + <nl> expect ( opts . noColor ) . to . be ( true ) ; <nl> expect ( opts . reporters ) . to . contain ( ' json ' ) ; <nl> 
mmm a / test / cli / run - options . test . js <nl> ppp b / test / cli / run - options . test . js <nl> done ( ) ; <nl> } ) ; <nl> } ) ; <nl> + <nl> + it ( ' should correctly work with global variable overrides passed with - - global - var ' , function ( done ) { <nl> + / / eslint - disable - next - line max - len <nl> + exec ( ' node . / bin / newman . js run test / integration / steph / steph . postman_collection . json - - global - var first = James - - global - var last = Bond ' , function ( code ) { <nl> + expect ( code ) . be ( 0 ) ; <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / cli / export - globals . test . js <nl> ppp b / test / cli / export - globals . test . js <nl> done ( ) ; <nl> } ) ; <nl> } ) ; <nl> + <nl> + it ( ' ` newman run ` should override exported globals with those provided via - - global - var ' , function ( done ) { <nl> + / / eslint - disable - next - line max - len <nl> + exec ( ' node . / bin / newman . js run test / fixtures / run / single - request - failing . json - g test / fixtures / run / simple - variables . json - - global - var foo = bar - - export - globals out / test - globals . json ' , function ( code ) { <nl> + var globals ; <nl> + <nl> + try { globals = JSON . parse ( fs . readFileSync ( exportedGlobalsPath ) . toString ( ) ) ; } <nl> + catch ( e ) { console . error ( e ) ; } <nl> + <nl> + expect ( code ) . not . be ( 0 ) ; <nl> + expect ( globals ) . be . ok ( ) ; <nl> + expect ( globals ) . have . property ( ' _postman_exported_at ' ) ; <nl> + expect ( globals ) . have . property ( ' values ' ) ; <nl> + expect ( globals . values ) . eql ( [ <nl> + { key : ' var - 1 ' , value : ' value - 1 ' , type : ' any ' } , <nl> + { key : ' var - 2 ' , value : ' value - 2 ' , type : ' any ' } , <nl> + { key : ' foo ' , value : ' bar ' , type : ' any ' } <nl> + ] ) ; <nl> + expect ( globals ) . have . property ( ' _postman_variable_scope ' , ' globals ' ) ; <nl> + done ( ) ; <nl> + } ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / spec . html <nl> ppp b / test / spec . html <nl> var loader_development = function ( ) { <nl> - document . write ( " < script src = ' . . / src / development_initializer . js ' > < \ / script > " + <nl> + document . write ( " < script type = ' module ' src = ' . . / src / main . js ' > < \ / script > " + <nl> " < script type = ' text / javascript ' > " + <nl> " if ( console ) console . log ( ' BiwaScheme ' + BiwaScheme . VERSION ) ; " + <nl> " BiwaScheme . register_tests ( ) ; " + <nl> 
mmm a / test / unit . js <nl> ppp b / test / unit . js <nl> this . foo = obj [ " foo " ] ; <nl> } ; <nl> var tmp = scm_eval ( ' ( js - new " BiwaScheme . TestForJSNew " \ ' foo ( lambda ( ) 4 ) ) ' ) ; <nl> - expect ( _ . isFunction ( tmp . foo ) ) . should_be ( true ) ; <nl> + expect ( typeof ( tmp . foo ) ) . should_be ( ' function ' ) ; <nl> } , <nl> ' js - null ? ' : function ( ) { <nl> ev ( ' ( js - null ? ( js - eval " null " ) ) ' ) . should_be ( true ) ; <nl> 
mmm a / test / spec . html <nl> ppp b / test / spec . html <nl> < div id = " bs - console " > < / div > <nl> - < script type = " text / javascript " > / / < ! [ CDATA [ <nl> + < script type = " text / javascript " > <nl> var loader_development = function ( ) { <nl> - document . write ( " < script type = ' module ' src = ' . . / src / main - browser . js ' > < \ / script > " + <nl> + document . write ( " < script type = ' text / javascript ' src = ' . . / src / deps / jquery . js ' > < \ / script > " + <nl> + " < script type = ' module ' src = ' . . / src / main - browser . js ' > < \ / script > " + <nl> " < script type = ' module ' > " + <nl> " if ( console ) console . log ( ' BiwaScheme ' + BiwaScheme . VERSION ) ; " + <nl> " RegisterBiwaSchemeTests ( ) ; " + <nl> @ @ - 47 , 8 + 48 , 7 @ @ switch ( location . hash ) { <nl> if ( console ) console . log ( " starting tests for src / * . js " ) ; <nl> loader_development ( ) ; <nl> } <nl> - <nl> - / / ] ] > < / script > <nl> + < / script > <nl> < / body > <nl> < / html > <nl> < ! - - vim : set ft = javascript : - - > <nl> 
mmm a / test / node_functions . js <nl> ppp b / test / node_functions . js <nl> / / $ npm run node - test <nl> var BiwaScheme = require ( ' . . ' ) , <nl> - _ = require ( ' underscore ' ) , <nl> assert = require ( ' assert ' ) , <nl> fs = require ( ' fs ' ) , <nl> path = require ( ' path ' ) , <nl> @ @ - 90 , 9 + 89 , 9 @ @ var tests = { <nl> } <nl> } ; <nl> - tests . forEach ( function ( func , name ) { <nl> + for ( const name in tests ) { <nl> puts ( " - " + name ) ; <nl> - func ( ) ; <nl> - } ) ; <nl> + tests [ name ] ( ) ; <nl> + } <nl> puts ( " test ok " ) ; <nl> 
mmm a / components / SocialLoginGroup / __tests__ / __snapshots__ / SocialLoginButtons . test . js . snap <nl> ppp b / components / SocialLoginGroup / __tests__ / __snapshots__ / SocialLoginButtons . test . js . snap <nl> > <nl> Login with Facebook <nl> < / button > , <nl> + < button <nl> + className = " loginButton githubButton " <nl> + onClick = { [ Function ] } <nl> + > <nl> + Login with GitHub <nl> + < / button > , <nl> ] <nl> ` ; <nl> 
mmm a / packages / engine - runner / test / replace . js <nl> ppp b / packages / engine - runner / test / replace . js <nl> t . end ( ) ; <nl> } ) ; <nl> + test ( ' putout : runner : replace : jsx : attribute ' , ( t ) = > { <nl> + const from = montag ` <nl> + < Link href = " __a " > <nl> + < a > __b < / a > <nl> + < / Link > <nl> + ` ; <nl> + <nl> + const plugin = { <nl> + report : ( ) = > ' ' , <nl> + replace : ( ) = > ( { <nl> + [ from ] : ( { __b } ) = > { <nl> + __b . type = ' StringLiteral ' ; <nl> + return __b ; <nl> + } , <nl> + } ) , <nl> + } ; <nl> + <nl> + const source = montag ` <nl> + < Link href = " / about " > <nl> + < a > About < / a > <nl> + < / Link > <nl> + ` ; <nl> + <nl> + const { code } = putout ( source , { <nl> + runPlugins , <nl> + plugins : [ <nl> + [ ' plugin ' , plugin ] , <nl> + ] , <nl> + } ) ; <nl> + <nl> + const expected = ` ' About ' ; ` ; <nl> + <nl> + t . equal ( code , expected ) ; <nl> + t . end ( ) ; <nl> + } ) ; <nl> + <nl> 
mmm a / test / bind . spec . js <nl> ppp b / test / bind . spec . js <nl> expect ( document . querySelector ( ' span ' ) . classList . contains ( ' foo ' ) ) . toBeTruthy ( ) <nl> } ) <nl> - test ( ' multiple classes are added by object syntax ' , async ( ) = > { <nl> + test ( ' multiple classes are removed by object syntax ' , async ( ) = > { <nl> document . body . innerHTML = ` <nl> < div x - data = " { isOn : false } " > <nl> < span class = " foo bar " x - bind : class = " { ' foo bar ' : isOn } " > < / span > <nl> @ @ - 125 , 7 + 125 , 7 @ @ test ( ' multiple classes are added by object syntax ' , async ( ) = > { <nl> expect ( document . querySelector ( ' span ' ) . classList . contains ( ' bar ' ) ) . toBeFalsy ( ) <nl> } ) <nl> - test ( ' multiple classes are removed by object syntax ' , async ( ) = > { <nl> + test ( ' multiple classes are added by object syntax ' , async ( ) = > { <nl> document . body . innerHTML = ` <nl> < div x - data = " { isOn : true } " > <nl> < span x - bind : class = " { ' foo bar ' : isOn } " > < / span > <nl> 
mmm a / src / __tests__ / UncontrolledCarousel . spec . js <nl> ppp b / src / __tests__ / UncontrolledCarousel . spec . js <nl> expect ( carousel . prop ( ' ride ' ) ) . toBe ( ' carousel ' ) ; <nl> } ) ; <nl> + it ( ' should have ride set to undefined when autoPlay is false ' , ( ) = > { <nl> + const carousel = shallow ( < UncontrolledCarousel items = { items } autoPlay = { false } / > ) ; <nl> + expect ( carousel . prop ( ' ride ' ) ) . toBe ( undefined ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should have ride set to " carousel " when autoPlay is true ' , ( ) = > { <nl> + const carousel = shallow ( < UncontrolledCarousel items = { items } autoPlay / > ) ; <nl> + expect ( carousel . prop ( ' ride ' ) ) . toBe ( ' carousel ' ) ; <nl> + } ) ; <nl> + <nl> it ( ' should increase the activeIndex when next is called ' , ( ) = > { <nl> const carousel = shallow ( < UncontrolledCarousel items = { items } / > ) ; <nl> const instance = carousel . instance ( ) ; <nl> 
mmm a / src / __tests__ / utils . spec . js <nl> ppp b / src / __tests__ / utils . spec . js <nl> const target = { } ; <nl> expect ( Utils . getTarget ( target ) ) . toEqual ( target ) ; <nl> } ) ; <nl> + <nl> + it ( ' should not return an error when the target could be identified ' , ( ) = > { <nl> + const element = document . createElement ( ' div ' ) ; <nl> + element . className = ' thing ' ; <nl> + document . body . appendChild ( element ) ; <nl> + jest . spyOn ( document , ' querySelector ' ) ; <nl> + expect ( ( ) = > { <nl> + Utils . getTarget ( ' . thing ' ) ; <nl> + } ) . not . toThrow ( ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should return an error when the target could not be identified ' , ( ) = > { <nl> + const target = ' not a target ' ; <nl> + expect ( ( ) = > { <nl> + Utils . getTarget ( target ) ; <nl> + } ) . toThrow ( ` The target ' $ { target } ' could not be identified in the dom , tip : check spelling ` ) ; <nl> + } ) ; <nl> + } ) ; <nl> + <nl> + describe ( ' setGlobalCssModule ' , ( ) = > { <nl> + it ( ' should return the mapped classnames ' , ( ) = > { <nl> + const globalCssModule = { <nl> + btn : ' a1 ' , <nl> + ' btn - success ' : ' b1 ' , <nl> + ' btn - primary ' : ' c2 ' , <nl> + } ; <nl> + Utils . setGlobalCssModule ( globalCssModule ) ; <nl> + expect ( Utils . mapToCssModules ( ' btn btn - primary ' ) ) . toBe ( ' a1 c2 ' ) ; <nl> + } ) ; <nl> } ) ; <nl> / / TODO <nl> 
mmm a / src / __tests__ / DropdownMenu . spec . js <nl> ppp b / src / __tests__ / DropdownMenu . spec . js <nl> expect ( wrapper . find ( ' . dropdown - menu ' ) . hostNodes ( ) . hasClass ( ' dropdown - menu - right ' ) ) . toBe ( true ) ; <nl> } ) ; <nl> + it ( ' should render down when direction is unknown on the context ' , ( ) = > { <nl> + isOpen = true ; <nl> + direction = ' unknown ' ; <nl> + const wrapper = shallow ( <nl> + < DropdownMenu > Ello world < / DropdownMenu > , <nl> + { <nl> + context : { isOpen , direction , inNavbar , popperManager } , <nl> + childContextTypes : { popperManager } <nl> + } <nl> + ) ; <nl> + <nl> + expect ( wrapper . find ( Popper ) . prop ( ' placement ' ) ) . toBe ( ' bottom - start ' ) ; <nl> + } ) ; <nl> + <nl> it ( ' should render down when direction is " down " on the context ' , ( ) = > { <nl> isOpen = true ; <nl> const wrapper = shallow ( <nl> 
mmm a / src / __tests__ / InputGroupAddon . spec . js <nl> ppp b / src / __tests__ / InputGroupAddon . spec . js <nl> import { shallow } from ' enzyme ' ; <nl> - import { InputGroupAddon } from ' . . / ' ; <nl> + import { InputGroupAddon , InputGroupText } from ' . . / ' ; <nl> describe ( ' InputGroupAddon ' , ( ) = > { <nl> it ( ' should render with " div " tag ' , ( ) = > { <nl> @ @ - 15 , 6 + 15 , 19 @ @ describe ( ' InputGroupAddon ' , ( ) = > { <nl> expect ( wrapper . text ( ) ) . toBe ( ' < InputGroupText / > ' ) ; <nl> } ) ; <nl> + it ( ' should render children provided ' , ( ) = > { <nl> + const wrapper = shallow ( < InputGroupAddon addonType = " append " > < button > Yo ! < / button > < / InputGroupAddon > ) ; <nl> + <nl> + expect ( wrapper . childAt ( 0 ) . type ( ) ) . toBe ( ' button ' ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should render the string provided in the child InputGroupText ' , ( ) = > { <nl> + const wrapper = shallow ( < InputGroupAddon addonType = " append " > Yo ! < / InputGroupAddon > ) ; <nl> + <nl> + expect ( wrapper . childAt ( 0 ) . type ( ) ) . toBe ( InputGroupText ) ; <nl> + expect ( wrapper . childAt ( 0 ) . prop ( ' children ' ) ) . toBe ( ' Yo ! ' ) ; <nl> + } ) ; <nl> + <nl> it ( ' should render with " input - group - * " classes ' , ( ) = > { <nl> const wrapperPrepend = shallow ( < InputGroupAddon addonType = " prepend " > Yo ! < / InputGroupAddon > ) ; <nl> const wrapperAppend = shallow ( < InputGroupAddon addonType = " append " > Yo ! < / InputGroupAddon > ) ; <nl> 
mmm a / src / __tests__ / Modal . spec . js <nl> ppp b / src / __tests__ / Modal . spec . js <nl> wrapper . unmount ( ) ; <nl> } ) ; <nl> + <nl> + it ( ' should return the focus to the last focused element before the modal has opened ' , ( ) = > { <nl> + const MockComponent = ( { isOpen = false } ) = > ( <nl> + < > <nl> + < button className = { ' focus ' } > Focused < / button > <nl> + < Modal isOpen = { isOpen } > <nl> + < ModalBody > Whatever < / ModalBody > <nl> + < / Modal > <nl> + < / > <nl> + ) ; <nl> + const wrapper = mount ( < MockComponent / > ) ; <nl> + const button = wrapper <nl> + . find ( ' . focus ' ) <nl> + . hostNodes ( ) <nl> + . getDOMNode ( ) ; <nl> + button . focus ( ) ; <nl> + wrapper . setProps ( { isOpen : true } ) ; <nl> + wrapper . setProps ( { isOpen : false } ) ; <nl> + jest . runAllTimers ( ) ; <nl> + <nl> + expect ( document . activeElement = = = button ) . toEqual ( true ) ; <nl> + wrapper . unmount ( ) ; <nl> + } ) <nl> + <nl> + it ( ' should not return the focus to the last focused element before the modal has opened when " returnFocusAfterClose " is false ' , ( ) = > { <nl> + const MockComponent = ( { isOpen = false } ) = > ( <nl> + < > <nl> + < button className = { ' focus ' } > Focused < / button > <nl> + < Modal isOpen = { isOpen } returnFocusAfterClose = { false } > <nl> + < ModalBody > Whatever < / ModalBody > <nl> + < / Modal > <nl> + < / > <nl> + ) ; <nl> + const wrapper = mount ( < MockComponent / > ) ; <nl> + const button = wrapper <nl> + . find ( ' . focus ' ) <nl> + . hostNodes ( ) <nl> + . getDOMNode ( ) ; <nl> + button . focus ( ) ; <nl> + wrapper . setProps ( { isOpen : true } ) ; <nl> + wrapper . setProps ( { isOpen : false } ) ; <nl> + jest . runAllTimers ( ) ; <nl> + <nl> + expect ( document . activeElement = = = button ) . toEqual ( false ) ; <nl> + wrapper . unmount ( ) ; <nl> + } ) <nl> + <nl> + it ( ' should return the focus to the last focused element before the modal has opened when " unmountOnClose " is false ' , ( ) = > { <nl> + const MockComponent = ( { isOpen = false } ) = > ( <nl> + < > <nl> + < button className = { ' focus ' } > Focused < / button > <nl> + < Modal isOpen = { isOpen } unmountOnClose = { false } > <nl> + < ModalBody > Whatever < / ModalBody > <nl> + < / Modal > <nl> + < / > <nl> + ) ; <nl> + const wrapper = mount ( < MockComponent / > ) ; <nl> + const button = wrapper <nl> + . find ( ' . focus ' ) <nl> + . hostNodes ( ) <nl> + . getDOMNode ( ) ; <nl> + button . focus ( ) ; <nl> + wrapper . setProps ( { isOpen : true } ) ; <nl> + wrapper . setProps ( { isOpen : false } ) ; <nl> + jest . runAllTimers ( ) ; <nl> + <nl> + expect ( document . activeElement = = = button ) . toEqual ( true ) ; <nl> + wrapper . unmount ( ) ; <nl> + } ) <nl> + <nl> + it ( ' should not return the focus to the last focused element before the modal has opened when " returnFocusAfterClose " is false and " unmountOnClose " is false ' , ( ) = > { <nl> + const MockComponent = ( { isOpen = false } ) = > ( <nl> + < > <nl> + < button className = { ' focus ' } / > <nl> + < Modal isOpen = { isOpen } returnFocusAfterClose = { false } unmountOnClose = { false } > <nl> + < ModalBody > Whatever < / ModalBody > <nl> + < / Modal > <nl> + < / > <nl> + ) ; <nl> + const wrapper = mount ( < MockComponent / > ) ; <nl> + const button = wrapper <nl> + . find ( ' . focus ' ) <nl> + . hostNodes ( ) <nl> + . getDOMNode ( ) ; <nl> + button . focus ( ) ; <nl> + wrapper . setProps ( { isOpen : true } ) ; <nl> + wrapper . setProps ( { isOpen : false } ) ; <nl> + jest . runAllTimers ( ) ; <nl> + <nl> + expect ( document . activeElement = = = button ) . toEqual ( false ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / src / __tests__ / PopperContent . spec . js <nl> ppp b / src / __tests__ / PopperContent . spec . js <nl> it ( ' should have x - placement of auto by default ' , ( ) = > { <nl> const wrapper = mount ( < PopperContent target = " target " isOpen container = " inline " > Yo ! < / PopperContent > ) ; <nl> - console . log ( wrapper . debug ( ) ) ; <nl> - <nl> expect ( wrapper . find ( ' div [ x - placement = " auto " ] ' ) . exists ( ) ) . toBe ( true ) ; <nl> } ) ; <nl> 
mmm a / src / __tests__ / Collapse . spec . js <nl> ppp b / src / __tests__ / Collapse . spec . js <nl> expect ( wrapper . find ( ' p ' ) . text ( ) ) . toBe ( ' hello ' ) ; <nl> } ) ; <nl> + it ( ' works with strict mode ' , ( ) = > { <nl> + const spy = jest . spyOn ( console , ' error ' ) ; <nl> + wrapper = mount ( < React . StrictMode > < Collapse / > < / React . StrictMode > ) ; <nl> + expect ( wrapper . instance ( ) ) . toBeTruthy ( ) ; <nl> + expect ( spy ) . not . toHaveBeenCalled ( ) ; <nl> + } ) <nl> + <nl> it ( ' should have default isOpen value ' , ( ) = > { <nl> wrapper = shallow ( < Collapse / > ) ; <nl> expect ( wrapper . instance ( ) . props . isOpen ) . toEqual ( false ) ; <nl> 
mmm a / packages / vega / test / web / bind - external . html <nl> ppp b / packages / vega / test / web / bind - external . html <nl> " update " : { <nl> " fill " : { " value " : " steelblue " } , <nl> " xc " : { " scale " : " xscale " , " field " : " u " , " band " : 0 . 5 } , <nl> - " width " : { " signal " : " barWidth " } <nl> + " width " : { " signal " : " + barWidth " } <nl> } , <nl> " hover " : { <nl> " fill " : { " value " : " red " } <nl> 
mmm a / VisComponent / test / events . js <nl> ppp b / VisComponent / test / events . js <nl> import Events from ' . . / mixin / Events ' ; <nl> test ( ' Events mixin for VisComponent ' , t = > { <nl> - t . plan ( 5 ) ; <nl> - <nl> let EventedVisComponent = class extends Events ( VisComponent ) { <nl> constructor ( el , options ) { <nl> super ( el ) ; <nl> @ @ - 41 , 6 + 39 , 9 @ @ test ( ' Events mixin for VisComponent ' , t = > { <nl> t . equal ( v . value , options . value ) ; <nl> / / Make sure we can catch triggered events from the component . <nl> - v . on ( ' foobar ' , value = > t . equal ( value , options . value , ' Event is emitted properly ' ) ) ; <nl> + v . on ( ' foobar ' , value = > { <nl> + t . equal ( value , options . value , ' Event is emitted properly ' ) ; <nl> + t . end ( ) <nl> + } ) ; <nl> v . emitEvent ( ) ; <nl> } ) ; <nl> 
mmm a / app / examples / dynamic - linechart / index . js <nl> ppp b / app / examples / dynamic - linechart / index . js <nl> super . render ( ) ; <nl> this . emit ( ' render ' ) ; <nl> } <nl> - <nl> - data ( data ) { <nl> - this . options . data = data ; <nl> - <nl> - this . chart . then ( chart = > { <nl> - let data = chart . data ( ' data ' ) ; <nl> - data . remove ( ( ) = > true ) ; <nl> - data . insert ( this . options . data ) ; <nl> - <nl> - chart . update ( ) ; <nl> - } ) ; <nl> - } <nl> } <nl> let data = [ ] ; <nl> @ @ - 58 , 7 + 46 , 7 @ @ window . onload = ( ) = > { <nl> counter + + ; <nl> - vis . data ( data ) ; <nl> + vis . update ( { data } ) ; <nl> vis . render ( ) ; <nl> } , 1000 ) ; <nl> 
mmm a / tests / webpack . config . js <nl> ppp b / tests / webpack . config . js <nl> var candelaWebpack = require ( ' . . / webpack ' ) ; <nl> - var config = { } ; <nl> - <nl> - config . entry = { <nl> - ' tests ' : ' . / tests . js ' <nl> - } ; <nl> - <nl> - config . devtool = ' inline - source - map ' ; <nl> - <nl> - config . node = { <nl> + module . exports = candelaWebpack ( { <nl> + entry : { <nl> + tests : ' . / tests . js ' <nl> + } , <nl> + devtool : ' inline - source - map ' , <nl> + node : { <nl> fs : ' empty ' <nl> - } ; <nl> - <nl> - config . output = { <nl> + } , <nl> + output : { <nl> path : ' build ' , <nl> filename : ' tests . js ' <nl> - } ; <nl> - config . module = { <nl> + } , <nl> + module : { <nl> loaders : [ <nl> { <nl> test : / \ . css / , <nl> @ @ - 25 , 9 + 20 , 5 @ @ config . module = { <nl> include : / node_modules \ / nvd3 / , <nl> } , <nl> ] <nl> - } ; <nl> - delete config . plugins ; <nl> - <nl> - var final = candelaWebpack ( config ) ; <nl> - <nl> - module . exports = final ; <nl> + } <nl> + } ) ; <nl> 
mmm a / tests / webpack . config . js <nl> ppp b / tests / webpack . config . js <nl> entry : { <nl> tests : ' . / tests . js ' <nl> } , <nl> - devtool : ' inline - source - map ' , <nl> - node : { <nl> - fs : ' empty ' <nl> - } , <nl> output : { <nl> path : ' build ' , <nl> filename : ' tests . js ' <nl> + } , <nl> + devtool : ' inline - source - map ' , <nl> + node : { <nl> + fs : ' empty ' <nl> } <nl> } ) ; <nl> 
mmm a / tests / package . json <nl> ppp b / tests / package . json <nl> " name " : " tests " , <nl> " version " : " 0 . 0 . 0 " , <nl> - " description " : " Candela unit tests " , <nl> + " description " : " Candela unit / coverage / image tests " , <nl> " scripts " : { <nl> " build : unit " : " webpack " , <nl> " build : coverage " : " webpack - - config webpack - coverage . config . js " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test : unit : debug " : " cd tests ; karma start - - log - level debug " , <nl> " test : image " : " npm run test : image : raw | tap - spec " , <nl> - " test : image : raw " : " result = true ; npm run test : image : server : down ; npm run test : image : server : up & & find packages / - name ' * . image . js ' | xargs - n 1 babel - node | | result = false ; npm run test : image : server : down ; $ { result } " , <nl> + " test : image : raw " : " result = true ; npm run test : image : server : down ; npm run test : image : server : up & & find plugins / - name ' * . image . js ' | xargs - n 1 babel - node | | result = false ; npm run test : image : server : down ; $ { result } " , <nl> " test : image : server : up " : " sh script / test - server - up . sh > . server . log " , <nl> " test : image : server : down " : " sh script / test - server - down . sh " , <nl> " build : test : coverage " : " cd tests ; CANDELA_COVERAGE = 1 webpack " , <nl> 
mmm a / plugins / lineup / LineUp / test / lineup . js <nl> ppp b / plugins / lineup / LineUp / test / lineup . js <nl> / / needed to handle Babel ' s conversion of for ` ( x of array ) ` <nl> import ' babel - polyfill ' ; <nl> - import $ from ' jquery ' ; <nl> - <nl> import LineUp from ' . . ' ; <nl> test ( ' LineUp component ' , t = > { <nl> - $ ( ' body ' ) . append ( $ ( ' < div / > ' ) . attr ( { id : ' elem ' } ) . css ( { width : 800 , height : 600 } ) ) ; <nl> + const div = document . createElement ( ' div ' ) ; <nl> + div . setAttribute ( ' style ' , ' width : 800px ; height : 600px ' ) ; <nl> + <nl> t . ok ( LineUp , ' LineUp exists ' ) ; <nl> t . ok ( LineUp . options , ' LineUp options exists ' ) ; <nl> - let lu = new LineUp ( document . getElementById ( ' elem ' ) , { <nl> + let lu = new LineUp ( div , { <nl> data : [ <nl> { a : 1 , b : 2 , c : ' a ' , d : true } , <nl> { a : 3 , b : 4 , c : ' b ' , d : false } , <nl> 
mmm a / util / test / exports . js <nl> ppp b / util / test / exports . js <nl> let count = 9 ; <nl> if ( opts . default ) { <nl> - t . equal ( cd . default , undefined , ' candela . default does not exist ' ) ; <nl> - } else { <nl> t . ok ( cd . default , ' candela . default exists ' ) ; <nl> count + = 1 ; <nl> + } else { <nl> + t . equal ( cd . default , undefined , ' candela . default does not exist ' ) ; <nl> } <nl> t . equal ( Object . keys ( cd ) . length , count , ' candela contains no other members ' ) ; <nl> @ @ - 101 , 7 + 101 , 7 @ @ function structureTests ( t , cd , opts ) { <nl> test ( ' Structure and content of default exported Candela library object ' , t = > { <nl> structureTests ( t , candela , { <nl> empty : true , <nl> - default : true <nl> + default : false <nl> } ) ; <nl> t . end ( ) ; <nl> } ) ; <nl> @ @ - 109 , 7 + 109 , 7 @ @ test ( ' Structure and content of default exported Candela library object ' , t = > { <nl> test ( ' Structure and content of non - default exported Candela library object ' , t = > { <nl> structureTests ( t , candelaStar , { <nl> empty : true , <nl> - default : false <nl> + default : true <nl> } ) ; <nl> t . end ( ) ; <nl> } ) ; <nl> 
mmm a / plugins / vega / BarChart / test / barchart . js <nl> ppp b / plugins / vega / BarChart / test / barchart . js <nl> import BarChart from ' . . ' ; <nl> test ( ' BarChart component ' , t = > { <nl> - t . plan ( 7 ) ; <nl> + t . plan ( 5 ) ; <nl> const data = [ <nl> { id : 0 , a : 1 , b : 3 , c : 3 } , <nl> @ @ - 29 , 14 + 29 , 10 @ @ test ( ' BarChart component ' , t = > { <nl> } ) ; <nl> vis . render ( ) ; <nl> - t . equal ( el . childNodes . length , 1 , ' VegaCharts should have a single element under the top - level div ' ) ; <nl> + t . equal ( el . childNodes . length , 2 , ' VegaViews should have two elements under the top - level div ' ) ; <nl> - let container = el . childNodes [ 0 ] ; <nl> - t . equal ( container . nodeName , ' DIV ' , ' The single element should be a div ' ) ; <nl> - t . equal ( container . childNodes . length , 1 , ' The div should have a single child element . ' ) ; <nl> - <nl> - let svg = container . childNodes [ 0 ] ; <nl> - t . equal ( svg . nodeName , ' svg ' , ' The single child should be an svg . ' ) ; <nl> + let svg = el . childNodes [ 0 ] ; <nl> + t . equal ( svg . nodeName , ' SVG ' , ' The first element should be an SVG ' ) ; <nl> let bars = select ( svg ) <nl> . select ( ' g . mark - rect ' ) <nl> @ @ - 45 , 10 + 41 , 9 @ @ test ( ' BarChart component ' , t = > { <nl> vis . update ( { <nl> data : data . concat ( [ { id : 8 , a : 10 , b : 6 , c : 3 } ] ) <nl> - } ) . then ( ( ) = > vis . render ( ) ) <nl> + } ) <nl> + . then ( ( ) = > vis . render ( ) ) <nl> . then ( ( ) = > { <nl> - vis . render ( ) ; <nl> - <nl> bars = select ( svg ) <nl> . select ( ' g . mark - rect ' ) <nl> . selectAll ( ' rect ' ) ; <nl> 
mmm a / packages / examples / package . json <nl> ppp b / packages / examples / package . json <nl> " serve " : " http - server dist - p 28000 " , <nl> " lint " : " semistandard | snazzy " , <nl> - " test " : " npm run serve > . server . log & pid = $ ! & & babel - node test / index . js | tap - spec ; kill $ { pid } " <nl> + " test " : " result = true ; npm run serve > . server . log & pid = $ ! & & babel - node test / index . js | tap - spec ; if [ $ { PIPESTATUS [ 0 ] } = = 1 ] ; then result = false ; fi ; kill $ { pid } ; $ { result } " <nl> } , <nl> " private " : true , <nl> " babel " : { <nl> 
mmm a / packages / treeheatmap / src / TreeHeatmap / test / treeheatmap . spec . js <nl> ppp b / packages / treeheatmap / src / TreeHeatmap / test / treeheatmap . spec . js <nl> < / g > <nl> < clipPath id = " clip - vertical " > < rect x = " 0 " y = " 100 " width = " 100 " height = " 200 " > < / rect > < / clipPath > <nl> < g class = " vertical " clip - path = " url ( # clip - vertical ) " > <nl> - < path class = " tree - links " d = " M100 , 150L0 , 150L0 , 250L100 , 250 " style = " fill - opacity : 0 ; stroke : # 000000 ; " > < / path > <nl> - < rect class = " tree - select " x = " 0 " y = " 100 " width = " 100 " height = " 200 " style = " fill : # 4682b4 ; fill - opacity : 0 ; " > < / rect > <nl> + < path class = " tree - links " d = " M100 , 150L0 , 150L0 , 250L100 , 250 " style = " fill - opacity : 0 ; stroke : black ; " > < / path > <nl> + < rect class = " tree - select " x = " 0 " y = " 100 " width = " 100 " height = " 200 " style = " fill : steelblue ; fill - opacity : 0 ; " > < / rect > <nl> < / g > <nl> < clipPath id = " clip - horizontal " > < rect x = " 100 " y = " 0 " width = " 200 " height = " 100 " > < / rect > < / clipPath > <nl> < g class = " horizontal " clip - path = " url ( # clip - horizontal ) " > <nl> - < path class = " tree - links " d = " M150 , 100L150 , 0L250 , 0L250 , 100 " style = " fill - opacity : 0 ; stroke : # 000000 ; " > < / path > <nl> - < rect class = " tree - select " y = " 0 " x = " 100 " height = " 100 " width = " 200 " style = " fill : # 4682b4 ; fill - opacity : 0 ; " > < / rect > <nl> + < path class = " tree - links " d = " M150 , 100L150 , 0L250 , 0L250 , 100 " style = " fill - opacity : 0 ; stroke : black ; " > < / path > <nl> + < rect class = " tree - select " y = " 0 " x = " 100 " height = " 100 " width = " 200 " style = " fill : steelblue ; fill - opacity : 0 ; " > < / rect > <nl> < / g > <nl> < / svg > ` . replace ( / \ n / g , ' ' ) . replace ( / { 2 } / g , ' ' ) ; <nl> 
mmm a / packages / lineup / webpack . config . test . babel . js <nl> ppp b / packages / lineup / webpack . config . test . babel . js <nl> ] , <nl> exclude : / \ . spec \ . js $ / <nl> } , <nl> + { <nl> + test : / \ . js $ / , <nl> + exclude : / node_modules / , <nl> + use : { <nl> + loader : ' babel - loader ' , <nl> + options : { <nl> + presets : [ <nl> + [ ' @ babel / env ' , { <nl> + targets : { <nl> + node : ' current ' <nl> + } <nl> + } ] <nl> + ] <nl> + } <nl> + } <nl> + } , <nl> { <nl> test : / \ . styl $ / , <nl> use : [ ' style - loader ' , ' css - loader ' , ' stylus - loader ' ] <nl> 
mmm a / packages / lineup / src / LineUp / test / lineup . spec . js <nl> ppp b / packages / lineup / src / LineUp / test / lineup . spec . js <nl> import test from ' tape - catch ' ; <nl> / / needed to handle Babel ' s conversion of for ` ( x of array ) ` <nl> @ @ - 8 , 6 + 9 , 7 @ @ import LineUp from ' . . ' ; <nl> test ( ' LineUp component ' , t = > { <nl> const div = document . createElement ( ' div ' ) ; <nl> div . setAttribute ( ' style ' , ' width : 800px ; height : 600px ' ) ; <nl> + document . body . appendChild ( div ) ; <nl> t . ok ( LineUp , ' LineUp exists ' ) ; <nl> t . ok ( LineUp . options , ' LineUp options exists ' ) ; <nl> @ @ - 18 , 9 + 20 , 9 @ @ test ( ' LineUp component ' , t = > { <nl> { a : - 1 , b : 0 , c : ' c ' , d : false } <nl> ] , <nl> fields : [ ' d ' , ' a ' , ' c ' ] , <nl> - stacked : false , <nl> + stacked : true , <nl> histograms : true , <nl> - animation : true <nl> + animation : false <nl> } ) ; <nl> t . ok ( lu . lineUpConfig , ' LineUp configured ' ) ; <nl> t . equal ( lu . lineUpConfig . renderingOptions . histograms , true , ' LineUp options set ' ) ; <nl> @ @ - 29 , 5 + 31 , 12 @ @ test ( ' LineUp component ' , t = > { <nl> / / still need to add tests for dragging columns and recording their weights , <nl> / / tooltip updates , select callback , and date - based columns <nl> + window . setTimeout ( ( ) = > { <nl> + const rows = select ( lu . el ) <nl> + . selectAll ( ' g . row ' ) <nl> + . nodes ( ) ; <nl> + t . assert ( rows . length > 0 , ' Plot has rendered some data rows ' ) ; <nl> + <nl> t . end ( ) ; <nl> + } , 200 ) ; <nl> } ) ; <nl> 
mmm a / packages / vega / src / component / Histogram / test / histogram . spec . js <nl> ppp b / packages / vega / src / component / Histogram / test / histogram . spec . js <nl> const height = 400 ; <nl> const maxBins = 10 ; <nl> + / / Count how many " classes " there are - - each one will be represented by a <nl> + / / rect mark . <nl> + let classes = new Set ( ) ; <nl> + data . forEach ( d = > { <nl> + classes . add ( d . a ) ; <nl> + } ) ; <nl> + <nl> let el = document . createElement ( ' div ' ) ; <nl> let vis = new Histogram ( el , { <nl> data , <nl> @ @ - 26 , 7 + 33 , 7 @ @ test ( ' Histogram component ' , t = > { <nl> . select ( ' . mark - rect . role - mark . marks ' ) <nl> . selectAll ( ' path ' ) <nl> . nodes ( ) ; <nl> - t . equal ( bars . length , maxBins , ' Plot has correct number of bin marks ' ) ; <nl> + t . equal ( bars . length , classes . size , ' Plot has correct number of bin marks ' ) ; <nl> t . end ( ) ; <nl> } ) ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build : test " : " lerna run build : test " , <nl> " build : coverage " : " COVERAGE = 1 npm run build : test " , <nl> - " test : unit " : " lerna run test - - ignore @ candela / examples " , <nl> + " test : unit " : " lerna run test - - ignore @ candela / examples - - concurrency 1 " , <nl> " test : image " : " cd packages / examples & & npm test " , <nl> " test : coverage " : " COVERAGE = 1 npm run test : unit " , <nl> " coverage : report " : " http - server build / coverage / html - p $ { PORT - 3000 } " , <nl> 
mmm a / tests / build . test . js <nl> ppp b / tests / build . test . js <nl> import { setup , clean } from ' . / lib / output ' ; <nl> import { normalize , expectedOutputs } from ' . / build . snapshot ' ; <nl> - const options = { timeout : 30 * 1000 } ; <nl> + const options = { timeout : 45 * 1000 } ; <nl> test ( ' preact build - before ' , async ( ) = > { <nl> await setup ( ) ; <nl> 
mmm a / tests / lib / chrome . js <nl> ppp b / tests / lib / chrome . js <nl> const openPage = async ( chrome , url , retryCount , retryInterval ) = > { <nl> if ( retryCount < 0 ) { <nl> - throw new Error ( ' Page could not be loaded ! ' ) ; <nl> + / / eslint - disable - next - line no - console <nl> + console . error ( ' Page could not be loaded - timeout reached . Continuing without throwing error . . . ' ) ; <nl> + return ; <nl> } <nl> let result ; <nl> @ @ - 87 , 6 + 89 , 6 @ @ const navigateToPage = ( chrome , url , timeout ) = > new Promise ( async ( resolve , rej <nl> reject ( ) ; <nl> } , timeout ) ; <nl> - await chrome . Page . navigate ( { url } ) ; <nl> chrome . on ( ' Network . responseReceived ' , listener ) ; <nl> + await chrome . Page . navigate ( { url } ) ; <nl> } ) ; <nl> 
mmm a / test / validators . js <nl> ppp b / test / validators . js <nl> } ) ; <nl> } ) ; <nl> + it ( ' should validate luhn numbers ' , ( ) = > { <nl> + test ( { <nl> + validator : ' isLuhnValid ' , <nl> + valid : [ <nl> + ' 0 ' , <nl> + ' 5421 ' , <nl> + ' 01234567897 ' , <nl> + ' 0123456789012345678906 ' , <nl> + ' 0123456789012345678901234567891 ' , <nl> + ' 123456789012345678906 ' , <nl> + ' 375556917985515 ' , <nl> + ' 36050234196908 ' , <nl> + ' 4716461583322103 ' , <nl> + ' 4716 - 2210 - 5188 - 5662 ' , <nl> + ' 4929 7226 5379 7141 ' , <nl> + ] , <nl> + invalid : [ <nl> + ' ' , <nl> + ' 1 ' , <nl> + ' 5422 ' , <nl> + ' foo ' , <nl> + ' prefix6234917882863855 ' , <nl> + ' 623491788middle2863855 ' , <nl> + ' 6234917882863855suffix ' , <nl> + ] , <nl> + } ) ; <nl> + } ) ; <nl> + <nl> it ( ' should validate credit cards ' , ( ) = > { <nl> test ( { <nl> validator : ' isCreditCard ' , <nl> 
mmm a / test / notifier . test . js <nl> ppp b / test / notifier . test . js <nl> var notifier = new Notifier ( queue , options ) ; <nl> var initialItem = { a : 123 , b : ' a string ' } ; <nl> + var error = new Error ( ' fizz buzz ' ) ; <nl> notifier . addTransform ( function ( i , o , cb ) { <nl> - cb ( new Error ( ' fizz buzz ' ) , null ) ; <nl> + cb ( error , null ) ; <nl> } ) . addTransform ( function ( i , o , cb ) { <nl> expect ( false ) . to . be . ok ( ) ; / / assert this is not called <nl> cb ( null , { a : 42 , b : i . b } ) ; <nl> @ @ - 182 , 7 + 183 , 7 @ @ describe ( ' log ' , function ( ) { <nl> notifier . log ( initialItem , spy ) ; <nl> expect ( spy . called ) . to . be . ok ( ) ; <nl> - expect ( spy . calledWithExactly ( new Error ( ' fizz buzz ' ) , null ) ) . to . be . ok ( ) ; <nl> + expect ( spy . calledWithExactly ( error , null ) ) . to . be . ok ( ) ; <nl> expect ( queue . items . length ) . to . eql ( 0 ) ; <nl> done ( ) ; <nl> 
mmm a / . eslintrc <nl> ppp b / . eslintrc <nl> " quotes " : [ 2 , " single " , " avoid - escape " ] , <nl> " no - underscore - dangle " : 0 , <nl> - " no - useless - escape " : 0 <nl> + " no - useless - escape " : 0 , <nl> + " no - use - before - define " : [ 1 , { " functions " : false } ] <nl> } <nl> } <nl> 
mmm a / karma . conf . js <nl> ppp b / karma . conf . js <nl> / / run the bundle through the webpack and sourcemap plugins <nl> preprocessors : { <nl> - ' test / ! ( requirejs ) . test . js ' : [ ' webpack ' , ' sourcemap ' ] , <nl> + ' test / * * / ! ( requirejs ) . test . js ' : [ ' webpack ' , ' sourcemap ' ] , <nl> ' * * / * . html ' : [ ' html2js ' ] <nl> } , <nl> 
mmm a / test / examples / universalBrowser . test . js <nl> ppp b / test / examples / universalBrowser . test . js <nl> document . write ( window . __html__ [ ' examples / universal - browser / test . html ' ] ) ; <nl> / / Stub the xhr interface . <nl> - server = sinon . createFakeServer ( ) ; <nl> + window . server = sinon . createFakeServer ( ) ; <nl> / / Give the snippet time to load and init . <nl> setTimeout ( function ( ) { <nl> @ @ - 18 , 10 + 18 , 11 @ @ describe ( ' Rollbar loaded by snippet ' , function ( ) { <nl> } ) ; <nl> after ( function ( ) { <nl> - server . restore ( ) ; <nl> + window . server . restore ( ) ; <nl> } ) ; <nl> it ( ' should send a valid log event ' , function ( done ) { <nl> + var server = window . server ; <nl> var rollbar = document . defaultView . Rollbar ; <nl> server . respondWith ( ' POST ' , ' api / 1 / item ' , <nl> @ @ - 35 , 7 + 36 , 7 @ @ describe ( ' Rollbar loaded by snippet ' , function ( ) { <nl> var ret = rollbar . info ( ' test ' ) ; <nl> server . respond ( ) ; <nl> - body = JSON . parse ( server . requests [ 0 ] . requestBody ) ; <nl> + var body = JSON . parse ( server . requests [ 0 ] . requestBody ) ; <nl> expect ( body . access_token ) . to . eql ( ' POST_CLIENT_ITEM_TOKEN ' ) ; <nl> expect ( body . data . uuid ) . to . eql ( ret . uuid ) ; <nl> 
mmm a / test / examples / angular2 . test . js <nl> ppp b / test / examples / angular2 . test . js <nl> / * globals sinon * / <nl> + / / To make changes to the example app , see / examples / angular2 / README . md . <nl> + <nl> describe ( ' Angular2 app ' , function ( ) { <nl> this . timeout ( 4000 ) ; <nl> @ @ - 24 , 10 + 26 , 7 @ @ describe ( ' Angular2 app ' , function ( ) { <nl> window . server . restore ( ) ; <nl> } ) ; <nl> - it ( ' should send a valid log event ' , function ( done ) { <nl> - var server = window . server ; <nl> - var angularComponent = window . angularAppComponent ; <nl> - <nl> + function stubResponse ( server ) { <nl> server . respondWith ( ' POST ' , ' api / 1 / item ' , <nl> [ <nl> 200 , <nl> @ @ - 35 , 6 + 34 , 14 @ @ describe ( ' Angular2 app ' , function ( ) { <nl> ' { " err " : 0 , " result " : { " uuid " : " d4c7acef55bf4c9ea95e4fe9428a8287 " } } ' <nl> ] <nl> ) ; <nl> + } <nl> + <nl> + it ( ' should send a valid log event ' , function ( done ) { <nl> + var server = window . server ; <nl> + var angularComponent = window . angularAppComponent ; <nl> + <nl> + stubResponse ( server ) ; <nl> + server . requests . length = 0 ; <nl> angularComponent . publicRollbarInfo ( ) ; <nl> server . respond ( ) ; <nl> @ @ - 46 , 4 + 53 , 44 @ @ describe ( ' Angular2 app ' , function ( ) { <nl> done ( ) ; <nl> } ) ; <nl> + <nl> + it ( ' should minimize Angular change detection events ' , function ( done ) { <nl> + var server = window . server ; <nl> + var angularComponent = window . angularAppComponent ; <nl> + var doCheckCount = angularComponent . doCheckCount ; <nl> + <nl> + stubResponse ( server ) ; <nl> + server . requests . length = 0 ; <nl> + <nl> + angularComponent . publicRollbarInfo ( ) ; <nl> + server . respond ( ) ; <nl> + <nl> + / / Angular triggers change detection on all events , timers , and XHR responses . <nl> + / / Rollbar . js exits the Angular Zone . js zone before API requests , preventing <nl> + / / change detection from being triggered by Rollbar reporting , and improving <nl> + / / performance for some apps . <nl> + / / <nl> + / / See src / browser / transport . js : _makeZoneRequest ( ) . <nl> + expect ( angularComponent . doCheckCount ) . to . eql ( doCheckCount + 1 ) ; <nl> + <nl> + done ( ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should report uncaught error ' , function ( done ) { <nl> + var server = window . server ; <nl> + <nl> + stubResponse ( server ) <nl> + server . requests . length = 0 ; <nl> + <nl> + var element = document . getElementById ( ' throw - error ' ) ; <nl> + element . click ( ) ; <nl> + server . respond ( ) ; <nl> + <nl> + var body = JSON . parse ( server . requests [ 0 ] . requestBody ) ; <nl> + <nl> + expect ( body . access_token ) . to . eql ( ' POST_CLIENT_ITEM_TOKEN ' ) ; <nl> + expect ( body . data . body . trace . exception . message ) . to . eql ( ' angular test error ' ) ; <nl> + <nl> + done ( ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / browser . rollbar . test . js <nl> ppp b / test / browser . rollbar . test . js <nl> done ( ) ; <nl> } ) <nl> } ) ; <nl> + <nl> + / / Test direct call to onerror , as used in verification of browser js install . <nl> + describe ( ' onerror ' , function ( ) { <nl> + before ( function ( done ) { <nl> + window . server = sinon . createFakeServer ( ) ; <nl> + done ( ) ; <nl> + } ) ; <nl> + <nl> + after ( function ( ) { <nl> + window . server . restore ( ) ; <nl> + } ) ; <nl> + <nl> + function stubResponse ( server ) { <nl> + server . respondWith ( ' POST ' , ' api / 1 / item ' , <nl> + [ <nl> + 200 , <nl> + { ' Content - Type ' : ' application / json ' } , <nl> + ' { " err " : 0 , " result " : { " uuid " : " d4c7acef55bf4c9ea95e4fe9428a8287 " } } ' <nl> + ] <nl> + ) ; <nl> + } <nl> + <nl> + it ( ' should send message when calling onerror directly ' , function ( done ) { <nl> + var server = window . server ; <nl> + stubResponse ( server ) ; <nl> + server . requests . length = 0 ; <nl> + <nl> + var options = { <nl> + accessToken : ' POST_CLIENT_ITEM_TOKEN ' , <nl> + captureUncaught : true <nl> + } ; <nl> + new Rollbar ( options ) ; <nl> + <nl> + window . onerror ( " TestRollbarError : testing window . onerror " , window . location . href ) ; <nl> + <nl> + server . respond ( ) ; <nl> + <nl> + var body = JSON . parse ( server . requests [ 0 ] . requestBody ) ; <nl> + <nl> + expect ( body . access_token ) . to . eql ( ' POST_CLIENT_ITEM_TOKEN ' ) ; <nl> + expect ( body . data . body . trace . exception . message ) . to . eql ( ' testing window . onerror ' ) ; <nl> + <nl> + done ( ) ; <nl> + } ) <nl> + } ) ; <nl> + <nl> describe ( ' captureEvent ' , function ( ) { <nl> it ( ' should handle missing / default type and level ' , function ( done ) { <nl> var options = { } ; <nl> 
mmm a / test / examples / webpack . test . js <nl> ppp b / test / examples / webpack . test . js <nl> var body = JSON . parse ( server . requests [ 0 ] . requestBody ) ; <nl> expect ( body . access_token ) . to . eql ( ' POST_CLIENT_ITEM_TOKEN ' ) ; <nl> - expect ( body . data . body . trace . exception . message ) . to . eql ( ' webpack test error ' ) ; <nl> + <nl> + / / This has become necessary because Travis switched their Chrome stable <nl> + / / version _down_ from 76 to 62 , which handles this test case differently . <nl> + var version = parseInt ( window . navigator . userAgent . match ( new RegExp ( ' ^ . * HeadlessChrome / ( [ 0 - 9 ] * ) . * $ ' ) ) [ 1 ] ) ; <nl> + var message = version > 62 ? ' webpack test error ' : ' Script error . ' ; <nl> + <nl> + expect ( body . data . body . trace . exception . message ) . to . eql ( message ) ; <nl> done ( ) ; <nl> } ) ; <nl> 
mmm a / examples / angular2 / src / app / rollbar . ts <nl> ppp b / examples / angular2 / src / app / rollbar . ts <nl> inspectAnonymousErrors : true , <nl> ignoreDuplicateErrors : true , <nl> wrapGlobalEventHandlers : false , <nl> - scrubRequestBody : true <nl> + scrubRequestBody : true , <nl> + exitOnUncaughtException : false <nl> } ; <nl> export const RollbarService = new InjectionToken < Rollbar > ( ' rollbar ' ) ; <nl> 
mmm a / test / browser . rollbar . test . js <nl> ppp b / test / browser . rollbar . test . js <nl> done ( ) ; <nl> } ) ; <nl> + it ( ' should add telemetry events for xhr calls ' , function ( done ) { <nl> + var server = window . server ; <nl> + stubResponse ( server ) ; <nl> + server . requests . length = 0 ; <nl> + <nl> + server . respondWith ( ' POST ' , ' xhr - test ' , <nl> + [ <nl> + 200 , <nl> + { ' Content - Type ' : ' application / json ' } , <nl> + JSON . stringify ( { name : ' foo ' , password : ' 123456 ' } ) <nl> + ] <nl> + ) ; <nl> + <nl> + var options = { <nl> + accessToken : ' POST_CLIENT_ITEM_TOKEN ' , <nl> + autoInstrument : { <nl> + log : false , <nl> + network : true , <nl> + networkResponseHeaders : true , <nl> + networkResponseBody : true , <nl> + networkRequestBody : true , <nl> + networkRequestHeaders : true <nl> + } <nl> + } ; <nl> + var rollbar = window . rollbar = new Rollbar ( options ) ; <nl> + <nl> + / / generate a telemetry event <nl> + var xhr = new XMLHttpRequest ( ) ; <nl> + xhr . open ( ' POST ' , ' https : / / example . com / xhr - test ' , true ) ; <nl> + xhr . setRequestHeader ( ' Content - type ' , ' application / json ' ) ; <nl> + xhr . setRequestHeader ( ' Secret ' , ' abcdef ' ) ; <nl> + xhr . onreadystatechange = function ( ) { <nl> + if ( xhr . readyState = = = 4 ) { <nl> + try { <nl> + rollbar . log ( ' test ' ) ; / / generate a payload to inspect <nl> + <nl> + expect ( server . requests . length ) . to . eql ( 2 ) ; <nl> + var body = JSON . parse ( server . requests [ 1 ] . requestBody ) ; <nl> + <nl> + / / Sinon fake server doesn ' t generate response body or headers that are visible <nl> + / / via the XMLHttpRequest properties and methods . So we settle for verifying <nl> + / / the request only . <nl> + <nl> + / / Verify request capture and scrubbing <nl> + expect ( body . data . body . telemetry [ 0 ] . body . request ) . to . eql ( ' { " name " : " bar " , " secret " : " * * * * * * * * " } ' ) ; <nl> + <nl> + / / Verify request headers capture and case - insensitive scrubbing <nl> + expect ( body . data . body . telemetry [ 0 ] . body . request_headers ) . to . eql ( { ' Content - type ' : ' application / json ' , Secret : ' * * * * * * * * ' } ) ; <nl> + <nl> + done ( ) ; <nl> + } catch ( e ) { <nl> + done ( e ) ; <nl> + } <nl> + } <nl> + } ; <nl> + xhr . send ( JSON . stringify ( { name : ' bar ' , secret : ' xhr post ' } ) ) ; <nl> + server . respond ( ) ; <nl> + } ) ; <nl> + <nl> + it ( ' should add telemetry events for fetch calls ' , function ( done ) { <nl> + var server = window . server ; <nl> + stubResponse ( server ) ; <nl> + server . requests . length = 0 ; <nl> + <nl> + window . fetchStub = sinon . stub ( window , ' fetch ' ) ; <nl> + window . fetch . returns ( Promise . resolve ( new Response ( <nl> + JSON . stringify ( { name : ' foo ' , password : ' 123456 ' } ) , <nl> + { status : 200 , statusText : ' OK ' , headers : { ' content - type ' : ' application / json ' , ' password ' : ' 123456 ' } } <nl> + ) ) ) ; <nl> + <nl> + var options = { <nl> + accessToken : ' POST_CLIENT_ITEM_TOKEN ' , <nl> + autoInstrument : { <nl> + log : false , <nl> + network : true , <nl> + networkResponseHeaders : true , <nl> + networkResponseBody : true , <nl> + networkRequestBody : true , <nl> + networkRequestHeaders : true <nl> + } <nl> + } ; <nl> + var rollbar = window . rollbar = new Rollbar ( options ) ; <nl> + <nl> + var fetchHeaders = new Headers ( ) ; <nl> + fetchHeaders . append ( ' Content - Type ' , ' application / json ' ) ; <nl> + fetchHeaders . append ( ' Secret ' , ' 123456 ' ) ; <nl> + <nl> + const fetchInit = { <nl> + method : ' POST ' , <nl> + headers : fetchHeaders , <nl> + body : JSON . stringify ( { name : ' bar ' , secret : ' xhr post ' } ) <nl> + } ; <nl> + var fetchRequest = new Request ( ' https : / / example . com / xhr - test ' ) ; <nl> + window , fetch ( fetchRequest , fetchInit ) <nl> + . then ( function ( _response ) { <nl> + try { <nl> + rollbar . log ( ' test ' ) ; / / generate a payload to inspect <nl> + server . respond ( ) ; <nl> + <nl> + expect ( server . requests . length ) . to . eql ( 1 ) ; <nl> + var body = JSON . parse ( server . requests [ 0 ] . requestBody ) ; <nl> + <nl> + / / Verify request capture and scrubbing <nl> + expect ( body . data . body . telemetry [ 0 ] . body . request ) . to . eql ( ' { " name " : " bar " , " secret " : " * * * * * * * * " } ' ) ; <nl> + <nl> + / / Verify request headers capture and case - insensitive scrubbing <nl> + expect ( body . data . body . telemetry [ 0 ] . body . request_headers ) . to . eql ( { ' content - type ' : ' application / json ' , secret : ' * * * * * * * * ' } ) ; <nl> + <nl> + / / When using the Sinon test stub , the response body is populated in Headless Chrome 73 , <nl> + / / but not in 77 . When using the Fetch API normally , it is populated in all tested Chrome versions . <nl> + / / Disable here due to the Sinon limitation . <nl> + / / <nl> + / / Verify response capture and scrubbing <nl> + / / expect ( body . data . body . telemetry [ 0 ] . body . response . body ) . to . eql ( ' { " name " : " foo " , " password " : " * * * * * * * * " } ' ) ; <nl> + <nl> + / / Verify response headers capture and case - insensitive scrubbing <nl> + expect ( body . data . body . telemetry [ 0 ] . body . response . headers ) . to . eql ( { ' content - type ' : ' application / json ' , password : ' * * * * * * * * ' } ) ; <nl> + <nl> + rollbar . configure ( { autoInstrument : false } ) ; <nl> + window . fetch . restore ( ) ; <nl> + done ( ) ; <nl> + } catch ( e ) { <nl> + done ( e ) ; <nl> + } <nl> + } ) <nl> + } ) ; <nl> + <nl> it ( ' should add a diagnostic message when wrapConsole fails ' , function ( done ) { <nl> var server = window . server ; <nl> stubResponse ( server ) ; <nl> 
mmm a / test / predicates . test . js <nl> ppp b / test / predicates . test . js <nl> } ; <nl> expect ( p . messageIsIgnored ( logger ) ( item , settings ) ) . to . not . be . ok ( ) ; <nl> } ) ; <nl> + it ( ' false if ignoredMessages regex match ' , function ( ) { <nl> + var item = { <nl> + level : ' critical ' , <nl> + body : { <nl> + message : { body : ' { " data " : { " messages " : [ { " message " : " Unauthorized " } ] } } ' } <nl> + } <nl> + } ; <nl> + var settings = { <nl> + reportLevel : ' debug ' , <nl> + ignoredMessages : [ ' { " data " : { " messages " : \ \ [ ' ] <nl> + } ; <nl> + expect ( p . messageIsIgnored ( logger ) ( item , settings ) ) . to . not . be . ok ( ) ; <nl> + } ) ; <nl> it ( ' true if both trace and body message but ignoredMessages only match body ' , function ( ) { <nl> var item = { <nl> level : ' critical ' , <nl> 
mmm a / test / predicates . test . js <nl> ppp b / test / predicates . test . js <nl> expect ( p . messageIsIgnored ( logger ) ( item , settings ) ) . to . not . be . ok ( ) ; <nl> } ) ; <nl> it ( ' false if ignoredMessages regex match ' , function ( ) { <nl> + var item = { <nl> + level : ' critical ' , <nl> + body : { <nl> + message : { body : ' This is an ignored message ' } <nl> + } <nl> + } ; <nl> + var settings = { <nl> + reportLevel : ' debug ' , <nl> + ignoredMessages : [ ' ^ This is an . { 7 } message $ ' ] <nl> + } ; <nl> + expect ( p . messageIsIgnored ( logger ) ( item , settings ) ) . to . not . be . ok ( ) ; <nl> + } ) ; <nl> + it ( ' false if ignoredMessages literal match ' , function ( ) { <nl> var item = { <nl> level : ' critical ' , <nl> body : { <nl> @ @ - 390 , 6 + 403 , 19 @ @ describe ( ' messageIsIgnored ' , function ( ) { <nl> } ; <nl> expect ( p . messageIsIgnored ( logger ) ( item , settings ) ) . to . not . be . ok ( ) ; <nl> } ) ; <nl> + it ( ' false if ignoredMessages more literal regex matches ' , function ( ) { <nl> + var item = { <nl> + level : ' critical ' , <nl> + body : { <nl> + message : { body : ' Match these characters : ( * + ? ) ' } <nl> + } <nl> + } ; <nl> + var settings = { <nl> + reportLevel : ' debug ' , <nl> + ignoredMessages : [ ' \ \ ( \ \ * \ \ + \ \ ? \ \ ) ' ] <nl> + } ; <nl> + expect ( p . messageIsIgnored ( logger ) ( item , settings ) ) . to . not . be . ok ( ) ; <nl> + } ) ; <nl> it ( ' true if both trace and body message but ignoredMessages only match body ' , function ( ) { <nl> var item = { <nl> level : ' critical ' , <nl> 
mmm a / test / examples / webpack . test . js <nl> ppp b / test / examples / webpack . test . js <nl> / / This has become necessary because Travis switched their Chrome stable <nl> / / version _down_ from 76 to 62 , which handles this test case differently . <nl> + / / 2020 - 05 - 06 : Travis Chrome 62 is now returning the original message . <nl> var version = parseInt ( window . navigator . userAgent . match ( new RegExp ( ' ^ . * HeadlessChrome / ( [ 0 - 9 ] * ) . * $ ' ) ) [ 1 ] ) ; <nl> - var message = version > 62 ? ' webpack test error ' : ' Script error . ' ; <nl> + var message = version > = 62 ? ' webpack test error ' : ' Script error . ' ; <nl> expect ( body . data . body . trace . exception . message ) . to . eql ( message ) ; <nl> 
mmm a / spec / cli . spec . js <nl> ppp b / spec / cli . spec . js <nl> confHolder = undefined ; <nl> } ) ; <nl> - it ( ' Test # 042 : config set autosave is called with true ' , ( ) = > { <nl> - return cli ( [ ' node ' , ' cordova ' , ' config ' , ' set ' , ' autosave ' , ' true ' , ' - - silent ' ] ) . then ( ( ) = > { <nl> - expect ( cordovaConfig . autosave ) . toBe ( ' true ' ) ; <nl> + it ( ' Test # 042 : config set is called with true ' , ( ) = > { <nl> + return cli ( [ ' node ' , ' cordova ' , ' config ' , ' set ' , ' foo ' , ' true ' , ' - - silent ' ] ) . then ( ( ) = > { <nl> + expect ( cordovaConfig . foo ) . toBe ( ' true ' ) ; <nl> } ) ; <nl> } ) ; <nl> - it ( ' Test # 043 : config delete autosave is called ' , ( ) = > { <nl> - return cli ( [ ' node ' , ' cordova ' , ' config ' , ' delete ' , ' autosave ' ] ) . then ( ( ) = > { <nl> - expect ( cordovaConfig . autosave ) . toBeUndefined ( ) ; <nl> + it ( ' Test # 043 : config delete is called ' , ( ) = > { <nl> + return cli ( [ ' node ' , ' cordova ' , ' config ' , ' delete ' , ' foo ' ] ) . then ( ( ) = > { <nl> + expect ( cordovaConfig . foo ) . toBeUndefined ( ) ; <nl> } ) ; <nl> } ) ; <nl> it ( ' Test # 044 : config set is called even without value , defaults to true ' , ( ) = > { <nl> - return cli ( [ ' node ' , ' cordova ' , ' config ' , ' set ' , ' autosave ' ] ) . then ( ( ) = > { <nl> - expect ( cordovaConfig . autosave ) . toBe ( true ) ; <nl> + return cli ( [ ' node ' , ' cordova ' , ' config ' , ' set ' , ' foo ' ] ) . then ( ( ) = > { <nl> + expect ( cordovaConfig . foo ) . toBe ( true ) ; <nl> } ) ; <nl> } ) ; <nl> it ( ' Test # 045 : config get is called ' , ( ) = > { <nl> - return cli ( [ ' node ' , ' cordova ' , ' config ' , ' get ' , ' autosave ' ] ) . then ( ( ) = > { <nl> + return cli ( [ ' node ' , ' cordova ' , ' config ' , ' get ' , ' foo ' ] ) . then ( ( ) = > { <nl> expect ( confHolder ) . toBe ( true ) ; <nl> } ) ; <nl> } ) ; <nl> 
mmm a / spec / cli . spec . js <nl> ppp b / spec / cli . spec . js <nl> cli . __set__ ( ' NODE_VERSION_REQUIREMENT ' , ' > = 8 ' ) ; <nl> return cli ( [ ' node ' , ' cordova ' ] ) . then ( ( ) = > { <nl> - const errorMsg = logger . warn . calls . argsFor ( 1 ) . toString ( ) ; <nl> - expect ( errorMsg ) . toMatch ( / v6 . 1 . 0 is no longer supported . / ) ; <nl> + const errorMsg = logger . warn . calls . allArgs ( ) . toString ( ) ; <nl> + expect ( errorMsg ) . toMatch ( / Node . js v6 . 1 . 0 is no longer supported . / ) ; <nl> } ) ; <nl> } ) ; <nl> @ @ - 504 , 8 + 504 , 8 @ @ describe ( ' cordova cli ' , ( ) = > { <nl> cli . __set__ ( ' NODE_VERSION_REQUIREMENT ' , ' > = 8 ' ) ; <nl> return cli ( [ ' node ' , ' cordova ' ] ) . then ( ( ) = > { <nl> - const errorMsg = logger . warn . calls . argsFor ( 1 ) . toString ( ) ; <nl> - expect ( errorMsg ) . toBeFalsy ( ) ; <nl> + const errorMsg = logger . warn . calls . allArgs ( ) . toString ( ) ; <nl> + expect ( errorMsg ) . not . toMatch ( / Node . js v6 . 1 . 0 is no longer supported . / ) ; <nl> } ) ; <nl> } ) ; <nl> @ @ - 515 , 8 + 515 , 8 @ @ describe ( ' cordova cli ' , ( ) = > { <nl> cli . __set__ ( ' NODE_VERSION_REQUIREMENT ' , ' > = 8 ' ) ; <nl> return cli ( [ ' node ' , ' cordova ' ] ) . then ( ( ) = > { <nl> - const errorMsg = logger . warn . calls . argsFor ( 1 ) . toString ( ) ; <nl> - expect ( errorMsg ) . toMatch ( / v8 . 0 . 0 has been deprecated . / ) ; <nl> + const errorMsg = logger . warn . calls . allArgs ( ) . toString ( ) ; <nl> + expect ( errorMsg ) . toMatch ( / Node . js v8 . 0 . 0 has been deprecated . / ) ; <nl> } ) ; <nl> } ) ; <nl> @ @ - 526 , 8 + 526 , 8 @ @ describe ( ' cordova cli ' , ( ) = > { <nl> cli . __set__ ( ' NODE_VERSION_REQUIREMENT ' , ' > = 8 ' ) ; <nl> return cli ( [ ' node ' , ' cordova ' ] ) . then ( ( ) = > { <nl> - const errorMsg = logger . warn . calls . argsFor ( 1 ) . toString ( ) ; <nl> - expect ( errorMsg ) . toBeFalsy ( ) ; <nl> + const errorMsg = logger . warn . calls . allArgs ( ) . toString ( ) ; <nl> + expect ( errorMsg ) . not . toMatch ( / Node . js v8 . 0 . 0 has been deprecated . / ) ; <nl> } ) ; <nl> } ) ; <nl> } ) ; <nl> 
mmm a / test / unit / specs / date - picker . spec . js <nl> ppp b / test / unit / specs / date - picker . spec . js <nl> } ) ; <nl> it ( ' default value ' , done = > { <nl> - const toDateStr = date = > { <nl> - let d = new Date ( date ) ; <nl> - return ` $ { d . getFullYear ( ) } - $ { d . getMonth ( ) } - $ { d . getDate ( ) } ` ; <nl> - } ; <nl> - let today = new Date ( ) ; <nl> - let nextMonth = new Date ( today ) ; <nl> - nextMonth . setDate ( 1 ) ; <nl> - if ( nextMonth . getMonth ( ) = = = 12 ) { <nl> - nextMonth . setFullYear ( today . getFullYear + 1 ) ; <nl> - nextMonth . setMonth ( 1 ) ; <nl> - } else { <nl> - nextMonth . setMonth ( today . getMonth ( ) + 1 ) ; <nl> - } <nl> - let nextMonthStr = toDateStr ( nextMonth ) ; <nl> + let defaultValue = ' 2000 - 01 - 01 ' ; <nl> + let expectValue = new Date ( 2000 , 0 , 1 ) ; <nl> vm = createVue ( { <nl> - template : ` < el - date - picker v - model = " value " ref = " compo " default - value = " $ { nextMonthStr } " / > ` , <nl> + template : ` < el - date - picker v - model = " value " ref = " compo " default - value = " $ { defaultValue } " / > ` , <nl> data ( ) { <nl> return { <nl> value : ' ' <nl> @ @ - 350 , 10 + 338 , 10 @ @ describe ( ' DatePicker ' , ( ) = > { <nl> const $ el = vm . $ refs . compo . picker . $ el ; <nl> $ el . querySelector ( ' td . current ' ) . click ( ) ; <nl> setTimeout ( _ = > { <nl> - expect ( vm . value ) . to . equal ( nextMonthStr ) ; <nl> - } ) ; <nl> + expect ( + vm . value ) . to . equal ( + expectValue ) ; <nl> done ( ) ; <nl> - } ) ; <nl> + } , 10 ) ; <nl> + } , 10 ) ; <nl> } ) ; <nl> describe ( ' keydown ' , ( ) = > { <nl> 
mmm a / test / unit / specs / date - picker . spec . js <nl> ppp b / test / unit / specs / date - picker . spec . js <nl> ref = " compo " <nl> v - model = " value " <nl> type = " date " <nl> - @ change = " handleChange " <nl> value - format = " dd - MM - yyyy " / > ` , <nl> data ( ) { <nl> return { <nl> - value : ' ' , <nl> - handleChange : null <nl> + value : ' ' <nl> } ; <nl> } <nl> } , true ) ; <nl> + <nl> const spy = sinon . spy ( ) ; <nl> - vm . handleChange = spy ; <nl> + vm . $ refs . compo . $ on ( ' change ' , spy ) ; <nl> + <nl> vm . $ refs . compo . $ el . querySelector ( ' input ' ) . focus ( ) ; <nl> setTimeout ( _ = > { <nl> vm . $ refs . compo . picker . $ el . querySelector ( ' . el - date - table td . available ' ) . click ( ) ; <nl> 
mmm a / test / unit / specs / input - number . spec . js <nl> ppp b / test / unit / specs / input - number . spec . js <nl> + const DELAY = 1 ; <nl> + <nl> describe ( ' InputNumber ' , ( ) = > { <nl> let vm ; <nl> afterEach ( ( ) = > { <nl> @ @ - 263 , 30 + 265 , 51 @ @ describe ( ' InputNumber ' , ( ) = > { <nl> } ) ; <nl> } ) ; <nl> } ) ; <nl> - it ( ' event : change ' , done = > { <nl> + describe ( ' event : change ' , ( ) = > { <nl> + let spy ; <nl> + <nl> + beforeEach ( ( ) = > { <nl> vm = createVue ( { <nl> template : ` <nl> - < el - input - number v - model = " value " ref = " input " > <nl> + < el - input - number v - model = " value " ref = " compo " : min = ' 2 ' : max = ' 3 ' : step = ' 1 ' > <nl> < / el - input - number > <nl> ` , <nl> data ( ) { <nl> return { <nl> - value : 1 . 5 <nl> + value : 2 <nl> } ; <nl> } <nl> } , true ) ; <nl> + spy = sinon . spy ( ) ; <nl> + vm . $ refs . compo . $ on ( ' change ' , spy ) ; <nl> + } ) ; <nl> - let btnIncrease = vm . $ el . querySelector ( ' . el - input - number__increase ' ) ; <nl> - const spy = sinon . spy ( ) ; <nl> - <nl> - vm . $ refs . input . $ on ( ' change ' , spy ) ; <nl> + it ( ' emit on input ' , done = > { <nl> + vm . $ refs . compo . handleInput ( ' 3 ' ) ; <nl> + setTimeout ( _ = > { <nl> + expect ( spy . calledOnce ) . to . be . true ; <nl> + expect ( spy . args [ 0 ] [ 0 ] ) . to . equal ( 3 ) ; <nl> + done ( ) ; <nl> + } , DELAY ) ; <nl> + } ) ; <nl> + it ( ' emit on button ' , done = > { <nl> + const btnIncrease = vm . $ el . querySelector ( ' . el - input - number__increase ' ) ; <nl> triggerEvent ( btnIncrease , ' mousedown ' ) ; <nl> triggerClick ( document , ' mouseup ' ) ; <nl> + setTimeout ( _ = > { <nl> + expect ( spy . calledOnce ) . to . be . true ; <nl> + expect ( spy . args [ 0 ] [ 0 ] ) . to . equal ( 3 ) ; <nl> + done ( ) ; <nl> + } , DELAY ) ; <nl> + } ) ; <nl> - vm . $ nextTick ( _ = > { <nl> - expect ( spy . withArgs ( 2 . 5 , 1 . 5 ) . calledOnce ) . to . be . true ; <nl> + it ( ' does not emit on programatic change ' , done = > { <nl> + vm . value = 3 ; <nl> + setTimeout ( _ = > { <nl> + expect ( spy . notCalled ) . to . be . true ; <nl> done ( ) ; <nl> + } , DELAY ) ; <nl> } ) ; <nl> } ) ; <nl> it ( ' event : focus & blur ' , done = > { <nl> 
mmm a / test / unit / specs / date - picker . spec . js <nl> ppp b / test / unit / specs / date - picker . spec . js <nl> const numberOfHighlightRows = ( ) = > pickerEl . querySelectorAll ( ' . el - date - table__row . current ' ) . length ; <nl> expect ( numberOfHighlightRows ( ) ) . to . equal ( 0 ) ; <nl> setTimeout ( ( ) = > { <nl> - pickerEl . querySelector ( ' td . available ' ) . click ( ) ; <nl> + pickerEl . querySelector ( ' . el - date - table__row ~ . el - date - table__row td . available ' ) . click ( ) ; <nl> setTimeout ( ( ) = > { <nl> expect ( vm . value ) . to . exist ; <nl> input . blur ( ) ; <nl> 
mmm a / test / unit / specs / autocomplete . spec . js <nl> ppp b / test / unit / specs / autocomplete . spec . js <nl> done ( ) ; <nl> } ) ; <nl> } ) ; <nl> + it ( ' can highlight first item ' , done = > { <nl> + vm = createVue ( { <nl> + template : ` <nl> + < el - autocomplete <nl> + ref = " autocomplete " <nl> + v - model = " state " <nl> + : fetch - suggestions = " querySearch " <nl> + highlight - first - item <nl> + > < / el - autocomplete > <nl> + ` , <nl> + data ( ) { <nl> + return { <nl> + restaurants : [ ] , <nl> + state : ' ' <nl> + } ; <nl> + } , <nl> + methods : { <nl> + querySearch ( queryString , cb ) { <nl> + const opts = [ <nl> + { ' value ' : ' 1 ' } , <nl> + { ' value ' : ' 11 ' } , <nl> + { ' value ' : ' 2 ' } , <nl> + { ' value ' : ' 22 ' } <nl> + ] ; <nl> + cb ( <nl> + queryString <nl> + ? opts . filter ( opt = > opt . value . indexOf ( queryString ) > = 0 ) <nl> + : opts <nl> + ) ; <nl> + } <nl> + } <nl> + } , true ) ; <nl> + let elm = vm . $ el ; <nl> + let inputElm = elm . querySelector ( ' input ' ) ; <nl> + inputElm . focus ( ) ; <nl> + <nl> + const autocomplete = vm . $ refs . autocomplete ; <nl> + const input = autocomplete . $ refs . input ; <nl> + input . $ emit ( ' input ' , ' 1 ' ) ; <nl> + <nl> + setTimeout ( _ = > { <nl> + const suggestions = vm . $ refs . autocomplete . $ refs . suggestions . $ el ; <nl> + const items = suggestions . querySelectorAll ( ' . el - autocomplete - suggestion__list li ' ) ; <nl> + <nl> + expect ( items . length ) . to . equal ( 2 ) ; <nl> + expect ( items [ 0 ] . classList . contains ( ' highlighted ' ) ) . to . be . true ; <nl> + <nl> + done ( ) ; <nl> + } , 500 ) ; <nl> + } ) ; <nl> } ) ; <nl> 
mmm a / test / unit / tests / directives / repeatClick . test . js <nl> ppp b / test / unit / tests / directives / repeatClick . test . js <nl> - import repeatClick from ' . . / . . / . . / . . / src / directives / new - repeat - click ' <nl> + import repeatClick from ' . . / . . / . . / . . / src / directives / repeatClick ' <nl> describe ( ' directives : repeat - click ' , ( ) = > { <nl> test ( ' should called repeat click callback when emitted mousedown event ' , ( done ) = > { <nl> const handleRepeatClick = jest . fn ( ) <nl> 
mmm a / jest . config . js <nl> ppp b / jest . config . js <nl> testEnvironment : ' jsdom ' , <nl> + roots : [ <nl> + ' < rootDir > / src ' , <nl> + ' < rootDir > / packages ' , <nl> + ' < rootDir > / test ' <nl> + ] , <nl> transform : { <nl> ' ^ . + \ \ . vue $ ' : ' vue - jest ' , <nl> ' ^ . + \ \ js $ ' : ' babel - jest ' <nl> } , <nl> moduleFileExtensions : [ ' vue ' , ' js ' , ' json ' , ' jsx ' , ' ts ' , ' tsx ' , ' node ' ] , <nl> - testMatch : [ ' * * / tests / * * / ? ( * . ) + ( test ) . [ jt ] s ? ( x ) ' ] , <nl> + testMatch : [ ' * * / tests / * * / ? ( * . ) + ( test ) . [ jt ] s ? ( x ) ' , ' * * / __tests__ / * * / * . spec . js ' ] , <nl> moduleNameMapper : { <nl> ' ^ element - ui ( . * ) $ ' : ' < rootDir > $ 1 ' , <nl> ' ^ main ( . * ) $ ' : ' < rootDir > / src $ 1 ' <nl> 
mmm a / test / unit / tests / use / emitter . test . js <nl> ppp b / test / unit / tests / use / emitter . test . js <nl> } ) <nl> } ) <nl> + describe ( ' off ' , ( ) = > { <nl> + it ( ' off all ' , ( ) = > { <nl> + const handleFoo = jest . fn ( ) <nl> + const handleBar = jest . fn ( ) <nl> + <nl> + const Foo = { <nl> + template : ' < div > < / div > ' , <nl> + setup ( props , { emit } ) { <nl> + const { on , off } = useEmitter ( ) <nl> + on ( ' foo ' , handleFoo ) <nl> + on ( ' bar ' , handleBar ) <nl> + <nl> + off ( ) <nl> + emit ( ' foo ' ) <nl> + emit ( ' bar ' ) <nl> + } <nl> + } <nl> + <nl> + mount ( Foo ) <nl> + <nl> + expect ( handleFoo ) . toBeCalledTimes ( 0 ) <nl> + expect ( handleBar ) . toBeCalledTimes ( 0 ) <nl> + } ) <nl> + <nl> + it ( ' off special event ' , ( ) = > { <nl> + const handleFoo1 = jest . fn ( ) <nl> + const handleFoo2 = jest . fn ( ) <nl> + const handleBar = jest . fn ( ) <nl> + <nl> + const Foo = { <nl> + template : ' < div > < / div > ' , <nl> + setup ( props , { emit } ) { <nl> + const { on , off } = useEmitter ( ) <nl> + on ( ' foo ' , handleFoo1 ) <nl> + on ( ' foo ' , handleFoo1 ) <nl> + on ( ' bar ' , handleBar ) <nl> + <nl> + off ( ' foo ' ) <nl> + emit ( ' foo ' ) <nl> + emit ( ' bar ' ) <nl> + } <nl> + } <nl> + <nl> + mount ( Foo ) <nl> + <nl> + expect ( handleFoo1 ) . toBeCalledTimes ( 0 ) <nl> + expect ( handleFoo2 ) . toBeCalledTimes ( 0 ) <nl> + expect ( handleBar ) . toBeCalledTimes ( 1 ) <nl> + } ) <nl> + <nl> + it ( ' off special handler ' , ( ) = > { <nl> + const handleFoo1 = jest . fn ( ) <nl> + const handleFoo2 = jest . fn ( ) <nl> + const handleBar = jest . fn ( ) <nl> + <nl> + const Foo = { <nl> + template : ' < div > < / div > ' , <nl> + setup ( props , { emit } ) { <nl> + const { on , off } = useEmitter ( ) <nl> + on ( ' foo ' , handleFoo1 ) <nl> + on ( ' foo ' , handleFoo2 ) <nl> + on ( ' bar ' , handleBar ) <nl> + <nl> + off ( ' foo ' , handleFoo1 ) <nl> + emit ( ' foo ' ) <nl> + emit ( ' bar ' ) <nl> + } <nl> + } <nl> + <nl> + mount ( Foo ) <nl> + <nl> + expect ( handleFoo1 ) . toBeCalledTimes ( 0 ) <nl> + expect ( handleFoo2 ) . toBeCalledTimes ( 1 ) <nl> + expect ( handleBar ) . toBeCalledTimes ( 1 ) <nl> + } ) <nl> + } ) <nl> + <nl> describe ( ' dispatch ' , ( ) = > { <nl> it ( ' Parent component can capture event when Child component called dispatch ' , ( ) = > { <nl> const Child = { <nl> 
mmm a / packages / image / __tests__ / Image . spec . js <nl> ppp b / packages / image / __tests__ / Image . spec . js <nl> - import { mount as _mount } from ' @ vue / test - utils ' <nl> + import { mount as $ mount } from ' @ vue / test - utils ' <nl> - const mount = async ( Component , options ) = > { <nl> - const wrapper = _mount ( Component , options ) <nl> + const mount = async ( Component , options , onInit ) = > { <nl> + const wrapper = $ mount ( Component , options ) <nl> wrapper . componentVM . $ isServer = false <nl> + if ( onInit ) { <nl> + onInit ( wrapper ) <nl> + } else { <nl> wrapper . componentVM . loading = false <nl> + } <nl> return new Promise ( ( resolve ) = > { <nl> setTimeout ( ( ) = > { <nl> resolve ( wrapper ) <nl> @ @ - 80 , 14 + 84 , 39 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> } ) <nl> describe ( ' Slots ' , ( ) = > { <nl> - / / Slots <nl> - <nl> it ( ' placeholder ' , async ( ) = > { <nl> - / / TODO <nl> + await mount ( <nl> + Image , <nl> + { <nl> + slots : { <nl> + placeholder : ( ) = > { <nl> + return ' loading . . . ' <nl> + } <nl> + } <nl> + } , <nl> + ( wrapper ) = > { <nl> + expect ( wrapper . find ( ' . el - image ' ) . text ( ) ) . toBe ( ' loading . . . ' ) <nl> + } <nl> + ) <nl> } ) <nl> it ( ' error ' , async ( ) = > { <nl> - / / TODO <nl> + const wrapper = await mount ( <nl> + Image , <nl> + { <nl> + src : ' test . jpg ' , <nl> + slots : { <nl> + error : ( ) = > { <nl> + return ' bad image ' <nl> + } <nl> + } <nl> + } , <nl> + ( wrapper ) = > { <nl> + wrapper . componentVM . loading = false <nl> + wrapper . componentVM . error = true <nl> + } <nl> + ) <nl> + expect ( wrapper . find ( ' . el - image ' ) . text ( ) ) . toBe ( ' bad image ' ) <nl> } ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / message / Message . vue <nl> ppp b / packages / message / Message . vue <nl> ? ` el - message__icon el - icon - $ { typeMap [ props . type ] } ` <nl> : ' ' <nl> } ) <nl> + <nl> const positionStyle = computed ( ( ) = > ( { top : ` $ { props . verticalOffset } px ` } ) ) <nl> const close = ( ) = > { <nl> @ @ - 136 , 8 + 137 , 10 @ @ export default { <nl> } <nl> const handleAfterLeave = ( currentElement ) = > { <nl> + if ( currentElement & & currentElement . parentNode ) { <nl> currentElement . parentNode . removeChild ( currentElement ) <nl> } <nl> + } <nl> watch ( <nl> ( ) = > state . closed , <nl> 
mmm a / packages / image / __tests__ / ImageViewer . spec . js <nl> ppp b / packages / image / __tests__ / ImageViewer . spec . js <nl> import { mount } from ' @ vue / test - utils ' <nl> + import ImageViewer from ' . . / ImageViewer . vue ' <nl> + import { IMAGE_FAIL , IMAGE_SUCCESS } from ' . / image ' <nl> describe ( ' ImageViewer . vue ' , ( ) = > { <nl> describe ( ' single ' , ( ) = > { <nl> it ( ' urlList ' , ( ) = > { <nl> const wrapper = mount ( ImageViewer , { <nl> props : { <nl> - urlList : [ ' test . jpg ' ] <nl> + urlList : [ IMAGE_SUCCESS ] <nl> } <nl> } ) <nl> expect ( wrapper . find ( ' . el - image - viewer__img ' ) . attributes ( ' src ' ) ) . toBe ( <nl> - ' test . jpg ' <nl> + IMAGE_SUCCESS <nl> ) <nl> } ) <nl> } ) <nl> @ @ - 17 , 48 + 18 , 47 @ @ describe ( ' ImageViewer . vue ' , ( ) = > { <nl> describe ( ' list ' , ( ) = > { <nl> const wrapper = mount ( ImageViewer , { <nl> props : { <nl> - urlList : [ ' test . jpg ' , ' test2 . jpg ' ] <nl> + urlList : [ IMAGE_SUCCESS , IMAGE_FAIL ] <nl> } <nl> } ) <nl> - const { componentVM } = wrapper <nl> it ( ' init ' , ( ) = > { <nl> expect ( wrapper . find ( ' . el - image - viewer__img ' ) . attributes ( ' src ' ) ) . toBe ( <nl> - ' test . jpg ' <nl> + IMAGE_SUCCESS <nl> ) <nl> - componentVM . next ( ) <nl> - } , 0 . 01 ) <nl> + } ) <nl> - it ( ' next ' , ( ) = > { <nl> + it ( ' next ' , async ( ) = > { <nl> + await wrapper . find ( ' . el - image - viewer__next ' ) . trigger ( ' click ' ) <nl> expect ( wrapper . find ( ' . el - image - viewer__img ' ) . attributes ( ' src ' ) ) . toBe ( <nl> - ' test2 . jpg ' <nl> + IMAGE_FAIL <nl> ) <nl> - componentVM . prev ( ) <nl> - } , 0 . 02 ) <nl> + } ) <nl> - it ( ' prev ' , ( ) = > { <nl> + it ( ' prev ' , async ( ) = > { <nl> + await wrapper . find ( ' . el - image - viewer__prev ' ) . trigger ( ' click ' ) <nl> expect ( wrapper . find ( ' . el - image - viewer__img ' ) . attributes ( ' src ' ) ) . toBe ( <nl> - ' test . jpg ' <nl> + IMAGE_SUCCESS <nl> ) <nl> - } , 0 . 03 ) <nl> + } ) <nl> } ) <nl> it ( ' initialIndex ' , ( ) = > { <nl> const wrapper = mount ( ImageViewer , { <nl> props : { <nl> - urlList : [ ' test . jpg ' , ' test2 . jpg ' ] , <nl> + urlList : [ IMAGE_SUCCESS , IMAGE_FAIL ] , <nl> initialIndex : 1 <nl> } <nl> } ) <nl> expect ( wrapper . find ( ' . el - image - viewer__img ' ) . attributes ( ' src ' ) ) . toBe ( <nl> - ' test2 . jpg ' <nl> + IMAGE_FAIL <nl> ) <nl> } ) <nl> it ( ' zIndex ' , ( ) = > { <nl> const wrapper = mount ( ImageViewer , { <nl> props : { <nl> - urlList : [ ' test . jpg ' ] , <nl> + urlList : [ IMAGE_SUCCESS ] , <nl> zIndex : 2020 <nl> } <nl> } ) <nl> @ @ - 67 , 27 + 67 , 31 @ @ describe ( ' ImageViewer . vue ' , ( ) = > { <nl> ) . toContain ( ' z - index : 2020 ' ) <nl> } ) <nl> - it ( ' onSwitch ' , ( ) = > { <nl> + it ( ' onSwitch ' , async ( ) = > { <nl> + let caller = false <nl> const wrapper = mount ( ImageViewer , { <nl> props : { <nl> - urlList : [ ' test . jpg ' , ' test2 . jpg ' ] , <nl> + urlList : [ IMAGE_SUCCESS , IMAGE_FAIL ] , <nl> onSwitch ( newIndex ) { <nl> - expect ( ` switch to $ { newIndex } ` ) . toBe ( ' switch to 1 ' ) <nl> + caller = true <nl> } <nl> } <nl> } ) <nl> - wrapper . componentVM . next ( ) <nl> + await wrapper . componentVM . next ( ) <nl> + expect ( caller ) . toBe ( true ) <nl> } ) <nl> - it ( ' onClose ' , ( ) = > { <nl> + it ( ' onClose ' , async ( ) = > { <nl> + let caller = false <nl> const wrapper = mount ( ImageViewer , { <nl> props : { <nl> - urlList : [ ' test . jpg ' , ' test2 . jpg ' ] , <nl> + urlList : [ IMAGE_SUCCESS , IMAGE_SUCCESS ] , <nl> onClose ( ) { <nl> - expect ( ' onClose ' ) . toBe ( ' onClose ' ) <nl> + caller = true <nl> } <nl> } <nl> } ) <nl> - wrapper . componentVM . hide ( ) <nl> + await wrapper . componentVM . hide ( ) <nl> + expect ( caller ) . toBe ( true ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / image / __tests__ / Image . spec . js <nl> ppp b / packages / image / __tests__ / Image . spec . js <nl> + import { mount as $ mount } from ' @ vue / test - utils ' <nl> import Image from ' . . / Image . vue ' <nl> - import { IMAGE_FAIL , IMAGE_SUCCESS as src } from ' . / image ' <nl> + import { IMAGE_SUCCESS as src } from ' . / image ' <nl> - Image . $ isServer = false <nl> + const mount = async ( Component , _options ) = > { <nl> + const options = _options | | { } <nl> + options . data = <nl> + options . data | | <nl> + function ( ) { <nl> + return { <nl> + loading : false <nl> + } <nl> + } <nl> + const wrapper = await $ mount ( Component , options ) <nl> + return wrapper <nl> + } <nl> describe ( ' Image . vue ' , ( ) = > { <nl> describe ( ' Attributes ' , ( ) = > { <nl> @ @ - 12 , 37 + 23 , 31 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> src <nl> } <nl> } ) <nl> - setTimeout ( ( ) = > { <nl> expect ( wrapper . find ( ' . el - image__inner ' ) . attributes ( ' src ' ) ) . toBe ( src ) <nl> - } , 100 ) <nl> } ) <nl> it ( ' fit ' , async ( ) = > { <nl> const wrapper = await mount ( Image , { <nl> props : { <nl> src , <nl> - fit : ' fill ' , <nl> - load ( ) { <nl> - expect ( <nl> - wrapper . find ( ' . el - image__inner ' ) . attributes ( ' style ' ) <nl> - ) . toContain ( ' object - fit : fill ; ' ) <nl> - } <nl> + fit : ' fill ' <nl> } <nl> } ) <nl> + expect ( wrapper . find ( ' . el - image__inner ' ) . attributes ( ' style ' ) ) . toContain ( <nl> + ' object - fit : fill ; ' <nl> + ) <nl> } ) <nl> it ( ' alt ' , async ( ) = > { <nl> const wrapper = await mount ( Image , { <nl> props : { <nl> src , <nl> - alt : ' hello world ! ' , <nl> - load ( ) { <nl> - expect ( wrapper . find ( ' . el - image__inner ' ) . attributes ( ' alt ' ) ) . toBe ( <nl> - ' hello world ! 2 ' <nl> - ) <nl> - } <nl> + alt : ' hello world ! ' <nl> } <nl> } ) <nl> + expect ( wrapper . find ( ' . el - image__inner ' ) . attributes ( ' alt ' ) ) . toBe ( <nl> + ' hello world ! ' <nl> + ) <nl> } ) <nl> it ( ' referrer - policy ' , async ( ) = > { <nl> @ @ - 67 , 35 + 72 , 16 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> } ) <nl> describe ( ' Events ' , ( ) = > { <nl> it ( ' load ' , async ( ) = > { <nl> - const wrapper = await mount ( Image , { <nl> - props : { <nl> - src , <nl> - load ( ) { <nl> - expect ( wrapper . find ( ' . el - image__inner ' ) . attributes ( ' src ' ) ) . toBe ( <nl> - ' test . jpg ' <nl> - ) <nl> - } <nl> - } <nl> - } ) <nl> + / / TODO <nl> } ) <nl> it ( ' error ' , async ( ) = > { <nl> - const wrapper = await mount ( Image , { <nl> - src : IMAGE_FAIL , <nl> - slots : { <nl> - error : ( ) = > { <nl> - return ' bad image ' <nl> - } <nl> - } , <nl> - error ( ) { <nl> - expect ( wrapper . find ( ' . el - image ' ) . text ( ) ) . toBe ( ' bad image ' ) <nl> - } <nl> - } ) <nl> + / / TODO <nl> } ) <nl> } ) <nl> describe ( ' Slots ' , ( ) = > { <nl> it ( ' placeholder ' , async ( ) = > { <nl> - const wrapper = await mount ( Image , { <nl> + const wrapper = await $ mount ( Image , { <nl> src , <nl> slots : { <nl> placeholder : ( ) = > { <nl> @ @ - 107 , 17 + 93 , 7 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> } ) <nl> it ( ' error ' , async ( ) = > { <nl> - const wrapper = await mount ( Image , { <nl> - src : IMAGE_FAIL , <nl> - slots : { <nl> - error : ( ) = > { <nl> - return ' bad image ' <nl> - } <nl> - } , <nl> - load ( ) { <nl> - expect ( wrapper . find ( ' . el - image ' ) . text ( ) ) . toBe ( ' bad image ' ) <nl> - } <nl> - } ) <nl> + / / TODO <nl> } ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / image / __tests__ / Image . spec . js <nl> ppp b / packages / image / __tests__ / Image . spec . js <nl> import Image from ' . . / Image . vue ' <nl> - import { IMAGE_SUCCESS as src } from ' . / image ' <nl> + import { IMAGE_FAIL , IMAGE_SUCCESS as src } from ' . / image ' <nl> const mount = async ( Component , _options ) = > { <nl> const options = _options | | { } <nl> @ @ - 12 , 7 + 12 , 11 @ @ const mount = async ( Component , _options ) = > { <nl> } <nl> } <nl> const wrapper = await $ mount ( Component , options ) <nl> - return wrapper <nl> + return new Promise ( ( resolve ) = > { <nl> + setTimeout ( ( ) = > { <nl> + resolve ( wrapper ) <nl> + } , 1 ) <nl> + } ) <nl> } <nl> describe ( ' Image . vue ' , ( ) = > { <nl> @ @ - 63 , 11 + 67 , 28 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> } ) <nl> it ( ' preview - src - list ' , async ( ) = > { <nl> - / / TODO <nl> + const wrapper = await mount ( Image , { <nl> + props : { <nl> + src : IMAGE_FAIL , <nl> + previewSrcList : [ src , IMAGE_FAIL ] <nl> + } <nl> + } ) <nl> + <nl> + await wrapper . trigger ( ' click ' ) <nl> + <nl> + console . log ( ' TODO previewSrcList ' ) <nl> } ) <nl> it ( ' z - index ' , async ( ) = > { <nl> - / / TODO <nl> + const wrapper = await mount ( Image , { <nl> + props : { <nl> + src , <nl> + previewSrcList : [ src , IMAGE_FAIL ] , <nl> + zIndex : 2020 <nl> + } <nl> + } ) <nl> + await wrapper . find ( ' . el - image__inner ' ) . trigger ( ' click ' ) <nl> + console . log ( ' TODO zIndex ' ) <nl> } ) <nl> } ) <nl> describe ( ' Events ' , ( ) = > { <nl> @ @ - 93 , 7 + 114 , 21 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> } ) <nl> it ( ' error ' , async ( ) = > { <nl> - / / TODO <nl> + const wrapper = await $ mount ( Image , { <nl> + src , <nl> + slots : { <nl> + error : ( ) = > { <nl> + return ' error ! ' <nl> + } <nl> + } , <nl> + data ( ) { <nl> + return { <nl> + loading : false , <nl> + error : true <nl> + } <nl> + } <nl> + } ) <nl> + expect ( wrapper . find ( ' . el - image ' ) . text ( ) ) . toBe ( ' error ! ' ) <nl> } ) <nl> } ) <nl> } ) <nl> 
mmm a / packages / image / __tests__ / Image . spec . js <nl> ppp b / packages / image / __tests__ / Image . spec . js <nl> } ) <nl> it ( ' preview - src - list ' , async ( ) = > { <nl> - const wrapper = await mount ( Image , { <nl> - props : { <nl> - src : IMAGE_FAIL , <nl> - previewSrcList : [ src , IMAGE_FAIL ] <nl> - } <nl> - } ) <nl> - <nl> - await wrapper . trigger ( ' click ' ) <nl> - <nl> - console . log ( ' TODO previewSrcList ' ) <nl> + / / TODO <nl> } ) <nl> it ( ' z - index ' , async ( ) = > { <nl> - const wrapper = await mount ( Image , { <nl> - props : { <nl> - src , <nl> - previewSrcList : [ src , IMAGE_FAIL ] , <nl> - zIndex : 2020 <nl> - } <nl> - } ) <nl> - await wrapper . find ( ' . el - image__inner ' ) . trigger ( ' click ' ) <nl> - console . log ( ' TODO zIndex ' ) <nl> + / / TODO <nl> } ) <nl> } ) <nl> describe ( ' Events ' , ( ) = > { <nl> @ @ - 115 , 7 + 98 , 7 @ @ describe ( ' Image . vue ' , ( ) = > { <nl> it ( ' error ' , async ( ) = > { <nl> const wrapper = await $ mount ( Image , { <nl> - src , <nl> + src : IMAGE_FAIL , <nl> slots : { <nl> error : ( ) = > { <nl> return ' error ! ' <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " url - loader " : " ^ 1 . 0 . 1 " , <nl> " vue " : " ^ 3 . 0 . 0 - rc . 4 " , <nl> - " vue - jest " : " github : vuejs / vue - jest # next " , <nl> + " vue - jest " : " vuejs / vue - jest # next " , <nl> " vue - loader " : " ^ 16 . 0 . 0 - beta . 4 " , <nl> " vue - router " : " ^ 4 . 0 . 0 - beta . 3 " , <nl> " webpack " : " ^ 4 . 14 . 0 " , <nl> 
mmm a / packages / dialog / __tests__ / Dialog . spec . js <nl> ppp b / packages / dialog / __tests__ / Dialog . spec . js <nl> it ( ' showClose ' , ( ) = > { <nl> const wrapperTrue = mount ( Dialog , { <nl> props : { <nl> - default : true <nl> + showClose : false <nl> } <nl> } ) <nl> - expect ( wrapperTrue . find ( ' . el - dialog__headerbtn ' ) . exists ( ) ) . toBe ( true ) <nl> + expect ( wrapperTrue . find ( ' . el - dialog__headerbtn ' ) . exists ( ) ) . toBe ( false ) <nl> } ) <nl> test ( ' Dialog render ' , async ( ) = > { <nl> 
mmm a / app / components / search - input . js <nl> ppp b / app / components / search - input . js <nl> ' hierarchy . lvl1 ' , <nl> ' hierarchy . lvl2 ' <nl> ] , <nl> - tagFilters : [ ` version : $ { projectVersion } ` ] <nl> + tagFilters : [ ` version : $ { projectVersion } ` ] , <nl> + facetFilters : [ ' access : public ' ] <nl> } ; <nl> const searchObj = { <nl> 
mmm a / web / index . html <nl> ppp b / web / index . html <nl> font - style : normal ; <nl> font - weight : 100 ; <nl> - src : local ( ' Roboto Thin ' ) , local ( ' Roboto - Thin ' ) , url ( http : / / themes . googleusercontent . com / static / fonts / roboto / v9 / vzIUHo9z - oJ4WgkpPOtg13YhjbSpvc47ee6xR_80Hnw . woff ) format ( ' woff ' ) ; <nl> + src : local ( ' Roboto Thin ' ) , local ( ' Roboto - Thin ' ) , url ( https : / / themes . googleusercontent . com / static / fonts / roboto / v9 / vzIUHo9z - oJ4WgkpPOtg13YhjbSpvc47ee6xR_80Hnw . woff ) format ( ' woff ' ) ; <nl> } <nl> @ font - face { <nl> font - family : ' Roboto ' ; <nl> font - style : normal ; <nl> font - weight : 300 ; <nl> - src : local ( ' Roboto Light ' ) , local ( ' Roboto - Light ' ) , url ( http : / / themes . googleusercontent . com / static / fonts / roboto / v9 / Hgo13k - tfSpn0qi1SFdUfbO3LdcAZYWl9Si6vvxL - qU . woff ) format ( ' woff ' ) ; <nl> + src : local ( ' Roboto Light ' ) , local ( ' Roboto - Light ' ) , url ( https : / / themes . googleusercontent . com / static / fonts / roboto / v9 / Hgo13k - tfSpn0qi1SFdUfbO3LdcAZYWl9Si6vvxL - qU . woff ) format ( ' woff ' ) ; <nl> } <nl> @ font - face { <nl> font - family : ' Roboto ' ; <nl> font - style : normal ; <nl> font - weight : 500 ; <nl> - src : local ( ' Roboto Medium ' ) , local ( ' Roboto - Medium ' ) , url ( http : / / themes . googleusercontent . com / static / fonts / roboto / v9 / RxZJdnzeo3R5zSexge8UUbO3LdcAZYWl9Si6vvxL - qU . woff ) format ( ' woff ' ) ; <nl> + src : local ( ' Roboto Medium ' ) , local ( ' Roboto - Medium ' ) , url ( https : / / themes . googleusercontent . com / static / fonts / roboto / v9 / RxZJdnzeo3R5zSexge8UUbO3LdcAZYWl9Si6vvxL - qU . woff ) format ( ' woff ' ) ; <nl> } <nl> body , html { <nl> @ @ - 142 , 7 + 142 , 7 @ @ footer a { <nl> < / head > <nl> < body > <nl> < header > <nl> - < svg version = " 1 . 1 " id = " template " xmlns = " http : / / www . w3 . org / 2000 / svg " xmlns : xlink = " http : / / www . w3 . org / 1999 / xlink " x = " 0px " y = " 0px " width = " 160 " height = " 180 " <nl> + < svg version = " 1 . 1 " id = " template " xmlns = " https : / / www . w3 . org / 2000 / svg " xmlns : xlink = " https : / / www . w3 . org / 1999 / xlink " x = " 0px " y = " 0px " width = " 160 " height = " 180 " <nl> viewBox = " 0 0 160 185 " xml : space = " preserve " > <nl> < path d = " M158 . 156 , 60 . 461l - 5 . 326 - 3 . 066 <nl> c8 . 189 - 12 . 08 , 13 . 084 - 30 . 242 , 6 . 947 - 57 . 395c0 , 0 - 13 . 82 , 38 . 733 - 41 . 602 , 37 . 449L85 . 645 , 18 . 73c - 1 . 227 - 0 . 728 - 2 . 602 - 1 . 103 - 3 . 992 - 1 . 159 <nl> @ @ - 160 , 7 + 160 , 7 @ @ footer a { <nl> < p > Nodemon is a utility that will monitor for any changes in your source and automatically restart your server . Perfect for development . Install it using < a href = " https : / / npmjs . org / package / nodemon " > npm < / a > . < / p > <nl> - < p > Just use < code > nodemon < / code > instead of < code > node < / code > to run your code , and now your process will automatically restart when your code changes . To install , get < a href = " http : / / nodejs . org " target = " _blank " > node . js < / a > , then from your terminal run : < / p > <nl> + < p > Just use < code > nodemon < / code > instead of < code > node < / code > to run your code , and now your process will automatically restart when your code changes . To install , get < a href = " https : / / nodejs . org " target = " _blank " > node . js < / a > , then from your terminal run : < / p > <nl> < pre > < code > npm install - g nodemon < / code > < / pre > <nl> @ @ - 175 , 10 + 175 , 10 @ @ footer a { <nl> < li > Watch specific directories . < / li > <nl> < li > Works with server applications or one time run utilities and REPLs . < / li > <nl> < li > Requirable in node apps . < / li > <nl> - < li > Open source and available on < a href = " http : / / github . com / remy / nodemon / " > github < / a > . < / li > <nl> + < li > Open source and available on < a href = " https : / / github . com / remy / nodemon / " > github < / a > . < / li > <nl> < / ul > <nl> - < p > Read the full < a href = " http : / / github . com / remy / nodemon # nodemon " > documentation < / a > . < / p > <nl> + < p > Read the full < a href = " https : / / github . com / remy / nodemon # nodemon " > documentation < / a > . < / p > <nl> < footer > <nl> < p > < a href = " https : / / github . com / remy / nodemon / issues " > issues < / a > & bull ; < a href = " https : / / github . com / remy / nodemon / " > source code < / a > & bull ; < a href = " https : / / twitter . com / rem " > built by @ rem < / a > < / p > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> } ) ; <nl> ` ` ` <nl> - # # Using io . js for nodemon <nl> - <nl> - If you * only * have io . js installed ( and the default install creates a symlink from ` node ` to ` iojs ` ) , then nodemon will work just fine out of the box ( or [ should ] ( https : / / github . com / remy / nodemon / issues / 468 ) ) . <nl> - <nl> - If you ' ve got * both * node and io . js installed , then it ' s easy ! You can either edit the local ` nodemon . json ` file ( in your working directory ) or in your ` $ HOME ` directory containing : <nl> - <nl> - ` ` ` json <nl> - { <nl> - " execMap " : { <nl> - " js " : " iojs " <nl> - } <nl> - } <nl> - ` ` ` <nl> - <nl> - Now you nodemon will use [ io . js ] ( https : / / iojs . org / ) with JavaScript files instead of node . <nl> - <nl> # # Using nodemon in your gulp workflow <nl> Check out the [ gulp - nodemon ] ( https : / / github . com / JacksonGariety / gulp - nodemon ) plugin to integrate nodemon with the rest of your project ' s gulp workflow . <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> notifications : <nl> email : false <nl> node_js : <nl> + - 8 <nl> + - 7 <nl> - 6 <nl> - - 5 <nl> - 4 <nl> - # - iojs - v3 <nl> - # - iojs - v2 <nl> - # - iojs - v1 <nl> - - ' 0 . 10 ' <nl> before_install : <nl> - npm i - g npm @ ^ 2 . 0 . 0 <nl> before_script : <nl> 
mmm a / lib / utils / index . js <nl> ppp b / lib / utils / index . js <nl> var path = require ( ' path ' ) ; <nl> var version = process . versions . node . split ( ' . ' ) | | [ null , null , null ] ; <nl> - var utils = module . exports = { <nl> + var utils = ( module . exports = { <nl> version : { <nl> major : parseInt ( version [ 0 ] | | 0 , 10 ) , <nl> minor : parseInt ( version [ 1 ] | | 0 , 10 ) , <nl> @ @ - 51 , 7 + 51 , 8 @ @ var utils = module . exports = { <nl> this . debug = false ; <nl> } , <nl> regexpToText : function ( t ) { <nl> - return t . replace ( / \ . \ * \ \ . / g , ' * . ' ) <nl> + return t <nl> + . replace ( / \ . \ * \ \ . / g , ' * . ' ) <nl> . replace ( / \ \ { 2 } / g , ' ^ ^ ' ) <nl> . replace ( / \ \ / g , ' ' ) <nl> . replace ( / \ ^ \ ^ / g , ' \ \ ' ) ; <nl> @ @ - 60 , 18 + 61 , 23 @ @ var utils = module . exports = { <nl> / / serializes an executable string and array of arguments into a string <nl> args = args | | [ ] ; <nl> - return [ exec ] . concat ( args . map ( function ( arg ) { <nl> - / / if an argument contains a space , we want to show it with quotes around <nl> - / / it to indicate that it is a single argument <nl> + return [ exec ] <nl> + . concat ( <nl> + args . map ( function ( arg ) { <nl> + / / if an argument contains a space , we want to show it with quotes <nl> + / / around it to indicate that it is a single argument <nl> if ( arg . indexOf ( ' ' ) = = = - 1 ) { <nl> return arg ; <nl> } else { <nl> / / this should correctly escape nested quotes <nl> return JSON . stringify ( arg ) ; <nl> } <nl> - } ) ) . join ( ' ' ) . trim ( ) ; <nl> + } ) <nl> + ) <nl> + . join ( ' ' ) <nl> + . trim ( ) ; <nl> } , <nl> - } ; <nl> + } ) ; <nl> utils . log = require ( ' . / log ' ) ( utils . isRequired ) ; <nl> 
mmm a / lib / monitor / signals . js <nl> ppp b / lib / monitor / signals . js <nl> - " SIGHUP " : " 1 " , <nl> - " SIGINT " : " 2 " , <nl> - " SIGQUIT " : " 3 " , <nl> - " SIGILL " : " 4 " , <nl> - " SIGTRAP " : " 5 " , <nl> - " SIGABRT " : " 6 " , <nl> - " SIGBUS " : " 7 " , <nl> - " SIGFPE " : " 8 " , <nl> - " SIGKILL " : " 9 " , <nl> - " SIGUSR1 " : " 10 " , <nl> - " SIGSEGV " : " 11 " , <nl> - " SIGUSR2 " : " 12 " , <nl> - " SIGPIPE " : " 13 " , <nl> - " SIGALRM " : " 14 " , <nl> - " SIGTERM " : " 15 " , <nl> - " SIGSTKFLT " : " 16 " , <nl> - " SIGCHLD " : " 17 " , <nl> - " SIGCONT " : " 18 " , <nl> - " SIGSTOP " : " 19 " , <nl> - " SIGTSTP " : " 20 " , <nl> - " SIGTTIN " : " 21 " , <nl> - " SIGTTOU " : " 22 " , <nl> - " SIGURG " : " 23 " , <nl> - " SIGXCPU " : " 24 " , <nl> - " SIGXFSZ " : " 25 " , <nl> - " SIGVTALRM " : " 26 " , <nl> - " SIGPROF " : " 27 " , <nl> - " SIGWINCH " : " 28 " , <nl> - " SIGIO " : " 29 " , <nl> - " SIGPWR " : " 30 " , <nl> - " SIGSYS " : " 31 " , <nl> - " SIGRTMIN " : " 35 " <nl> + SIGHUP : 1 , <nl> + SIGINT : 2 , <nl> + SIGQUIT : 3 , <nl> + SIGILL : 4 , <nl> + SIGTRAP : 5 , <nl> + SIGABRT : 6 , <nl> + SIGBUS : 7 , <nl> + SIGFPE : 8 , <nl> + SIGKILL : 9 , <nl> + SIGUSR1 : 10 , <nl> + SIGSEGV : 11 , <nl> + SIGUSR2 : 12 , <nl> + SIGPIPE : 13 , <nl> + SIGALRM : 14 , <nl> + SIGTERM : 15 , <nl> + SIGSTKFLT : 16 , <nl> + SIGCHLD : 17 , <nl> + SIGCONT : 18 , <nl> + SIGSTOP : 19 , <nl> + SIGTSTP : 20 , <nl> + SIGTTIN : 21 , <nl> + SIGTTOU : 22 , <nl> + SIGURG : 23 , <nl> + SIGXCPU : 24 , <nl> + SIGXFSZ : 25 , <nl> + SIGVTALRM : 26 , <nl> + SIGPROF : 27 , <nl> + SIGWINCH : 28 , <nl> + SIGIO : 29 , <nl> + SIGPWR : 30 , <nl> + SIGSYS : 31 , <nl> + SIGRTMIN : 35 , <nl> } <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - ' 6 ' <nl> - ' 4 ' <nl> before_install : <nl> - - if [ " $ TRAVIS_PULL_REQUEST_BRANCH " = = " " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > . npmrc ; fi <nl> + - if [ " $ TRAVIS_PULL_REQUEST_BRANCH " = = " " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > > . npmrc ; fi <nl> after_success : <nl> - npm run semantic - release <nl> branches : <nl> 
mmm a / lib / monitor / match . js <nl> ppp b / lib / monitor / match . js <nl> rule . slice ( - 1 ) = = = ' * ' & & <nl> rule . indexOf ( ' * . ' ) = = = - 1 ) { <nl> - if ( rule . slice ( - 2 ) ! = = ' * * ' ) rule + = ' * / * ' ; <nl> + if ( rule . slice ( - 2 ) ! = = ' * * ' ) { <nl> + rule + = ' * / * ' ; <nl> + } <nl> } <nl> 
mmm a / . github / oliver . yml <nl> ppp b / . github / oliver . yml <nl> # If the issue was closed in more days than this , the bot won ' t reply . <nl> # Use ` daysClosedIn : false ` to * always * reply . <nl> - daysClosedIn : 5 <nl> + daysClosedIn : false <nl> # Labels to look for on issues the bot can reply to <nl> labels : <nl> 
mmm a / . github / oliver . yml <nl> ppp b / . github / oliver . yml <nl> # If the issue was closed in more days than this , the bot won ' t reply . <nl> # Use ` daysClosedIn : false ` to * always * reply . <nl> - daysClosedIn : false <nl> + daysClosedIn : 100 <nl> # Labels to look for on issues the bot can reply to <nl> labels : <nl> 
mmm a / . github / stale . yml <nl> ppp b / . github / stale . yml <nl> - daysUntilStale : 60 <nl> + daysUntilStale : 14 <nl> # Number of days of inactivity before a stale issue is closed <nl> daysUntilClose : 7 <nl> # Issues with these labels will never be considered stale <nl> 
mmm a / . github / stale . yml <nl> ppp b / . github / stale . yml <nl> - pinned <nl> - security <nl> # Label to use when marking an issue as stale <nl> - staleLabel : wontfix <nl> + staleLabel : stale <nl> # Comment to post when marking an issue as stale . Set to ` false ` to disable <nl> markComment : > <nl> This issue has been automatically marked as idle and stale because it hasn ' t <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " ignore - by - default " : " ^ 1 . 0 . 1 " , <nl> " minimatch " : " ^ 3 . 0 . 4 " , <nl> - " pstree . remy " : " ^ 1 . 1 . 1 " , <nl> + " pstree . remy " : " ^ 1 . 1 . 2 " , <nl> " semver " : " ^ 5 . 5 . 0 " , <nl> " supports - color " : " ^ 5 . 2 . 0 " , <nl> " touch " : " ^ 3 . 1 . 0 " , <nl> 
mmm a / . github / stale . yml <nl> ppp b / . github / stale . yml <nl> exemptLabels : <nl> - pinned <nl> - security <nl> + - not - stale <nl> # Label to use when marking an issue as stale <nl> staleLabel : stale <nl> # Comment to post when marking an issue as stale . Set to ` false ` to disable <nl> 
mmm a / . github / FUNDING . yml <nl> ppp b / . github / FUNDING . yml <nl> + github : remy # Replace with up to 4 GitHub Sponsors - enabled usernames e . g . , [ user1 , user2 ] <nl> open_collective : nodemon <nl> 
mmm a / lib / monitor / run . js <nl> ppp b / lib / monitor / run . js <nl> if ( shouldFork ) { <nl> var forkArgs = cmd . args . slice ( 1 ) ; <nl> var env = utils . merge ( options . execOptions . env , process . env ) ; <nl> - stdio . pop ( ) ; <nl> - stdio . push ( process . stderr ) ; <nl> stdio . push ( ' ipc ' ) ; <nl> child = fork ( options . execOptions . script , forkArgs , { <nl> env : env , <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> notifications : <nl> email : false <nl> node_js : <nl> + - ' 14 ' <nl> - ' 12 ' <nl> - - ' 11 ' <nl> - ' 10 ' <nl> - - ' 8 ' <nl> before_install : <nl> - if [ " $ TRAVIS_PULL_REQUEST_BRANCH " = = " " ] ; then echo " / / registry . npmjs . org / : _authToken = \ $ { NPM_TOKEN } " > > . npmrc ; fi <nl> after_success : <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " clean " : " rm - rf test / fixtures / test * . js test / fixtures / test * . md " , <nl> " web " : " node web " , <nl> - " semantic - release " : " semantic - release pre & & npm publish & & semantic - release post " , <nl> + " semantic - release " : " semantic - release " , <nl> " prepush " : " npm run lint " , <nl> " killall " : " ps auxww | grep node | grep - v grep | awk ' { print $ 2 } ' | xargs kill - 9 " , <nl> " postinstall " : " node bin / postinstall | | exit 0 " <nl> " istanbul " : " ^ 0 . 4 . 5 " , <nl> " mocha " : " ^ 2 . 5 . 3 " , <nl> " proxyquire " : " ^ 1 . 8 . 0 " , <nl> - " semantic - release " : " ^ 8 . 2 . 3 " , <nl> + " semantic - release " : " ^ 17 . 4 . 4 " , <nl> " should " : " ~ 4 . 0 . 0 " <nl> } , <nl> " dependencies " : { <nl> 
mmm a / . github / stale . yml <nl> ppp b / . github / stale . yml <nl> - daysUntilStale : 14 <nl> - # Number of days of inactivity before a stale issue is closed <nl> - daysUntilClose : 7 <nl> - # Issues with these labels will never be considered stale <nl> - exemptLabels : <nl> - - pinned <nl> - - security <nl> - - not - stale <nl> - # Label to use when marking an issue as stale <nl> - staleLabel : stale <nl> - # Comment to post when marking an issue as stale . Set to ` false ` to disable <nl> - markComment : > <nl> + name : Mark stale issues and pull requests <nl> + <nl> + on : <nl> + schedule : <nl> + - cron : " 0 * * * * " <nl> + <nl> + jobs : <nl> + stale : <nl> + <nl> + runs - on : ubuntu - latest <nl> + permissions : <nl> + issues : write <nl> + pull - requests : write <nl> + <nl> + steps : <nl> + - uses : actions / stale @ v3 <nl> + with : <nl> + repo - token : $ { { secrets . GITHUB_TOKEN } } <nl> + days - before - stale : 14 <nl> + days - before - close : 30 <nl> + days - before - pr - close : - 1 <nl> + stale - issue - label : ' stale ' <nl> + stale - pr - label : ' stale ' <nl> + stale - issue - message : > <nl> This issue has been automatically marked as idle and stale because it hasn ' t <nl> had any recent activity . It will be automtically closed if no further activity <nl> occurs . If you think this is wrong , or the problem still persists , just pop <nl> a reply in the comments and @ remy will ( try ! ) to follow up . <nl> Thank you for contributing < 3 <nl> - # Comment to post when closing a stale issue . Set to ` false ` to disable <nl> - closeComment : false <nl> + close - issue - message : ' Automatically closing this issue due to lack of activity ' <nl> + exempt - issue - labels : <nl> + - not - stale <nl> + - security <nl> + - pinned <nl> 
mmm a / . github / workflows / stale . yml <nl> ppp b / . github / workflows / stale . yml <nl> Thank you for contributing < 3 <nl> close - issue - message : ' Automatically closing this issue due to lack of activity ' <nl> - exempt - issue - labels : <nl> - - not - stale <nl> - - security <nl> - - pinned <nl> + exempt - issue - labels : not - stale , security , pinned <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> - name : Setup Node . js <nl> uses : actions / setup - node @ v1 <nl> with : <nl> - node - version : 12 <nl> + node - version : 14 <nl> - name : Install dependencies <nl> run : npm ci <nl> - name : Release <nl> 
mmm a / website / index . html <nl> ppp b / website / index . html <nl> style = " display : flex ; flex - wrap : wrap ; overflow : hidden ; background : white ; border - radius : 2px ; padding : 20px ; margin - top : 40px ; " > <nl> + < ! - - static contributors - - > <nl> + < a title = ' padlet ' data - id = ' padlet ' href = ' https : / / padlet . com / ' > < img alt = ' null ' <nl> + src = ' https : / / images . opencollective . com / padlet / 320fa3e / logo / 256 . png ' style = ' float : left ; margin : 12px ' <nl> + width = ' 120 ' > < / a > <nl> + <nl> < ! - - https : / / opencollective . com / nodemon / members / all . json ? limit = 100 & offset = 0 & TierId = 2603 - - > <nl> < ! - - generated using https : / / jqterm . com / e09008bb74afe9fec8c1816252c3b9eb ? query = def % 20getImage % 3A % 0A % 09 . % 20as % 20 % 24_ % 20 % 7C % 0A % 09 % 7B % 20 % 0A % 20 % 20 % 20 % 20 % 20 % 20 % 22206432 % 22 % 3A % 20 % 22https % 3A % 2F % 2Fuser - images . githubusercontent . com % 2F13700 % 2F127474039 - 8ba5ac8c - 2095 - 4984 - 9309 - 54ff15e95340 . png % 22 % 2C % 0A % 09 % 20 % 20 % 22215800 % 22 % 3A % 20 % 22https % 3A % 2F % 2Fuser - images . githubusercontent . com % 2F13700 % 2F151881982 - 04677f3d - e2e1 - 44ee - a168 - 258b242b1ef4 . svg % 22 % 20 % 0A % 20 % 20 % 20 % 20 % 7D % 20 % 7C % 20 % 28 . % 5B % 22 % 5C % 28 % 24_ . MemberId % 29 % 22 % 5D % 20 % 2F % 2F % 20 % 24_ . image % 29 % 0A % 3B % 0A % 0Adef % 20tohtml % 3A % 0A % 22 % 20 % 20 % 20 % 20 % 20 % 20 % 20 % 20 % 20 % 20 % 3Ca % 20title % 3D % 27 % 5C % 28 . name % 29 % 27 % 20data - id % 3D % 27 % 5C % 28 . MemberId % 29 % 27 % 20href % 3D % 27 % 5C % 28 . website % 29 % 27 % 3E % 3Cimg % 20alt % 3D % 27 % 5C % 28 . description % 29 % 27 % 20src % 3D % 27 % 5C % 28 . % 20 % 7C % 20getImage % 29 % 27 % 20style % 3D % 27float % 3A % 20left % 3B % 20margin % 3A12px % 27 % 20width % 3D % 27120 % 27 % 3E % 3C % 2Fa % 3E % 22 % 0A % 3B % 0A % 0Asort_by % 28 . createdAt % 29 % 20 % 7C % 20map % 28select % 28 . isActive % 20 % 3D % 3D % 20true % 20and % 20 . image % 29 % 20 % 7C % 20tohtml % 29 % 5B % 5D & raw = true - - > <nl> 
mmm a / website / index . html <nl> ppp b / website / index . html <nl> style = ' object - fit : contain ; float : left ; margin : 12px ' height = ' 120 ' width = ' 120 ' > < / a > < a <nl> href = ' https : / / www . newcasinosaustralia . com / ' > < img src = ' https : / / logo . clearbit . com / newcasinosaustralia . com ' <nl> + style = ' object - fit : contain ; float : left ; margin : 12px ' height = ' 120 ' width = ' 120 ' > < / a > < a <nl> + href = ' https : / / casinostranieri . net / ' > < img <nl> + src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / 7aae8900 - 0c02 - 11ed - 9aa8 - 2bd811fd6f10 . png ' <nl> + style = ' object - fit : contain ; float : left ; margin : 12px ' height = ' 120 ' width = ' 120 ' > < / a > < a <nl> + href = ' https : / / goread . io / buy - instagram - followers ' > < img <nl> + src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / 7d1302a0 - 0f33 - 11ed - a094 - 3dca78aec7cd . png ' <nl> style = ' object - fit : contain ; float : left ; margin : 12px ' height = ' 120 ' width = ' 120 ' > < / a > <nl> < / div > <nl> < / div > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < a title = ' Casinostranieri . net ' data - id = ' 319480 ' href = ' https : / / casinostranieri . net / ' > < img alt = ' ' src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / 7aae8900 - 0c02 - 11ed - 9aa8 - 2bd811fd6f10 . png ' style = ' object - fit : contain ; float : left ; margin : 12px ' width = ' 120 ' > < / a > <nl> < a title = ' Goread . io ' data - id = ' 320564 ' href = ' https : / / goread . io / buy - instagram - followers ' > < img alt = ' null ' src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / 7d1302a0 - 0f33 - 11ed - a094 - 3dca78aec7cd . png ' style = ' object - fit : contain ; float : left ; margin : 12px ' width = ' 120 ' > < / a > <nl> < a title = ' SureBet ' data - id = ' 321121 ' href = ' https : / / www . sure . bet / casinos - not - on - gamstop / ' > < img alt = ' We are the most advanced casino guide ! ' src = ' https : / / logo . clearbit . com / sure . bet ' style = ' object - fit : contain ; float : left ; margin : 12px ' width = ' 120 ' > < / a > <nl> - < a title = ' Scommetteronline . info ' data - id = ' 321538 ' href = ' https : / / scommetteronline . info / bonus - scommesse - online / ' > < img alt = ' null ' src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / dfc8a530 - 126c - 11ed - 9c7b - 3b6f4738893c . jpg ' style = ' object - fit : contain ; float : left ; margin : 12px ' width = ' 120 ' > < / a > <nl> + < a title = ' Casinosicuri . info ' data - id = ' 321538 ' href = ' https : / / casinosicuri . info / ' > < img alt = ' null ' src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / 6ad106d0 - 16ec - 11ed - 8a46 - 7b820b28a610 . jpg ' style = ' object - fit : contain ; float : left ; margin : 12px ' width = ' 120 ' > < / a > <nl> + < a title = ' Correct Casinos Australia ' data - id = ' 322445 ' href = ' https : / / www . correctcasinos . com / australian - online - casinos / ' > < img alt = ' Best Australian online casinos . Reviewed by Correct Casinos . ' src = ' https : / / opencollective - production . s3 . us - west - 1 . amazonaws . com / fef95200 - 1551 - 11ed - ba3f - 410c614877c8 . png ' style = ' object - fit : contain ; float : left ; margin : 12px ' width = ' 120 ' > < / a > <nl> < / div > <nl> # License <nl> 
mmm a / src / server . js <nl> ppp b / src / server . js <nl> import ws from ' ws ' ; <nl> import sirv from ' sirv ' ; <nl> import polka from ' polka ' ; <nl> import parse from ' @ polka / url ' ; <nl> + import { createServer } from ' http ' ; <nl> import compression from ' . / lib / polkompress . js ' ; <nl> / * * <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " sade " : " ^ 1 . 7 . 3 " , <nl> " semver " : " ^ 7 . 3 . 2 " , <nl> - " sirv " : " ^ 0 . 4 . 6 " , <nl> + " sirv " : " ^ 1 . 0 . 0 " , <nl> " tar - stream " : " ^ 2 . 1 . 2 " , <nl> " terser " : " ^ 4 . 7 . 0 " , <nl> " tiny - glob " : " ^ 0 . 2 . 6 " , <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> } <nl> if ( config . mode = = = ' serve ' ) { <nl> - options . middleware . push ( <nl> + config . middleware . push ( <nl> / / add any Polka middleware : <nl> function myPolkaMiddleware ( req , res , next ) { <nl> res . setHeader ( ' X - Foo ' , ' bar ' ) ; <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # Configuration and plugins <nl> WMR supports a ` wmr . config . js ` ( or ` wmr . config . mjs ` ) configuration file . <nl> - You can export a config function , or individual config functions for each of the ` start ` , ` build ` and ` serve ` commands : <nl> + You can export a ` default ` config function , or individual config functions for each of the ` start ` , ` build ` and ` serve ` commands : <nl> ` ` ` js <nl> - / / wmr . config . js <nl> + / / wmr . config . mjs <nl> import someRollupPlugin from ' @ rollup / plugin - xyz ' ; <nl> / * * @ param { import ( ' wmr ' ) . Options } config * / <nl> @ @ - 142 , 6 + 142 , 20 @ @ export default async function ( config ) { <nl> ) ; <nl> } <nl> } <nl> + <nl> + / / OR <nl> + <nl> + export async function start ( config ) { <nl> + / / equivalent to ` config . mode = = = ' start ' ` <nl> + } <nl> + <nl> + export async function build ( config ) { <nl> + / / equivalent to ` config . mode = = = ' build ' ` <nl> + } <nl> + <nl> + export async function serve ( config ) { <nl> + / / equivalent to ` config . mode = = = ' serve ' ` <nl> + } <nl> ` ` ` <nl> See [ the full list of options ] ( https : / / github . com / preactjs / wmr / blob / master / types . d . ts ) . <nl> 
mmm a / src / bundler . js <nl> ppp b / src / bundler . js <nl> * @ property { string } [ publicDir = ' ' ] <nl> * @ property { string } [ out = ' . cache ' ] <nl> * @ property { boolean } [ sourcemap ] <nl> - * @ property { boolean } [ minify ] <nl> + * @ property { boolean } [ minify = true ] <nl> * @ property { Record < string , string > } [ aliases ] module aliases <nl> * @ property { boolean } [ profile ] Enable bundler performance profiling <nl> * @ property { Record < string , string > } [ env ] <nl> @ @ - 138 , 9 + 138 , 7 @ @ export async function bundleProd ( { <nl> return fileName ; <nl> } , <nl> hoistTransitiveImports : true , <nl> - plugins : [ <nl> - minify & & terser ( { compress : true , sourcemap } ) <nl> - ] , <nl> + plugins : [ minify & & terser ( { compress : true , sourcemap } ) ] , <nl> sourcemap , <nl> sourcemapPathTransform ( p , mapPath ) { <nl> let url = pathToPosix ( relative ( cwd , resolve ( dirname ( mapPath ) , p ) ) ) ; <nl> 
mmm a / src / plugins / optimize - graph - plugin . js <nl> ppp b / src / plugins / optimize - graph - plugin . js <nl> appendCode + = ' \ n ' + DEFAULT_STYLE_LOAD_IMPL ; <nl> } <nl> if ( DEBUG ) console . log ( ` Preloading CSS for import ( $ { spec } ) : $ { css } ` ) ; <nl> - preloads . push ( <nl> - . . . css . map ( f = > ` $ { meta . styleLoadFn } ( $ { toImport ( graph . publicPath , f , true ) } ) ` ) <nl> - ) ; <nl> + preloads . push ( . . . css . map ( f = > ` $ { meta . styleLoadFn } ( $ { toImport ( graph . publicPath , f , true ) } ) ` ) ) ; <nl> } <nl> const js = deps . js . get ( spec ) ; <nl> 
mmm a / src / plugins / optimize - graph - plugin . js <nl> ppp b / src / plugins / optimize - graph - plugin . js <nl> let rep = typeof newUrl = = = ' function ' ? newUrl ( url , fn , quote ) : newUrl ; <nl> if ( rep = = = false ) return ' null ' ; <nl> if ( typeof rep = = = ' string ' ) { <nl> - rep = JSON . stringify ( publicPath ? toImport ( publicPath , rep ) : rep ) ; <nl> + rep = publicPath ? toImport ( publicPath , rep ) : JSON . stringify ( rep ) ; <nl> } <nl> return ` $ { fn } ( $ { rep } ) ` ; <nl> } <nl> @ @ - 187 , 9 + 187 , 8 @ @ class ChunkGraph { <nl> / * * <nl> * @ param { string } publicPath <nl> * @ param { string } filename <nl> - * @ param { boolean } [ toJSON ] <nl> * / <nl> - function toImport ( publicPath , filename , toJSON ) { <nl> + function toImport ( publicPath , filename ) { <nl> let value = posix . join ( publicPath , filename ) ; <nl> if ( / ^ ( https ? : ) ? \ / \ / / . test ( publicPath ) ) { <nl> @ @ - 198 , 7 + 197 , 7 @ @ function toImport ( publicPath , filename , toJSON ) { <nl> value = new URL ( filename , root ) . href . substring ( isFull ? 0 : 6 ) ; <nl> } <nl> - return toJSON ? JSON . stringify ( value ) : value ; <nl> + return JSON . stringify ( value ) ; <nl> } <nl> / * * <nl> @ @ - 285 , 7 + 284 , 7 @ @ function hoistEntryCss ( graph ) { <nl> } else { <nl> / / @ TODO : this branch is actually unreachable <nl> if ( DEBUG ) console . log ( ` Hoisting CSS " $ { f } " imported by $ { id } into parent HTML . ` ) ; <nl> - const url = toImport ( graph . publicPath , f , true ) ; <nl> + const url = toImport ( graph . publicPath , f ) ; <nl> asset . source = getAssetSource ( asset ) . replace ( / < \ / head > / , ` < link rel = " stylesheet " href = $ { url } > < / head > ` ) ; <nl> } <nl> } <nl> @ @ - 348 , 7 + 347 , 7 @ @ function hoistCascadedCss ( graph , { cssMinSize } ) { <nl> parentChunk . code + = ' \ n ' + DEFAULT_STYLE_LOAD_IMPL ; <nl> } <nl> - const url = toImport ( graph . publicPath , fileName , true ) ; <nl> + const url = toImport ( graph . publicPath , fileName ) ; <nl> parentChunk . code + = ` \ n $ { meta . styleLoadFn } ( $ { url } ) ; ` ; <nl> } <nl> break ; <nl> @ @ - 390 , 7 + 389 , 7 @ @ function hoistTransitiveImports ( graph ) { <nl> appendCode + = ' \ n ' + DEFAULT_STYLE_LOAD_IMPL ; <nl> } <nl> if ( DEBUG ) console . log ( ` Preloading CSS for import ( $ { spec } ) : $ { css } ` ) ; <nl> - preloads . push ( . . . css . map ( f = > ` $ { meta . styleLoadFn } ( $ { toImport ( graph . publicPath , f , true ) } ) ` ) ) ; <nl> + preloads . push ( . . . css . map ( f = > ` $ { meta . styleLoadFn } ( $ { toImport ( graph . publicPath , f ) } ) ` ) ) ; <nl> } <nl> const js = deps . js . get ( spec ) ; <nl> 
mmm a / src / lib / npm - middleware - cache . js <nl> ppp b / src / lib / npm - middleware - cache . js <nl> * / <nl> function getCachePath ( { module , version , path } , cwd ) { <nl> const tfPath = ( path | | ' ' ) . replace ( / \ / / g , ' - - - ' ) ; <nl> - return resolve ( cwd | | ' . ' , ` node_modules / $ { module } / . cache / $ { version } - - $ { tfPath } . js ` ) ; <nl> + return resolve ( cwd | | ' . ' , ` . cache / @ npm / $ { module } @ $ { version } / $ { tfPath } . js ` ) ; <nl> } <nl> 
mmm a / packages / wmr / src / cli . js <nl> ppp b / packages / wmr / src / cli . js <nl> return v ! = = false & & ! / false | 0 / . test ( v ) ; <nl> } <nl> + / / global options <nl> prog <nl> . option ( ' - - public ' , ' Your web app root directory ( default : . / public ) ' ) <nl> . option ( ' - - out ' , ' Where to store generated files ( default : . / dist ) ' ) <nl> - . option ( ' - - cwd ' , ' The working directory - equivalent to " ( cd FOO & & wmr ) " ' ) <nl> + . option ( ' - - cwd ' , ' The working directory - equivalent to " ( cd FOO & & wmr ) " ' ) ; <nl> + <nl> + prog <nl> . command ( ' build ' , ' make a production build ' ) <nl> . option ( ' - - prerender ' , ' Pre - render the application to HTML ' ) <nl> . option ( ' - - sourcemap ' , ' Enable Source Maps ' ) <nl> @ @ - 24 , 7 + 27 , 9 @ @ prog <nl> . action ( opts = > { <nl> opts . minify = opts . minify ! = = false & & ! / false | 0 / . test ( opts . minify ) ; <nl> run ( build ( opts ) ) ; <nl> - } ) <nl> + } ) ; <nl> + <nl> + prog <nl> . command ( ' serve ' , ' Start a production server ' ) <nl> . option ( ' - - out ' , ' Directory to serve ( default : . / dist ) ' ) <nl> . option ( ' - - port , - p ' , ' HTTP port to listen on ( default : $ PORT or 8080 ) ' ) <nl> @ @ - 34 , 7 + 39 , 9 @ @ prog <nl> . action ( opts = > { <nl> opts . compress = bool ( opts . compress ) ; <nl> run ( serve ( opts ) ) ; <nl> - } ) <nl> + } ) ; <nl> + <nl> + prog <nl> . command ( ' start ' , ' Start a development server ' , { default : true } ) <nl> . option ( ' - - port , - p ' , ' HTTP port to listen on ( default : $ PORT or 8080 ) ' ) <nl> . option ( ' - - host ' , ' HTTP host to listen on ( default : localhost ) ' ) <nl> @ @ - 45 , 21 + 52 , 25 @ @ prog <nl> . action ( opts = > { <nl> opts . optimize = ! / false | 0 / . test ( opts . compress ) ; <nl> opts . compress = bool ( opts . compress ) ; <nl> - if ( / true / . test ( process . env . PROFILE ) ) opts . profile = true ; <nl> + if ( / true / . test ( process . env . PROFILE | | ' ' ) ) opts . profile = true ; <nl> run ( start ( opts ) ) ; <nl> } ) ; <nl> prog . parse ( process . argv ) ; <nl> function run ( p ) { <nl> - p . catch ( err = > { <nl> - const text = err . message | | err + ' ' ; <nl> + p . catch ( catchException ) ; <nl> + } <nl> + <nl> + function catchException ( err ) { <nl> + const text = ( err . stack & & err . stack . split ( ' \ n ' ) [ 0 ] ) | | err . message | | err + ' ' ; <nl> const stack = errorstacks <nl> . parseStackTrace ( err . stack ) <nl> . map ( frame = > frame . raw ) <nl> . join ( ' \ n ' ) ; <nl> process . stderr . write ( ` \ n $ { kl . red ( text ) } \ n $ { stack ? kl . dim ( stack + ' \ n \ n ' ) : ' ' } ` ) ; <nl> - process . exit ( p . code | | 1 ) ; <nl> - } ) ; <nl> + process . exit ( 1 ) ; <nl> } <nl> + <nl> + process . setUncaughtExceptionCaptureCallback ( catchException ) ; <nl> 
mmm a / examples / demo / public / index . tsx <nl> ppp b / examples / demo / public / index . tsx <nl> const sleep = t = > new Promise ( r = > setTimeout ( r , t ) ) ; <nl> + const IS_CLIENT = typeof window ! = = ' undefined ' ; <nl> + <nl> const About = lazy ( ( ) = > import ( ' . / pages / about / index . js ' ) ) ; <nl> - const LazyAndLate = lazy ( async ( ) = > ( await sleep ( 1500 ) , import ( ' . / pages / about / index . js ' ) ) ) ; <nl> + const LazyAndLate = lazy ( async ( ) = > ( IS_CLIENT & & ( await sleep ( 1500 ) ) , import ( ' . / pages / about / index . js ' ) ) ) ; <nl> const CompatPage = lazy ( ( ) = > import ( ' . / pages / compat . js ' ) ) ; <nl> - const ClassFields = lazy ( async ( ) = > ( await sleep ( 1500 ) , import ( ' . / pages / class - fields . js ' ) ) ) ; <nl> + const ClassFields = lazy ( async ( ) = > ( IS_CLIENT & & ( await sleep ( 1500 ) ) , import ( ' . / pages / class - fields . js ' ) ) ) ; <nl> const Files = lazy ( ( ) = > import ( ' . / pages / files / index . js ' ) ) ; <nl> const Environment = lazy ( async ( ) = > ( await import ( ' . / pages / environment / index . js ' ) ) . Environment ) ; <nl> const JSONView = lazy ( async ( ) = > ( await import ( ' . / pages / json . js ' ) ) . JSONView ) ; <nl> 
mmm a / packages / wmr / test / lib / polkompress . test . js <nl> ppp b / packages / wmr / test / lib / polkompress . test . js <nl> } ; <nl> } <nl> - describe . only ( ' polkompress ' , ( ) = > { <nl> + describe ( ' polkompress ' , ( ) = > { <nl> it ( ' should be a function ' , ( ) = > { <nl> expect ( typeof compression ) . toBe ( ' function ' ) ; <nl> } ) ; <nl> 
mmm a / packages / wmr / src / wmr - middleware . js <nl> ppp b / packages / wmr / src / wmr - middleware . js <nl> } <nl> let graphId = importer . replace ( / ^ \ . ? \ . ? \ / / , ' ' ) ; <nl> if ( ! moduleGraph . has ( graphId ) ) { <nl> - console . log ( ' create ' , graphId ) ; <nl> moduleGraph . set ( graphId , { dependencies : new Set ( ) , dependents : new Set ( ) , acceptingUpdates : false } ) ; <nl> } <nl> const mod = moduleGraph . get ( graphId ) ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " * * / * . ts " , <nl> " packages / wmr / wmr . cjs " , <nl> - " packages / wmr / test / fixtures / * * / * . expected . * " , <nl> - " packages / wmr / test / fixtures / * / dist " , <nl> - " packages / wmr / test / fixtures / * / . cache " <nl> + " packages / wmr / test / fixtures / * * " <nl> ] , <nl> " prettier " : { <nl> " singleQuote " : true , <nl> 
mmm a / packages / wmr / rollup . config . js <nl> ppp b / packages / wmr / rollup . config . js <nl> plugins : [ <nl> shebangPlugin ( ) , <nl> replace ( { <nl> - ' process . env . VERSION ' : JSON . stringify ( require ( ' . / package . json ' ) . version ) <nl> + ' process . env . VERSION ' : JSON . stringify ( require ( ' . / package . json ' ) . version ) , <nl> + ' process . env . BROWSERSLIST_IGNORE_OLD_DATA ' : true <nl> } ) , <nl> { <nl> / / This inlines some fs . promises . readFile ( ) calls , while allowing them to run unbundled in Node . <nl> @ @ - 116 , 7 + 117 , 7 @ @ const config = { <nl> } , <nl> { <nl> / / This ensures the template files for rollup - plugin - visualizer are inlined <nl> - / / rather than bundleds as fs . readFile ( ) <nl> + / / rather than bundled as fs . readFile ( ) <nl> name : ' fix - visualizer ' , <nl> transform ( code , id ) { <nl> if ( / rollup - plugin - visualizer [ / \ \ ] dist [ / \ \ ] plugin [ / \ \ ] build - stats \ . js $ / . test ( id ) ) { <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> + < a name = " " > < / a > <nl> + # [ ] ( https : / / github . com / CyberReboot / CRviz / compare / v0 . 1 . 2 . . . v ) ( 2018 - 06 - 23 ) <nl> + <nl> + <nl> + <nl> < a name = " 0 . 1 . 2 " > < / a > <nl> # # [ 0 . 1 . 2 ] ( https : / / github . com / CyberReboot / CRviz / compare / v0 . 1 . 1 . . . v0 . 1 . 2 ) ( 2018 - 06 - 23 ) <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> + <nl> + services : <nl> + - docker <nl> + <nl> language : node_js <nl> node_js : <nl> - ' 8 ' <nl> @ @ - 14 , 3 + 19 , 5 @ @ script : <nl> - npm install - - no - optional <nl> - npm run test <nl> - npm run build <nl> + - docker build - t crviz - f Dockerfile . <nl> + - docker build - t crviz - gh - f Dockerfile . gh . <nl> \ No newline at end of file <nl> 
mmm a / . github / ISSUE_TEMPLATE / bug_report . md <nl> ppp b / . github / ISSUE_TEMPLATE / bug_report . md <nl> - - - <nl> - # # # Description # # # <nl> + # # # Description <nl> Describe your issue here . <nl> - # # # Environment # # # <nl> + # # # Environment <nl> - version of CRviz ? <nl> - which browser and its version ? <nl> - versions of the following ( if known and / or applicable ) <nl> @ @ - 16 , 11 + 16 , 11 @ @ Describe your issue here . <nl> - D3 <nl> - Docker <nl> - # # # Steps to reproduce # # # <nl> + # # # Steps to reproduce <nl> Tell us how to recreate your issue . <nl> - # # # Expected results # # # <nl> + # # # Expected results <nl> What did you think would happen ? <nl> - # # # Actual results # # # <nl> + # # # Actual results <nl> What * * really * * happened ? <nl> 
mmm a / . github / ISSUE_TEMPLATE / feature_request . md <nl> ppp b / . github / ISSUE_TEMPLATE / feature_request . md <nl> - - - <nl> - # # # Describe the feature you are requesting # # # <nl> + # # # Describe the feature you are requesting <nl> A clear and concise description of the functionality you would like implemented . <nl> - # # # Describe your use case # # # <nl> + # # # Describe your use case <nl> A clear and concise explanation of the obstacle you are facing . <nl> - # # # Explain how this feature supports your use case ? Other use cases ? # # <nl> + # # # Explain how this feature supports your use case ? Other use cases ? <nl> Why should this be implemented in the way you are suggesting ? <nl> - # # # Additional Info # # # <nl> + # # # Additional Info <nl> Add any other information relevant to this request <nl> 
mmm a / src / features / dataset - controls / DatasetSelector . test . js <nl> ppp b / src / features / dataset - controls / DatasetSelector . test . js <nl> const change = ( target ) = > { <nl> } <nl> - const event = { " target " : { " name " : " ds3 " , " url " : " test3 . url " } } ; <nl> + const event = { " target " : { value : " test3 . url " } } ; <nl> describe ( ' DatasetSelector ' , ( ) = > { <nl> it ( ' renders the control ' , ( ) = > { <nl> const selector = mount ( < DatasetSelector <nl> @ @ - 31 , 15 + 31 , 18 @ @ describe ( ' DatasetSelector ' , ( ) = > { <nl> } ) ; <nl> it ( ' changes the selection ' , ( ) = > { <nl> - const onChange = sinon . stub ( ) <nl> + const fakeOnChange = ( evt ) = > { <nl> + <nl> + } <nl> + const onChangeSpy = sinon . spy ( fakeOnChange ) ; <nl> const selector = mount ( < DatasetSelector <nl> className = { style . selector } <nl> selected = { empty } <nl> - onChange = { onChange } <nl> + onChange = { onChangeSpy } <nl> datasets = { datasets } <nl> / > ) ; <nl> - selector . find ( ' select ' ) . first ( ) . simulate ( " change " , event ) ; <nl> - expect ( onChange . calledOnce ) . to . equal ( true ) ; <nl> + selector . find ( ' select ' ) . first ( ) . simulate ( ' change ' , event ) ; <nl> + expect ( onChangeSpy . calledWith ( datasets [ 2 ] ) ) . to . equal ( true ) ; <nl> } ) ; <nl> } ) ; <nl> \ No newline at end of file <nl> 
mmm a / src / features / header / Header . js <nl> ppp b / src / features / header / Header . js <nl> render ( ) { <nl> return ( <nl> < div className = { style . header } > <nl> - < img src = { logo } className = { style . logo } alt = ' ' / > <nl> + < a href = " http : / / www . cyberreboot . org / " target = " _blank " rel = " noopener noreferrer " > <nl> + < img src = { logo } className = { style . logo } alt = ' Cyber Reboot ' / > <nl> + < / a > <nl> < span className = { style . appName } > CRviz < / span > <nl> < span className = { style . infoIcon } > <nl> < label id = " showInfo " onMouseEnter = { this . showTooltip } onMouseLeave = { this . hideTooltip } > <nl> 
mmm a / src / domain / controls . js <nl> ppp b / src / domain / controls . js <nl> start : null , / / The uuid of the dataset to use as the starting point for comparison <nl> end : null , / / The uuid of the dataset to use as the end point for comparison <nl> showBusy : false , / / display the activity icon <nl> - position : [ 0 , 0 ] <nl> + position : [ 0 , 0 ] , / / The position used for a mouse click <nl> + datum : null / / <nl> } ; <nl> / / ACTION CREATORS <nl> @ @ - 22 , 6 + 23 , 7 @ @ const useDarkTheme = createAction ( " USE_DARK_THEME " ) ; <nl> const colorBy = createAction ( " COLOR_BY " ) ; <nl> const showBusy = createAction ( " SHOW_BUSY " ) ; <nl> const setPosition = createAction ( " POSITION " ) ; <nl> + const setSelectedDatum = createAction ( " SETSELECTEDDATUM " ) <nl> / / REDUCERS <nl> @ @ - 56 , 6 + 58 , 7 @ @ const reducer = handleActions ( <nl> [ colorBy ] : ( state , { payload } ) = > ( { . . . state , colorBy : payload } ) , <nl> [ showBusy ] : ( state , { payload } ) = > ( { . . . state , showBusy : ! ! payload } ) , <nl> [ setPosition ] : ( state , { payload } ) = > ( { . . . state , position : payload } ) , <nl> + [ setSelectedDatum ] : ( state , { payload } ) = > ( { . . . state , selectedDatum : payload } ) , <nl> } , <nl> defaultState <nl> ) ; <nl> @ @ - 63 , 6 + 66 , 7 @ @ const reducer = handleActions ( <nl> / / SELECTORS <nl> const selectControls = ( state ) = > state . controls ; <nl> const getPosition = ( state ) = > state . controls . position ; <nl> + const getSelectedDatum = ( state ) = > state . controls . selectedDatum ; <nl> export default reducer ; <nl> - export { setControls , setHierarchyConfig , showNodes , colorBy , useDarkTheme , selectControls , setStartDataset , setEndDataset , showBusy , setPosition , getPosition } ; <nl> + export { setControls , setHierarchyConfig , showNodes , colorBy , useDarkTheme , selectControls , setStartDataset , setEndDataset , showBusy , setPosition , getPosition , setSelectedDatum , getSelectedDatum } ; <nl> 
mmm a / src / features / note - selector / NoteSelector . module . css <nl> ppp b / src / features / note - selector / NoteSelector . module . css <nl> border - left - color : rgb ( 65 , 65 , 65 ) ; <nl> } <nl> + <nl> + : global ( . darkTheme ) . tag { <nl> + color : white ; <nl> + background - color : rgb ( 130 , 129 , 129 ) ; <nl> + } <nl> + <nl> + : global ( . darkTheme ) . tag : hover { <nl> + / * background - color : # cc0000 ; * / <nl> + background - color : white ; <nl> + color : black ; <nl> + } <nl> \ No newline at end of file <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # # # Project TODO : <nl> - [ x ] Setup Storybook for components UI <nl> - [ x ] Theme Provider <nl> + - [ x ] Develop styling scheme for components with styled components <nl> - [ x ] Setup Vue . js plugin system <nl> - [ x ] Provide Theme <nl> - - [ ] Observe theme and set it dynamically in javascript with ease . <nl> + - [ x ] Observe theme and set it dynamically in javascript with ease . <nl> - [ ] Provide icons API for icons component <nl> - - [ ] Develop styling scheme for components with styled components <nl> + - [ ] Accessibility ( Focus ) Styling <nl> - [ ] Setup NPM distribution <nl> - [ ] Set up type system for components with Typescript <nl> - - [ ] Accessibility ( Focus ) Styling <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build - storybook " : " build - storybook - - quiet " , <nl> " docs : dev " : " vuepress dev docs " , <nl> - " docs : build " : " vuepress build docs " <nl> + " docs : build " : " vuepress build docs " , <nl> + " build - vsc " : " cd node_modules / vue - styled - components & & npm install & & npm run build & & cd . . / . . / " <nl> } , <nl> " dependencies " : { <nl> " @ babel / preset - env " : " ^ 7 . 6 . 3 " , <nl> 
mmm a / stories / 3 - Button . stories . js <nl> ppp b / stories / 3 - Button . stories . js <nl> } <nl> } <nl> } ) ) <nl> - . add ( ' Mortezas button ' , ( ) = > ( { <nl> - components : { Button } , <nl> - template : ` <nl> - < div > <nl> - < Button : variant - color = " variantColor " variant = " link " right - icon = " email " @ click = " setLoading " : is - loading = " loading " > { { buttonText } } < / Button > <nl> - < / div > <nl> - ` , <nl> - data ( ) { <nl> - return { <nl> - loading : false , <nl> - buttonText : ' Send ' , <nl> - variantColor : ' blue ' <nl> - } <nl> - } , <nl> - methods : { <nl> - setLoading ( ) { <nl> - this . loading = true <nl> - setTimeout ( ( ) = > { <nl> - this . loading = false <nl> - this . buttonText = ' Sent ' <nl> - this . variantColor = ' green ' <nl> - } , 1500 ) <nl> - } <nl> - } <nl> - } ) ) <nl> 
mmm a / packages / kiwi - core / src / Portal / index . js <nl> ppp b / packages / kiwi - core / src / Portal / index . js <nl> created ( ) { <nl> this . target = createPortalTarget ( this . targetNode ) <nl> this . targetSelector = ` # $ { this . target . id } ` <nl> - console . log ( { target : this . target } ) <nl> } , <nl> render ( h ) { <nl> return h ( ' mounting - portal ' , { <nl> 
mmm a / packages / kiwi - core / src / Breadcrumb / index . js <nl> ppp b / packages / kiwi - core / src / Breadcrumb / index . js <nl> import { baseProps } from ' . . / config / props ' <nl> import Box from ' . . / Box ' <nl> import Link from ' . . / Link ' <nl> - import { forwardProps , cloneVNode , cloneVNodes } from ' . . / utils ' <nl> + import { forwardProps , cloneVNodes } from ' . . / utils ' <nl> const BreadcrumbSeparator = { <nl> name : ' BreadcrumbSeparator ' , <nl> @ @ - 87 , 20 + 87 , 18 @ @ const BreadcrumbItem = { <nl> setup ( props , context ) { <nl> return ( ) = > { <nl> const children = context . slots . default ( ) <nl> - const clones = children . map ( ( node ) = > { <nl> - if ( node . componentOptions . tag = = = BreadcrumbLink . name ) { <nl> - const clone = cloneVNode ( node , h ) <nl> + const clones = cloneVNodes ( children , h ) . map ( ( clone ) = > { <nl> + if ( clone . componentOptions . tag = = = BreadcrumbLink . name ) { <nl> const { propsData } = clone . componentOptions <nl> propsData [ ' isCurrentPage ' ] = props . isCurrentPage <nl> clone . componentOptions . propsData = propsData <nl> return clone <nl> } <nl> - if ( node . componentOptions . tag = = = BreadcrumbSeparator . name ) { <nl> - const clone = cloneVNode ( node , h ) <nl> + if ( clone . componentOptions . tag = = = BreadcrumbSeparator . name ) { <nl> const { propsData } = clone . componentOptions <nl> propsData [ ' spacing ' ] = props . spacing <nl> propsData [ ' separator ' ] = props . separator <nl> - clone . componentOptions . children = node . componentOptions . children | | props . separator <nl> + clone . componentOptions . children = clone . componentOptions . children | | props . separator <nl> clone . componentOptions . propsData = propsData <nl> return clone <nl> } <nl> 
mmm a / stories / 33 - FormControl . stories . js <nl> ppp b / stories / 33 - FormControl . stories . js <nl> - import { Input , FormControl , FormLabel } from ' . . / packages / kiwi - core / src ' <nl> + import { Input , FormControl , FormLabel , Icon , Stack , InputGroup , InputLeftElement , InputRightElement , FormHelperText , FormErrorMessage } from ' . . / packages / kiwi - core / src ' <nl> storiesOf ( ' UI | FormControl ' , module ) <nl> . add ( ' Basic Usage ' , ( ) = > ( { <nl> @ @ - 11 , 3 + 11 , 43 @ @ storiesOf ( ' UI | FormControl ' , module ) <nl> < / FormControl > <nl> ` <nl> } ) ) <nl> + . add ( ' With Form Helper Text ' , ( ) = > ( { <nl> + components : { Input , FormControl , Stack , Icon , InputGroup , InputLeftElement , InputRightElement , FormHelperText } , <nl> + template : ` <nl> + < div > <nl> + < FormControl isInvalid id = " test - error " > <nl> + < InputGroup > <nl> + < InputLeftElement color = " gray . 300 " fontSize = " 1 . 2em " > < Icon name = " lock " / > < / InputLeftElement > <nl> + < Input : type = " shouldShowPassword ? ' text ' : ' password ' " placeholder = " Password " / > <nl> + < InputRightElement @ click . native = " shouldShowPassword = ! shouldShowPassword " > < Icon : name = " shouldShowPassword ? ' eye - slash ' : ' eye ' " color = " gray . 500 " / > < / InputRightElement > <nl> + < / InputGroup > <nl> + < FormHelperText > Add your website here < / FormHelperText > <nl> + < / FormControl > <nl> + < / div > <nl> + ` , <nl> + data ( ) { <nl> + return { <nl> + shouldShowPassword : false <nl> + } <nl> + } <nl> + } ) ) <nl> + . add ( ' With Form Validation Message ' , ( ) = > ( { <nl> + components : { Input , FormControl , Stack , Icon , InputGroup , InputLeftElement , InputRightElement , FormErrorMessage } , <nl> + template : ` <nl> + < div > <nl> + < FormControl isInvalid id = " test - error " > <nl> + < InputGroup > <nl> + < InputLeftElement color = " gray . 300 " fontSize = " 1 . 2em " > < Icon name = " lock " / > < / InputLeftElement > <nl> + < Input : type = " shouldShowPassword ? ' text ' : ' password ' " placeholder = " Password " / > <nl> + < InputRightElement @ click . native = " shouldShowPassword = ! shouldShowPassword " > < Icon : name = " shouldShowPassword ? ' eye - slash ' : ' eye ' " color = " gray . 500 " / > < / InputRightElement > <nl> + < / InputGroup > <nl> + < FormErrorMessage id = " url - error " > Website is invalid < / FormErrorMessage > <nl> + < / FormControl > <nl> + < / div > <nl> + ` , <nl> + data ( ) { <nl> + return { <nl> + shouldShowPassword : false <nl> + } <nl> + } <nl> + } ) ) <nl> 
mmm a / stories / 27 - Popover . stories . js <nl> ppp b / stories / 27 - Popover . stories . js <nl> - import { Button , Popover , PopoverTrigger , PopoverContent , DarkMode , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter , Box , ButtonGroup , Text } from ' . . / packages / kiwi - core / src ' <nl> + import { Avatar , Button , Badge , Popover , PopoverTrigger , PopoverContent , DarkMode , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter , Box , ButtonGroup , Text } from ' . . / packages / kiwi - core / src ' <nl> storiesOf ( ' UI | Popover ' , module ) <nl> . add ( ' Basic Usage ' , ( ) = > ( { <nl> @ @ - 82 , 7 + 82 , 7 @ @ storiesOf ( ' UI | Popover ' , module ) <nl> ` <nl> } ) ) <nl> . add ( ' Accessing Internal state ' , ( ) = > ( { <nl> - components : { Button , Popover , PopoverTrigger , PopoverContent , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter } , <nl> + components : { Button , Popover , PopoverTrigger , PopoverContent , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter , Box } , <nl> template : ` <nl> < Popover <nl> initialFocusRef = " # initRef " <nl> @ @ - 115 , 7 + 115 , 7 @ @ storiesOf ( ' UI | Popover ' , module ) <nl> ` <nl> } ) ) <nl> . add ( ' Customizing the Popover ' , ( ) = > ( { <nl> - components : { Button , Popover , PopoverTrigger , PopoverContent , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter } , <nl> + components : { Button , Popover , PopoverTrigger , PopoverContent , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter , Box } , <nl> template : ` <nl> < Popover > <nl> < PopoverTrigger > <nl> @ @ - 143 , 13 + 143 , 13 @ @ storiesOf ( ' UI | Popover ' , module ) <nl> ` <nl> } ) ) <nl> . add ( ' Hover Trigger ' , ( ) = > ( { <nl> - components : { DarkMode , KText : Text , Button , Popover , PopoverTrigger , PopoverContent , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter } , <nl> + components : { DarkMode , KText : Text , Button , Popover , PopoverTrigger , PopoverContent , PopoverHeader , PopoverBody , PopoverArrow , PopoverCloseButton , PopoverFooter , Box , Avatar , Badge } , <nl> template : ` <nl> < Popover trigger = " hover " > <nl> < PopoverTrigger > <nl> - < Anchor href = " # " color = " blue . 500 " > <nl> + < Button color = " blue . 500 " > <nl> Hover to see @ swyx profile <nl> - < / Anchor > <nl> + < / Button > <nl> < / PopoverTrigger > <nl> < DarkMode > <nl> < PopoverContent border = " 0 " zIndex = " 4 " width = " 400px " color = " white " > <nl> 
mmm a / stories / 26 - Menu . stories . js <nl> ppp b / stories / 26 - Menu . stories . js <nl> - import { Menu , MenuGroup , MenuButton , MenuList , MenuOptionGroup , MenuItemOption , MenuItem , MenuDivider } from ' . . / packages / kiwi - core / src ' <nl> + import { Menu , MenuGroup , MenuButton , MenuList , MenuOptionGroup , MenuItemOption , MenuItem , MenuDivider , Icon } from ' . . / packages / kiwi - core / src ' <nl> storiesOf ( ' UI | Menu ' , module ) <nl> . add ( ' Default Menu ' , ( ) = > ( { <nl> - components : { Menu , MenuGroup , MenuButton , MenuList , MenuItem , MenuDivider } , <nl> + components : { Menu , MenuGroup , MenuButton , MenuList , MenuItem , MenuDivider , Icon } , <nl> template : ` <nl> < Menu > <nl> - < MenuButton as = { Button } rightIcon = " chevron - down " > <nl> + < MenuButton as = " Button " rightIcon = " chevron - down " > <nl> Actions <nl> < / MenuButton > <nl> < MenuList > <nl> @ @ - 43 , 7 + 43 , 7 @ @ storiesOf ( ' UI | Menu ' , module ) <nl> ` <nl> } ) ) <nl> . add ( ' With letter navigation ' , ( ) = > ( { <nl> - components : { Menu , MenuGroup , MenuButton , MenuList , MenuItem , MenuDivider } , <nl> + components : { Menu , MenuGroup , MenuButton , MenuList , MenuItem , MenuDivider , Icon } , <nl> template : ` <nl> < Menu > <nl> < MenuButton <nl> 
mmm a / packages / kiwi - core / src / Radio / index . js <nl> ppp b / packages / kiwi - core / src / Radio / index . js <nl> } , <nl> render ( h ) { <nl> const children = this . $ slots . default . filter ( e = > ( e . tag | | e . text ) ) <nl> - / / const children = this . $ slots . default <nl> return h ( Box , { <nl> props : { <nl> 
mmm a / packages / kiwi - core / src / Switch / tests / switch . test . js <nl> ppp b / packages / kiwi - core / src / Switch / tests / switch . test . js <nl> } ) <nl> it ( ' should emit a change event ' , async ( ) = > { <nl> - const events = [ ] <nl> - const eventsHandler = jest . fn ( evt = > events . push ( evt . type ) ) <nl> + const spy = jest . fn ( ) <nl> const { getByTestId } = renderComponent ( <nl> { <nl> methods : { <nl> - handleChange : eventsHandler <nl> + handleChange : spy <nl> } , <nl> template : ` < Toggle data - testid = " label " @ change = " handleChange " / > ` <nl> } <nl> @ @ - 45 , 5 + 44 , 6 @ @ it ( ' should emit a change event ' , async ( ) = > { <nl> const label = getByTestId ( ' label ' ) <nl> userEvent . click ( label ) <nl> - expect ( events ) . toEqual ( [ ' change ' ] ) <nl> + <nl> + expect ( spy ) . toHaveBeenCalledTimes ( 1 ) <nl> } ) <nl> 
mmm a / packages / kiwi - core / src / CloseButton / tests / CloseButton . test . js <nl> ppp b / packages / kiwi - core / src / CloseButton / tests / CloseButton . test . js <nl> return render ( base ) <nl> } <nl> it ( ' should render correctly ' , ( ) = > { <nl> - const { asFragment } = renderComponent ( { <nl> - template : ` < CloseButton / > ` <nl> - } ) <nl> + const { asFragment } = renderComponent ( ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> } ) <nl> it ( ' should allow setting a custom aria - label for the button ' , ( ) = > { <nl> 
mmm a / packages / kiwi - core / docs / components / components . js <nl> ppp b / packages / kiwi - core / docs / components / components . js <nl> + / * * <nl> + * NOTE : <nl> + * <nl> + * Dear maintainers , <nl> + * Components listed in this file should be listed alphabetically . Thanks : ) <nl> + * / <nl> const components = [ <nl> ' Accordion ' , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " babel - preset - vue " : " ^ 2 . 0 . 2 " , <nl> " babelrc - rollup " : " ^ 3 . 0 . 0 " , <nl> - " body - scroll - lock " : " ^ 2 . 6 . 4 " , <nl> " breadstick " : " ^ 0 . 1 . 21 " , <nl> " can - use - dom " : " ^ 0 . 1 . 0 " , <nl> " color " : " ^ 3 . 1 . 2 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " styled - system " : " ^ 5 . 1 . 2 " , <nl> " v - scroll - lock " : " ^ 1 . 1 . 0 " , <nl> - " vue " : " ^ 2 . 6 . 10 " , <nl> " vue - loader " : " ^ 15 . 7 . 1 " , <nl> " vue - lorem - ipsum " : " ^ 0 . 0 . 1 " , <nl> " vue - template - compiler " : " ^ 2 . 6 . 10 " <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " v - scroll - lock " : " ^ 1 . 1 . 0 " , <nl> " vue - loader " : " ^ 15 . 7 . 1 " , <nl> - " vue - lorem - ipsum " : " ^ 0 . 0 . 1 " , <nl> - " vue - template - compiler " : " ^ 2 . 6 . 10 " <nl> + " vue - lorem - ipsum " : " ^ 0 . 0 . 1 " <nl> } <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / RadioButtonGroup / RadioGroup . stories . js <nl> ppp b / packages / chakra - ui - core / src / RadioButtonGroup / RadioGroup . stories . js <nl> template : ` <nl> < div > <nl> < Fragment > <nl> - < Button @ click = " focusRadioGroup " > <nl> - Focus RadioGroup <nl> - < / Button > <nl> < RadioGroup <nl> size = " lg " <nl> defaultValue = " male " <nl> - @ change = " handleChange " <nl> ref = " rg " <nl> > <nl> < Radio variantColor = " red " value = " male " > Male < / Radio > <nl> @ @ - 53 , 7 + 49 , 6 @ @ storiesOf ( ' UI | RadioGroup ' , module ) <nl> < Fragment > <nl> < RadioButtonGroup <nl> defaultValue = " item - 2 " <nl> - @ change = " handleChange " <nl> isInline <nl> : spacing = " 4 " <nl> > <nl> 
mmm a / packages / chakra - ui - docs / package . json <nl> ppp b / packages / chakra - ui - docs / package . json <nl> } , <nl> " dependencies " : { <nl> - " @ chakra - ui / vue " : " ^ 0 . 2 . 5 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 2 . 6 " , <nl> " @ fortawesome / free - solid - svg - icons " : " ^ 5 . 11 . 2 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> " @ mdx - js / vue - loader " : " ^ 1 . 5 . 7 " , <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> You can also view all developed components in * * [ Storybook ] ( https : / / chakra - ui - vue . netlify . com ) ! * * <nl> # # # Development for Contributing : <nl> - Interested in contributing ? See our [ open issues ] ( / issues ) ! Remember to take a look at our [ CONTRIBUTORS ] ( . . / . . / . github / CONTRIBUTING . md ) guide . <nl> + Interested in contributing ? See our [ open issues ] ( https : / / github . com / chakra - ui / chakra - ui - vue / issues ) ! Remember to take a look at our [ CONTRIBUTORS ] ( . . / . . / . github / CONTRIBUTING . md ) guide . <nl> ` ` ` bash <nl> yarn install <nl> 
mmm a / packages / chakra - ui - core / src / Editable / tests / Editable . test . js <nl> ppp b / packages / chakra - ui - core / src / Editable / tests / Editable . test . js <nl> expect ( input ) . not . toHaveAttribute ( ' aria - disabled ' ) <nl> } ) <nl> - test ( ' has the proper aria attributes ' , async ( ) = > { <nl> - const inlineAttrs = ' defaultValue = " " ' <nl> - const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> - <nl> - const preview = getByTestId ( ' preview ' ) <nl> - <nl> - await userEvent . click ( preview ) <nl> - const input = getByTestId ( ' input ' ) <nl> - <nl> - / / preview and input do not have aria - disabled when ` Editable ` is not disabled <nl> - expect ( preview ) . not . toHaveAttribute ( ' aria - disabled ' ) <nl> - expect ( input ) . not . toHaveAttribute ( ' aria - disabled ' ) <nl> - } ) <nl> - <nl> test ( ' has the proper aria attributes when disabled ' , async ( ) = > { <nl> const inlineAttrs = ' isDisabled defaultValue = " " ' <nl> const { getByTestId } = renderComponent ( { inlineAttrs } ) <nl> 
mmm a / packages / chakra - ui - core / src / Input / Input . stories . js <nl> ppp b / packages / chakra - ui - core / src / Input / Input . stories . js <nl> / > <nl> ` <nl> } ) ) <nl> - <nl> - const variantStories = storiesOf ( ' Input / Variants ' , module ) <nl> - <nl> - variantStories . add ( ' Filled ' , ( ) = > ( { <nl> + . add ( ' Filled ' , ( ) = > ( { <nl> components : { Input } , <nl> template : ` <nl> < Input variant = " filled " placeholder = " Text goes here " > < / Input > <nl> ` <nl> } ) ) <nl> - <nl> - variantStories . add ( ' Filled ' , ( ) = > ( { <nl> + . add ( ' Filled w / custom focus and error border colors ' , ( ) = > ( { <nl> components : { Input } , <nl> template : ` <nl> < Input <nl> 
mmm a / packages / chakra - ui - docs / components / components . js <nl> ppp b / packages / chakra - ui - docs / components / components . js <nl> ' ControlBox ' , <nl> ' Divider ' , <nl> ' Drawer ' , <nl> - / / ' Editable ' , <nl> + ' Editable ' , <nl> ' Flex ' , <nl> ' FormControl ' , <nl> ' Grid ' , <nl> @ @ - 45 , 7 + 45 , 7 @ @ const components = [ <nl> ' Select ' , <nl> ' Slider ' , <nl> ' Spinner ' , <nl> - / / ' Stat ' , <nl> + ' Stat ' , <nl> ' Stack ' , <nl> ' Switch ' , <nl> ' Tabs ' , <nl> 
mmm a / packages / chakra - ui - core / src / CAccordion / CAccordion . js <nl> ppp b / packages / chakra - ui - core / src / CAccordion / CAccordion . js <nl> * The container for the accordion item <nl> * details to be revealed . <nl> * <nl> - * @ extends CPseudoBox <nl> + * @ extends CBox <nl> * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> * / <nl> const CAccordionPanel = { <nl> @ @ - 342 , 7 + 342 , 7 @ @ const CAccordionPanel = { <nl> * A chevron - down icon that rotates based on the <nl> * expanded / collapsed state . <nl> * <nl> - * @ extends CPseudoBox <nl> + * @ extends CIcon <nl> * @ see Docs https : / / vue . chakra - ui . com / accordion <nl> * / <nl> const CAccordionIcon = { <nl> 
mmm a / packages / chakra - ui - core / src / config / props / props . js <nl> ppp b / packages / chakra - ui - core / src / config / props / props . js <nl> gridTemplateRows : SNA , <nl> gridTemplateColumns : SNA , <nl> opacity : SNA , <nl> - letterSpacing : SNA , <nl> - flexShrink : SNA <nl> + letterSpacing : SNA <nl> } <nl> export default baseProps <nl> 
mmm a / packages / chakra - ui - core / src / CButton / CButton . stories . js <nl> ppp b / packages / chakra - ui - core / src / CButton / CButton . stories . js <nl> this . loading = true <nl> setTimeout ( ( ) = > { <nl> this . loading = false <nl> - / / this . buttonText = ' Sent ' <nl> - / / this . variantColor = ' green ' <nl> - } , 60000 ) <nl> + } , 3000 ) <nl> } <nl> } <nl> } ) ) <nl> 
mmm a / packages / chakra - ui - core / src / CAlertDialog / CAlertDialog . js <nl> ppp b / packages / chakra - ui - core / src / CAlertDialog / CAlertDialog . js <nl> * @ see Docs https : / / vue . chakra - ui . com / alertdialog <nl> * / <nl> const CAlertDialogOverlay = CModalOverlay <nl> - <nl> + CAlertDialogOverlay . name = ' CAlertDialogOverlay ' <nl> / * * <nl> * CAlertDialogBody component <nl> * <nl> @ @ - 117 , 6 + 117 , 7 @ @ const CAlertDialogOverlay = CModalOverlay <nl> * @ see Docs https : / / vue . chakra - ui . com / alertdialog <nl> * / <nl> const CAlertDialogBody = CModalBody <nl> + CAlertDialogBody . name = ' CAlertDialogBody ' <nl> / * * <nl> * CAlertDialogHeader component <nl> @ @ - 127 , 6 + 128 , 7 @ @ const CAlertDialogBody = CModalBody <nl> * @ see Docs https : / / vue . chakra - ui . com / alertdialog <nl> * / <nl> const CAlertDialogHeader = CModalHeader <nl> + CAlertDialogHeader . name = ' CAlertDialogHeader ' <nl> / * * <nl> * CAlertDialogFooter component <nl> @ @ - 137 , 6 + 139 , 7 @ @ const CAlertDialogHeader = CModalHeader <nl> * @ see Docs https : / / vue . chakra - ui . com / alertdialog <nl> * / <nl> const CAlertDialogFooter = CModalFooter <nl> + CAlertDialogFooter . name = ' CAlertDialogFooter ' <nl> / * * <nl> * CAlertDialogCloseButton component <nl> @ @ - 147 , 6 + 150 , 7 @ @ const CAlertDialogFooter = CModalFooter <nl> * @ see Docs https : / / vue . chakra - ui . com / alertdialog <nl> * / <nl> const CAlertDialogCloseButton = CModalCloseButton <nl> + CAlertDialogCloseButton . name = ' CAlertDialogCloseButton ' <nl> export { <nl> CAlertDialog , <nl> 
mmm a / packages / chakra - ui - docs / package . json <nl> ppp b / packages / chakra - ui - docs / package . json <nl> " emotion " : " ^ 10 . 0 . 27 " , <nl> " file - contributors " : " ^ 1 . 0 . 2 " , <nl> + " mdx - vue " : " ^ 1 . 0 . 2 " , <nl> + " mdx - vue - loader " : " ^ 1 . 0 . 2 " , <nl> " node - sass " : " ^ 4 . 13 . 1 " , <nl> " nuxt " : " ^ 2 . 0 . 0 " , <nl> " prismjs " : " ^ 1 . 19 . 0 " , <nl> 
mmm a / packages / chakra - ui - core / src / CCircularProgress / CCircularProgress . js <nl> ppp b / packages / chakra - ui - core / src / CCircularProgress / CCircularProgress . js <nl> + * Hey ! Welcome to @ chakra - ui / vue CircularProgress <nl> + * <nl> + * The Circular Progress component is used to indicates the progress for both determinate and indeterminate processes . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / circularprogress <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCircularProgress / CCircularProgress . js <nl> + * @ see A11y https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CCircularProgress / accessibility . md <nl> + * / <nl> + <nl> + <nl> import { baseProps } from ' . . / config / props ' <nl> import { forwardProps } from ' . . / utils ' <nl> import { getComputedProps } from ' . / utils / circularprogress . styles ' <nl> import CBox from ' . . / CBox ' <nl> + / * * <nl> + * CCircularProgress component <nl> + * <nl> + * The test label that displays the progress percentage in the ` CCircularProgress ` <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / circularprogress <nl> + * / <nl> const CCircularProgressLabel = { <nl> name : ' CCircularProgressLabel ' , <nl> props : baseProps , <nl> @ @ - 25 , 6 + 44 , 14 @ @ const CCircularProgressLabel = { <nl> } <nl> } <nl> + / * * <nl> + * CCircularProgressLabel component <nl> + * <nl> + * Indicates the progress for both determinate and indeterminate processes . <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / circularprogress <nl> + * / <nl> const CCircularProgress = { <nl> name : ' CCircularProgress ' , <nl> inject : [ ' $ chakraColorMode ' ] , <nl> 
mmm a / packages / chakra - ui - core / src / CCircularProgress / CCircularProgress . js <nl> ppp b / packages / chakra - ui - core / src / CCircularProgress / CCircularProgress . js <nl> * / <nl> - <nl> import { baseProps } from ' . . / config / props ' <nl> import { forwardProps } from ' . . / utils ' <nl> import { getComputedProps } from ' . / utils / circularprogress . styles ' <nl> @ @ - 39 , 6 + 38 , 9 @ @ const CCircularProgressLabel = { <nl> transform : ' translate ( - 50 % , - 50 % ) ' , <nl> fontSize : ' 0 . 25em ' , <nl> . . . forwardProps ( this . $ props ) <nl> + } , <nl> + attrs : { <nl> + ' data - chakra - component ' : ' CCircularProgressLabel ' <nl> } <nl> } , this . $ slots . default ) <nl> } <nl> @ @ - 126 , 7 + 128 , 10 @ @ const CCircularProgress = { <nl> . . . rootData . props , <nl> . . . forwardProps ( this . $ props ) <nl> } , <nl> - attrs : rootData . attrs <nl> + attrs : { <nl> + . . . rootData . attrs , <nl> + ' data - chakra - component ' : ' CCircularProgress ' <nl> + } <nl> } , [ <nl> h ( CBox , { <nl> props : svgData . props , <nl> 
mmm a / packages / chakra - ui - core / src / CControlBox / CControlBox . js <nl> ppp b / packages / chakra - ui - core / src / CControlBox / CControlBox . js <nl> * ControlBox provides style props to change it ' s styles based <nl> * on a sibling checkbox or radio input . <nl> - * It relies on a common [ CSS technique ] ( https : / / dev . to / lkopacz / create - custom - keyboard - accessible - checkboxes - 2036 ) <nl> + * <nl> + * In order to keep prerve accessiblity , it relies on a common <nl> + * [ CSS technique ] ( https : / / dev . to / lkopacz / create - custom - keyboard - accessible - checkboxes - 2036 ) <nl> * for styling custom controls . <nl> * <nl> * > For this component to work , it should have a sibling input and be contained in a label <nl> 
mmm a / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> ppp b / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> + * Hey ! Welcome to @ chakra - ui / vue Divider <nl> + * <nl> + * Dividers are used to display a thin horizontal or vertical line . <nl> + * <nl> + * @ see Docs https : / / vue . chakra - ui . com / divider <nl> + * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> + * / <nl> + <nl> import CBox from ' . . / CBox ' <nl> import { baseProps } from ' . . / config / props ' <nl> import { forwardProps } from ' . . / utils ' <nl> + / * * <nl> + * CDivider component <nl> + * <nl> + * Creates a horizontal or vertical dividing rule between sibling <nl> + * elements <nl> + * <nl> + * @ extends CBox <nl> + * @ see Docs https : / / vue . chakra - ui . com / divider <nl> + * / <nl> const CDivider = { <nl> name : ' CDivider ' , <nl> props : { <nl> 
mmm a / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> ppp b / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> * @ see Docs https : / / vue . chakra - ui . com / divider <nl> * @ see Source https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CDivider / CDivider . js <nl> + * @ see A11y https : / / github . com / chakra - ui / chakra - ui - vue / blob / master / packages / chakra - ui - core / src / CDivider / accessibility . md <nl> * / <nl> import CBox from ' . . / CBox ' <nl> @ @ - 45 , 7 + 46 , 8 @ @ const CDivider = { <nl> . . . forwardProps ( this . $ props ) <nl> } , <nl> attrs : { <nl> - ' aria - orientation ' : this . orientation <nl> + ' aria - orientation ' : this . orientation , <nl> + ' data - chakra - component ' : ' CDivider ' <nl> } <nl> } ) <nl> } <nl> 
mmm a / packages / chakra - ui - docs / static / sw . js <nl> ppp b / packages / chakra - ui - docs / static / sw . js <nl> - <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - / / Configure <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - <nl> - / / Set workbox config <nl> - workbox . setConfig ( { <nl> - ' debug ' : false <nl> - } ) <nl> - <nl> - / / Start controlling any existing clients as soon as it activates <nl> - workbox . core . clientsClaim ( ) <nl> - <nl> - / / Skip over the SW waiting lifecycle stage <nl> - workbox . core . skipWaiting ( ) <nl> - <nl> - workbox . precaching . cleanupOutdatedCaches ( ) <nl> - <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - / / Precaches <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - <nl> - / / Precache assets <nl> - <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - / / Runtime Caching <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - <nl> - / / Register route handlers for runtimeCaching <nl> - workbox . routing . registerRoute ( new RegExp ( ' / _nuxt / ' ) , new workbox . strategies . CacheFirst ( { } ) , ' GET ' ) <nl> - workbox . routing . registerRoute ( new RegExp ( ' / ' ) , new workbox . strategies . NetworkFirst ( { } ) , ' GET ' ) <nl> + / / THIS FILE SHOULD NOT BE VERSION CONTROLLED <nl> 
mmm a / packages / chakra - ui - core / src / CRadio / CRadio . stories . js <nl> ppp b / packages / chakra - ui - core / src / CRadio / CRadio . stories . js <nl> components : { CFragment , CRadio } , <nl> template : ` <nl> < div > <nl> - < CRadio value = " male " v - model = " maleChecked " defaultIsChecked name = " bee " > <nl> + < CRadio value = " male " v - model = " maleChecked " name = " bee " > <nl> Male <nl> < / CRadio > <nl> < CRadio ml = " 3 " value = " female " name = " bee " > <nl> 
mmm a / packages / chakra - ui - docs / package . json <nl> ppp b / packages / chakra - ui - docs / package . json <nl> " vue " : " ^ 2 . 6 . 11 " , <nl> " vue - live " : " ^ 1 . 5 . 1 " , <nl> + " vue - lorem - ipsum " : " ^ 0 . 0 . 1 " , <nl> " vue - meta " : " ^ 2 . 3 . 3 " , <nl> " vue - prism - editor " : " ^ 0 . 5 . 1 " , <nl> " vue - router " : " ^ 3 . 1 . 5 " <nl> 
mmm a / jest . config . js <nl> ppp b / jest . config . js <nl> ] , <nl> moduleNameMapper : { <nl> ' ^ @ / ( . * ) $ ' : ' < rootDir > / $ 1 ' , <nl> + ' @ chakra - ui / theme - vue ' : require . resolve ( ' . / packages / chakra - ui - theme / src / index . js ' ) , <nl> ' \ \ . css $ ' : require . resolve ( ' . / tests / test - utils / style - mock . js ' ) , <nl> ' breadstick ' : require . resolve ( ' . / tests / test - utils / module - mock . js ' ) <nl> } , <nl> 
mmm a / packages / chakra - ui - core / README . md <nl> ppp b / packages / chakra - ui - core / README . md <nl> - [ Chakra UI for React ] ( https : / / github . com / chakra - ui / chakra - ui ) <nl> - [ Vuetify ] ( https : / / vuetifyjs . org ) <nl> - [ Buefy ] ( https : / / buefy . org ) <nl> - - [ Vuesax ] ( https : / / lusaxweb . github . io / vuesax / ) <nl> + - [ Vuesax ] ( https : / / lusaxweb . github . io / vuesax ) <nl> < a id = " contributors " > < / a > <nl> Created by [ Jonathan Bakebwa ] ( https : / / twitter . com / codebender828 ) <nl> \ No newline at end of file <nl> 
mmm a / . github / workflows / nodejs . yml <nl> ppp b / . github / workflows / nodejs . yml <nl> uses : actions / setup - node @ v1 <nl> with : <nl> node - version : $ { { matrix . node - version } } <nl> - - run : yarn bootstrap - - frozen - lockfile <nl> + - run : yarn install - - frozen - lockfile <nl> + - run : yarn bootstrap <nl> - run : yarn build - - if - present <nl> - run : yarn test <nl> env : <nl> 
mmm a / packages / chakra - ui - docs / router . js <nl> ppp b / packages / chakra - ui - docs / router . js <nl> mixpanel . init ( MIXPANEL_TOKEN ) <nl> Vue . prototype . $ mixpanel = mixpanel <nl> - <nl> - / / router . afterEach ( to = > { <nl> - / / ( process . env . NODE_ENV ! = = ' production ' ) & & console . log ( { to } ) <nl> - / / const { path : page , . . . rest } = to <nl> - / / mixpanel . track ( ' Page View ' , { page , . . . rest } ) <nl> - / / } ) <nl> - <nl> return router <nl> } <nl> 
mmm a / packages / chakra - ui - docs / plugins / analytics . js <nl> ppp b / packages / chakra - ui - docs / plugins / analytics . js <nl> import mixpanel from ' mixpanel - browser ' <nl> - const MIXPANEL_TOKEN = process . env . MIXPANEL_TOKEN <nl> - <nl> - mixpanel . init ( MIXPANEL_TOKEN ) <nl> - <nl> - export default ( { app } ) = > { <nl> + export default ( { app , env } ) = > { <nl> + try { <nl> + mixpanel . init ( env . MIXPANEL_TOKEN ) <nl> Vue . prototype . $ mixpanel = mixpanel <nl> + } catch ( error ) { <nl> + console . error ( ' Error initializing docs analytics ' , error ) <nl> + } <nl> app . router . afterEach ( to = > { <nl> try { <nl> 
mmm a / packages / chakra - ui - docs / layouts / default . vue <nl> ppp b / packages / chakra - ui - docs / layouts / default . vue <nl> watch : { <nl> ' $ route . path ' ( newVal ) { <nl> this . $ nextTick ( ( ) = > { <nl> - console . log ( this . $ refs . docContainer ) <nl> this . $ refs . docContainer . $ el . scrollTo ( 0 , 0 ) <nl> } ) <nl> } <nl> 
mmm a / packages / chakra - ui - docs / layouts / default . vue <nl> ppp b / packages / chakra - ui - docs / layouts / default . vue <nl> < / keep - alive > <nl> < Footer v - if = " $ route . path = = = ' / ' " / > <nl> - < ! - - < FileContributors / > - - > <nl> + < FileContributors / > <nl> < / CBox > <nl> < / CFlex > <nl> < / CBox > <nl> @ @ - 52 , 14 + 52 , 14 @ @ import MDXComponents from ' . . / components / MDXComponents ' <nl> import Navbar from ' . . / components / Navbar ' <nl> import Sidebar from ' . . / components / Sidebar ' <nl> import Footer from ' . . / components / Footer ' <nl> - / / import FileContributors from ' . . / components / FileContributors ' <nl> + import FileContributors from ' . . / components / FileContributors ' <nl> / / import { stringToUrl } from ' . . / utils ' <nl> export default { <nl> name : ' DefaultLayout ' , <nl> components : { <nl> - / / FileContributors , <nl> + FileContributors , <nl> MDXProvider , <nl> CThemeProvider , <nl> CColorModeProvider , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " @ babel / plugin - transform - parameters " : " ^ 7 . 7 . 4 " , <nl> " @ babel / preset - env " : " ^ 7 . 9 . 5 " , <nl> - " @ chakra - ui / vue " : " ^ 0 . 4 . 1 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 5 . 2 " , <nl> " @ commitlint / cli " : " ^ 8 . 2 . 0 " , <nl> " @ commitlint / config - conventional " : " ^ 8 . 2 . 0 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> 
mmm a / packages / nuxt - chakra / package . json <nl> ppp b / packages / nuxt - chakra / package . json <nl> " lint " : " eslint - - ext . js , . vue . " , <nl> " release " : " yarn test & & standard - version " , <nl> - " test " : " yarn lint & & jest " <nl> + " test " : " jest " <nl> } , <nl> " dependencies " : { <nl> " @ chakra - ui / vue " : " ^ 0 . 5 . 3 " , <nl> 
mmm a / packages / chakra - ui - core / src / Chakra / index . js <nl> ppp b / packages / chakra - ui - core / src / Chakra / index . js <nl> + import { merge } from ' lodash - es ' <nl> import { parsePackIcons } from ' . . / utils / icons ' <nl> import internalIcons from ' . . / lib / internal - icons ' <nl> import defaultTheme from ' . . / . . / . . / chakra - ui - theme / src ' <nl> - import VScrollLock from ' v - scroll - lock ' <nl> - import { merge } from ' lodash - es ' <nl> import useToast from ' . . / CToast ' <nl> / * * <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> } , <nl> " scripts " : { <nl> - " postinstall " : " yarn test & & yarn build : dev & & yarn theme : dev & & lerna link " , <nl> + " postinstall " : " yarn build : dev & & yarn theme : dev & & lerna link " , <nl> " build : dev " : " yarn workspace @ chakra - ui / vue run rollup - - config rollup . dev . config . js " , <nl> " build " : " yarn workspace @ chakra - ui / vue build " , <nl> " dev " : " yarn workspace @ chakra - ui / vue dev " , <nl> 
mmm a / packages / chakra - ui - core / src / CStack / CStack . stories . js <nl> ppp b / packages / chakra - ui - core / src / CStack / CStack . stories . js <nl> - import { CHeading , CText , CStack , CBox } from ' . . ' <nl> + import { CHeading , CText , CStack , CBox , CFlex , CIcon } from ' . . ' <nl> storiesOf ( ' UI | Stack ' , module ) <nl> . add ( ' With vertical stack ' , ( ) = > ( { <nl> @ @ - 36 , 3 + 36 , 20 @ @ storiesOf ( ' UI | Stack ' , module ) <nl> < / div > <nl> ` <nl> } ) ) <nl> + . add ( ' Nesting Flex in stack ' , ( ) = > ( { <nl> + components : { CHeading , CText , CStack , CBox , CFlex , CIcon } , <nl> + template : ` <nl> + < div > <nl> + < c - stack is - inline spacing = " 3 " > <nl> + < c - flex align - items = " center " > <nl> + < c - icon mr = " 3 " name = " sun " / > <nl> + < c - text > Kitchener , ON , Canada < / c - text > <nl> + < / c - flex > <nl> + < c - flex align - items = " center " > <nl> + < c - icon mr = " 3 " name = " sun " / > <nl> + < c - text > Kitchener , ON , Canada < / c - text > <nl> + < / c - flex > <nl> + < / c - stack > <nl> + < / div > <nl> + ` <nl> + } ) ) <nl> 
mmm a / packages / nuxt - chakra / test / module . spec . js <nl> ppp b / packages / nuxt - chakra / test / module . spec . js <nl> const customTheme = require ( ' . . / example / utils / theme ' ) <nl> - / * * <nl> - * nuxtjs / module - test - utils is unable <nl> - * to fully support some of the recent nuxtjs <nl> - * features like module resolving inside the <nl> - * nuxt module . <nl> - * <nl> - * Without this working properly <nl> - * it makes developing on top of the tests <nl> - * unreliable . <nl> - * <nl> - * I ' ve spoken to the Nuxt team about this <nl> - * and I they ' re making some improvemtns <nl> - * to the @ nuxtjs / module - test - utils <nl> - * package . <nl> - * <nl> - * Since this is still something to be <nl> - * improved , I hope to run these tests again . re <nl> - * <nl> - * Contributions are welcome ! <nl> - * / <nl> + <nl> describe ( ' module ' , ( ) = > { <nl> let nuxt <nl> 
mmm a / packages / chakra - ui - core / src / CAspectRatioBox / tests / CAspectRatioBox . test . js <nl> ppp b / packages / chakra - ui - core / src / CAspectRatioBox / tests / CAspectRatioBox . test . js <nl> function getElementStyles ( selector ) { <nl> selector = new RegExp ( selector ) <nl> let styles = [ ] <nl> - let i ; let j ; let sel = selector <nl> + let i ; let j ; const sel = selector <nl> for ( i = 0 ; i < document . styleSheets . length ; + + i ) { <nl> for ( j = 0 ; j < document . styleSheets [ i ] . cssRules . length ; + + j ) { <nl> if ( sel . test ( document . styleSheets [ i ] . cssRules [ j ] . selectorText ) ) { <nl> / / let selectorText = document . styleSheets [ i ] . cssRules [ j ] . selectorText <nl> - let cssText = document . styleSheets [ i ] . cssRules [ j ] . style . cssText <nl> + const cssText = document . styleSheets [ i ] . cssRules [ j ] . style . cssText <nl> styles + = cssText <nl> } <nl> } <nl> @ @ - 49 , 8 + 49 , 8 @ @ it ( ' should render correctly ' , ( ) = > { <nl> ` . trim ( ) ) <nl> } ) <nl> - it ( ' should have correct styles ' , async ( ) = > { <nl> - const inlineAttrs = ` : ratio = " 2 " ` <nl> + it ( ' should have correct styles ' , ( ) = > { <nl> + const inlineAttrs = ' : ratio = " 2 " ' <nl> renderComponent ( { inlineAttrs } ) <nl> const image = screen . getByTestId ( ' image ' ) <nl> const aspectRatioBox = screen . getByTestId ( ' aspectRatioBox ' ) <nl> 
mmm a / packages / chakra - ui - core / src / CButtonGroup / tests / CButtonGroup . test . js <nl> ppp b / packages / chakra - ui - core / src / CButtonGroup / tests / CButtonGroup . test . js <nl> - import { render , screen } from ' @ / tests / test - utils ' <nl> + import { render } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> 
mmm a / packages / chakra - ui - core / src / CAccordion / tests / CAccordion . test . js <nl> ppp b / packages / chakra - ui - core / src / CAccordion / tests / CAccordion . test . js <nl> - import { render , userEvent , fireEvent , screen } from ' @ / tests / test - utils ' <nl> + import { render , userEvent , screen } from ' @ / tests / test - utils ' <nl> const renderComponent = ( props ) = > { <nl> const base = { <nl> @ @ - 177 , 7 + 177 , 6 @ @ it ( ' tab moves focus to the next focusable element ' , async ( ) = > { <nl> expect ( last ) . toHaveFocus ( ) <nl> } ) <nl> - <nl> it ( ' shift + tab moves focus to the previous focusable element ' , async ( ) = > { <nl> renderComponent ( { <nl> template : ` <nl> 
mmm a / packages / chakra - ui - core / src / CAspectRatioBox / tests / CAspectRatioBox . test . js <nl> ppp b / packages / chakra - ui - core / src / CAspectRatioBox / tests / CAspectRatioBox . test . js <nl> return render ( base ) <nl> } <nl> - xit ( ' should render correctly ' , ( ) = > { <nl> + it ( ' should render correctly ' , ( ) = > { <nl> const inlineAttrs = ' : ratio = " 1 " ' <nl> const { asFragment } = renderComponent ( { inlineAttrs } ) <nl> expect ( asFragment ( ) ) . toMatchSnapshot ( ) <nl> 
mmm a / packages / chakra - ui - core / src / CImage / CImage . js <nl> ppp b / packages / chakra - ui - core / src / CImage / CImage . js <nl> return h ( CNoSsr , [ <nl> h ( ' img ' , { <nl> class : this . className , <nl> - / / domProps : { <nl> - / / . . . imageProps <nl> - / / } , <nl> attrs : { <nl> . . . imageProps , <nl> . . . this . computedAttrs , <nl> 
mmm a / . eslintrc . js <nl> ppp b / . eslintrc . js <nl> curly : ' off ' , <nl> ' testing - library / no - debug ' : ' error ' , <nl> ' testing - library / prefer - screen - queries ' : ' error ' , <nl> - ' testing - library / await - fire - event ' : ' error ' <nl> + ' testing - library / await - fire - event ' : ' error ' , <nl> + indent : [ <nl> + ' error ' , <nl> + 2 , <nl> + { <nl> + SwitchCase : 1 , <nl> + ignoredNodes : [ <nl> + ' TemplateLiteral ' <nl> + ] <nl> + } <nl> + ] , <nl> + ' template - curly - spacing ' : 0 <nl> } , <nl> parserOptions : { <nl> parser : ' babel - eslint ' <nl> 
mmm a / packages / chakra - ui - core / src / CButton / utils / button . props . js <nl> ppp b / packages / chakra - ui - core / src / CButton / utils / button . props . js <nl> size : { <nl> type : String , <nl> default : ' md ' , <nl> - validator : value = > value . match ( / ^ ( sm | md | lg ) $ / ) <nl> + validator : value = > value . match ( / ^ ( xs | sm | md | lg ) $ / ) <nl> } , <nl> loadingText : { <nl> type : String , <nl> 
mmm a / packages / chakra - ui - core / src / CFlex / CFlex . stories . js <nl> ppp b / packages / chakra - ui - core / src / CFlex / CFlex . stories . js <nl> . add ( ' Flex grow ' , ( ) = > ( { <nl> components : { CFlex , CBox , CText } , <nl> template : ` <nl> - < CFlex align = " center " > <nl> - < CBox rounded - top = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 1 < / CBox > <nl> - < CBox rounded - right = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 2 < / CBox > <nl> - < CBox rounded - bottom = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 3 < / CBox > <nl> - < CBox rounded - right = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 4 < / CBox > <nl> - < CBox border - top - right - radius = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 5 < / CBox > <nl> - < CBox border - top - left - radius = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 6 < / CBox > <nl> - < CBox border - bottom - right - radius = " lg " p = " 3 " w = " 20 " mr = " 3 " h = " 20 " bg = " blue . 100 " > 7 < / CBox > <nl> - < CBox border - bottom - left - radius = " lg " p = " 3 " w = " 20 " h = " 20 " bg = " blue . 100 " > 8 < / CBox > <nl> + < CFlex w = " 600px " align = " center " > <nl> + < CBox flex - grow = " 2 " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 1 < / CBox > <nl> + < CBox rounded - top = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 1 < / CBox > <nl> + < CBox rounded - right = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 2 < / CBox > <nl> + < CBox rounded - bottom = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 3 < / CBox > <nl> + < CBox rounded - right = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 4 < / CBox > <nl> + < CBox border - top - right - radius = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 5 < / CBox > <nl> + < CBox border - top - left - radius = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 6 < / CBox > <nl> + < CBox border - bottom - right - radius = " lg " w = " 10 " mr = " 3 " h = " 10 " bg = " blue . 100 " > 7 < / CBox > <nl> + < CBox border - bottom - left - radius = " lg " w = " 10 " h = " 10 " bg = " blue . 100 " > 8 < / CBox > <nl> < / CFlex > <nl> ` <nl> } ) ) <nl> 
mmm a / packages / chakra - ui - core / CHANGELOG . md <nl> ppp b / packages / chakra - ui - core / CHANGELOG . md <nl> + # # 0 . 6 . 3 <nl> + <nl> + # # # Patch Changes <nl> + <nl> + - fix : includes missing style props for border - radius and flex - grow style declarations " <nl> + <nl> # # 0 . 6 . 2 <nl> # # # Patch Changes <nl> 
mmm a / website / package . json <nl> ppp b / website / package . json <nl> " dependencies " : { <nl> " @ chakra - ui / theme - vue " : " ^ 0 . 2 . 7 " , <nl> - " @ chakra - ui / vue " : " ^ 0 . 6 . 4 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 6 . 5 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> " @ fortawesome / free - solid - svg - icons " : " ^ 5 . 11 . 2 " , <nl> " @ mdx - js / vue - loader " : " ^ 1 . 6 . 1 " , <nl> 
mmm a / packages / chakra - ui - core / package . json <nl> ppp b / packages / chakra - ui - core / package . json <nl> " focus - trap " : " ^ 5 . 1 . 0 " , <nl> " focus - trap - vue " : " ^ 0 . 0 . 4 " , <nl> - " known - css - properties " : " ^ 0 . 20 . 0 " , <nl> " lodash - es " : " ^ 4 . 17 . 15 " , <nl> " portal - vue " : " ^ 2 . 1 . 6 " , <nl> " styled - system " : " ^ 5 . 1 . 2 " , <nl> 
mmm a / yarn . lock <nl> ppp b / yarn . lock <nl> resolved " https : / / registry . yarnpkg . com / kleur / - / kleur - 3 . 0 . 3 . tgz # a79c9ecc86ee1ce3fa6206d1216c501f147fc07e " <nl> integrity sha512 - eTIzlVOSUR + JxdDFepEYcBMtZ9Qqdef + rnzWdRZuMbOywu5tO2w2N7rqjoANZ5k9vywhL6Br1VRjUIgTQx4E8w = = <nl> - known - css - properties @ ^ 0 . 20 . 0 : <nl> - version " 0 . 20 . 0 " <nl> - resolved " https : / / registry . yarnpkg . com / known - css - properties / - / known - css - properties - 0 . 20 . 0 . tgz # 0570831661b47dd835293218381166090ff60e96 " <nl> - integrity sha512 - URvsjaA9ypfreqJ2 / ylDr5MUERhJZ + DhguoWRr2xgS5C7aGCalXo + ewL + GixgKBfhT2vuL02nbIgNGqVWgTOYw = = <nl> - <nl> last - call - webpack - plugin @ ^ 3 . 0 . 0 : <nl> version " 3 . 0 . 0 " <nl> resolved " https : / / registry . yarnpkg . com / last - call - webpack - plugin / - / last - call - webpack - plugin - 3 . 0 . 0 . tgz # 9742df0e10e3cf46e5c0381c2de90d3a7a2d7555 " <nl> 
mmm a / packages / chakra - ui - core / src / CReset / CReset . js <nl> ppp b / packages / chakra - ui - core / src / CReset / CReset . js <nl> color : theme . colors . gray [ 800 ] , <nl> bg : undefined , <nl> borderColor : theme . colors . gray [ 200 ] , <nl> - placeholderColor : theme . colors . gray [ 400 ] , <nl> - fontFamily : theme . fonts . body <nl> + placeholderColor : theme . colors . gray [ 400 ] <nl> } , <nl> dark : { <nl> color : theme . colors . whiteAlpha [ 900 ] , <nl> bg : theme . colors . gray [ 800 ] , <nl> borderColor : theme . colors . whiteAlpha [ 300 ] , <nl> - placeholderColor : theme . colors . whiteAlpha [ 400 ] , <nl> - fontFamily : theme . fonts . body <nl> + placeholderColor : theme . colors . whiteAlpha [ 400 ] <nl> } <nl> } ) <nl> @ @ - 61 , 14 + 59 , 13 @ @ const CReset = { <nl> } <nl> } , <nl> created ( ) { <nl> - const { color , bg , borderColor , placeholderColor , fontFamily } = this . styleConfig [ this . colorMode ] <nl> + const { color , bg , borderColor , placeholderColor } = this . styleConfig [ this . colorMode ] <nl> useTailwindPreflight ( this . theme ) <nl> injectGlobal ( { <nl> html : { <nl> lineHeight : 1 . 5 , <nl> color , <nl> - backgroundColor : bg , <nl> - fontFamily <nl> + backgroundColor : bg <nl> } , <nl> ' * , * : : before , * : : after ' : { <nl> 
mmm a / . storybook / config . js <nl> ppp b / . storybook / config . js <nl> } from ' @ fortawesome / free - brands - svg - icons ' <nl> Vue . use ( Chakra , { <nl> - extendTheme : { <nl> - fonts : { <nl> - heading : " ' Comic Sans MS ' " , <nl> - body : " ' Comic Sans MS ' " , <nl> - monospace : " ' Comic Sans MS ' " <nl> - } <nl> - } , <nl> icons : { <nl> iconPack : ' fa ' , <nl> iconSet : { <nl> 
mmm a / website / package . json <nl> ppp b / website / package . json <nl> " dependencies " : { <nl> " @ chakra - ui / theme - vue " : " ^ 0 . 2 . 7 " , <nl> - " @ chakra - ui / vue " : " ^ 0 . 6 . 5 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 6 . 6 " , <nl> " @ fortawesome / free - brands - svg - icons " : " ^ 5 . 12 . 0 " , <nl> " @ fortawesome / free - solid - svg - icons " : " ^ 5 . 11 . 2 " , <nl> " @ mdx - js / vue - loader " : " ^ 1 . 6 . 1 " , <nl> 
mmm a / yarn . lock <nl> ppp b / yarn . lock <nl> version " 0 . 2 . 28 " <nl> - resolved " https : / / npm . fontawesome . com / @ fortawesome / fontawesome - common - types / - / 0 . 2 . 28 / fontawesome - common - types - 0 . 2 . 28 . tgz # 1091bdfe63b3f139441e9cba27aa022bff97d8b2 " <nl> + resolved " https : / / registry . yarnpkg . com / @ fortawesome / fontawesome - common - types / - / 0 . 2 . 28 / fontawesome - common - types - 0 . 2 . 28 . tgz # 1091bdfe63b3f139441e9cba27aa022bff97d8b2 " <nl> integrity sha512 - gtis2 / 5yLdfI6n0ia0jH7NJs5i / Z / 8M / ZbQL6jXQhCthEOe5Cr5NcQPhgTvFxNOtURE03 / ZqUcEskdn2M + QaBg = = <nl> " @ fortawesome / free - brands - svg - icons @ ^ 5 . 12 . 0 " : <nl> version " 5 . 13 . 0 " <nl> - resolved " https : / / npm . fontawesome . com / @ fortawesome / free - brands - svg - icons / - / 5 . 13 . 0 / free - brands - svg - icons - 5 . 13 . 0 . tgz # e79de73ba6555055204828dca9c0691e7ce5242b " <nl> + resolved " https : / / registry . yarnpkg . com / @ fortawesome / free - brands - svg - icons / - / 5 . 13 . 0 / free - brands - svg - icons - 5 . 13 . 0 . tgz # e79de73ba6555055204828dca9c0691e7ce5242b " <nl> integrity sha512 - / 6xXiJFCMEQxqxXbL0FPJpwq5Cv6MRrjsbJEmH / t5vOvB4dILDpnY0f7zZSlA8 + TG7jwlt12miF / yZpZkykucA = = <nl> dependencies : <nl> " @ fortawesome / fontawesome - common - types " " ^ 0 . 2 . 28 " <nl> " @ fortawesome / free - solid - svg - icons @ ^ 5 . 11 . 2 " : <nl> version " 5 . 13 . 0 " <nl> - resolved " https : / / npm . fontawesome . com / @ fortawesome / free - solid - svg - icons / - / 5 . 13 . 0 / free - solid - svg - icons - 5 . 13 . 0 . tgz # 44d9118668ad96b4fd5c9434a43efc5903525739 " <nl> + resolved " https : / / registry . yarnpkg . com / @ fortawesome / free - solid - svg - icons / - / 5 . 13 . 0 / free - solid - svg - icons - 5 . 13 . 0 . tgz # 44d9118668ad96b4fd5c9434a43efc5903525739 " <nl> integrity sha512 - IHUgDJdomv6YtG4p3zl1B5wWf9ffinHIvebqQOmV3U + 3SLw4fC + LUCCgwfETkbTtjy5 / Qws2VoVf6z / ETQpFpg = = <nl> dependencies : <nl> " @ fortawesome / fontawesome - common - types " " ^ 0 . 2 . 28 " <nl> 
mmm a / website / package . json <nl> ppp b / website / package . json <nl> " dependencies " : { <nl> " @ chakra - ui / theme - vue " : " ^ 0 . 2 . 7 " , <nl> - " @ chakra - ui / vue " : " ^ 0 . 7 . 0 - next . 0 " , <nl> + " @ chakra - ui / vue " : " ^ 0 . 7 . 0 - next . 2 " , <nl> " @ emotion / css " : " ^ 11 . 0 . 0 " , <nl> " @ mdx - js / vue - loader " : " ^ 1 . 6 . 1 " , <nl> " @ nuxtjs / dotenv " : " ^ 1 . 4 . 0 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> ] , <nl> " nohoist " : [ <nl> - " core - js " <nl> + " core - js " , <nl> + " @ chakra - ui / vue " <nl> ] <nl> } , <nl> " scripts " : { <nl> " evalbundle " : " bundlesize " <nl> } , <nl> " dependencies " : { <nl> + " @ chakra - ui / vue " : " ^ 0 . 7 . 0 - next . 2 " , <nl> " @ babel / core " : " ^ 7 . 9 . 0 " , <nl> " @ babel / plugin - proposal - object - rest - spread " : " ^ 7 . 7 . 4 " , <nl> " @ babel / plugin - transform - modules - commonjs " : " ^ 7 . 7 . 4 " , <nl> 
mmm a / packages / chakra - ui - nuxt / package . json <nl> ppp b / packages / chakra - ui - nuxt / package . json <nl> } , <nl> " dependencies " : { <nl> - " @ chakra - ui / vue " : " ^ 0 . 7 . 0 - next . 2 " , <nl> + " @ chakra - ui / vue " : " latest " , <nl> " chakra - loader " : " latest " , <nl> " @ emotion / css " : " ^ 11 . 0 . 0 " <nl> } , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test : module " : " yarn workspace @ chakra - ui / nuxt test " , <nl> " test " : " yarn test : core & & yarn test : module " , <nl> - " publish - ci " : " git add - A & & git commit - m \ " chore ( lerna ) : publishing package \ " & & lerna publish from - package - y - - no - verify - access " , <nl> + " publish - ci " : " changeset publish " , <nl> " clean " : " lerna run clean " , <nl> " storybook " : " cross - env STORYBOOK_VUE_DEV_TOOLS = 1 start - storybook - p 9000 " , <nl> " storybook : devtools " : " vue - devtools " , <nl> 
mmm a / packages / chakra - ui - nuxt / lib / module . js <nl> ppp b / packages / chakra - ui - nuxt / lib / module . js <nl> / / Icons <nl> const icons = { <nl> - . . . internalIcons . default , <nl> + . . . internalIcons , <nl> . . . packIcons , <nl> . . . ( options . icons & & options . icons . extend ) <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test : module " : " yarn workspace @ chakra - ui / nuxt test " , <nl> " test " : " yarn test : core & & yarn test : module " , <nl> - " release " : " changeset publish " , <nl> + " release " : " yarn changeset publish " , <nl> " clean " : " lerna run clean " , <nl> " storybook " : " cross - env STORYBOOK_VUE_DEV_TOOLS = 1 start - storybook - p 9000 " , <nl> " storybook : devtools " : " vue - devtools " , <nl> 
mmm a / packages / chakra - ui - core / src / CImage / tests / CImage . test . js <nl> ppp b / packages / chakra - ui - core / src / CImage / tests / CImage . test . js <nl> expect ( screen . getByAltText ( / Mesut Koca / i ) ) . toHaveAttribute ( ' src ' , ' LOAD_FALLBACK_SRC ' ) <nl> } ) <nl> } ) <nl> + <nl> + it ( ' srcset works ' , async ( ) = > { <nl> + renderComponent ( { template : ' < CImage alt = " My Image Description " src = " LOAD_SUCCESS_SRC " srcset = " LOAD_SUCCESS_SRC 400w " / > ' } ) <nl> + await wait ( ( ) = > { <nl> + expect ( screen . getByAltText ( / My Image Description / i ) ) . toHaveAttribute ( ' srcset ' , ' LOAD_SUCCESS_SRC 400w ' ) <nl> + } ) <nl> + } ) <nl> 
mmm a / packages / chakra - ui - core / src / CThemeProvider / tests / CThemeProvider . test . js <nl> ppp b / packages / chakra - ui - core / src / CThemeProvider / tests / CThemeProvider . test . js <nl> import { mount , shallowMount } from ' @ vue / test - utils ' <nl> import theme from ' @ chakra - ui / theme - vue ' <nl> - import { getElementStyles } from ' @ / tests / test - utils ' <nl> - <nl> import CThemeProvider from ' . . ' <nl> + import { getElementStyles } from ' @ / tests / test - utils ' <nl> describe ( ' CThemeProvider ' , ( ) = > { <nl> const ChildComponent = { <nl> 
mmm a / . codesandbox / ci . json <nl> ppp b / . codesandbox / ci . json <nl> " packages " : [ <nl> " packages / chakra - ui - core " , <nl> - " packages / chakra - ui - nuxt " <nl> + " packages / chakra - ui - nuxt " , <nl> + " packages / chakra - ui - theme " <nl> ] , <nl> " sandboxes " : [ " chakra - ui - vue - 0x - starter - template - 2sy0g " , " chakra - ui - nuxt - demo - f8tq4 " ] , <nl> " node " : " 14 " <nl> 
mmm a / website / package . json <nl> ppp b / website / package . json <nl> " prismjs " : " ^ 1 . 19 . 0 " , <nl> " sass - loader " : " ^ 8 . 0 . 2 " , <nl> - " vue " : " ^ 2 . 6 . 12 " , <nl> " vue - error - boundary " : " ^ 1 . 0 . 3 " , <nl> " vue - live " : " 1 . 5 . 1 " , <nl> " vue - lorem - ipsum " : " ^ 0 . 0 . 1 " , <nl> 
mmm a / website / nuxt . config . js <nl> ppp b / website / nuxt . config . js <nl> } , <nl> babel : { <nl> plugins : [ <nl> + [ ' @ babel / plugin - proposal - private - property - in - object ' , { loose : true } ] , <nl> ' @ babel / plugin - proposal - optional - chaining ' <nl> ] <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / utils / icons . js <nl> ppp b / packages / chakra - ui - core / src / utils / icons . js <nl> / * * <nl> - * @ description Parse FontAwesome icon path <nl> - * @ param { String | Array } path a single svg path , or array of paths <nl> - * @ returns { String } <nl> + * @ param { String } pack <nl> + * @ param { Array } icon <nl> + * @ returns { { path : string , viewBox : string , attrs : * } } <nl> * / <nl> - const parseFontAwesomeIcon = ( path ) = > { <nl> - / / duotone icon <nl> - if ( Array . isArray ( path ) & & path . length = = = 2 ) { <nl> - const paths = path . map ( ( d , idx ) = > <nl> - ` < path d = " $ { d } " fill = " currentColor " class = " $ { idx ? ' fa - primary ' : ' fa - secondary ' } " / > ` <nl> + const createIcon = ( pack , icon ) = > { <nl> + const [ w , h , content , svg , data , , attrs ] = icon <nl> + let path <nl> + <nl> + const createPath = ( d , attrs = { } ) = > ` < path d = " $ { d } " $ { attrs . className ? ` class = " $ { attrs . className } " ` : ' ' } fill = " currentColor " / > ` <nl> + <nl> + const createGroupedPath = ( groups , prefix ) = > { <nl> + const paths = groups . map ( ( d , idx ) = > <nl> + createPath ( d , { <nl> + className : idx ? ` $ { prefix } - primary ` : ` $ { prefix } - secondary ` , <nl> + } ) <nl> ) <nl> - return ` < defs > < style > . fa - secondary { opacity : . 4 } < / style > < / defs > < g class = " fa - group " > $ { paths . join ( ' ' ) } < / g > ` <nl> + return ` < g fill = " currentColor " class = " $ { prefix } - group " > $ { paths . join ( ' ' ) } < / g > ` <nl> } <nl> - return ` < path d = " $ { path } " fill = " currentColor " / > ` <nl> + if ( pack = = = ' fa ' ) { <nl> + path = Array . isArray ( data ) <nl> + ? createGroupedPath ( data , pack ) <nl> + : createPath ( data ) <nl> + } else { <nl> + path = pack . startsWith ( ' fe ' ) ? content : svg <nl> + } <nl> + <nl> + return { <nl> + path , <nl> + viewBox : ` 0 0 $ { w } $ { h } ` , <nl> + attrs , <nl> + } <nl> } <nl> / * * <nl> * @ description Custom parse all Icons provided by user <nl> + * @ param { String } pack - the name of the icon pack being used ( fe , fa , mdi , etc ) <nl> * @ param { Object } iconSet - Registered Icons object <nl> * @ returns { Object } <nl> * / <nl> - const parseIcons = ( iconSet = { } ) = > { <nl> + const parseIcons = ( pack , iconSet = { } ) = > { <nl> const parseIcon = ( iconObject ) = > { <nl> - const { icon } = iconObject <nl> + const { icon , iconName } = iconObject <nl> / / Is library icon <nl> if ( icon ) { <nl> - const [ w , h , content , svg , path , , attrs ] = icon <nl> return { <nl> - [ ` $ { iconObject . iconName } ` ] : { <nl> - path : iconObject . prefix . startsWith ( ' fa ' ) <nl> - ? parseFontAwesomeIcon ( path ) <nl> - : iconObject . prefix . startsWith ( ' fe ' ) <nl> - ? content <nl> - : svg , <nl> - viewBox : ` 0 0 $ { w } $ { h } ` , <nl> - attrs <nl> - } <nl> + [ ` $ { iconName } ` ] : createIcon ( pack , icon ) <nl> } <nl> } else { <nl> return { } <nl> } <nl> } <nl> - const result = Object . values ( iconSet ) <nl> + return Object . values ( iconSet ) <nl> . map ( value = > parseIcon ( value ) ) <nl> . reduce ( ( target , source ) = > merge ( target , source ) , { } ) <nl> - <nl> - return result <nl> } <nl> / * * <nl> * @ description Parse Icon packs <nl> - * @ param { String } pack Icon pack name <nl> + * @ param { String } pack - the name of the icon pack being used ( fe , fa , mdi , etc ) <nl> * @ param { Object } iconSet Registered Icon set <nl> * @ returns { Object } Parsed pack icons object <nl> * / <nl> - export const parsePackIcons = ( iconSet ) = > { <nl> + export const parsePackIcons = ( pack , iconSet ) = > { <nl> / / TODO : Add support for other icon libraries <nl> - / / - Material Icons <nl> + / / - Material Icons : these are string constants , and need lots of work <nl> / / - Tailwind Icons ( Hero icons ) <nl> - const packIcons = parseIcons ( iconSet ) <nl> - return packIcons <nl> + return parseIcons ( pack , iconSet ) <nl> } <nl> 
mmm a / packages / chakra - ui - core / src / CTextarea / CTextarea . stories . js <nl> ppp b / packages / chakra - ui - core / src / CTextarea / CTextarea . stories . js <nl> mt = " 2 " <nl> placeholder = " Here is a sample placeholder " <nl> size = " md " <nl> + @ change = " handleChange " <nl> : value = " textareaContent " <nl> / > <nl> < / CBox > <nl> 
mmm a / test / tests / razzle - start . test . js <nl> ppp b / test / tests / razzle - start . test . js <nl> const kill = require ( ' . . / utils / psKill ' ) ; <nl> const path = require ( ' path ' ) ; <nl> - / / shell . config . silent = true ; <nl> + shell . config . silent = true ; <nl> describe ( ' razzle start ' , ( ) = > { <nl> describe ( ' razzle basic example ' , ( ) = > { <nl> 
mmm a / lerna . json <nl> ppp b / lerna . json <nl> " publish " : { <nl> " npmClient " : " npm " , <nl> - " allowBranch " : [ <nl> - " master " , <nl> - " canary " <nl> - ] , <nl> + " allowBranch " : [ " master " , " next " ] , <nl> " registry " : " https : / / registry . npmjs . org / " <nl> } <nl> } , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " test : e2e " : " jest - - config . / test / jest . config . json - - verbose - - no - cache " , <nl> " clean " : " lerna clean - - yes " , <nl> - " format " : " prettier - - trailing - comma es5 - - single - quote - - write ' packages / * / * . + ( js | jsx | json | yml | yaml | css | less | scss | ts | tsx | md | mdx ) ' ' packages / * / ! ( node_modules ) / * * / * . js ' " , <nl> + " format " : " prettier - - write ' packages / * / * . + ( js | jsx | json | yml | yaml | css | less | scss | ts | tsx | md | mdx ) ' ' packages / * / ! ( node_modules ) / * * / * . js ' " , <nl> " publish - canary " : " lerna version prerelease - - preid canary - - force - publish & & release - - pre " , <nl> " publish - stable " : " lerna version - - force - publish & & release & & node . / scripts / release - notes . js " , <nl> " build - docs " : " node . / scripts / build - docs . js " , <nl> } , <nl> " lint - staged " : { <nl> " * . { js | jsx | json | yml | yaml | css | less | scss | ts | tsx | md | mdx } " : [ <nl> - " prettier - - trailing - comma es5 - - single - quote - - write " <nl> + " yarn format " <nl> ] <nl> } , <nl> " dependencies " : { } , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> } , <nl> " lint - staged " : { <nl> - " * . { js | jsx | json | yml | yaml | css | less | scss | ts | tsx | md | mdx } " : [ <nl> - " prettier - - trailing - comma es5 - - single - quote - - write " , <nl> - " git add " <nl> + " * . { js , jsx , json , yml , yaml , css , less , scss , ts , tsx , md , mdx } " : [ <nl> + " prettier - - trailing - comma es5 - - single - quote - - write " <nl> ] <nl> } , <nl> " dependencies " : { } , <nl> 
mmm a / . changeset / config . json <nl> ppp b / . changeset / config . json <nl> " baseBranch " : " master " , <nl> " ignore " : [ ] , <nl> - <nl> - " changelog " : " @ changesets / cli / changelog " <nl> + " changelog " : [ " @ changesets / changelog - github " , { " repo " : " jaredpalmer / razzle " } ] <nl> } <nl> \ No newline at end of file <nl> 
mmm a / webpack . config . js <nl> ppp b / webpack . config . js <nl> rules : [ { <nl> test : / \ . jsx ? $ / , <nl> loader : ' babel - loader ' , <nl> - include : path . resolve ( __dirname , ' src ' ) <nl> + include : [ path . resolve ( __dirname , ' src ' ) , / node_modules [ \ \ / ] scratch - [ ^ \ \ / ] + [ \ \ / ] src / ] , <nl> + options : { <nl> + / / Explicitly disable babelrc so we don ' t catch various config <nl> + / / in much lower dependencies . <nl> + babelrc : false , <nl> + plugins : [ <nl> + ' syntax - dynamic - import ' , <nl> + ' transform - async - to - generator ' , <nl> + ' transform - object - rest - spread ' , <nl> + [ ' react - intl ' , { <nl> + messagesDir : ' . / translations / messages / ' <nl> + } ] ] , <nl> + presets : [ [ ' env ' , { targets : { browsers : [ ' last 3 versions ' , ' Safari > = 8 ' , ' iOS > = 8 ' ] } } ] , ' react ' ] <nl> + } <nl> } , <nl> { <nl> test : / \ . css $ / , <nl> 
mmm a / . vscode / settings . json <nl> ppp b / . vscode / settings . json <nl> " titleBar . activeForeground " : " # 15202b " , <nl> " titleBar . inactiveForeground " : " # 15202b99 " <nl> - } <nl> + } , <nl> + " cSpell . words " : [ " abbr " , " mdsvex " , " rehype " , " sveltejs " ] <nl> } <nl> 
mmm a / package - lock . json <nl> ppp b / package - lock . json <nl> " dependencies " : { <nl> " @ babel / code - frame " : { <nl> - " version " : " 7 . 12 . 11 " , <nl> - " resolved " : " https : / / registry . npmjs . org / @ babel / code - frame / - / code - frame - 7 . 12 . 11 . tgz " , <nl> - " integrity " : " sha512 - Zt1yodBx1UcyiePMSkWnU4hPqhwq7hGi2nFL1LeA3EUl + q2LQx16MISgJ0 + z7dnmgvP9QtIleuETGOiOH1RcIw = = " , <nl> + " version " : " 7 . 12 . 13 " , <nl> + " resolved " : " https : / / registry . npmjs . org / @ babel / code - frame / - / code - frame - 7 . 12 . 13 . tgz " , <nl> + " integrity " : " sha512 - HV1Cm0Q3ZrpCR93tkWOYiuYIgLxZXZFVG2VgK + MBWjUqZTundupbfx2aXarXuw5Ko5aMcjtJgbSs4vUGBS5v6g = = " , <nl> " dev " : true , <nl> " requires " : { <nl> - " @ babel / highlight " : " ^ 7 . 10 . 4 " <nl> + " @ babel / highlight " : " ^ 7 . 12 . 13 " <nl> } <nl> } , <nl> " @ babel / helper - validator - identifier " : { <nl> " integrity " : " sha1 - p9BVi9icQveV3UIyj3QIMcpTvCU = " , <nl> " dev " : true <nl> } , <nl> - " escape - string - regexp " : { <nl> - " version " : " 1 . 0 . 5 " , <nl> - " resolved " : " https : / / registry . npmjs . org / escape - string - regexp / - / escape - string - regexp - 1 . 0 . 5 . tgz " , <nl> - " integrity " : " sha1 - G2HAViGQqN / 2rjuyzwIAyhMLhtQ = " , <nl> - " dev " : true <nl> - } , <nl> " has - flag " : { <nl> " version " : " 3 . 0 . 0 " , <nl> " resolved " : " https : / / registry . npmjs . org / has - flag / - / has - flag - 3 . 0 . 0 . tgz " , <nl> " dev " : true <nl> } , <nl> " @ types / node " : { <nl> - " version " : " 15 . 6 . 1 " , <nl> - " resolved " : " https : / / registry . npmjs . org / @ types / node / - / node - 15 . 6 . 1 . tgz " , <nl> - " integrity " : " sha512 - 7EIraBEyRHEe7CH + Fm1XvgqU6uwZN8Q7jppJGcqjROMT29qhAuuOxYB1uEY5UMYQKEmA5D + 5tBnhdaPXSsLONA = = " , <nl> + " version " : " 15 . 6 . 2 " , <nl> + " resolved " : " https : / / registry . npmjs . org / @ types / node / - / node - 15 . 6 . 2 . tgz " , <nl> + " integrity " : " sha512 - dxcOx8801kMo3KlU + C + / ctWrzREAH7YvoF3aoVpRdqgs + Kf7flp + PJDN / EX5bME3suDUZHsxes9hpvBmzYlWbA = = " , <nl> " dev " : true <nl> } , <nl> " @ types / parse - json " : { <nl> } <nl> } , <nl> " caniuse - lite " : { <nl> - " version " : " 1 . 0 . 30001232 " , <nl> - " resolved " : " https : / / registry . npmjs . org / caniuse - lite / - / caniuse - lite - 1 . 0 . 30001232 . tgz " , <nl> - " integrity " : " sha512 - e4Gyp7P8vqC2qV2iHA + cJNf / yqUKOShXQOJHQt81OHxlIZl / j / j3soEA0adAQi8CPUQgvOdDENyQ5kd6a6mNSg = = " , <nl> + " version " : " 1 . 0 . 30001233 " , <nl> + " resolved " : " https : / / registry . npmjs . org / caniuse - lite / - / caniuse - lite - 1 . 0 . 30001233 . tgz " , <nl> + " integrity " : " sha512 - BmkbxLfStqiPA7IEzQpIk0UFZFf3A4E6fzjPJ6OR + bFC2L8ES9J8zGA / asoi47p8XDVkev + WJo2I2Nc8c / 34Yg = = " , <nl> " dev " : true <nl> } , <nl> " chalk " : { <nl> " dev " : true <nl> } , <nl> " escape - string - regexp " : { <nl> - " version " : " 4 . 0 . 0 " , <nl> - " resolved " : " https : / / registry . npmjs . org / escape - string - regexp / - / escape - string - regexp - 4 . 0 . 0 . tgz " , <nl> - " integrity " : " sha512 - TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA = = " , <nl> + " version " : " 1 . 0 . 5 " , <nl> + " resolved " : " https : / / registry . npmjs . org / escape - string - regexp / - / escape - string - regexp - 1 . 0 . 5 . tgz " , <nl> + " integrity " : " sha1 - G2HAViGQqN / 2rjuyzwIAyhMLhtQ = " , <nl> " dev " : true <nl> } , <nl> " eslint " : { <nl> " table " : " ^ 6 . 0 . 9 " , <nl> " text - table " : " ^ 0 . 2 . 0 " , <nl> " v8 - compile - cache " : " ^ 2 . 0 . 3 " <nl> + } , <nl> + " dependencies " : { <nl> + " @ babel / code - frame " : { <nl> + " version " : " 7 . 12 . 11 " , <nl> + " resolved " : " https : / / registry . npmjs . org / @ babel / code - frame / - / code - frame - 7 . 12 . 11 . tgz " , <nl> + " integrity " : " sha512 - Zt1yodBx1UcyiePMSkWnU4hPqhwq7hGi2nFL1LeA3EUl + q2LQx16MISgJ0 + z7dnmgvP9QtIleuETGOiOH1RcIw = = " , <nl> + " dev " : true , <nl> + " requires " : { <nl> + " @ babel / highlight " : " ^ 7 . 10 . 4 " <nl> + } <nl> + } , <nl> + " escape - string - regexp " : { <nl> + " version " : " 4 . 0 . 0 " , <nl> + " resolved " : " https : / / registry . npmjs . org / escape - string - regexp / - / escape - string - regexp - 4 . 0 . 0 . tgz " , <nl> + " integrity " : " sha512 - TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA = = " , <nl> + " dev " : true <nl> + } <nl> } <nl> } , <nl> " eslint - config - prettier " : { <nl> " escape - string - regexp " : " ^ 4 . 0 . 0 " , <nl> " unist - util - is " : " ^ 4 . 0 . 0 " , <nl> " unist - util - visit - parents " : " ^ 3 . 0 . 0 " <nl> + } , <nl> + " dependencies " : { <nl> + " escape - string - regexp " : { <nl> + " version " : " 4 . 0 . 0 " , <nl> + " resolved " : " https : / / registry . npmjs . org / escape - string - regexp / - / escape - string - regexp - 4 . 0 . 0 . tgz " , <nl> + " integrity " : " sha512 - TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA = = " , <nl> + " dev " : true <nl> + } <nl> } <nl> } , <nl> " mdast - util - to - string " : { <nl> " integrity " : " sha1 - p9BVi9icQveV3UIyj3QIMcpTvCU = " , <nl> " dev " : true <nl> } , <nl> - " escape - string - regexp " : { <nl> - " version " : " 1 . 0 . 5 " , <nl> - " resolved " : " https : / / registry . npmjs . org / escape - string - regexp / - / escape - string - regexp - 1 . 0 . 5 . tgz " , <nl> - " integrity " : " sha1 - G2HAViGQqN / 2rjuyzwIAyhMLhtQ = " , <nl> - " dev " : true <nl> - } , <nl> " has - flag " : { <nl> " version " : " 3 . 0 . 0 " , <nl> " resolved " : " https : / / registry . npmjs . org / has - flag / - / has - flag - 3 . 0 . 0 . tgz " , <nl> } <nl> } , <nl> " tailwindcss " : { <nl> - " version " : " 2 . 1 . 3 " , <nl> - " resolved " : " https : / / registry . npmjs . org / tailwindcss / - / tailwindcss - 2 . 1 . 3 . tgz " , <nl> - " integrity " : " sha512 - 434rlH / gVSm0Qhc2pQjvsQeasrcmPWEWSxyDcF66Y + CavOURsdqx3hymqqXlozs + CVWN3z + VpFV / PE9b2wx / GA = = " , <nl> + " version " : " 2 . 1 . 4 " , <nl> + " resolved " : " https : / / registry . npmjs . org / tailwindcss / - / tailwindcss - 2 . 1 . 4 . tgz " , <nl> + " integrity " : " sha512 - fh1KImDLg6se / Suaelju / 5oFbqq1b0ntagmGLu0aG9LlnNPGHgO1n / 4E57CbKcCtyz / VYnvVXUiWmfyfBBZQ6g = = " , <nl> " dev " : true , <nl> " requires " : { <nl> " @ fullhuman / postcss - purgecss " : " ^ 3 . 1 . 3 " , <nl> 
mmm a / src / routes / __layout . svelte <nl> ppp b / src / routes / __layout . svelte <nl> < / script > <nl> - < main class = " container max - w - 3xl mx - auto px - 4 sm : px - 6 lg : px - 8 " > <nl> + < div class = " container max - w - 3xl mx - auto px - 4 sm : px - 6 lg : px - 8 " > <nl> < Header / > <nl> + < main > <nl> < slot / > <nl> < / main > <nl> + < / div > <nl> 
mmm a / src / routes / [ slug ] . svelte <nl> ppp b / src / routes / [ slug ] . svelte <nl> < a <nl> class = " font - semibold text - xs underline hover : no - underline " <nl> - href = { ` https : / / github . com / spences10 / cheat - sheets / edit / production / sheets / $ { metadata . slug } . md ` } <nl> + href = { ` https : / / github . com / spences10 / cheat - sheets / edit / main / sheets / $ { metadata . slug } . md ` } <nl> > Edit this page on GitHub < / a <nl> > <nl> < / div > <nl> 
mmm a / tailwind . config . cjs <nl> ppp b / tailwind . config . cjs <nl> + const config = { <nl> mode : ' jit ' , <nl> purge : [ ' . / src / * * / * . { html , js , svelte , ts } ' ] , <nl> theme : { <nl> @ @ - 6 , 3 + 6 , 5 @ @ module . exports = { <nl> } , <nl> plugins : [ require ( ' @ tailwindcss / typography ' ) , require ( ' daisyui ' ) ] , <nl> } <nl> + <nl> + module . exports = config <nl> 
mmm a / svelte . config . js <nl> ppp b / svelte . config . js <nl> } <nl> export default config <nl> + / / Workaround until SvelteKit uses Vite 2 . 3 . 8 ( and it ' s confirmed to fix the Tailwind JIT problem ) <nl> + const mode = process . env . NODE_ENV <nl> + const dev = mode = = = ' development ' <nl> + process . env . TAILWIND_MODE = dev ? ' watch ' : ' build ' <nl> 
mmm a / mdsvex . config . js <nl> ppp b / mdsvex . config . js <nl> export default { <nl> extensions : [ ' . svx ' , ' . md ' ] , <nl> - smartypants : { <nl> - dashes : ' oldschool ' , <nl> - } , <nl> remarkPlugins : [ <nl> / / Add a text preview snippet ( no formatting ) so we can use it in the meta description tag <nl> preview ( <nl> 
mmm a / src / routes / __layout . svelte <nl> ppp b / src / routes / __layout . svelte <nl> / / https : / / mattjennings . io / blog / how - to - use - fathom - analytics - with - sveltekit <nl> - onMount ( async ( ) = > { <nl> + onMount ( ( ) = > { <nl> themeChange ( false ) <nl> Fathom . load ( import . meta . env . VITE_FATHOM_ID , { <nl> url : import . meta . env . VITE_FATHOM_URL , <nl> 
mmm a / . vscode / settings . json <nl> ppp b / . vscode / settings . json <nl> " titleBar . inactiveForeground " : " # 15202b99 " <nl> } , <nl> - " cSpell . words " : [ " abbr " , " mdsvex " , " rehype " , " sveltejs " ] <nl> + " cSpell . words " : [ <nl> + " abbr " , <nl> + " djvu " , <nl> + " EDIFACT " , <nl> + " mdsvex " , <nl> + " MHTML " , <nl> + " msvideo " , <nl> + " rehype " , <nl> + " sveltejs " , <nl> + " vercel " , <nl> + " vite " , <nl> + " webm " <nl> + ] <nl> } <nl> 
mmm a / svelte . config . js <nl> ppp b / svelte . config . js <nl> / / hydrate the < div id = " svelte " > element in src / app . html <nl> target : ' # svelte ' , <nl> adapter : adapter ( ) , <nl> + vite : { <nl> + / / https : / / vitejs . dev / config / # server - fs - allow <nl> + server : { <nl> + fs : { <nl> + / / Allow serving files from one level up to the project root <nl> + / / posts , copy <nl> + allow : [ ' . . ' ] , <nl> + } , <nl> + } , <nl> + } , <nl> } , <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " babel - plugin - lodash " : " ^ 3 . 2 . 10 " , <nl> " babel - plugin - react - transform " : " ^ 2 . 0 . 2 " , <nl> - " babel - plugin - transform - react - constant - elements " : " ^ 6 . 9 . 1 " , <nl> " babel - plugin - transform - react - handled - props " : " ^ 0 . 2 . 1 " , <nl> " babel - plugin - transform - react - remove - prop - types " : " ^ 0 . 2 . 10 " , <nl> " babel - plugin - transform - runtime " : " ^ 6 . 15 . 0 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " lint : fix " : " npm run lint - - - - fix " , <nl> " lint : watch " : " watch ' npm run lint - - silent ' docs gulp src test " , <nl> - " prerelease " : " npm run lint & & npm test & & cross - env NODE_ENV = production npm run build " , <nl> + " prerelease " : " npm run lint & & npm run tsd : lint & & npm test & & cross - env NODE_ENV = production npm run build " , <nl> " postrelease " : " NODE_ENV = production npm run deploy : docs " , <nl> " release : major " : " npm run prerelease & & ta - script npm / release . sh major & & npm run prerelease " , <nl> " release : minor " : " npm run prerelease & & ta - script npm / release . sh minor & & npm run prerelease " , <nl> 
mmm a / docs / . eslintrc <nl> ppp b / docs / . eslintrc <nl> " __PATH_SEP__ " : false , <nl> " __PROD__ " : false <nl> + } , <nl> + " rules " : { <nl> + " jsx - a11y / anchor - has - content " : 0 , <nl> + " jsx - a11y / aria - props " : 0 , <nl> + " jsx - a11y / aria - proptypes " : 0 , <nl> + " jsx - a11y / aria - role " : 0 , <nl> + " jsx - a11y / aria - unsupported - elements " : 0 , <nl> + " jsx - a11y / click - events - have - key - events " : 0 , <nl> + " jsx - a11y / heading - has - content " : 0 , <nl> + " jsx - a11y / href - no - hash " : 0 , <nl> + " jsx - a11y / html - has - lang " : 0 , <nl> + " jsx - a11y / img - has - alt " : 0 , <nl> + " jsx - a11y / img - redundant - alt " : 0 , <nl> + " jsx - a11y / label - has - for " : 0 , <nl> + " jsx - a11y / lang " : 0 , <nl> + " jsx - a11y / mouse - events - have - key - events " : 0 , <nl> + " jsx - a11y / no - access - key " : 0 , <nl> + " jsx - a11y / no - marquee " : 0 , <nl> + " jsx - a11y / no - onchange " : 0 , <nl> + " jsx - a11y / no - static - element - interactions " : 0 , <nl> + " jsx - a11y / onclick - has - focus " : 0 , <nl> + " jsx - a11y / onclick - has - role " : 0 , <nl> + " jsx - a11y / role - has - required - aria - props " : 0 , <nl> + " jsx - a11y / role - supports - aria - props " : 0 , <nl> + " jsx - a11y / scope " : 0 , <nl> + " jsx - a11y / tabindex - no - positive " : 0 <nl> } <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build : docs " : " gulp build : docs " , <nl> " build : umd " : " gulp umd " , <nl> - " build : docs - toc " : " doctoc README . md . / . github / CONTRIBUTING . md - - github - - maxlevel 4 " , <nl> + " build : docs - toc " : " doctoc . / . github / CONTRIBUTING . md - - github - - maxlevel 4 " , <nl> " build : docs - cname " : " echo react . semantic - ui . com > docs / build / CNAME " , <nl> " predeploy : docs " : " cross - env NODE_ENV = production npm run build : docs & & npm run build : docs - cname " , <nl> " deploy : docs " : " gh - pages - d docs / build - m ' deploy docs [ ci skip ] ' " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " babel - plugin - lodash " : " ^ 3 . 2 . 10 " , <nl> " babel - plugin - react - transform " : " ^ 2 . 0 . 2 " , <nl> - " babel - plugin - transform - react - handled - props " : " ^ 0 . 2 . 2 " , <nl> + " babel - plugin - transform - react - handled - props " : " ^ 0 . 2 . 3 " , <nl> " babel - plugin - transform - react - remove - prop - types " : " ^ 0 . 2 . 10 " , <nl> " babel - plugin - transform - runtime " : " ^ 6 . 15 . 0 " , <nl> " babel - preset - es2015 " : " ^ 6 . 18 . 0 " , <nl> 
mmm a / docs / app / index . ejs <nl> ppp b / docs / app / index . ejs <nl> data - presets = " es2015 , react , stage1 " <nl> > < / script > <nl> - < script src = " / / cdnjs . cloudflare . com / ajax / libs / Faker / < % = htmlWebpackPlugin . options . versions . faker % > / faker . min . js " > < / script > <nl> + < script src = " / / cdn . jsdelivr . net / faker . js / < % = htmlWebpackPlugin . options . versions . faker % > / faker . min . js " > < / script > <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / js - beautify / < % = htmlWebpackPlugin . options . versions . jsBeautify % > / beautify - html . min . js " > < / script > <nl> < ! - - Use unminified React when not in production so we get errors and warnings - - > <nl> < script src = " / / cdnjs . cloudflare . com / ajax / libs / react / < % = htmlWebpackPlugin . options . versions . react % > / react < % = __PROD__ ? ' . min ' : ' ' % > . js " > < / script > <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " require - dir " : " ^ 0 . 3 . 0 " , <nl> " rimraf " : " ^ 2 . 5 . 2 " , <nl> - " satisfied " : " ^ 1 . 0 . 0 " , <nl> + " satisfied " : " ^ 1 . 1 . 0 " , <nl> " semantic - ui - css " : " ^ 2 . 2 . 2 " , <nl> " simulant " : " ^ 0 . 2 . 2 " , <nl> " sinon " : " ^ 2 . 1 . 0 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " doctrine " : " ^ 2 . 0 . 0 " , <nl> " empty " : " ^ 0 . 10 . 1 " , <nl> - " enzyme " : " ^ 2 . 7 . 1 " , <nl> + " enzyme " : " ^ 2 . 8 . 2 " , <nl> " eslint - config - ta " : " ^ 5 . 2 . 0 " , <nl> " eslint - plugin - jsx - a11y " : " ^ 4 . 0 . 0 " , <nl> " express " : " ^ 4 . 13 . 4 " , <nl> " react - dom " : " 15 . 5 . 4 " , <nl> " react - router " : " ^ 4 . 0 . 0 " , <nl> " react - router - dom " : " ^ 4 . 0 . 0 " , <nl> + " react - test - renderer " : " ^ 15 . 5 . 4 " , <nl> " require - dir " : " ^ 0 . 3 . 0 " , <nl> " rimraf " : " ^ 2 . 5 . 2 " , <nl> " satisfied " : " ^ 1 . 1 . 0 " , <nl> 
mmm a / webpack . dll . js <nl> ppp b / webpack . dll . js <nl> webpackDllConfig . output = { <nl> path : paths . dll ( ) , <nl> filename : ` dll . [ name ] . [ $ { config . compiler_hash_type } ] . js ` , <nl> - library : ' [ name ] _ [ hash ] ' , <nl> + library : ` [ name ] _ [ $ { config . compiler_hash_type } ] ` , <nl> } <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> 
mmm a / webpack . dll . js <nl> ppp b / webpack . dll . js <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> webpackDllConfig . output = { <nl> path : paths . dll ( ) , <nl> - filename : ` dll . [ name ] . [ $ { config . compiler_hash_type } ] . js ` , <nl> - library : ` [ name ] _ [ $ { config . compiler_hash_type } ] ` , <nl> + filename : ' dll . [ name ] . js ' , <nl> + library : ' [ name ] _ [ hash ] ' , <nl> } <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> 
mmm a / config . js <nl> ppp b / config . js <nl> compiler_hash_type : __PROD__ ? ' chunkhash ' : ' hash ' , <nl> compiler_fail_on_warning : __TEST__ | | __PROD__ , <nl> compiler_output_path : paths . base ( config . dir_docs_dist ) , <nl> - compiler_public_path : __PROD__ ? ' / / cdn . rawgit . com / Semantic - Org / Semantic - UI - React / gh - pages / ' : ' / ' , <nl> + compiler_public_path : __PROD__ ? ' / / raw . github . com / Semantic - Org / Semantic - UI - React / gh - pages / ' : ' / ' , <nl> compiler_stats : { <nl> hash : false , / / the hash of the compilation <nl> version : false , / / webpack version info <nl> 
mmm a / gulp / tasks / umd . js <nl> ppp b / gulp / tasks / umd . js <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> task ( ' build : umd : webpack ' , ( cb ) = > { <nl> - const webpackUMDConfig = require ( ' . . / . . / webpack . umd . config ' ) <nl> + const webpackUMDConfig = require ( ' . . / . . / webpack . umd . config ' ) . default <nl> const compiler = webpack ( webpackUMDConfig ) <nl> compiler . run ( ( err , stats ) = > { <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> " lint : fix " : " yarn lint - - - - fix " , <nl> - " prerelease " : " yarn lint & & yarn tsd : lint & & npm test & & cross - env NODE_ENV = production yarn build " , <nl> + " prerelease " : " yarn lint & & yarn tsd : lint & & yarn tsd : test & & yarn test & & cross - env NODE_ENV = production yarn build " , <nl> " postrelease " : " yarn deploy : docs " , <nl> " release : major " : " yarn prerelease & & ta - script npm / release major & & yarn postrelease " , <nl> " release : minor " : " yarn prerelease & & ta - script npm / release minor & & yarn postrelease " , <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> # Chrome HeadlessBrowser is missing deps on Debian , see : <nl> # https : / / github . com / GoogleChrome / puppeteer / issues / 290 <nl> - run : <nl> - name : Update Pupeteer Dependencies <nl> + name : Update Puppeteer Dependencies <nl> command : | <nl> sudo apt - get update <nl> sudo apt - get install - - yes - - quiet gconf - service libasound2 libatk1 . 0 - 0 libc6 \ <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " postdeploy : docs " : " yarn build : changelog & & yarn deploy : changelog " , <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> - " lint : fix " : " yarn lint - - - - fix " , <nl> + " lint : fix " : " yarn lint - - fix " , <nl> " prerelease " : " yarn lint & & yarn tsd : lint & & yarn tsd : test & & yarn test & & cross - env NODE_ENV = production yarn build " , <nl> " postrelease " : " yarn deploy : docs " , <nl> " release : major " : " yarn prerelease & & ta - script npm / release major & & yarn postrelease " , <nl> " release : minor " : " yarn prerelease & & ta - script npm / release minor & & yarn postrelease " , <nl> " release : patch " : " yarn prerelease & & ta - script npm / release patch & & yarn postrelease " , <nl> - " prestart " : " yarn satisfied - - - - fix yarn " , <nl> + " prestart " : " yarn satisfied - - fix yarn " , <nl> " start " : " yarn docs " , <nl> " satisfied " : " satisfied - - skip - invalid " , <nl> " pretest " : " yarn satisfied & & yarn build : dll " , <nl> " test " : " cross - env NODE_ENV = test node - r babel - register . / node_modules / karma / bin / karma start karma . conf . babel . js " , <nl> - " test : watch " : " yarn test - - - - no - single - run " , <nl> + " test : watch " : " yarn test - - no - single - run " , <nl> " tsd " : " gulp tsd " , <nl> " tsd : lint " : " tslint ' . / index . d . ts ' ' . / src / * * / * . d . ts ' ' . / src / * * / * . tsx ' ' . / test / * * / * . d . ts ' ' . / test / * * / * . tsx ' " , <nl> - " tsd : lint : fix " : " yarn tsd : lint - - - - fix " , <nl> + " tsd : lint : fix " : " yarn tsd : lint - - fix " , <nl> " tsd : test " : " yarn tsd & & tsc - p . / & & rm test / typings . js " <nl> } , <nl> " repository " : { <nl> 
mmm a / karma . conf . babel . js <nl> ppp b / karma . conf . babel . js <nl> export default ( karmaConfig ) = > { <nl> karmaConfig . set ( { <nl> basePath : process . cwd ( ) , <nl> - browsers : [ ' ChromeHeadless ' ] , <nl> + browsers : [ ' puppeteer ' ] , <nl> client : { <nl> mocha : { <nl> reporter : ' html ' , / / change Karma ' s debug . html to mocha web reporter <nl> @ @ - 47 , 6 + 47 , 8 @ @ export default ( karmaConfig ) = > { <nl> puppeteer : { <nl> base : ' ChromeHeadless ' , <nl> flags : [ <nl> + ' - - disable - setuid - sandbox ' , <nl> + ' - - no - sandbox ' , <nl> / / Avoid " Maximum call stack size exceeded " errors on CircleCI <nl> ' - - stack - trace - limit 50000 ' , <nl> ] , <nl> 
mmm a / build / preset - env . js <nl> ppp b / build / preset - env . js <nl> ' not ie_mob < = 11 ' , <nl> ] <nl> - module . exports = { <nl> - presets : [ [ ' env ' , { <nl> + const envOptions = { <nl> targets : { browsers } , <nl> - } ] ] , <nl> + } <nl> + if ( env = = = ' build - es ' ) envOptions . modules = false <nl> + <nl> + module . exports = { <nl> + presets : [ [ ' env ' , envOptions ] ] , <nl> plugins , <nl> } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build : docs - cname " : " echo react . semantic - ui . com > docs / build / CNAME " , <nl> " build : changelog " : " github_changelog_generator - - no - issues - - no - unreleased - - release - branch master - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 400 ) ) " , <nl> - " deploy : changelog " : " git add CHANGELOG . md & & git commit - m ' docs ( changelog ) : update changelog [ ci skip ] ' & & git push " , <nl> " predeploy : docs " : " cross - env NODE_ENV = production yarn build : docs & & yarn build : docs - cname " , <nl> " deploy : docs " : " gh - pages - d docs / build - m ' deploy docs [ ci skip ] ' " , <nl> - " postdeploy : docs " : " yarn build : changelog & & yarn deploy : changelog " , <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> " lint : fix " : " yarn lint - - fix " , <nl> " prerelease " : " yarn lint & & yarn tsd : lint & & yarn tsd : test & & yarn test & & cross - env NODE_ENV = production yarn build " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build : docs - cname " : " echo react . semantic - ui . com > docs / build / CNAME " , <nl> " build : changelog " : " github_changelog_generator - - no - issues - - no - unreleased - - release - branch master - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 400 ) ) " , <nl> + " deploy : changelog " : " git add CHANGELOG . md & & git commit - m ' docs ( changelog ) : update changelog [ ci skip ] ' & & git push " , <nl> " predeploy : docs " : " cross - env NODE_ENV = production yarn build : docs & & yarn build : docs - cname " , <nl> " deploy : docs " : " gh - pages - d docs / build - m ' deploy docs [ ci skip ] ' " , <nl> + " postdeploy : docs " : " yarn build : changelog & & yarn deploy : changelog " , <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> " lint : fix " : " yarn lint - - fix " , <nl> " prettier " : " prettier - - list - different \ " * * / * . { js , jsx , ts , tsx } \ " " , <nl> 
mmm a / docs / app / Components / CarbonAd / CarbonAd . js <nl> ppp b / docs / app / Components / CarbonAd / CarbonAd . js <nl> script . async = true <nl> script . id = ' _carbonads_js ' <nl> script . type = ' text / javascript ' <nl> - script . src = ' / / cdn . carbonads . com / carbon . js ? zoneid = 1673 & serve = C6AILKT & placement = reactsemanticuicom ' <nl> + script . src = ' / / cdn . carbonads . com / carbon . js ? serve = CK7DT23J & placement = reactsemanticuicom ' <nl> this . ifRef ( ref = > ref . appendChild ( script ) ) <nl> } <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> jobs : <nl> build : <nl> docker : <nl> - - image : circleci / node : 8 <nl> + - image : circleci / node : 8 - browsers <nl> environment : <nl> TZ : " / usr / share / zoneinfo / America / Los_Angeles " <nl> steps : <nl> - # Chrome HeadlessBrowser is missing deps on Debian , see : <nl> - # https : / / github . com / GoogleChrome / puppeteer / issues / 290 <nl> - - run : <nl> - name : Update Puppeteer Dependencies <nl> - command : | <nl> - sudo apt - get update <nl> - sudo apt - get install - - yes - - quiet gconf - service libasound2 libatk1 . 0 - 0 libc6 \ <nl> - libcairo2 libcups2 libdbus - 1 - 3 libexpat1 libfontconfig1 libgcc1 libgconf - 2 - 4 \ <nl> - libgdk - pixbuf2 . 0 - 0 libglib2 . 0 - 0 libgtk - 3 - 0 libnspr4 libpango - 1 . 0 - 0 libpangocairo - 1 . 0 - 0 \ <nl> - libstdc + + 6 libx11 - 6 libx11 - xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 \ <nl> - libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca - certificates fonts - liberation \ <nl> - libappindicator1 libnss3 lsb - release xdg - utils wget <nl> - run : <nl> name : Update yarn <nl> command : | <nl> 
mmm a / gulp / tasks / docs . js <nl> ppp b / gulp / tasks / docs . js <nl> import express from ' express ' <nl> import { task , src , dest , lastRun , parallel , series , watch } from ' gulp ' <nl> import loadPlugins from ' gulp - load - plugins ' <nl> + import path from ' path ' <nl> import rimraf from ' rimraf ' <nl> import webpack from ' webpack ' <nl> import WebpackDevMiddleware from ' webpack - dev - middleware ' <nl> @ @ - 165 , 7 + 166 , 8 @ @ task ( ' deploy : changelog ' , ( cb ) = > { <nl> } ) <nl> task ( ' deploy : docs ' , ( cb ) = > { <nl> - sh ( ` gh - pages - d $ { paths . docsDist ( ) } - m " deploy docs [ ci skip ] " ` , cb ) <nl> + const relativePath = path . relative ( process . cwd ( ) , paths . docsDist ( ) ) <nl> + sh ( ` gh - pages - d $ { relativePath } - m " deploy docs [ ci skip ] " ` , cb ) <nl> } ) <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> 
mmm a / gulp / tasks / dist . js <nl> ppp b / gulp / tasks / dist . js <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> task ( ' clean : dist ' , ( cb ) = > { <nl> - rimraf ( config . paths . dist ( ) , cb ) <nl> + rimraf ( ` $ { config . paths . dist ( ) } / * ` , cb ) <nl> } ) <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> 
mmm a / . circleci / config . yml <nl> ppp b / . circleci / config . yml <nl> command : echo ' export PATH = " $ { PATH } : $ ( npm bin ) " ' > > $ BASH_ENV <nl> - restore_cache : <nl> keys : <nl> - - v1 - dependencies - { { checksum " yarn . lock " } } <nl> - - v1 - dependencies <nl> + - v2 - dependencies - { { checksum " yarn . lock " } } <nl> - run : <nl> name : Install Dependencies <nl> command : yarn <nl> - save_cache : <nl> - key : v1 - dependencies - { { checksum " yarn . lock " } } <nl> + key : v2 - dependencies - { { checksum " yarn . lock " } } <nl> paths : <nl> - ~ / . cache / yarn <nl> - - . yarn - cache <nl> - - node_modules <nl> - run : <nl> name : Lint TypeScript <nl> command : yarn tsd : lint <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " deploy : changelog " : " git add CHANGELOG . md & & git commit - m \ " docs ( changelog ) : update changelog [ ci skip ] \ " & & git push " , <nl> " deploy : docs " : " gulp deploy : docs " , <nl> - " postdeploy : docs " : " yarn build : changelog & & gulp deploy : changelog " , <nl> + " postdeploy : docs " : " yarn build : changelog & & yarn deploy : changelog " , <nl> " lint " : " cross - env NODE_ENV = production eslint . " , <nl> " lint : fix " : " yarn lint - - fix " , <nl> " prettier " : " prettier - - list - different \ " * * / * . { js , jsx , ts , tsx } \ " " , <nl> 
mmm a / config . js <nl> ppp b / config . js <nl> . . . envConfig , <nl> paths , <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - / / Server Configuration <nl> - / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - server_host : ' localhost ' , <nl> - server_port : process . env . PORT | | 8080 , <nl> - <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> / / Compiler Configuration <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> 
mmm a / src / modules / Sidebar / Sidebar . js <nl> ppp b / src / modules / Sidebar / Sidebar . js <nl> import cx from ' classnames ' <nl> import _ from ' lodash ' <nl> import PropTypes from ' prop - types ' <nl> @ @ - 8 , 7 + 9 , 6 @ @ import { <nl> childrenUtils , <nl> customPropTypes , <nl> doesNodeContainClick , <nl> - eventStack , <nl> getUnhandledProps , <nl> getElementType , <nl> useKeyOnly , <nl> @ @ - 100 , 41 + 100 , 15 @ @ class Sidebar extends Component { <nl> state = { } <nl> - componentDidMount ( ) { <nl> - const { visible } = this . props <nl> - <nl> - if ( visible ) this . addListener ( ) <nl> - } <nl> - <nl> - componentWillUnmount ( ) { <nl> - const { visible } = this . props <nl> - <nl> - if ( visible ) this . removeListener ( ) <nl> - clearTimeout ( this . animationTimer ) <nl> - } <nl> - <nl> componentDidUpdate ( prevProps ) { <nl> const { visible : prevVisible } = prevProps <nl> const { visible : currentVisible } = this . props <nl> - if ( prevVisible = = = currentVisible ) return <nl> - <nl> - this . handleAnimationStart ( ) <nl> - <nl> - if ( currentVisible ) { <nl> - this . addListener ( ) <nl> - return <nl> - } <nl> - <nl> - this . removeListener ( ) <nl> + if ( prevVisible ! = = currentVisible ) this . handleAnimationStart ( ) <nl> } <nl> - addListener ( ) { <nl> - eventStack . sub ( ' click ' , this . handleDocumentClick ) <nl> - } <nl> - <nl> - removeListener ( ) { <nl> - eventStack . unsub ( ' click ' , this . handleDocumentClick ) <nl> + componentWillUnmount ( ) { <nl> + clearTimeout ( this . animationTimer ) <nl> } <nl> handleAnimationStart = ( ) = > { <nl> @ @ - 192 , 6 + 166 , 7 @ @ class Sidebar extends Component { <nl> < Ref innerRef = { this . handleRef } > <nl> < ElementType { . . . rest } className = { classes } > <nl> { childrenUtils . isNil ( children ) ? content : children } <nl> + { visible & & < EventStack name = ' click ' on = { this . handleDocumentClick } / > } <nl> < / ElementType > <nl> < / Ref > <nl> ) <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " scripts " : { <nl> " build " : " cross - env NODE_ENV = production gulp build " , <nl> - " build : changelog " : " github_changelog_generator - - no - issues - - no - unreleased - - release - branch master - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 300 ) ) " , <nl> + " build : changelog " : " github_changelog_generator - - user Semantic - Org - - project Semantic - UI - React - - no - issues - - no - unreleased - - release - branch master - - breaking - labels breaking - change - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 250 ) ) " , <nl> " build : docs " : " cross - env NODE_ENV = production gulp build : docs " , <nl> " build : docs : staging " : " cross - env STAGING = true yarn build : docs & & yarn serve docs / dist " , <nl> " build : dist " : " gulp - - series build : dist " , <nl> 
mmm a / karma . conf . babel . js <nl> ppp b / karma . conf . babel . js <nl> ] , <nl> formatError , <nl> frameworks : [ ' mocha ' ] , <nl> + mochaReporter : { <nl> + output : ' minimal ' , <nl> + } , <nl> / / make karma serve all files that the web server does : / * = > / docs / app / * <nl> proxies : fs . readdirSync ( paths . docsPublic ( ) ) . reduce ( ( acc , file ) = > { <nl> const isDir = fs . statSync ( paths . docsPublic ( file ) ) . isDirectory ( ) <nl> 
mmm a / src / modules / Modal / Modal . js <nl> ppp b / src / modules / Modal / Modal . js <nl> import _ from ' lodash ' <nl> import PropTypes from ' prop - types ' <nl> - import React , { isValidElement } from ' react ' <nl> + import React , { createRef , Fragment , isValidElement } from ' react ' <nl> import { <nl> AutoControlledComponent as Component , <nl> @ @ - 151 , 6 + 151 , 9 @ @ class Modal extends Component { <nl> static Description = ModalDescription <nl> static Actions = ModalActions <nl> + ref = createRef ( ) <nl> + dimmerRef = createRef ( ) <nl> + <nl> componentWillUnmount ( ) { <nl> debug ( ' componentWillUnmount ( ) ' ) <nl> this . handlePortalUnmount ( ) <nl> @ @ - 179 , 7 + 182 , 7 @ @ class Modal extends Component { <nl> debug ( ' handleDocumentClick ( ) ' ) <nl> const { closeOnDimmerClick } = this . props <nl> - if ( ! closeOnDimmerClick | | doesNodeContainClick ( this . ref , e ) ) return <nl> + if ( ! closeOnDimmerClick | | doesNodeContainClick ( this . ref . current , e ) ) return <nl> _ . invoke ( this . props , ' onClose ' , e , this . props ) <nl> this . trySetState ( { open : false } ) <nl> @ @ - 206 , 7 + 209 , 10 @ @ class Modal extends Component { <nl> this . setState ( { scrolling : false } ) <nl> this . setPositionAndClassNames ( ) <nl> - eventStack . sub ( ' click ' , this . handleDocumentClick , { pool : eventPool , target : this . dimmerRef } ) <nl> + eventStack . sub ( ' click ' , this . handleDocumentClick , { <nl> + pool : eventPool , <nl> + target : this . dimmerRef . current , <nl> + } ) <nl> _ . invoke ( this . props , ' onMount ' , e , this . props ) <nl> } <nl> @ @ - 215 , 19 + 221 , 18 @ @ class Modal extends Component { <nl> debug ( ' handlePortalUnmount ( ) ' , { eventPool } ) <nl> cancelAnimationFrame ( this . animationRequestId ) <nl> - eventStack . unsub ( ' click ' , this . handleDocumentClick , { pool : eventPool , target : this . dimmerRef } ) <nl> + eventStack . unsub ( ' click ' , this . handleDocumentClick , { <nl> + pool : eventPool , <nl> + target : this . dimmerRef . current , <nl> + } ) <nl> _ . invoke ( this . props , ' onUnmount ' , e , this . props ) <nl> } <nl> - handleRef = c = > ( this . ref = c ) <nl> - <nl> - handleDimmerRef = c = > ( this . dimmerRef = c ) <nl> - <nl> setDimmerNodeStyle = ( ) = > { <nl> debug ( ' setDimmerNodeStyle ( ) ' ) <nl> - if ( this . dimmerRef ) { <nl> - this . dimmerRef . style . setProperty ( ' display ' , ' flex ' , ' important ' ) <nl> + if ( this . dimmerRef . current ) { <nl> + this . dimmerRef . current . style . setProperty ( ' display ' , ' flex ' , ' important ' ) <nl> } <nl> } <nl> @ @ - 245 , 8 + 250 , 8 @ @ class Modal extends Component { <nl> const newState = { } <nl> - if ( this . ref ) { <nl> - const { height } = this . ref . getBoundingClientRect ( ) <nl> + if ( this . ref . current ) { <nl> + const { height } = this . ref . current . getBoundingClientRect ( ) <nl> / / Leaving the old calculation here since we may need it as an older browser fallback <nl> / / SEE : https : / / github . com / Semantic - Org / Semantic - UI / issues / 6185 # issuecomment - 376725956 <nl> @ @ - 301 , 30 + 306 , 21 @ @ class Modal extends Component { <nl> const closeIconName = closeIcon = = = true ? ' close ' : closeIcon <nl> const closeIconJSX = Icon . create ( closeIconName , { overrideProps : this . handleIconOverrides } ) <nl> - if ( ! childrenUtils . isNil ( children ) ) { <nl> - / / TODO : remove when ref with " as " is resolved : PR # 2306 <nl> - return ( <nl> - < Ref innerRef = { this . handleRef } > <nl> - < ElementType { . . . rest } className = { classes } style = { { marginTop , . . . style } } > <nl> - < MountNode className = { mountClasses } node = { mountNode } / > <nl> - <nl> - { closeIconJSX } <nl> - { children } <nl> - < / ElementType > <nl> - < / Ref > <nl> - ) <nl> - } <nl> - <nl> - / / TODO : remove when ref with " as " is resolved : PR # 2306 <nl> return ( <nl> - < Ref innerRef = { this . handleRef } > <nl> + < Ref innerRef = { this . ref } > <nl> < ElementType { . . . rest } className = { classes } style = { { marginTop , . . . style } } > <nl> < MountNode className = { mountClasses } node = { mountNode } / > <nl> { closeIconJSX } <nl> + { childrenUtils . isNil ( children ) ? ( <nl> + < Fragment > <nl> { ModalHeader . create ( header , { autoGenerateKey : false } ) } <nl> { ModalContent . create ( content , { autoGenerateKey : false } ) } <nl> { ModalActions . create ( actions , { overrideProps : this . handleActionsOverrides } ) } <nl> + < / Fragment > <nl> + ) : ( <nl> + children <nl> + ) } <nl> < / ElementType > <nl> < / Ref > <nl> ) <nl> @ @ - 386 , 7 + 382 , 7 @ @ class Modal extends Component { <nl> onOpen = { this . handleOpen } <nl> onUnmount = { this . handlePortalUnmount } <nl> > <nl> - < div className = { dimmerClasses } ref = { this . handleDimmerRef } > <nl> + < div className = { dimmerClasses } ref = { this . dimmerRef } > <nl> { this . renderContent ( rest ) } <nl> < / div > <nl> < / Portal > <nl> 
mmm a / src / elements / Button / Button . js <nl> ppp b / src / elements / Button / Button . js <nl> import _ from ' lodash ' <nl> import PropTypes from ' prop - types ' <nl> - import React , { Component } from ' react ' <nl> + import React , { Component , createRef } from ' react ' <nl> import { <nl> childrenUtils , <nl> @ @ - 155 , 6 + 155 , 8 @ @ class Button extends Component { <nl> static Group = ButtonGroup <nl> static Or = ButtonOr <nl> + ref = createRef ( ) <nl> + <nl> computeButtonAriaRole ( ElementType ) { <nl> const { role } = this . props <nl> @ @ - 176 , 7 + 178 , 7 @ @ class Button extends Component { <nl> if ( ElementType = = = ' div ' ) return 0 <nl> } <nl> - focus = ( ) = > _ . invoke ( this . ref , ' focus ' ) <nl> + focus = ( ) = > _ . invoke ( this . ref . current , ' focus ' ) <nl> handleClick = ( e ) = > { <nl> const { disabled } = this . props <nl> @ @ - 189 , 8 + 191 , 6 @ @ class Button extends Component { <nl> _ . invoke ( this . props , ' onClick ' , e , this . props ) <nl> } <nl> - handleRef = c = > ( this . ref = c ) <nl> - <nl> hasIconClass = ( ) = > { <nl> const { labelPosition , children , content , icon } = this . props <nl> @ @ - 268 , 9 + 268 , 9 @ @ class Button extends Component { <nl> { labelPosition = = = ' left ' & & labelElement } <nl> < button <nl> className = { buttonClasses } <nl> - aria - pressed = { toggle ? ( ! ! active ) : undefined } <nl> + aria - pressed = { toggle ? ! ! active : undefined } <nl> disabled = { disabled } <nl> - ref = { this . handleRef } <nl> + ref = { this . ref } <nl> tabIndex = { tabIndex } <nl> > <nl> { Icon . create ( icon , { autoGenerateKey : false } ) } { content } <nl> @ @ - 288 , 10 + 288 , 10 @ @ class Button extends Component { <nl> < ElementType <nl> { . . . rest } <nl> className = { classes } <nl> - aria - pressed = { toggle ? ( ! ! active ) : undefined } <nl> + aria - pressed = { toggle ? ! ! active : undefined } <nl> disabled = { ( disabled & & ElementType = = = ' button ' ) | | undefined } <nl> onClick = { this . handleClick } <nl> - ref = { this . handleRef } <nl> + ref = { this . ref } <nl> role = { role } <nl> tabIndex = { tabIndex } <nl> > <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " main " : " dist / commonjs / index . js " , <nl> " module " : " dist / es / index . js " , <nl> - " browser " : " dist / umd / semantic - ui - react . min . js " , <nl> " types " : " index . d . ts " , <nl> + " unpkg " : " dist / umd / semantic - ui - react . min . js " , <nl> " files " : [ <nl> " src " , <nl> " dist " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " prettier " : " prettier - - list - different \ " * * / * . { js , jsx , ts , tsx } \ " " , <nl> " prettier : fix " : " prettier - - write \ " * * / * . { js , jsx , ts , tsx } \ " " , <nl> - " postcommit " : " git update - index - - again " , <nl> " prerelease " : " yarn lint & & yarn tsd : lint & & yarn tsd : test & & yarn test & & cross - env NODE_ENV = production yarn build " , <nl> " postrelease " : " yarn deploy : docs " , <nl> " release : major " : " yarn prerelease & & ta - script npm / release major & & yarn postrelease " , <nl> } , <nl> " husky " : { <nl> " hooks " : { <nl> - " pre - commit " : " lint - staged " <nl> + " pre - commit " : " lint - staged " , <nl> + " post - commit " : " git update - index - - again " <nl> } <nl> } , <nl> " lint - staged " : { <nl> 
mmm a / src / behaviors / Visibility / Visibility . js <nl> ppp b / src / behaviors / Visibility / Visibility . js <nl> / / Lifecycle <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - / / eslint - disable - next - line camelcase <nl> - UNSAFE_componentWillReceiveProps ( { continuous , once , context , updateOn } ) { <nl> - const cleanHappened = <nl> - continuous ! = = this . props . continuous | | <nl> - once ! = = this . props . once | | <nl> - updateOn ! = = this . props . updateOn <nl> - <nl> - / / Heads up ! We should clean up array of happened callbacks , if values of these props are changed <nl> - if ( cleanHappened ) this . firedCallbacks = [ ] <nl> - <nl> - if ( context ! = = this . props . context | | updateOn ! = = this . props . updateOn ) { <nl> - this . unattachHandlers ( this . props . context ) <nl> - this . attachHandlers ( context , updateOn ) <nl> - } <nl> - } <nl> - <nl> componentDidMount ( ) { <nl> this . mounted = true <nl> @ @ - 215 , 6 + 199 , 21 @ @ export default class Visibility extends Component { <nl> if ( fireOnMount ) this . update ( ) <nl> } <nl> + componentDidUpdate ( prevProps ) { <nl> + const cleanHappened = <nl> + prevProps . continuous ! = = this . props . continuous | | <nl> + prevProps . once ! = = this . props . once | | <nl> + prevProps . updateOn ! = = this . props . updateOn <nl> + <nl> + / / Heads up ! We should clean up array of happened callbacks , if values of these props are changed <nl> + if ( cleanHappened ) this . firedCallbacks = [ ] <nl> + <nl> + if ( prevProps . context ! = = this . props . context | | prevProps . updateOn ! = = this . props . updateOn ) { <nl> + this . unattachHandlers ( prevProps . context ) <nl> + this . attachHandlers ( this . props . context , this . props . updateOn ) <nl> + } <nl> + } <nl> + <nl> componentWillUnmount ( ) { <nl> const { context } = this . props <nl> 
mmm a / src / modules / Sticky / Sticky . js <nl> ppp b / src / modules / Sticky / Sticky . js <nl> } <nl> state = { <nl> + active : true , <nl> sticky : false , <nl> } <nl> @ @ - 96 , 43 + 97 , 47 @ @ export default class Sticky extends Component { <nl> componentDidMount ( ) { <nl> if ( ! isBrowser ( ) ) return <nl> - const { active } = this . props <nl> + const { active } = this . state <nl> if ( active ) { <nl> this . handleUpdate ( ) <nl> - this . addListeners ( this . props ) <nl> + this . addListeners ( this . props . scrollContext ) <nl> } <nl> } <nl> - / / eslint - disable - next - line camelcase <nl> - UNSAFE_componentWillReceiveProps ( nextProps ) { <nl> - const { active : current , scrollContext : currentScrollContext } = this . props <nl> - const { active : next , scrollContext : nextScrollContext } = nextProps <nl> + static getDerivedStateFromProps ( props , state ) { <nl> + if ( state . active ! = = props . active & & ! props . active ) { <nl> + return { active : props . active , sticky : false } <nl> + } <nl> - if ( current = = = next ) { <nl> - if ( currentScrollContext ! = = nextScrollContext ) { <nl> - this . removeListeners ( ) <nl> - this . addListeners ( nextProps ) <nl> + return { active : props . active } <nl> } <nl> + <nl> + componentDidUpdate ( prevProps , prevState ) { <nl> + if ( prevState . active = = = this . state . active ) { <nl> + if ( prevProps . scrollContext ! = = this . props . scrollContext ) { <nl> + this . removeListeners ( prevProps . scrollContext ) <nl> + this . addListeners ( this . props . scrollContext ) <nl> + } <nl> + <nl> return <nl> } <nl> - if ( next ) { <nl> + if ( this . state . active ) { <nl> this . handleUpdate ( ) <nl> - this . addListeners ( nextProps ) <nl> + this . addListeners ( this . props . scrollContext ) <nl> return <nl> } <nl> - this . removeListeners ( ) <nl> - this . setState ( { sticky : false } ) <nl> + this . removeListeners ( prevProps . scrollContext ) <nl> } <nl> componentWillUnmount ( ) { <nl> if ( ! isBrowser ( ) ) return <nl> - const { active } = this . props <nl> + const { active } = this . state <nl> if ( active ) { <nl> - this . removeListeners ( ) <nl> + this . removeListeners ( this . props . scrollContext ) <nl> cancelAnimationFrame ( this . frameId ) <nl> } <nl> } <nl> @ @ - 141 , 8 + 146 , 7 @ @ export default class Sticky extends Component { <nl> / / Events <nl> / / - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - <nl> - addListeners = ( props ) = > { <nl> - const { scrollContext } = props <nl> + addListeners = ( scrollContext ) = > { <nl> const scrollContextNode = isRefObject ( scrollContext ) ? scrollContext . current : scrollContext <nl> if ( scrollContextNode ) { <nl> @ @ - 151 , 8 + 155 , 7 @ @ export default class Sticky extends Component { <nl> } <nl> } <nl> - removeListeners = ( ) = > { <nl> - const { scrollContext } = this . props <nl> + removeListeners = ( scrollContext ) = > { <nl> const scrollContextNode = isRefObject ( scrollContext ) ? scrollContext . current : scrollContext <nl> if ( scrollContextNode ) { <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " scripts " : { <nl> " build " : " cross - env NODE_ENV = production gulp build " , <nl> - " build : changelog " : " github_changelog_generator - - user Semantic - Org - - project Semantic - UI - React - - no - issues - - no - unreleased - - release - branch master - - since - tag $ ( git describe - - abbrev = 0 - - tags $ ( git rev - parse HEAD ~ 250 ) ) " , <nl> " build : docs " : " cross - env NODE_ENV = production gulp build : docs " , <nl> " build : docs : staging " : " cross - env STAGING = true yarn build : docs & & yarn serve docs / dist " , <nl> " build : dist " : " gulp build : dist " , <nl> " build : size " : " node bundle - size / bundle . js " , <nl> " ci " : " yarn tsd : test & & yarn lint & & yarn test " , <nl> " predeploy : docs " : " cross - env NODE_ENV = production yarn build : docs & & gulp build : docs : cname " , <nl> - " deploy : changelog " : " git add CHANGELOG . md & & git commit - m \ " docs ( changelog ) : update changelog [ ci skip ] \ " & & git push " , <nl> " deploy : docs " : " gulp deploy : docs " , <nl> - " postdeploy : docs " : " yarn build : changelog & & yarn deploy : changelog " , <nl> " lint " : " cross - env NODE_ENV = production eslint . - - ext . js , . ts , . tsx " , <nl> " lint : fix " : " yarn lint - - fix " , <nl> " prettier " : " prettier - - list - different \ " * * / * . { js , jsx , ts , tsx } \ " " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " * * / * . { js , jsx , ts , tsx } " : [ <nl> " prettier - - write " , <nl> - " eslint - - fix " , <nl> - " git add " <nl> + " eslint - - fix " <nl> ] , <nl> " * * / * . mdx " : [ <nl> - " prettier - - parser mdx - - write " , <nl> - " git add " <nl> + " prettier - - parser mdx - - write " <nl> ] <nl> } , <nl> " repository " : { <nl> 
mmm a / bin / newman . js <nl> ppp b / bin / newman . js <nl> program . on ( ' - - help ' , function ( ) { <nl> console . info ( ' \ nTo get available options for a command : ' ) ; <nl> - console . info ( ' newman [ command ] - h ' ) ; <nl> + console . info ( ' newman < command > - h ' ) ; <nl> } ) ; <nl> / / Warn on invalid command and then exits . <nl> 
mmm a / lib / util . js <nl> ppp b / lib / util . js <nl> - url = require ( ' url ' ) , <nl> + { URL } = require ( ' url ' ) , <nl> _ = require ( ' lodash ' ) , <nl> chardet = require ( ' chardet ' ) , <nl> @ @ - 191 , 7 + 191 , 7 @ @ util = { <nl> resource = ' resource ' ; <nl> if ( response . statusCode ! = = 200 ) { <nl> - urlObj = url . parse ( location ) ; <nl> + urlObj = new URL ( location ) ; <nl> ( urlObj . hostname = = = POSTMAN_API_HOST ) & & <nl> ( resource = _ ( urlObj . path ) . split ( ' / ' ) . get ( 1 ) . slice ( 0 , - 1 ) | | resource ) ; <nl> 
mmm a / package - lock . json <nl> ppp b / package - lock . json <nl> " optional " : true , <nl> " requires " : { <nl> - " bindings " : " ^ 1 . 5 . 0 " , <nl> - " nan " : " ^ 2 . 12 . 1 " <nl> + " bindings " : " ^ 1 . 5 . 0 " <nl> } <nl> } <nl> } <nl> " dev " : true , <nl> " optional " : true , <nl> " requires " : { <nl> - " bindings " : " ^ 1 . 5 . 0 " , <nl> - " nan " : " ^ 2 . 12 . 1 " <nl> + " bindings " : " ^ 1 . 5 . 0 " <nl> } <nl> } <nl> } <nl> " thenify - all " : " ^ 1 . 0 . 0 " <nl> } <nl> } , <nl> - " nan " : { <nl> - " version " : " 2 . 15 . 0 " , <nl> - " resolved " : " https : / / registry . npmjs . org / nan / - / nan - 2 . 15 . 0 . tgz " , <nl> - " integrity " : " sha512 - 8ZtvEnA2c5aYCZYd1cvgdnU6cqwixRoYg70xPLWUws5ORTa / lnw + u4amixRS / Ac5U5mQVgp9pnlSUnbNWFaWZQ = = " , <nl> - " optional " : true <nl> - } , <nl> " nanocolors " : { <nl> " version " : " 0 . 1 . 12 " , <nl> " resolved " : " https : / / registry . npmjs . org / nanocolors / - / nanocolors - 0 . 1 . 12 . tgz " , <nl> } , <nl> " glob - parent " : { <nl> " version " : " 5 . 1 . 0 " , <nl> - " resolved " : " https : / / registry . npmjs . org / glob - parent / - / glob - parent - 5 . 1 . 0 . tgz " , <nl> - " integrity " : " sha512 - qjtRgnIVmOfnKUE3NJAQEdk + lKrxfw8t5ke7SXtfMTHcjsBfOfWXCQfdb30zfDoZQ2IRSIiidmjtbHZPZ + + Ihw = = " , <nl> + " resolved " : " " , <nl> " requires " : { <nl> " is - glob " : " ^ 4 . 0 . 1 " <nl> } <nl> 
mmm a / frontend / mina - signer / src / MinaSigner . ts <nl> ppp b / frontend / mina - signer / src / MinaSigner . ts <nl> * the private key and additionally checking if we can use the private key to <nl> * sign a transaction . If the key pair is invalid , an exception is thrown . <nl> * <nl> - * @ param keypair - A keypair <nl> + * @ param keypair A key pair <nl> * @ returns True if the ` keypair ` is a verifiable key pair , otherwise throw an exception <nl> * / <nl> public verifyKeypair ( keypair : keypair ) : boolean { <nl> @ @ - 49 , 7 + 49 , 7 @ @ class Client { <nl> / * * <nl> * Derives the public key of the corresponding private key <nl> * <nl> - * @ param privateKey - The private key used to get the corresponding public key <nl> + * @ param privateKey The private key used to get the corresponding public key <nl> * @ returns A public key <nl> * / <nl> public derivePublicKey ( privateKey : privateKey ) : publicKey { <nl> @ @ - 59 , 8 + 59 , 8 @ @ class Client { <nl> / * * <nl> * Signs an arbitrary message <nl> * <nl> - * @ param message - An arbitrary string message to be signed <nl> - * @ param key - The keypair used to sign the message <nl> + * @ param message An arbitrary string message to be signed <nl> + * @ param key The key pair used to sign the message <nl> * @ returns A signed message <nl> * / <nl> public signMessage ( message : string , key : keypair ) : signed < message > { <nl> @ @ - 76 , 7 + 76 , 7 @ @ class Client { <nl> / * * <nl> * Verifies that a signature matches a message . <nl> * <nl> - * @ param signedMessage - A signed message <nl> + * @ param signedMessage A signed message <nl> * @ returns True if the ` signedMessage ` contains a valid signature matching <nl> * the message and publicKey . <nl> * / <nl> @ @ - 95 , 8 + 95 , 8 @ @ class Client { <nl> * This type of transaction allows a user to transfer funds from one account <nl> * to another over the network . <nl> * <nl> - * @ param payment - An object describing the payment <nl> - * @ param privateKey - The private key used to sign the transaction <nl> + * @ param payment An object describing the payment <nl> + * @ param privateKey The private key used to sign the transaction <nl> * @ returns A signed payment transaction <nl> * / <nl> public signPayment ( <nl> @ @ - 138 , 7 + 138 , 7 @ @ class Client { <nl> / * * <nl> * Verifies a signed payment . <nl> * <nl> - * @ param signedPayment - A signed payment transaction <nl> + * @ param signedPayment A signed payment transaction <nl> * @ returns True if the ` signed ( payment ) ` is a verifiable payment <nl> * / <nl> public verifyPayment ( signedPayment : signed < payment > ) : boolean { <nl> @ @ - 216 , 7 + 216 , 7 @ @ class Client { <nl> / * * <nl> * Verifies a signed stake delegation . <nl> * <nl> - * @ param signedStakeDelegation - A signed stake delegation <nl> + * @ param signedStakeDelegation A signed stake delegation <nl> * @ returns True if the ` signed ( stakeDelegation ) ` is a verifiable stake delegation <nl> * / <nl> public verifyStakeDelegation ( <nl> @ @ - 249 , 7 + 249 , 7 @ @ class Client { <nl> / * * <nl> * Compute the hash of a signed payment . <nl> * <nl> - * @ param signedPayment - A signed payment transaction <nl> + * @ param signedPayment A signed payment transaction <nl> * @ returns A transaction hash <nl> * / <nl> public hashPayment ( signedPayment : signed < payment > ) : string { <nl> @ @ - 282 , 7 + 282 , 7 @ @ class Client { <nl> / * * <nl> * Compute the hash of a signed stake delegation . <nl> * <nl> - * @ param signedStakeDelegation - A signed stake delegation <nl> + * @ param signedStakeDelegation A signed stake delegation <nl> * @ returns A transaction hash <nl> * / <nl> public hashStakeDelegation ( <nl> @ @ - 317 , 7 + 317 , 7 @ @ class Client { <nl> * compatible with GraphQL . The JSON string is a representation of <nl> * a ` Signed_command ` which is what our GraphQL expects . <nl> * <nl> - * @ param signedRosettaTxn - A signed Rosetta transaction <nl> + * @ param signedRosettaTxn A signed Rosetta transaction <nl> * @ returns A string that represents the JSON conversion of a signed Rosetta transaction ` . <nl> * / <nl> public signedRosettaTransactionToSignedCommand ( <nl> @ @ - 330 , 7 + 330 , 7 @ @ class Client { <nl> * Return the hex - encoded format of a valid public key . This will throw an exception if <nl> * the key is invalid or the conversion fails . <nl> * <nl> - * @ param publicKey - A valid public key <nl> + * @ param publicKey A valid public key <nl> * @ returns A string that represents the hex encoding of a public key . <nl> * / <nl> public publicKeyToRaw ( publicKey : string ) : string { <nl> 
mmm a / packages / history / index . ts <nl> ppp b / packages / history / index . ts <nl> * <nl> * @ see https : / / github . com / ReactTraining / history / tree / master / docs / api - reference . md # parsepath <nl> * / <nl> - export function parsePath ( path : string ) { <nl> - let partialPath : PartialPath = { <nl> + export function parsePath ( path : string ) : PartialPath { <nl> + let parsedPath : PartialPath = { <nl> search : ' ' <nl> } ; <nl> if ( path ) { <nl> let hashIndex = path . indexOf ( ' # ' ) ; <nl> if ( hashIndex > = 0 ) { <nl> - partialPath . hash = path . substr ( hashIndex ) ; <nl> + parsedPath . hash = path . substr ( hashIndex ) ; <nl> path = path . substr ( 0 , hashIndex ) ; <nl> } <nl> let searchIndex = path . indexOf ( ' ? ' ) ; <nl> if ( searchIndex > = 0 ) { <nl> - partialPath . search = path . substr ( searchIndex ) ; <nl> + parsedPath . search = path . substr ( searchIndex ) ; <nl> path = path . substr ( 0 , searchIndex ) ; <nl> } <nl> if ( path ) { <nl> - partialPath . pathname = path ; <nl> + parsedPath . pathname = path ; <nl> } <nl> } <nl> - return partialPath ; <nl> + return parsedPath ; <nl> } <nl> 
mmm a / src / utils / Sort . js <nl> ppp b / src / utils / Sort . js <nl> . map ( ( x ) = > ( x / 2 ) . toString ( ) ) <nl> . concat ( [ ' 1000000 ' ] ) ; <nl> + const CARD_TYPES = [ <nl> + ' Creature ' , <nl> + ' Planeswalker ' , <nl> + ' Instant ' , <nl> + ' Sorcery ' , <nl> + ' Artifact ' , <nl> + ' Enchantment ' , <nl> + ' Conspiracy ' , <nl> + ' Contraption ' , <nl> + ' Phenomenon ' , <nl> + ' Plane ' , <nl> + ' Scheme ' , <nl> + ' Vanguard ' , <nl> + ' Land ' , <nl> + ] ; <nl> + <nl> const SINGLE_COLOR = [ ' White ' , ' Blue ' , ' Black ' , ' Red ' , ' Green ' ] ; <nl> const GUILDS = [ ' Azorius ' , ' Dimir ' , ' Rakdos ' , ' Gruul ' , ' Selesnya ' , ' Orzhov ' , ' Izzet ' , ' Golgari ' , ' Boros ' , ' Simic ' ] ; <nl> const SHARDS_AND_WEDGES = [ ' Bant ' , ' Esper ' , ' Grixis ' , ' Jund ' , ' Naya ' , ' Mardu ' , ' Temur ' , ' Abzan ' , ' Jeskai ' , ' Sultai ' ] ; <nl> 
mmm a / src / utils / Sort . js <nl> ppp b / src / utils / Sort . js <nl> return [ ' White ' , ' Blue ' , ' Black ' , ' Red ' , ' Green ' , ' Colorless ' ] ; <nl> } <nl> if ( sort = = = ' Type ' ) { <nl> - return [ <nl> - ' Creature ' , <nl> - ' Planeswalker ' , <nl> - ' Instant ' , <nl> - ' Sorcery ' , <nl> - ' Artifact ' , <nl> - ' Enchantment ' , <nl> - ' Conspiracy ' , <nl> - ' Contraption ' , <nl> - ' Phenomenon ' , <nl> - ' Plane ' , <nl> - ' Scheme ' , <nl> - ' Vanguard ' , <nl> - ' Land ' , <nl> - ' Other ' , <nl> - ] ; <nl> + return CARD_TYPES . concat ( [ ' Other ' ] ) ; <nl> } <nl> if ( sort = = = ' Supertype ' ) { <nl> return [ ' Snow ' , ' Legendary ' , ' Tribal ' , ' Basic ' , ' Elite ' , ' Host ' , ' Ongoing ' , ' World ' ] ; <nl> @ @ - 352 , 48 + 337 , 11 @ @ function getLabelsRaw ( cube , sort ) { <nl> return [ . . . types ] ; <nl> } <nl> if ( sort = = = ' Types - Multicolor ' ) { <nl> - return [ <nl> - ' Creature ' , <nl> - ' Planeswalker ' , <nl> - ' Instant ' , <nl> - ' Sorcery ' , <nl> - ' Artifact ' , <nl> - ' Enchantment ' , <nl> - ' Conspiracy ' , <nl> - ' Contraption ' , <nl> - ' Phenomenon ' , <nl> - ' Plane ' , <nl> - ' Scheme ' , <nl> - ' Vanguard ' , <nl> - ' Azorius ' , <nl> - ' Dimir ' , <nl> - ' Rakdos ' , <nl> - ' Gruul ' , <nl> - ' Selesnya ' , <nl> - ' Orzhov ' , <nl> - ' Golgari ' , <nl> - ' Simic ' , <nl> - ' Izzet ' , <nl> - ' Boros ' , <nl> - ' Bant ' , <nl> - ' Esper ' , <nl> - ' Grixis ' , <nl> - ' Jund ' , <nl> - ' Naya ' , <nl> - ' Abzan ' , <nl> - ' Jeskai ' , <nl> - ' Sultai ' , <nl> - ' Mardu ' , <nl> - ' Temur ' , <nl> - ' Non - White ' , <nl> - ' Non - Blue ' , <nl> - ' Non - Black ' , <nl> - ' Non - Red ' , <nl> - ' Non - Green ' , <nl> - ' Five Color ' , <nl> - ' Land ' , <nl> - ' Other ' , <nl> - ] ; <nl> + return CARD_TYPES . slice ( 0 , - 1 ) <nl> + . concat ( GUILDS ) <nl> + . concat ( SHARDS_AND_WEDGES ) <nl> + . concat ( FOUR_AND_FIVE_COLOR ) <nl> + . concat ( [ ' Land ' , ' Other ' ] ) ; <nl> } <nl> if ( sort = = = ' Legality ' ) { <nl> return [ ' Standard ' , ' Modern ' , ' Legacy ' , ' Vintage ' , ' Pioneer ' , ' Brawl ' , ' Historic ' , ' Pauper ' , ' Penny ' , ' Commander ' ] ; <nl> 
mmm a / packages / react - dev - utils / printHostingInstructions . js <nl> ppp b / packages / react - dev - utils / printHostingInstructions . js <nl> console . log ( ) ; <nl> console . log ( ' Find out more about deployment here : ' ) ; <nl> console . log ( ) ; <nl> - console . log ( ` $ { chalk . yellow ( ' https : / / bit . ly / CRA - deploy ' ) } ` ) ; <nl> + console . log ( ` $ { chalk . yellow ( ' https : / / create - react - app . dev / docs / deployment ' ) } ` ) ; <nl> console . log ( ) ; <nl> } <nl> 
mmm a / CONTRIBUTING . md <nl> ppp b / CONTRIBUTING . md <nl> * * TL ; DR * * use the command ` yarn e2e : docker ` to run unit and e2e tests . <nl> - More detailed information are in the dedicated [ README ] ( / packages / react - scripts / fixtures / kitchensink / README . md ) . <nl> + More detailed information are in the dedicated [ README ] ( / test / README . md ) . <nl> # # # CI testing with private packages <nl> 
mmm a / components / UpdateProfileForm / __tests__ / __snapshots__ / UpdateProfileForm . test . js . snap <nl> ppp b / components / UpdateProfileForm / __tests__ / __snapshots__ / UpdateProfileForm . test . js . snap <nl> > <nl> Professional Details <nl> < / h3 > <nl> + < div <nl> + className = " ProgressIndicator " <nl> + > <nl> + < div > <nl> + 0 <nl> + / <nl> + 3 <nl> + Complete <nl> + < / div > <nl> + < div <nl> + className = " bar " <nl> + > <nl> + < div <nl> + className = " progress " <nl> + style = { <nl> + Object { <nl> + " width " : " 0 % " , <nl> + } <nl> + } <nl> + / > <nl> + < / div > <nl> + < / div > <nl> < div <nl> className = " row " <nl> > <nl> 
mmm a / components / SocialLoginGroup / SocialLoginGroup . css <nl> ppp b / components / SocialLoginGroup / SocialLoginGroup . css <nl> / * Github * / <nl> - <nl> - / * WHITE * / <nl> - <nl> - / * . githubButton { <nl> - color : # 24292e ; <nl> - background : # eff3f6 ; <nl> - transition : opacity 0 . 15s linear ; <nl> - border : 1px solid # 1b1f23 ; <nl> - } <nl> - <nl> - . githubButton : : before { <nl> - border - right : # 1b1f23 1px solid ; <nl> - background - color : # eff3f6 ; <nl> - background - image : url ( " http : / / localhost : 3000 / static / images / icons / github_logo_black . svg " ) ; <nl> - background - repeat : no - repeat ; <nl> - } <nl> - <nl> - . githubButton : active , <nl> - . githubButton : hover , <nl> - . githubButton : focus { <nl> - opacity : 0 . 8 ; <nl> - cursor : pointer ; <nl> - } * / <nl> - <nl> - / * . githubButton { <nl> - color : # 24292e ; <nl> - background : # eff3f6 ; <nl> - transition : opacity 0 . 15s linear ; <nl> - border : 1px solid # 1b1f23 ; <nl> - } <nl> - <nl> - . githubButton : : before { <nl> - content : url ( " http : / / localhost : 3000 / static / images / icons / github_logo_black . svg " ) ; <nl> - border - right : # 1b1f23 1px solid ; <nl> - / * background - color : # eff3f6 ; <nl> - background - image : url ( " http : / / localhost : 3000 / static / images / icons / github_logo . svg " ) ; <nl> - background - repeat : no - repeat ; <nl> - } <nl> - <nl> - . githubButton : active , <nl> - . githubButton : hover , <nl> - . githubButton : focus { <nl> - opacity : 0 . 8 ; <nl> - cursor : pointer ; <nl> - } * / <nl> - <nl> - / * BLACK * / <nl> . githubButton { <nl> color : # eff3f6 ; <nl> background : # 24292e ; <nl> . githubButton : : before { <nl> border - right : # b0b0b0 1px solid ; <nl> - background : url ( " http : / / localhost : 3000 / static / images / icons / github_octocat_logo . svg " ) 4px 4px <nl> - no - repeat ; <nl> + background : url ( " / static / images / icons / github_octocat_logo . svg " ) 4px 4px no - repeat ; <nl> } <nl> . githubButton : active , <nl> 
mmm a / . github / workflows / nodejs . yml <nl> ppp b / . github / workflows / nodejs . yml <nl> run : lerna bootstrap <nl> - name : Lint <nl> run : redrun fix : lint <nl> + <nl> + - uses : actions - rs / toolchain @ v1 <nl> + with : <nl> + toolchain : stable <nl> + <nl> + - uses : actions - rs / cargo @ v1 <nl> + with : <nl> + command : install <nl> + args : typos - cli <nl> + <nl> + - name : Typos <nl> + run : typos - - write - changes | | true <nl> + <nl> - name : Commit fixes <nl> uses : EndBug / add - and - commit @ v7 <nl> with : <nl> @ @ - 34 , 5 + 47 , 3 @ @ jobs : <nl> uses : coverallsapp / github - action @ master <nl> with : <nl> github - token : $ { { secrets . GITHUB_TOKEN } } <nl> - - name : typos - action <nl> - uses : crate - ci / typos @ v1 . 0 . 4 <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + fix : <nl> + - @ putout / plugin - madrun : description <nl> + <nl> + feature : <nl> + - @ putout / plugin - logical - expressions : add remove - duplicates <nl> + - @ putout / plugin - logical - expressions : add <nl> + - ( package ) @ putout / plugin - simplify - logical - expressions v4 . 0 . 0 <nl> + - ( @ putout / plugin - simplify - logical - expressions ) merge @ putout / plugin - remove - duplicates - from - logical - expressions <nl> + <nl> 2022 . 08 . 24 , v27 . 2 . 0 <nl> feature : <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + fix : <nl> + - putout : exit codes <nl> + <nl> 2022 . 08 . 24 , v27 . 3 . 0 <nl> fix : <nl> 
mmm a / packages / engine - runner / package . json <nl> ppp b / packages / engine - runner / package . json <nl> " name " : " @ putout / engine - runner " , <nl> - " version " : " 14 . 0 . 0 " , <nl> + " version " : " 14 . 0 . 1 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " run putout plugins " , <nl> 
mmm a / . github / workflows / nodejs . yml <nl> ppp b / . github / workflows / nodejs . yml <nl> key : $ { { runner . os } } - cargo - $ { { hashFiles ( ' * * / Cargo . lock ' ) } } <nl> - name : Typos Install <nl> - run : cargo install typos - cli | | echo ' already installed ' <nl> + run : which typos | | cargo install typos - cli <nl> - name : Typos <nl> run : typos - - write - changes <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + feature : <nl> + - @ putout / eslint : add <nl> + - package : @ putout / eslint v1 . 0 . 0 <nl> + <nl> 2022 . 08 . 27 , v27 . 6 . 0 <nl> fix : <nl> 
mmm a / . nycrc . json <nl> ppp b / . nycrc . json <nl> " packages / * / coverage " , <nl> " packages / * / bin " , <nl> - " packages / * / test " <nl> + " packages / * / test " , <nl> + " * * / eslint . config . js " <nl> ] , <nl> " branches " : 100 , <nl> " lines " : 100 , <nl> 
mmm a / packages / plugin - remove - iife / lib / remove - iife . js <nl> ppp b / packages / plugin - remove - iife / lib / remove - iife . js <nl> } ; <nl> module . exports . replace = ( ) = > ( { <nl> - ' ( ( __args__a ) = > __c ( __args__a ) ) ( __args__b ) ' : ' __c ( __args__b ) ' , <nl> + ' ( ( __args__a ) = > __f ( __args__a ) ) ( __args__b ) ' : ' __f ( __args__b ) ' , <nl> ' ( ( ) = > __body ) ( ) ' : ' __body ' , <nl> ' ( function ( ) { } ) ( ) ' : ( vars , path ) = > { <nl> const { body } = path . node . callee . body ; <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + feature : <nl> + - putout : * . md : typescript / remove - unused - types : off <nl> + <nl> 2022 . 09 . 20 , v27 . 9 . 0 <nl> feature : <nl> 
mmm a / packages / engine - processor / package . json <nl> ppp b / packages / engine - processor / package . json <nl> " name " : " @ putout / engine - processor " , <nl> - " version " : " 6 . 1 . 0 " , <nl> + " version " : " 6 . 2 . 0 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " run processors " , <nl> 
mmm a / packages / engine - processor / package . json <nl> ppp b / packages / engine - processor / package . json <nl> " name " : " @ putout / engine - processor " , <nl> - " version " : " 6 . 2 . 0 " , <nl> + " version " : " 6 . 3 . 0 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " run processors " , <nl> 
mmm a / packages / engine - processor / package . json <nl> ppp b / packages / engine - processor / package . json <nl> " name " : " @ putout / engine - processor " , <nl> - " version " : " 6 . 3 . 0 " , <nl> + " version " : " 6 . 4 . 0 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " run processors " , <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + feature : <nl> + - putout : add yarn files to ignore <nl> + - @ putout / test : processor : add ability to pass processorRunners <nl> + - @ putout / engine - runner : improve support of passed processorRunners <nl> + <nl> 2022 . 09 . 20 , v27 . 11 . 0 <nl> fix : <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + feature : <nl> + - putout : add . git to ignore <nl> + <nl> 2022 . 09 . 21 , v27 . 12 . 0 <nl> feature : <nl> 
mmm a / packages / engine - processor / package . json <nl> ppp b / packages / engine - processor / package . json <nl> " name " : " @ putout / engine - processor " , <nl> - " version " : " 6 . 4 . 0 " , <nl> + " version " : " 6 . 4 . 1 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " run processors " , <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + feature : <nl> + - @ putout / plugin - math : add apply - numeric - separators <nl> + - @ putout / plugin - math : add apply - multiplication <nl> + - @ putout / plugin - math : add apply - exponentiation <nl> + - @ putout / plugin - math : add convert - sqrt - to - hypot <nl> + - putout : add @ putout / plugin - math <nl> + - package : lerna v6 . 0 . 1 <nl> + - @ putout / plugin - remove - empty : block : report <nl> + - @ putout / plugin - remove - empty : add static - block <nl> + <nl> 2022 . 09 . 22 , v27 . 13 . 0 <nl> feature : <nl> 
mmm a / packages / cli - match / package . json <nl> ppp b / packages / cli - match / package . json <nl> " name " : " @ putout / cli - match " , <nl> - " version " : " 1 . 0 . 1 " , <nl> + " version " : " 2 . 0 . 0 " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " convert \ " rules \ " section to \ " match \ " in . putout . json " , <nl> " homepage " : " https : / / github . com / coderaiser / putout / tree / master / packages / cli - match # readme " , <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + fix : <nl> + - @ putout / compare : __children - > __jsx_children <nl> + <nl> + feature : <nl> + - package : @ putout / cli - match v2 . 0 . 0 <nl> + - @ putout / cli - match : drop support of node < 16 <nl> + - @ putout / cli - match : change " match ( ) " return signature : code - > { code , message } <nl> + - @ putout / plugin - remove - useless - spread : add support of sparse arrays ( # 119 ) <nl> + - @ putout / compare : __jsx_children : improve support <nl> + - @ putout / compare : improve support of jsx expressions <nl> + - @ putout / compare : improve __jsx_children support <nl> + - @ putout / compare : add support of JSXElement ( # 116 ) <nl> + - @ putout / engine - parser : template : add support of jsx <nl> + - @ putout / engine - runner : replacer : add support of jsx ( # 116 ) <nl> + - @ putout / compare : add support of JSXText ( # 116 ) <nl> + - @ putout / operate : extract : add support of JSXText ( # 116 ) <nl> + - @ putout / plugin - github : create - uses - fixer <nl> + - @ putout / plugin - github : add set - add - and - commit ( EndBug / add - and - commit # 448 ) <nl> + - @ putout / plugin - github : set - setup - node : set v3 <nl> + - @ putout / plugin - nodejs : set - checkout - version : add support of actions / checkout v3 <nl> + <nl> 2022 . 10 . 30 , v28 . 0 . 1 <nl> feature : <nl> 
mmm a / packages / engine - loader / package . json <nl> ppp b / packages / engine - loader / package . json <nl> " name " : " @ putout / engine - loader " , <nl> - " version " : " 7 . 1 . 1 " , <nl> + " version " : " 7 . 1 . 2 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " load plugins and prepare them to run " , <nl> 
mmm a / packages / engine - processor / package . json <nl> ppp b / packages / engine - processor / package . json <nl> " name " : " @ putout / engine - processor " , <nl> - " version " : " 6 . 4 . 1 " , <nl> + " version " : " 6 . 4 . 2 " , <nl> " type " : " commonjs " , <nl> " author " : " coderaiser < mnemonic . enemy @ gmail . com > ( https : / / github . com / coderaiser ) " , <nl> " description " : " run processors " , <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + feature : <nl> + - package : nano - memoize v2 . 0 . 0 <nl> + - @ putout / plugin - logical - expressions : simplify : add support of OptionalChaining <nl> + - @ putout / plugin - extract - sequence - expressions : add support of IfStatement test ( # 126 ) <nl> + - @ putout / plugin - remove - unused - variables : add support of SequenceExpressions ( # 126 ) <nl> + <nl> 2022 . 12 . 26 , v28 . 2 . 0 <nl> feature : <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + fix : <nl> + - @ putout / plugin - apply - is - array : description <nl> + <nl> + feature : <nl> + - package : cosmiconfig v8 . 0 . 0 <nl> + - @ putout / plugin - apply - flat - map : add <nl> + <nl> 2022 . 12 . 29 , v28 . 3 . 0 <nl> feature : <nl> 
mmm a / packages / putout / ChangeLog <nl> ppp b / packages / putout / ChangeLog <nl> + <nl> + fix : <nl> + - @ putout / plugin - regexp : remove - useless - group : report after transform <nl> + <nl> + feature : <nl> + - @ putout / plugin - apply - maybe : add <nl> + - @ putout / plugin - regexp : apply - literal - notation : report : message <nl> + - @ putout / plugin - regexp : apply - literal - notation : improve support of @ putout / plugin - remove - useless - escape <nl> + - @ putout / plugin - regexp : remove - useless - group : improve support of apply - literal - notation <nl> + <nl> 2023 . 02 . 03 , v28 . 15 . 0 <nl> feature : <nl> 
mmm a / src / helpers / compiler . js <nl> ppp b / src / helpers / compiler . js <nl> var template = options . template | | ' ' ; <nl> var controller = options . controller ; <nl> var controllerAs = options . controllerAs ; <nl> - var resolve = angular . copy ( options . resolve | | { } ) ; <nl> - var locals = angular . copy ( options . locals | | { } ) ; <nl> + var resolve = options . resolve | | { } ; <nl> + var locals = options . locals | | { } ; <nl> var transformTemplate = options . transformTemplate | | angular . identity ; <nl> var bindToController = options . bindToController ; <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - If you don ' t want to use ` ngAnimate ` , you will have to include a tiny [ ngAnimate mock ] ( https : / / github . com / mgcrea / angular - strap / wiki / ngAnimate - mock ) . <nl> + # # Looking for maintainers ! <nl> + <nl> + We ' re currently looking for aspiring maintainers to tackle issues and pull requests ! <nl> + <nl> + I ( mgcrea ) have not worked on any Angular . js v1 codebase for more than a year now . For me it ' s time to move on ! <nl> + <nl> + If you have an ongoing project depending on AngularStrap , and would like to become a contributor , please chime in on [ issue # 2256 ] ( https : / / github . com / mgcrea / angular - strap / issues / 2256 ) <nl> + <nl> + <nl> # # Documentation and examples <nl> + Check the [ documentation ] ( http : / / mgcrea . github . io / angular - strap ) and [ changelog ] ( https : / / github . com / mgcrea / angular - strap / releases ) . <nl> 
mmm a / src / __tests__ / DropdownMenu . spec . js <nl> ppp b / src / __tests__ / DropdownMenu . spec . js <nl> } ) ; <nl> it ( ' should render custom tag ' , ( ) = > { <nl> - const wrapper = shallow ( < DropdownMenu tag = " main " > Yo ! < / DropdownMenu > ) ; <nl> + const wrapper = shallow ( < DropdownMenu tag = " main " > Yo ! < / DropdownMenu > , <nl> + { <nl> + context : { <nl> + isOpen : isOpen <nl> + } <nl> + } ) ; <nl> expect ( wrapper . text ( ) ) . toBe ( ' Yo ! ' ) ; <nl> expect ( wrapper . hasClass ( ' dropdown - menu ' ) ) . toBe ( true ) ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " react - addons - test - utils " : " ^ 15 . 3 . 0 " , <nl> " react - dom " : " ^ 15 . 3 . 0 " , <nl> - " react - helmet " : " ^ 3 . 0 . 1 " , <nl> - " react - prism " : " 4 . 0 . 0 " , <nl> + " react - helmet " : " ^ 5 . 0 . 3 " , <nl> + " react - prism " : " ^ 4 . 1 . 0 " , <nl> " react - router " : " ^ 2 . 6 . 1 " , <nl> - " react - test - renderer " : " ^ 15 . 5 . 4 " , <nl> " react - scripts " : " ^ 0 . 9 . 5 " , <nl> + " react - test - renderer " : " ^ 15 . 5 . 4 " , <nl> " react - transition - group " : " ^ 1 . 1 . 2 " , <nl> " rollup " : " ^ 0 . 41 . 5 " , <nl> " rollup - plugin - babel " : " ^ 2 . 7 . 1 " , <nl> - " rollup - plugin - babili " : " ^ 2 . 0 . 0 " , <nl> + " rollup - plugin - babili " : " ^ 3 . 0 . 0 " , <nl> " rollup - plugin - commonjs " : " ^ 8 . 0 . 2 " , <nl> - " rollup - plugin - node - resolve " : " ^ 2 . 0 . 0 " , <nl> + " rollup - plugin - node - resolve " : " ^ 3 . 0 . 0 " , <nl> " static - site - generator - webpack - plugin " : " ^ 2 . 0 . 1 " , <nl> " style - loader " : " ^ 0 . 13 . 1 " , <nl> " webpack " : " ^ 1 . 12 . 13 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " version " : " 4 . 6 . 1 " , <nl> " description " : " React Bootstrap 4 components " , <nl> - " main " : " dist / reactstrap . min . js " , <nl> + " main " : " lib / index . js " , <nl> " jsnext : main " : " dist / reactstrap . es . js " , <nl> " module " : " dist / reactstrap . es . js " , <nl> " scripts " : { <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Install reactstrap and Bootstrap from NPM . Reactstrap does not include Bootstrap CSS so this needs to be installed as well : <nl> ` ` ` <nl> - npm install bootstrap @ 4 . 0 . 0 - alpha . 6 - - save <nl> - npm install - - save reactstrap react - transition - group react react - dom <nl> + npm install - - save bootstrap @ 4 . 0 . 0 - alpha . 6 <nl> + npm install - - save reactstrap react - transition - group @ ^ 1 . 1 . 2 react @ ^ 15 . 3 . 0 react - dom @ ^ 15 . 3 . 0 <nl> ` ` ` <nl> Import Bootstrap CSS in the ` ` ` src / index . js ` ` ` file : <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " scripts " : { <nl> " report - coverage " : " coveralls < . / coverage / lcov . info " , <nl> - " test " : " BABEL_ENV = test react - scripts test - - env = jsdom " , <nl> + " test " : " cross - env BABEL_ENV = test react - scripts test - - env = jsdom " , <nl> " cover " : " npm test - - - - coverage " , <nl> - " start " : " BABEL_ENV = webpack webpack - dev - server - - config . / webpack . dev . config . js - - watch " , <nl> + " start " : " cross - env BABEL_ENV = webpack webpack - dev - server - - config . / webpack . dev . config . js - - watch " , <nl> " build - docs " : " cross - env WEBPACK_BUILD = production webpack - - config . / webpack . dev . config . js - - progress - - colors " , <nl> " build " : " rollup - c " , <nl> - " prebuild " : " BABEL_ENV = lib - dir babel src - - out - dir lib - - ignore src / __tests__ / " , <nl> + " prebuild " : " cross - env BABEL_ENV = lib - dir babel src - - out - dir lib - - ignore src / __tests__ / " , <nl> " create - release " : " npm test & & sh . / scripts / release " , <nl> " publish - release " : " npm test & & sh . / scripts / publish " , <nl> " lint " : " eslint src " <nl> 
mmm a / LICENSE <nl> ppp b / LICENSE <nl> - Copyright ( c ) 2016 Eddy Hernandez , Chris Burrell <nl> + Copyright ( c ) 2016 - Present Eddy Hernandez , Chris Burrell , Evan Sharp <nl> Permission is hereby granted , free of charge , to any person obtaining a copy <nl> of this software and associated documentation files ( the " Software " ) , to deal <nl> 
mmm a / docs / lib / examples / ModalNested . js <nl> ppp b / docs / lib / examples / ModalNested . js <nl> Lorem ipsum dolor sit amet , consectetur adipisicing elit , sed do eiusmod tempor incididunt ut labore et dolore magna aliqua . Ut enim ad minim veniam , quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat . Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur . Excepteur sint occaecat cupidatat non proident , sunt in culpa qui officia deserunt mollit anim id est laborum . <nl> < br / > <nl> < Button color = " success " onClick = { this . toggleNested } > Show Nested Model < / Button > <nl> - < Modal isOpen = { this . state . nestedModal } toggle = { this . toggleNested } onClosed = { this . state . closeAll & & this . toggle } > <nl> + < Modal isOpen = { this . state . nestedModal } toggle = { this . toggleNested } onClosed = { this . state . closeAll ? this . toggle : undefined } > <nl> < ModalHeader > Nested Modal title < / ModalHeader > <nl> < ModalBody > Stuff and things < / ModalBody > <nl> < ModalFooter > <nl> 
mmm a / docs / lib / examples / FormInline . js <nl> ppp b / docs / lib / examples / FormInline . js <nl> render ( ) { <nl> return ( <nl> < Form inline > <nl> - < FormGroup > <nl> - < Label for = " exampleEmail " > Email < / Label > { ' ' } <nl> + < FormGroup className = " mb - 2 mr - sm - 2 mb - sm - 0 " > <nl> + < Label for = " exampleEmail " className = " mr - sm - 2 " > Email < / Label > <nl> < Input type = " email " name = " email " id = " exampleEmail " placeholder = " something @ idk . cool " / > <nl> < / FormGroup > <nl> - { ' ' } <nl> - < FormGroup > <nl> - < Label for = " examplePassword " > Password < / Label > { ' ' } <nl> + < FormGroup className = " mb - 2 mr - sm - 2 mb - sm - 0 " > <nl> + < Label for = " examplePassword " className = " mr - sm - 2 " > Password < / Label > <nl> < Input type = " password " name = " password " id = " examplePassword " placeholder = " don ' t tell ! " / > <nl> < / FormGroup > <nl> - { ' ' } <nl> < Button > Submit < / Button > <nl> < / Form > <nl> ) ; <nl> 
mmm a / src / UncontrolledNavDropdown . js <nl> ppp b / src / UncontrolledNavDropdown . js <nl> + import React from ' react ' ; <nl> import { warnOnce } from ' . / utils ' ; <nl> - import NavDropdown from ' . / NavDropdown ' ; <nl> + import UncontrolledDropdown from ' . / UncontrolledDropdown ' ; <nl> - export default class UncontrolledNavDropdown extends Component { <nl> - constructor ( props ) { <nl> - super ( props ) ; <nl> - <nl> - this . state = { isOpen : false } ; <nl> - this . toggle = this . toggle . bind ( this ) ; <nl> - } <nl> - <nl> - toggle ( ) { <nl> - this . setState ( { isOpen : ! this . state . isOpen } ) ; <nl> - } <nl> - <nl> - render ( ) { <nl> + const UncontrolledNavDropdown = ( ) = > { <nl> warnOnce ( ' The " UncontrolledNavDropdown " component has been deprecated . \ nPlease use component " UncontrolledDropdown " with nav prop . ' ) ; <nl> - return < NavDropdown isOpen = { this . state . isOpen } toggle = { this . toggle } { . . . this . props } / > ; <nl> - } <nl> - } <nl> + return < UncontrolledDropdown nav { . . . this . props } / > ; <nl> + } ; <nl> + <nl> + export default UncontrolledNavDropdown ; <nl> 
mmm a / docs / lib / examples / ButtonGroup . js <nl> ppp b / docs / lib / examples / ButtonGroup . js <nl> render ( ) { <nl> return ( <nl> < ButtonGroup > <nl> - < Button > Left < / Button > { ' ' } <nl> - < Button > Middle < / Button > { ' ' } <nl> + < Button > Left < / Button > <nl> + < Button > Middle < / Button > <nl> < Button > Right < / Button > <nl> < / ButtonGroup > <nl> ) ; <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ component - template ] ( https : / / reactstrap . github . io / component - template / ) <nl> - [ video - react ] ( https : / / video - react . github . io / ) <nl> - [ CoreUI - Free - Bootstrap - Admin - Template ] ( https : / / github . com / mrholek / CoreUI - Free - Bootstrap - Admin - Template ) - [ demo ] ( http : / / coreui . io / demo / React_Demo / # / ) <nl> + - [ Admin dashboard example app built with reactstrap ] ( https : / / github . com / reduction - admin / react - reduction ) - [ demo ] ( https : / / reduction - admin . firebaseapp . com / ) <nl> Submit a PR to add to this list ! <nl> 
mmm a / docs / lib / examples / Navbar . js <nl> ppp b / docs / lib / examples / Navbar . js <nl> render ( ) { <nl> return ( <nl> < div > <nl> - < Navbar color = " faded " light expand = " md " > <nl> + < Navbar color = " light " light expand = " md " > <nl> < NavbarBrand href = " / " > reactstrap < / NavbarBrand > <nl> < NavbarToggler onClick = { this . toggle } / > <nl> < Collapse isOpen = { this . state . isOpen } navbar > <nl> 
mmm a / src / DropdownMenu . js <nl> ppp b / src / DropdownMenu . js <nl> } ; <nl> const DropdownMenu = ( props , context ) = > { <nl> - const { className , cssModule , right , tag , flip , modifiers , . . . attrs } = props ; <nl> + const { className , cssModule , right , tag , flip , modifiers , persist , . . . attrs } = props ; <nl> const classes = mapToCssModules ( classNames ( <nl> className , <nl> ' dropdown - menu ' , <nl> @ @ - 48 , 7 + 48 , 7 @ @ const DropdownMenu = ( props , context ) = > { <nl> let Tag = tag ; <nl> - if ( persist | | ( context . isOpen & & ! context . inNavbar ) { <nl> + if ( persist | | ( context . isOpen & & ! context . inNavbar ) ) { <nl> Tag = Popper ; <nl> const position1 = directionPositionMap [ context . direction ] | | ' bottom ' ; <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ video - react ] ( https : / / video - react . github . io / ) <nl> - [ CoreUI - Free - Bootstrap - Admin - Template ] ( https : / / github . com / mrholek / CoreUI - Free - Bootstrap - Admin - Template ) - [ demo ] ( http : / / coreui . io / demo / React_Demo / # / ) <nl> - [ Admin dashboard example app built with reactstrap ] ( https : / / github . com / reduction - admin / react - reduction ) - [ demo ] ( https : / / reduction - admin . firebaseapp . com / ) <nl> + - [ DevExtreme React Grid ] ( https : / / devexpress . github . io / devextreme - reactive / react / grid / ) - It ' s a stateless data grid built on top of ` reactstrap ` with paging , sorting , filtering , grouping , selection , editing and virtual scrolling features . <nl> Submit a PR to add to this list ! <nl> 
mmm a / docs / lib / Components / CollapsePage . js <nl> ppp b / docs / lib / Components / CollapsePage . js <nl> < SectionTitle > Events < / SectionTitle > <nl> < p > <nl> - Use the < code > onEnter < / code > , onEntering , onEntered , onExit , onExiting and onExited props for callbacks when the <nl> + Use the < code > onEnter < / code > , onEntering , onEntered , onExiting and onExited props for callbacks when the <nl> Collapse has finished opening ( entering ) or closing ( exiting ) . <nl> < / p > <nl> < div className = " docs - example " > <nl> 
mmm a / docs / lib / Home / index . js <nl> ppp b / docs / lib / Home / index . js <nl> < h3 className = " mt - 5 " > NPM < / h3 > <nl> < p > Install reactstrap and peer dependencies via NPM < / p > <nl> < pre > <nl> - < PrismCode className = " language - bash " > npm install - - save reactstrap @ next react react - dom < / PrismCode > <nl> + < PrismCode className = " language - bash " > npm install - - save reactstrap react react - dom < / PrismCode > <nl> < / pre > <nl> < p > Import the components you need < / p > <nl> < div className = " docs - example " > <nl> @ @ - 67 , 7 + 67 , 7 @ @ npm start ` } <nl> < pre > <nl> < PrismCode className = " language - bash " > <nl> { ` npm install bootstrap - - save <nl> - npm install - - save reactstrap @ next react react - dom ` } <nl> + npm install - - save reactstrap react react - dom ` } <nl> < / PrismCode > <nl> < / pre > <nl> < p > Import Bootstrap CSS in the < code > src / index . js < / code > file : < / p > <nl> 
mmm a / docs / lib / Home / index . js <nl> ppp b / docs / lib / Home / index . js <nl> Easy to use React Bootstrap 4 components <nl> < / p > <nl> < p > <nl> - < Button outline color = " danger " href = " https : / / github . com / reactstrap / reactstrap " > View on Github < / Button > <nl> - < Button color = " danger " tag = { Link } to = " / components / " > View Components < / Button > <nl> + < Button outline color = " danger " href = " https : / / github . com / reactstrap / reactstrap " > GitHub < / Button > <nl> + < Button color = " danger " tag = { Link } to = " / components / " > Components < / Button > <nl> < / p > <nl> < / Col > <nl> < / Row > <nl> 
mmm a / docs / lib / UI / Nav . js <nl> ppp b / docs / lib / UI / Nav . js <nl> < NavLink tag = { Link } to = " / utilities / " activeClassName = " active " > Utilities < / NavLink > <nl> < / NavItem > <nl> < NavItem > <nl> - < NavLink href = " https : / / github . com / reactstrap / reactstrap " > Github < / NavLink > <nl> + < NavLink href = " https : / / github . com / reactstrap / reactstrap " > GitHub < / NavLink > <nl> < / NavItem > <nl> < / Nav > <nl> < / Collapse > <nl> 
mmm a / docs / lib / Home / index . js <nl> ppp b / docs / lib / Home / index . js <nl> { ` import { Button } from ' reactstrap ' ; ` } <nl> < / PrismCode > <nl> < / pre > <nl> - < p > Now you are ready to use the imported reactstrap components within your component hierarchy defined in the render method . Here is an example < a href = " https : / / gist . github . com / eddywashere / e13033c0e655ab7cda995f8bc77ce40d " target = " _blank " > < code > App . js < / code > < / a > redone using reactstrap . < / p > <nl> + < p > Now you are ready to use the imported reactstrap components within your component hierarchy defined in the render method . Here is an example < a href = " https : / / gist . github . com / Thomas - Smyth / 006fd507a7295f17a8473451938f9935 " target = " _blank " > < code > App . js < / code > < / a > redone using reactstrap . < / p > <nl> < h2 className = " mt - 5 " > CDN < / h2 > <nl> < p > Reactstrap can be included directly in your application ' s bundle or excluded during compilation and linked directly to a CDN . < / p > <nl> < pre > <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " unpkg " : " dist / reactstrap . min . js " , <nl> " cdn " : " dist / reactstrap . min . js " , <nl> + " esnext " : " src " , <nl> " scripts " : { <nl> " report - coverage " : " coveralls < . / coverage / lcov . info " , <nl> " test " : " cross - env BABEL_ENV = test react - scripts test - - env = jsdom " , <nl> " README . md " , <nl> " CHANGELOG . md " , <nl> " lib " , <nl> - " dist " <nl> + " dist " , <nl> + " src " <nl> ] , <nl> " keywords " : [ <nl> " reactstrap " , <nl> 
mmm a / ISSUE_TEMPLATE . md <nl> ppp b / ISSUE_TEMPLATE . md <nl> - reactstrap version ` # x . x . x ` <nl> - - import method ` umd / csj / es ` ( if umd , are you using the " full " version ( only for v5 + ) ? ) <nl> + - import method ` umd / csj / es ` < ! - - ( if umd , are you using the " full " version ( only for v5 + ) ? ) - - > <nl> - react version ` # x . x . x ` <nl> - bootstrap version ` # x . x . x ` <nl> @ @ - 29 , 9 + 29 , 8 @ @ paste error message with stacktrack here <nl> # # # Code <nl> < ! - - <nl> - Fork a link ( for the corresponding version ) and update it to demonstrate your issue . <nl> - - v4 ( with react 15 ) : issue http : / / codepen . io / eddywashere / pen / ZOjmkm <nl> - - v5 ( with react 16 ) : issue https : / / codepen . io / TheSharpieOne / pen / GMMPEZ <nl> + Fork the link and update it to demonstrate your issue . <nl> + https : / / stackblitz . com / edit / reactstrap ? file = Example . js <nl> and / or add the code which causes the issue directly here <nl> - - > <nl> 
mmm a / src / Tooltip . js <nl> ppp b / src / Tooltip . js <nl> this . show = this . show . bind ( this ) ; <nl> this . hide = this . hide . bind ( this ) ; <nl> this . onEscKeyDown = this . onEscKeyDown . bind ( this ) ; <nl> - this . handleFocusIn = this . handleFocusIn . bind ( this ) ; <nl> - this . handleFocusOut = this . handleFocusOut . bind ( this ) ; <nl> } <nl> componentDidMount ( ) { <nl> @ @ - 126 , 14 + 124 , 6 @ @ class Tooltip extends React . Component { <nl> return delay ; <nl> } <nl> - handleFocusIn ( ) { <nl> - this . show ( ) ; <nl> - } <nl> - <nl> - handleFocusOut ( ) { <nl> - this . hide ( ) ; <nl> - } <nl> - <nl> show ( ) { <nl> if ( ! this . props . isOpen ) { <nl> this . clearShowTimeout ( ) ; <nl> @ @ - 174 , 8 + 164 , 8 @ @ class Tooltip extends React . Component { <nl> this . _target . addEventListener ( ' mouseover ' , this . onMouseOverTooltip , true ) ; <nl> this . _target . addEventListener ( ' mouseout ' , this . onMouseLeaveTooltip , true ) ; <nl> this . _target . addEventListener ( ' keydown ' , this . onEscKeyDown , true ) ; <nl> - this . _target . addEventListener ( ' focusin ' , this . handleFocusIn , true ) ; <nl> - this . _target . addEventListener ( ' focusout ' , this . handleFocusOut , true ) ; <nl> + this . _target . addEventListener ( ' focusin ' , this . show , true ) ; <nl> + this . _target . addEventListener ( ' focusout ' , this . hide , true ) ; <nl> [ ' click ' , ' touchstart ' ] . forEach ( event = > <nl> @ @ - 187 , 8 + 177 , 8 @ @ class Tooltip extends React . Component { <nl> this . _target . removeEventListener ( ' mouseover ' , this . onMouseOverTooltip , true ) ; <nl> this . _target . removeEventListener ( ' mouseout ' , this . onMouseLeaveTooltip , true ) ; <nl> this . _target . addEventListener ( ' keydown ' , this . onEscKeyDown , true ) ; <nl> - this . _target . addEventListener ( ' focusin ' , this . handleFocusIn , true ) ; <nl> - this . _target . addEventListener ( ' focusout ' , this . handleFocusOut , true ) ; <nl> + this . _target . addEventListener ( ' focusin ' , this . show , true ) ; <nl> + this . _target . addEventListener ( ' focusout ' , this . hide , true ) ; <nl> [ ' click ' , ' touchstart ' ] . forEach ( event = > <nl> document . removeEventListener ( event , this . handleDocumentClick , true ) <nl> 
mmm a / docs / lib / examples / ModalCustomTimeout . js <nl> ppp b / docs / lib / examples / ModalCustomTimeout . js <nl> return ( <nl> < div > <nl> < Button color = " danger " onClick = { this . toggle } > { this . props . buttonLabel } < / Button > <nl> - < Modal isOpen = { this . state . modal } modalTransition = { { timeout : 20 } } backdropTransition = { { timeout : 10 } } <nl> + < Modal isOpen = { this . state . modal } modalTransition = { { timeout : 700 } } backdropTransition = { { timeout : 1300 } } <nl> toggle = { this . toggle } className = { this . props . className } > <nl> < ModalHeader toggle = { this . toggle } > Modal title < / ModalHeader > <nl> < ModalBody > <nl> 
mmm a / docs / lib / examples / FormFeedback . js <nl> ppp b / docs / lib / examples / FormFeedback . js <nl> < FormFeedback > Oh noes ! that name is already taken < / FormFeedback > <nl> < FormText > Example help text that remains unchanged . < / FormText > <nl> < / FormGroup > <nl> + < p > Invalid checkboxes ( or radio ) < / p > <nl> + < FormGroup check > <nl> + < Input id = " cityNewyork " type = " checkbox " / > <nl> + < Label for = " cityNewyork " check > New York < / Label > <nl> + < / FormGroup > <nl> + < FormGroup check > <nl> + < Input id = " invalidCityCheckbox " type = " checkbox " invalid / > <nl> + < Label for = " invalidCityCheckbox " check > Gotham < / Label > <nl> + < FormFeedback > Gotham is not a real city . < / FormFeedback > <nl> + < / FormGroup > <nl> < / Form > <nl> ) ; <nl> } <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> branches : <nl> only : <nl> - master <nl> - - / ^ \ d + \ . \ d + ( \ . \ d + ) ? ( - \ S * ) ? $ / <nl> + - " / ^ \ \ d + \ \ . \ \ d + ( \ \ . \ \ d + ) ? ( - \ \ S * ) ? $ / " <nl> before_deploy : <nl> - - " echo ' Preparing to publish ' " <nl> + - echo ' Preparing to publish ' <nl> - npm run build <nl> deploy : <nl> provider : npm <nl> - email : " dumbdrum @ gmail . com " <nl> + email : dumbdrum @ gmail . com <nl> api_key : <nl> - secure : P + 6SEhs1BQ8sUygZ3L + Mqe2lxrhA9CB35DOds4d8Lp1LneRMm3jDt / DDBhIxF3N1xhd5f9BaHifyXcOfm + EiNIczkTP2G8wJCaxoA7bVKLNx27 / / kXBUVq7J4vnM3nZltFO7YHd3l46XkTeapQuXVXmbNbT6enQISkwNKMGd / hJk / hNqtS / faJAk84wqjcSGh / wY1YQ7po7FaAUWN2V6y8M8GfW / 8s9BEAlY0sY4QYZr90CnSmOsvFtY / / 0Mx0NevUbo7UcEa + 8cO7YOsrgdIMxQBq3UlN9L2XkQyLBobwShk + GeQhFWNVw5aByluWg8DoY5GOkgRSMhTLUyQ3fKnV8B2Mo1SqsqdSD9830TWY + Br47O1Mx20WrbzkpMdGa / Msmvrk0wMFNY0 + TuMyn6ItMpGnijbKLoM23deiq69TwgUlVLOHGRcuE7P9iyP + bCNgHxPtI3d3akO2ZWO + 8wiVw8sJ29Ywr4x + omFeuyLalfNCGVYF2vg07hT8oWPXNPcNA7Lktqb6PWmaUMGAaLv6Awe8lBu / RT / Tx5rVzdygxKj + xti95vduKaSZp0KfNCkA1txemQCbiuURM5S7KhAhWsDrFJOlYdP5tSf53HhCNrpniAEUXPuNW0aPjgFYYcOVFL / 7U4eWLUaXaFL9mBF4wT6K9ekjHaEOSCjZeKDCw = <nl> + secure : Fth8EnmhP + / TV7Uj5Czz3nwuek40GOnIlWRppqGs2IA + Q / le7V3R4xvgTlA / p5xN17IH1EhT / UVZBoNd1lOi6wcbgqrkeqPTarqNbkhzaEFJokNBkOJR7FmGC41Y76XbqPl2zeU / / p + 7dtrCEUacXCDWEfoCjA34GHaD0snd2yuPXYH0FOy1YkydauqGjLg8Y65g3f94xxAnY2Wm2TJzC5rnCjKPMXKEKAX6LpI5UIbq8UDPP8sFv + JpAkgI1 / ygY8daBOeIurJEUUoVNazZWtvgdMFcBlL90QbP62HTU1vGTMK7cNT64COTlOrP4BdvIgWh1KaYXiboEwFrooA3fp / 1KDNcCC1sXmXa2UoFOAUh9vr4SFBA8vE7tjWEvYtI2zCVD8b5ekLGfPandezKolh8V3sbeJrDFhY0G9lap8ftHWQejohvG / 6xjI + / pe + UDpHH1USIqf0DtAnDn5mNWWav / 5xCp8HlsIsmh5EKCM3 / / a8aWY6H + eMfeEFPzU / X3jC4ZUGZ + D5ZGQQ / NX9tvyeoH0pnRnlZil8MAjf / e2 / IWu66ruAUde3eMpX4h + w0q8bVGvH4ObR7QKiJdTntwJSsp9iO4uBHTSpoo9yYO9ycepMAc5af0Np7K1xOv7ja5BvMesSVzyZsbDK3Q8iOOWBDk54bqV7PrFtRPn + VIjk = <nl> skip_cleanup : true <nl> on : <nl> tags : true <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> # # # tl ; dr <nl> + ` ` ` <nl> + npx create - react - app my - app <nl> + cd my - app / <nl> + npm start <nl> + ` ` ` <nl> + or , if npx ( Node > = 6 and npm > = 5 . 2 ) not available <nl> + <nl> ` ` ` <nl> npm install - g create - react - app <nl> 
mmm a / docs / lib / Utilities / ClearfixPage . js <nl> ppp b / docs / lib / Utilities / ClearfixPage . js <nl> < PageTitle title = " Clearfix " / > <nl> < p > <nl> Easily clear < code className = " highlighter - rouge " > float < / code > s by adding <nl> - < code className = " highlighter - rouge " > . clearfix < / code > <nl> + { ' ' } < code className = " highlighter - rouge " > . clearfix < / code > { ' ' } <nl> < strong > to the parent element < / strong > . <nl> Utilizes < a href = " http : / / nicolasgallagher . com / micro - clearfix - hack / " > <nl> the micro clearfix < / a > as popularized by Nicolas Gallagher . <nl> 
mmm a / docs / lib / examples / Layout . js <nl> ppp b / docs / lib / examples / Layout . js <nl> < Col sm = " 4 " > . col - sm - 4 < / Col > <nl> < / Row > <nl> < Row > <nl> - < Col sm = { { size : 6 , order : 2 , offset : 1 } } > . col - sm - 6 . col - sm - order - 2 . col - sm - offset - 2 < / Col > <nl> + < Col sm = { { size : 6 , order : 2 , offset : 1 } } > . col - sm - 6 . order - sm - 2 . offset - sm - 1 < / Col > <nl> < / Row > <nl> < Row > <nl> - < Col sm = " 12 " md = { { size : 8 , offset : 2 } } > . col - sm - 12 . col - md - 6 . col - md - offset - 3 < / Col > <nl> + < Col sm = " 12 " md = { { size : 6 , offset : 3 } } > . col - sm - 12 . col - md - 6 . offset - md - 3 < / Col > <nl> < / Row > <nl> < Row > <nl> - < Col sm = { { size : ' auto ' , offset : 1 } } > . col - sm . col - sm - offset - 1 < / Col > <nl> - < Col sm = { { size : ' auto ' , offset : 1 } } > . col - sm . col - sm - offset - 1 < / Col > <nl> + < Col sm = { { size : ' auto ' , offset : 1 } } > . col - sm - auto . offset - sm - 1 < / Col > <nl> + < Col sm = { { size : ' auto ' , offset : 1 } } > . col - sm - auto . offset - sm - 1 < / Col > <nl> < / Row > <nl> < / Container > <nl> ) ; <nl> 
mmm a / docs / lib / app . js <nl> ppp b / docs / lib / app . js <nl> debug : false / / Set debug to true if you want to inspect the dropdown <nl> } ) ; <nl> < / script > <nl> + < ! - - avangate : Evan @ lostonia . com - - > <nl> < / body > <nl> < / html > ` ; <nl> callback ( null , markup ) ; <nl> 
mmm a / docs / lib / Components / index . js <nl> ppp b / docs / lib / Components / index . js <nl> name : ' Card ' , <nl> to : ' / components / card / ' <nl> } , <nl> - { <nl> - name : ' Collapse ' , <nl> - to : ' / components / collapse / ' , <nl> - } , <nl> { <nl> name : ' Carousel ' , <nl> to : ' / components / carousel / ' <nl> } , <nl> + { <nl> + name : ' Collapse ' , <nl> + to : ' / components / collapse / ' , <nl> + } , <nl> { <nl> name : ' Dropdowns ' , <nl> to : ' / components / dropdowns / ' <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> } , <nl> " peerDependencies " : { <nl> - " react " : " ^ 16 . 0 . 0 " , <nl> - " react - dom " : " ^ 16 . 0 . 0 " <nl> + " react " : " ^ 16 . 3 . 0 " , <nl> + " react - dom " : " ^ 16 . 3 . 0 " <nl> } , <nl> " devDependencies " : { <nl> " @ babel / cli " : " ^ 7 . 2 . 3 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " reactstrap " , <nl> - " version " : " 7 . 1 . 0 " , <nl> + " version " : " 8 . 0 . 0 " , <nl> " description " : " React Bootstrap 4 components " , <nl> " main " : " lib / index . js " , <nl> " jsnext : main " : " es / index . js " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " reactstrap " , <nl> - " version " : " 8 . 0 . 0 " , <nl> + " version " : " 8 . 0 . 1 " , <nl> " description " : " React Bootstrap 4 components " , <nl> " main " : " lib / index . js " , <nl> " jsnext : main " : " es / index . js " , <nl> 
mmm a / docs / lib / NotFound / index . js <nl> ppp b / docs / lib / NotFound / index . js <nl> < / p > <nl> < p > <nl> < Button outline color = " danger " className = " mr - 1 " tag = { Link } to = " / " > Get Started < / Button > <nl> - < Button color = " danger " tag = { Link } to = " / components " > View Components < / Button > <nl> + < Button color = " danger " tag = { Link } to = " / components / " > View Components < / Button > <nl> < / p > <nl> < / Col > <nl> < / Row > <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " reactstrap " , <nl> - " version " : " 8 . 0 . 1 " , <nl> + " version " : " 8 . 1 . 0 " , <nl> " description " : " React Bootstrap 4 components " , <nl> " main " : " lib / index . js " , <nl> " jsnext : main " : " es / index . js " , <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> - npm run build <nl> deploy : <nl> provider : npm <nl> - email : dumbdrum @ gmail . com <nl> + email : <nl> + secure : AUw8fn5gmJKKXzSvLs + vUZRz / htXtUAApRCy6SD7EZyQMHiFMfXCXdOIcSCyiOsxlvsh + Wv12qmfKySd3Yi3exeGbuZ / rQcK + i582iVBiBVRru2wcQ5iN9E21zgaRYk8c3lHWGDzorrJfr3dMbhmi4atmvrMg / u / jVLmz5h4Y8pHZeJ24WSl26NJo4WH2ibjOADfwKZmTH4jPMICKXpMvmUJ7K49LPE8MRHJRwSefadwtVcLuHHBqNOmDmUfNF9bEgTm0FnOtwEycsS6y1seB6pTOyidz9N5F5fB1eCyVuc / ev27Bvw6HL + i8anchtgGlGJyW / yL6yxycNfkGWaoJ243GhMbt4PTNwtiksolGvbgJ071yoRVqV / 8m8tnTJWyShy16Y96hD2vFKV8lj4Fru3Ad8s0VU40ebslOa1IlzrmxxuUYOhX9Ir1ryHgnf7AEnVwie0p0IbJJY / SqPsa3kIyeoG9RePoruzS + v685GMRM + O7ZN34x4H2UogzWIql9IvpGAUdO5FDP9Ww8BkuLEv4myTZh7x4chqYLKQXoPIBzCzdbO8Hl4t7BYgFB2OLaTdcqPvjeANp7EtDzemCYFtNLuS34HKHQCwKcfr + Ar6 / ZDlSKdWu0w7XC5jk0rYrDn97BKnbnNmn77d6ZWr6bzo439pCu91jW6DEyI6iAOM = <nl> api_key : <nl> - secure : Fth8EnmhP + / TV7Uj5Czz3nwuek40GOnIlWRppqGs2IA + Q / le7V3R4xvgTlA / p5xN17IH1EhT / UVZBoNd1lOi6wcbgqrkeqPTarqNbkhzaEFJokNBkOJR7FmGC41Y76XbqPl2zeU / / p + 7dtrCEUacXCDWEfoCjA34GHaD0snd2yuPXYH0FOy1YkydauqGjLg8Y65g3f94xxAnY2Wm2TJzC5rnCjKPMXKEKAX6LpI5UIbq8UDPP8sFv + JpAkgI1 / ygY8daBOeIurJEUUoVNazZWtvgdMFcBlL90QbP62HTU1vGTMK7cNT64COTlOrP4BdvIgWh1KaYXiboEwFrooA3fp / 1KDNcCC1sXmXa2UoFOAUh9vr4SFBA8vE7tjWEvYtI2zCVD8b5ekLGfPandezKolh8V3sbeJrDFhY0G9lap8ftHWQejohvG / 6xjI + / pe + UDpHH1USIqf0DtAnDn5mNWWav / 5xCp8HlsIsmh5EKCM3 / / a8aWY6H + eMfeEFPzU / X3jC4ZUGZ + D5ZGQQ / NX9tvyeoH0pnRnlZil8MAjf / e2 / IWu66ruAUde3eMpX4h + w0q8bVGvH4ObR7QKiJdTntwJSsp9iO4uBHTSpoo9yYO9ycepMAc5af0Np7K1xOv7ja5BvMesSVzyZsbDK3Q8iOOWBDk54bqV7PrFtRPn + VIjk = <nl> + secure : vnNNG + s14Yqnnj / ZjvMnAvsxd + QeLDlfo / iDA0EyHoFIBaSpApYoPzNd2FSZKyI / 2kMYdKwUT40DF / qS + NBbhKY2M / HPUqomDny6Lw7XJKI7gTmtA2trlUR / fcHucOjW8PhMqQhB90J8J / RuWK2nS1Y3Mrhwtkbx0ShRl2mnWeysFOfrNywIi3bMDfUVWwQNcnC8c + w09F / S9tZKjjSSzcK9 / raEwvZ2iSr2H6HRdlqf7JEl2H6F3k7ltx01FzIzdoTMAYsNENWDZfZUd8vfjmTfbtvVQC6n6uZd28PB1AGdsgy27aeBUe + C28UDlX6p3p6rRsPoLHXYx4hWlGmQvfIyl + vxlSiv8WcOJy2NnXnoJhMeYNmJVEQpBzWlI906z5UCn5 + A3E + mPEKXg0jI / uQF5CFguMwwu2vl5N03ZNtD9tdFR0b53N + GCGkOF7jq7SeviR7b3 / YmdHi9q5hFEmBXdYFzajxsaqUDYvHtVnjHSW3yT8pnxOvnG7JErg28bTdcYRHc / / IVImjktFFsX85ukbGsgAwQAP9oVU0Wz7b0aQ0REnyW2aMroy1JGs8z / voM4aiNfvF6GwrBysWd4AYkalisjkq / LY1G3NDxU9gvPfRIIckgbQcgJ98eSHlG / 2i7HqKlSH9Hf2LBAzkhwke3BTaI / hAuq3k0wDIVSY0 = <nl> skip_cleanup : true <nl> on : <nl> tags : true <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " reactstrap " , <nl> - " version " : " 8 . 2 . 0 " , <nl> + " version " : " 8 . 3 . 0 " , <nl> " description " : " React Bootstrap 4 components " , <nl> " main " : " lib / index . js " , <nl> " jsnext : main " : " es / index . js " , <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> cache : <nl> directories : <nl> - node_modules <nl> - before_script : <nl> - - chmod + x scripts / docs <nl> script : <nl> - npm run lint <nl> - npm run cover - - - - runInBand <nl> after_script : <nl> - npm run report - coverage <nl> - after_success : <nl> - - scripts / docs <nl> env : <nl> global : <nl> secure : Jb9Q9 + XnCh + n5uNJuqUmLmPG6mUUv7iTi5bNeK6TpLdrVKk + 2mLdobV3iRUy / DEqNLwt2lxwzp1oq4YI / lZ0vlUam7HpFWpSf4PAI8ckGRqFdus7K45o + zxHLJ2zBQwXacsZB204qtO8RDdXaNb9PjRGNFdKm3ZuqZTv6PkO + hS05EFxmcW95HiSHpV / qPxKjEsDdCpoTNEA3MP0dNtSKygeht2nFQVr7WkOhkjDvUtU9EypkGbJeBCd0AckqXM0Qvmdi + + csyz5VRQhhUwI / 2BKSjbBVUZ6Q3m8sX2p4G / wFEbhXl5eKTzAYLuf + 9kT9Jg + gKdT30PoChx2NPKHv0XS8BOrKQScs6KIwOVH2 / CNCKqAxh3HkCMSONmqEQRqBK1V / gSCZ4zDX9PgrfyE23FLN / GM4YtBlkVCMLh8Y / hiapXUaDobxh / o2tfOoQkeoZWZeoeIydhwULTDSG2R3PKV7rkGYas0VQ + qtU + i8VG + PzjPT4DRf4xIKzNzJbFIq9oTNYBTasWi6 + OKzNw0uH3ydmRzf + GxaTwOIdR3nRQMQN60dH + 6qeJkrIvpfrGAB5gqTutXPfe0xf2rMrW6dyipnSgGlk1JOgA + cU4CPyHql1OA + ox / kIQ4I3PIJBu5YYE3amFmKLu3vnDHELSzM1CYeOs0sDasRyiDkKE79l0 = <nl> @ @ - 24 , 6 + 20 , 20 @ @ branches : <nl> only : <nl> - master <nl> - " / ^ \ \ d + \ \ . \ \ d + ( \ \ . \ \ d + ) ? ( - \ \ S * ) ? $ / " <nl> + <nl> + jobs : <nl> + include : <nl> + - stage : deploy <nl> + node_js : 12 <nl> + before_script : <nl> + - chmod + x scripts / docs <nl> + script : echo " Deploying . . . " <nl> + after_success : <nl> + - scripts / docs <nl> + branches : <nl> + only : <nl> + - master <nl> + - " / ^ \ \ d + \ \ . \ \ d + ( \ \ . \ \ d + ) ? ( - \ \ S * ) ? $ / " <nl> before_deploy : <nl> - echo ' Preparing to publish ' <nl> - npm run build <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> jobs : <nl> include : <nl> - stage : deploy <nl> + if : tag IS present <nl> node_js : 12 <nl> before_script : <nl> - chmod + x scripts / docs <nl> script : echo " Deploying . . . " <nl> after_success : <nl> - scripts / docs <nl> - branches : <nl> - only : <nl> - - master <nl> - - " / ^ \ \ d + \ \ . \ \ d + ( \ \ . \ \ d + ) ? ( - \ \ S * ) ? $ / " <nl> before_deploy : <nl> - echo ' Preparing to publish ' <nl> - npm run build <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> dist : trusty <nl> language : node_js <nl> - node_js : <nl> - - 10 <nl> - - 11 <nl> - - 12 <nl> cache : <nl> directories : <nl> - node_modules <nl> - script : <nl> - - npm run lint <nl> - - npm run cover - - - - runInBand <nl> - after_script : <nl> - - npm run report - coverage <nl> env : <nl> global : <nl> secure : Jb9Q9 + XnCh + n5uNJuqUmLmPG6mUUv7iTi5bNeK6TpLdrVKk + 2mLdobV3iRUy / DEqNLwt2lxwzp1oq4YI / lZ0vlUam7HpFWpSf4PAI8ckGRqFdus7K45o + zxHLJ2zBQwXacsZB204qtO8RDdXaNb9PjRGNFdKm3ZuqZTv6PkO + hS05EFxmcW95HiSHpV / qPxKjEsDdCpoTNEA3MP0dNtSKygeht2nFQVr7WkOhkjDvUtU9EypkGbJeBCd0AckqXM0Qvmdi + + csyz5VRQhhUwI / 2BKSjbBVUZ6Q3m8sX2p4G / wFEbhXl5eKTzAYLuf + 9kT9Jg + gKdT30PoChx2NPKHv0XS8BOrKQScs6KIwOVH2 / CNCKqAxh3HkCMSONmqEQRqBK1V / gSCZ4zDX9PgrfyE23FLN / GM4YtBlkVCMLh8Y / hiapXUaDobxh / o2tfOoQkeoZWZeoeIydhwULTDSG2R3PKV7rkGYas0VQ + qtU + i8VG + PzjPT4DRf4xIKzNzJbFIq9oTNYBTasWi6 + OKzNw0uH3ydmRzf + GxaTwOIdR3nRQMQN60dH + 6qeJkrIvpfrGAB5gqTutXPfe0xf2rMrW6dyipnSgGlk1JOgA + cU4CPyHql1OA + ox / kIQ4I3PIJBu5YYE3amFmKLu3vnDHELSzM1CYeOs0sDasRyiDkKE79l0 = <nl> - branches : <nl> - only : <nl> - - master <nl> - - " / ^ \ \ d + \ \ . \ \ d + ( \ \ . \ \ d + ) ? ( - \ \ S * ) ? $ / " <nl> + <nl> + stages : <nl> + - lint <nl> + - test <nl> + - deploy <nl> jobs : <nl> include : <nl> + - stage : lint <nl> + node_js : 12 <nl> + script : npm run lint <nl> + - stage : test <nl> + node_js : <nl> + - 10 <nl> + - 11 <nl> + - 12 <nl> + script : npm run cover - - - - runInBand <nl> + after_script : npm run report - coverage <nl> - stage : deploy <nl> if : tag IS present <nl> node_js : 12 <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> dist : trusty <nl> language : node_js <nl> + node_js : <nl> + - 10 <nl> + - 11 <nl> + - 12 <nl> + script : npm run cover - - - - runInBand <nl> + after_script : npm run report - coverage <nl> cache : <nl> directories : <nl> - node_modules <nl> @ @ - 18 , 19 + 24 , 13 @ @ jobs : <nl> - stage : lint <nl> node_js : 12 <nl> script : npm run lint <nl> - - stage : test <nl> - node_js : <nl> - - 10 <nl> - - 11 <nl> - - 12 <nl> - script : npm run cover - - - - runInBand <nl> - after_script : npm run report - coverage <nl> - stage : deploy <nl> if : tag IS present <nl> node_js : 12 <nl> before_script : <nl> - chmod + x scripts / docs <nl> script : echo " Deploying . . . " <nl> + after_script : skip <nl> after_success : <nl> - scripts / docs <nl> before_deploy : <nl> 
mmm a / scripts / docs <nl> ppp b / scripts / docs <nl> git config user . name " Travis - CI " <nl> git config user . email " reactstrap @ github . io " <nl> git add - - all <nl> - git commit - m " docs ( travis ) : publish documentation for $ TRAVIS_COMMIT " <nl> + git commit - m " docs ( travis ) : publish documentation for $ TRAVIS_TAG ( $ TRAVIS_COMMIT ) " <nl> git push origin $ BRANCH > / dev / null 2 > & 1 <nl> - success " Successfully published documentation for $ TRAVIS_COMMIT ! " <nl> + success " Successfully published documentation for $ TRAVIS_TAG ( $ TRAVIS_COMMIT ) ! " <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " reactstrap " , <nl> - " version " : " 8 . 4 . 1 " , <nl> + " version " : " 8 . 5 . 0 " , <nl> " description " : " React Bootstrap 4 components " , <nl> " main " : " lib / index . js " , <nl> " jsnext : main " : " es / index . js " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> } , <nl> " peerDependencies " : { <nl> - " react " : " ^ 16 . 3 . 0 " , <nl> - " react - dom " : " ^ 16 . 3 . 0 " <nl> + " react " : " > = 16 . 3 . 0 " , <nl> + " react - dom " : " > = 16 . 3 . 0 " <nl> } , <nl> " devDependencies " : { <nl> " @ babel / cli " : " ^ 7 . 2 . 3 " , <nl> 
mmm a / PULL_REQUEST_TEMPLATE . md <nl> ppp b / PULL_REQUEST_TEMPLATE . md <nl> What types of changes does your code introduce ? Put an ` x ` in all the boxes that apply : <nl> - - > <nl> + <nl> - [ ] Bug fix < ! - - ( change which fixes an issue ) - - > <nl> - [ ] New feature < ! - - ( change which adds functionality ) - - > <nl> - - [ ] Chore < ! - - ( change which doesn ' t affect the usage of the package ( such as a documentation , build process , or project setup change ) ) - - > <nl> + - [ ] Chore < ! - - ( change which doesn ' t affect the usage of the package ( such as documentation , build process , or project setup changes ) ) - - > <nl> - [ ] Breaking change < ! - - ( fix or feature that would cause existing functionality to change ) - - > <nl> - [ ] There is an open issue which this change addresses <nl> - [ ] I have read the * * [ CONTRIBUTING ] ( . / CONTRIBUTING . md ) * * document . <nl> @ @ - 16 , 8 + 17 , 7 @ @ What types of changes does your code introduce ? Put an ` x ` in all the boxes that <nl> < ! - - Put any other information you believe would be useful to know when reviewing this PR below - - > <nl> - <nl> < ! - - - <nl> If there is an issue this PR addresses , please make sure it is in the commit message per the Git Commit Guidelines above <nl> - * * AND * * put the issue number below , indicating that is closes or fixes the issue . <nl> + * * AND * * put the issue number below , indicating that it closes or fixes the issue . <nl> - - > <nl> 
mmm a / docs / lib / PremiumThemes / premium . js <nl> ppp b / docs / lib / PremiumThemes / premium . js <nl> } , <nl> ] , <nl> } , <nl> + { <nl> + creator : { <nl> + name : ' PIXINVENT ' , <nl> + tagLine : ' PIXINVENT provides high quality , creative design and easy to use Premium & Free Bootstrap Admin Template ' , <nl> + link : ' https : / / 1 . envato . market / pixinvent_portfolio ' , <nl> + } , <nl> + products : [ <nl> + { <nl> + title : ' Vuexy - Vuejs , React , HTML & Laravel Admin Dashboard Template ' , <nl> + tagLine : ' Best selling , Production Ready , Carefully Crafted Admin Template ' , <nl> + imgUrl : ' https : / / www . pixinvent . com / demo / vuexy - html - bootstrap - admin - template / item - page / reactstrap . jpg ' , <nl> + link : ' https : / / 1 . envato . market / vuexy_admin ' , <nl> + } , <nl> + ] , <nl> + } , <nl> ] ; <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> + <nl> + <nl> + # # # Features <nl> + <nl> + * * * Dropdown : * * add support for listbox or menu role ( [ # 2077 ] ( https : / / github . com / reactstrap / reactstrap / issues / 2077 ) ) ( [ fd9e988 ] ( https : / / github . com / reactstrap / reactstrap / commit / fd9e9888b7712905a85684f7822fc75fde38c069 ) ) <nl> + <nl> + <nl> + <nl> # [ 8 . 9 . 0 ] ( https : / / github . com / reactstrap / reactstrap / compare / 8 . 8 . 1 . . . 8 . 9 . 0 ) ( 2021 - 01 - 19 ) <nl> 
mmm a / scripts / docs <nl> ppp b / scripts / docs <nl> git config user . email " reactstrap @ github . io " <nl> git add - - all <nl> git commit - m " docs ( Github Actions ) : publish documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) " <nl> - git push origin $ BRANCH > / dev / null 2 > & 1 <nl> + git push origin $ BRANCH <nl> git tag - a $ VERSION - m " docs $ RELEASE_TAG " <nl> - git push - - tags > / dev / null 2 > & 1 <nl> + git push - - tags <nl> success " Successfully published documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) ! " <nl> 
mmm a / scripts / docs <nl> ppp b / scripts / docs <nl> git add - - all <nl> git commit - m " docs ( Github Actions ) : publish documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) " <nl> git push origin $ BRANCH <nl> - git tag - a $ VERSION - m " docs $ RELEASE_TAG " <nl> - git push - - tags <nl> success " Successfully published documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) ! " <nl> 
mmm a / scripts / docs <nl> ppp b / scripts / docs <nl> exit 0 <nl> fi <nl> - git config user . name " Github Actions " <nl> - git config user . email " reactstrap @ github . io " <nl> git add - - all <nl> git commit - m " docs ( Github Actions ) : publish documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) " <nl> + git remote remove origin <nl> + git remote add origin https : / / $ { GITHUB_TOKEN } @ github . com / $ { GITHUB_REPO } . git <nl> git push origin $ BRANCH <nl> success " Successfully published documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) ! " <nl> 
mmm a / scripts / docs <nl> ppp b / scripts / docs <nl> exit 0 <nl> fi <nl> + git config user . name " Github Actions " <nl> + git config user . email " reactstrap @ github . io " <nl> git add - - all <nl> git commit - m " docs ( Github Actions ) : publish documentation for $ RELEASE_TAG ( $ GITHUB_SHA ) " <nl> git remote remove origin <nl> 
mmm a / . github / workflows / docs . yml <nl> ppp b / . github / workflows / docs . yml <nl> run : rm - rf node_modules & & yarn install - - frozen - lockfile <nl> - name : Publish Docs <nl> env : <nl> - GITHUB_TOKEN : $ { { secrets . GITHUB_TOKEN } } <nl> + GITHUB_TOKEN : $ { { secrets . REACTSTRAP_DOCS_GITHUB_TOKEN } } <nl> run : . / scripts / docs <nl> 
mmm a / . github / workflows / publish . yml <nl> ppp b / . github / workflows / publish . yml <nl> env : <nl> NODE_AUTH_TOKEN : $ { { secrets . NPM_TOKEN } } <nl> - name : Publish Docs <nl> - run : | <nl> - echo " RELEASE_TAG = $ { GITHUB_REF # # * / } " > > $ GITHUB_ENV <nl> - echo " GITHUB_TOKEN = $ { { secrets . GITHUB_TOKEN } } " > > $ GITHUB_ENV <nl> - . / scripts / docs <nl> + env : <nl> + GITHUB_TOKEN : $ { { secrets . REACTSTRAP_DOCS_GITHUB_TOKEN } } <nl> + run : . / scripts / docs <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> Organizations and projects using ` reactstrap ` <nl> - - [ availity - reactstrap - validation ] ( https : / / availity . github . io / availity - reactstrap - validation / ) <nl> - [ airframe - react ] ( https : / / github . com / 0wczar / airframe - react ) - [ demo ] ( http : / / dashboards . webkom . co / react / airframe / ) - Airframe provides all the components a developer needs to build data - intensive web apps using React . <nl> - [ component - template ] ( https : / / reactstrap . github . io / component - template / ) <nl> - [ video - react ] ( https : / / video - react . github . io / ) <nl> 
mmm a / . github / workflows / release - please . yml <nl> ppp b / . github / workflows / release - please . yml <nl> release - pr : <nl> runs - on : ubuntu - latest <nl> steps : <nl> + - uses : actions / checkout @ v2 <nl> + - run : git tag - d $ ( git tag - l | grep - ) # workaround for a bug with prerelease tags on the first run of release - please <nl> - uses : GoogleCloudPlatform / release - please - action @ v2 <nl> id : release - please <nl> with : <nl> 
mmm a / . github / workflows / release - please . yml <nl> ppp b / . github / workflows / release - please . yml <nl> release - pr : <nl> runs - on : ubuntu - latest <nl> steps : <nl> - - uses : actions / checkout @ v2 <nl> - - run : git tag - d $ ( git tag - l | grep - ) # workaround for a bug with prerelease tags on the first run of release - please <nl> - uses : GoogleCloudPlatform / release - please - action @ v2 <nl> id : release - please <nl> with : <nl> @ @ - 31 , 14 + 29 , 11 @ @ jobs : <nl> - uses : actions / setup - node @ v2 <nl> with : <nl> node - version : ' 16 . x ' <nl> - registry - url : ' https : / / npm . pkg . github . com / ' <nl> + registry - url : ' https : / / registry . npmjs . org ' <nl> if : $ { { steps . release . outputs . release_created } } <nl> - name : Install dependencies <nl> run : rm - rf node_modules & & yarn install - - frozen - lockfile <nl> if : $ { { steps . release . outputs . release_created } } <nl> - - name : Build package <nl> - run : npm run build <nl> - if : $ { { steps . release . outputs . release_created } } <nl> - name : Publish package <nl> run : npm publish <nl> env : <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " reactstrap " , <nl> - " version " : " 8 . 10 . 0 " , <nl> + " version " : " 8 . 10 . 1 " , <nl> " description " : " React Bootstrap 4 components " , <nl> " main " : " lib / index . js " , <nl> " types " : " es / index . d . ts " , <nl> 
mmm a / stories / examples / PopoverUncontrolled . js <nl> ppp b / stories / examples / PopoverUncontrolled . js <nl> import { Button , UncontrolledPopover , PopoverHeader , PopoverBody } from ' reactstrap ' ; <nl> - export default function ( ) { <nl> + const Example = ( props ) = > { <nl> return ( <nl> < div > <nl> < Button id = " UncontrolledPopover " type = " button " > <nl> @ @ - 15 , 3 + 15 , 5 @ @ export default function ( ) { <nl> < / div > <nl> ) ; <nl> } <nl> + <nl> + export default Example ; <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> + <nl> + <nl> + # # # Features <nl> + <nl> + * * * accordion : * * add ` flush ` support and ` stayOpen ` support ( [ 272b773 ] ( https : / / github . com / reactstrap / reactstrap / commit / 272b773972a16f60d581a13a5807277884a1693f ) ) <nl> + * * * bs5 : * * add Offcanvas ( [ df61c93 ] ( https : / / github . com / reactstrap / reactstrap / commit / df61c937f941a166538e9c7012d6b51c56ea6a41 ) ) <nl> + * * * carousel : * * add Bootstrap5 updates ( [ 1cca298 ] ( https : / / github . com / reactstrap / reactstrap / commit / 1cca298f74f85599fa8e5b22fa73e15ebc76315d ) ) <nl> + * * * collapse : * * add horizontal collapse ( [ 45d28fe ] ( https : / / github . com / reactstrap / reactstrap / commit / 45d28fec7becf71f0e57fe0612db6b9ff74fdb9a ) ) <nl> + * * * ListGroup : * * Add ListGroupNumbered ( [ ea4621e ] ( https : / / github . com / reactstrap / reactstrap / commit / ea4621e5d90f717dcc84e295658767eed6fef486 ) ) <nl> + * * * Placeholder : * * add component ( [ 0b315ab ] ( https : / / github . com / reactstrap / reactstrap / commit / 0b315abc0428f9fa6096115a39e6697b7e61abd8 ) ) <nl> + <nl> + <nl> + <nl> # [ 9 . 0 . 0 - 0 ] ( https : / / github . com / reactstrap / reactstrap / compare / 8 . 9 . 0 . . . 9 . 0 . 0 - 0 ) ( 2021 - 03 - 03 ) <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - Stateless React Components for Bootstrap . <nl> + Stateless React Components for Bootstrap 5 . <nl> + <nl> + If you ' re using Bootstrap 4 , you ' ll need to use [ Reactstrap v8 ] ( https : / / reactstrap . github . io / legacy / 8 . 10 . 1 ) <nl> # # Getting Started <nl> 
mmm a / stories / Index . stories . mdx <nl> ppp b / stories / Index . stories . mdx <nl> # # # Reactstrap is a [ React ] ( https : / / reactjs . org ) component library for [ Bootstrap ] ( https : / / getbootstrap . com ) <nl> - Reactstrap is currently compatible with Bootstrap 5 . 1 . If you are using Bootstrap 4 , you ' ll need to use [ Reactstrap v8 ] ( / legacy / 8 . 10 . 1 ) <nl> + Reactstrap is currently compatible with Bootstrap 5 . 1 . If you are using Bootstrap 4 , you ' ll need to use [ Reactstrap v8 ] ( . / legacy / 8 . 10 . 1 ) <nl> # # Getting Started <nl> 
mmm a / src / Dropdown . js <nl> ppp b / src / Dropdown . js <nl> getMenuCtrl ( ) { <nl> if ( this . _ $ menuCtrl ) return this . _ $ menuCtrl ; <nl> - this . _ $ menuCtrl = this . toggleRef . current ; <nl> + this . _ $ menuCtrl = this . getToggle ( ) ; <nl> return this . _ $ menuCtrl ; <nl> } <nl> 
mmm a / src / Collapse . js <nl> ppp b / src / Collapse . js <nl> dimension : null , <nl> } ; <nl> - this . nodeRef = React . createRef ( ) ; <nl> + this . nodeRef = props . innerRef | | React . createRef ( ) ; <nl> [ ' onEntering ' , ' onEntered ' , ' onExit ' , ' onExiting ' , ' onExited ' ] . forEach ( <nl> ( name ) = > { <nl> @ @ - 72 , 8 + 72 , 7 @ @ class Collapse extends Component { <nl> } <nl> getNode ( ) { <nl> - const nodeRef = this . props . innerRef | | this . nodeRef ; <nl> - return nodeRef . current ; <nl> + return this . nodeRef . current ; <nl> } <nl> onEntering ( _ , isAppearing ) { <nl> @ @ - 125 , 8 + 124 , 6 @ @ class Collapse extends Component { <nl> . . . otherProps <nl> } = this . props ; <nl> - const nodeRef = innerRef | | this . nodeRef ; <nl> - <nl> const { dimension } = this . state ; <nl> const transitionProps = pick ( otherProps , TransitionPropTypeKeys ) ; <nl> @ @ - 135 , 7 + 132 , 7 @ @ class Collapse extends Component { <nl> < Transition <nl> { . . . transitionProps } <nl> in = { isOpen } <nl> - nodeRef = { nodeRef } <nl> + nodeRef = { this . nodeRef } <nl> onEntering = { this . onEntering } <nl> onEntered = { this . onEntered } <nl> onExit = { this . onExit } <nl> @ @ - 162 , 7 + 159 , 7 @ @ class Collapse extends Component { <nl> { . . . childProps } <nl> style = { { . . . childProps . style , . . . style } } <nl> className = { classes } <nl> - ref = { nodeRef } <nl> + ref = { this . nodeRef } <nl> > <nl> { children } <nl> < / Tag > <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " jest " : " 28 . 1 . 3 " , <nl> " jest - environment - jsdom " : " 28 . 1 . 3 " , <nl> - " jsdom " : " ^ 20 . 0 . 2 " , <nl> + " jsdom " : " ^ 19 . 0 . 0 " , <nl> " json - loader " : " ^ 0 . 5 . 7 " , <nl> " microbundle " : " ^ 0 . 13 . 3 " , <nl> " prettier " : " 2 . 7 . 1 " , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> - " private " : true , <nl> - " workspaces " : [ <nl> - " packages / * " <nl> - ] , <nl> - " author " : " Pascal Luther " , <nl> - " repository " : " https : / / github . com / nuxt - community / firebase - module " , <nl> - " homepage " : " https : / / firebase . nuxtjs . org / " , <nl> + " name " : " @ nuxtjs / firebase " , <nl> + " version " : " 4 . 0 . 0 " , <nl> + " description " : " Intergrate Firebase into your Nuxt project . " , <nl> " keywords " : [ <nl> + " firebase " , <nl> + " firestore " , <nl> + " google " , <nl> + " googleauthentication " , <nl> " nuxt " , <nl> - " firebase " <nl> + " realtimedatabase " <nl> + ] , <nl> + " homepage " : " https : / / firebase . nuxtjs . org / " , <nl> + " repository " : " nuxt - community / firebase - module " , <nl> + " license " : " MIT " , <nl> + " author " : " Pascal Luther " , <nl> + " files " : [ <nl> + " lib " <nl> ] , <nl> + " main " : " lib / module . js " , <nl> + " types " : " types / index . d . ts " , <nl> " scripts " : { <nl> - " docs : dev " : " vuepress dev docs " , <nl> " docs : build " : " vuepress build docs " , <nl> - " npm : publish " : " cd packages / firebase - module & & npm publish " <nl> + " docs : dev " : " vuepress dev docs " , <nl> + " lint " : " eslint - - ext . js , . vue lib test " , <nl> + " release " : " yarn test & & standard - version & & git push - - follow - tags & & npm publish " , <nl> + " test " : " yarn lint & & jest " <nl> + } , <nl> + " dependencies " : { <nl> + " firebase - admin " : " ^ 8 . 9 . 2 " , <nl> + " jwt - decode " : " ^ 2 . 2 . 0 " , <nl> + " lodash " : " ^ 4 . 17 . 15 " <nl> } , <nl> " devDependencies " : { <nl> - " babel - eslint " : " 10 . 1 . 0 " , <nl> - " eslint " : " 6 . 8 . 0 " , <nl> - " eslint - config - prettier " : " 6 . 10 . 0 " , <nl> - " eslint - plugin - prettier " : " 3 . 1 . 2 " , <nl> - " prettier " : " 1 . 19 . 1 " , <nl> - " vuepress " : " 1 . 3 . 1 " <nl> + " @ commitlint / cli " : " latest " , <nl> + " @ commitlint / config - conventional " : " latest " , <nl> + " @ nuxtjs / eslint - config " : " latest " , <nl> + " @ nuxtjs / module - test - utils " : " latest " , <nl> + " @ vuepress / plugin - google - analytics " : " latest " , <nl> + " codecov " : " latest " , <nl> + " eslint " : " latest " , <nl> + " firebase " : " latest " , <nl> + " husky " : " latest " , <nl> + " jest " : " latest " , <nl> + " nuxt - edge " : " latest " , <nl> + " standard - version " : " latest " , <nl> + " vuepress " : " latest " <nl> } , <nl> - " dependencies " : { <nl> - " @ vuepress / plugin - google - analytics " : " 1 . 3 . 1 " <nl> + " peerDependencies " : { <nl> + " firebase " : " ^ 7 . 9 . 0 " , <nl> + " nuxt " : " ^ 2 . 0 . 0 " <nl> + } , <nl> + " publishConfig " : { <nl> + " access " : " public " <nl> } <nl> } <nl> 
mmm a / lib / module . js <nl> ppp b / lib / module . js <nl> module . exports = function ( moduleOptions ) { <nl> const options = Object . assign ( { } , this . options . firebase , moduleOptions ) <nl> - const firebaseVersion = ' 7 . 9 . 3 ' / / TODO : Update with each Firebase update <nl> + const firebaseVersion = ' 7 . 11 . 0 ' / / TODO : Update with each Firebase update <nl> const currentEnv = getCurrentEnv ( options ) <nl> validateOptions ( options ) <nl> 
mmm a / . github / ISSUE_TEMPLATE / question . md <nl> ppp b / . github / ISSUE_TEMPLATE / question . md <nl> - - - <nl> < ! - - * * IMPORTANT ! * * <nl> - Please make sure to look for an answer to your question in our documentation and the Firebase documenation before asking a question here . <nl> + Please make sure to look for an answer to your question in our documentation and the Firebase documentation before asking a question here . <nl> If you have a general question regarding Nuxt - Firebase use Discord ` modules ` channel . Thanks ! <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " name " : " @ nuxtjs / firebase " , <nl> - " version " : " 5 . 2 . 0 " , <nl> + " version " : " 6 . 0 . 0 " , <nl> " description " : " Intergrate Firebase into your Nuxt project . " , <nl> " keywords " : [ <nl> " firebase " , <nl> 
mmm a / types / index . d . ts <nl> ppp b / types / index . d . ts <nl> } <nl> export interface FirebaseModuleConfiguration { <nl> + legacyMode ? : boolean , <nl> + injectModule ? : boolean , <nl> + lazy ? : boolean , <nl> config : <nl> | { <nl> [ envKey : string ] : FirebaseConfiguration <nl> 
mmm a / types / index . d . ts <nl> ppp b / types / index . d . ts <nl> declare module ' vue / types / vue ' { <nl> interface Vue { <nl> + / / LegacyMode <nl> $ fireStore : firebase . firestore . Firestore <nl> $ fireStoreObj : typeof firebase . firestore <nl> $ fireDb : firebase . database . Database <nl> @ @ - 145 , 6 + 146 , 19 @ @ declare module ' vue / types / vue ' { <nl> $ firePerfObj : typeof firebase . performance <nl> $ fireConfig : firebase . remoteConfig . RemoteConfig <nl> $ fireConfigObj : typeof firebase . remoteConfig <nl> + / / From v7 + <nl> + $ fireObj : typeof firebase <nl> + $ fire : { <nl> + auth : firebase . auth . Auth <nl> + realtimeDb : firebase . database . Database <nl> + firestore : firebase . firestore . Firestore <nl> + storage : firebase . storage . Storage <nl> + functions : firebase . functions . Functions <nl> + messaging : firebase . messaging . Messaging <nl> + performance : firebase . performance . Performance <nl> + analytics : firebase . analytics . Analytics <nl> + remoteConfig : firebase . remoteConfig . RemoteConfig <nl> + } <nl> } <nl> } <nl> @ @ - 154 , 6 + 168 , 7 @ @ declare module ' @ nuxt / vue - app ' { <nl> } <nl> interface NuxtAppOptions { <nl> + / / LegacyMode <nl> $ fireStore : firebase . firestore . Firestore <nl> $ fireStoreObj : typeof firebase . firestore <nl> $ fireDb : firebase . database . Database <nl> @ @ - 173 , 6 + 188 , 19 @ @ declare module ' @ nuxt / vue - app ' { <nl> $ firePerfObj : typeof firebase . performance <nl> $ fireConfig : firebase . remoteConfig . RemoteConfig <nl> $ fireConfigObj : typeof firebase . remoteConfig <nl> + / / From v7 + <nl> + $ fireObj : typeof firebase <nl> + $ fire : { <nl> + auth : firebase . auth . Auth <nl> + realtimeDb : firebase . database . Database <nl> + firestore : firebase . firestore . Firestore <nl> + storage : firebase . storage . Storage <nl> + functions : firebase . functions . Functions <nl> + messaging : firebase . messaging . Messaging <nl> + performance : firebase . performance . Performance <nl> + analytics : firebase . analytics . Analytics <nl> + remoteConfig : firebase . remoteConfig . RemoteConfig <nl> + } <nl> } <nl> } <nl> @ @ - 183 , 6 + 211 , 7 @ @ declare module ' @ nuxt / types ' { <nl> } <nl> interface NuxtAppOptions { <nl> + / / LegacyMode <nl> $ fireStore : firebase . firestore . Firestore <nl> $ fireStoreObj : typeof firebase . firestore <nl> $ fireDb : firebase . database . Database <nl> @ @ - 202 , 11 + 231 , 25 @ @ declare module ' @ nuxt / types ' { <nl> $ firePerfObj : typeof firebase . performance <nl> $ fireConfig : firebase . remoteConfig . RemoteConfig <nl> $ fireConfigObj : typeof firebase . remoteConfig <nl> + / / From v7 + <nl> + $ fireObj : typeof firebase <nl> + $ fire : { <nl> + auth : firebase . auth . Auth <nl> + realtimeDb : firebase . database . Database <nl> + firestore : firebase . firestore . Firestore <nl> + storage : firebase . storage . Storage <nl> + functions : firebase . functions . Functions <nl> + messaging : firebase . messaging . Messaging <nl> + performance : firebase . performance . Performance <nl> + analytics : firebase . analytics . Analytics <nl> + remoteConfig : firebase . remoteConfig . RemoteConfig <nl> + } <nl> } <nl> } <nl> declare module ' vuex / types / index ' { <nl> interface Store < S > { <nl> + / / LegacyMode <nl> readonly $ fireStore : firebase . firestore . Firestore <nl> $ fireStoreObj : typeof firebase . firestore <nl> $ fireDb : firebase . database . Database <nl> @ @ - 226 , 6 + 269 , 19 @ @ declare module ' vuex / types / index ' { <nl> $ firePerfObj : typeof firebase . performance <nl> $ fireConfig : firebase . remoteConfig . RemoteConfig <nl> $ fireConfigObj : typeof firebase . remoteConfig <nl> + / / From v7 + <nl> + $ fireObj : typeof firebase <nl> + $ fire : { <nl> + auth : firebase . auth . Auth <nl> + realtimeDb : firebase . database . Database <nl> + firestore : firebase . firestore . Firestore <nl> + storage : firebase . storage . Storage <nl> + functions : firebase . functions . Functions <nl> + messaging : firebase . messaging . Messaging <nl> + performance : firebase . performance . Performance <nl> + analytics : firebase . analytics . Analytics <nl> + remoteConfig : firebase . remoteConfig . RemoteConfig <nl> + } <nl> } <nl> } <nl> 
mmm a / types / index . d . ts <nl> ppp b / types / index . d . ts <nl> * Injections <nl> * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * / <nl> + <nl> interface ReadyFunction { <nl> ( ) : void ; <nl> } <nl> - declare module ' vue / types / vue ' { <nl> - interface Vue { <nl> - $ fireModule : typeof firebase <nl> - $ fire : { <nl> + interface NuxtFireInstance { <nl> auth : firebase . auth . Auth <nl> authReady : ReadyFunction <nl> database : firebase . database . Database <nl> @ @ - 157 , 93 + 155 , 55 @ @ declare module ' vue / types / vue ' { <nl> remoteConfig : firebase . remoteConfig . RemoteConfig <nl> remoteConfigReady : ReadyFunction <nl> } <nl> - } <nl> - } <nl> declare module ' @ nuxt / vue - app ' { <nl> interface NuxtConfiguration { <nl> firebase ? : FirebaseModuleConfiguration <nl> } <nl> - <nl> - interface NuxtAppOptions { <nl> + interface Context { <nl> $ fireModule : typeof firebase <nl> - $ fire : { <nl> - auth : firebase . auth . Auth <nl> - authReady : ReadyFunction <nl> - database : firebase . database . Database <nl> - databaseReady : ReadyFunction <nl> - firestore : firebase . firestore . Firestore <nl> - firestoreReady : ReadyFunction <nl> - functions : firebase . functions . Functions <nl> - functionsReady : ReadyFunction <nl> - storage : firebase . storage . Storage <nl> - storageReady : ReadyFunction <nl> - messaging : firebase . messaging . Messaging <nl> - messagingReady : ReadyFunction <nl> - performance : firebase . performance . Performance <nl> - performanceReady : ReadyFunction <nl> - analytics : firebase . analytics . Analytics <nl> - analyticsReady : ReadyFunction <nl> - remoteConfig : firebase . remoteConfig . RemoteConfig <nl> - remoteConfigReady : ReadyFunction <nl> + $ fire : NuxtFireInstance <nl> } <nl> + interface NuxtAppOptions { <nl> + $ fireModule : typeof firebase <nl> + $ fire : NuxtFireInstance <nl> } <nl> } <nl> - / / Nuxt 2 . 9 + <nl> declare module ' @ nuxt / types ' { <nl> + interface Context { <nl> + $ fireModule : typeof firebase <nl> + $ fire : NuxtFireInstance <nl> + } <nl> + <nl> + interface NuxtAppOptions { <nl> + $ fireModule : typeof firebase <nl> + $ fire : NuxtFireInstance <nl> + } <nl> + <nl> interface Configuration { <nl> firebase ? : FirebaseModuleConfiguration <nl> } <nl> + } <nl> - interface NuxtAppOptions { <nl> + declare module ' vue / types / vue ' { <nl> + interface Vue { <nl> $ fireModule : typeof firebase <nl> - $ fire : { <nl> - auth : firebase . auth . Auth <nl> - authReady : ReadyFunction <nl> - database : firebase . database . Database <nl> - databaseReady : ReadyFunction <nl> - firestore : firebase . firestore . Firestore <nl> - firestoreReady : ReadyFunction <nl> - functions : firebase . functions . Functions <nl> - functionsReady : ReadyFunction <nl> - storage : firebase . storage . Storage <nl> - storageReady : ReadyFunction <nl> - messaging : firebase . messaging . Messaging <nl> - messagingReady : ReadyFunction <nl> - performance : firebase . performance . Performance <nl> - performanceReady : ReadyFunction <nl> - analytics : firebase . analytics . Analytics <nl> - analyticsReady : ReadyFunction <nl> - remoteConfig : firebase . remoteConfig . RemoteConfig <nl> - remoteConfigReady : ReadyFunction <nl> + $ fire : NuxtFireInstance <nl> + } <nl> } <nl> + <nl> + declare module ' @ nuxt / vue - app ' { <nl> + interface NuxtAppOptions { <nl> + $ fireModule : typeof firebase <nl> + $ fire : NuxtFireInstance <nl> } <nl> } <nl> declare module ' vuex / types / index ' { <nl> interface Store < S > { <nl> $ fireModule : typeof firebase <nl> - $ fire : { <nl> - auth : firebase . auth . Auth <nl> - authReady : ReadyFunction <nl> - database : firebase . database . Database <nl> - databaseReady : ReadyFunction <nl> - firestore : firebase . firestore . Firestore <nl> - firestoreReady : ReadyFunction <nl> - functions : firebase . functions . Functions <nl> - functionsReady : ReadyFunction <nl> - storage : firebase . storage . Storage <nl> - storageReady : ReadyFunction <nl> - messaging : firebase . messaging . Messaging <nl> - messagingReady : ReadyFunction <nl> - performance : firebase . performance . Performance <nl> - performanceReady : ReadyFunction <nl> - analytics : firebase . analytics . Analytics <nl> - analyticsReady : ReadyFunction <nl> - remoteConfig : firebase . remoteConfig . RemoteConfig <nl> - remoteConfigReady : ReadyFunction <nl> - } <nl> + $ fire : NuxtFireInstance <nl> } <nl> } <nl> 
mmm a / types / index . d . ts <nl> ppp b / types / index . d . ts <nl> initialize ? : { <nl> onAuthStateChangedMutation ? : string <nl> onAuthStateChangedAction ? : string <nl> + subscribeManually ? : boolean <nl> } <nl> ssr ? : <nl> @ @ - 53 , 9 + 54 , 13 @ @ export interface AuthServiceConfig extends ServiceConfig { <nl> } <nl> ignorePaths ? : ( string | RegExp ) [ ] <nl> } <nl> + <nl> + emulatorPort ? : number <nl> + emulatorHost ? : string <nl> } <nl> export interface StoreServiceConfig extends ServiceConfig { <nl> + memoryOnly ? : boolean <nl> enablePersistence ? : <nl> | boolean <nl> | { <nl> @ @ - 67 , 6 + 72 , 7 @ @ export interface StoreServiceConfig extends ServiceConfig { <nl> export interface FunctionsServiceConfig extends ServiceConfig { <nl> location ? : string <nl> emulatorPort ? : number <nl> + emulatorHost ? : string <nl> } <nl> export interface StorageServiceConfig extends ServiceConfig { } <nl> 
mmm a / lib / sw - templates / firebase - auth - sw . js <nl> ppp b / lib / sw - templates / firebase - auth - sw . js <nl> - < % if ( options . onFirebaseHosting ) { % > <nl> + < % if ( options . loadFromFirebaseHosting ) { % > <nl> / / Only works on Firebase hosting ! <nl> importScripts ( ' / __ / firebase / < % = options . firebaseVersion % > / firebase - app . js ' ) <nl> importScripts ( ' / __ / firebase / < % = options . firebaseVersion % > / firebase - auth . js ' ) <nl> 
mmm a / lib / module . js <nl> ppp b / lib / module . js <nl> / / If one of the required keys is missing , throw an error : <nl> if ( requiredKeys . some ( k = > ! configKeys . includes ( k ) ) ) { <nl> - let missingKey = requiredKeys [ requiredKeys . findIndex ( k = > ! configKeys . includes ( k ) ) ] ; <nl> + const missingKey = requiredKeys [ requiredKeys . findIndex ( k = > ! configKeys . includes ( k ) ) ] <nl> return logger . error ( <nl> ` Missing or incomplete config for current environment ' $ { currentEnv } ' : key ' $ { missingKey } ' is required ! ` <nl> ) <nl> 
mmm a / lib / module . js <nl> ppp b / lib / module . js <nl> if ( isEmpty ( options . services ) ) { <nl> return logger . error ( <nl> ` The ' services ' option is missing or empty , make sure to define it properly . <nl> - See : https : / / firebase . nuxtjs . org / getting - started / # configure ` <nl> + See : https : / / firebase . nuxtjs . org / guide / getting - started # configure ` <nl> ) <nl> } <nl> 
mmm a / packages / vega - view / src / View . js <nl> ppp b / packages / vega - view / src / View . js <nl> const ctx = runtime ( view , spec , options . functions ) ; <nl> view . _runtime = ctx ; <nl> view . _signals = ctx . signals ; <nl> - view . _bind = ( spec . bindings | | [ ] ) . map ( function ( _ ) { <nl> - return { <nl> + view . _bind = ( spec . bindings | | [ ] ) . map ( _ = > ( { <nl> state : null , <nl> param : extend ( { } , _ ) <nl> - } ; <nl> - } ) ; <nl> + } ) ) ; <nl> / / initialize scenegraph <nl> if ( ctx . root ) ctx . root . set ( root ) ; <nl> @ @ - 303 , 18 + 301 , 15 @ @ prototype . removeResizeListener = function ( handler ) { <nl> } ; <nl> function findOperatorHandler ( op , handler ) { <nl> - var t = op . _targets | | [ ] , <nl> - h = t . filter ( function ( op ) { <nl> - var u = op . _update ; <nl> - return u & & u . handler = = = handler ; <nl> - } ) ; <nl> + const h = ( op . _targets | | [ ] ) <nl> + . filter ( op = > op . _update & & op . _update . handler = = = handler ) ; <nl> return h . length ? h [ 0 ] : null ; <nl> } <nl> function addOperatorListener ( view , name , op , handler ) { <nl> var h = findOperatorHandler ( op , handler ) ; <nl> if ( ! h ) { <nl> - h = trap ( view , function ( ) { handler ( name , op . value ) ; } ) ; <nl> + h = trap ( view , ( ) = > handler ( name , op . value ) ) ; <nl> h . handler = handler ; <nl> view . on ( op , null , h ) ; <nl> } <nl> 
mmm a / lib / rollup . config . js <nl> ppp b / lib / rollup . config . js <nl> const pkg = require ( ' . / package . json ' ) ; <nl> const d3CoreDeps = [ <nl> - / / ' d3 - array ' , / / we use d3 - array v2 , not part of D3 v5 <nl> + ' d3 - array ' , <nl> ' d3 - color ' , <nl> ' d3 - dispatch ' , <nl> ' d3 - dsv ' , <nl> @ @ - 19 , 12 + 19 , 12 @ @ const d3CoreDeps = [ <nl> ' d3 - hierarchy ' , <nl> ' d3 - interpolate ' , <nl> ' d3 - path ' , <nl> - / / ' d3 - scale ' , / / we use d3 - scale v3 , not part of D3 v5 <nl> + ' d3 - scale ' , <nl> ' d3 - shape ' , <nl> ' d3 - time ' , <nl> ' d3 - time - format ' , <nl> ' d3 - timer ' , <nl> - / / ' d3 - delaunay ' , / / not part of D3 v5 <nl> + ' d3 - delaunay ' , <nl> ' topojson - client ' <nl> ] ; <nl> 
mmm a / docs / docs / marks / image . md <nl> ppp b / docs / docs / marks / image . md <nl> | url | { % include type t = " URL " % } | The URL of the image file . | <nl> | image | [ Canvas ] ( https : / / developer . mozilla . org / en - US / docs / Web / HTML / Element / canvas ) \ | [ Image ] ( https : / / developer . mozilla . org / en - US / docs / Web / API / HTMLImageElement / Image ) | The image instance to show . This property can be used to include dynamically generated images . This property is ignored if _url_ is specified . { % include tag ver = " 5 . 8 " % } | <nl> | aspect | { % include type t = " Boolean " % } | A boolean flag ( default ` true ` ) indicating if the image aspect ratio should be preserved across sizes . If ` true ` and only one of the dimensional ( * width * or * height * ) properties are defined , the other dimensional property will be calculated to match the aspect ratio of the loaded image file . | <nl> - | smooth | { % include type t = " Boolean " % } | A boolean flag ( default ` true ` ) indicating if the image should be smoothed when resized . If ` false ` , indvidual pixels should be scaled directly rather than interpolated with smoothing . For SVG rendering , this option may not work in some browsers due to lack of standardization . { % include tag ver = " 5 . 8 " % } | <nl> + | smooth | { % include type t = " Boolean " % } | A boolean flag ( default ` true ` ) indicating if the image should be smoothed when resized . If ` false ` , individual pixels should be scaled directly rather than interpolated with smoothing . For SVG rendering , this option may not work in some browsers due to lack of standardization . { % include tag ver = " 5 . 8 " % } | <nl> | align | { % include type t = " String " % } | The horizontal alignment of the image . One of ` left ` , ` center ` , or ` right ` . The default value is ` left ` . | <nl> | baseline | { % include type t = " String " % } | The vertical alignment of the image . One of ` top ` , ` middle ` , or ` bottom ` . The default value is ` top ` . | <nl> 
mmm a / LICENSE <nl> ppp b / LICENSE <nl> + Copyright ( c ) 2015 - 2021 , University of Washington Interactive Data Lab <nl> All rights reserved . <nl> Redistribution and use in source and binary forms , with or without <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " postinstall " : " yarn data " <nl> } , <nl> + " dependencies " : { } , <nl> " devDependencies " : { <nl> " @ babel / cli " : " ^ 7 . 17 . 6 " , <nl> " @ babel / core " : " ^ 7 . 17 . 5 " , <nl> } , <nl> " workspaces " : [ <nl> " packages / * " <nl> - ] , <nl> - " dependencies " : { } <nl> + ] <nl> } <nl> 
mmm a / packages / vega / index . js <nl> ppp b / packages / vega / index . js <nl> - import pkg from ' . / package . json ' ; <nl> import { extend } from ' vega - util ' ; <nl> import { transforms } from ' vega - dataflow ' ; <nl> import * as tx from ' vega - transforms ' ; <nl> @ @ - 22 , 7 + 21 , 7 @ @ extend ( <nl> / / - - Exports - - - - - <nl> - export const version = pkg . version ; <nl> + export { version } from ' . / package . json ' ; <nl> export * from ' vega - statistics ' ; <nl> 
mmm a / . github / workflows / test . yml <nl> ppp b / . github / workflows / test . yml <nl> steps : <nl> - uses : actions / checkout @ v3 <nl> + - name : Ensure apt - get is updated <nl> + run : sudo apt - get update <nl> + <nl> - name : Install Canvas and XML dependencies <nl> run : sudo apt - get install - y libxml2 - utils <nl> 
mmm a / packages / app / package . json <nl> ppp b / packages / app / package . json <nl> " workspaces " : { <nl> " nohoist " : [ <nl> - " @ lightningjs / sdk " <nl> + " @ lightningjs / sdk " , <nl> + " @ lightningjs / cli " <nl> ] <nl> } <nl> } <nl> \ No newline at end of file <nl> 
mmm a / packages / rnv - engine - rn - electron / src / sdks / sdk - electron / index . js <nl> ppp b / packages / rnv - engine - rn - electron / src / sdks / sdk - electron / index . js <nl> await executeAsync ( <nl> c , <nl> - ` npx electron - builder - - config $ { path . join ( <nl> + ` npx - p electron - builder electron - builder - - config $ { path . join ( <nl> platformBuildDir , <nl> ' electronConfig . json ' <nl> ) } ` <nl> 
mmm a / packages / renative - template - hello - world / wdio . conf . js <nl> ppp b / packages / renative - template - hello - world / wdio . conf . js <nl> { <nl> platformName : ' iOS ' , <nl> deviceName : ' iPhone 8 ' , <nl> - platformVersion : ' 14 . 4 ' , <nl> + platformVersion : ' 15 . 0 ' , <nl> automationName : ' XCUITest ' , <nl> - bundleId : ' myapp ' , <nl> + bundleId : ' renative . helloworld . debug ' , <nl> } , <nl> ] , <nl> tvos : [ <nl> { <nl> platformName : ' tvOS ' , <nl> - deviceName : ' Apple TV 4K ' , <nl> - platformVersion : ' 14 . 3 ' , <nl> + deviceName : ' Apple TV ' , <nl> + platformVersion : ' 15 . 0 ' , <nl> automationName : ' XCUITest ' , <nl> - bundleId : ' myapp ' , <nl> + bundleId : ' renative . helloworld . debug ' , <nl> } , <nl> ] , <nl> android : [ <nl> @ @ - 34 , 7 + 34 , 7 @ @ const capabilities = { <nl> platformVersion : ' 10 ' , <nl> automationName : ' UiAutomator2 ' , <nl> appPackage : ' renative . helloworld . debug ' , <nl> - appActivity : ' renative . helloworld . MainActivity ' , <nl> + appActivity : ' renative . helloworld . debug . MainActivity ' , <nl> } , <nl> ] , <nl> androidtv : [ <nl> @ @ - 44 , 14 + 44 , 14 @ @ const capabilities = { <nl> platformVersion : ' 10 ' , <nl> automationName : ' UiAutomator2 ' , <nl> appPackage : ' renative . helloworld . debug ' , <nl> - appActivity : ' renative . helloworld . MainActivity ' , <nl> + appActivity : ' renative . helloworld . debug . MainActivity ' , <nl> } , <nl> ] , <nl> macos : [ <nl> { <nl> platformName : ' Mac ' , <nl> automationName : ' Mac2 ' , <nl> - bundleId : ' myapp ' , <nl> + bundleId : ' renative . helloworld . debug ' , <nl> } , <nl> ] , <nl> web : [ <nl> 
mmm a / packages / renative - template - hello - world / package . json <nl> ppp b / packages / renative - template - hello - world / package . json <nl> " e2e : macos " : " PLATFORM = macos ENGINE = macos npx wdio wdio . conf . js " , <nl> " e2e : tvos " : " PLATFORM = tvos npx wdio wdio . conf . js " , <nl> - " e2e : web " : " PLATFORM = web npx wdio wdio . conf . js " <nl> + " e2e : web " : " PLATFORM = web npx wdio wdio . conf . js " , <nl> + " report " : " yarn report : generate & & yarn report : open " , <nl> + " report : generate " : " npx allure generate - - clean reporting / allure - results - o reporting / allure - report " , <nl> + " report : open " : " npx allure open reporting / allure - report " <nl> } , <nl> " dependencies " : { } , <nl> " devDependencies " : { <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " deploy : feat " : " npm run test & & npm run deploy - prepare & & npm run git - commit - tag & & npx lerna publish from - package - - dist - tag feat - - yes & & git push origin HEAD " , <nl> " deploy : prod " : " npm run deploy - all & & npx lerna publish from - package - - yes & & git push origin HEAD " , <nl> - " e2e - hello - world - ios " : " cd packages / renative - template - hello - world & & npx rnv build - p ios - s test & & yarn e2e : ios " , <nl> - " e2e - hello - world - android " : " cd packages / renative - template - hello - world & & npx rnv build - p android - s test & & yarn e2e : android " , <nl> - " e2e - hello - world - tvos " : " cd packages / renative - template - hello - world & & npx rnv build - p tvos - s test & & yarn e2e : tvos " , <nl> - " e2e - hello - world - androidtv " : " cd packages / renative - template - hello - world & & npx rnv build - p androidtv - s test & & yarn e2e : androidtv " , <nl> - " e2e - hello - world - macos " : " cd packages / renative - template - hello - world & & npx rnv build - p macos - s test & & yarn e2e : macos " , <nl> - " e2e - hello - world - web " : " cd packages / renative - template - hello - world & & npx rnv start - p web - s test & sleep 60 & & cd packages / renative - template - hello - world & & yarn e2e : web & & kill $ ( lsof - t - i : 8080 ) " , <nl> + " e2e - hello - world - ios " : " cd packages / renative - template - hello - world & & npx rnv build - p ios - s test - c template & & yarn e2e : ios " , <nl> + " e2e - hello - world - android " : " cd packages / renative - template - hello - world & & npx rnv build - p android - s test - c template & & yarn e2e : android " , <nl> + " e2e - hello - world - tvos " : " cd packages / renative - template - hello - world & & npx rnv build - p tvos - s test - c template & & yarn e2e : tvos " , <nl> + " e2e - hello - world - androidtv " : " cd packages / renative - template - hello - world & & npx rnv build - p androidtv - s test - c template & & yarn e2e : androidtv " , <nl> + " e2e - hello - world - macos " : " cd packages / renative - template - hello - world & & npx rnv build - p macos - s test - c template & & yarn e2e : macos " , <nl> + " e2e - hello - world - web " : " cd packages / renative - template - hello - world & & npx rnv start - p web - s test - c template & sleep 60 & & cd packages / renative - template - hello - world & & yarn e2e : web & & kill $ ( lsof - t - i : 8080 ) " , <nl> " git - commit " : " rnv hooks run - x gitCommit - r " , <nl> " git - commit - tag " : " rnv hooks run - x gitCommitAndTag - r " , <nl> " git - tag " : " rnv hooks run - x gitTag - r " , <nl> 
mmm a / packages / renative - template - hello - world / src / navigation / index . js <nl> ppp b / packages / renative - template - hello - world / src / navigation / index . js <nl> + import { createDrawerNavigator } from ' @ react - navigation / drawer ' ; <nl> + import { NavigationContainer } from ' @ react - navigation / native ' ; <nl> + import { createStackNavigator } from ' @ react - navigation / stack ' ; <nl> import React , { useContext } from ' react ' ; <nl> import { StatusBar } from ' react - native ' ; <nl> - import { createStackNavigator } from ' @ react - navigation / stack ' ; <nl> - import { NavigationContainer } from ' @ react - navigation / native ' ; <nl> - import { createDrawerNavigator } from ' @ react - navigation / drawer ' ; <nl> - import { CastButton } from ' react - native - google - cast ' ; <nl> import { isFactorDesktop } from ' renative ' ; <nl> + import Menu , { DrawerButton } from ' . . / components / menu ' ; <nl> import ScreenHome from ' . . / components / screenHome ' ; <nl> - import ScreenMyPage from ' . . / components / screenMyPage ' ; <nl> import ScreenModal from ' . . / components / screenModal ' ; <nl> - import Menu , { DrawerButton } from ' . . / components / menu ' ; <nl> + import ScreenMyPage from ' . . / components / screenMyPage ' ; <nl> import { ThemeContext } from ' . . / config ' ; <nl> + import { CastButton } from ' . . / imports / react - native - google - cast ' ; <nl> const Stack = createStackNavigator ( ) ; <nl> const ModalStack = createStackNavigator ( ) ; <nl> 
mmm a / packages / engine - rn - electron / src / sdks / sdk - electron / index . js <nl> ppp b / packages / engine - rn - electron / src / sdks / sdk - electron / index . js <nl> ) ; <nl> const appId = getAppId ( c , platform ) ; <nl> - console . log ( ' AJLKAJLKAJLKA ' , packagePath ) ; <nl> - <nl> if ( ! fsExistsSync ( packagePath ) ) { <nl> if ( exitOnFail ) { <nl> logWarning ( <nl> @ @ - 113 , 9 + 111 , 7 @ @ const configureProject = ( c , exitOnFail ) = > new Promise ( ( resolve , reject ) = > { <nl> reject ( ` $ { packagePath } does not exist ! ` ) ; <nl> return ; <nl> } <nl> - console . log ( ' SKSLKS : LSLKS : ' , engine ) ; <nl> const pkgJson = path . join ( engine . originalTemplatePlatformsDir , platform , ' package . json ' ) ; <nl> - console . log ( ' AMAMAMAAM ' , pkgJson ) ; <nl> const packageJson = readObjectSync ( pkgJson ) ; <nl> packageJson . name = ` $ { c . runtime . appId } - $ { platform } ` ; <nl> 
mmm a / shell . nix <nl> ppp b / shell . nix <nl> fontconfig . dev <nl> gdk_pixbuf <nl> glib <nl> - glibc <nl> gnome3 . gconf <nl> gtk2 <nl> nspr <nl> @ @ - 43 , 7 + 42 , 6 @ @ in stdenv . mkDerivation { <nl> buildInputs = [ <nl> electron <nl> - git <nl> nodejs - 7_x <nl> phantomjs2 <nl> pkgconfig <nl> 
mmm a / webpack . js <nl> ppp b / webpack . js <nl> } , <nl> { <nl> test : / \ . js $ / , <nl> - tag : ' glo ' , <nl> loaders : [ <nl> ' exports - loader ? GLO ' , <nl> ' imports - loader ? _ = underscore & cola = webcola ' <nl> 
mmm a / webpack . js <nl> ppp b / webpack . js <nl> + <nl> function _includePaths ( basePath ) { <nl> if ( basePath ) { <nl> return [ <nl> @ @ - 57 , 7 + 59 , 10 @ @ module . exports = function ( config , basePath , options ) { <nl> } <nl> / / Prepend the Candela loaders . <nl> - var gloPath = basePath + ' / node_modules / glo / glo . js ' ; <nl> + if ( basePath = = = undefined ) { <nl> + basePath = ' . ' ; <nl> + } <nl> + var gloPath = path . resolve ( basePath , ' node_modules / glo / glo . js ' ) ; <nl> config . module . loaders = [ <nl> { <nl> test : / \ . js $ / , <nl> 
mmm a / webpack . js <nl> ppp b / webpack . js <nl> + var process = require ( ' process ' ) ; <nl> function _includePaths ( basePath ) { <nl> if ( basePath ) { <nl> @ @ - 41 , 11 + 42 , 16 @ @ module . exports = function ( config , basePath , options ) { <nl> if ( exclude ) { <nl> / / Install empty module and module . loaders entries if missing . <nl> config . module = config . module | | { } ; <nl> + <nl> + if ( process . env . WEBPACK2 ) { <nl> + config . module . rules = config . module . rules | | [ ] ; <nl> + } else { <nl> config . module . loaders = config . module . loaders | | [ ] ; <nl> + } <nl> / / For each loader , append the Candela include paths to its ` exclude ` <nl> / / property . <nl> - config . module . loaders . forEach ( function ( loader ) { <nl> + var excluder = function ( loader ) { <nl> / / Install an empty list if there is no ` exclude ` property . <nl> loader . exclude = loader . exclude | | [ ] ; <nl> @ @ - 55 , 7 + 61 , 13 @ @ module . exports = function ( config , basePath , options ) { <nl> } <nl> loader . exclude = loader . exclude . concat ( includePaths ) ; <nl> - } ) ; <nl> + } ; <nl> + <nl> + if ( process . env . WEBPACK2 ) { <nl> + config . module . rules . forEach ( excluder ) ; <nl> + } else { <nl> + config . module . loaders . forEach ( excluder ) ; <nl> + } <nl> } <nl> / / Prepend the Candela loaders . <nl> @ @ - 63 , 6 + 75 , 69 @ @ module . exports = function ( config , basePath , options ) { <nl> basePath = ' . ' ; <nl> } <nl> var gloPath = path . resolve ( basePath , ' node_modules / glo / glo . js ' ) ; <nl> + if ( process . env . WEBPACK2 ) { <nl> + config . module . rules = [ <nl> + { <nl> + test : / \ . js $ / , <nl> + use : { <nl> + loader : ' babel - loader ' , <nl> + options : { <nl> + presets : [ ' es2015 ' ] <nl> + } <nl> + } , <nl> + include : includePaths . concat ( gloPath ) <nl> + } , <nl> + { <nl> + test : / \ . js $ / , <nl> + use : [ <nl> + ' exports - loader ? GLO ' , <nl> + ' imports - loader ? _ = underscore & cola = webcola ' <nl> + ] , <nl> + include : gloPath <nl> + } , <nl> + { <nl> + test : / \ . jpe ? g $ | \ . gif $ | \ . png $ | \ . woff $ | \ . wav $ | \ . mp3 $ | \ . woff ( 2 ) ? ( \ ? v = [ 0 - 9 ] \ . [ 0 - 9 ] \ . [ 0 - 9 ] ) ? $ | \ . ( ttf | eot | svg ) ( \ ? v = [ 0 - 9 ] \ . [ 0 - 9 ] \ . [ 0 - 9 ] ) ? $ / , <nl> + use : ' url - loader ' , <nl> + include : addNMPath ( [ ' font - awesome ' , ' bootstrap ' ] , includePaths ) <nl> + } , <nl> + { <nl> + test : / \ . csv $ / , <nl> + use : ' raw - loader ' , <nl> + include : includePaths <nl> + } , <nl> + { <nl> + test : / \ . html $ / , <nl> + use : ' html - loader ? attrs = img : src ' , <nl> + include : includePaths <nl> + } , <nl> + { <nl> + test : / \ . styl $ / , <nl> + use : [ ' style - loader ' , ' css - loader ' , ' stylus - loader ' ] , <nl> + include : includePaths <nl> + } , <nl> + { <nl> + test : / \ . css $ / , <nl> + use : [ ' style - loader ' , ' css - loader ' ] , <nl> + include : addNMPath ( [ ' lineupjs ' , ' nvd3 ' ] , includePaths ) <nl> + } , <nl> + { <nl> + test : / \ . scss $ / , <nl> + use : [ ' style - loader ' , ' css - loader ' , ' sass - loader ' ] , <nl> + include : addNMPath ( ' UpSet ' , includePaths ) <nl> + } , <nl> + { <nl> + test : / \ . jade $ / , <nl> + use : ' jade - loader ' , <nl> + include : includePaths <nl> + } , <nl> + { <nl> + test : / \ . json $ / , <nl> + use : [ ' json - loader ' , ' strip - json - comments - loader ' ] , <nl> + include : addNMPath ( ' datalib ' , includePaths ) <nl> + } <nl> + <nl> + ] . concat ( config . module . rules ) ; <nl> + } else { <nl> config . module . loaders = [ <nl> { <nl> test : / \ . js $ / , <nl> @ @ - 121 , 6 + 196 , 7 @ @ module . exports = function ( config , basePath , options ) { <nl> include : addNMPath ( ' datalib ' , includePaths ) <nl> } <nl> ] . concat ( config . module . loaders ) ; <nl> + } <nl> return config ; <nl> } ; <nl> 
mmm a / packages / examples / index . json <nl> ppp b / packages / examples / index . json <nl> " template " : " resize - full " <nl> } , <nl> - { <nl> - " title " : " Resize Table " , <nl> - " link " : " resize - table " , <nl> - " template " : " resize - table " <nl> - } , <nl> - { <nl> - " title " : " Resize Matrix " , <nl> - " link " : " resize - matrix " , <nl> - " template " : " resize - matrix " <nl> - } , <nl> { <nl> " title " : " LineUp " , <nl> " link " : " lineup " <nl> 
mmm a / python / pycandela / setup . py <nl> ppp b / python / pycandela / setup . py <nl> setup ( <nl> name = ' pycandela ' , <nl> - version = ' 0 . 3 . 0 ' , <nl> + version = ' 0 . 4 . 0 ' , <nl> description = ' Jupyter interface for Candela visualization components ' , <nl> author = ' Kitware , Inc . ' , <nl> author_email = ' kitware @ kitware . com ' , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " script - ext - html - webpack - plugin " : " ^ 1 . 8 . 0 " , <nl> " simplehttp2server " : " ^ 1 . 0 . 0 " , <nl> - " sw - precache - webpack - plugin " : " ^ 0 . 11 . 0 " , <nl> + " sw - precache - webpack - plugin " : " ^ 0 . 11 . 2 " , <nl> " tmp " : " 0 . 0 . 31 " , <nl> " unfetch " : " ^ 2 . 1 . 2 " , <nl> " url - loader " : " ^ 0 . 5 . 8 " , <nl> 
mmm a / . travis . yml <nl> ppp b / . travis . yml <nl> cache : <nl> npm : true <nl> + before_script : <nl> + - echo " which google - chrome " <nl> + - echo ` which google - chrome ` <nl> + - echo " which google - chrome - stable " <nl> + - echo ` which google - chrome - stable ` <nl> + - export LIGHTHOUSE_CHROMIUM_PATH = ` which google - chrome - stable ` <nl> script : <nl> - npm run lint <nl> - npm run test <nl> 
mmm a / tests / lib / chrome . js <nl> ppp b / tests / lib / chrome . js <nl> import chrome from ' chrome - remote - interface ' ; <nl> + import fs from ' fs . promised ' ; <nl> export default async ( ) = > { <nl> let launcher = new Launcher ( { <nl> @ @ - 12 , 7 + 13 , 18 @ @ export default async ( ) = > { <nl> ] <nl> } ) ; <nl> await launcher . launch ( ) ; <nl> - let protocol = await setup ( ) ; <nl> + / / Wait for chrome to launch <nl> + await delay ( 1000 ) ; <nl> + <nl> + let protocol ; <nl> + try { <nl> + protocol = await setup ( ) ; <nl> + } catch ( err ) { <nl> + console . log ( ' chrome errors ' ) ; <nl> + let chromeErrors = fs . readFile ( launcher . errFile , ' utf - 8 ' ) ; <nl> + console . error ( chromeErrors ) ; <nl> + throw err ; <nl> + } <nl> return { launcher , protocol } ; <nl> } ; <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " scripts " : { <nl> " pretest " : " yarn lint " , <nl> - " test " : " lerna run test " , <nl> + " test " : " lerna run test - - stream " , <nl> " prettier " : " prettier - - write * * / * . { js , ts , tsx , json , css , scss , md , yml } " , <nl> " lint " : " eslint . " <nl> } , <nl> 
mmm a / packages / cli / package . json <nl> ppp b / packages / cli / package . json <nl> " homepage " : " https : / / github . com / preactjs / preact - cli " , <nl> " devDependencies " : { <nl> - " eslint " : " ^ 7 . 12 . 1 " , <nl> " html - looks - like " : " ^ 1 . 0 . 2 " , <nl> " jest " : " ^ 26 . 0 . 1 " , <nl> - " lerna " : " ^ 3 . 16 . 4 " , <nl> - " lint - staged " : " ^ 10 . 5 . 0 " , <nl> " mkdirp " : " ^ 1 . 0 . 3 " , <nl> " ncp " : " ^ 2 . 0 . 0 " , <nl> " node - sass " : " ^ 4 . 12 . 0 " , <nl> 
mmm a / . github / workflows / release . yml <nl> ppp b / . github / workflows / release . yml <nl> - name : Install Dependencies <nl> run : yarn <nl> - - name : Create Release Pull Request <nl> + - name : Create Release Pull Request or Publish to npm <nl> uses : changesets / action @ master <nl> + with : <nl> + # This expects you to have a script called release which does a build for your packages and calls changeset publish <nl> + publish : yarn release <nl> env : <nl> GITHUB_TOKEN : $ { { secrets . REPO_SCOPED_TOKEN } } <nl> + NPM_TOKEN : $ { { secrets . PREACT_NPM_TOKEN } } <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> LIGHTHOUSE_CHROMIUM_PATH : ' which google - chrome - stable ' <nl> run : npm run test <nl> - pnpTest : <nl> - name : PnPTest <nl> - runs - on : ubuntu - latest <nl> - steps : <nl> - - uses : actions / checkout @ v2 <nl> - with : <nl> - fetch - depth : 1 <nl> - <nl> - - uses : actions / setup - node @ v1 <nl> - with : <nl> - node - version : 12 . x <nl> - <nl> - - name : Run PnP test <nl> - run : | <nl> - git clone https : / / github . com / preactjs - templates / default . git default <nl> - cd default / template <nl> - touch yarn . lock <nl> - echo $ ( cat package . json | jq ' . name = " pnp - test " ' ) > package . json <nl> - yarn set version 2 <nl> - yarn config set pnpFallbackMode none <nl> - yarn config set compressionLevel 0 <nl> - yarn link - A - p . . / . . <nl> - yarn build <nl> - <nl> ci - success : <nl> name : ci <nl> if : $ { { success ( ) } } <nl> needs : <nl> - test <nl> - - pnpTest <nl> runs - on : ubuntu - latest <nl> steps : <nl> - name : CI succeeded <nl> 
mmm a / html / package . json <nl> ppp b / html / package . json <nl> " dev " : " webpack - - config webpack . config . js - - mode development " , <nl> " watch " : " webpack - - config webpack . config . js - - mode development - - watch " , <nl> - " prod " : " webpack - - config webpack . config . js - - mode production " <nl> + " prod " : " webpack - - config webpack . config . js - - mode production " , <nl> + " development " : " npm run dev " , <nl> + " production " : " npm run prod " <nl> } , <nl> " repository " : { <nl> " type " : " git " , <nl> 
mmm a / html / webpack . config . js <nl> ppp b / html / webpack . config . js <nl> } , <nl> { <nl> test : / \ . ( eot | png | svg | ttf | woff ) / , <nl> - use : { <nl> - loader : ' url - loader ' , <nl> - options : { <nl> - limit : false , <nl> - name : ' assets / [ name ] . [ ext ] ' <nl> - } <nl> + type : ' asset ' , <nl> + generator : { <nl> + filename : ' assets / [ name ] [ ext ] ' <nl> } <nl> } <nl> ] <nl> 
mmm a / . github / workflows / github_actions . yml <nl> ppp b / . github / workflows / github_actions . yml <nl> node - version : $ { { matrix . node - version } } <nl> - name : Restore dependencies <nl> run : npm ci <nl> + - name : Lint <nl> + run : npm run lint <nl> - name : Build <nl> run : npm run production <nl> 
mmm a / VRCX . csproj <nl> ppp b / VRCX . csproj <nl> < ItemGroup > <nl> < PackageReference Include = " CefSharp . Common " > <nl> - < Version > 91 . 1 . 230 < / Version > <nl> + < Version > 92 . 0 . 260 < / Version > <nl> < / PackageReference > <nl> < PackageReference Include = " CefSharp . OffScreen " > <nl> - < Version > 91 . 1 . 230 < / Version > <nl> + < Version > 92 . 0 . 260 < / Version > <nl> < / PackageReference > <nl> < PackageReference Include = " CefSharp . WinForms " > <nl> - < Version > 91 . 1 . 230 < / Version > <nl> + < Version > 92 . 0 . 260 < / Version > <nl> < / PackageReference > <nl> < PackageReference Include = " DiscordRichPresence " > <nl> < Version > 1 . 0 . 175 < / Version > <nl> 
mmm a / html / package - lock . json <nl> ppp b / html / package - lock . json <nl> " packages " : { <nl> " " : { <nl> + " name " : " html " , <nl> " license " : " MIT " , <nl> " devDependencies " : { <nl> " @ babel / eslint - parser " : " ^ 7 . 19 . 1 " , <nl> " dev " : true <nl> } , <nl> " node_modules / json5 " : { <nl> - " version " : " 1 . 0 . 1 " , <nl> - " resolved " : " https : / / registry . npmjs . org / json5 / - / json5 - 1 . 0 . 1 . tgz " , <nl> - " integrity " : " sha512 - aKS4WQjPenRxiQsC93MNfjx + nbF4PAdYzmd / 1JIj8HYzqfbu86beTuNgXDzPknWk0n0uARlyewZo4s + + ES36Ow = = " , <nl> + " version " : " 1 . 0 . 2 " , <nl> + " resolved " : " https : / / registry . npmjs . org / json5 / - / json5 - 1 . 0 . 2 . tgz " , <nl> + " integrity " : " sha512 - g1MWMLBiz8FKi1e4w0UyVL3w + iJceWAFBAaBnnGKOpNa5f8TLktkbre1 + s6oICydWAm + HRUGTmI + / / xv2hvXYA = = " , <nl> " dev " : true , <nl> " dependencies " : { <nl> " minimist " : " ^ 1 . 2 . 0 " <nl> " dev " : true <nl> } , <nl> " json5 " : { <nl> - " version " : " 1 . 0 . 1 " , <nl> - " resolved " : " https : / / registry . npmjs . org / json5 / - / json5 - 1 . 0 . 1 . tgz " , <nl> - " integrity " : " sha512 - aKS4WQjPenRxiQsC93MNfjx + nbF4PAdYzmd / 1JIj8HYzqfbu86beTuNgXDzPknWk0n0uARlyewZo4s + + ES36Ow = = " , <nl> + " version " : " 1 . 0 . 2 " , <nl> + " resolved " : " https : / / registry . npmjs . org / json5 / - / json5 - 1 . 0 . 2 . tgz " , <nl> + " integrity " : " sha512 - g1MWMLBiz8FKi1e4w0UyVL3w + iJceWAFBAaBnnGKOpNa5f8TLktkbre1 + s6oICydWAm + HRUGTmI + / / xv2hvXYA = = " , <nl> " dev " : true , <nl> " requires " : { <nl> " minimist " : " ^ 1 . 2 . 0 " <nl> 
mmm a / VRCX . csproj <nl> ppp b / VRCX . csproj <nl> < ItemGroup > <nl> < PackageReference Include = " CefSharp . Common " > <nl> - < Version > 109 . 1 . 110 < / Version > <nl> + < Version > 110 . 0 . 250 < / Version > <nl> < / PackageReference > <nl> < PackageReference Include = " CefSharp . OffScreen " > <nl> - < Version > 109 . 1 . 110 < / Version > <nl> + < Version > 110 . 0 . 250 < / Version > <nl> < / PackageReference > <nl> < PackageReference Include = " CefSharp . WinForms " > <nl> - < Version > 109 . 1 . 110 < / Version > <nl> + < Version > 110 . 0 . 250 < / Version > <nl> < / PackageReference > <nl> < PackageReference Include = " DiscordRichPresence " > <nl> < Version > 1 . 1 . 3 . 18 < / Version > <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * isBoolean ( str ) * * | check if a string is a boolean . <nl> * * isByteLength ( str [ , options ] ) * * | check if the string ' s length ( in UTF - 8 bytes ) falls in a range . < br / > < br / > ` options ` is an object which defaults to ` { min : 0 , max : undefined } ` . <nl> * * isCreditCard ( str ) * * | check if the string is a credit card . <nl> - * * isCurrency ( str [ , options ] ) * * | check if the string is a valid currency amount . < br / > < br / > ` options ` is an object which defaults to ` { symbol : ' $ ' , require_symbol : false , allow_space_after_symbol : false , symbol_after_digits : false , allow_negatives : true , parens_for_negatives : false , negative_sign_before_digits : false , negative_sign_after_digits : false , allow_negative_sign_placeholder : false , thousands_separator : ' , ' , decimal_separator : ' . ' , allow_decimal : true , require_decimal : false , digits_after_decimal : [ 2 ] , allow_space_after_digits : false } ` . < br / > * * Note : * * The array ` digits_after_decimal ` is filled with the exact number of digits allowd not a range , for example a range 1 to 3 will be given as [ 1 , 2 , 3 ] . <nl> + * * isCurrency ( str [ , options ] ) * * | check if the string is a valid currency amount . < br / > < br / > ` options ` is an object which defaults to ` { symbol : ' $ ' , require_symbol : false , allow_space_after_symbol : false , symbol_after_digits : false , allow_negatives : true , parens_for_negatives : false , negative_sign_before_digits : false , negative_sign_after_digits : false , allow_negative_sign_placeholder : false , thousands_separator : ' , ' , decimal_separator : ' . ' , allow_decimal : true , require_decimal : false , digits_after_decimal : [ 2 ] , allow_space_after_digits : false } ` . < br / > * * Note : * * The array ` digits_after_decimal ` is filled with the exact number of digits allowed not a range , for example a range 1 to 3 will be given as [ 1 , 2 , 3 ] . <nl> * * isDataURI ( str ) * * | check if the string is a [ data uri format ] ( https : / / developer . mozilla . org / en - US / docs / Web / HTTP / data_URIs ) . <nl> * * isDecimal ( str [ , options ] ) * * | check if the string represents a decimal number , such as 0 . 1 , . 3 , 1 . 1 , 1 . 00003 , 4 . 0 , etc . < br / > < br / > ` options ` is an object which defaults to ` { force_decimal : false , decimal_digits : ' 1 , ' , locale : ' en - US ' } ` < br / > < br / > ` locale ` determine the decimal separator and is one of ` [ ' ar ' , ' ar - AE ' , ' ar - BH ' , ' ar - DZ ' , ' ar - EG ' , ' ar - IQ ' , ' ar - JO ' , ' ar - KW ' , ' ar - LB ' , ' ar - LY ' , ' ar - MA ' , ' ar - QA ' , ' ar - QM ' , ' ar - SA ' , ' ar - SD ' , ' ar - SY ' , ' ar - TN ' , ' ar - YE ' , ' bg - BG ' , ' cs - CZ ' , ' da - DK ' , ' de - DE ' , ' en - AU ' , ' en - GB ' , ' en - HK ' , ' en - IN ' , ' en - NZ ' , ' en - US ' , ' en - ZA ' , ' en - ZM ' , ' es - ES ' , ' fr - FR ' , ' hu - HU ' , ' it - IT ' , ' ku - IQ ' , nb - NO ' , ' nl - NL ' , ' nn - NO ' , ' pl - PL ' , ' pt - BR ' , ' pt - PT ' , ' ru - RU ' , ' sr - RS ' , ' sr - RS @ latin ' , ' sv - SE ' , ' tr - TR ' , ' uk - UA ' ] ` . < br / > * * Note : * * ` decimal_digits ` is given as a range like ' 1 , 3 ' , a specific value like ' 3 ' or min like ' 1 , ' . <nl> * * isDivisibleBy ( str , number ) * * | check if the string is a number that ' s divisible by another . <nl> 
mmm a / test / validators . js <nl> ppp b / test / validators . js <nl> ' 22040 - 020 ' , <nl> ' 39400 - 152 ' , <nl> ] , <nl> + invalid : [ <nl> + ' 79800A12 ' , <nl> + ' 13165 - 00 ' , <nl> + ' 38175 - abc ' , <nl> + ' 81470 - 2763 ' , <nl> + ' 78908 ' , <nl> + ' 13010 | 111 ' , <nl> + ] , <nl> } , <nl> { <nl> locale : ' NZ ' , <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> - * * New and Improved locales * * : <nl> - - [ # 1439 ] ( https : / / github . com / validatorjs / validator . js / pull / 1439 ) @ saidfagan <nl> - - [ # 1420 ] ( https : / / github . com / validatorjs / validator . js / pull / 1420 ) @ icyice0217 <nl> - - [ # 1411 ] ( https : / / github . com / validatorjs / validator . js / pull / 1411 ) @ stinkymonkeyph <nl> - - [ # 1394 ] ( https : / / github . com / validatorjs / validator . js / pull / 1394 ) @ heanzyzabala <nl> - - [ # 1391 ] ( https : / / github . com / validatorjs / validator . js / pull / 1391 ) @ heanzyzabala <nl> - - [ # 1388 ] ( https : / / github . com / validatorjs / validator . js / pull / 1388 ) @ stinkymonkeyph <nl> - - [ # 1384 ] ( https : / / github . com / validatorjs / validator . js / pull / 1384 ) @ lorenzodb1 <nl> - - [ # 1371 ] ( https : / / github . com / validatorjs / validator . js / pull / 1371 ) @ rubiin <nl> - - [ # 1370 ] ( https : / / github . com / validatorjs / validator . js / pull / 1370 ) @ rubiin <nl> - - [ # 1367 ] ( https : / / github . com / validatorjs / validator . js / pull / 1367 ) @ rubiin <nl> - - [ # 1356 ] ( https : / / github . com / validatorjs / validator . js / pull / 1356 ) @ MladenZeljic <nl> - - [ # 1303 ] ( https : / / github . com / validatorjs / validator . js / pull / 1301 ) @ heathcliff - hu <nl> + - ` isMobilePhone ` : <nl> + - [ # 1439 ] ( https : / / github . com / validatorjs / validator . js / pull / 1439 ) ` az - AZ ` @ saidfagan <nl> + - [ # 1420 ] ( https : / / github . com / validatorjs / validator . js / pull / 1420 ) ` uz - Uz ` @ icyice0217 <nl> + - [ # 1391 ] ( https : / / github . com / validatorjs / validator . js / pull / 1391 ) ` de - DE ` @ heanzyzabala <nl> + - [ # 1388 ] ( https : / / github . com / validatorjs / validator . js / pull / 1388 ) ` en - PH ` @ stinkymonkeyph <nl> + - [ # 1370 ] ( https : / / github . com / validatorjs / validator . js / pull / 1370 ) ` es - ES ` @ rubiin <nl> + - [ # 1356 ] ( https : / / github . com / validatorjs / validator . js / pull / 1356 ) ` bs - BA ` @ MladenZeljic <nl> + - [ # 1303 ] ( https : / / github . com / validatorjs / validator . js / pull / 1301 ) ` zh - CN ` @ heathcliff - hu <nl> + - ` isPostalCode ` : <nl> + - [ # 1439 ] ( https : / / github . com / validatorjs / validator . js / pull / 1439 ) ` AZ ` @ saidfagan <nl> + - [ # 1370 ] ( https : / / github . com / validatorjs / validator . js / pull / 1370 ) ` ES ` @ rubiin <nl> + - [ # 1367 ] ( https : / / github . com / validatorjs / validator . js / pull / 1367 ) ` IL ` @ rubiin <nl> + - ` isAlpha ` , ` isAlphanumeric ` : <nl> + - [ # 1411 ] ( https : / / github . com / validatorjs / validator . js / pull / 1411 ) ` fa - AF ` , ` fa - IR ` @ stinkymonkeyph <nl> + - [ # 1371 ] ( https : / / github . com / validatorjs / validator . js / pull / 1371 ) ` vi - VN ` @ rubiin <nl> + - ` isBAN ` : <nl> + - [ # 1394 ] ( https : / / github . com / validatorjs / validator . js / pull / 1394 ) ` EG ` , ` SV ` @ heanzyzabala <nl> + - ` isIdentityCard ` : <nl> + - [ # 1384 ] ( https : / / github . com / validatorjs / validator . js / pull / 1384 ) ` IT ` @ lorenzodb1 <nl> # # # # 13 . 1 . 1 <nl> 
mmm a / . github / workflows / ci . yml <nl> ppp b / . github / workflows / ci . yml <nl> strategy : <nl> matrix : <nl> node - version : [ 14 , 12 , 10 , 8 , 6 ] <nl> + name : Run tests on Node . js $ { { matrix . node - version } } <nl> steps : <nl> - name : Setup Node . js $ { { matrix . node - version } } <nl> uses : actions / setup - node @ v2 - beta <nl> with : <nl> node - version : $ { { matrix . node - version } } <nl> check - latest : true <nl> - - name : Checkout Repository <nl> + - name : Checkout repository <nl> uses : actions / checkout @ v2 <nl> - - name : Install Dependencies <nl> + - name : Install dependencies <nl> run : npm install <nl> - - name : Run Tests <nl> + - name : Run tests <nl> run : npm test <nl> - if : matrix . node - version = = 14 <nl> name : Generate coverage file <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> * * This library validates and sanitizes strings only . * * <nl> If you ' re not sure if your input is a string , coerce it using ` input + ' ' ` . <nl> - Passing anything other than a string is an error . <nl> + Passing anything other than a string will result in an error . <nl> # # Installation and Usage <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> [ ! [ Backers on Open Collective ] ( https : / / opencollective . com / validatorjs / backers / badge . svg ) ] ( # backers ) <nl> [ ! [ Sponsors on Open Collective ] ( https : / / opencollective . com / validatorjs / sponsors / badge . svg ) ] ( # sponsors ) <nl> + [ ! [ Gitter ] ( https : / / badges . gitter . im / validatorjs / community . svg ) ] ( https : / / gitter . im / validatorjs / community ) <nl> A library of string validators and sanitizers . <nl> 
mmm a / . github / pull_request_template . md <nl> ppp b / . github / pull_request_template . md <nl> feat ( validatorName ) : brief title of what has been done <nl> - - > <nl> - { { briefly describe what you have done in this PR } } <nl> + < ! - - - briefly describe what you have done in this PR - - - > <nl> # # Checklist <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> - [ chriso ] ( https : / / github . com / chriso ) - * * Chris O ' Hara * * ( author ) <nl> - [ profnandaa ] ( https : / / github . com / profnandaa ) - * * Anthony Nandaa * * <nl> + - [ ezkemboi ] ( https : / / github . com / ezkemboi ) - * * Ezrqn Kemboi * * <nl> + - [ tux - tn ] ( https : / / github . com / tux - tn ) - * * Sarhan Aissi * * <nl> # # Reading <nl> 
mmm a / . github / pull_request_template . md <nl> ppp b / . github / pull_request_template . md <nl> < ! - - - briefly describe what you have done in this PR - - - > <nl> + < ! - - - provide some ( credible ) references showing the structure of the data to be validated , if applicable - - - > <nl> + <nl> # # Checklist <nl> - [ ] PR contains only changes related ; no stray files , etc . <nl> - [ ] README updated ( where applicable ) <nl> - [ ] Tests written ( where applicable ) <nl> + - [ ] References provided in PR ( where applicable ) <nl> 
mmm a / index . d . ts <nl> ppp b / index . d . ts <nl> public warning ( . . . args : Rollbar . LogArgument [ ] ) : Rollbar . LogResult ; <nl> public error ( . . . args : Rollbar . LogArgument [ ] ) : Rollbar . LogResult ; <nl> public critical ( . . . args : Rollbar . LogArgument [ ] ) : Rollbar . LogResult ; <nl> + public wait ( callback : ( ) = > void ) : void ; <nl> public captureEvent ( metadata : object , level : Rollbar . Level ) : Rollbar . TelemetryEvent ; <nl> 
mmm a / karma . conf . js <nl> ppp b / karma . conf . js <nl> webpack : { <nl> plugins : [ defaultsPlugin ] , <nl> devtool : ' inline - source - map ' , <nl> + performance : { hints : false } , <nl> module : { <nl> rules : [ <nl> { <nl> 
mmm a / webpack_config / webpack . isomorphic . js <nl> ppp b / webpack_config / webpack . isomorphic . js <nl> + * @ file <nl> + * / <nl> import path from ' path ' <nl> import config from ' . / config ' <nl> import webpack from ' webpack ' <nl> - import I18nPlugin from ' i18n - webpack - plugin ' <nl> import CircularDependencyPlugin from ' circular - dependency - plugin ' <nl> - const { <nl> - srcPath , <nl> - rootPath , <nl> - srcCommonPath , <nl> - APP_LANGUAGE , <nl> - BASE_API , <nl> - NODE_ENV , <nl> - i18n <nl> - } = config <nl> + const { srcPath , rootPath , srcCommonPath , BASE_API , NODE_ENV } = config <nl> const definePluginArgs = { <nl> - ' process . env . APP_LANGUAGE ' : JSON . stringify ( APP_LANGUAGE ) , <nl> ' process . env . NODE_ENV ' : JSON . stringify ( NODE_ENV ) , <nl> ' process . env . BASE_API ' : JSON . stringify ( BASE_API ) <nl> } <nl> - const languageTranslation = ( function ( ) { <nl> - const isTranslationExists = i18n . hasOwnProperty ( APP_LANGUAGE ) <nl> - if ( isTranslationExists ) { <nl> - return i18n [ APP_LANGUAGE ] <nl> - } else { <nl> - throw new Error ( <nl> - ` Something went wrong with your i18n . Check that " $ { APP_LANGUAGE } " property exists in i18n object . ` <nl> - ) <nl> - } <nl> - } ) ( ) <nl> - <nl> export default { <nl> resolve : { <nl> / / Aliases that both server and client use <nl> @ @ - 77 , 12 + 59 , 8 @ @ export default { <nl> banner : config . banner <nl> } ) , <nl> new CircularDependencyPlugin ( { <nl> - / / exclude detection of files based on a RegExp <nl> exclude : / node_modules / <nl> - / / add errors to webpack instead of warnings <nl> - / / failOnError : true <nl> } ) , <nl> - new I18nPlugin ( languageTranslation , { functionName : ' i18n ' } ) , <nl> new webpack . DefinePlugin ( definePluginArgs ) <nl> ] <nl> } <nl> 
mmm a / README . md <nl> ppp b / README . md <nl> < div > <nl> + < a href = " https : / / app . codesponsor . io / link / cFthevq5iGu9WkCHS316WqmS / Metnew / react - semantic . ui - starter " rel = " nofollow " > < img src = " https : / / app . codesponsor . io / embed / cFthevq5iGu9WkCHS316WqmS / Metnew / react - semantic . ui - starter . svg " style = " width : 888px ; height : 68px ; " alt = " Sponsor " / > < / a > <nl> [ ! [ Build Status ] ( https : / / travis - ci . org / Metnew / react - semantic . ui - starter . svg ? branch = master ) ] ( https : / / travis - ci . org / Metnew / react - semantic . ui - starter ) <nl> [ ! [ Join the chat at https : / / gitter . im / react - semantic - ui - starter / Lobby ] ( https : / / badges . gitter . im / react - semantic - ui - starter / Lobby . svg ) ] ( https : / / gitter . im / react - semantic - ui - starter / Lobby ? utm_source = badge & utm_medium = badge & utm_campaign = pr - badge & utm_content = badge ) <nl> 
mmm a / src / common / containers / UserItem / index . jsx <nl> ppp b / src / common / containers / UserItem / index . jsx <nl> render ( ) { <nl> const { user , isLoaded } = this . props <nl> - console . log ( user , isLoaded ) <nl> return ( <nl> < div > <nl> < Helmet > <nl> @ @ - 54 , 11 + 53 , 9 @ @ class UserItem extends Component { <nl> function mapStateToProps ( state : GlobalState , props ) { <nl> const users = getEntitiesUsersState ( state ) <nl> - console . log ( state ) <nl> const userId : string = props . match . params . id <nl> const { entities , isLoaded , isLoading } = users <nl> const user = entities ? entities [ userId ] : { } <nl> - console . log ( entities , userId ) <nl> return { <nl> user , <nl> userId , <nl> 
mmm a / webpack_config / assets / manifest . json <nl> ppp b / webpack_config / assets / manifest . json <nl> - " name " : " React - Semantic . UI - Starter " , <nl> - " short_name " : " RSUIS " , <nl> - " description " : " https : / / github . com / Metnew / react - semantic . ui - starter " , <nl> + " name " : " Noir " , <nl> + " short_name " : " Noir " , <nl> + " description " : " https : / / github . com / Metnew / noir " , <nl> " icons " : [ <nl> { <nl> " src " : " favicons / android - chrome - 36x36 . png " , <nl> 
mmm a / src / common / reducers / users / index . js <nl> ppp b / src / common / reducers / users / index . js <nl> / / result may be an object , if it was request with params <nl> / / ` normalizeArrayOfItems ` works only with arrays ! <nl> const { count , entities } = normalizeArrayOfItems ( [ action . payload ] ) <nl> - console . log ( entities ) <nl> return { <nl> . . . state , <nl> isLoaded : true , <nl> 
mmm a / src / common / api / utils / xhr_wrapper . js <nl> ppp b / src / common / api / utils / xhr_wrapper . js <nl> * / <nl> async function parseJSON ( res : Response ) : Object { <nl> let json : Object <nl> + / / status response field in return object <nl> try { <nl> json = await res . json ( ) <nl> } catch ( e ) { <nl> 
mmm a / src / common / app / configure_app . js <nl> ppp b / src / common / app / configure_app . js <nl> import { autoRehydrate } from ' redux - persist ' <nl> import { createStore , applyMiddleware , compose } from ' redux ' <nl> import { routerMiddleware } from ' react - router - redux ' <nl> - / / Application <nl> + / / / / Application <nl> import rootReducer from ' reducers ' <nl> - import { routes , history } from ' routing ' <nl> - <nl> + import { history , routes } from ' routing ' <nl> + / / <nl> / * * <nl> * Configure application store with middlewares . <nl> * @ param { Object } initialState - preloadedState <nl> @ @ - 18 , 7 + 18 , 7 @ @ const configureStore = ( initialState : Object ) = > { <nl> const middlewares = [ thunk , routerMiddleware ( history ) ] <nl> const appliedMiddlewares = middlewares . map ( a = > applyMiddleware ( a ) ) <nl> const enhancers = [ rehydrate ] . concat ( appliedMiddlewares ) <nl> - / / <nl> + <nl> const getComposeFunc = ( ) = > { <nl> if ( process . env . NODE_ENV = = = ' development ' ) { <nl> const { composeWithDevTools } = require ( ' redux - devtools - extension ' ) <nl> 
mmm a / src / server / middlewares / auth . js <nl> ppp b / src / server / middlewares / auth . js <nl> import chalk from ' chalk ' <nl> import jwt from ' jsonwebtoken ' <nl> - import { JWT_TOKEN } from ' api / LocalStorageCookiesSvc ' <nl> + import { JWT_TOKEN } from ' common / api / LocalStorageCookiesSvc ' <nl> / * * <nl> * Auth - related middleware . <nl> * Checks that user is logged in and token is valid <nl> @ @ - 12 , 18 + 12 , 18 @ @ import { JWT_TOKEN } from ' api / LocalStorageCookiesSvc ' <nl> * @ param { Function } next <nl> * / <nl> export default ( req : Object , res : Object , next : ( ) = > void ) = > { <nl> - const { JWT_SECRET } = process . env <nl> req . user = { <nl> token : null , <nl> isLoggedIn : false <nl> } <nl> + <nl> const token : string = req . cookies [ JWT_TOKEN ] <nl> if ( ! token ) { <nl> return next ( ) <nl> } <nl> console . log ( chalk . blue ( ' USER HAS TOKEN ' ) ) <nl> - jwt . verify ( token , JWT_SECRET , ( err , decoded ) = > { <nl> + jwt . verify ( token , process . env . JWT_SECRET , ( err , decoded ) = > { <nl> if ( err ) { <nl> console . log ( chalk . red ( ' CANT DECODE JWT TOKEN ! ' , err ) ) <nl> } else { <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> import path from ' path ' <nl> - import i18n from ' . . / locals ' <nl> import manifest from ' . . / static / manifest ' <nl> let { <nl> @ @ - 38 , 7 + 37 , 6 @ @ export default { <nl> title : ' Noir ' , <nl> publicPath : ' / ' , <nl> / / i18n object <nl> - i18n , <nl> isProduction , <nl> / / Env vars <nl> BASE_API , <nl> 
mmm a / src / common / components / addons / RouteAuth / index . test . jsx <nl> ppp b / src / common / components / addons / RouteAuth / index . test . jsx <nl> const sampleRouteItem = routing . filter ( a = > a . component & & a . tag ) [ 0 ] <nl> - describe ( ' RouteAuth component ' , ( ) = > { <nl> - / / it ( ' creates < Redirect / > if user dont have access ' , done = > { <nl> - / / const gotRedirect = { <nl> - / / . . . sampleRouteItem , <nl> - / / canAccess : accessExceptInbox , <nl> - / / path : ' / inbox ' <nl> - / / } <nl> - / / const component = shallow ( < RouteAuth { . . . gotRedirect } / > ) <nl> - / / done ( ) <nl> - / / } ) <nl> - / / <nl> - / / it ( ' creates component if user have access ' , done = > { <nl> - / / const gotComponent = { <nl> - / / . . . sampleRouteItem , <nl> - / / canAccess : accessToInboxOnly , <nl> - / / path : ' / inbox ' <nl> - / / } <nl> - / / const component = shallow ( < RouteAuth { . . . gotComponent } / > ) <nl> - / / console . log ( component ) <nl> - / / done ( ) <nl> - / / } ) <nl> + xdescribe ( ' RouteAuth component ' , ( ) = > { <nl> + it ( ' creates < Redirect / > if user dont have access ' , done = > { <nl> + const gotRedirect = { <nl> + . . . sampleRouteItem , <nl> + canAccess : accessExceptInbox , <nl> + path : ' / inbox ' <nl> + } <nl> + const component = shallow ( < RouteAuth { . . . gotRedirect } / > ) <nl> + done ( ) <nl> + } ) <nl> + <nl> + it ( ' creates component if user have access ' , done = > { <nl> + const gotComponent = { <nl> + . . . sampleRouteItem , <nl> + canAccess : accessToInboxOnly , <nl> + path : ' / inbox ' <nl> + } <nl> + const component = shallow ( < RouteAuth { . . . gotComponent } / > ) <nl> + console . log ( component ) <nl> + done ( ) <nl> + } ) <nl> } ) <nl> 
mmm a / src / common / api / utils / xhr_wrapper . js <nl> ppp b / src / common / api / utils / xhr_wrapper . js <nl> ) <nl> if ( ! isRequestToExternalResource ) { <nl> - console . log ( ` Request $ { url } was sent to our domain ` , request ) <nl> + / / console . log ( ` Request $ { url } was sent to our domain ` , request ) <nl> } else { <nl> - console . log ( ` Request $ { url } was sent to external domain ` , request ) <nl> + / / console . log ( ` Request $ { url } was sent to external domain ` , request ) <nl> } <nl> return { <nl> 
mmm a / src / common / api / AuthSvc / index . js <nl> ppp b / src / common / api / AuthSvc / index . js <nl> export type LoginDataType = { <nl> username : string , <nl> - password : string <nl> + password : string , <nl> + language ? : string <nl> } <nl> export async function loginAPI ( data : LoginDataType ) { <nl> 
mmm a / src / server / config / index . dev . js <nl> ppp b / src / server / config / index . dev . js <nl> import { readFileSync } from ' fs ' <nl> + / / If you want quick SSL for prototyping : <nl> + / / import pseudossl from ' pseudossl ' <nl> export const serverOptions = { <nl> key : readFileSync ( path . join ( __dirname , ' . / ssl / server . key ' ) ) , <nl> 
mmm a / webpack_config / config . js <nl> ppp b / webpack_config / config . js <nl> const srcCommonPath = path . join ( srcPath , ' . / common ' ) / / = " / src / common " <nl> / / Vars for server only <nl> - const CLIENT_DIST_PATH = path . join ( distPath , ' . / client ' ) <nl> + const CLIENT_DIST_PATH = path . join ( distPath , ' . / client ' ) / / = " / dist / client " <nl> JWT_SECRET = JWT_SECRET | | ' secret ' <nl> PORT = PORT | | 3000 <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " build " : " npm run frontend_build & & npm run server_build " , <nl> " dev " : " NODE_ENV = development babel - node . / src / server / index . dev " , <nl> - " dev : exp " : " NODE_ENV = development babel - node - - - - expose - http2 . / src / server / index . dev " , <nl> " server_build " : " NODE_ENV = production webpack - - config webpack_config / server / webpack . prod . babel . js " , <nl> " frontend_build " : " NODE_ENV = production webpack - - config webpack_config / client / webpack . prod . babel . js " , <nl> " test " : " NODE_ENV = test jest - - config = jest_config / jest . config . json - - coverage - - forceExit | | true " , <nl> 
mmm a / src / common / api / AuthSvc / index . js <nl> ppp b / src / common / api / AuthSvc / index . js <nl> export type LoginDataType = { <nl> username : string , <nl> - password : string , <nl> - language ? : string <nl> + password : string <nl> } <nl> export async function loginAPI ( data : LoginDataType ) { <nl> 
mmm a / src / common / components / addons / RoutingWrapper / index . jsx <nl> ppp b / src / common / components / addons / RoutingWrapper / index . jsx <nl> import { Switch , Redirect } from ' react - router - dom ' <nl> import LazyLoad from ' components / addons / LazyLoad ' <nl> import { getAuthState } from ' selectors ' <nl> - import type { RouteItem } from ' routing ' <nl> + import type { RouteItem } from ' types ' <nl> type Props = { <nl> routes : RouteItem [ ] , <nl> @ @ - 52 , 7 + 52 , 7 @ @ export default class RoutingWrapper extends Component { <nl> const { path , exact , strict , component , lazy } = a <nl> / / can visitor access this route ? <nl> / / this function determinates is user allowed to visit route <nl> - const canAccess = : : this . authCheck <nl> + const canAccess = this . authCheck . bind ( this ) <nl> / / select only props that we need <nl> const b = { path , exact , strict , canAccess } <nl> 
mmm a / src / common / styles / global . jsx <nl> ppp b / src / common / styles / global . jsx <nl> box - sizing : border - box ; <nl> } <nl> - / * After one of the latest releases Semantic styles scrollbars ! <nl> - * It ' s important to remember this info , when you work on custom scrollbar <nl> - * / <nl> - <nl> $ { ' ' / * body : : - webkit - scrollbar { <nl> width : 0 ; <nl> } <nl> 
mmm a / src / common / types / index . js <nl> ppp b / src / common / types / index . js <nl> - import type { Node } from ' react ' <nl> export type PostItem = { <nl> title : string , <nl> body : string , <nl> @ @ - 40 , 6 + 39 , 6 @ @ export type RouteItem = { <nl> icon ? : string , <nl> name ? : string , <nl> sidebarVisible ? : boolean , <nl> - tag ? : Node | Function , <nl> - component ? : Node | Function <nl> + tag ? : React $ Node | Function , <nl> + component ? : React $ Node | Function <nl> } <nl> 
mmm a / src / common / styles / theme . jsx <nl> ppp b / src / common / styles / theme . jsx <nl> * / <nl> export default { <nl> - primaryColorDark : ' # 00796B ' , <nl> - primaryColor : ' # 009688 ' , <nl> - primaryColorLight : ' # B2DFDB ' , <nl> + primaryColorDark : ' # 0e1319 ' , <nl> + primaryColor : ' # 1b1e2f ' , <nl> + primaryColorLight : ' # 303747 ' , <nl> primaryColorText : ' # F7F7F7 ' , <nl> - accentColor : ' # 00BCD4 ' , <nl> + accentColor : ' # e2c7c0 ' , <nl> primaryTextColor : ' # 212121 ' , <nl> secondaryTextColor : ' # 757575 ' , <nl> dividerColor : ' # BDBDBD ' <nl> 
mmm a / src / common / components / parts / Footer / style . jsx <nl> ppp b / src / common / components / parts / Footer / style . jsx <nl> width : 100 % ; <nl> display : flex ; <nl> align - items : center ; <nl> - background - color : $ { props = > props . theme . primaryColor } ; <nl> + background - color : $ { props = > props . theme . primaryColorLight } ; <nl> color : $ { props = > props . theme . primaryTextColor } ; <nl> height : 90px ; <nl> box - shadow : inset 0 0 0 0 $ { props = > props . theme . primaryColorDark } , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " babili - webpack - plugin " : " ^ 0 . 1 . 2 " , <nl> " git - rev - sync " : " ^ 1 . 9 . 1 " , <nl> - " locale " : " ^ 0 . 1 . 0 " , <nl> " prepack - webpack - plugin " : " ^ 1 . 1 . 0 " , <nl> - " purify - css " : " ^ 1 . 2 . 5 " , <nl> - " purifycss - webpack " : " ^ 0 . 7 . 0 " , <nl> - " webpack - shell - plugin " : " ^ 0 . 5 . 0 " , <nl> - " preact " : " ^ 8 . 2 . 5 " , <nl> - " preact - compat " : " ^ 3 . 17 . 0 " <nl> + " webpack - shell - plugin " : " ^ 0 . 5 . 0 " <nl> } , <nl> " scripts " : { <nl> " build " : " npm run frontend_build & & npm run server_build " , <nl> 
mmm a / webpack_config / client / webpack . base . js <nl> ppp b / webpack_config / client / webpack . base . js <nl> resolve : { <nl> alias : { <nl> . . . isomorphicWebpackConfig . resolve . alias <nl> + / / NOTE : Preact + preact - compat can save you 148Kb parsed or 14kb gzipped <nl> + / / Preact may breaks your React app , starter by default doesn ' t aim to support Preact <nl> / / react : ' preact - compat ' , <nl> / / ' react - dom ' : ' preact - compat ' , <nl> - / / ' preact - compat ' : ' preact - compat / dist / preact - compat ' , <nl> - / / ' react - redux ' : ' preact - redux ' <nl> + / / ' preact - compat ' : ' preact - compat / dist / preact - compat ' <nl> } , <nl> modules : isomorphicWebpackConfig . resolve . modules , <nl> extensions : isomorphicWebpackConfig . resolve . extensions . concat ( [ <nl> 
mmm a / . eslintrc . json <nl> ppp b / . eslintrc . json <nl> } <nl> } , <nl> + " globals " : { <nl> + " i18n " : true , <nl> + " Raven " : true , <nl> + " ga " : true <nl> + } , <nl> " env " : { <nl> " browser " : true , <nl> " amd " : true , <nl> " no - tabs " : 0 , <nl> " no - unused - vars " : 1 , <nl> " indent " : [ 2 , " tab " ] <nl> - } , <nl> - " globals " : { <nl> - " i18n " : true , <nl> - " Raven " : true , <nl> - " ga " : true <nl> } <nl> } <nl> 
mmm a / src / common / components / parts / Sidebar / index . jsx <nl> ppp b / src / common / components / parts / Sidebar / index . jsx <nl> isMobile : boolean <nl> } <nl> - export default class SidebarComponent extends Component { <nl> + class SidebarComponent extends Component { <nl> props : Props <nl> render ( ) { <nl> @ @ - 36 , 14 + 36 , 14 @ @ export default class SidebarComponent extends Component { <nl> const routes = routing . map ( ( route , i ) = > { <nl> const { external , path , icon , name , strict , exact } = route <nl> - / / Props that are applicable for both " plain link , i . e . < a > " and " RR Link " <nl> + / / Props that are common for both " < a > " and " RR Link " <nl> const basicProps = { <nl> as : external ? ' a ' : NavLink , <nl> link : true , <nl> [ external ? ' href ' : ' to ' ] : path <nl> } <nl> - / / Is it ' s RR Link , then it has more props <nl> + / / Is it ' s RR Link , then it needs additional props <nl> const externalProps = external <nl> ? { } <nl> : { <nl> @ @ - 85 , 3 + 85 , 5 @ @ export default class SidebarComponent extends Component { <nl> ) <nl> } <nl> } <nl> + <nl> + export default SidebarComponent <nl> 
mmm a / src / common / containers / App / index . jsx <nl> ppp b / src / common / containers / App / index . jsx <nl> * Checks that user is still allowed to visit path after props changed <nl> * @ param { Object } nextProps <nl> * / <nl> - componentWillReceiveProps ( nextProps ) { <nl> + componentWillReceiveProps ( nextProps : Props ) { <nl> this . checkAppAuthLogic ( nextProps . isLoggedIn ) <nl> } <nl> @ @ - 84 , 8 + 84 , 7 @ @ class App extends Component { <nl> / / script . src = ' https : / / cdn . ravenjs . com / 3 . 16 . 1 / raven . min . js ' <nl> / / document . body . appendChild ( script ) <nl> / / } <nl> - / / <nl> - / / NOTE : uncomment if you use Google Analytics <nl> + <nl> if ( process . env . GA_ID ) { <nl> ReactGA . initialize ( process . env . GA_ID ) <nl> } <nl> 
mmm a / src / common / containers / Users / components / UsersItemComponent . jsx <nl> ppp b / src / common / containers / Users / components / UsersItemComponent . jsx <nl> const { name , username , address , email , website , phone , id } = user <nl> return ( <nl> < StyledUserItem as = { Link } to = { ` / users / $ { id } ` } > <nl> - < Statistic floated = " left " value = { id } label = { ' User ID ' } / > <nl> + < Statistic floated = " left " value = { id } label = { ' User ' } / > <nl> < Item . Content > <nl> < Item . Header > <nl> { ` $ { name } " $ { username } " ` } <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " dependencies " : { <nl> " awral " : " ^ 1 . 1 . 2 " , <nl> - " body - parser " : " ^ 1 . 18 . 1 " , <nl> + " body - parser " : " ^ 1 . 18 . 2 " , <nl> " chalk " : " ^ 2 . 1 . 0 " , <nl> - " compression " : " ^ 1 . 7 . 0 " , <nl> + " compression " : " ^ 1 . 7 . 1 " , <nl> " cookie - parser " : " ^ 1 . 4 . 3 " , <nl> - " express " : " ^ 4 . 15 . 4 " , <nl> + " express " : " ^ 4 . 15 . 5 " , <nl> " express - useragent " : " ^ 1 . 0 . 8 " , <nl> " glob " : " ^ 7 . 1 . 2 " , <nl> - " helmet " : " ^ 3 . 8 . 1 " , <nl> + " helmet " : " ^ 3 . 8 . 2 " , <nl> " history " : " ^ 4 . 7 . 2 " , <nl> + " immutable " : " ^ 3 . 8 . 1 " , <nl> " isomorphic - fetch " : " ^ 2 . 2 . 1 " , <nl> " js - cookie " : " ^ 2 . 1 . 4 " , <nl> " jsonwebtoken " : " ^ 8 . 0 . 1 " , <nl> " jwt - decode " : " ^ 2 . 2 . 0 " , <nl> " lodash " : " ^ 4 . 17 . 4 " , <nl> - " morgan " : " ^ 1 . 8 . 2 " , <nl> + " morgan " : " ^ 1 . 9 . 0 " , <nl> " node - noop " : " ^ 1 . 0 . 0 " , <nl> " normalizr " : " ^ 3 . 2 . 3 " , <nl> - " offline - plugin " : " ^ 4 . 8 . 3 " , <nl> + " offline - plugin " : " ^ 4 . 8 . 4 " , <nl> " promise - polyfill " : " 6 . 0 . 2 " , <nl> - " prop - types " : " ^ 15 . 5 . 10 " , <nl> + " prop - types " : " ^ 15 . 6 . 0 " , <nl> " query - string " : " ^ 5 . 0 . 0 " , <nl> " rapscallion " : " ^ 2 . 1 . 13 " , <nl> " raven " : " ^ 2 . 1 . 2 " , <nl> - " react " : " ^ 15 . 6 . 1 " , <nl> - " react - dom " : " ^ 15 . 6 . 1 " , <nl> - " react - ga " : " ^ 2 . 2 . 0 " , <nl> - " react - headroom " : " ^ 2 . 1 . 6 " , <nl> + " react " : " ^ 16 . 0 . 0 " , <nl> + " react - dom " : " ^ 16 . 0 . 0 " , <nl> + " react - ga " : " 2 . 2 . 0 " , <nl> + " react - headroom " : " ^ 2 . 2 . 1 " , <nl> " react - helmet " : " ^ 5 . 2 . 0 " , <nl> " react - intl " : " ^ 2 . 4 . 0 " , <nl> " react - redux " : " ^ 5 . 0 . 6 " , <nl> " react - router - dom " : " ^ 4 . 2 . 2 " , <nl> " react - router - redux " : " ^ 5 . 0 . 0 - alpha . 6 " , <nl> " redux " : " ^ 3 . 7 . 2 " , <nl> - " redux - persist " : " ^ 4 . 9 . 1 " , <nl> + " redux - persist " : " ^ 4 . 10 . 1 " , <nl> " redux - thunk " : " ^ 2 . 2 . 0 " , <nl> " reselect " : " ^ 3 . 0 . 1 " , <nl> " semantic - ui - css " : " ^ 2 . 2 . 12 " , <nl> - " semantic - ui - react " : " ^ 0 . 73 . 1 " , <nl> + " semantic - ui - react " : " ^ 0 . 74 . 2 " , <nl> " serialize - javascript " : " ^ 1 . 4 . 0 " , <nl> " spdy " : " ^ 3 . 4 . 7 " , <nl> - " store2 " : " ^ 2 . 5 . 5 " , <nl> - " styled - components " : " ^ 2 . 1 . 2 " <nl> + " store2 " : " ^ 2 . 5 . 6 " , <nl> + " styled - components " : " ^ 2 . 2 . 0 " <nl> } , <nl> " devDependencies " : { <nl> " assets - webpack - plugin " : " ^ 3 . 5 . 1 " , <nl> " autoprefixer " : " ^ 7 . 1 . 4 " , <nl> " babel - cli " : " ^ 6 . 26 . 0 " , <nl> " babel - core " : " ^ 6 . 26 . 0 " , <nl> - " babel - eslint " : " ^ 8 . 0 . 0 " , <nl> + " babel - eslint " : " ^ 8 . 0 . 1 " , <nl> " babel - loader " : " ^ 7 . 1 . 2 " , <nl> " babel - plugin - dynamic - import - node " : " ^ 1 . 1 . 0 " , <nl> " babel - plugin - lodash " : " ^ 3 . 2 . 11 " , <nl> " babel - preset - stage - 1 " : " ^ 6 . 24 . 1 " , <nl> " babel - register " : " 6 . 26 . 0 " , <nl> " babel - runtime " : " ^ 6 . 26 . 0 " , <nl> - " caniuse - lite " : " ^ 1 . 0 . 30000733 " , <nl> + " caniuse - lite " : " ^ 1 . 0 . 30000739 " , <nl> " circular - dependency - plugin " : " ^ 4 . 2 . 1 " , <nl> " commitizen " : " ^ 2 . 9 . 6 " , <nl> " compression - webpack - plugin " : " ^ 1 . 0 . 0 " , <nl> " css - loader " : " ^ 0 . 28 . 7 " , <nl> - " enzyme " : " ^ 2 . 9 . 1 " , <nl> - " enzyme - to - json " : " ^ 2 . 0 . 0 " , <nl> - " eslint " : " ^ 4 . 7 . 1 " , <nl> + " enzyme " : " ^ 3 . 0 . 0 " , <nl> + " enzyme - to - json " : " ^ 3 . 0 . 1 " , <nl> + " eslint " : " ^ 4 . 7 . 2 " , <nl> " eslint - config - standard " : " ^ 10 . 2 . 1 " , <nl> " eslint - loader " : " ^ 1 . 9 . 0 " , <nl> " eslint - plugin - babel " : " ^ 4 . 1 . 2 " , <nl> - " eslint - plugin - flowtype " : " ^ 2 . 35 . 1 " , <nl> + " eslint - plugin - flowtype " : " ^ 2 . 36 . 0 " , <nl> " eslint - plugin - import " : " ^ 2 . 7 . 0 " , <nl> " eslint - plugin - jsx - a11y " : " ^ 6 . 0 . 2 " , <nl> - " eslint - plugin - node " : " ^ 5 . 1 . 1 " , <nl> + " eslint - plugin - node " : " ^ 5 . 2 . 0 " , <nl> " eslint - plugin - promise " : " ^ 3 . 5 . 0 " , <nl> - " eslint - plugin - react " : " ^ 7 . 3 . 0 " , <nl> + " eslint - plugin - react " : " ^ 7 . 4 . 0 " , <nl> " eslint - plugin - standard " : " ^ 3 . 0 . 1 " , <nl> " extract - text - webpack - plugin " : " ^ 3 . 0 . 0 " , <nl> " favicons - webpack - plugin " : " 0 . 0 . 7 " , <nl> " husky " : " ^ 0 . 14 . 3 " , <nl> " i18n - webpack - plugin " : " ^ 1 . 0 . 0 " , <nl> " img - loader " : " ^ 2 . 0 . 0 " , <nl> - " jest " : " ^ 21 . 1 . 0 " , <nl> + " jest " : " ^ 21 . 2 . 1 " , <nl> " jest - styled - components " : " ^ 4 . 6 . 0 " , <nl> - " nock " : " ^ 9 . 0 . 18 " , <nl> + " nock " : " ^ 9 . 0 . 22 " , <nl> " node - sass " : " ^ 4 . 5 . 3 " , <nl> " open " : " 0 . 0 . 5 " , <nl> " optimize - css - assets - webpack - plugin " : " ^ 3 . 2 . 0 " , <nl> " optimize - js - plugin " : " 0 . 0 . 4 " , <nl> - " postcss " : " ^ 6 . 0 . 11 " , <nl> + " postcss " : " ^ 6 . 0 . 12 " , <nl> " postcss - browser - reporter " : " ^ 0 . 5 . 0 " , <nl> " postcss - cssnext " : " ^ 3 . 0 . 2 " , <nl> " postcss - import " : " ^ 11 . 0 . 0 " , <nl> " postcss - loader " : " ^ 2 . 0 . 6 " , <nl> " postcss - reporter " : " ^ 5 . 0 . 0 " , <nl> + " pseudossl " : " ^ 1 . 0 . 1 " , <nl> " react - a11y " : " ^ 0 . 3 . 4 " , <nl> " react - addons - perf " : " ^ 15 . 4 . 2 " , <nl> - " react - addons - test - utils " : " ^ 15 . 6 . 0 " , <nl> + " react - addons - test - utils " : " ^ 15 . 6 . 2 " , <nl> " react - hot - loader " : " ^ 3 . 0 . 0 - beta . 6 " , <nl> " redux - devtools - extension " : " ^ 2 . 13 . 2 " , <nl> " redux - mock - store " : " ^ 1 . 3 . 0 " , <nl> " webpack - hot - middleware " : " ^ 2 . 19 . 1 " , <nl> " webpack - manifest - plugin " : " ^ 1 . 3 . 2 " , <nl> " why - did - you - update " : " ^ 0 . 0 . 8 " , <nl> - " write - file - webpack - plugin " : " ^ 4 . 1 . 0 " <nl> + " write - file - webpack - plugin " : " ^ 4 . 2 . 0 " <nl> } , <nl> " optionalDependencies " : { <nl> " babili - webpack - plugin " : " ^ 0 . 1 . 2 " , <nl> 
mmm a / src / common / actions / utils / index . js <nl> ppp b / src / common / actions / utils / index . js <nl> const check = ( result : Object = { ok : false } ) : boolean = > result . ok <nl> const beforeCheck = a = > a <nl> const afterCheck = a = > a . data <nl> - / / Create default Awral <nl> + / * * <nl> + Create default Awral <nl> + Awral is my own tool . <nl> + It ' s not well known , but it can make your work with actions even more simpler . <nl> + { @ link https : / / github . com / Metnew / awral } <nl> + * / <nl> export const awral = Awral . of ( { check , beforeCheck , afterCheck } ) <nl> 
mmm a / locals / en . json <nl> ppp b / locals / en . json <nl> " Dashboard . h2 - 1 " : " Intro " , <nl> " Dashboard . h2 - 2 " : " How it works ? " , <nl> - " Dashboard . h3 - 1 " : " Hello , this is Noir . " , <nl> - " Dashboard . h3 - 2 " : " Hello , this is Noir . " , <nl> - " Dashboard . p - 1 " : " How it works ? " , <nl> - " Dashboard . p - 2 " : " Hello , this is Noir . " <nl> + " Dashboard . h3 - 1 " : " Noir . " , <nl> + " Dashboard . h3 - 2 " : " Noir . " , <nl> + " Dashboard . p - 1 " : " In progress . " , <nl> + " Dashboard . p - 2 " : " In progress . " <nl> } <nl> 
mmm a / src / server / middlewares / auth . js <nl> ppp b / src / server / middlewares / auth . js <nl> isLoggedIn : false <nl> } <nl> - const token : string = req . cookies [ JWT_TOKEN ] <nl> + let token : string = req . cookies [ JWT_TOKEN ] <nl> if ( ! token ) { <nl> return next ( ) <nl> } <nl> @ @ - 33 , 16 + 33 , 18 @ @ export default ( <nl> jwt . verify ( token , process . env . JWT_SECRET , ( err , decoded ) = > { <nl> if ( err ) { <nl> console . log ( chalk . red ( ' CANT DECODE JWT TOKEN ! ' , err ) ) <nl> + token = null <nl> } else { <nl> - console . log ( chalk . magenta ( ' TOKEN SUCCESSFULLY DECODED ' ) ) <nl> - / / NOTE : set user language in jwt token that may helps handling i18n efficiently <nl> const { username } = decoded <nl> req . user = { <nl> token , <nl> username , <nl> isLoggedIn : true <nl> } <nl> + console . log ( chalk . magenta ( ' TOKEN SUCCESSFULLY DECODED ' ) ) <nl> + / / FIXME : set user language in jwt token <nl> } <nl> + <nl> console . log ( <nl> chalk . yellow ( ` USER IS LOGGED IN : $ { req . user . isLoggedIn ? ' YES ' : ' NO ' } ` ) <nl> ) <nl> 
mmm a / src / server / api / links . json <nl> ppp b / src / server / api / links . json <nl> } , <nl> { <nl> - " link " : " https : / / github . com / Metnew / noir " , <nl> + " link " : " https : / / github . com / Metnew / react - semantic . ui - starter / tree / master / docs " , <nl> " icon " : " bug " , <nl> " header " : " Testing " , <nl> " desc " : " How to test actions , reducers , components ? " <nl> } , <nl> { <nl> - " link " : " https : / / github . com / Metnew / noir " , <nl> + " link " : " https : / / github . com / Metnew / react - semantic . ui - starter / tree / master / docs " , <nl> " icon " : " paint brush " , <nl> " header " : " Why semantic - ui - react ? " , <nl> " desc " : " Notes about SUI . Why SUIR is a good ( or bad ) choise . " <nl> } , <nl> { <nl> - " link " : " " , <nl> + " link " : " https : / / github . com / Metnew / react - semantic . ui - starter / tree / master / docs " , <nl> " icon " : " globe " , <nl> " header " : " How i18n works ? " , <nl> " desc " : " How i18n is implemented and how to customize it . " <nl> } , <nl> { <nl> + " link " : " https : / / github . com / Metnew / react - semantic . ui - starter / tree / master / docs " , <nl> " header " : " How Webpack is configured ? " , <nl> " icon " : " code " , <nl> - " link " : " " , <nl> " desc " : <nl> " Webpack configuration for server / client in production and development . " <nl> } , <nl> { <nl> - " link " : " " , <nl> + " link " : " https : / / github . com / Metnew / react - semantic . ui - starter / tree / master / docs " , <nl> " icon " : " terminal " , <nl> " header " : " npm scripts and ENV vars " , <nl> " desc " : " Docs about every npm script and ENV variable . " <nl> } , <nl> { <nl> - " link " : " " , <nl> + " link " : " https : / / github . com / Metnew / react - semantic . ui - starter / tree / master / docs " , <nl> " icon " : " folder " , <nl> " header " : " Folder structure " , <nl> " desc " : " Why this folder structure and how to adapt it in own project . " <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> path : ' / links ' , <nl> name : ' Links ' , <nl> exact : true , <nl> + / / lazy : true , <nl> icon : ' bookmark ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : Links <nl> + component : Links / / loadLazyComponentFnConstructor ( ' Links ' ) <nl> } , <nl> { <nl> external : true , <nl> 
mmm a / package . json <nl> ppp b / package . json <nl> " react " : " ^ 16 . 0 . 0 " , <nl> " react - dom " : " ^ 16 . 0 . 0 " , <nl> - " react - ga " : " 2 . 2 . 0 " , <nl> + " react - ga " : " 2 . 3 . 5 " , <nl> " react - headroom " : " ^ 2 . 2 . 1 " , <nl> " react - helmet " : " ^ 5 . 2 . 0 " , <nl> " react - intl " : " ^ 2 . 4 . 0 " , <nl> } , <nl> " devDependencies " : { <nl> " assets - webpack - plugin " : " ^ 3 . 5 . 1 " , <nl> - " autodll - webpack - plugin " : " ^ 0 . 2 . 1 " , <nl> + " autodll - webpack - plugin " : " ^ 0 . 3 . 2 " , <nl> " autoprefixer " : " ^ 7 . 1 . 4 " , <nl> " babel - cli " : " ^ 6 . 26 . 0 " , <nl> " babel - core " : " ^ 6 . 26 . 0 " , <nl> " eslint - plugin - standard " : " ^ 3 . 0 . 1 " , <nl> " extract - text - webpack - plugin " : " ^ 3 . 0 . 0 " , <nl> " favicons - webpack - plugin " : " 0 . 0 . 7 " , <nl> - " file - loader " : " ^ 0 . 11 . 2 " , <nl> - " flow - bin " : " ^ 0 . 55 . 0 " , <nl> + " file - loader " : " ^ 1 . 1 . 5 " , <nl> + " flow - bin " : " ^ 0 . 57 . 2 " , <nl> " friendly - errors - webpack - plugin " : " ^ 1 . 6 . 1 " , <nl> " html - webpack - plugin " : " ^ 2 . 30 . 1 " , <nl> " husky " : " ^ 0 . 14 . 3 " , <nl> " sass - loader " : " ^ 6 . 0 . 6 " , <nl> " serve " : " ^ 6 . 1 . 0 " , <nl> " standard - version " : " ^ 4 . 2 . 0 " , <nl> - " style - loader " : " ^ 0 . 18 . 2 " , <nl> + " style - loader " : " ^ 0 . 19 . 0 " , <nl> " stylelint " : " ^ 8 . 1 . 1 " , <nl> " stylelint - config - standard " : " ^ 17 . 0 . 0 " , <nl> " uglify - js " : " git : / / github . com / mishoo / UglifyJS2 . git # harmony - v2 . 8 . 22 " , <nl> - " uglifyjs - webpack - plugin " : " ^ 0 . 4 . 6 " , <nl> - " url - loader " : " ^ 0 . 5 . 9 " , <nl> + " uglifyjs - webpack - plugin " : " ^ 1 . 0 . 0 - beta . 3 " , <nl> + " url - loader " : " ^ 0 . 6 . 2 " , <nl> " validate - commit - msg " : " ^ 2 . 14 . 0 " , <nl> " webpack " : " ^ 3 . 6 . 0 " , <nl> " webpack - assets - manifest " : " ^ 1 . 0 . 0 " , <nl> 
mmm a / src / common / actions / layout / index . js <nl> ppp b / src / common / actions / layout / index . js <nl> } <nl> } ) <nl> + / / See reducers / layout for an additional info : <nl> + / / export const ADD_STYLES_TO_ELEMENT = ( element <nl> + / / ) = > ( styles ) = > ( { <nl> + / / element , <nl> + / / styles <nl> + / / } ) <nl> + <nl> export type UI_OPEN_SIDEBAR_TYPE = { type : ' UI_OPEN_SIDEBAR ' } <nl> export type UI_CLOSE_SIDEBAR_TYPE = { type : ' UI_CLOSE_SIDEBAR ' } <nl> export type UI_WINDOW_RESIZE_TYPE = { <nl> 
mmm a / src / common / reducers / layout / index . js <nl> ppp b / src / common / reducers / layout / index . js <nl> . . . state , <nl> sidebarOpened : false <nl> } <nl> + / / See actions / layout for more info <nl> + / / case APPLY_STYLES : { <nl> + / / const { element , styles } = payload <nl> + / / return { <nl> + / / . . . state , <nl> + / / styles : { <nl> + / / [ element ] : styles <nl> + / / } <nl> + / / } <nl> + / / } <nl> default : <nl> return state <nl> } <nl> 
mmm a / CHANGELOG . md <nl> ppp b / CHANGELOG . md <nl> - < a name = " 0 . 1 . 1 " > < / a > <nl> - # # [ 0 . 1 . 1 ] ( https : / / github . com / Metnew / react - semantic . ui - starter / compare / v0 . 1 . 0 . . . v0 . 1 . 1 ) ( 2017 - 10 - 16 ) <nl> - <nl> - <nl> - <nl> < a name = " 0 . 1 . 0 " > < / a > <nl> # [ 0 . 1 . 0 ] ( https : / / github . com / Metnew / react - semantic . ui - starter / compare / v0 . 1 . 0 - alpha . 0 . . . v0 . 1 . 0 ) ( 2017 - 10 - 16 ) <nl> 
mmm a / src / common / actions / utils / index . js <nl> ppp b / src / common / actions / utils / index . js <nl> const afterCheck = a = > a . data <nl> / * * <nl> Create default Awral <nl> - Awral is my own tool . <nl> - It ' s not well known , but it can make your work with actions even more simpler . <nl> + Awral is not recommended for production usage now <nl> + But it can make your work with actions even simpler . <nl> + NOTE : I strongly recommend you check Awral sources ! <nl> + Awral is 880B gzipped ! <nl> { @ link https : / / github . com / Metnew / awral } <nl> * / <nl> export const awral = Awral . of ( { check , beforeCheck , afterCheck } ) <nl> 
mmm a / src / common / components / addons / RoutingWrapper / index . jsx <nl> ppp b / src / common / components / addons / RoutingWrapper / index . jsx <nl> * Checks Auth logic . Is user allowed to visit certain path ? <nl> * @ param { String } path next path to visit <nl> * @ return { Bool } is user allowed to visit next location ? <nl> - * check RouteAuth component . <nl> + * @ desc Think about this method as static . <nl> + * Maybe , It ' d be even better to store this logic in a plain function rather than in a method . <nl> + * { @ link - src / common / components / addons / RouteAuth / index . jsx } <nl> * / <nl> authCheck ( path : string ) : boolean { <nl> const { store } = this . props <nl> 
mmm a / src / common / routing / routes . js <nl> ppp b / src / common / routing / routes . js <nl> import RouteAuth from ' components / addons / RouteAuth ' <nl> import Dashboard from ' containers / Dashboard ' <nl> - import Links from ' containers / Links ' <nl> import Login from ' containers / Login ' <nl> import type { RouteItem } from ' types ' <nl> @ @ - 32 , 11 + 31 , 11 @ @ const routes : Array < RouteItem > = [ <nl> path : ' / links ' , <nl> name : ' Links ' , <nl> exact : true , <nl> - / / lazy : true , <nl> + lazy : true , <nl> icon : ' bookmark ' , <nl> sidebarVisible : true , <nl> tag : RouteAuth , <nl> - component : Links / / loadLazyComponentFnConstructor ( ' Links ' ) <nl> + component : loadLazyComponentFnConstructor ( ' Links ' ) <nl> } , <nl> { <nl> external : true , <nl> 
mmm a / src / client / index . jsx <nl> ppp b / src / client / index . jsx <nl> import ' semantic - ui - css / components / sidebar . css ' <nl> import ' semantic - ui - css / components / site . css ' <nl> import ' semantic - ui - css / components / statistic . css ' <nl> - / / promise polyfill <nl> + / / Polyfill for IE 11 <nl> + / / P . S : i don ' t know does starter works in IE 11 <nl> import ' promise - polyfill ' <nl> / / Application <nl> import { hydrate } from ' react - dom ' <nl> 
